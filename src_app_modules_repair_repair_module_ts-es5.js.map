{"version":3,"mappings":"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","names":["module","year","month","day","hour","minute","second","e","hour12","timeZone","timeZoneName","r","n","i","u","c","f","locale","$set","utcOffset","find","o","a","m","d","RepairStatusMapper","CaseStatusMapper","_angular_core__WEBPACK_IMPORTED_MODULE_10__","ctx_r4","ctx_r5","ctx_r6","CustomerLayoutComponent","router","caseService","route","commonService","cdr","inspectionService","messageService","translateService","repairEstimateService","monitorService","dialog","src_app_model_menu__WEBPACK_IMPORTED_MODULE_2__","inProgressSteps","subscribe","length","stepInProgress","status","indexOf","_a","toLowerCase","event","getCaseHistory","repairGuid","domainId","inspectionData","item","inspection","repairInspectionTemplate","template","uploadType","minimumPhotosRequired","inspectionItems","filter","value","isSkipEnabled","currentPhotos","_b","currentStep","rawAzureBlobUrl","showToast","minimumBulkPhotosRequired","minImageLimit","bulkUploadedItemsWithImages","step","queryParam","location","search","url","tabs","_c","setActiveMenu","navigate","replace","queryParams","mode","error","console","log","caseId","history","isHistoryLoading","next","response","complete","id","showLoading","getInspection","inspectionDetailResponse","mapInspection","hideLoading","urlSegments","split","lastSegment","substring","repairSegments","includes","activeItem","params","idSub$","pipe","data","subscriptions","push","bookingId$","bookingId","detectChanges","activeItem$","repairDetails$","repairDetails","showHideTopHeader","statusDesc","statusDescription","customerData","firstName","customer","lastName","mobileNumber","countryCode","_d","email","_e","workProvider","_f","companyOrgType","isCompany","_g","customerTypeName","caseData","vehicleMake","vehicle","_h","vehicleModel","_j","licensePlate","_k","licensePlateNumber","_l","modelYearRange","inspectionId","_m","repairTypes","repairServiceTypes","repairType","currentOrganizationId","organizationDetail","_o","organizationId","isViewOnly","currentLastSegment","displayMissingInspectionMessage","isGenerated","_p","_q","_r","type","formType","vehicleId","_s","quoteId","repairObjectId","_t","repairMenuItems","disabled","isNoShow","booking","_u","roleName","_v","getEstimationDetail","estimateSource","userPermission$","userProfileData","res","automotiveServices","userPermission","automotiveService","x","automotiveServiceName","menuRepairItems","q","name","source","getGTEstimationDetail","getManualEstimationDetail","logEvent","caseGuid","getEstimate","estimateCharges","estimationOperationLength","getRepairEstimate","currentUrl","pathname","statusList","openAlertDialog","instant","getInspectionItems","viewActionTriggeredBooking","actionTriggered","active","currentStatus","afterClosed","result","containerWidth","userDetail","nativeElement","offsetWidth","expandUserDetail","showUserSection","dialogRef","open","src_app_dialogs_labour_rate_labour_rate_component__WEBPACK_IMPORTED_MODULE_0__","src_app_model_chq_upload_model__WEBPACK_IMPORTED_MODULE_1__","autoFocus","labourData","isRefreshRepairEstimateDetails","repairId","forEach","subscription","unsubscribe","selectors","viewQuery","ctx","_r2","_angular_core__WEBPACK_IMPORTED_MODULE_14__","ctx_r27","$event","model_r35","customer_r52","dayjs__WEBPACK_IMPORTED_MODULE_0__","dayjs_plugin_utc__WEBPACK_IMPORTED_MODULE_2__","dayjs_plugin_timezone__WEBPACK_IMPORTED_MODULE_1__","BookingJournalComponent","formBuilder","calendarService","datePipe","bookingService","xaCurrencyPipe","Date","label","icon","localStorage","getItem","currentView","defaultHeight","group","TypeName","Booking","WorkProviderDto","WorkProviderName","CustomerName","OrgName","Assignees","RepairType","placeHolder","options","displayValue","fieldValue","isMultiSelect","checked","geti18nInfo","bookingJournal","onAppointmentAdd","bind","getScreenSize","isTouchScreen","window","navigator","maxTouchPoints","platform","userAgent","document","windowInnerWidth","innerWidth","maxAppointmentsPerCell","isSmallScreen","scheduler","instance","getDataSource","reload","hasQuotePermission","some","userIsBM","roleDetail","filterForm","get","setValue","noPermissionRoles","isReadOnlyPermission","currentDate","getCalendarData","generateFilterQuery","draftDataLoaded","showDraftCustomer","getDraftCustomer","draftData","map","statusTrimmed","routeToRedirect","draftCustomerType","src_app_config_route_mapper_repair_status_mapper__WEBPACK_IMPORTED_MODULE_4__","statusClass","sort","b","createdDate","getTime","draftCustomer","calendarWidth","calendarHeight","showCalendar","setTimeout","scrollToCurrentTime","getOrganizations","filterDataLoaded","toggle","getBookingRepairTypes","getOrgIfBM","getProvidersByOrgId","getCaseUsers","bookingRepairType","orgList","employeeList","filterModal","BookingTypes","Object","selectedOption","RepairTypes","getRepairTpeIcon","iconMapper","Body","Maintenance","Paint","Tires","Electric","Electrical","Mechanical","Diagnosis","Others","statusMapper","draft","vehicledetails","uploaddocuments","uploadphotos","repairestimation","pendingapproval","approved","reject","rejected","closed","partsorderedpartially","partsordered","repairinprogress","readytoinvoice","invoiceready","invoiced","paid","others","calendarData","calendarCurrentStartDate","getStartViewDate","toDateString","toISOString","calendarCurrentEndDate","getEndViewDate","startDate","endDate","isFromCalendar","filterValue","query","keys","key","join","partialQuery","arr","reduce","total","current","totalEstimate","totalLabour","totalBooking","bookingIdList","disabledDate","weekendDate","startHour","endHour","getSchedule","userId","scheduleData","updatedValue","orgValue","mappedData","StartDate","toDate","EndDate","Color","BookingTypeColor","Icon","DisplayStatus","getDisplayStatus","StatusName","isSameDay","allDay","BookingGuid","getFullYear","getMonth","checkDateRange","EstimateCost","LabourCost","checkSchedule","scrollToHour","getHours","scrollToTime","getMinutes","calenderDays","element","breaks","startTime","date","endTime","stringDate","toString","lunchTime","add","isOff","isWeekend","timeSlots","format","formattedStartDate","transform","formattedEndDate","appointment","previewOpen","openPreview","deleteAppointment","findIndex","Id","cancel","_booking_preview_booking_preview_component__WEBPACK_IMPORTED_MODULE_6__","maxHeight","success","refreshCalendarData","draftClose","isDoubleClick","appointmentData","ObjectGuid","setItem","showInfoToast","checkDateAndOpen","isPastDate","cellData","isValidAppointment","component","notifyDisableDate","isValidAppointmentDate","allowedStatus","oldData","newData","message","getDate","setDate","patchBooking","bookingGuid","patchValue","op","path","updateBooking","localeDate","toLocaleDateString","holidays","getHolidays","holiday","getDay","isHoliday","isDisableDate","isValidAppointmentInterval","cellDuration","edgeEndDate","form","startDateEditor","getEditor","option","endDateEditor","filteredData","calculateSum","i18n","currencySymbol","digitsInfo","position","start","end","output","prevValue","keyFieldValue","index","splice","showProviderChild","orgQuery","getCompanyData","concatArray","concat","companyName","partnershipName","getCustomer","self","ContactId","FirstName","LastName","Email","html","getWorkProviders","applyButton","Math","round","close","reset","itemData","fromData","toData","addAppointmentFromDraft","openDraftCustomer","openDeleteDialog","deleteDraftCustomer","orgId","devextreme_angular__WEBPACK_IMPORTED_MODULE_24__","src_app_services_calendar_calendar_service__WEBPACK_IMPORTED_MODULE_5__","decls","vars","consts","_r5","_angular_core__WEBPACK_IMPORTED_MODULE_5__","repairType_r11","BookingPreviewComponent","Tyres","events","_angular_router__WEBPACK_IMPORTED_MODULE_7__","src_app_config_route_mapper_repair_status_mapper__WEBPACK_IMPORTED_MODULE_0__","isRepairCreatedFromCase","isArrived","IsArrived","IsNoShow","IsRepairCreatedFromCase","calculateTimeDifference","beforeClosed","changesMade","bookingInDate","canActivateDate","isArrivedVisible","isNoShowVisible","deleteBooking","AssigneeName","_angular_material_dialog__WEBPACK_IMPORTED_MODULE_10__","features","src_app_services_calendar_calendar_service__WEBPACK_IMPORTED_MODULE_1__","_r1","_r4","LoungeListComponent","OutboundService","orgLogoUrl","logoUrl","orgName","orgImageLoading","chkScreenMode","elem","documentElement","getOutboundData","timeInterval","setInterval","updateDate","repairs","OutboundStatus","IsDeliveryTypeEnable","DeliveryDTO","flag","CallingAPI","subs","getDeparturesDetails","outboundData","Jobs","PickUpDate","LastRefreshed","clearTimeout","currentDateTimeout","updateCurrentDateTime","nodes","querySelectorAll","FocusedRepairIndex","querySelector","scrollTop","scrollIntoView","behavior","block","loungeTimeout","autoScrollLastVisibleNode","container","undefined","visibleHeight","totalHeight","clientHeight","fullscreenElement","isFullScreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","sub","clearInterval","_angular_common__WEBPACK_IMPORTED_MODULE_6__","hostBindings","src_app_services_outbound_outbound_service__WEBPACK_IMPORTED_MODULE_1__","_angular_core__WEBPACK_IMPORTED_MODULE_2__","CheckInTaskComponent","_angular_router__WEBPACK_IMPORTED_MODULE_4__","getTaskDetails","repair","RepairGuid","jobId","job","JobGuid","ListOfRepairs","allMandatoryTasks","task","isMandatory","_angular_material_dialog__WEBPACK_IMPORTED_MODULE_7__","src_app_services_outbound_outbound_service__WEBPACK_IMPORTED_MODULE_0__","_r13","OutboundComponent","maxDate","minDate","getWeekDates","currentWeek","isTechnician","departures","TotalAmount","el","lastUpdated","IntervalGetOutBound","repairIndex","pickupDate","setPickupDate","_check_in_task_check_in_task_component__WEBPACK_IMPORTED_MODULE_2__","days","floor","weekNumber","ceil","daysInWeek","dates","week","start_date","temp_date","new_date","setMonth","currentWeekNumber","getWeekNumber","direction","scrollLeft","scrollWidth","clientWidth","RepairData","getRepairDetailByGuid","openEmailForNotifyInner","communicationTypeId","communicationEvents","communicationList","communicatedList","src_app_dialogs_notify_dialog_notify_dialog_component__WEBPACK_IMPORTED_MODULE_3__","templateId","backdropClass","maxWidth","RepairStatus","repairRoutes","pathMatch","redirectTo","canActivate","src_app_guards_repair_guard_repair_guard__WEBPACK_IMPORTED_MODULE_10__","loadChildren","Promise","then","AddRepairCustomersModule","_add_customers_customer_layout_customer_layout_component__WEBPACK_IMPORTED_MODULE_3__","__webpack_require__","CustomerTableModule","_booking_journal_booking_journal_booking_journal_component__WEBPACK_IMPORTED_MODULE_4__","BookingJournalModule","_workflow_workflow_workflow_component__WEBPACK_IMPORTED_MODULE_9__","WorkflowModule","_outbound_outbound_outbound_component__WEBPACK_IMPORTED_MODULE_7__","_azure_msal_angular__WEBPACK_IMPORTED_MODULE_11__","OutboundModule","_lounge_list_lounge_list_component__WEBPACK_IMPORTED_MODULE_6__","LoungeListModule","_workflow_lounge_workflow_lounge_component__WEBPACK_IMPORTED_MODULE_8__","WorkflowLoungeModule","RepairModule","_angular_common__WEBPACK_IMPORTED_MODULE_13__","src_app_shared_shared_module__WEBPACK_IMPORTED_MODULE_1__","_angular_material_icon__WEBPACK_IMPORTED_MODULE_14__","_angular_router__WEBPACK_IMPORTED_MODULE_15__","_widgets_chq_widgets_module__WEBPACK_IMPORTED_MODULE_2__","_ngx_translate_core__WEBPACK_IMPORTED_MODULE_16__","src_app_helper_directive_module__WEBPACK_IMPORTED_MODULE_0__","declarations","_estimate_approval_estimate_approval_component__WEBPACK_IMPORTED_MODULE_5__","imports","_r7","items_r14","WorkflowLoungeComponent","workflowService","CustomerId","CompanyId","width","height","parentContainer","visibleWidth","longestNodeIndex","longestNodeLength","totalWidth","children","FocusedRepairHorizontalIndex","inline","autoScrollInterval","verticalView","verticalScroll","horizontalScroll","getWorkflowDetails","IntervalGetWorkflow","getWorkflowDetailsWithQuery","workflowData","getTotals","JobName","calculatedHeight","WaterfallRepairs","child","isLoaded","LastRefreshedDate","horizontalRowHeight","horizontalRow","offsetHeight","totalCost","totalCount","itm","ManualCost","CustomerList","contactId","isIndividual","subLabel","licenseNumber","companyId","Tooltip","verticalRowWidth","verticalRow","src_app_services_workflow_workflow_service__WEBPACK_IMPORTED_MODULE_1__","WorkflowComponent","Status","src_app_config_route_mapper_repair_status_mapper__WEBPACK_IMPORTED_MODULE_1__","src_app_services_workflow_workflow_service__WEBPACK_IMPORTED_MODULE_2__","_r3","MessagesService","http","fileService","src_environments_environment__WEBPACK_IMPORTED_MODULE_0__","post","body","emailBody","reportProgress","observe","formData","FormData","append","cc","subject","objectId","files","file","uploadFile","factory","providedIn","isPickedup","put","_angular_core__WEBPACK_IMPORTED_MODULE_1__","WorkflowService","repairguid","obj","patch"],"sources":["webpack:///node_modules/dayjs/plugin/timezone.js","webpack:///src/app/config/route-mapper/repair-status-mapper.ts","webpack:///src/app/modules/repair/add-customers/customer-layout/customer-layout.component.html","webpack:///src/app/modules/repair/add-customers/customer-layout/customer-layout.component.ts","webpack:///src/app/modules/repair/booking-journal/booking-journal/booking-journal.component.html","webpack:///src/app/modules/repair/booking-journal/booking-journal/booking-journal.component.ts","webpack:///src/app/modules/repair/booking-journal/booking-preview/booking-preview.component.html","webpack:///src/app/modules/repair/booking-journal/booking-preview/booking-preview.component.ts","webpack:///src/app/modules/repair/lounge-list/lounge-list.component.html","webpack:///src/app/modules/repair/lounge-list/lounge-list.component.ts","webpack:///src/app/modules/repair/outbound/check-in-task/check-in-task.component.html","webpack:///src/app/modules/repair/outbound/check-in-task/check-in-task.component.ts","webpack:///src/app/modules/repair/outbound/outbound/outbound.component.html","webpack:///src/app/modules/repair/outbound/outbound/outbound.component.ts","webpack:///src/app/modules/repair/repair.module.ts","webpack:///src/app/modules/repair/workflow-lounge/workflow-lounge.component.html","webpack:///src/app/modules/repair/workflow-lounge/workflow-lounge.component.ts","webpack:///src/app/modules/repair/workflow/workflow/workflow.component.html","webpack:///src/app/modules/repair/workflow/workflow/workflow.component.ts","webpack:///src/app/services/message/messages.service.ts","webpack:///src/app/services/outbound/outbound.service.ts","webpack:///src/app/services/workflow/workflow.service.ts"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs_plugin_timezone=e()}(this,(function(){\"use strict\";var t={year:0,month:1,day:2,hour:3,minute:4,second:5},e={};return function(n,i,o){var r,a=function(t,n,i){void 0===i&&(i={});var o=new Date(t),r=function(t,n){void 0===n&&(n={});var i=n.timeZoneName||\"short\",o=t+\"|\"+i,r=e[o];return r||(r=new Intl.DateTimeFormat(\"en-US\",{hour12:!1,timeZone:t,year:\"numeric\",month:\"2-digit\",day:\"2-digit\",hour:\"2-digit\",minute:\"2-digit\",second:\"2-digit\",timeZoneName:i}),e[o]=r),r}(n,i);return r.formatToParts(o)},u=function(e,n){for(var i=a(e,n),r=[],u=0;u<i.length;u+=1){var f=i[u],s=f.type,m=f.value,c=t[s];c>=0&&(r[c]=parseInt(m,10))}var d=r[3],l=24===d?0:d,h=r[0]+\"-\"+r[1]+\"-\"+r[2]+\" \"+l+\":\"+r[4]+\":\"+r[5]+\":000\",v=+e;return(o.utc(h).valueOf()-(v-=v%1e3))/6e4},f=i.prototype;f.tz=function(t,e){void 0===t&&(t=r);var n=this.utcOffset(),i=this.toDate(),a=i.toLocaleString(\"en-US\",{timeZone:t}),u=Math.round((i-new Date(a))/1e3/60),f=o(a,{locale:this.$L}).$set(\"millisecond\",this.$ms).utcOffset(15*-Math.round(i.getTimezoneOffset()/15)-u,!0);if(e){var s=f.utcOffset();f=f.add(n-s,\"minute\")}return f.$x.$timezone=t,f},f.offsetName=function(t){var e=this.$x.$timezone||o.tz.guess(),n=a(this.valueOf(),e,{timeZoneName:t}).find((function(t){return\"timezonename\"===t.type.toLowerCase()}));return n&&n.value};var s=f.startOf;f.startOf=function(t,e){if(!this.$x||!this.$x.$timezone)return s.call(this,t,e);var n=o(this.format(\"YYYY-MM-DD HH:mm:ss:SSS\"),{locale:this.$L});return s.call(n,t,e).tz(this.$x.$timezone,!0)},o.tz=function(t,e,n){var i=n&&e,a=n||e||r,f=u(+o(),a);if(\"string\"!=typeof t)return o(t).tz(a);var s=function(t,e,n){var i=t-60*e*1e3,o=u(i,n);if(e===o)return[i,e];var r=u(i-=60*(o-e)*1e3,n);return o===r?[i,o]:[t-60*Math.min(o,r)*1e3,Math.max(o,r)]}(o.utc(t,i).valueOf(),f,a),m=s[0],c=s[1],d=o(m).utcOffset(c);return d.$x.$timezone=a,d},o.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},o.tz.setDefault=function(t){r=t}}}));","export const RepairStatusMapper = {\r\n  'draft': 'repair/booking/{{repairGUID}}',\r\n  'vehicledetails': 'repair/booking/{{repairGUID}}',\r\n  'uploaddocuments': 'repair/booking/{{repairGUID}}/document',\r\n  'uploadphotos': 'repair/booking/{{repairGUID}}/photos',\r\n  'repairestimation': 'repair/booking/{{repairGUID}}/estimate',\r\n  'pendingapproval': 'repair/booking/{{repairGUID}}/estimate',\r\n  'approved': 'repair/booking/{{repairGUID}}/estimate',\r\n  'reject': 'repair/booking/{{repairGUID}}/estimate',\r\n  'rejected': 'repair/booking/{{repairGUID}}/estimate',\r\n  'closed': 'repair/booking/{{repairGUID}}/invoices',\r\n  'complete': 'repair/booking/{{repairGUID}}/invoices',\r\n  'partsorderedpartially': 'repair/booking/{{repairGUID}}/parts',\r\n  'partsordered': 'repair/booking/{{repairGUID}}/parts',\r\n  'repairinprogress': 'repair/booking/{{repairGUID}}/repair-stages',\r\n  'readytoinvoice': 'repair/booking/{{repairGUID}}/invoices',\r\n  'invoiced': 'repair/booking/{{repairGUID}}/invoices',\r\n  'paid': 'repair/booking/{{repairGUID}}/invoices',\r\n  'others': 'repair/booking/{{repairGUID}}',\r\n}\r\n\r\nexport const CaseStatusMapper = {\r\n  'draft': 'quote/case/{{caseGUID}}',\r\n  'vehicledetails': 'quote/case/{{caseGUID}}/vehicle',\r\n  'uploaddocuments': 'quote/case/{{caseGUID}}/document',\r\n  'uploadphotos': 'quote/case/{{caseGUID}}/photos',\r\n  'aianalysis': 'quote/case/{{caseGUID}}/ai',\r\n  'repairestimation': 'quote/case/{{caseGUID}}/estimate',\r\n  'approved': 'quote/case/{{caseGUID}}/estimate',\r\n  'reject': 'quote/case/{{caseGUID}}/estimate',\r\n  'rejected': 'quote/case/{{caseGUID}}/estimate',\r\n  'closed': 'quote/case/{{caseGUID}}/estimate',\r\n  'complete': 'quote/case/{{caseGUID}}/estimate',\r\n  'others': 'quote/case/{{caseGUID}}/estimate'\r\n}","<div class=\"page-container  mh-0 mt-0 fx-col\">\r\n    <div class=\"tab-container fx-0\">\r\n        <div class=\"main-tab-wrapper\">\r\n            <chq-tabs [mode]=\"'underline'\" #tabMain [menuItems]=\"repairMenuItems\"\r\n                (menuItemClick)=\"changeTab($event);\"></chq-tabs>\r\n            <div class=\"user-wrapper\">\r\n                <ng-container *ngIf=\"!expandUserDetail;else expanding\">\r\n                    <div class=\"user-detail-container fx-col\" *ngIf=\"showUserSection\"\r\n                        [ngClass]=\"{'expand-main-wrapper': expandUserDetail}\"\r\n                        [ngStyle]=\"{'width': expandUserDetail ? containerWidth : '' }\">\r\n                        <div class=\"user-detail-wrapper\" #userDetail>\r\n                            <div class=\"user-detail\">\r\n                                <div class=\"heading-text\">{{customerData.firstName}} {{customerData.lastName}}</div>\r\n                                <div style=\"font-weight: 500;\"><span class=\"title\">{{ 'booking_id' | translate\r\n                                        }}</span>: <b>{{ bookingId }} </b></div>\r\n                            </div>\r\n\r\n                            <div class=\"vehicle-detail\">\r\n                                <div class=\"make-status fx-row\">\r\n                                    <div class=\"fx-row align-center\" *ngIf=\"caseData?.vehicleMake\">\r\n                                        <div class=\"heading-label\">{{'make' | translate}}: </div>\r\n                                        <div class=\"heading-text\">{{ caseData.vehicleMake }} </div>\r\n                                    </div>\r\n\r\n                                    <div class=\"fx-row align-center\">\r\n                                        <div class=\"heading-label\">{{'status' | translate}}: </div>\r\n                                        <div class=\"heading-text\">{{ statusDesc }} </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class=\"fx-row\" *ngIf=\"caseData?.vehicleMake\">\r\n                                    <span style=\"font-weight: 500;\" *ngIf=\"caseData?.vehicleModel\"><span\r\n                                            class=\"title\">{{ 'model' | translate }}</span>: <b>{{ caseData.vehicleModel\r\n                                            }}</b></span>\r\n                                    <span style=\"font-weight: 500;\" *ngIf=\"caseData?.licensePlate\"><span\r\n                                            class=\"title\">{{ 'license_plate' | translate }}</span>:\r\n                                        <b>{{caseData.licensePlate}}</b></span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"arrow-drop\">\r\n                                <mat-icon [svgIcon]=\"!expandUserDetail ? 'dropdown' : 'dropdown-up'\"\r\n                                    (click)=\"expand()\"></mat-icon>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </ng-container>\r\n\r\n                <ng-template #expanding>\r\n                    <ng-container>\r\n                        <div class=\"user-detail-container fx-col\" *ngIf=\"showUserSection\"\r\n                            [ngClass]=\"{'expand-main-wrapper': expandUserDetail}\"\r\n                            [ngStyle]=\"{'width': expandUserDetail ? containerWidth : '' }\">\r\n                            <div class=\"user-detail-wrapper\" #userDetail>\r\n                                <div class=\"user-detail\">\r\n                                    <div class=\"heading-text\">{{customerData.firstName}} {{customerData.lastName}}</div>\r\n                                    <div style=\"font-weight: 500;\"><span class=\"title\">{{ 'booking_id' | translate\r\n                                            }}</span>: <b>{{ bookingId }} </b></div>\r\n                                </div>\r\n\r\n                                <div class=\"arrow-drop\">\r\n                                    <mat-icon [svgIcon]=\"!expandUserDetail ? 'dropdown' : 'dropdown-up'\"\r\n                                        (click)=\"expand()\"></mat-icon>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class=\"user-detail-expand-wrapper\" [ngClass]=\"{'expand': expandUserDetail}\">\r\n                                <div class=\"user-detail-more fx-col\">\r\n                                    <div class=\"labour-container\" (click)=\"openLabourRate()\">\r\n                                        <span>{{'labour_rate_discount' | translate}}</span>\r\n                                    </div>\r\n                                    <div class=\"vehicle-detail\">\r\n                                        <div class=\"vehicle-detail-expand fx-col\">\r\n                                            <span *ngIf=\"status\">{{ 'status' |translate }}: <b>{{ status }}</b></span>\r\n                                            <span *ngIf=\"caseData?.vehicleMake\">{{ 'make' |translate }}: <b>{{\r\n                                                    caseData.vehicleMake }}</b></span>\r\n                                            <span *ngIf=\"caseData?.year\">{{ 'year' |translate }}: <b>{{ caseData.year\r\n                                                    }}</b></span>\r\n                                            <span *ngIf=\"caseData?.vehicleModel\">{{ 'model' |translate }}: <b>{{\r\n                                                    caseData.vehicleModel }}</b></span>\r\n                                            <span *ngIf=\"caseData?.licensePlate\">{{ 'license_plate' |translate }}: <b>{{\r\n                                                    caseData.licensePlate }}</b></span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </ng-container>\r\n                </ng-template>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"tab-wrapper\">\r\n            <chq-tabs [mode]=\"'default'\" #tabs [menuItems]=\"menuItems\" (menuItemClick)=\"navigate($event);\"\r\n                *ngIf=\"activeItem === 'Booking'\"></chq-tabs>\r\n            <chq-tabs [mode]=\"'default'\" #tabs [menuItems]=\"menuRepairItems\" (menuItemClick)=\"navigate($event);\"\r\n                *ngIf=\"activeItem === 'Repair'\"></chq-tabs>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"tab-content fx-1\">\r\n        <div class=\"tab-wrapper\">\r\n            <router-outlet></router-outlet>\r\n        </div>\r\n    </div>\r\n</div>\r\n<history (toggleExpand)=\"onHistoryExpand($event)\" [history]=\"history\" [isLoading]=\"isHistoryLoading\"\r\n    *ngIf=\"repairGuid !== '0'\" serviceType=\"repair\"></history>","import { ChangeDetectorRef, Component, ElementRef, OnDestroy, OnInit, ViewChild } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BehaviorSubject, Subscription, filter } from 'rxjs';\r\nimport { ChqLabourRateComponent } from 'src/app/dialogs/labour-rate/labour-rate.component';\r\nimport { Modules, UploadStepModel } from 'src/app/model/chq-upload-model';\r\nimport { customerMenus, menuItem, menuRepairItems, repairMenus } from 'src/app/model/menu';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\nimport { InspectionService } from 'src/app/services/inspection-service/inspection.service';\r\nimport { MessagesService } from 'src/app/services/message/messages.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { ChqTabsComponent } from 'src/app/widgets/chq-tabs/chq-tabs/chq-tabs.component';\r\nimport { RepairEstimateService } from 'src/app/services/repair-estimate/repair-estimate.service';\r\nimport { MonitorService } from 'src/app/services/monitor-service/monitor.service';\r\nimport { ChqInspectionStep } from 'src/app/model/chq-inspection-step';\r\n\r\n@Component({\r\n  selector: 'app-customer-layout',\r\n  templateUrl: './customer-layout.component.html',\r\n  styleUrls: [ './customer-layout.component.scss' ],\r\n})\r\n\r\nexport class CustomerLayoutComponent implements OnInit, OnDestroy {\r\n\r\n  public activeItem: string = 'Booking';\r\n  public bookingId: string = '';\r\n  public repairGuid: string = '0';\r\n  private repairObjectId = 0;\r\n  public inspectionId: number;\r\n  private domainId: number = 3100;\r\n  public repairTypes: any = [];\r\n  public showUserSection: boolean = false;\r\n  public expandUserDetail: boolean = false;\r\n  public status: string = '';\r\n  public statusDesc: string = '';\r\n  stepInProgress: boolean = false;\r\n  currentOrganizationId: number;\r\n\r\n  private vehicleId: number = 0;\r\n  private caseId: string = '0';\r\n\r\n  private estimationOperationLength: boolean = false;\r\n\r\n  public caseData: any = {\r\n    'vehicleMake': '',\r\n    'vehicleModel': ''\r\n  }\r\n  @ViewChild('tabs') tabs: ChqTabsComponent;\r\n  @ViewChild('tabMain') tabMain: ChqTabsComponent;\r\n  @ViewChild('userDetail') userDetail!: ElementRef;\r\n\r\n  public customerData: any = {\r\n    'firstName': '',\r\n    'lastName': '',\r\n    'countryCode': '',\r\n    'mobileNumber': '',\r\n    'email': ''\r\n  }\r\n  // sample history data\r\n  history = []\r\n  private workProvider:string = '';\r\n  private isCompany:boolean = false;\r\n  isHistoryLoading = false;\r\n  subscriptions: Subscription[] = [];\r\n  private isNoShow:boolean = false;\r\n  private repairType:string = '';\r\n\r\n  private roleName: string = '';\r\n  containerWidth: string;\r\n  /**\r\n   * get current status\r\n   */\r\n  get currentStatus(): boolean {\r\n    if (this.status && [ 'draft', 'uploaddocuments', 'uploadphotos' ].indexOf(this.status?.toLowerCase()) === -1) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * constructor\r\n   * @param router\r\n   */\r\n  constructor(\r\n    private router: Router,\r\n    private caseService: CaseService,\r\n    private route: ActivatedRoute,\r\n    private commonService: CommonService,\r\n    private cdr: ChangeDetectorRef,\r\n    private inspectionService: InspectionService,\r\n    private messageService: MessagesService,\r\n    private translateService: TranslateService,\r\n    private repairEstimateService: RepairEstimateService,\r\n    private monitorService: MonitorService,\r\n    public dialog: MatDialog,\r\n  ) {\r\n    this.commonService.inProgressSteps.subscribe((length: number) => {\r\n      this.stepInProgress = length > 0;\r\n    });\r\n\r\n\r\n  }\r\n\r\n  menuItems = customerMenus;\r\n  repairMenuItems = repairMenus;\r\n  menuRepairItems = menuRepairItems;\r\n\r\n\r\n  /**\r\n   * map inspection from api\r\n   */\r\n  onHistoryExpand(event:boolean):void {\r\n    // Get latest History when history is expanded\r\n    if(event) {\r\n      this.getCaseHistory(this.repairGuid, this.domainId)\r\n    }\r\n  }\r\n  /**\r\n   * map inspection from api\r\n   * @param inspectionData\r\n   */\r\n  mapInspection(inspectionData: any, item: menuItem): void {\r\n    if (inspectionData) {\r\n      try {\r\n        const inspection = inspectionData;\r\n        if (this.commonService.repairInspectionTemplate) {\r\n          const template = this.commonService.repairInspectionTemplate\r\n          if(inspection?.uploadType) {\r\n            if (inspection?.uploadType.toLowerCase() === 'spi') {\r\n              const minimumPhotosRequired = inspection.inspectionItems?.filter((value: ChqInspectionStep) => {\r\n                return value.isSkipEnabled !== true;\r\n              }).length;\r\n              const currentPhotos = inspection.inspectionItems?.filter((currentStep) => {\r\n                return currentStep.rawAzureBlobUrl;\r\n              });\r\n              if (currentPhotos.length < minimumPhotosRequired) {\r\n                this.commonService.showToast(0, `All ${minimumPhotosRequired} sides images are mandatory and cannot skip to next section.`);\r\n                return;\r\n              }\r\n            } else {\r\n              const minimumBulkPhotosRequired = template?.minImageLimit;\r\n              const bulkUploadedItemsWithImages = inspection.inspectionItems\r\n                .filter((step) => {\r\n                  return step.rawAzureBlobUrl != null && step.rawAzureBlobUrl != '';\r\n                });\r\n              if (bulkUploadedItemsWithImages.length < minimumBulkPhotosRequired) {\r\n                this.commonService.showToast(0, `All ${minimumBulkPhotosRequired} sides images are mandatory and cannot skip to next section.`);\r\n                return;\r\n              }\r\n            }\r\n          }\r\n\r\n          const queryParam = location.search;\r\n          const url = item.url;\r\n          this.tabs?.setActiveMenu(item);\r\n          if ((queryParam.indexOf('mode=edit') !== -1)) {\r\n            this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '') ], { queryParams: { mode: 'edit' } });\r\n          } else {\r\n            this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '') ]);\r\n          }\r\n        }\r\n      } catch (error: any) {\r\n        console.log(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get Case History\r\n   */\r\n  getCaseHistory(caseId: string, domainId: number): void {\r\n    this.history = [];\r\n    this.isHistoryLoading = true;\r\n    this.caseService.getCaseHistory(caseId, domainId).subscribe({\r\n      next: (response) => {\r\n        this.history = response;\r\n      },\r\n      complete: () => {\r\n        this.isHistoryLoading = false\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * get current inspectionitems length\r\n   */\r\n  getInspectionItems(id, item: menuItem): void {\r\n    this.commonService.showLoading();\r\n    this.inspectionService.getInspection(id).subscribe({\r\n      next: (inspectionDetailResponse: any) => {\r\n        if (inspectionDetailResponse) {\r\n          this.mapInspection(inspectionDetailResponse, item);\r\n        }\r\n        this.commonService.hideLoading();\r\n      },\r\n      complete: () => {\r\n        this.commonService.hideLoading();\r\n      },\r\n    });\r\n  }\r\n\r\n  /**\r\n   * on init\r\n   */\r\n  ngOnInit(): void {\r\n    const urlSegments = this.router.url.split('/');\r\n    let lastSegment = (urlSegments.length > 0) ? urlSegments[urlSegments.length - 1] : '';\r\n\r\n    if (lastSegment.indexOf('?') != -1) {\r\n      lastSegment = lastSegment.substring(0, lastSegment.indexOf('?'));\r\n    }\r\n\r\n    const repairSegments: string[] = [ 'parts', 'invoices', 'repair-stages', 'invoicesEdit' ];\r\n\r\n    if (repairSegments.includes(lastSegment)) {\r\n      this.activeItem = 'Repair';\r\n    }\r\n\r\n    this.route?.params.subscribe((value) => {\r\n      if (value && value['id']) {\r\n        this.repairGuid = value['id'];\r\n\r\n        if (this.repairGuid !== '0') {\r\n          // Get Case History when domainId is available\r\n          const idSub$ = this.commonService.domainId.pipe(filter(value => value !== null)).subscribe({\r\n            next: (data) => {\r\n              this.getCaseHistory(this.repairGuid, data)\r\n              this.domainId = data\r\n            }\r\n          });\r\n          this.subscriptions.push(idSub$);\r\n        }\r\n\r\n      }\r\n    });\r\n\r\n    const bookingId$ = this.commonService.bookingId.subscribe({\r\n      next: (bookingId: string) => {\r\n        this.bookingId = bookingId;\r\n        this.cdr.detectChanges();\r\n      }\r\n    });\r\n\r\n    const activeItem$ = this.commonService.activeItem.subscribe({\r\n      next: (activeItem: string) => {\r\n        if (activeItem) {\r\n          this.activeItem = activeItem\r\n        }\r\n      }\r\n    });\r\n    const repairDetails$ = this.commonService.repairDetails.subscribe({\r\n      next: (repairDetails: any) => {\r\n        this.showHideTopHeader()\r\n        if (repairDetails) {\r\n          this.status = repairDetails.status;\r\n          this.statusDesc = repairDetails?.statusDescription;\r\n          this.customerData.firstName = repairDetails.customer?.firstName || '';\r\n          this.customerData.lastName = repairDetails.customer?.lastName || '';\r\n          this.customerData.mobileNumber = (repairDetails.customer?.countryCode || '') + ' ' + repairDetails.customer?.mobileNumber || '';\r\n          this.customerData.email = repairDetails.customer?.email || '';\r\n          this.workProvider = repairDetails.customer?.companyOrgType || '';\r\n          this.isCompany = repairDetails.customer?.customerTypeName !== 'Person' || false;\r\n\r\n          this.caseData.vehicleMake = repairDetails.vehicle?.vehicleMake || '';\r\n          this.caseData.vehicleModel = repairDetails.vehicle?.vehicleModel || '';\r\n          this.caseData.licensePlate = repairDetails.vehicle?.licensePlateNumber || '';\r\n          this.caseData.year = repairDetails.vehicle?.modelYearRange || '';\r\n\r\n          this.inspectionId = repairDetails.vehicle?.inspectionId;\r\n          this.repairTypes = repairDetails.repairServiceTypes;\r\n          this.repairType = repairDetails.repairType;\r\n          this.domainId = repairDetails.domainId;\r\n\r\n          if(this.currentOrganizationId != repairDetails.organizationDetail?.organizationId) {\r\n            this.commonService.isViewOnly = true;\r\n          }else{\r\n            this.commonService.isViewOnly = false;\r\n          }\r\n\r\n          const urlSegments = this.router.url.split('/');\r\n          let currentLastSegment = (urlSegments.length > 0) ? urlSegments[urlSegments.length - 1] : '';\r\n          if(currentLastSegment.includes('photos')){\r\n            if(!this.inspectionId){\r\n              this.displayMissingInspectionMessage(this.repairGuid);\r\n              return;\r\n            }\r\n          }\r\n          const queryParam = location.search;\r\n\r\n          if(currentLastSegment === 'invoices' && !queryParam.includes('isBack=true')){\r\n            const isGenerated = this.status?.toLowerCase() === 'paid' || this.status?.toLowerCase() === 'invoiced' || this.status?.toLowerCase()\r\n              === 'complete';\r\n            let type = 1;\r\n            if(isGenerated){\r\n              if(this.workProvider === 'Retail' && !this.isCompany){\r\n                type = 2;\r\n              }\r\n              this.router.navigate([ `/repair/booking/${this.repairGuid}/invoicesEdit` ], { queryParams: { formType: type } });\r\n              return;\r\n            }\r\n          }\r\n\r\n          this.vehicleId = repairDetails.vehicle?.vehicleId\r\n          this.caseId = repairDetails.quoteId;\r\n          this.domainId = repairDetails.domainId;\r\n\r\n          this.repairObjectId = repairDetails.id;\r\n          if (this.repairType?.toLowerCase() === 'assessment') {\r\n            this.repairMenuItems[1].disabled = true;\r\n          } else {\r\n            this.repairMenuItems[1].disabled = false;\r\n          }\r\n          this.isNoShow = repairDetails?.booking?.isNoShow;\r\n\r\n          if (currentLastSegment.indexOf('?') != -1) {\r\n            currentLastSegment = currentLastSegment.substring(0, currentLastSegment.indexOf('?'));\r\n          }\r\n\r\n          if(this.roleName?.toLowerCase() === 'technician' && currentLastSegment === 'invoices') {\r\n            this.router.navigate([ `/repair/booking/${this.repairGuid}/repair-stages` ]);\r\n            return;\r\n          }\r\n\r\n          const repairSegments: string[] = [ 'parts', 'invoices', 'repair-stages', 'invoicesEdit' ];\r\n          if (repairSegments.includes(currentLastSegment)) {\r\n            this.getEstimationDetail(repairDetails.estimateSource);\r\n          }\r\n\r\n          this.cdr.detectChanges();\r\n        }\r\n      }\r\n    });\r\n\r\n    const userPermission$ = this.commonService.userProfileData.subscribe((res) => {\r\n      if (res?.data) {\r\n        const automotiveServices = res?.data?.userPermission?.automotiveServices;\r\n        const automotiveService = automotiveServices?.find(x => x.automotiveServiceName.toLowerCase() === 'addenda repair');\r\n        this.roleName = automotiveService.roleName.toLowerCase();  \r\n        this.commonService.roleName = this.roleName;\r\n\r\n        if(this.roleName?.toLowerCase() == 'technician') {\r\n          this.menuRepairItems = this.menuRepairItems.filter(q=> q.name != 'Invoices')\r\n        }\r\n\r\n        const organizationDetail = res.data.organizationDetail;\r\n        if (organizationDetail) {\r\n          this.currentOrganizationId = organizationDetail.id;\r\n        }\r\n      }\r\n    });\r\n    this.subscriptions.push(bookingId$);\r\n    this.subscriptions.push(activeItem$);\r\n    this.subscriptions.push(repairDetails$);\r\n    this.subscriptions.push(userPermission$);\r\n  }\r\n\r\n  /**\r\n * estimate\r\n */\r\n  getEstimationDetail(source: string): void {\r\n    if (source === 'GTMotive') {\r\n      this.getGTEstimationDetail();\r\n    } else {\r\n      this.getManualEstimationDetail();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get estimation detail\r\n   */\r\n  getGTEstimationDetail(): void {\r\n    if (this.vehicleId && this.inspectionId) {\r\n      this.monitorService.logEvent('getGTEstimationDetail', [ 'CustomerLayoutComponent', 'addenda-repair' ], {\r\n        repairGuid: this.repairGuid,\r\n        caseGuid: this.caseId,\r\n        inspectionId: this.inspectionId,\r\n        vehicleId: this.vehicleId\r\n      });\r\n      this.commonService.showLoading();\r\n      this.repairEstimateService.getEstimate(this.caseId, this.inspectionId, this.vehicleId, this.domainId).subscribe({\r\n        next: (response) => {\r\n          if (response?.data?.estimateCharges?.length > 0) {\r\n            this.estimationOperationLength = true;\r\n          }\r\n          this.commonService.hideLoading();\r\n        },\r\n        error: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get manual estimate\r\n   */\r\n  getManualEstimationDetail(): void {\r\n    if (this.vehicleId && this.inspectionId) {\r\n      this.monitorService.logEvent('getManualEstimationDetail', [ 'EstimateComponent', 'addenda-repair' ], {\r\n        repairGuid: this.repairGuid,\r\n        inspectionId: this.inspectionId,\r\n        vehicleId: this.vehicleId\r\n      });\r\n      this.commonService.showLoading();\r\n      this.repairEstimateService.getRepairEstimate(this.repairGuid, this.inspectionId, this.vehicleId).subscribe({\r\n        next: (response) => {\r\n          if (response?.estimateCharges?.length) {\r\n            this.estimationOperationLength = true;\r\n          }\r\n\r\n          this.commonService.hideLoading();\r\n        },\r\n        error: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * navigate to selected route\r\n   * @param item\r\n   */\r\n  navigate(item: menuItem): void {\r\n    const queryParam = location.search;\r\n    const url = item.url;\r\n    const currentUrl = location.pathname;\r\n\r\n    if(url.includes('/repair-stages')){\r\n      const statusList = [ 'draft', 'uploaddocuments', 'uploadphotos', 'repairestimation', 'pendingapproval', 'rejected' ];\r\n      if(statusList.includes(this.status?.toLowerCase())){\r\n        this.commonService.hideLoading();\r\n        this.commonService.openAlertDialog(this.translateService.instant('warning'), this.translateService.instant('start_job'));\r\n        return;\r\n      }\r\n\r\n      if(this.isNoShow){\r\n        this.commonService.hideLoading();\r\n        this.commonService.openAlertDialog(this.translateService.instant('warning'), this.translateService.instant('stages_no_allowed'));\r\n        return;\r\n      }\r\n\r\n      if(this.repairType?.toLowerCase() !== 'repair'){\r\n        this.commonService.hideLoading();\r\n        this.commonService.openAlertDialog(this.translateService.instant('warning'), this.translateService.instant('stages_repair'));\r\n        return;\r\n      }\r\n\r\n    }\r\n\r\n    if (url.includes('/invoices')) {\r\n      if (!this.estimationOperationLength) {\r\n        this.commonService.openAlertDialog(this.translateService.instant('warning'), this.translateService.instant('no_charges'));\r\n        return;\r\n      }\r\n\r\n      if(this.status?.toLowerCase() === 'rejected') {\r\n        this.commonService.openAlertDialog(this.translateService.instant('warning'), this.translateService.instant('invoice_access'));\r\n        return;\r\n      }\r\n    }\r\n\r\n\r\n    if (currentUrl.includes('/document')) {\r\n      if (this.stepInProgress) {\r\n        const module = currentUrl.includes('/photos') ? 'images' : 'documents';\r\n        this.commonService.showToast(0, `Please wait until all ${module} are uploaded.`);\r\n        return;\r\n      }\r\n    }\r\n    if (currentUrl.includes('/photos')) {\r\n      if (this.stepInProgress) {\r\n        const module = currentUrl.includes('/photos') ? 'images' : 'documents';\r\n        this.commonService.showToast(0, `Please wait until all ${module} are uploaded.`);\r\n        return;\r\n      }\r\n      if(url.includes('/estimate')) {\r\n        this.getInspectionItems(this.inspectionId, item);\r\n        return;\r\n      }\r\n    }\r\n\r\n    if(url.includes('invoices')){\r\n      const isGenerated = this.status?.toLowerCase() === 'paid' || this.status?.toLowerCase() === 'invoiced' || this.status?.toLowerCase()\r\n       === 'complete';\r\n      let type = 1;\r\n      if(isGenerated){\r\n        if(this.workProvider === 'Retail' && !this.isCompany){\r\n          type = 2;\r\n        }\r\n        this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '').replace('invoices', 'invoicesEdit') ], { queryParams: { formType: type } });\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (url === '/repair/booking/{bookingId}') {\r\n      if ((queryParam.indexOf('mode=edit') !== -1)) {\r\n        this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '') ], { queryParams: { mode: 'edit' } });\r\n      } else {\r\n        this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '') ]);\r\n      }\r\n    } else if (currentUrl === '/repair/booking' || currentUrl === '/repair/booking/0' || currentUrl === `/repair/booking/${this.repairGuid}`) {\r\n      if (url === '/repair/booking/{bookingId}') {\r\n        return;\r\n      }\r\n\r\n      if(this.roleName?.toLowerCase() === 'technician' || this.status?.toLowerCase() === 'complete') {\r\n        this.commonService.viewActionTriggeredBooking.next((queryParam.indexOf('mode=edit') !== -1) ? url + queryParam : url);\r\n      } else {\r\n        this.commonService.actionTriggered.next((queryParam.indexOf('mode=edit') !== -1) ? url + queryParam : url);\r\n      }\r\n\r\n    } else {\r\n      \r\n      if(url.includes('/photos') || url.includes('/estimate')){\r\n        if(!this.inspectionId){\r\n          this.displayMissingInspectionMessage(this.repairGuid);\r\n          return;\r\n        }\r\n      }\r\n      this.tabs?.setActiveMenu(item);\r\n      if ((queryParam.indexOf('mode=edit') !== -1)) {\r\n        this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '') ], { queryParams: { mode: 'edit' } });\r\n      } else {\r\n        this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '') ]);\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  /**\r\n   * change tab\r\n   */\r\n  changeTab(item: menuItem): void {\r\n    let url = '';\r\n    const queryParam = location.search;\r\n\r\n    if (item.disabled) {\r\n      return;\r\n    }\r\n\r\n    if (item.name == 'Booking') {\r\n      url = '/repair/booking/' + this.repairGuid;\r\n      this.repairMenuItems.filter(q => q.name == 'Repair')[0].active = false;\r\n    } else {\r\n      if (!this.currentStatus) {// && !this.estimationOperationLength) {\r\n        return;\r\n      }\r\n\r\n      url = '/repair/booking/' + this.repairGuid + '/parts';\r\n      this.repairMenuItems.filter(q => q.name == 'Booking')[0].active = false;\r\n    }\r\n    item.active = true;\r\n    this.repairMenuItems = [ ...this.repairMenuItems ];\r\n\r\n    if ((queryParam.indexOf('?mode=edit') !== -1)) {\r\n      this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '') ], { queryParams: { mode: 'edit' } });\r\n    } else {\r\n      this.router.navigate([ url.replace('{bookingId}', this.repairGuid || '') ]);\r\n    }\r\n\r\n    this.activeItem = item.name;\r\n  }\r\n\r\n  /**\r\n   * show error dialog\r\n   */\r\n  displayMissingInspectionMessage(bookingId:string):void{\r\n    this.commonService.openAlertDialog('Notification', 'Please add your vehicle in order to add car images.').afterClosed().subscribe({\r\n      next: (result:boolean)=>{\r\n        if(result){\r\n          this.router.navigate([ `repair/booking/${bookingId}` ]);\r\n        }\r\n      },\r\n      error: ()=>{\r\n        this.commonService.hideLoading();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * expand user -detail\r\n  */\r\n  expand(): void {\r\n    this.containerWidth = `${this.userDetail.nativeElement.offsetWidth}px` ;\r\n    this.expandUserDetail = !this.expandUserDetail;\r\n  }\r\n\r\n  /**\r\n   * Show Hide User section based on active menu item\r\n   */\r\n  showHideTopHeader(): void {\r\n    if (this.repairGuid && this.repairGuid != '0') {\r\n      this.showUserSection = true\r\n    } else {\r\n      this.showUserSection = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * open labour rate popup\r\n   */\r\n  openLabourRate(): void {\r\n    this.monitorService.logEvent('openLabourRate', [ 'CustomerLayoutComponent', 'addenda-repair' ]);\r\n    let dialogRef = this.dialog.open(ChqLabourRateComponent, {\r\n      data:\r\n        { 'repairId': this.repairGuid, 'from': Modules.repair },\r\n      autoFocus: false\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result: any) => {\r\n      dialogRef = null;\r\n      if(result) {\r\n        this.commonService.labourData.next(result);\r\n        this.commonService.isRefreshRepairEstimateDetails.next(true)\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * on destroy\r\n   */\r\n  ngOnDestroy(): void {\r\n    this.monitorService.logEvent('ngOnDestroy', [ 'CustomerLayoutComponent', 'addenda-repair', {\r\n      repairId: this.repairGuid\r\n    } ]);\r\n    if (this.subscriptions) this.subscriptions.forEach((subscription: Subscription) => subscription.unsubscribe());\r\n    this.commonService.activeItem.next(null);\r\n    this.commonService.repairDetails.next(null);\r\n    this.commonService.isViewOnly = false;\r\n  }\r\n}\r\n","<div class=\"calendar-header-container\" [ngClass]=\"{'margin-right':isiOS }\">\r\n    <div class=\"filter\">\r\n        <chq-button [buttonModel]=\"newBookingButton\" (click)=\"newBooking()\"\r\n            *chqPermission=\"'bookingJournal'\"></chq-button>\r\n        <chq-button [buttonModel]=\"draftButton\" (click)=\"openDraftCustomer()\"></chq-button>\r\n        <chq-button [buttonModel]=\"filterButton\" (click)=\"openFilter()\"></chq-button>\r\n    </div>\r\n\r\n    <p class=\"total\">\r\n        <span><span>E</span><b>{{totalEstimate |\r\n                xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}</b> {{'total_estimated' |\r\n            translate}}</span>\r\n        <span><span>L</span><b>{{totalLabour |\r\n                xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}</b> {{'total_labour' |\r\n            translate}}</span>\r\n        <span><span class=\"has-background\">{{ totalBooking }}</span>\r\n            <ng-container *ngIf=\"totalBooking === 1; else elseTemplate\">\r\n                {{ 'no_of_booking' | translate }}\r\n            </ng-container>\r\n            <ng-template #elseTemplate>\r\n                {{ 'no_of_bookings' | translate }}\r\n            </ng-template>\r\n        </span>\r\n    </p>\r\n</div>\r\n\r\n<div class=\"booking-calendar mh-0\" [ngClass]=\"{'margin-right':isiOS }\">\r\n    <!-- [ngClass]=\"{'mt-0': windowInnerWidth >= 1200}\" -->\r\n    <!-- [height]=\"'calc(100vh - (5px + 0.8vw + 5px + 1.5vw + 48px + 66px))'\" -->\r\n    <dx-scheduler *ngIf=\"showCalendar\" [width]='calendarWidth' [height]=\"calendarHeight\" [editing]=\"true\"\r\n        [dataSource]=\"calendarData\" [views]=\"['day', 'week', 'month']\" [currentView]=\"currentView\"\r\n        [adaptivityEnabled]=\"isSmallScreen\" startDateExpr=\"StartDate\" endDateExpr=\"EndDate\" [firstDayOfWeek]=\"1\"\r\n        [startDayHour]=\"0\" [endDayHour]=\"24\" [currentDate]=\"currentDate\" [cellDuration]=\"30\"\r\n        [useDropDownViewSwitcher]=\"false\" [crossScrollingEnabled]=\"true\" dateCellTemplate=\"dateCellTemplate\"\r\n        timeCellTemplate=\"timeCellTemplate\" dataCellTemplate=\"dataCellTemplate\"\r\n        appointmentTemplate=\"appointment-template\" appointmentTooltipTemplate=\"appointment-tooltip-template\"\r\n        [showCurrentTimeIndicator]=\"true\" (onAppointmentFormOpening)=\"onAppointmentFormOpening($event)\"\r\n        (onAppointmentUpdating)=\"onAppointmentUpdating($event)\" (onAppointmentUpdated)=\"onAppointmentUpdated($event)\"\r\n        (onAppointmentClick)=\"onAppointmentClick($event)\" (onAppointmentDblClick)=\"onAppointmentDblClick($event)\"\r\n        (onOptionChanged)=\"onOptionChanged($event)\" (onCellClick)=\"onCellClick($event)\"\r\n        [maxAppointmentsPerCell]=\"maxAppointmentsPerCell\">\r\n\r\n        <div *dxTemplate=\"let dataCell of 'dataCellTemplate'\"\r\n            [ngClass]=\"{'disable-date' : disabledDate[dataCell.startDate.toDateString()],'weekend' : weekendDate[dataCell.startDate.toDateString()], 'readonly': isReadOnlyPermission,'dinner': lunchTime[dataCell.startDate.toString()]}\">\r\n            {{ currentView === 'month' ? dataCell.startDate.getDate() : \"\" }}\r\n\r\n        </div>\r\n\r\n        <div *dxTemplate=\"let dateCell of 'dateCellTemplate'\"\r\n            [ngClass]=\"{ 'disable-date': disabledDate[dateCell.date.toDateString()] }\">\r\n            <p *ngIf=\"currentView !== 'month'\" class=\"calendar-header header-info\"\r\n                [ngClass]=\"{'flex-column': getDateText(dateCell.date).length > 105}\"\r\n                [innerHtml]=\"getDateText(dateCell.date)\"></p>\r\n            <p *ngIf=\"currentView !== 'month'\" class=\"calendar-header date-info\">\r\n                {{ dateCell.date | date: 'd EEE' }}\r\n            </p>\r\n            <p *ngIf=\"currentView === 'month'\" class=\"calendar-header date-info\">\r\n                {{ dateCell.text }}\r\n            </p>\r\n        </div>\r\n\r\n        <div *dxTemplate=\"let timeCell of 'timeCellTemplate'\">\r\n            <!-- [ngClass]=\"{ dinner: timeCell.date.getHours() >= lunchTime.from && timeCell.date.getHours() < lunchTime.to }\" -->\r\n            {{ timeCell.text ? (timeCell.date | date:'HH:mm') : '' }}\r\n        </div>\r\n\r\n        <div *dxTemplate=\"let model of 'appointment-template'\">\r\n            <div class='template-wrap' [style.background]=\"model.targetedAppointmentData.Color\">\r\n                <div class=\"template-content-wrap\">\r\n                    <div class=\"subject\">\r\n                        <span>{{model.targetedAppointmentData.Customer?.FirstName}}\r\n                            {{model.targetedAppointmentData.Customer?.LastName}}</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div *dxTemplate=\"let model of 'appointment-tooltip-template'\">\r\n            <div class='tooltip-template-wrap'\r\n                [style.border-left]=\"'12px solid ' + model.targetedAppointmentData.Color\">\r\n                <div class=\"tooltip-content-wrap\">\r\n                    <div class=\"subject\">\r\n                        <span>{{model.targetedAppointmentData.Customer?.FirstName}}\r\n                            {{model.targetedAppointmentData.Customer?.LastName}}</span>\r\n                    </div>\r\n                    <div class=\"booking-detail\">\r\n                        <div class=\"assigned\">Work Provider:\r\n                            {{model.targetedAppointmentData.WorkProviderDto?.CompanyName}}\r\n                        </div>\r\n                        <div class=\"status\">Status: {{model.targetedAppointmentData.DisplayStatus}}</div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"context-menu\">\r\n                    <button (click)=\"handleContextMenu('preview', $event, model.targetedAppointmentData)\">\r\n                        <mat-icon [svgIcon]=\"'show'\" color=\"black\"></mat-icon>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <dxo-appointment-dragging [group]=\"'customer'\" [onAdd]=\"onAppointmentAdd\">\r\n        </dxo-appointment-dragging>\r\n\r\n        <dxo-scrolling mode=\"virtual\"> </dxo-scrolling>\r\n    </dx-scheduler>\r\n</div>\r\n\r\n<mat-sidenav-container [hasBackdrop]=\"true\">\r\n    <mat-sidenav #filter [mode]=\"'over'\" [position]=\"'end'\" class=\"filter-sidenav\">\r\n        <div class=\"filter-container\">\r\n            <div class=\"header\">\r\n                <div class=\"title\">\r\n                    {{ 'filters' | translate }}\r\n                </div>\r\n                <div class=\"action\">\r\n                    <button (click)=\"filter.toggle()\">\r\n                        <mat-icon [svgIcon]=\"'cross'\" color=\"white\"></mat-icon>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <form class=\"form-container\" [formGroup]=\"filterForm\">\r\n                \r\n                <div class=\"row\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input [inputModel]=\"filterModal[1]\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n                <hr class=\"no-line\">\r\n                <div class=\"row custom-checkbox\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input\r\n                            [ngClass]=\"{ 'two-per-row': (filterModal[0].options.length < 3 || filterModal[0].options[2]?.label.length > 12) }\"\r\n                            [inputModel]=\"filterModal[0]\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n                <hr class=\"no-line\" *ngIf=\"filterModal[0].options.length > 0\">\r\n                <div class=\"row custom-checkbox\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input class=\"two-per-row\" [inputModel]=\"filterModal[2]\"\r\n                            (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n                <hr *ngIf=\"filterModal[3].options.length > 0\">\r\n                <div class=\"row custom-checkbox\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input class=\"two-per-row\" [inputModel]=\"filterModal[3]\"\r\n                            (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n                <hr class=\"no-line\" *ngIf=\"showProviderChild\">\r\n                <div class=\"row\" *ngIf=\"showProviderChild\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input [inputModel]=\"filterModal[7]\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n                <hr class=\"no-line\"\r\n                    *ngIf=\"filterForm.get('WorkProviderDto').value && filterForm.get('WorkProviderDto').value.length > 0\">\r\n                <div class=\"row\"\r\n                    *ngIf=\"filterForm.get('WorkProviderDto').value && filterForm.get('WorkProviderDto').value.length > 0\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input [inputModel]=\"filterModal[4]\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n                <hr *ngIf=\"filterModal[5].options.length > 0\">\r\n                <div *ngIf=\"filterModal[5].options.length > 0\" class=\"row\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input [inputModel]=\"filterModal[5]\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n                <hr *ngIf=\"filterModal[6].options.length > 0\">\r\n                <div class=\"row custom-checkbox\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input class=\"two-per-row\" [inputModel]=\"filterModal[6]\"\r\n                            (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n            <div class=\"footer\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-6\">\r\n                        <chq-button [buttonModel]=\"applyButton\" (click)=\"applyFilter()\"></chq-button>\r\n                    </div>\r\n                    <div class=\"col-6\">\r\n                        <chq-button [buttonModel]=\"resetButton\" (click)=\"resetFilter()\"></chq-button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </mat-sidenav>\r\n</mat-sidenav-container>\r\n\r\n<mat-sidenav-container class=\"draft-sidenav-container\" [hasBackdrop]=\"false\">\r\n    <mat-sidenav #draftcustomer [mode]=\"'over'\" [position]=\"'end'\" class=\"draft-sidenav\">\r\n        <div class=\"draft-container\">\r\n            <div class=\"header\">\r\n                <div class=\"title\">\r\n                    {{ 'draft_customers' | translate }}\r\n                </div>\r\n                <div class=\"action\">\r\n                    <button (click)=\"draftClose()\">\r\n                        <mat-icon [svgIcon]=\"'cross'\" color=\"white\"></mat-icon>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <div *ngIf=\"!draftData || draftData.length === 0\" class=\"no-data-wrapper\">\r\n                <div class=\"no-data-content\">\r\n                    <img src=\"assets/img/no-data.png\" alt=\"\">\r\n                    <span>{{'no_result_found' | translate}}</span>\r\n                    <span>{{'could_not_find_any_data' | translate}}.</span>\r\n                </div>\r\n            </div>\r\n\r\n            <dx-draggable class=\"item dx-card dx-theme-text-color dx-theme-background-color\" [clone]=\"true\"\r\n                handle=\".draggable\" [group]=\"'customer'\" [data]=\"customer\" (onDragStart)=\"onItemDragStart($event)\"\r\n                (onDragEnd)=\"onItemDragEnd($event)\" *ngFor=\"let customer of draftData\">\r\n                <div class='draft-wrap'>\r\n                    <mat-icon [svgIcon]=\"'list'\" color=\"light-gray\" class=\"draggable\"></mat-icon>\r\n                    <div class=\"draft-content-wrap\">\r\n                        <div class=\"subject\">\r\n                            <span>\r\n                                {{customer.firstName}}\r\n                                {{customer.lastName}}\r\n                            </span>\r\n                        </div>\r\n                        <div class=\"booking-detail\">\r\n                            <span class=\"value\">\r\n                                {{customer.createdDate | date:'dd/MM/yyyy hh:mm:ss'}}\r\n                            </span>\r\n                            <span *ngIf=\"customer.statusClass === 'RepairEstimation'\">\r\n                                License Plate: <span class=\"value\">{{customer.licensePlateNumber}}</span>\r\n                            </span>\r\n                            <span *ngIf=\"customer.statusClass === 'RepairEstimation'\">\r\n                                Amount:\r\n                                <span class=\"value\">\r\n                                    {{customer.cost |\r\n                                    xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}\r\n                                </span>\r\n                            </span>\r\n                        </div>\r\n                        <div class=\"status {{customer.statusClass}}\">\r\n                            <span>\r\n                                {{customer.status}}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"draft-action-menu\">\r\n                        <a [ngClass]=\"{'disabled': !hasQuotePermission && customer.draftCustomerType === 'Quote'}\"\r\n                            [routerLink]=\"[customer.url]\">\r\n                            <mat-icon [svgIcon]=\"'show'\" color=\"black\"></mat-icon>\r\n                        </a>\r\n                        <a *chqPermission=\"'bookingJournal'\" (click)=\"handleDraftAction('delete', $event, customer)\">\r\n                            <mat-icon [svgIcon]=\"'trash'\" color=\"red\"></mat-icon>\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </dx-draggable>\r\n        </div>\r\n    </mat-sidenav>\r\n</mat-sidenav-container>\r\n\r\n<div class=\"footer-full-wrapper\">\r\n    <div class=\"footer-image-wrapper\">\r\n        <div class=\"image-wrapper\">\r\n            <img src=\"assets/img/addenda-repair.png\" />\r\n        </div>\r\n    </div>\r\n</div>","import { DatePipe } from '@angular/common';\r\nimport { AfterViewInit, ChangeDetectorRef, Component, HostListener, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder } from '@angular/forms';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { MatSidenav } from '@angular/material/sidenav';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport * as dayjs from 'dayjs';\r\nimport * as tz from 'dayjs/plugin/timezone';\r\nimport * as utc from 'dayjs/plugin/utc';\r\nimport { DxSchedulerComponent } from 'devextreme-angular';\r\nimport { locale } from 'devextreme/localization';\r\nimport { Observable, forkJoin, map, of } from 'rxjs';\r\nimport { catchError } from 'rxjs/operators';\r\nimport { CaseStatusMapper, RepairStatusMapper } from 'src/app/config/route-mapper/repair-status-mapper';\r\nimport { XaCurrencyPipe } from 'src/app/helper/pipe/xa-currency/xa-currency.pipe';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { ChqWidgetsInputModel, IControlValue } from 'src/app/model/chq-widgets-input-model';\r\nimport { BookingService } from 'src/app/services/booking/booking.service';\r\nimport { CalendarService, } from 'src/app/services/calendar/calendar.service';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\nimport { BookingPreviewComponent } from '../booking-preview/booking-preview.component';\r\ndayjs.extend(utc);\r\ndayjs.extend(tz);\r\n\r\nlocale('en');\r\n\r\n@Component({\r\n  selector: 'chr-booking-journal',\r\n  templateUrl: './booking-journal.component.html',\r\n  styleUrls: [ './booking-journal.component.scss' ],\r\n  providers: [ CalendarService ]\r\n})\r\nexport class BookingJournalComponent implements AfterViewInit, OnInit {\r\n\r\n  currentDate: Date = new Date();\r\n  startHour: number = 0;\r\n  endHour: number = 24;\r\n\r\n  public filterButton: ChqWidgetsButtonModel = {\r\n    label: 'filter',\r\n    type: 'outline',\r\n    icon: 'filter'\r\n  }\r\n\r\n  public draftButton: ChqWidgetsButtonModel = {\r\n    label: 'draft_customer',\r\n    type: 'outline',\r\n    icon: 'person-add'\r\n  }\r\n\r\n  public newBookingButton: ChqWidgetsButtonModel = {\r\n    label: 'new_booking',\r\n    type: 'primary',\r\n    icon: 'plus'\r\n  }\r\n\r\n  public applyButton: ChqWidgetsButtonModel = {\r\n    label: 'apply',\r\n    type: 'primary'\r\n  }\r\n\r\n  public resetButton: ChqWidgetsButtonModel = {\r\n    label: 'reset_all',\r\n    type: 'outline'\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @returns \r\n   */\r\n  get isiOS(): boolean {\r\n    return false;\r\n    return [\r\n      'iPad Simulator',\r\n      'iPhone Simulator',\r\n      'iPod Simulator',\r\n      'iPad',\r\n      'iPhone',\r\n      'iPod'\r\n    ].includes(navigator.platform)\r\n      // iPad on iOS 13 detection\r\n      || (navigator.userAgent.includes('Mac') && 'ontouchend' in document)\r\n  }\r\n\r\n  public calendarData: any[] = [];\r\n  public draftData: any[] = [];\r\n  @ViewChild(DxSchedulerComponent, { static: false }) scheduler: DxSchedulerComponent;\r\n  @ViewChild('filter') public filter: MatSidenav;\r\n  @ViewChild('draftcustomer') public draftCustomer: MatSidenav;\r\n  currentView = localStorage.getItem('currentView') || 'week'\r\n  calendarWidth = '100%';\r\n  defaultHeight = 'calc(100vh - (5px + 0.8vw + 5px + 1.5vw + 50px))';\r\n  calendarHeight = this.currentView === 'month' ? '100%' : this.defaultHeight;\r\n  // calc(((((100vh - (50px + 2 * (5px + 0.8vw))) - (5px + 1.5vw)) - 1.5vw) - 90px))\r\n  public filterForm = this.formBuilder.group({\r\n    TypeName: [],\r\n    Booking: [],\r\n    WorkProviderDto: [],\r\n    WorkProviderName: [],\r\n    CustomerName: [],\r\n    OrgName: '',\r\n    Assignees: [],\r\n    RepairType: []\r\n  });\r\n\r\n  filterModal: ChqWidgetsInputModel[] = [\r\n    {\r\n      placeHolder: 'booking_type',\r\n      name: 'TypeName',\r\n      label: 'booking_type',\r\n      value: '',\r\n      type: 'checkbox',\r\n      options: []\r\n    },\r\n    {\r\n      placeHolder: 'select_organization',\r\n      label: 'organization',\r\n      name: 'OrgName',\r\n      value: '',\r\n      type: 'select',\r\n      displayValue: 'label',\r\n      fieldValue: 'value',\r\n      options: [],\r\n      isMultiSelect: false\r\n    },\r\n    {\r\n      placeHolder: 'booking',\r\n      name: 'Booking',\r\n      label: 'booking',\r\n      value: '',\r\n      type: 'checkbox',\r\n      options: [\r\n        { label: 'Start Date', value: 'bookingIn', checked: false },\r\n        { label: 'End Date', value: 'bookingOut', checked: false }\r\n      ]\r\n    },\r\n    {\r\n      placeHolder: 'work_provider',\r\n      name: 'WorkProviderDto',\r\n      label: 'work_provider',\r\n      value: '',\r\n      type: 'checkbox',\r\n      options: []\r\n    },\r\n    {\r\n      placeHolder: 'driver_name',\r\n      name: 'CustomerName',\r\n      label: 'driver_name',\r\n      value: '',\r\n      type: 'select',\r\n      displayValue: 'label',\r\n      fieldValue: 'value',\r\n      options: [],\r\n      isMultiSelect: true\r\n    },\r\n    {\r\n      placeHolder: 'assigned_to',\r\n      label: 'assigned_to',\r\n      name: 'Assignees',\r\n      value: '',\r\n      type: 'select',\r\n      displayValue: 'label',\r\n      fieldValue: 'value',\r\n      options: [],\r\n      isMultiSelect: true\r\n    },\r\n    {\r\n      placeHolder: 'repair_type',\r\n      name: 'RepairType',\r\n      label: 'repair_type',\r\n      value: '',\r\n      type: 'checkbox',\r\n      options: []\r\n    },\r\n    {\r\n      placeHolder: 'work_provider_name',\r\n      name: 'WorkProviderName',\r\n      label: 'work_provider_name',\r\n      value: '',\r\n      type: 'select',\r\n      displayValue: 'label',\r\n      fieldValue: 'value',\r\n      options: [],\r\n      isMultiSelect: true\r\n    },\r\n  ];\r\n  filterDataLoaded: boolean = false;\r\n  draftDataLoaded: boolean = false;\r\n  isFromCalendar = false;\r\n  calendarCurrentStartDate = null;\r\n  calendarCurrentEndDate = null;\r\n\r\n  isSmallScreen = false;\r\n  isTouchScreen = false;\r\n\r\n  maxAppointmentsPerCell = 2;\r\n\r\n  /**\r\n   * detect change in windows resize\r\n   */\r\n  @HostListener('window:resize', [ '$event' ])\r\n  getScreenSize(): void {\r\n    this.windowInnerWidth = window.innerWidth;\r\n\r\n    if (window.innerWidth < 1024) {\r\n      this.maxAppointmentsPerCell = 1;\r\n    } else {\r\n      this.maxAppointmentsPerCell = 2;\r\n    }\r\n\r\n    if (window.innerWidth < 500) {\r\n      this.isSmallScreen = true;\r\n      this.maxAppointmentsPerCell = 0;\r\n    }\r\n\r\n    this.scheduler?.instance.getDataSource().reload();\r\n  }\r\n\r\n  public userDetail;\r\n  public userIsBM = false;\r\n\r\n\r\n  i18n = this.commonService.geti18nInfo();\r\n\r\n  public isReadOnlyPermission: boolean = true;\r\n\r\n  /**\r\n   * Constructor\r\n   */\r\n  constructor(\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private formBuilder: FormBuilder,\r\n    public dialog: MatDialog,\r\n    private calendarService: CalendarService,\r\n    private commonService: CommonService,\r\n    private datePipe: DatePipe,\r\n    private cdr: ChangeDetectorRef,\r\n    private bookingService: BookingService,\r\n    private caseService: CaseService,\r\n    private xaCurrencyPipe: XaCurrencyPipe,\r\n    private translateService: TranslateService\r\n  ) {\r\n    this.onAppointmentAdd = this.onAppointmentAdd.bind(this);\r\n    this.getScreenSize();\r\n\r\n    this.isTouchScreen = ('ontouchstart' in window) ||\r\n      (navigator.maxTouchPoints > 0) ||\r\n      (navigator.maxTouchPoints > 0);\r\n\r\n  }\r\n\r\n  showCalendar = true;\r\n  hasQuotePermission = false;\r\n  windowInnerWidth = 0;\r\n\r\n  /**\r\n   * on init\r\n   */\r\n  ngOnInit(): void {\r\n\r\n    this.windowInnerWidth = window.innerWidth;\r\n\r\n    this.commonService.userProfileData.subscribe((res) => {\r\n      this.userDetail = res?.data;\r\n      const automotiveServices = res?.data?.userPermission?.automotiveServices;\r\n      this.hasQuotePermission = automotiveServices?.some(x => x.automotiveServiceName === 'Carheal Quote');\r\n      this.userIsBM = this.userDetail?.roleDetail.some(x => x.name == 'Bodyshop Manager');\r\n\r\n      if (this.userDetail?.organizationDetail?.id) {\r\n        this.filterForm.get('OrgName').setValue(this.userDetail?.organizationDetail.id);\r\n      }\r\n\r\n      const automotiveService = automotiveServices?.find(x => x.automotiveServiceName.toLowerCase() === 'addenda repair');\r\n      if (automotiveService && this.noPermissionRoles['bookingJournal'].includes(automotiveService.roleName.toLowerCase())) {\r\n        this.isReadOnlyPermission = false;\r\n      } else {\r\n        this.isReadOnlyPermission = true;\r\n      }\r\n    })\r\n\r\n    this.route.queryParams.subscribe((params) => {\r\n      if (params['bookInDate']) {\r\n        this.currentDate = new Date(params['bookInDate']);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n* function\r\n*/\r\n  ngAfterViewInit(): void {\r\n    this.getCalendarData(this.generateFilterQuery());\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n\r\n  /**\r\n   * Check and pull draft customer data\r\n   */\r\n  openDraftCustomer(): void {\r\n    if (this.draftDataLoaded) {\r\n      this.showDraftCustomer();\r\n    } else {\r\n      this.commonService.showLoading();\r\n      this.calendarService.getDraftCustomer()?.subscribe({\r\n        next: (result) => {\r\n          this.draftData = result.data\r\n            // .filter(x => !this.bookingIdList.some(y => y === x.bookingGuid))\r\n            .map(\r\n              ((x) => {\r\n                const statusTrimmed = x.status?.replace(/\\s/g, '');\r\n                let routeToRedirect = '/';\r\n                if (x.draftCustomerType === 'Repair') {\r\n                  routeToRedirect += RepairStatusMapper[statusTrimmed?.toLowerCase()] || RepairStatusMapper.others;\r\n                  routeToRedirect = routeToRedirect.replace('{{repairGUID}}', x.repairGuid)\r\n                } else if (x.draftCustomerType === 'Quote') {\r\n                  routeToRedirect += CaseStatusMapper[statusTrimmed?.toLowerCase()] || CaseStatusMapper.others;\r\n                  routeToRedirect = routeToRedirect.replace('{{caseGUID}}', x.caseGuid)\r\n                }\r\n                return {\r\n                  ...x,\r\n                  url: routeToRedirect,\r\n                  statusClass: statusTrimmed\r\n                }\r\n              }))\r\n            .sort(function (a, b) {\r\n              return new Date(b.createdDate).getTime() - new Date(a.createdDate).getTime();\r\n            });\r\n          this.commonService.hideLoading();\r\n          this.draftDataLoaded = true;\r\n          this.showDraftCustomer();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * open draft customer panel\r\n   */\r\n  showDraftCustomer(open = true): void {\r\n    if (open) {\r\n      this.draftCustomer.open();\r\n    }\r\n\r\n    this.calendarWidth = (window.innerWidth - 400) + 'px';\r\n    this.calendarHeight = this.defaultHeight;\r\n\r\n    this.showCalendar = false;\r\n    setTimeout(() => {\r\n      this.showCalendar = true;\r\n      setTimeout(() => {\r\n        this.scrollToCurrentTime();\r\n      }, 0);\r\n    }, 0);\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * Check if user is bm , then call api otherwise return observable\r\n   */\r\n  getOrgIfBM(): Observable<any> {\r\n    if (this.userIsBM) {\r\n      return this.caseService.getOrganizations()\r\n    } else {\r\n      return of(null);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * pull data and open filter panel\r\n   */\r\n  openFilter(): void {\r\n    if (this.filterDataLoaded) {\r\n      this.filter.toggle();\r\n    } else {\r\n      this.commonService.showLoading();\r\n\r\n      forkJoin([\r\n        this.bookingService.getBookingRepairTypes(`?orgIds=${this.userDetail?.organizationDetail.id}`),\r\n        this.getOrgIfBM(),\r\n        this.caseService.getProvidersByOrgId(`?orgIds=${this.userDetail?.organizationDetail.id}`),\r\n        this.caseService.getCaseUsers(`?orgId=${this.userDetail?.organizationDetail.id}`)\r\n      ]\r\n      ).pipe(\r\n        map(([ bookingRepairType, orgList, workProvider, employeeList ]) => {\r\n          return { bookingRepairType, orgList, workProvider, employeeList };\r\n        })\r\n      ).subscribe((result) => {\r\n        this.filterModal[0].options = result.bookingRepairType.data.BookingTypes.map((x) => { return { label: x.name, value: x.name } });\r\n\r\n        if (this.userIsBM) {\r\n          this.filterModal[1] =\r\n          {\r\n            ...this.filterModal[1],\r\n            selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n            options: result.orgList.data.map((x) => { return { label: x.name, value: x.id } })\r\n          };\r\n        } else {\r\n          this.filterModal[1] =\r\n          {\r\n            ...this.filterModal[1],\r\n            selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n            options: [ { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id } ],\r\n            disabled: true\r\n          };\r\n        }\r\n\r\n        this.filterModal[3].options = result.workProvider.data.map((x) => { return { label: x, value: x } });\r\n        this.filterModal[5] =\r\n        {\r\n          ...this.filterModal[5],\r\n          options: result.employeeList.data.map((x) => { return { label: x.name, value: x.id } })\r\n        };\r\n        if (result.bookingRepairType.data.RepairType && result.bookingRepairType.data.RepairType.length > 0) {\r\n          this.filterModal[6].options = result.bookingRepairType.data.RepairType[0].RepairTypes.map((x) => {\r\n            return { label: x.name, value: x.id, icon: this.getRepairTpeIcon(x.name) }\r\n          });\r\n        }\r\n\r\n        this.filter.toggle();\r\n        this.commonService.hideLoading();\r\n        this.filterDataLoaded = true;\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n * getRepairTpeIcon\r\n */\r\n  getRepairTpeIcon(name): string {\r\n    const iconMapper = {\r\n      Body: 'car',\r\n      Maintenance: 'house',\r\n      Paint: 'paint',\r\n      Tires: 'tire',\r\n      Electric: 'bolt-car',\r\n      Electrical: 'bolt-car',\r\n      Mechanical: 'mechanical',\r\n      Diagnosis: 'diagnosis',\r\n      Others: 'gears'\r\n    };\r\n    return iconMapper[name];\r\n  }\r\n\r\n  /**\r\n* getDisplayStatus\r\n*/\r\n  getDisplayStatus(status): string {\r\n    const statusMapper =\r\n    {\r\n      draft: 'Draft',\r\n      vehicledetails: 'Vehicle Details',\r\n      uploaddocuments: 'Upload Documents',\r\n      uploadphotos: 'Upload Photos',\r\n      repairestimation: 'Repair Estimation',\r\n      pendingapproval: 'Pending Approval',\r\n      approved: 'Approved',\r\n      reject: 'Reject',\r\n      rejected: 'Rejected',\r\n      closed: 'Closed',\r\n      complete: 'Complete',\r\n      partsorderedpartially: 'Parts Ordered Partially',\r\n      partsordered: 'Parts Ordered',\r\n      repairinprogress: 'Repair In Progress',\r\n      readytoinvoice: 'Ready To Invoice',\r\n      invoiceready: 'Invoice Ready',\r\n      invoiced: 'Invoiced',\r\n      paid: 'Paid',\r\n      others: 'Others'\r\n    }\r\n    return statusMapper[status.replace(/\\s/g, '').toLowerCase()] || status;\r\n  }\r\n\r\n  public lunchTime = {};\r\n\r\n  /**\r\n  * function\r\n  */\r\n  refreshCalendarData(): void {\r\n    this.calendarData = [];\r\n    this.getCalendarData(this.generateFilterQuery());\r\n  }\r\n\r\n  /**\r\n  * function\r\n  */\r\n  generateFilterQuery(): string {\r\n\r\n    this.calendarCurrentStartDate = this.calendarCurrentStartDate\r\n      || new Date(this.scheduler.instance.getStartViewDate().toDateString()).toISOString();\r\n    this.calendarCurrentEndDate = this.calendarCurrentEndDate\r\n      || new Date(new Date(this.scheduler.instance.getEndViewDate().toDateString()).getTime() + 1000 * 60 * 60 * 24 - 1000).toISOString();\r\n\r\n    let startDate = this.calendarCurrentStartDate;\r\n    let endDate = this.calendarCurrentEndDate;\r\n    if (this.isFromCalendar) {\r\n      startDate = new Date(this.scheduler.instance.getStartViewDate().toDateString()).toISOString();\r\n      endDate = new Date(new Date(this.scheduler.instance.getEndViewDate().toDateString()).getTime() + 1000 * 60 * 60 * 24 - 1000).toISOString();\r\n\r\n      this.calendarCurrentStartDate = startDate;\r\n      this.calendarCurrentEndDate = endDate;\r\n      this.isFromCalendar = false;\r\n    }\r\n\r\n    const filterValue = this.filterForm.value;\r\n    let query = `?$filter=((StartDate ge ${startDate} and StartDate le ${endDate}) or (EndDate ge ${startDate} and EndDate le ${endDate}) or (StartDate le ${startDate} and EndDate ge ${endDate}))`;\r\n\r\n    if (filterValue['Booking']) {\r\n      if (filterValue['Booking'].includes('bookingIn') && filterValue['Booking'].includes('bookingOut')) {\r\n        query = `?$filter=((StartDate ge ${startDate} and StartDate le ${endDate}) and (EndDate ge ${startDate} and EndDate le ${endDate}))`;\r\n      } else if (filterValue['Booking'].includes('bookingIn')) {\r\n        query = `?$filter=((StartDate ge ${startDate} and StartDate le ${endDate}))`;\r\n      } else if (filterValue['Booking'].includes('bookingOut')) {\r\n        query = `?$filter=((EndDate ge ${startDate} and EndDate le ${endDate}))`;\r\n      }\r\n    }\r\n\r\n    Object.keys(filterValue).forEach((key) => {\r\n      switch (key) {\r\n      case 'OrgName':\r\n        if (filterValue[key]) {\r\n          query += ` and (OrgId eq ${filterValue[key]})`;\r\n        }\r\n        break;\r\n      case 'TypeName':\r\n        if (filterValue[key] && filterValue[key].length > 0) {\r\n          query += ` and (${filterValue[key].map(x => key + ' eq \\'' + x + '\\'').join(' or ')})`;\r\n        }\r\n        break;\r\n      case 'WorkProviderDto':\r\n        if (filterValue[key] && filterValue[key].length > 0) {\r\n          query += ` and (${filterValue[key].map(x => 'WorkProviderDto/CompanyOrgType eq \\'' + x + '\\'').join(' or ')})`;\r\n        }\r\n        break;\r\n      case 'WorkProviderName':\r\n        if (filterValue[key] && filterValue[key].length > 0) {\r\n          query += ` and (${filterValue[key].map(x => 'WorkProviderDto/CompanyName eq \\'' + x + '\\'').join(' or ')})`;\r\n        }\r\n        break;\r\n      case 'CustomerName':\r\n        if (filterValue[key] && filterValue[key].length > 0) {\r\n          query += ` and (${filterValue[key].map(x => 'Customer/Email eq \\'' + x + '\\'').join(' or ')})`;\r\n        }\r\n        break;\r\n      case 'Assignees':\r\n        if (filterValue[key] && filterValue[key].length > 0) {\r\n          const partialQuery = `${filterValue[key].map(x => 'c/AssigneeId eq ' + x).join(' or ')}`;\r\n          query += ` and Assignees/any(c: (${partialQuery}))`;\r\n        }\r\n        break;\r\n      case 'RepairType':\r\n        if (filterValue[key] && filterValue[key].length > 0) {\r\n          const partialQuery = `${filterValue[key].map(x => 'c/RepairServiceTypeId eq ' + x).join(' or ')}`;\r\n          query += ` and RepairServiceTypes/any(c: (${partialQuery}))`;\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n      }\r\n    });\r\n\r\n    return query + '&$count=true';\r\n  }\r\n\r\n  bookingIdList: any[] = [];\r\n\r\n  totalEstimate: number = 0;\r\n  totalLabour: number = 0;\r\n  totalBooking: number = 0;\r\n\r\n  /**\r\n   * \r\n   * @param arr \r\n   * @returns \r\n   */\r\n  calculateSum(arr, key): number {\r\n    return arr.reduce((total, current) => {\r\n      return total + current[key];\r\n    }, 0);\r\n  }\r\n\r\n  /**\r\n   * getCalendarData\r\n   * @param query \r\n   */\r\n  getCalendarData(query: string): void {\r\n    this.totalEstimate = 0;\r\n    this.totalLabour = 0;\r\n    this.totalBooking = 0;\r\n\r\n    // this.setDisabledCell();\r\n    this.bookingIdList = [];\r\n    this.disabledDate = {};\r\n    this.weekendDate = {};\r\n    this.startHour = 0;\r\n    this.endHour = 24;\r\n    this.commonService.showLoading();\r\n\r\n    forkJoin([\r\n      this.calendarService.getCalendarData(query),\r\n      this.calendarService.getSchedule(this.userDetail?.userId, this.calendarCurrentStartDate, this.calendarCurrentEndDate).pipe(catchError(error => of(null)))\r\n    ]\r\n    ).pipe(\r\n      map(([ calendarData, scheduleData ]) => {\r\n\r\n        const updatedValue = [];\r\n        calendarData.value.forEach((orgValue) => {\r\n          const mappedData = {\r\n            ...orgValue,\r\n            StartDate: dayjs(orgValue.StartDate).toDate(),\r\n            EndDate: dayjs(orgValue.EndDate).toDate(),\r\n            Color: orgValue.BookingTypeColor, //(orgValue.TypeName === 'Assessment' ? '#3B82F6' : '#03A31B'),\r\n            Icon: (orgValue.TypeName === 'Assessment' ? 'booking-type-assessment' : 'booking-type-repair'),\r\n            DisplayStatus: this.getDisplayStatus(orgValue.StatusName)\r\n          };\r\n\r\n          if (!this.isSameDay(mappedData.StartDate, mappedData.EndDate)) {\r\n            mappedData.allDay = true;\r\n          }\r\n          updatedValue.push(mappedData);\r\n          this.bookingIdList.push(mappedData.BookingGuid);\r\n\r\n          const startDate = this.currentView === 'month' ? new Date(this.currentDate.getFullYear(), this.currentDate.getMonth(), 1) : new Date(this.calendarCurrentStartDate);\r\n          const endDate = this.currentView === 'month' ? new Date(this.currentDate.getFullYear(), this.currentDate.getMonth() + 1, 0, 11, 59, 59) : new Date(this.calendarCurrentEndDate);\r\n\r\n\r\n          if (this.checkDateRange(startDate, endDate, mappedData.StartDate)) {\r\n            this.totalEstimate += mappedData.EstimateCost || 0;\r\n            this.totalLabour += mappedData.LabourCost || 0;\r\n            this.totalBooking++;\r\n          }\r\n        });\r\n\r\n        return { calendarData: updatedValue, scheduleData };\r\n      })\r\n    ).subscribe((result) => {\r\n      this.calendarData = [ ...result.calendarData ];\r\n\r\n      this.commonService.hideLoading();\r\n\r\n      this.checkSchedule(result.scheduleData);\r\n\r\n      this.scrollToCurrentTime();\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  private scrollToCurrentTime(): void {\r\n    const currentDate = new Date();\r\n    let scrollToHour = currentDate.getHours() > 0 ? currentDate.getHours() - 1 : currentDate.getHours();\r\n\r\n    if (scrollToHour < this.startHour) {\r\n      scrollToHour = this.startHour;\r\n    }\r\n\r\n    if (scrollToHour > this.endHour) {\r\n      scrollToHour = this.endHour - 1;\r\n    }\r\n\r\n    this.scheduler.instance.scrollToTime(scrollToHour, currentDate.getMinutes());\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param data \r\n   */\r\n  private checkSchedule(scheduleData): void {\r\n    let startHour;\r\n    let endHour;\r\n    scheduleData?.data?.calenderDays?.forEach((element) => {\r\n      if (element.breaks && element.breaks.length > 0) {\r\n        let startTime = dayjs(`${element.date} ${element.breaks[0].startTime} Z`, 'YYYY-MM-DD hh:mm A Z');\r\n        const endTime = dayjs(`${element.date} ${element.breaks[0].endTime} Z`, 'YYYY-MM-DD hh:mm A Z');\r\n\r\n        do {\r\n          const stringDate = dayjs(startTime.toDate()).toDate().toString();\r\n\r\n          this.lunchTime[stringDate] = true;\r\n          startTime = dayjs.utc(startTime.toDate()).add(30, 'm');\r\n        } while (startTime < endTime);\r\n      }\r\n\r\n      const date = dayjs(`${element.date} 00:00 AM Z`, 'YYYY-MM-DD hh:mm A Z');\r\n      if (element.isOff) {\r\n        this.disabledDate[date.toDate().toDateString()] = true;\r\n      }\r\n\r\n      if (element.isWeekend) {\r\n        this.weekendDate[date.toDate().toDateString()] = true;\r\n      }\r\n\r\n      if (element.timeSlots && element.timeSlots.length > 0) {\r\n        const startTime = dayjs(`${element.date} ${element.timeSlots[0].startTime} Z`, 'YYYY-MM-DD HH:mm Z');\r\n        const endTime = dayjs(`${element.date} ${element.timeSlots[0].endTime} Z`, 'YYYY-MM-DD HH:mm Z');\r\n\r\n        if (!startHour || startHour > startTime.toDate().getHours()) {\r\n          startHour = startTime.toDate().getHours()\r\n        }\r\n\r\n        if (!endHour || endHour < endTime.toDate().getHours()) {\r\n          endHour = endTime.toDate().getHours()\r\n          if (endTime.toDate().getMinutes() > 0 && endHour < 24) {\r\n            endHour = endHour + 1;\r\n          }\r\n        }\r\n\r\n      }\r\n    });\r\n\r\n    this.startHour = startHour || 0;\r\n    this.endHour = endHour || 24;\r\n\r\n    // this.showCalendar = false;\r\n    // setTimeout(() => {\r\n    //   this.showCalendar = true;\r\n    // }, 0);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param date \r\n   * @returns \r\n   */\r\n  getStringDate(date): string {\r\n    return dayjs(date).format('YYYYMMDDHHmm');\r\n  }\r\n\r\n  /**\r\n   * isSameDay\r\n   * @param startDate \r\n   * @param endDate \r\n   * @returns \r\n   */\r\n  isSameDay(startDate: Date, endDate: Date): boolean {\r\n    const formattedStartDate = this.datePipe.transform(startDate, 'yyyy-MM-dd');\r\n    const formattedEndDate = this.datePipe.transform(endDate, 'yyyy-MM-dd');\r\n\r\n    return formattedStartDate === formattedEndDate;\r\n  }\r\n\r\n  /**\r\n   * newBooking\r\n   */\r\n  newBooking(): void {\r\n    this.router.navigate([ '/repair/booking/0' ]);\r\n  }\r\n\r\n  /**\r\n   * handleContextMenu\r\n   * @param type \r\n   * @param e \r\n   * @param appointment \r\n   */\r\n  handleContextMenu(type: any, e: any, appointment: any): void {\r\n    if (type === 'preview') {\r\n      if (!this.previewOpen) {\r\n        this.openPreview(appointment);\r\n      }\r\n    } else if (type === 'delete') {\r\n      this.scheduler.instance.deleteAppointment(this.calendarData[this.calendarData.findIndex(x => x.Id == appointment.Id)]);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * cancelEvent\r\n   * @param e \r\n   */\r\n  cancelEvent(e): void {\r\n    e.cancel = true;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param appointment \r\n   */\r\n  openPreview(appointment): void {\r\n    this.previewOpen = true;\r\n    appointment.isReadOnlyPermission = this.isReadOnlyPermission;\r\n    const dialogRef = this.dialog.open(BookingPreviewComponent, { data: appointment, maxHeight: '90vh' });\r\n\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      this.previewOpen = false;\r\n      if (result?.success && (result.type === 'delete' || result.type === 'refresh')) {\r\n        this.refreshCalendarData();\r\n\r\n        this.draftClose();\r\n        this.draftData = [];\r\n        this.draftDataLoaded = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  isDoubleClick = false;\r\n  previewOpen = false;\r\n\r\n  /**\r\n     * onAppointmentClick\r\n     * @param e \r\n     */\r\n  onAppointmentClick(e): void {\r\n\r\n    setTimeout(() => {\r\n      if (!this.isDoubleClick && !this.previewOpen) {\r\n        this.openPreview(e.appointmentData);\r\n      }\r\n    }, 500);\r\n    this.isDoubleClick = false;\r\n    e.cancel = true;\r\n  }\r\n\r\n  /**\r\n     * onAppointmentDblClick\r\n     * @param e \r\n     */\r\n  onAppointmentDblClick(e): void {\r\n    this.isDoubleClick = true;\r\n    const routeToRedirect = RepairStatusMapper[e.appointmentData.StatusName?.replace(/\\s/g, '').toLowerCase()] || RepairStatusMapper.others;\r\n    this.router.navigate([ routeToRedirect.replace('{{repairGUID}}', e.appointmentData.ObjectGuid) ]);\r\n    e.cancel = true;\r\n  }\r\n\r\n  /**\r\n   * onOptionChanged\r\n   * @param e \r\n   */\r\n  onOptionChanged(e: any): void {\r\n    if (e.name === 'currentView') {\r\n      this.currentView = e.value;\r\n      localStorage.setItem('currentView', this.currentView);\r\n      this.isFromCalendar = true;\r\n      setTimeout(() => {\r\n        this.draftClose();\r\n        this.draftData = [];\r\n        this.draftDataLoaded = false;\r\n        this.refreshCalendarData();\r\n      }, 100);\r\n\r\n      this.calendarHeight = this.currentView === 'month' ? '100%' : this.defaultHeight;\r\n    } else if (e.name === 'currentDate') {\r\n      this.currentDate = e.value;\r\n      this.isFromCalendar = true;\r\n      setTimeout(() => {\r\n        this.draftClose();\r\n        this.draftData = [];\r\n        this.draftDataLoaded = false;\r\n        this.refreshCalendarData();\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onCellClick\r\n   * @param e \r\n   */\r\n  onCellClick(e): void {\r\n    if (!this.previewOpen) {\r\n      if (this.isReadOnlyPermission) {\r\n        e.cancel = true;\r\n        this.commonService.showInfoToast(5000, 'msg_gt_permission');\r\n      } else {\r\n        this.checkDateAndOpen(e);\r\n      }\r\n    }\r\n  }\r\n\r\n  private noPermissionRoles = {\r\n    bookingJournal: [ 'bodyshop manager', 'service advisor' ]\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  checkDateAndOpen(e): void {\r\n    if (this.isPastDate(e.cellData.startDate)) {\r\n      e.cancel = true;\r\n      this.commonService.showInfoToast(5000, 'cannot_past_date');\r\n    } else {\r\n      const isValidAppointment = this.isValidAppointment(e.component, e.cellData);\r\n\r\n      if (!isValidAppointment) {\r\n        e.cancel = true;\r\n        this.notifyDisableDate();\r\n      } else {\r\n        const startDate = this.datePipe.transform(e.cellData.startDate, 'yyyy-MM-ddTHH:mm:ss');\r\n        const endDate = this.datePipe.transform(e.cellData.endDate, 'yyyy-MM-ddTHH:mm:ss');\r\n\r\n        this.router.navigate([ '/repair/booking/0' ], { queryParams: { startDate: startDate, endDate: endDate } });\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  onAppointmentFormOpening(e: any): void {\r\n    e.cancel = true;\r\n    const startDate = e.appointmentData.startDate;\r\n    if (!this.isValidAppointmentDate(startDate)) {\r\n      e.cancel = true;\r\n      this.notifyDisableDate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  onAppointmentAdding(e: any): void {\r\n    const isValidAppointment = this.isValidAppointment(e.component, e.appointmentData);\r\n    if (!isValidAppointment) {\r\n      e.cancel = true;\r\n      this.notifyDisableDate();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  onAppointmentUpdating(e: any): void {\r\n    const allowedStatus = [ 'draft', 'vehicledetails', 'uploaddocuments', 'uploadphotos', 'repairestimation', 'pendingapproval', 'approved', 'reject', 'rejected', 'repairinprogress' ];\r\n    const statusTrimmed = e.oldData.StatusName.toLowerCase().replace(/\\s/g, '');\r\n\r\n    if (!this.isReadOnlyPermission && allowedStatus.includes(statusTrimmed)) {\r\n      const isValidAppointment = this.isValidAppointment(e.component, e.newData);\r\n      if (!isValidAppointment) {\r\n        e.cancel = true;\r\n        this.notifyDisableDate();\r\n      }\r\n\r\n      if (e.newData.TypeName === 'Assessment') {\r\n        if ((e.newData.StartDate.getTime() === e.oldData.StartDate.getTime() && e.newData.EndDate.getTime() !== e.oldData.EndDate.getTime())\r\n          || (e.newData.StartDate.getTime() !== e.oldData.StartDate.getTime() && e.newData.EndDate.getTime() === e.oldData.EndDate.getTime())) {\r\n          //This means that the appointment is resized and you can cancel it.  \r\n          e.cancel = true;\r\n        }\r\n      }\r\n    } else {\r\n      e.cancel = true;\r\n\r\n      if (!allowedStatus.includes(statusTrimmed)) {\r\n        const message = this.translateService.instant('cannot_update_datetime_for_status', { status: this.getDisplayStatus(statusTrimmed) });\r\n        this.commonService.showInfoToast(5000, message);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  onAppointmentUpdated(e: any): void {\r\n    if (!this.isReadOnlyPermission) {\r\n      const startDate = new Date(e.appointmentData.StartDate.getTime());\r\n      let endDate = new Date(e.appointmentData.EndDate.getTime());\r\n\r\n      if (e.appointmentData.allDay && startDate.getDate() == endDate.getDate()) {\r\n        endDate = new Date(e.appointmentData.StartDate.getTime());\r\n        endDate.setDate(endDate.getDate() + 1);\r\n      }\r\n\r\n      this.patchBooking(startDate, endDate, e.appointmentData.BookingGuid).subscribe({\r\n        next: () => {\r\n          this.commonService.hideLoading();\r\n          this.refreshCalendarData();\r\n        }\r\n      });\r\n    } else {\r\n      e.cancel = true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param startDate \r\n   * @param endDate \r\n   * @param bookingGuid \r\n   * @returns \r\n   */\r\n  patchBooking(startDate, endDate, bookingGuid): Observable<any> {\r\n    const patchValue: any =\r\n      [\r\n        {\r\n          op: 'replace',\r\n          path: 'StartDate',\r\n          value: dayjs.utc(startDate).format('YYYY-MM-DDTHH:mm:ss.000') + 'Z'\r\n        },\r\n        {\r\n          op: 'replace',\r\n          path: 'EndDate',\r\n          value: dayjs.utc(endDate).format('YYYY-MM-DDTHH:mm:ss.000') + 'Z'\r\n        },\r\n        {\r\n          op: 'replace',\r\n          path: 'IsArrived',\r\n          value: 'False'\r\n        },\r\n        {\r\n          op: 'replace',\r\n          path: 'IsNoShow',\r\n          value: 'False'\r\n        },\r\n      ];\r\n\r\n    this.commonService.showLoading();\r\n\r\n    return this.calendarService.updateBooking(bookingGuid, patchValue);\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  notifyDisableDate(): void {\r\n    this.commonService.showInfoToast(5000, 'cannot_disabled_date');\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param date \r\n   * @returns \r\n   */\r\n  isHoliday(date: Date): boolean {\r\n    const localeDate = date.toLocaleDateString();\r\n    const holidays = this.calendarService.getHolidays();\r\n    return holidays.filter(holiday => holiday.toLocaleDateString() === localeDate).length > 0;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param date \r\n   * @returns \r\n   */\r\n  isWeekend(date: Date): boolean {\r\n    const day = date.getDay();\r\n    return day === 0;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param date \r\n   * @returns \r\n   */\r\n  isDisableDate(date: Date): boolean {\r\n    return this.isHoliday(date);// || this.isWeekend(date) || this.isPastDate(date);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param date \r\n   * @returns \r\n   */\r\n  isPastDate(date: Date): boolean {\r\n    return date < new Date();\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param date \r\n   * @returns \r\n   */\r\n  isDisabledDateCell(date: Date): boolean {\r\n    return this.currentView === 'month'\r\n      ? this.isWeekend(date)\r\n      : this.isDisableDate(date);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param date \r\n   * @returns \r\n   */\r\n  // hasCoffeeCupIcon(date: Date): boolean {\r\n  //   const hours = date.getHours();\r\n  //   const minutes = date.getMinutes();\r\n  //   const dinnerTime = this.lunchTime;\r\n\r\n  //   return hours === dinnerTime.from && minutes === 0;\r\n  // }\r\n\r\n  /**\r\n   * \r\n   * @param component \r\n   * @param appointmentData \r\n   * @returns \r\n   */\r\n  isValidAppointment(component: any, appointmentData: any): boolean {\r\n    const startDate = new Date(appointmentData.StartDate || appointmentData.startDate);\r\n    const endDate = new Date(appointmentData.EndDate || appointmentData.endDate);\r\n    return this.isValidAppointmentInterval(startDate, endDate, 30);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param startDate \r\n   * @param endDate \r\n   * @param cellDuration \r\n   * @returns \r\n   */\r\n  isValidAppointmentInterval(startDate: Date, endDate: Date, cellDuration: number): boolean {\r\n    const edgeEndDate = new Date(endDate.getTime());\r\n\r\n    if (!this.isValidAppointmentDate(edgeEndDate)) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param date \r\n   * @returns \r\n   */\r\n  isValidAppointmentDate(date: Date): boolean {\r\n    // return !this.isHoliday(date) &&\r\n    //   !(date.getHours() >= this.lunchTime.from &&\r\n    //     date.getHours() < this.lunchTime.to) &&\r\n    //   !this.isWeekend(date) && !this.isPastDate(date);\r\n\r\n    // return !this.isHoliday(date) &&\r\n    //   !this.isWeekend(date) && !this.isPastDate(date);\r\n\r\n    return !this.isPastDate(date);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param form \r\n   */\r\n  applyDisableDatesToDateEditors(form: any): void {\r\n    const holidays = this.calendarService.getHolidays();\r\n    const startDateEditor = form.getEditor('startDate');\r\n    startDateEditor.option('disabledDates', holidays);\r\n\r\n    const endDateEditor = form.getEditor('endDate');\r\n    endDateEditor.option('disabledDates', holidays);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param currentDate \r\n   * @returns \r\n   */\r\n  getDateText(currentDate): string {\r\n    const startDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());\r\n    const endDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate() + 1);\r\n\r\n    const filteredData = this.calendarData.filter(x => this.checkDateRange(startDate, endDate, x.StartDate)).map(a => a);\r\n\r\n    if (filteredData.length > 0) {\r\n      return '<span>' + this.xaCurrencyPipe.transform(this.calculateSum(filteredData, 'EstimateCost'), this.i18n.currencySymbol, this.i18n.digitsInfo, this.i18n.locale, this.i18n.position) + '<span>E</span></span>' +\r\n        '<span>' + this.xaCurrencyPipe.transform(this.calculateSum(filteredData, 'LabourCost'), this.i18n.currencySymbol, this.i18n.digitsInfo, this.i18n.locale, this.i18n.position) + '<span>L</span></span>' +\r\n        '<span class=\"has-background\">' + filteredData.length + '</span>';\r\n    } else {\r\n      return '<span>' + this.xaCurrencyPipe.transform(0, this.i18n.currencySymbol, this.i18n.digitsInfo, this.i18n.locale, this.i18n.position) + '<span>E</span></span>' +\r\n        '<span>' + this.xaCurrencyPipe.transform(0, this.i18n.currencySymbol, this.i18n.digitsInfo, this.i18n.locale, this.i18n.position) + '<span>L</span></span>' +\r\n        '<span class=\"has-background\">0</span>';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param start \r\n   * @param end \r\n   * @param current \r\n   * @returns \r\n   */\r\n  checkDateRange(start: Date, end: Date, current: Date): boolean {\r\n    if (start <= current && current <= end) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  showProviderChild = false;\r\n\r\n  /**\r\n   * \r\n   * @param output \r\n   */\r\n  onFormUpdate(output: IControlValue): void {\r\n    if (output.name === 'TypeName' || output.name === 'Booking' || output.name === 'WorkProviderDto' || output.name === 'RepairType') {\r\n      // eslint-disable-next-line prefer-const\r\n      let prevValue = this.filterForm.get(output.name).value || [];\r\n      if (output.value) {\r\n        if (prevValue.indexOf(output.keyFieldValue) === -1) {\r\n          prevValue.push(output.keyFieldValue);\r\n        }\r\n      } else {\r\n        const index = prevValue.indexOf(output.keyFieldValue);\r\n        prevValue.splice(index, 1);\r\n      }\r\n      this.filterForm.get(output.name).setValue(prevValue);\r\n\r\n      if (output.name === 'WorkProviderDto') {\r\n        this.showProviderChild = (prevValue.length > 1 || (prevValue.length == 1 && !prevValue.includes('Retail')));\r\n      }\r\n\r\n      if (prevValue.length > 0 && output.name === 'WorkProviderDto') {\r\n        this.filterModal[4] = { ...this.filterModal[4], value: '', selectedOption: '' };\r\n        this.filterForm.get('CustomerName').setValue('');\r\n\r\n        this.filterModal[7] = { ...this.filterModal[7], value: '', options: [], selectedOption: '' };\r\n        this.filterForm.get('WorkProviderName').setValue('');\r\n\r\n        this.commonService.showLoading();\r\n        let query = `?$filter= (OrgId eq ${this.filterForm.get('OrgName').value})`;\r\n        query += `and (${prevValue.map((x) => { return `CompanyOrgType eq '${x}'` }).join(' or ')})`;\r\n        const orgQuery = `?orgId=${this.filterForm.get('OrgName').value}`;\r\n        prevValue.forEach((value) => {\r\n          this.caseService.getCompanyData(value, orgQuery).subscribe({\r\n            next: (result) => {\r\n              const concatArray = this.filterModal[7].options.concat(result.data.map((x) => {\r\n                return { label: x.companyName || x.partnershipName, value: x.companyName || x.partnershipName }\r\n              }));\r\n\r\n              this.filterModal[7] = {\r\n                ...this.filterModal[7],\r\n                options: concatArray\r\n              }\r\n            }\r\n          });\r\n        });\r\n\r\n        this.calendarService.getCustomer(query).subscribe({\r\n          next: (result) => {\r\n            this.commonService.hideLoading();\r\n            if (result) {\r\n              this.filterModal[4] =\r\n              {\r\n                ...this.filterModal[4],\r\n                options: result.value.filter((value, index, self) => {\r\n                  return self.findIndex(o => o.ContactId === value.ContactId) === index;\r\n                }).map((x) => {\r\n                  return {\r\n                    label: x.FirstName + ' ' + x.LastName,\r\n                    value: x.Email,\r\n                    html: `<div class='workflow-customer-item'><span class='name'>${x.FirstName + ' ' + x.LastName}</span><span class='email'>${x.Email}</span></div>`\r\n                  }\r\n                })\r\n              };\r\n            } else {\r\n              this.filterModal[4] =\r\n              {\r\n                ...this.filterModal[4],\r\n                options: []\r\n              };\r\n            }\r\n          },\r\n          error: () => {\r\n            this.filterModal[4] =\r\n            {\r\n              ...this.filterModal[4],\r\n              options: []\r\n            };\r\n\r\n            this.commonService.hideLoading();\r\n          }\r\n        });\r\n      } else {\r\n        this.filterModal[4] =\r\n        {\r\n          ...this.filterModal[4],\r\n          options: []\r\n        };\r\n      }\r\n\r\n    } else if (output.name === 'Assignees') {\r\n      this.filterModal[5] = { ...this.filterModal[5], selectedOption: output.value };\r\n      this.filterForm.get(output.name).setValue(output.value.map((x) => { return x.value }));\r\n    } else if (output.name === 'CustomerName') {\r\n      this.filterModal[4] = { ...this.filterModal[4], selectedOption: output.value };\r\n      this.filterForm.get(output.name).setValue(output.value.map((x) => { return x.value }));\r\n    } else if (output.name === 'WorkProviderName') {\r\n      this.filterModal[7] = { ...this.filterModal[7], selectedOption: output.value };\r\n      this.filterForm.get(output.name).setValue(output.value.map((x) => { return x.value }));\r\n    } else if (output.name === 'OrgName') {\r\n      this.filterModal[1] = { ...this.filterModal[1], selectedOption: output.value };\r\n      this.filterForm.get(output.name).setValue(output.value.value);\r\n\r\n      this.filterModal[0] = {\r\n        ...this.filterModal[0],\r\n        options: []\r\n      };\r\n      this.filterModal[3] = {\r\n        ...this.filterModal[3],\r\n        options: []\r\n      };\r\n      this.filterModal[4] =\r\n      {\r\n        ...this.filterModal[4],\r\n        options: []\r\n      };\r\n      this.filterModal[5] =\r\n      {\r\n        ...this.filterModal[5],\r\n        options: []\r\n      };\r\n      this.filterModal[6] =\r\n      {\r\n        ...this.filterModal[6],\r\n        options: []\r\n      };\r\n      this.filterModal[7] =\r\n      {\r\n        ...this.filterModal[7],\r\n        options: []\r\n      };\r\n      this.filterForm.get('WorkProviderDto').setValue('');\r\n      this.filterForm.get('WorkProviderName').setValue('');\r\n      this.filterForm.get('CustomerName').setValue('');\r\n      if (this.filterForm.get(output.name).value) {\r\n        this.getWorkProviders(this.filterForm.get(output.name).value);\r\n        this.applyButton = { ...this.applyButton, type: 'primary' };\r\n      } else {\r\n        this.applyButton = { ...this.applyButton, type: 'disabled' };\r\n      }\r\n\r\n      this.showProviderChild = false;\r\n    } else {\r\n      this.filterForm.get(output.name).setValue(output.value);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param value \r\n   * @returns \r\n   */\r\n  formatLabel(value: number): string {\r\n    if (value >= 1000) {\r\n      return Math.round(value / 1000) + 'k';\r\n    }\r\n\r\n    return `${value} `;\r\n  }\r\n\r\n  public disabledDate: any = {};\r\n  public weekendDate: any = {};\r\n\r\n  /**\r\n   * \r\n   */\r\n  // setDisabledCell(): void {\r\n  //   const startDate = this.scheduler.instance.getStartViewDate();\r\n  //   const endDate = this.scheduler.instance.getEndViewDate();\r\n\r\n\r\n\r\n  //   for (const date = startDate; date <= endDate; date.setDate(date.getDate() + 1)) {\r\n  //     // if (this.isPastDate(startDate)) {\r\n  //     //   this.disabledDate[startDate.toDateString()] = true;\r\n  //     //   continue;\r\n  //     // }\r\n\r\n  //     if (this.isDisableDate(date)) {\r\n  //       this.disabledDate[date.toDateString()] = true;\r\n  //     } else {\r\n  //       if (this.isWeekend(date)) {\r\n  //         this.weekendDate[date.toDateString()] = true;\r\n  //       }\r\n  //     }\r\n\r\n  //   }\r\n  // }\r\n\r\n  /**\r\n   * \r\n   */\r\n  applyFilter(): void {\r\n    this.refreshCalendarData();\r\n    this.filter.close();\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  resetFilter(): void {\r\n    this.filterForm.reset();\r\n\r\n    for (let index = 0; index < this.filterModal.length; index++) {\r\n      if (!this.filterModal[index].disabled) {\r\n        this.filterModal[index] = {\r\n          ...this.filterModal[index],\r\n          value: '',\r\n          selectedOption: '',\r\n          options: this.filterModal[index].options?.map((x) => { x.checked = false; return x; })\r\n        }\r\n      }\r\n    }\r\n\r\n    this.showProviderChild = false;\r\n\r\n    if (this.userDetail?.organizationDetail?.id) {\r\n      this.filterForm.get('OrgName').setValue(this.userDetail?.organizationDetail.id);\r\n\r\n      this.filterModal[1] =\r\n      {\r\n        ...this.filterModal[1],\r\n        selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n      };\r\n\r\n      if (this.filterForm.get('OrgName').value) {\r\n        this.getWorkProviders(this.filterForm.get('OrgName').value);\r\n      }\r\n    }\r\n    this.applyButton = { ...this.applyButton, type: 'primary' };\r\n    // this.refreshCalendarData();\r\n    // this.filter.close();\r\n  }\r\n\r\n  /*Draft customer*/\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  onItemDragStart(e): void {\r\n    e.itemData = e.fromData;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  onItemDragEnd(e): void {\r\n    if (e.toData) {\r\n      e.cancel = true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  onAppointmentAdd(e): void {\r\n    if (this.isReadOnlyPermission) {\r\n      this.commonService.showInfoToast(5000, 'msg_gt_permission');\r\n    } else {\r\n      this.addAppointmentFromDraft(e);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param e \r\n   */\r\n  addAppointmentFromDraft(e): void {\r\n    if (this.isPastDate(e.itemData.StartDate)) {\r\n      e.cancel = true;\r\n      this.commonService.showInfoToast(5000, 'cannot_past_date');\r\n    } else {\r\n      const isValidAppointment = this.isValidAppointment(e.component, e.itemData);\r\n\r\n      if (!isValidAppointment) {\r\n        e.cancel = true;\r\n        this.notifyDisableDate();\r\n      } else {\r\n        if (e.itemData.draftCustomerType === 'Quote') {\r\n          if (e.itemData.status == 'Repair Estimation') {\r\n\r\n            const startDate = this.datePipe.transform(e.itemData.StartDate, 'yyyy-MM-ddTHH:mm:ss');\r\n            const endDate = this.datePipe.transform(e.itemData.EndDate, 'yyyy-MM-ddTHH:mm:ss');\r\n\r\n            this.router.navigate([ 'repair/booking/0' ], {\r\n              queryParams:\r\n                { 'caseId': e.itemData.caseGuid, 'startDate': startDate, 'endDate': endDate }\r\n            });\r\n          } else {\r\n            this.router.navigate([ `/quote/case/${e.itemData.caseGuid}` ]);\r\n          }\r\n        } else if (e.itemData.draftCustomerType === 'Repair') {\r\n          this.patchBooking(e.itemData.StartDate, e.itemData.EndDate, e.itemData.bookingGuid).subscribe({\r\n            next: () => {\r\n              this.commonService.hideLoading();\r\n              this.draftDataLoaded = false;\r\n              this.refreshCalendarData();\r\n              this.openDraftCustomer();\r\n            }\r\n          });\r\n        } else {\r\n          this.commonService.showInfoToast(1000, 'draft_type_not_defined');\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param type \r\n   * @param e \r\n   * @param customer \r\n   */\r\n  handleDraftAction(type: any, e: any, customer: any): void {\r\n    if (type === 'preview') {\r\n      if (customer.draftCustomerType == 'Repair') {\r\n        this.router.navigate([ `/repair/booking/${customer.repairGuid}` ]);\r\n      } else if (customer.draftCustomerType == 'Quote') {\r\n        this.router.navigate([ `/quote/case/${customer.caseGuid}` ]);\r\n      }\r\n    } else if (type === 'delete') {\r\n      this.commonService.openDeleteDialog('customer')\r\n        .afterClosed().subscribe((data) => {\r\n          if (data) {\r\n            this.commonService.showLoading();\r\n            this.calendarService.deleteDraftCustomer(customer.id).subscribe({\r\n              next: () => {\r\n                this.commonService.hideLoading();\r\n                this.draftDataLoaded = false;\r\n                this.openDraftCustomer();\r\n              }\r\n            });\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  draftClose(): void {\r\n    this.draftCustomer.close();\r\n    this.calendarWidth = '100%';\r\n    this.calendarHeight = this.currentView === 'month' ? '100%' : this.defaultHeight;\r\n  }\r\n\r\n  /**\r\n   * get work providers\r\n   * @param orgId \r\n   */\r\n  getWorkProviders(orgId: any): void {\r\n    this.commonService.showLoading();\r\n    // this.caseService.getProvidersByOrgId(`?orgIds=${orgId}`).subscribe({\r\n    //   next: (result) => {\r\n    //     this.commonService.hideLoading();\r\n    //     this.filterModal[3].options = result.data.map((x) => { return { label: x, value: x } });\r\n    //   },\r\n    //   error: (err) => {\r\n    //     this.commonService.hideLoading();\r\n    //   }\r\n    // });\r\n\r\n\r\n    forkJoin([\r\n      this.bookingService.getBookingRepairTypes(`?orgIds=${orgId}`),\r\n      this.caseService.getProvidersByOrgId(`?orgIds=${orgId}`),\r\n      this.caseService.getCaseUsers(`?orgId=${orgId}`)\r\n    ]\r\n    ).pipe(\r\n      map(([ bookingRepairType, workProvider, employeeList ]) => {\r\n        return { bookingRepairType, workProvider, employeeList };\r\n      })\r\n    ).subscribe((result) => {\r\n      if(result?.bookingRepairType?.data) this.filterModal[0].options = result?.bookingRepairType?.data.BookingTypes.map((x) => { return { label: x.name, value: x.name } });\r\n\r\n      if(result?.workProvider?.data) this.filterModal[3].options = result?.workProvider?.data.map((x) => { return { label: x, value: x } });\r\n\r\n      if(result?.employeeList?.data) {\r\n        this.filterModal[5] =\r\n        {\r\n          ...this.filterModal[5],\r\n          options: result?.employeeList?.data?.map((x) => { return { label: x.name, value: x.id } })\r\n        };\r\n      }\r\n      \r\n\r\n      if (result.bookingRepairType.data.RepairType && result.bookingRepairType.data.RepairType.length > 0) {\r\n        this.filterModal[6].options = result.bookingRepairType.data.RepairType[0].RepairTypes.map((x) => {\r\n          return { label: x.name, value: x.id, icon: this.getRepairTpeIcon(x.name) }\r\n        });\r\n      }\r\n\r\n      this.commonService.hideLoading();\r\n    });\r\n  }\r\n}","<div class=\"dialog-with-header large-width\">\r\n    <div class=\"header\" [ngStyle]=\"{'background-color': data.Color}\">\r\n        <div class=\"title\">\r\n            {{ 'booking_details' | translate}} - {{data.TypeName}}\r\n        </div>\r\n        <div class=\"action\">\r\n            <button>\r\n                <mat-icon [svgIcon]=\"'cross'\" color=\"white\" [mat-dialog-close]=\"\"></mat-icon>\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <mat-dialog-content class=\"mat-typography\">\r\n        <div class=\"booking-preview-wrapper\">\r\n            <div class=\"booking-preview-content\">\r\n                <div class=\"section-header\">\r\n                    <div class=\"section-title\">\r\n                        <mat-icon [svgIcon]=\"'person-circle'\" color=\"black-medium\"></mat-icon>\r\n                        <span>{{ 'customer_details' | translate}}</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'first_name' | translate}}: <span class=\"info-content short-text\">{{data.Customer?.FirstName ||\r\n                                '-'}}</span></label>\r\n                    </div>\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'last_name' | translate}}: <span class=\"info-content short-text\">{{data.Customer?.LastName ||\r\n                                '-'}}</span></label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'work_provider' | translate}}: <span\r\n                                class=\"info-content\">{{data.WorkProviderDto?.CompanyName ||\r\n                                data.WorkProviderDto?.CompanyOrgType || '-'}}</span></label>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"section-header\">\r\n                    <div class=\"section-title\">\r\n                        <mat-icon [svgIcon]=\"'car'\" color=\"black-medium\"></mat-icon>\r\n                        <span>{{ 'vehicle_detail' | translate}}</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'car_make' | translate}}: <span class=\"info-content\">{{data.Vehicle?.Make ||\r\n                                '-'}}</span></label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'car_model' | translate}}: <span class=\"info-content\">{{data.Vehicle?.Model ||\r\n                                '-'}}</span></label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'license_plate' | translate}}: <span class=\"info-content\">{{data.Vehicle?.LicensePlate\r\n                                || '-'}}</span></label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'import_interval' | translate}}:\r\n                            <span class=\"info-content\">\r\n                                {{ data.Vehicle?.VehicleId ? data.Vehicle?.ModelInterval || '-' : '-'}}\r\n                            </span>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"section-header\">\r\n                    <div class=\"section-title\">\r\n                        <mat-icon [svgIcon]=\"'magazine'\" color=\"black-medium\"></mat-icon>\r\n                        <span>{{ 'booking_details' | translate}}</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'assigned_to' | translate}}:\r\n                            <ng-container *ngIf=\"data.Assignees?.length > 0; else emptyAssignee\">\r\n                                <span class=\"info-content\" inner>{{ joinAssignees(data.Assignees) }}</span>\r\n                            </ng-container>\r\n                            <ng-template #emptyAssignee>\r\n                                <span class=\"info-content\">-</span>\r\n                            </ng-template>\r\n\r\n\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'status' | translate}}: <span class=\"info-content\">\r\n                                {{data.DisplayStatus || '-'}}</span></label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\" *ngIf=\"data.TypeName === 'Repair'\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'repair_type' | translate}}:\r\n                            <ng-container *ngFor=\"let repairType of data.RepairServiceTypes\">\r\n                                <mat-icon [svgIcon]=\"iconMapper[repairType.RepairServiceTypeName]\"\r\n                                    [matTooltip]=\"repairType.RepairServiceTypeName\"></mat-icon>\r\n                            </ng-container>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\" *ngIf=\"data.TypeName === 'Repair'\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'stage' | translate}}: <span class=\"info-content\">{{data.Stage || '-'}}</span></label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'booking_in' | translate}}: <span class=\"info-content\">{{data.StartDate | date:'EE d\r\n                                MMM y h:mm:ss a'}}</span></label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <label>{{ 'booking_out' | translate}}: <span class=\"info-content\">{{data.EndDate | date:'EE d\r\n                                MMM y h:mm:ss a'}}</span></label>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\" *ngIf=\"data.TypeName === 'Repair'\">\r\n                        <label>{{ 'parts' | translate }}:\r\n                            <div class=\"icon-container\">\r\n                                <div class=\"icon-wrapper\" [matTooltip]=\"data.RepairPartsGeneralStatus || 'Not Ordered'\"\r\n                                    matTooltipPosition=\"above\">\r\n                                    <mat-icon\r\n                                        [svgIcon]=\"partsIconMapper[data.RepairPartsGeneralStatus || 'Not Ordered']\"></mat-icon>\r\n                                </div>\r\n                            </div>\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"booking-preview-action\">\r\n                <div class=\"section-header transparent\">\r\n                    <div class=\"section-title\">\r\n                        <span>{{ 'actions' | translate}}</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\">\r\n                    <div class=\"detail-col\">\r\n                        <a class=\"button button-outline\"\r\n                            [routerLink]=\"bookingStatusUrl\"\r\n                            [queryParams]=\"{ mode: 'edit' }\" *chqPermission=\"'viewBooking'\">\r\n                            <mat-icon [svgIcon]=\"'edit'\" aria-hidden=\" false\" aria-label='edit icon'></mat-icon>\r\n                            <label *ngIf=\"!data.isReadOnlyPermission\" class=\"action-btn\">{{ 'edit_booking' |\r\n                                translate}}</label>\r\n                            <label *ngIf=\"data.isReadOnlyPermission\" class=\"action-btn\">{{ 'view_booking' |\r\n                                translate}}</label>\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\" *ngIf=\"!data.isReadOnlyPermission && showDelete\">\r\n                    <div class=\"detail-col\">\r\n                        <button class=\"button-outline-danger\" (click)=\"deleteBooking(data.BookingGuid)\"\r\n                            *chqPermission=\"'newBooking'\">\r\n                            <mat-icon [svgIcon]=\"'delete'\" aria-hidden=\" false\" aria-label='edit icon'></mat-icon>\r\n                            <label class=\"action-btn\">{{ 'cancel_booking' | translate}}</label>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"detail-row\"\r\n                    *ngIf=\"data.TypeName === 'Repair' && isArrivedVisible && !data.isReadOnlyPermission\">\r\n                    <div class=\"detail-col\">\r\n                        <div class=\"toggle\">\r\n                            <label class=\"label-toggle\">{{ 'arrived' | translate}}</label>\r\n                            <div class=\"toggle-button\">\r\n                                <chq-toggle [checked]=\"isArrived\" [name]=\"'arrived'\"\r\n                                    (ToggleChange)=\"onToggleChange($event)\"></chq-toggle>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"detail-row\"\r\n                    *ngIf=\"data.TypeName === 'Repair' && data.StatusName === 'Draft' && isNoShowVisible && !data.isReadOnlyPermission\">\r\n                    <div class=\"detail-col\">\r\n                        <div class=\"toggle\">\r\n                            <label class=\"label-toggle\">{{ 'no_show' | translate}}</label>\r\n                            <div class=\"toggle-button\">\r\n                                <chq-toggle [checked]=\"isNoShow\" [name]=\"'noshow'\"\r\n                                    (ToggleChange)=\"onToggleChange($event)\"></chq-toggle>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </mat-dialog-content>\r\n</div>","/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/* eslint-disable require-jsdoc */\r\nimport { Component, Inject, OnChanges, OnInit } from '@angular/core';\r\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { NavigationStart, Router, RouterEvent } from '@angular/router';\r\nimport { filter, take, tap } from 'rxjs';\r\nimport { RepairStatusMapper } from 'src/app/config/route-mapper/repair-status-mapper';\r\nimport { CalendarService } from 'src/app/services/calendar/calendar.service';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\n\r\n@Component({\r\n  selector: 'booking-preview',\r\n  templateUrl: './booking-preview.component.html',\r\n  styleUrls: [ './booking-preview.component.scss' ],\r\n  providers: [ CalendarService ]\r\n})\r\nexport class BookingPreviewComponent implements OnInit, OnChanges {\r\n  public iconMapper = {\r\n    Body: 'car',\r\n    Maintenance: 'house',\r\n    Paint: 'paintbrush',\r\n    Tyres: 'tire',\r\n    Electric: 'bolt-car',\r\n    Tires: 'tire',\r\n    Electrical: 'bolt-car',\r\n    Mechanical: 'mechanical',\r\n    Diagnosis: 'diagnosis',\r\n    Others: 'gears'\r\n  };\r\n\r\n  public isArrived = false;\r\n  public isNoShow = false;\r\n\r\n  public isArrivedVisible = false;\r\n  public isNoShowVisible = false;\r\n  public isRepairCreatedFromCase = false;\r\n  public status = '';\r\n\r\n  private changesMade: boolean = false;\r\n\r\n  constructor(\r\n    public dialog: MatDialog,\r\n    public dialogRef: MatDialogRef<BookingPreviewComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: any,\r\n    private router: Router,\r\n    private calendarService: CalendarService,\r\n    private commonService: CommonService\r\n  ) {\r\n\r\n    // Close dialog ref on route changes\r\n    router.events.pipe(\r\n      filter((event: RouterEvent) => event instanceof NavigationStart),\r\n      tap(() => this.dialogRef.close()),\r\n      take(1),\r\n    ).subscribe();\r\n  }\r\n\r\n\r\n  /**\r\n   * booking url\r\n   */\r\n  get bookingStatusUrl(): string {\r\n    const { StatusName, ObjectGuid } = this.data;\r\n    let routeToRedirect = RepairStatusMapper[StatusName?.replace(/\\s/g, '')?.toLowerCase()] || RepairStatusMapper.others;\r\n    routeToRedirect = routeToRedirect.replace('{{repairGUID}}', ObjectGuid)\r\n    return routeToRedirect;\r\n  }\r\n\r\n  /**\r\n   * show delete\r\n   */\r\n  get showDelete(): boolean {\r\n    if (this.status?.toLowerCase() === 'draft') {\r\n      return true;\r\n    } else if (this.isRepairCreatedFromCase == true && this.status?.toLowerCase() == 'repairestimation') {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * detects changes in input attributes\r\n   * @param changes \r\n   */\r\n  ngOnInit(): void {\r\n    this.isArrived = this.data.IsArrived;\r\n    this.isNoShow = this.data.IsNoShow;\r\n    this.status = this.data.StatusName;\r\n    this.isRepairCreatedFromCase = this.data.IsRepairCreatedFromCase;\r\n\r\n    this.calculateTimeDifference();\r\n\r\n    this.dialogRef.beforeClosed().subscribe(() => this.dialogRef.close({ 'success': this.changesMade, 'type': 'refresh' }));\r\n  }\r\n\r\n  /**\r\n * detects changes in input attributes\r\n * @param changes \r\n */\r\n  ngOnChanges(): void {\r\n    this.isArrived = this.data.IsArrived;\r\n    this.isNoShow = this.data.IsNoShow;\r\n    this.status = this.data.StatusName;\r\n    this.isRepairCreatedFromCase = this.data.IsRepairCreatedFromCase;\r\n\r\n    this.calculateTimeDifference();\r\n  }\r\n\r\n  calculateTimeDifference(): void {\r\n    const currentDate = new Date();\r\n    const bookingInDate = this.data.StartDate;\r\n    const canActivateDate = new Date(bookingInDate.getTime() - 30 * 60000);\r\n    if (currentDate > canActivateDate) {\r\n      this.isArrivedVisible = true;\r\n    }\r\n\r\n    if (currentDate > bookingInDate) {\r\n      this.isNoShowVisible = true;\r\n      this.isArrivedVisible = false;\r\n    }\r\n  }\r\n\r\n  deleteBooking(id): void {\r\n    this.commonService.openDeleteDialog()\r\n      .afterClosed().subscribe((data) => {\r\n        if (data) {\r\n          this.commonService.showLoading();\r\n          this.calendarService.deleteBooking(id).subscribe({\r\n            next: () => {\r\n              this.dialogRef.close({ 'success': true, 'type': 'delete', 'id': id });\r\n              this.commonService.hideLoading();\r\n            }\r\n          });\r\n        }\r\n      });\r\n  }\r\n\r\n  onToggleChange(e): void {\r\n    if (e.checked && e.name == 'noshow') {\r\n      this.isNoShow = true;\r\n      this.isArrived = false;\r\n    } else if (e.checked && e.name == 'arrived') {\r\n      this.isNoShow = false;\r\n      this.isArrived = true;\r\n    } else {\r\n      this.isNoShow = false;\r\n      this.isArrived = false;\r\n    }\r\n\r\n    const patchValue: any =\r\n      [\r\n        {\r\n          op: 'replace',\r\n          path: 'IsArrived',\r\n          value: this.isArrived ? 'True' : 'False'\r\n        },\r\n        {\r\n          op: 'replace',\r\n          path: 'IsNoShow',\r\n          value: this.isNoShow ? 'True' : 'False'\r\n        },\r\n      ];\r\n\r\n    this.commonService.showLoading();\r\n\r\n    this.calendarService.updateBooking(this.data.BookingGuid, patchValue).subscribe({\r\n      next: () => {\r\n        this.commonService.hideLoading();\r\n        this.changesMade = true;\r\n      },\r\n      error: () => {\r\n        e.cancel = true;\r\n      }\r\n    });\r\n  }\r\n\r\n  partsIconMapper = {\r\n    'Ordered': 'parts-ordered',\r\n    'Arrived Partially': 'parts-arrived-partial',\r\n    'Arrived': 'parts-arrived',\r\n    'Ordered Partially': 'parts-ordered-partial',\r\n    'Not Ordered': 'parts-not-ordered'\r\n  }\r\n\r\n  joinAssignees(Assignees): string {\r\n    return Assignees?.map(x => x.AssigneeName).join(', ');\r\n  }\r\n\r\n}","<div class=\"page-container lounge-list-container mh-0 mt-0 fx-col\">\r\n    <div class=\"fx-0 lounge-list-header\">\r\n        <div class=\"header-content fx-row justify-space-between align-center\">\r\n            <!-- <div class=\"last-updated\">\r\n                {{'last_refreshed' | translate}}: {{LastRefreshed}}\r\n            </div> -->\r\n            <chq-button style='margin-left: auto;' [buttonModel]=\"FullscreenButton\" (click)=\"openFullscreen()\"></chq-button>\r\n        </div>\r\n    </div>\r\n    <div class=\"fullscreen\" *ngIf=\"isFullScreen\">\r\n        <div class=\"lounge-header fx-0 fx-col justify-center\">\r\n            <div class=\"lounge-header-content align-center fx-row\">\r\n                <a class=\"xa-logo-wrapper\">\r\n                    <div class=\"menu-image\">\r\n                        <img [src]=\"orgLogoUrl\" (error)=\"avatar='';\" (load)=\"orgImageLoading=false\" *ngIf=\"orgLogoUrl else name\" />\r\n                        <ng-template #name>\r\n                            <label *ngIf=\"orgName\" class=\"org-name\">{{orgName}}</label>\r\n                        </ng-template>\r\n                        <chq-custom-loader [showLoading]=\"orgImageLoading\"></chq-custom-loader>\r\n                    </div>\r\n                </a>\r\n                <div class=\"lounge-title-wrapper\">{{'outbound_dashboard' | translate}}</div>\r\n                <div class='date-container'>\r\n                    <div class=\"lounge-date-wrapper\">{{currentDate}}</div>\r\n                    <div class=\"lounge-last-refresh\">{{'last_refreshed' | translate}}: {{LastRefreshed}}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"lounge-content\">\r\n        <mat-card class=\"card block\" *ngFor=\"let item of outboundData; let i = index;\">\r\n\r\n            <div class=\"card-container\">\r\n                <div class=\"card-header\">\r\n                    <div class=\"card-header-container align-center fx-row\">\r\n                        <table class=\"card-head-table\" [ngClass]=\"getHeaderTableDarkClass(item)\">\r\n                            <tr class=\"head-row\" [ngClass]=\"getHeaderTableDarkClass(item)\">\r\n                                <div class='head-row-col-1'>\r\n                                  <th *ngIf=\"item.CustomerName\" class='header-customerName' [ngClass]=\"getHeaderTableDarkClass(item)\">\r\n                                      <div class=\"header-content-data\">{{item.CustomerName}}</div>\r\n                                    </th>\r\n                                  <!-- <th *ngIf=\"item.RepairNumber\">\r\n                                      <div class=\"header-content-data\">{{item.RepairNumber}}</div>\r\n                                    </th> -->\r\n                                    <!-- <span *ngIf=\"item.RepairNumber\" class='border-right-line'></span> -->\r\n                                    <th><span class='sub-text'>Make & Model:</span>{{ item.VehicleMake + ' ' + item.VehicleName}}</th>\r\n                                    <th><span class='sub-text'>Plate:</span>{{ item.VehicleLicensePlate }}</th>\r\n                                    <th class='header-amount'><span class='sub-text'>Amount:</span>{{item.TotalAmount | xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}\r\n                                    </th>\r\n\r\n                                    <th *ngIf=\"item.CompanyName\"><span class='sub-text'>Customer:</span>{{item.CompanyName}}</th>\r\n                                    <!-- <th *ngIf=\"item.Assignees.length > 0\"><div class=\"flex\" style=\"flex-wrap: wrap;\"><div *ngFor=\"let assignee of item.Assignees;let last = last\">{{assignee.AssigneeName}}<ng-container *ngIf=\"!last\">&nbsp;-&nbsp;</ng-container></div></div></th> -->\r\n                                    <!-- <span *ngIf=\"item.Assignees.length > 0\" class='border-right-line'></span> -->\r\n                                </div>\r\n                                <!-- <th class='head-item' *ngIf=\"item.RepairServiceTypes.length > 0\">\r\n                                  <div class=\"fx-row\" style=\"display: flex !important; flex-wrap: wrap;\">\r\n                                      <button class=\"outbound-icon-btn\" *ngFor=\"let repair of item.RepairServiceTypes\">\r\n                                          <mat-icon [svgIcon]=\"jobIconDictionary[repair.Name]?jobIconDictionary[repair.Name]:'gears'\" [attr.color]=\"'black'\"></mat-icon>\r\n                                      </button>\r\n                                  </div>\r\n                              </th> -->\r\n                                <th style='margin-left: auto' class=\"head-item\">\r\n                                    <div class=\"repair-state\">\r\n                                        <button class=\"repair-state-btn\"><span [ngClass]=\"getHeaderTableDarkClass(item, 'text')\">{{(item.IsDeliveryTypeEnable && item.DeliveryDTO ? 'picked_up' :item.OutboundStatus.split(' ').join('')) | lowercase | translate}}</span></button>\r\n                                    </div>\r\n                                </th>\r\n                            </tr>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"card-content\" [ngClass]=\"getHeaderTableClass(item)\">\r\n                    <div class=\"job-list-container fx-row align-center\">\r\n                        <div class=\"jobs-list\">\r\n                            <table class=\"card-table\">\r\n                                <tr class=\"card-row\">\r\n                                    <th class=\"card-job\" [ngClass]=\"getHeaderTableClass(item)\">\r\n                                      <div class=\"outbound-header-card\" style='justify-content: center;'>\r\n                                        <img [src]=\"item.ImageUrlFirst===null?'assets/img/front-left.png':item.ImageUrlFirst\" class=\"rapair-car-img\" (load)=\"item.ImageUrlFirstLoad=false;\" alt=\"\">\r\n                                        <chq-custom-loader [showLoading]=\"item.ImageUrlFirstLoad\"></chq-custom-loader>\r\n\r\n                                      </div>\r\n                                    </th>\r\n                                    <th  *ngFor=\"let job of item.Jobs\" [ngClass]=\"getHeaderTableClass(item)\">\r\n                                      <div class=\"outbound-header-card\" [matTooltip]=\"job.JobName\">\r\n                                        <!-- <span class='color-block' [style.background-color]=\"job.Color\"></span> -->\r\n                                        <div class='outbound-content'>\r\n                                          <span [style.background-color]=\"job.Color\">\r\n                                            <mat-icon style='width: 15px;height:15px' svgIcon=\"checked\"></mat-icon>\r\n                                            <p>{{job.JobName}}</p>\r\n                                          </span>\r\n                                          <p>{{job.CompletePercentage}}%</p>\r\n                                      </div>\r\n                                      </div>\r\n                                    </th>\r\n                                    <!-- <th class=\"card-job\">\r\n                                        <div class=\"img-container\">\r\n                                            <img [src]=\"item.ImageUrlLast?.includes('inspectiontemplates')?item.ImageUrlFirst ?item.ImageUrlFirst:item.ImageUrlLast:item.ImageUrlLast\" (load)=\"item.ImageUrlLastLoad=false;\" alt=\"\">\r\n                                            <chq-custom-loader [showLoading]=\"item.ImageUrlLastLoad\"></chq-custom-loader>\r\n                                        </div>\r\n                                    </th> -->\r\n                                </tr>\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        </mat-card>\r\n\r\n        <div class=\"no-data-wrapper\" *ngIf=\"outboundData.length === 0 && !CallingAPI\">\r\n            <div class=\"no-data-content\">\r\n                <img src=\"assets/img/no-data.png\" alt=\"\">\r\n                <span>{{'no_result_found' | translate}}</span>\r\n                <span>{{'could_not_find_any_data' | translate}}.</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"footer-full-wrapper\">\r\n    <div class=\"footer-image-wrapper\">\r\n        <div class=\"image-wrapper\">\r\n            <img src=\"assets/img/addenda-repair.png\" alt=\"\"/>\r\n        </div>\r\n    </div>\r\n</div>\r\n","import { DatePipe } from '@angular/common';\r\nimport { Component, HostListener, Inject, OnDestroy, OnInit } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport * as dayjs from 'dayjs';\r\nimport { Subscription } from 'rxjs';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { OutboundService } from 'src/app/services/outbound/outbound.service';\r\nimport { CommonService, i18nInfo } from 'src/app/services/common/common.service';\r\n\r\n@Component({\r\n  selector: 'app-lounge-list',\r\n  templateUrl: './lounge-list.component.html',\r\n  styleUrls: [ './lounge-list.component.scss' ],\r\n  providers: [ OutboundService ],\r\n})\r\nexport class LoungeListComponent implements OnInit, OnDestroy {\r\n\r\n  public FullscreenButton: ChqWidgetsButtonModel = {\r\n    label: 'view_full_screen',\r\n    type: 'outline',\r\n    icon: 'fullscreen'\r\n  };\r\n\r\n  public jobIconDictionary = {\r\n    'Body': 'car',\r\n    'Paint': 'paint-nozzle',\r\n    'Mechanical': 'mechanical',\r\n    'Electrical': 'electric',\r\n    'Tires': 'tire',\r\n    'Preparation': 'car-roof',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Check In': 'checkbox-open',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Panel Repair': 'door-panel',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Panel Fitup': 'door-panel',\r\n    'Polish': 'car-paint',\r\n    'Detailing': 'car-cleaning',\r\n    'Maintenance': 'maintenance',\r\n    'Diagnosis': 'diagnosis',\r\n    'Others': 'gears',\r\n  };\r\n\r\n  public i18n: i18nInfo;\r\n  public currentDate: string = dayjs().format('MMMM DD, YYYY hh:mm a');\r\n  public LastRefreshed: string = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n  public loungeTimeout = null;\r\n  public currentDateTimeout = null;\r\n  subs: Subscription[] = [];\r\n  CallingAPI = false;\r\n  public outboundData = [];\r\n  public FocusedRepairIndex = 0;\r\n  orgImageLoading: boolean = true;\r\n  orgLogoUrl: string = '';\r\n  orgName: string = '';\r\n  avatar: string | ArrayBuffer;\r\n\r\n  elem: any;\r\n  isFullScreen: boolean;\r\n  timeInterval = null;\r\n\r\n\r\n\r\n  /**\r\n     * Creates an instance.\r\n     * @constructor\r\n     * @param {DatePipe} datePipe\r\n     * @param {CommonService} CommonService\r\n     * @param {OutboundService} OutboundService\r\n     */\r\n  constructor(private datePipe: DatePipe,\r\n      private commonService: CommonService,\r\n      private OutboundService: OutboundService,\r\n      @Inject(DOCUMENT) private document: any) {\r\n    this.i18n = this.commonService.geti18nInfo();\r\n\r\n    this.commonService.userProfileData.subscribe({\r\n      next: (res: any) => {\r\n        if (res) {\r\n          this.orgLogoUrl = res?.data.organizationDetail?.logoUrl;\r\n          this.orgName = res?.data.organizationDetail?.name;\r\n          if (!this.orgLogoUrl) {\r\n            this.orgImageLoading = false;\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * ngOnInit\r\n   */\r\n  ngOnInit(): void{\r\n    this.chkScreenMode();\r\n    this.elem = document.documentElement;\r\n    this.getOutboundData(true);\r\n    this.timeInterval = setInterval(()=> {\r\n      this.updateDate();\r\n    }, 1000);\r\n  }\r\n\r\n  /**\r\n     * getCardTableClass\r\n     */\r\n  getCardTableClass(repairs: any): string {\r\n    if (\r\n      repairs.OutboundStatus === null ||\r\n        repairs.OutboundStatus === 'Repair Not Started' ||\r\n        repairs.OutboundStatus === 'Repair In Progress'\r\n    ) {\r\n      return 'card-table-gray';\r\n    } else if (\r\n      (!repairs.IsDeliveryTypeEnable ||\r\n          (repairs.IsDeliveryTypeEnable && repairs.DeliveryDTO === null)) &&\r\n        repairs.OutboundStatus === 'Ready To PickUp'\r\n    ) {\r\n      return 'card-table-yellow';\r\n    } else if (\r\n      repairs.OutboundStatus === 'Picked Up' ||\r\n        repairs.DeliveryDTO !== null\r\n    ) {\r\n      return 'card-table-green';\r\n    } else {\r\n      return 'card-table-gray';\r\n    }\r\n  }\r\n\r\n  /**\r\n       * getHeaderTableDarkClass\r\n       */\r\n  getHeaderTableDarkClass(repairs: any, type = 'background'): string {\r\n    if(type === 'background') {\r\n      if (\r\n        repairs.OutboundStatus === null ||\r\n        repairs.OutboundStatus === 'Repair Not Started' ||\r\n        repairs.OutboundStatus === 'Repair In Progress'\r\n      ) {\r\n        return 'header-table-gray-dark';\r\n      } else if (\r\n        (!repairs.IsDeliveryTypeEnable ||\r\n          (repairs.IsDeliveryTypeEnable && repairs.DeliveryDTO === null)) &&\r\n        repairs.OutboundStatus === 'Ready To PickUp'\r\n      ) {\r\n        return 'header-table-yellow-dark';\r\n      } else if (\r\n        repairs.OutboundStatus === 'Picked Up' ||\r\n        repairs.DeliveryDTO !== null\r\n      ) {\r\n        return 'header-table-green-dark';\r\n      } else {\r\n        return 'card-table-gray-dark';\r\n      }\r\n    } else if (type === 'text') {\r\n      if (\r\n        repairs.OutboundStatus === null ||\r\n        repairs.OutboundStatus === 'Repair Not Started' ||\r\n        repairs.OutboundStatus === 'Repair In Progress'\r\n      ) {\r\n        return 'header-table-gray-dark-text';\r\n      } else if (\r\n        (!repairs.IsDeliveryTypeEnable ||\r\n          (repairs.IsDeliveryTypeEnable && repairs.DeliveryDTO === null)) &&\r\n        repairs.OutboundStatus === 'Ready To PickUp'\r\n      ) {\r\n        return 'header-table-yellow-dark-text';\r\n      } else if (\r\n        repairs.OutboundStatus === 'Picked Up' ||\r\n        repairs.DeliveryDTO !== null\r\n      ) {\r\n        return 'header-table-green-dark-text';\r\n      } else {\r\n        return 'header-table-gray-dark-text';\r\n      }\r\n    } else return ''\r\n  }\r\n\r\n  /**\r\n       * getHeaderTableClass\r\n       */\r\n  getHeaderTableClass(repairs: any): string {\r\n    if (\r\n      repairs.OutboundStatus === null ||\r\n        repairs.OutboundStatus === 'Repair Not Started' ||\r\n        repairs.OutboundStatus === 'Repair In Progress'\r\n    ) {\r\n      return 'header-table-gray';\r\n    } else if (\r\n      (!repairs.IsDeliveryTypeEnable ||\r\n          (repairs.IsDeliveryTypeEnable && repairs.DeliveryDTO === null)) &&\r\n        repairs.OutboundStatus === 'Ready To PickUp'\r\n    ) {\r\n      return 'header-table-yellow';\r\n    } else if (\r\n      repairs.OutboundStatus === 'Picked Up' ||\r\n        repairs.DeliveryDTO !== null\r\n    ) {\r\n      return 'header-table-green';\r\n    } else {\r\n      return 'card-table-gray';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * update Date\r\n   */\r\n  updateDate(): void {\r\n    this.currentDate = dayjs().format('MMMM DD, YYYY hh:mm a');\r\n  }\r\n\r\n  /**\r\n   * getOutboundData\r\n   */\r\n  getOutboundData(flag):void {\r\n    this.CallingAPI = true;\r\n    if(flag) this.commonService.showLoading();\r\n    const StartDate = new Date(new Date().toDateString()).toISOString();\r\n    const EndDate = new Date(new Date(new Date().toDateString()).getTime()+1000*60*60*24-1000).toISOString();\r\n    const query = `$filter=RepairEndDate ge ${StartDate} and RepairEndDate lt ${EndDate} or PickUpDate ge ${StartDate} and PickUpDate lt ${EndDate}`;\r\n\r\n    this.subs.push(this.OutboundService.getDeparturesDetails(query).subscribe({\r\n      next: (data) => {\r\n        this.CallingAPI = false;\r\n        this.outboundData = [];\r\n        data.value.forEach((item)=>{\r\n          if(item?.Jobs?.length > 0) {\r\n            if(item.PickUpDate !== null) {\r\n              if(!(new Date(StartDate) < new Date(item.PickUpDate) && new Date(EndDate) > new Date(item.PickUpDate))) {\r\n                return;\r\n              }\r\n            }\r\n            item['ImageUrlFirstLoad']=true;\r\n            item['ImageUrlLastLoad']=true;\r\n            this.outboundData.push(item);\r\n          }\r\n        });\r\n\r\n        this.LastRefreshed = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n        this.commonService.hideLoading();\r\n        clearTimeout(this.currentDateTimeout);\r\n        this.currentDateTimeout = setTimeout(()=>{\r\n          this.updateCurrentDateTime();\r\n        }, 60*1000);\r\n\r\n        setTimeout(()=>{\r\n          const nodes = document.querySelectorAll('.card');\r\n          if(this.FocusedRepairIndex == 0){\r\n            document.querySelector('.lounge-content').scrollTop = 0;\r\n          } else {\r\n            nodes[this.FocusedRepairIndex].scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n          }\r\n        }, 500);\r\n\r\n        clearTimeout(this.loungeTimeout);\r\n        this.loungeTimeout = setTimeout(()=>{ //call getOutboundData every 5 mins\r\n          this.getOutboundData(false);\r\n        }, 300000);\r\n      }, error: (error) => {\r\n        this.CallingAPI = false;\r\n        clearTimeout(this.loungeTimeout);\r\n      }\r\n    }))\r\n  }\r\n\r\n  /**\r\n   * updateCurrentDateTime\r\n   */\r\n  updateCurrentDateTime(): void {\r\n    this.autoScrollLastVisibleNode();\r\n\r\n    clearTimeout(this.currentDateTimeout);\r\n    this.currentDateTimeout = setTimeout(()=>{\r\n      this.updateCurrentDateTime();\r\n    }, 60*1000);\r\n  }\r\n\r\n  /**\r\n   * autoScrollLastVisibleNode\r\n   */\r\n  autoScrollLastVisibleNode(): void{\r\n    const container = document.querySelector('.lounge-content');\r\n    const nodes = document.querySelectorAll('.card');\r\n    if(container === null || container === undefined || nodes === null || nodes === undefined) {\r\n      return;\r\n    }\r\n    if(this.FocusedRepairIndex == nodes.length-1){\r\n      this.FocusedRepairIndex = 0;\r\n      container.scrollTop = 0;\r\n      return;\r\n    }\r\n\r\n    let visibleHeight = 0;\r\n    const totalHeight = container.clientHeight;\r\n\r\n    for(let i = this.FocusedRepairIndex; i < nodes.length; i++){\r\n      visibleHeight += nodes[i].clientHeight;\r\n      if(visibleHeight >= totalHeight){\r\n        this.FocusedRepairIndex = i;\r\n        nodes[i].scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n        break;\r\n      }\r\n      if(i === nodes.length-1){\r\n        this.FocusedRepairIndex = 0;\r\n        container.scrollTop = 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param event\r\n   */\r\n  @HostListener('document:fullscreenchange', [ '$event' ])\r\n  @HostListener('document:webkitfullscreenchange', [ '$event' ])\r\n  @HostListener('document:mozfullscreenchange', [ '$event' ])\r\n  @HostListener('document:MSFullscreenChange', [ '$event' ])\r\n  @HostListener('document:onwebkitfullscreenchange', [ '$event' ])\r\n  fullscreenmodes(event): void{\r\n    this.chkScreenMode();\r\n  }\r\n\r\n  /**\r\n   * check screen mode\r\n   */\r\n  chkScreenMode(): void{\r\n    if(document.fullscreenElement || document['webkitIsFullScreen']){\r\n      //fullscreen\r\n      this.isFullScreen = true;\r\n    }else{\r\n      //not in full screen\r\n      this.isFullScreen = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * open in full screen\r\n   */\r\n  openFullscreen(): void {\r\n    if (this.elem.requestFullscreen) {\r\n      this.elem.requestFullscreen();\r\n    } else if (this.elem.mozRequestFullScreen) {\r\n      /* Firefox */\r\n      this.elem.mozRequestFullScreen();\r\n    } else if (this.elem.webkitRequestFullscreen) {\r\n      /* Chrome, Safari and Opera */\r\n      this.elem.webkitRequestFullscreen();\r\n    } else if (this.elem.msRequestFullscreen) {\r\n      /* IE/Edge */\r\n      this.elem.msRequestFullscreen();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * OnDestroy\r\n   */\r\n  ngOnDestroy(): void {\r\n    this.subs.forEach(sub=>sub.unsubscribe());\r\n    clearTimeout(this.loungeTimeout);\r\n    clearInterval(this.timeInterval);\r\n  }\r\n}\r\n","<div class=\"dialog-with-header\">\r\n    <div class=\"header\" >\r\n        <div class=\"title\">\r\n            {{data.job.JobName}}\r\n        </div>\r\n        <div class=\"action\">\r\n            <button class=\"close-dailog-btn\">\r\n                <mat-icon [svgIcon]=\"'cross'\" color=\"white\" [mat-dialog-close]=\"\"></mat-icon>\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <mat-dialog-content class=\"mat-content-dialog\">\r\n\r\n        <mat-card class=\"repair-card border-10\">\r\n            <div class=\"repair-table-header\">\r\n                <div *ngIf=\"allMandatoryTasks > 0\" class=\"mandatory-div\"><span\r\n                    class=\"mandatory-text text-danger\">{{'label_mandatory' |\r\n                    translate\r\n                    }}</span></div>\r\n                <table class=\"repair-dialog-table\">\r\n                    <tr class=\"task-hearder\">\r\n                        <th class=\"task-hearder-item task_Name_column\">{{'item_name' | translate}}</th>\r\n                        <th class=\"task-hearder-item repair_type_column\">{{'repair_type' | translate}}</th>\r\n                        <th class=\"task-hearder-item modified_column\">{{'modified_by' | translate}}</th>\r\n                        <th class=\"task-hearder-item note_column\">{{'notes' | translate}}</th>\r\n                        <th class=\"task-hearder-item status_column\">{{'done' | translate}}</th>\r\n                    </tr>\r\n                </table>\r\n            </div>            \r\n            <table class=\"repair-dialog-table\">\r\n                <tr *ngFor=\"let task of ListOfRepairs; let i = index;\" class=\"task-data-row\">\r\n                    <td class=\"task-data-item task_Name_column\"><span class=\"task-data\">{{task.name}}<span class=\"text-danger\" *ngIf=\"task.isMandatory\">*</span></span></td>\r\n                    <td class=\"task-data-item repair_type_column\">\r\n                        <span class=\"task-data\" *ngFor=\"let repair of task.repairJobMappings; let ind = index;\">\r\n                            {{repair.repairServiceTypeName}}<span *ngIf=\"ind !== task.repairJobMappings.length - 1\">, </span>\r\n                        </span>\r\n                    </td>\r\n                    <td class=\"task-data-item modified_column\"><div class=\"task-data\">\r\n                        <div class=\"modified_name\">{{task.modifiedBy}}</div>\r\n                        <div class=\"span-date\" *ngIf=\"task.completedDate\">{{task.completedDate | date: 'dd/MM/yyyy\r\n                            hh:mm:ss'}}</div>\r\n                        </div></td>\r\n                    <td class=\"task-data-item note_column\"><span class=\"task-data\">\r\n                        <mat-icon [svgIcon]=\"'comment'\" [color]=\"'black'\"></mat-icon>\r\n                    </span></td>\r\n                    <td class=\"task-data-item status_column\">\r\n\r\n                        <div class=\"col-2 relate-spinner\">\r\n                            <span *ngIf=\"task.completedBy !== null\" class=\"checked\"></span>\r\n                            <span *ngIf=\"task.completedBy === null\" class=\"circle\"></span>\r\n                            {{ 'task_done' | translate }}\r\n                        </div>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </mat-card>\r\n        <div *ngIf=\"ListOfRepairs.length===0 && !CallingAPI\">\r\n            <span class=\"not-found-task\">{{'no_task_found' | translate}}</span>\r\n        </div>\r\n        \r\n    </mat-dialog-content>\r\n</div>","import { Component, OnDestroy, OnInit, Inject } from '@angular/core';\r\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { NavigationStart, Router, RouterEvent } from '@angular/router';\r\nimport { Subscription, filter, take, tap } from 'rxjs';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\nimport { OutboundComponent } from '../outbound/outbound.component';\r\nimport { OutboundService } from 'src/app/services/outbound/outbound.service';\r\n\r\n@Component({\r\n  selector: 'app-check-in-task',\r\n  templateUrl: './check-in-task.component.html',\r\n  styleUrls: [ './check-in-task.component.scss' ],\r\n  providers: [ OutboundService ],\r\n})\r\nexport class CheckInTaskComponent implements OnInit, OnDestroy{\r\n\r\n  \r\n  /**\r\n  * constructor\r\n  */\r\n  constructor(\r\n    public dialog: MatDialog,\r\n    public dialogRef: MatDialogRef<OutboundComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: any,\r\n    router: Router,\r\n    private OutboundService: OutboundService,\r\n    private commonService: CommonService\r\n  ) {\r\n\r\n    // Close dialog ref on route changes\r\n    router.events.pipe(\r\n      filter((event: RouterEvent) => event instanceof NavigationStart),\r\n      tap(() => this.dialogRef.close()),\r\n      take(1),\r\n    ).subscribe();\r\n  }\r\n  \r\n  public subs: Subscription[] = [];\r\n  public ListOfRepairs: any[] = [];\r\n  public CallingAPI = false;\r\n  public allMandatoryTasks: number = 0;\r\n\r\n  /**\r\n  * ngOnInit\r\n  */\r\n  ngOnInit(): void {\r\n    this.getTaskDetails();\r\n  }\r\n\r\n  /**\r\n  * getTaskDetails\r\n  */\r\n  getTaskDetails(): void{\r\n    const repairId: string = this.data.repair.RepairGuid;\r\n    const jobId: string = this.data.job.JobGuid;\r\n    this.CallingAPI = true;\r\n    this.commonService.showLoading();\r\n    this.subs.push(this.OutboundService.getTaskDetails(repairId, jobId).subscribe({\r\n      next: (data: object[]) => {\r\n        this.ListOfRepairs = data;\r\n        this.allMandatoryTasks = this.ListOfRepairs.filter((task) => {\r\n          return task.isMandatory === true;\r\n        }).length;\r\n        this.CallingAPI = false;\r\n        this.commonService.hideLoading();\r\n      }, error: (error) =>{\r\n        this.CallingAPI = false;\r\n      }\r\n    }))\r\n  }\r\n\r\n  /**\r\n     * ngOnDestroy\r\n     */\r\n  ngOnDestroy(): void{\r\n    this.subs.forEach(sub=>sub.unsubscribe());\r\n  }\r\n\r\n}\r\n","<div class=\"page-container outbound-container mh-0 mt-0 fx-col\">\r\n    <div class=\"fx-0 outbound-header\">\r\n        <div class=\"fx-row date-filter-wrapper\" style=\"padding-bottom: 26px;\">\r\n            <div class=\"fx-row change-week-btn\">\r\n                <div class=\"fx-row align-center week-days-tile\">\r\n                    <button type=\"button\" class=\"btn btn-left\" (click)=\"changeCurrentWeek('left')\">\r\n                        <mat-icon color=\"black\" svgIcon=\"arrow-left\"></mat-icon>\r\n                    </button>\r\n                    <span class=\"week-tile-content\">{{dates[0] | date: 'dd'}}-{{dates[6] | date: 'dd'}} {{dates[0] | date: 'MMM'}} {{dates[0] | date: 'YY'}} ({{currentWeekNumber}})</span>\r\n                    <button type=\"button\" class=\"btn btn-right\" (click)=\"changeCurrentWeek('right')\">\r\n                        <mat-icon color=\"black\" svgIcon=\"arrow-right\"></mat-icon>\r\n                    </button>\r\n                </div>\r\n                <button type=\"button\" class=\"btn current-week-btn\" (click)=\"TodayWeek()\">{{'today' | translate}}</button>\r\n            </div>\r\n            <div class=\"fx-row week-tiles\">\r\n                <button type=\"button\" class=\"day-tile\" *ngFor=\"let day of dates\" [ngClass]=\"day.getDay() === currentWeek.getDay()?'active':''\" (click)=\"changeCurrentDate(day)\"><span>{{day | date: 'dd EEEE'}}</span><span>{{day | date: 'MMM'}}</span></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"outbound-container-wrapper\">\r\n        <div class=\"outbound-card\" *ngIf=\"departures.length > 0\">\r\n            <div class=\"card-header fx-row justify-space-between\">\r\n                <div class=\"fx-col left-content\">\r\n                    <label>\r\n                        {{currentWeek | date: 'EEEE, d MMMM y'}}\r\n                    </label>\r\n                    <div class=\"last-updated\">{{'last_refreshed' | translate}}: {{lastUpdated}}</div>\r\n                </div>\r\n                <div class=\"fx-row right-content\">\r\n                    <div class=\"fx-row align-center repair-count\">\r\n                        <mat-icon color=\"dark-gray\">directions_car</mat-icon>\r\n                        <label>{{departures.length}}</label>\r\n                    </div>\r\n                    <div class=\"fx-row align-center total-amount\">\r\n                        <mat-icon style=\"margin-right:8px\" svgIcon=\"double-database\"></mat-icon>\r\n                        <label>{{TotalAmount | xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}</label>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- <span class=\"card-header flex\">\r\n                <p><b>{{items.Day === null?'': items.Day| date: 'EEEE, d MMMM y'}}</b></p>\r\n                <span class=\"flex\">\r\n                    <span class=\"flex align-center\" style=\"margin: 0px 16px;\">\r\n                        <mat-icon color=\"dark-gray\" style=\"margin-right:8px\">directions_car</mat-icon>\r\n                        <label><b>{{items.NumberOfRepairs}}</b></label>\r\n                    </span>\r\n                    <span class=\"flex align-center\">\r\n                        <mat-icon style=\"margin-right:8px\" svgIcon=\"double-database\"></mat-icon>\r\n                        <label><b>{{items.TotalAmount | xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}</b></label>\r\n                    </span>\r\n                </span>\r\n            </span> -->\r\n            <mat-card class=\"card border-10\" *ngFor=\"let repairs of  departures; let j = index;\" [ngClass]=\"repairs.OutboundStatus===null || repairs.OutboundStatus==='Repair Not Started' || repairs.OutboundStatus==='Repair In Progress'?'card-table-gray':repairs.OutboundStatus==='Ready To PickUp'?'card-table-yellow':repairs.OutboundStatus==='Picked Up'?'card-table-green':'card-table-gray'\">\r\n                <table style=\"padding-bottom:8px\" [ngClass]=\"repairs.OutboundStatus===null || repairs.OutboundStatus==='Repair Not Started' || repairs.OutboundStatus==='Repair In Progress'?'header-table-gray':repairs.OutboundStatus==='Ready To PickUp'?'header-table-yellow':repairs.OutboundStatus==='Picked Up'?'header-table-green':'card-table-gray'\" class=\"header-table border-top-10\">\r\n                    <tr style=\"text-align: left;padding: 10px;display: flex;justify-content: space-between;\">\r\n                        <th><div class=\"header-type-text\">{{'booking_id' | translate}}</div><div class=\"header-content link\" (click)=\"bookingStatusUrl(repairs)\">{{repairs.RepairNumber}}</div></th>\r\n                        <th><div class=\"header-type-text\">{{'work_provider' | translate}}</div><div class=\"header-content\">{{repairs.WorkProviderName}}</div></th>\r\n                        <th><div class=\"header-type-text\">{{'driver_owner_name' | translate}}</div><div class=\"header-content\">{{repairs.CustomerName}}</div></th>\r\n                        <th><div class=\"header-type-text\">{{'vehicle' | translate}}</div><div class=\"header-content\">{{repairs.VehicleMake}} {{repairs.VehicleName}}</div></th>\r\n                        <th *ngIf=\"repairs.Assignees.length > 0\"><div class=\"header-type-text\">{{'assigned' | translate}}</div><div class=\"header-content\"><div class=\"flex\" *ngFor=\"let assignee of repairs.Assignees\">{{assignee.AssigneeName}}</div></div></th>\r\n                        <th><div class=\"header-type-text\">{{'cost' | translate}}</div>\r\n                            <div class=\"flex align-center header-content\">                                \r\n                                <div>{{repairs.TotalAmount | xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}</div>\r\n                            </div>                           \r\n                        </th>\r\n                        <th *ngIf=\"repairs.RepairServiceTypes.length > 0\"><div class=\"header-type-text\">{{'repair_types' | translate}}</div>\r\n                            <div class=\"flex align-center\" style=\"flex-wrap: wrap;\">\r\n                                <div class=\"header-repair-type\" *ngFor=\"let type of repairs.RepairServiceTypes\">\r\n                                    <button class=\"outbound-icon-btn\" matTooltip=\"{{(type.Name===null?'Others':type.Name) | lowercase | translate}}\" matTooltipPosition=\"above\">\r\n                                        <mat-icon [svgIcon]=\"jobIconDictionary[type.Name]?jobIconDictionary[type.Name]:'gears'\" [attr.color]=\"'black'\"></mat-icon>\r\n                                    </button>                                    \r\n                                </div>\r\n                            </div>                           \r\n                        </th>\r\n                        <th *ngIf=\"repairs.IsTowedIn\"><div class=\"header-type-text\"></div>\r\n                            <div class=\"is-towing\">\r\n                                <button class=\"outbound-icon-btn\" [matTooltip]=\"(repairs.IsTowedIn?'towed_in':'not_towed_in') | translate\" matTooltipPosition=\"above\">\r\n                                    <mat-icon [svgIcon]=\"'towing'\" [attr.color]=\"repairs.IsTowedIn ? 'black' : 'dark-gray-disabled'\"></mat-icon>\r\n                                </button>\r\n                            </div>\r\n                        </th>\r\n                    </tr>\r\n                </table>\r\n                <div class=\"outbound-card-content border-bottom-10\">\r\n                    <div class=\"outbound-jobs-container fx-row align-center\">\r\n                        <div class=\"move-left-wrapper\" *ngIf=\"checkJobWrapperScroll('left',job_scroll_wrapper)\">\r\n                            <button type=\"button\" class=\"jobs-move-btn\" (click)=\"move_scroll('left',job_scroll_wrapper)\">\r\n                                <mat-icon color=\"black\" svgIcon=\"arrow-left\"></mat-icon>\r\n                            </button>\r\n                        </div>\r\n                        <div class=\"outbound-jobs-wrapper\" #job_scroll_wrapper>\r\n                            <table class=\"outbound-table border-bottom-10\">\r\n                                <tr class=\"flex align-center\">\r\n                                    <th>\r\n                                        <div class=\"img-container\">\r\n                                            <img [src]=\"repairs.ImageUrlFirst===null?'assets/img/front-left.png':repairs.ImageUrlFirst\" class=\"rapair-car-img\" (load)=\"repairs.ImageUrlFirstLoad=false;\" alt=\"\">\r\n                                            <chq-customloader [showLoading]=\"repairs.ImageUrlFirstLoad\"></chq-customloader>                                        \r\n                                        </div>\r\n                                    </th>\r\n                                    <th *ngFor=\"let job of repairs.Jobs; let i = index\">\r\n                                        <div class=\"outbound-header-card\" [style.background-color]=\"job.Color\" (click)=\"openJobpopup(repairs,job)\">\r\n                                            <div>\r\n                                                <span class=\"uppercase\">{{job.JobName}}</span>\r\n                                            </div>\r\n            \r\n                                            <p>{{job.CompletePercentage}}%</p>\r\n                                        </div>\r\n                                    </th>\r\n                                    <th>\r\n                                        <div class=\"img-container\">\r\n                                            <img [src]=\"repairs.ImageUrlLast===null?'assets/img/front-left.png':repairs.ImageUrlLast\" (load)=\"repairs.ImageUrlLastLoad=false;\" alt=\"\">\r\n                                            <chq-customloader [showLoading]=\"repairs.ImageUrlLastLoad\"></chq-customloader>\r\n                                        </div>\r\n                                    </th>\r\n                                </tr>\r\n                            </table>\r\n                        </div>\r\n                        <div class=\"move-right-wrapper\" *ngIf=\"checkJobWrapperScroll('right',job_scroll_wrapper)\">\r\n                            <button type=\"button\"  class=\"jobs-move-btn\" (click)=\"move_scroll('right',job_scroll_wrapper)\">\r\n                                <mat-icon color=\"black\" svgIcon=\"arrow-right\"></mat-icon>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n    \r\n                    <div class=\"date-card flex align-end\">\r\n                        <div class=\"date-selector\">\r\n                            <div class=\"input-wrapper flex align-end\">\r\n                                <div class=\"pickup_wrapper\">\r\n                                    <label class=\"input-label text-muted uppercase\">{{ PickUpDateTextBox.label | translate }}</label>\r\n                                    <dx-date-box\r\n                                    [value]=\"repairs.PickUpDate\" [acceptCustomValue]=\"false\"\r\n                                    type=\"datetime\" [invalidDateMessage]=\"''\" [max]=\"PickUpDateTextBox.maxDate\"\r\n                                    [min]=\"PickUpDateTextBox.minDate\" [validationError]=\"false\" [validationMessageMode]=\"'none'\"\r\n                                    [disabled]=\"!isTechnician?repairs.OutboundStatus !=='Ready To PickUp':true\"\r\n                                    (onValueChanged)=\"updateInput($event, repairs.RepairGuid,j)\"\r\n                                  >\r\n                                  </dx-date-box>\r\n                                  <span *ngIf=\"repairs?.PickupDateError\" class=\"pickupDate-error input-label text-muted\">Pick up date cannot set as past date</span>\r\n                                </div>\r\n    \r\n                                <chq-button [buttonModel]=\"notifyButton\" *ngIf=\"!isTechnician?!repairs.IsPickedUp && repairs.PickUpDate !== null && repairs.OutboundStatus ==='Ready To PickUp' && repairs.CommunicationTypes.length > 0: false\" (click)=\"openEmailForNotify(repairs)\" class=\"notify-btn\">\r\n                                </chq-button>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <div class=\"day-counter\">\r\n                            <span class=\"text-muted\">{{'initial_booking_out_date' | translate}}: {{date_format(repairs.BookingEndDate)}} | {{repairs.LagInDays}} {{'days' | translate}}</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </mat-card>\r\n        </div>\r\n        <div class=\"no-data-wrapper\" *ngIf=\"departures.length === 0 && !CallingAPI\">\r\n            <div class=\"no-data-content\">\r\n                <img src=\"assets/img/no-data.png\" alt=\"\">\r\n                <span>{{'no_result_found' | translate}}</span>\r\n                <span>{{'could_not_find_any_data' | translate}}.</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"footer-full-wrapper\">\r\n    <div class=\"footer-image-wrapper\">\r\n        <div class=\"image-wrapper\">\r\n            <img src=\"assets/img/addenda-repair.png\" alt=\"\"/>\r\n        </div>\r\n    </div>\r\n</div>","import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport * as dayjs from 'dayjs';\r\nimport { ChqWidgetsInputModel } from 'src/app/model/chq-widgets-input-model';\r\nimport { OutboundService } from 'src/app/services/outbound/outbound.service';\r\nimport { CheckInTaskComponent } from '../check-in-task/check-in-task.component';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { DatePipe } from '@angular/common';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { NotifyDialogComponent } from 'src/app/dialogs/notify-dialog/notify-dialog.component';\r\nimport { CommonService, i18nInfo } from 'src/app/services/common/common.service';\r\nimport { BookingService } from 'src/app/services/booking/booking.service';\r\nimport { RepairStatusMapper } from 'src/app/config/route-mapper/repair-status-mapper';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-outbound',\r\n  templateUrl: './outbound.component.html',\r\n  styleUrls: [ './outbound.component.scss' ],\r\n  providers: [ OutboundService ],\r\n})\r\n\r\nexport class OutboundComponent implements OnInit, OnDestroy {\r\n\r\n  jobIconDictionary = {\r\n    'Body': 'car',\r\n    'Paint': 'paint-nozzle',\r\n    'Mechanical': 'mechanical',\r\n    'Electrical': 'electric',\r\n    'Tires': 'tire',\r\n    'Preparation': 'car-roof',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Check In': 'checkbox-open',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Panel Repair': 'door-panel',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Panel Fitup': 'door-panel',\r\n    'Polish': 'car-paint',\r\n    'Detailing': 'car-cleaning',\r\n    'Maintenance': 'maintenance',\r\n    'Diagnosis': 'diagnosis',\r\n    'Others': 'gears',\r\n  }\r\n  departures: any[] = []\r\n  subs: Subscription[] = []\r\n\r\n  public PickUpDateTextBox: ChqWidgetsInputModel = {\r\n    placeHolder: 'pickup_date',\r\n    label: 'pick_up_date_time',\r\n    name: '',\r\n    type: 'datetime',\r\n    maxDate: dayjs().add(6, 'month').toDate(),\r\n    minDate: new Date(),\r\n    value: new Date(),\r\n  }\r\n\r\n  public notifyButton: ChqWidgetsButtonModel = {\r\n    label: 'notify',\r\n    type: 'outline',\r\n    icon: 'send'\r\n  }\r\n\r\n\r\n  currentWeek: Date = new Date();\r\n  currentWeekNumber: number = 1;\r\n  dates: Array<Date> = [];\r\n  public IntervalGetOutBound = null;\r\n  public lastUpdated = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n  public CallingAPI = false;\r\n  i18n: i18nInfo;\r\n  public isTechnician: boolean = false;\r\n  public TotalAmount: any = 0;\r\n\r\n  /**\r\n     * Creates an instance of DeparturesComponent.\r\n     * @constructor\r\n     * @param {Router} router\r\n     * @param {OutboundService} OutboundService\r\n     *  @param {MatDialog} dialog\r\n     *  @param {DatePipe} datePipe\r\n     * @param {CommonService} CommonService\r\n     */\r\n  constructor(private OutboundService: OutboundService,\r\n    private router: Router,\r\n    public dialog: MatDialog,\r\n    private datePipe: DatePipe,\r\n    private bookingService: BookingService,\r\n    private commonService: CommonService,) {\r\n    this.i18n = this.commonService.geti18nInfo();\r\n    this.getWeekDates(new Date(this.currentWeek));\r\n  }\r\n\r\n\r\n  /**\r\n     * ngOnInit\r\n     */\r\n  ngOnInit(): void {\r\n    this.getDeparturesDetails();\r\n\r\n    this.commonService.userProfileData.subscribe((res) => {\r\n      if (res?.data) {\r\n        const automotiveServices = res?.data?.userPermission?.automotiveServices;\r\n        const automotiveService = automotiveServices?.find(x => x.automotiveServiceName.toLowerCase() === 'addenda repair');\r\n        if (automotiveService && automotiveService.roleName.toLowerCase() === 'technician') {\r\n          this.isTechnician = true;\r\n        } else {\r\n          this.isTechnician = false;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * getOutBoundData\r\n   */\r\n  public async getDeparturesDetails(): Promise<void> {\r\n    this.CallingAPI = true;\r\n    this.commonService.showLoading();\r\n    this.departures = [];\r\n    const StartDate = new Date(this.currentWeek.toDateString()).toISOString();\r\n    const EndDate = new Date(new Date(this.currentWeek.toDateString()).getTime()+1000*60*60*24-1000).toISOString();\r\n    const query = `$filter=BookingEndDate ge ${StartDate} and BookingEndDate lt ${EndDate} or PickUpDate ge ${StartDate} and PickUpDate lt ${EndDate}`;\r\n    this.subs.push(this.OutboundService.getDeparturesDetails(query).subscribe({\r\n      next: (data) => {\r\n        this.CallingAPI = false;\r\n        this.TotalAmount = 0;\r\n        data.value.forEach((el) => {\r\n          if(el.PickUpDate !== null) {\r\n            if(!(new Date(StartDate) < new Date(el.PickUpDate) && new Date(EndDate) > new Date(el.PickUpDate))) {\r\n              return;\r\n            }\r\n          }\r\n          el['ImageUrlFirstLoad'] = true;\r\n          el['ImageUrlLastLoad'] = true;\r\n          this.TotalAmount += el.TotalAmount; \r\n          this.departures.push(el);\r\n        });\r\n\r\n        this.lastUpdated = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n        this.commonService.hideLoading();\r\n\r\n        clearTimeout(this.IntervalGetOutBound);\r\n        this.IntervalGetOutBound = setTimeout(() => { //call getWorkflow every 5 mins\r\n          this.getDeparturesDetails();\r\n        }, 300000);\r\n      }, error: (error) => {\r\n        this.CallingAPI = false;\r\n        clearTimeout(this.IntervalGetOutBound);\r\n      }\r\n    }))\r\n  }\r\n\r\n\r\n  /**\r\n     * date_format\r\n     * return date format \r\n     * example 28 Wednesday, of June 2023\r\n     *@param date data \r\n  \r\n     * @returns {string}\r\n     */\r\n  date_format(date: Date): string {\r\n    return dayjs(date).format('D dddd, of MMMM YYYY');\r\n  }\r\n\r\n  /**\r\n  * updateInput\r\n  * update pickup date\r\n  */\r\n  updateInput(e, repairId: string, repairIndex: number): void {\r\n    this.departures[repairIndex]['PickupDateError'] = false;\r\n    if (new Date(e.value) < new Date()) {\r\n      this.departures[repairIndex]['PickupDateError'] = true;\r\n      return;\r\n    }\r\n\r\n\r\n    const pickupDate: string = new Date(e.value).toISOString();\r\n\r\n    if (new Date(pickupDate) == new Date(this.departures[repairIndex].PickUpDate)) {\r\n      return;\r\n    }\r\n\r\n    this.commonService.showLoading();\r\n    this.subs.push(this.OutboundService.setPickupDate(repairId, pickupDate, false).subscribe({\r\n      next: (data) => {\r\n        this.commonService.showInfoToast(1000, data.message);\r\n        this.commonService.hideLoading();\r\n      }\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * openJobpopup\r\n   * @param { string } jobId\r\n   */\r\n  openJobpopup(repair: object, job: object): void {\r\n    this.dialog.open(CheckInTaskComponent, { data: { 'repair': repair, 'job': job } });\r\n  }\r\n\r\n  /**\r\n   * GetWeekNumber()\r\n   * \r\n   * @param {Date} date\r\n   */\r\n  getWeekNumber(date: Date): number {\r\n\r\n    const currentDate: any = date;\r\n    const startDate: any = new Date(currentDate.getFullYear(), 0, 1);\r\n    const days = Math.floor((currentDate - startDate) /\r\n      (24 * 60 * 60 * 1000));\r\n\r\n    const weekNumber = Math.ceil(days / 7);\r\n    return weekNumber;\r\n  }\r\n\r\n\r\n  /**\r\n    * getWeekDates\r\n    * change months as well when month about to end\r\n    */\r\n  getWeekDates(date: Date): any[] {\r\n    const daysInWeek = 7;\r\n    const dates = [];\r\n    const week = date.getDay() == 0 ? daysInWeek : date.getDay();\r\n    const start_date = new Date(date.setDate(date.getDate() - week + 1));\r\n\r\n    for (let i = 0; i < daysInWeek; i++) {\r\n      const temp_date = new Date(start_date);\r\n      const new_date: Date = new Date(temp_date.setDate(start_date.getDate() + i));\r\n      if (new_date.getMonth() < start_date.getMonth() && new_date.getMonth() == date.getFullYear()) {\r\n        new_date.setMonth(start_date.getMonth());\r\n      }\r\n      dates.push(new_date);\r\n    }\r\n\r\n    this.currentWeekNumber = this.getWeekNumber(this.currentWeek);\r\n    this.dates = dates;\r\n    return dates;\r\n  }\r\n\r\n  /**\r\n  * changeCurrentWeek\r\n  */\r\n  changeCurrentWeek(direction: string): void {\r\n    if (direction === 'left') {\r\n      const temp_date = this.dates[0];\r\n      this.currentWeek = new Date(temp_date.setDate(temp_date.getDate() - 7));\r\n    } else {\r\n      const temp_date = this.dates[6];\r\n      this.currentWeek = new Date(temp_date.setDate(temp_date.getDate() + 1));\r\n    }\r\n\r\n    this.getWeekDates(new Date(this.currentWeek));\r\n    this.departures = [];\r\n    this.getDeparturesDetails();\r\n  }\r\n\r\n  /**\r\n  * TodayWeek\r\n  */\r\n  TodayWeek(): void {\r\n    this.currentWeek = new Date();\r\n    this.getWeekDates(new Date(this.currentWeek));\r\n    this.departures = [];\r\n    this.getDeparturesDetails();\r\n  }\r\n\r\n  /**\r\n  * changeCurrentDate\r\n  *@param day { date } \r\n  */\r\n  changeCurrentDate(day: Date): void {\r\n    this.currentWeek = day;\r\n    this.departures = [];\r\n    this.getDeparturesDetails();\r\n  }\r\n\r\n  /**\r\n   * move_scroll\r\n   */\r\n  move_scroll(direction, el): void {\r\n    if (direction === 'left') {\r\n      el.scrollLeft = el.scrollLeft - 160;\r\n    } else {\r\n      el.scrollLeft = el.scrollLeft + 160;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * checkJobWrapperScroll\r\n   */\r\n  checkJobWrapperScroll(direction, el): boolean {\r\n    if (direction === 'left') {\r\n      return !(el.scrollLeft <= 0);\r\n    } else {\r\n      return !(el.scrollLeft >= el.scrollWidth - el.clientWidth - 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * openEmailForNotify\r\n   * \r\n   */\r\n  openEmailForNotify(RepairData: any): void {\r\n    this.commonService.showLoading();\r\n    this.bookingService.getRepairDetailByGuid(RepairData.RepairGuid).subscribe({\r\n      next: async (result: any) => {\r\n        if (result?.data) {\r\n          this.openEmailForNotifyInner(RepairData.RepairGuid, result.data.domainId, result.data.booking.communicationTypeId, result.data.communicationEvents);\r\n        }\r\n        this.commonService.hideLoading();\r\n      },\r\n      error: async (error: any) => {\r\n        this.commonService.hideLoading();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * openEmailForNotify\r\n   * \r\n   */\r\n  openEmailForNotifyInner(RepairGuid: any, domainId: string, communicationList: string, communicatedList: any[]): void {\r\n    this.dialog.open(NotifyDialogComponent, {\r\n      data: {\r\n        repairGuid: RepairGuid,\r\n        domainId: domainId,\r\n        templateId: 2,\r\n        communicationList: communicationList,\r\n        communicatedList: communicatedList\r\n        \r\n      },\r\n      backdropClass: 'confirmation-popup-backdrop',\r\n      maxHeight: '693px',\r\n      maxWidth: '629px'\r\n    });\r\n  }\r\n\r\n  /**\r\n   * booking url\r\n   */\r\n  bookingStatusUrl(repair: any): void {\r\n    const { RepairStatus, RepairGuid } = repair;\r\n    const status = RepairStatus.split(' ').join('');\r\n    let routeToRedirect = RepairStatusMapper[status?.toLowerCase()] || RepairStatusMapper.others;\r\n    routeToRedirect = routeToRedirect.replace('{{repairGUID}}', RepairGuid);\r\n    this.router.navigate([ routeToRedirect ]);\r\n  }\r\n\r\n  /**\r\n     * ngOnDestroy\r\n     */\r\n  ngOnDestroy(): void {\r\n    this.subs.forEach(sub => sub.unsubscribe());\r\n    clearTimeout(this.IntervalGetOutBound);\r\n  }\r\n}\r\n\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { Route, RouterModule } from '@angular/router';\r\nimport { MsalGuard } from '@azure/msal-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { DirectiveModule } from 'src/app/helper/directive.module';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\nimport { WidgetsModule } from '../../widgets/chq-widgets.module';\r\nimport { CustomerLayoutComponent } from './add-customers/customer-layout/customer-layout.component';\r\nimport { BookingJournalComponent } from './booking-journal/booking-journal/booking-journal.component';\r\nimport { EstimateApprovalComponent } from './estimate-approval/estimate-approval.component';\r\nimport { LoungeListComponent } from './lounge-list/lounge-list.component';\r\nimport { OutboundComponent } from './outbound/outbound/outbound.component';\r\nimport { WorkflowLoungeComponent } from './workflow-lounge/workflow-lounge.component';\r\nimport { WorkflowComponent } from './workflow/workflow/workflow.component';\r\nimport { RepairGuard } from 'src/app/guards/repair-guard/repair.guard';\r\n\r\nconst repairRoutes: Route[] = [\r\n  {\r\n    path: '',\r\n    pathMatch: 'full',\r\n    redirectTo: 'booking-journal'\r\n\r\n  },\r\n  {\r\n    path: 'booking',\r\n    canActivate: [ RepairGuard ],\r\n    loadChildren: () =>\r\n      import('../repair/add-customers/customers.module').then(\r\n        m => m.AddRepairCustomersModule\r\n      )\r\n  },\r\n  {\r\n    path: 'booking/:id',\r\n    component: CustomerLayoutComponent,\r\n    canActivate: [ RepairGuard ],\r\n    loadChildren: () =>\r\n      import('../repair/add-customers/customers.module').then(\r\n        m => m.AddRepairCustomersModule\r\n      )\r\n  },\r\n  {\r\n    path: 'customers',\r\n    canActivate: [ RepairGuard ],\r\n    loadChildren: () =>\r\n      import('../repair/customer/customer.module').then(\r\n        m => m.CustomerTableModule\r\n      )\r\n  },\r\n  {\r\n    path: 'booking-journal',\r\n    component: BookingJournalComponent,\r\n    canActivate: [ RepairGuard ],\r\n    loadChildren: () =>\r\n      import('../repair/booking-journal/booking-journal.module').then(\r\n        m => m.BookingJournalModule\r\n      )\r\n  },\r\n  {\r\n    path: 'workflow',\r\n    component: WorkflowComponent,\r\n    canActivate: [ RepairGuard ],\r\n    loadChildren: () =>\r\n      import('../repair/workflow/workflow.module').then(\r\n        m => m.WorkflowModule\r\n      )\r\n  },\r\n  {\r\n    path: 'outbound',\r\n    component: OutboundComponent,\r\n    canActivate: [ MsalGuard ],\r\n    loadChildren: () =>\r\n      import('../repair/outbound/outbound.module').then(\r\n        m => m.OutboundModule\r\n      )\r\n  },\r\n  {\r\n    path: 'lounge',\r\n    component: LoungeListComponent,\r\n    canActivate: [ MsalGuard ],\r\n    loadChildren: () =>\r\n      import('../repair/lounge-list/lounge-list.module').then(\r\n        m => m.LoungeListModule\r\n      )\r\n  },\r\n  {\r\n    path: 'workflow-lounge',\r\n    component: WorkflowLoungeComponent,\r\n    canActivate: [ MsalGuard ],\r\n    loadChildren: () =>\r\n      import('../repair/workflow-lounge/workflow-lounge.module').then(\r\n        m => m.WorkflowLoungeModule\r\n      )\r\n  }\r\n]\r\n\r\n@NgModule({\r\n  declarations: [\r\n    EstimateApprovalComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    SharedModule,\r\n    MatIconModule,\r\n    RouterModule.forChild(repairRoutes),\r\n    WidgetsModule,\r\n    TranslateModule,\r\n    DirectiveModule\r\n  ]\r\n})\r\nexport class RepairModule { }\r\n\r\n","<div class=\"page-container workflow-container mh-0 mt-0 fx-col\">\r\n    <div class=\"fx-0 lounge-list-header\">\r\n        <div class=\"header-content fx-row justify-space-between align-center\">\r\n            <chq-button style='margin-left: auto;' [buttonModel]=\"FullscreenButton\"\r\n                (click)=\"openFullscreen()\"></chq-button>\r\n            <div class=\"alignment-btn\" (click)=\"changeView()\">\r\n                <mat-icon *ngIf=\"!verticalView\" svgIcon=\"horizontal-alignment\"></mat-icon>\r\n                <mat-icon *ngIf=\"verticalView\" svgIcon=\"vertical-alignment\"></mat-icon>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"fullscreen\" *ngIf=\"isFullScreen\">\r\n        <div class=\"lounge-header fx-0 fx-col justify-center\">\r\n            <div class=\"lounge-header-content align-center fx-row\">\r\n                <a class=\"xa-logo-wrapper\">\r\n                    <div class=\"menu-image\">\r\n                        <img [src]=\"orgLogoUrl\" (error)=\"avatar='';\" (load)=\"orgImageLoading=false\" alt=\"\"\r\n                            *ngIf=\"orgLogoUrl else name\" />\r\n                        <ng-template #name>\r\n                            <label *ngIf=\"orgName\" class=\"org-name\">{{orgName}}</label>\r\n                        </ng-template>\r\n                        <chq-custom-loader [showLoading]=\"orgImageLoading\"></chq-custom-loader>\r\n                    </div>\r\n                </a>\r\n                <div class=\"lounge-title-wrapper\">{{'workflow_dashboard' | translate}}</div>\r\n                <div class='date-container'>\r\n                    <div class=\"lounge-date-wrapper\">{{currentDate}}</div>\r\n                    <div class=\"lounge-last-refresh\">{{'last_refreshed' | translate}}: {{LastRefreshedDate}}</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"workflow-table-container\" [class.fullscreen-table]=\"isFullScreen\" *ngIf=\"totalCost > 0 && totalCount > 0 && !verticalView\">\r\n        <table class=\"horizontal-workflow-table\"  aria-describedby=\"horizontal\">\r\n            <th class=\"d-none\"></th>\r\n            <tbody class=\"scroll-items-row\">\r\n                <tr class='job-item-row' *ngFor=\"let items of workflowData; let i = index\" [ngStyle]=\"{'min-height': calculatedHeight, 'height': calculatedHeight, 'max-height': calculatedHeight}\">\r\n                    <div class='job-item-cards'>\r\n                        <div class=\"workflow-row-container\" #horizontalRow>\r\n                            <div class=\"workflow-header-card\" [style.background-color]=\"items.IsJobFromMaster ?items.Color:'#DCDDE2'\"\r\n                                [style.color]=\"items.IsJobFromMaster ?'':'#0B0E15'\">\r\n                                <div class=\"card-content\">\r\n                                    <span class=\"uppercase\">{{items.JobName}}</span>\r\n                                    <div class=\"rounded-icon\">{{items.WaterfallRepairs.length}}</div>\r\n                                </div>\r\n                            </div>\r\n                            <div #cardContainer class='card-container'>\r\n                                <div class=\"workflow-details-card\"\r\n                                    *ngFor=\"let repair of items.WaterfallRepairs; let j = index\">\r\n                                    <div class=\"detail-card-link\">\r\n                                        <div class=\"img-container\">\r\n                                            <img [src]=\"(repair.ImageUrl !== null && repair.ImageUrl !== '') ? repair.ImageUrl : 'assets/img/front-left.png'\"\r\n                                                (load)=\"repair.isloaded=true;\" alt=\"\" [ngStyle]=\"{'width.px': horizontalRowHeight }\"/>\r\n                                        </div>\r\n                                        <div class=\"repair-items-container\">\r\n                                            <span class=\"due-date-span\">\r\n                                                {{'due_out' | translate}}: {{repair.RepairEndDate | date: 'dd/MM/yy' | translate}}\r\n                                            </span>\r\n                                            <span class=\"info-span\">\r\n                                                {{repair.VehicleMake + ' ' + repair.VehicleModel}}\r\n                                            </span>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n    <div class=\"vertical-workflow-table\" [class.fullscreen-table]=\"isFullScreen\" *ngIf=\"totalCost > 0 && totalCount > 0 && verticalView\">\r\n        <table class='vertical-table' aria-describedby=\"vertical view\">\r\n            <thead>\r\n                <tr>\r\n                    <th *ngFor=\"let items of workflowData;\" #verticalRow>\r\n                        <div class=\"header-container\" [style.background-color]=\"items.Color\" [ngClass]=\"{'repair-not-started': items.JobName.toLowerCase() === 'repair not started'}\">\r\n                            <div class=\"count\">{{items.WaterfallRepairs.length}}</div>\r\n                            <span class=\"title\">{{items.JobName | uppercase}}</span>\r\n                        </div>\r\n                    </th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr class='vertical-card-container'>\r\n                    <td class='vertical-card' *ngFor=\"let items of workflowData; let i = index\">\r\n                        <ng-container *ngFor=\"let repair of items.WaterfallRepairs;\">\r\n                            <div class=\"repair-container\">\r\n                                <div class=\"img-container\">\r\n                                    <img [src]=\"(repair.ImageUrl !== null && repair.ImageUrl !== '') ? repair.ImageUrl : 'assets/img/front-left.png'\" (load)=\"repair.isloaded=true;\" alt=\"\" [ngStyle]=\"{'height.px': verticalRowWidth }\"/>\r\n                                </div>\r\n                                <div class=\"repair-items-container\">\r\n                                    <span class=\"due-date-span\" [style.visibility]=\"repair.RepairEndDate ? 'visible': 'hidden'\" >\r\n                                        {{'due_out' | translate}}: {{repair.RepairEndDate | date: 'dd/MM/yy' | translate}}\r\n                                    </span>\r\n                                    <span class=\"info-span\">\r\n                                        {{repair.VehicleMake + ' ' + repair.VehicleModel}}\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                        </ng-container>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n    <div class=\"no-data-wrapper\"\r\n        *ngIf=\"(workflowData.length === 0 || (totalCost === 0 && totalCount === 0)) && !CallingAPI\">\r\n        <div class=\"no-data-content\">\r\n            <img src=\"assets/img/no-data.png\" alt=\"\">\r\n            <span>{{'no_result_found' | translate}}</span>\r\n            <span>{{'could_not_find_any_data' | translate}}.</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"footer-full-wrapper\">\r\n    <div class=\"footer-image-wrapper\">\r\n        <div class=\"image-wrapper\">\r\n            <img src=\"assets/img/addenda-repair.png\" alt=\"\" />\r\n        </div>\r\n    </div>\r\n</div>\r\n","import { AfterViewInit, Component, ElementRef, HostListener, OnDestroy, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder } from '@angular/forms';\r\nimport { MatSidenav } from '@angular/material/sidenav';\r\nimport { Router } from '@angular/router';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport * as dayjs from 'dayjs';\r\nimport { Observable, Subscription, forkJoin, map, of } from 'rxjs';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { ChqWidgetsInputModel, IControlValue } from 'src/app/model/chq-widgets-input-model';\r\nimport { WorkflowService } from 'src/app/services/workflow/workflow.service';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService, i18nInfo } from 'src/app/services/common/common.service';\r\n\r\n@Component({\r\n  selector: 'app-workflow-lounge',\r\n  templateUrl: './workflow-lounge.component.html',\r\n  styleUrls: [ './workflow-lounge.component.scss' ],\r\n  providers: [ WorkflowService ],\r\n})\r\n\r\nexport class WorkflowLoungeComponent implements OnInit, OnDestroy, AfterViewInit {\r\n\r\n  totalCost = 0;\r\n  totalCount = 0;\r\n  workflowData: any[] = [];\r\n  CallingAPI = false;\r\n  i18n: i18nInfo;\r\n  IntervalGetWorkflow = null;\r\n  autoScrollInterval = null;\r\n  timeInterval = null;\r\n  LastRefreshedDate = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n  public userDetail = null;\r\n  public userIsBM = false;\r\n  @ViewChild('filter') public filter: MatSidenav;\r\n\r\n  public filterButton: ChqWidgetsButtonModel = {\r\n    label: 'filter',\r\n    type: 'outline',\r\n    icon: 'filter'\r\n  }\r\n\r\n  public filterForm = this.formBuilder.group({\r\n    OrgName: [],\r\n    CustomerId: [],\r\n    CompanyId: []\r\n  });\r\n\r\n  public applyButton: ChqWidgetsButtonModel = {\r\n    label: 'apply',\r\n    type: 'primary'\r\n  }\r\n\r\n  public resetButton: ChqWidgetsButtonModel = {\r\n    label: 'reset_all',\r\n    type: 'outline'\r\n  }\r\n  public statusMap:{ [key: string]:string } = {\r\n    'Approved': 'Approved',\r\n    'PendingApproval': 'Pending Approval',\r\n    'RepairEstimation': 'Repair Estimation',\r\n    'UploadPhotos': 'Upload Photos',\r\n    'UploadDocuments': 'Upload Documents',\r\n    'Draft': 'Draft',\r\n  }\r\n\r\n  filterModal: ChqWidgetsInputModel[] = [\r\n    {\r\n      placeHolder: 'select_organization',\r\n      label: 'organization',\r\n      name: 'OrgName',\r\n      value: '',\r\n      type: 'select',\r\n      displayValue: 'label',\r\n      fieldValue: 'value',\r\n      options: [],\r\n      isMultiSelect: false\r\n    },\r\n    {\r\n      placeHolder: 'select_type',\r\n      label: 'customer_name',\r\n      name: 'CustomerId',\r\n      value: '',\r\n      type: 'select',\r\n      displayValue: 'label',\r\n      fieldValue: 'value',\r\n      options: [],\r\n      isMultiSelect: true\r\n    }\r\n  ];\r\n  filterDataLoaded: boolean = false;\r\n\r\n  repairSizeColors = {\r\n    'sm': 'bg-light-blue',\r\n    's': 'bg-light-blue',\r\n    'l': 'bg-light-green text-white',\r\n    'm': 'bg-light-pink text-white',\r\n    'xl': 'bg-dark-red text-white'\r\n  };\r\n  settingsButtonModel: ChqWidgetsButtonModel = {\r\n    label: 'filter',\r\n    type: 'outline',\r\n    icon: 'filter',\r\n    width: '13px',\r\n    height: '13px'\r\n  };\r\n\r\n  jobIconDictionary = {\r\n    'Body': 'car',\r\n    'Paint': 'paint-nozzle',\r\n    'Mechanical': 'mechanical',\r\n    'Electrical': 'electric',\r\n    'Tires': 'tire',\r\n    'Preparation': 'car-roof',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Check In': 'checkbox-open',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Panel Repair': 'door-panel',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Panel Fitup': 'door-panel',\r\n    'Polish': 'car-paint',\r\n    'Detailing': 'car-cleaning',\r\n    'Maintenance': 'maintenance',\r\n    'Diagnosis': 'diagnosis',\r\n    'Others': 'gears',\r\n  }\r\n\r\n  subs: Subscription[] = [];\r\n\r\n  public FullscreenButton: ChqWidgetsButtonModel = {\r\n    label: 'view_full_screen',\r\n    type: 'outline',\r\n    icon: 'fullscreen'\r\n  };\r\n  public currentDate: string = dayjs().format('MMMM DD, YYYY hh:mm a');\r\n  isFullScreen: boolean;\r\n\r\n  orgImageLoading: boolean = true;\r\n  orgLogoUrl: string = '';\r\n  orgName: string = '';\r\n  avatar: string | ArrayBuffer;\r\n  public FocusedRepairIndex = 0;\r\n  public FocusedRepairHorizontalIndex = 0;\r\n  calculatedHeight: string;\r\n  verticalView: boolean = false;\r\n\r\n  @ViewChild('horizontalRow') horizontalRow: ElementRef;\r\n  horizontalRowHeight: number = 0;\r\n\r\n  @ViewChild('verticalRow') verticalRow: ElementRef;\r\n  verticalRowWidth: number = 0;\r\n\r\n  /**\r\n   * constructor.\r\n   * @constructor\r\n   * @param {WorkflowService} workflowService\r\n   * @param {commonService} commonService\r\n   * @param {caseService} caseService\r\n   * @param {formBuilder} formBuilder\r\n   */\r\n  constructor(private workflowService: WorkflowService,\r\n    private router: Router,\r\n    private commonService: CommonService,\r\n    private caseService: CaseService,\r\n    private translateService: TranslateService,\r\n    private formBuilder: FormBuilder\r\n  ) {\r\n    this.i18n = this.commonService.geti18nInfo();\r\n    this.commonService.userProfileData.subscribe({\r\n      next: (res: any) => {\r\n        if (res) {\r\n          this.orgLogoUrl = res?.data.organizationDetail?.logoUrl;\r\n          this.orgName = res?.data.organizationDetail?.name;\r\n          if (!this.orgLogoUrl) {\r\n            this.orgImageLoading = false;\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * ngOnInit\r\n   */\r\n  ngOnInit(): void {\r\n    this.timeInterval = setInterval(()=> {\r\n      this.updateDate();\r\n    }, 1000);\r\n    this.commonService.userProfileData.subscribe((res) => {\r\n      this.userDetail = res?.data;\r\n      this.userIsBM = this.userDetail?.roleDetail.some(x => x.name == 'Bodyshop Manager');\r\n      if (this.userDetail?.organizationDetail?.id) {\r\n        this.filterForm.get('OrgName').setValue(this.userDetail.organizationDetail.id);\r\n      }\r\n    });\r\n    this.chkScreenMode();\r\n\r\n  }\r\n\r\n  /**\r\n   * update Date\r\n   */\r\n  updateDate(): void {\r\n    this.currentDate = dayjs().format('MMMM DD, YYYY hh:mm a');\r\n  }\r\n  /**\r\n   * move_scroll\r\n   */\r\n  move_scroll(direction, el): void {\r\n    if (direction === 'left') {\r\n      el.scrollLeft = el.scrollLeft - 250;\r\n    } else {\r\n      el.scrollLeft = el.scrollLeft + 250;\r\n    }\r\n  }\r\n\r\n  /**\r\n * checkJobWrapperScroll\r\n */\r\n  checkJobWrapperScroll(direction, el): boolean {\r\n    if (direction === 'left') {\r\n      return !(el.scrollLeft <= 0);\r\n    } else {\r\n      return !(el.scrollLeft >= el.scrollWidth - el.clientWidth - 1);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * auto scroll horizontally\r\n   */\r\n  horizontalScroll():void {\r\n\r\n    const parentContainer = document.querySelector('.workflow-table-container');\r\n    const container = document.querySelector('.scroll-items-row');\r\n    const nodes = container.querySelectorAll('.card-container');\r\n    if(container === null || container === undefined || nodes === null || nodes === undefined) {\r\n      return;\r\n    }\r\n\r\n    let visibleWidth = 0;\r\n    let longestNodeIndex = 0;\r\n    let longestNodeLength = 0;\r\n    const totalWidth = parentContainer.clientWidth\r\n    for(let i = 0; i < nodes.length; i++){\r\n      visibleWidth = 0;\r\n      if(longestNodeLength < nodes[i].children.length) {\r\n        longestNodeLength = nodes[i].children.length;\r\n        longestNodeIndex = i;\r\n      }\r\n    }\r\n    for(let i = this.FocusedRepairHorizontalIndex;i<nodes[longestNodeIndex].children.length;i++) {\r\n      if(i === nodes[longestNodeIndex].children.length - 1) {\r\n        this.FocusedRepairHorizontalIndex = 0;\r\n        parentContainer.scrollLeft = 0;\r\n      }\r\n      visibleWidth += nodes[longestNodeIndex].children[i].clientWidth + nodes[longestNodeIndex].children[i + 1]?.clientWidth ?? 0;\r\n      if(visibleWidth >= totalWidth){\r\n        this.FocusedRepairHorizontalIndex = i;\r\n        nodes[longestNodeIndex].children[i].scrollIntoView({ behavior: 'smooth', inline: 'start' });\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * auto scroll vertically\r\n   */\r\n  verticalScroll():void {\r\n\r\n    const parentContainer = document.querySelector('.vertical-workflow-table');\r\n    const container = document.querySelector('.vertical-card-container');\r\n    const nodes = container.querySelectorAll('.vertical-card');\r\n    if(container === null || container === undefined || nodes === null || nodes === undefined) {\r\n      return;\r\n    }\r\n    let visibleHeight = 0;\r\n    let longestNodeIndex = 0;\r\n    let longestNodeLength = 0;\r\n    const totalHeight = parentContainer.clientHeight\r\n    for(let i = 0; i < nodes.length; i++){\r\n      visibleHeight = 0;\r\n      if(longestNodeLength < nodes[i].children.length) {\r\n        longestNodeLength = nodes[i].children.length;\r\n        longestNodeIndex = i;\r\n      }\r\n    }\r\n    for(let i = this.FocusedRepairIndex;i<nodes[longestNodeIndex].children.length;i++) {\r\n      if(i === nodes[longestNodeIndex].children.length - 1) {\r\n        this.FocusedRepairIndex = 0;\r\n        parentContainer.scrollTop = 0;\r\n      }\r\n      visibleHeight += nodes[longestNodeIndex].children[i].clientHeight;\r\n      if(visibleHeight >= totalHeight){\r\n        this.FocusedRepairIndex = i;\r\n        nodes[longestNodeIndex].children[i].scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n        break;\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * ngAfterViewInit\r\n   */\r\n  ngAfterViewInit(): void {\r\n    //call autoScroll every 1 mins\r\n    this.autoScrollInterval = setInterval(()=> {\r\n      if(this.isFullScreen) {\r\n        if(this.verticalView) {\r\n          this.verticalScroll();\r\n        } else {\r\n          this.horizontalScroll();\r\n        }\r\n      }\r\n    }, 10000);\r\n    this.getWorkflowDetails(this.generateFilterQuery());\r\n    this.IntervalGetWorkflow = setInterval(() => { //call getWorkflow every 5 mins\r\n      this.getWorkflowDetails(this.generateFilterQuery());\r\n    }, 300000);\r\n\r\n  }\r\n\r\n  /**\r\n   * getWorkflowData\r\n   */\r\n  public async getWorkflowDetails(query): Promise<any> {\r\n    this.commonService.showLoading();\r\n    this.CallingAPI = true;\r\n    if (query !== '?$filter=') {\r\n      this.subs.push(this.workflowService.getWorkflowDetailsWithQuery(query).subscribe({\r\n        next: (data) => {\r\n          this.workflowData = this.getTotals(data.value);\r\n\r\n          if (this.workflowData) {\r\n            this.workflowData = this.workflowData.filter(x => x.JobName !== 'REPAIR NOT STARTED');\r\n            this.calculatedHeight = `${100/this.workflowData.length}%`;\r\n            this.workflowData.map(value =>\r\n              value?.WaterfallRepairs.map(child => child.isLoaded = false));\r\n          }\r\n          this.CallingAPI = false;\r\n          this.LastRefreshedDate = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n          setTimeout(() => {\r\n            this.horizontalRowHeight = this.horizontalRow?.nativeElement?.offsetHeight;\r\n            this.commonService.hideLoading();\r\n          });\r\n        }, error: () => {\r\n          this.CallingAPI = false;\r\n        }\r\n      }))\r\n    } else {\r\n      this.subs.push(this.workflowService.getWorkflowDetails().subscribe({\r\n        next: (data) => {\r\n\r\n          this.workflowData = this.getTotals(data.value);\r\n\r\n          if (this.workflowData) {\r\n            this.workflowData.map(value =>\r\n              value?.WaterfallRepairs.map(child => child.isLoaded = false));\r\n          }\r\n          this.CallingAPI = false;\r\n          this.LastRefreshedDate = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n          this.commonService.hideLoading();\r\n        }, error: () => {\r\n          this.CallingAPI = false;\r\n        }\r\n      }))\r\n    }\r\n  }\r\n\r\n  /**\r\n   * calculate totalCost and totalCount of all repairs\r\n   */\r\n  getTotals(data: any): any {\r\n    this.totalCost = 0;\r\n    this.totalCount = 0;\r\n    data.forEach((item) => {\r\n      this.totalCount += item.WaterfallRepairs.length;\r\n      item['ManualCost'] = 0;\r\n      item.WaterfallRepairs.forEach((itm) => {\r\n        this.totalCost += itm.EstimateCost;\r\n        item.ManualCost += itm.EstimateCost;\r\n      });\r\n\r\n    });\r\n\r\n    return data;\r\n  }\r\n\r\n  /**\r\n   * current_date_format\r\n   * return date format\r\n   * example 28 Wednesday, of June 2023\r\n   *\r\n   * @returns {string}\r\n   */\r\n  current_date_format(): string {\r\n    return dayjs().format('D dddd, of MMMM YYYY');\r\n  }\r\n\r\n  /**\r\n   * pull data and open filter panel\r\n   */\r\n  openFilter(): void {\r\n    if (this.filterDataLoaded) {\r\n      this.filter.open();\r\n    } else {\r\n      this.commonService.showLoading();\r\n\r\n      forkJoin([\r\n        this.getOrgIfBM(),\r\n        this.workflowService.getCustomer(this.userDetail.organizationDetail.id)\r\n      ]\r\n      ).pipe(\r\n        map(([ orgList, CustomerList ]) => {\r\n          return { orgList, CustomerList };\r\n        })\r\n      ).subscribe((result) => {\r\n\r\n        if (this.userIsBM) {\r\n          this.filterModal[0] =\r\n          {\r\n            ...this.filterModal[0],\r\n            selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n            options: result.orgList.data.map((x) => { return { label: x.name, value: x.id } })\r\n          };\r\n        } else {\r\n          this.filterModal[0] =\r\n          {\r\n            ...this.filterModal[0],\r\n            selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n            options: [ { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id } ],\r\n            disabled: true\r\n          };\r\n        }\r\n        this.filterModal[1] =\r\n        {\r\n          ...this.filterModal[1],\r\n          options: result.CustomerList.filter((value, index, self) => {\r\n            return self.findIndex(o => o.contactId === value.contactId) === index;\r\n          }).map((x) => {\r\n            const name = x.firstName + ' ' + x.lastName;\r\n            const label = x.isIndividual ? name : x.companyName;\r\n            const subLabel = x.isIndividual ? x.email : x.licenseNumber;\r\n            return {\r\n              label: x.isIndividual ? name : x.companyName,\r\n              subLabel: x.isIndividual ? x.email : x.licenseNumber,\r\n              value: x.isIndividual ? x.contactId : x.companyId,\r\n              html: `<div class='workflow-customer-item'><span class='name'>${label}</span><span class='email'>${subLabel}</span></div>`\r\n            }\r\n          })\r\n        };\r\n\r\n        this.filter.open();\r\n        this.commonService.hideLoading();\r\n        this.filterDataLoaded = true;\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if user is bm , then call api otherwise return observable\r\n   */\r\n  getOrgIfBM(): Observable<any> {\r\n    if (this.userIsBM) {\r\n      return this.caseService.getOrganizations()\r\n    } else {\r\n      return of(null);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get customer list\r\n   * @param orgId\r\n   */\r\n  getCustomer(orgId: number): void {\r\n    this.commonService.showLoading();\r\n    this.workflowService.getCustomer(orgId).subscribe({\r\n      next: (data) => {\r\n        this.filterModal[1] =\r\n        {\r\n          ...this.filterModal[1],\r\n          options: data.filter((value, index, self) => {\r\n            return self.findIndex(o => o.contactId === value.contactId) === index;\r\n          }).map((x) => {\r\n            const name = x.firstName + ' ' + x.lastName;\r\n            const label = x.isIndividual ? name : x.companyName;\r\n            const subLabel = x.isIndividual ? x.email : x.licenseNumber;\r\n            return {\r\n              label: x.isIndividual ? name : x.companyName,\r\n              subLabel: x.isIndividual ? x.email : x.licenseNumber,\r\n              value: x.isIndividual ? x.contactId : x.companyId,\r\n              html: `<div class='workflow-customer-item'><span class='name'>${label}</span><span class='email'>${subLabel}</span></div>`\r\n            }\r\n          })\r\n        };\r\n        console.log(this.filterModal[1]);\r\n        this.commonService.hideLoading();\r\n      }, error: () => {\r\n        this.commonService.showLoading();\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n  * function\r\n  */\r\n  generateFilterQuery(): string {\r\n\r\n    const filterValue = this.filterForm.value;\r\n    let query = '?$filter=';\r\n\r\n    if(filterValue.OrgName && filterValue.OrgName > 0) {\r\n      query += `OrgId eq ${filterValue.OrgName}`;\r\n    }\r\n\r\n    if((filterValue.CustomerId && filterValue.CustomerId.length > 0) || (filterValue.CompanyId && filterValue.CompanyId.length > 0)) {\r\n      if(query !== '?$filter=') {\r\n        query += '&';\r\n      } else {\r\n        query = '?';\r\n      }\r\n      query += '$expand=WaterfallRepairs($filter=(';\r\n      if(filterValue.CustomerId.length>0)\r\n        query += `${filterValue.CustomerId.map(x => 'ContactId eq ' + x + '').join(' or ')}`;\r\n      if(filterValue.CustomerId.length>0 && filterValue.CompanyId.length>0)\r\n        query += ' or ';\r\n      if(filterValue.CompanyId.length>0)\r\n        query += `${filterValue.CompanyId.map(x => 'CompanyId eq ' + x + '').join(' or ')}`;\r\n      query += '))';\r\n    }\r\n\r\n    return query;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param output\r\n   */\r\n  onFormUpdate(output: IControlValue): void {\r\n\r\n    if (output.name === 'CustomerId') {\r\n      this.filterModal[1] = { ...this.filterModal[1], selectedOption: output.value };\r\n      this.filterForm.get(output.name).setValue(output.value.filter(x =>x.isIndividual).map((x) => { return x.value }));\r\n      this.filterForm.get('CompanyId').setValue(output.value.filter(x =>!x.isIndividual).map((x) => { return x.value }));\r\n    } else if (output.name === 'OrgName') {\r\n      this.filterModal[0] = { ...this.filterModal[0], selectedOption: output.value };\r\n      if (output.value) {\r\n        this.filterForm.get(output.name).setValue(output.value.value);\r\n        this.getCustomer(output.value.value);\r\n      } else {\r\n        this.filterModal[1] = {\r\n          ...this.filterModal[1],\r\n          value: '',\r\n          selectedOption: '',\r\n          options: []\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   *\r\n   */\r\n  applyFilter(): void {\r\n    this.workflowData = [];\r\n    this.getWorkflowDetails(this.generateFilterQuery());\r\n    this.filter.close();\r\n  }\r\n\r\n  /**\r\n   *\r\n   */\r\n  resetFilter(): void {\r\n    this.filterForm.reset();\r\n\r\n    for (let index = 0; index < this.filterModal.length; index++) {\r\n      this.filterModal[index] = {\r\n        ...this.filterModal[index],\r\n        value: '',\r\n        selectedOption: '',\r\n        options: this.filterModal[index].options?.map((x) => { x.checked = false; return x; })\r\n      }\r\n\r\n    }\r\n\r\n    if (this.userDetail?.organizationDetail?.id) {\r\n      this.filterForm.get('OrgName').setValue(this.userDetail.organizationDetail.id);\r\n      this.filterModal[0] =\r\n      {\r\n        ...this.filterModal[0],\r\n        selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n      };\r\n      this.getCustomer(this.userDetail?.organizationDetail.id);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * PartTypeIcon\r\n   *  @param type {string}\r\n   *\r\n   *  @returns {string}\r\n   */\r\n  PartTypeIcon(type: string): string {\r\n    switch (type) {\r\n    case 'NotOrdered':\r\n      return 'parts-not-ordered';\r\n    case 'Ordered':\r\n      return 'parts-ordered';\r\n    case 'Arrived':\r\n      return 'parts-arrived';\r\n    case 'OrderedPartially':\r\n      return 'parts-ordered-partial';\r\n    case 'ArrivedPartially':\r\n      return 'parts-arrived-partial';\r\n    default:\r\n      return 'parts-not-ordered';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * PartTypeIcon\r\n   *  @param type {string}\r\n   *\r\n   *  @returns {string}\r\n   */\r\n  PartTypetoolTip(type: string): string {\r\n    let Tooltip = '';\r\n    switch (type) {\r\n    case 'NotOrdered':\r\n      Tooltip = 'parts_not_ordered';\r\n      break;\r\n    case 'Ordered':\r\n      Tooltip = 'part_ordered';\r\n      break;\r\n    case 'Arrived':\r\n      Tooltip = 'part_arrived';\r\n      break;\r\n    case 'OrderedPartially':\r\n      Tooltip = 'part_ordered_partial';\r\n      break;\r\n    case 'ArrivedPartially':\r\n      Tooltip = 'part_arrived_partial';\r\n      break;\r\n    default:\r\n      Tooltip = 'parts_not_ordered';\r\n      break;\r\n    }\r\n    return this.translateService.instant(Tooltip);\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param event\r\n   */\r\n  @HostListener('document:fullscreenchange', [ '$event' ])\r\n  @HostListener('document:webkitfullscreenchange', [ '$event' ])\r\n  @HostListener('document:mozfullscreenchange', [ '$event' ])\r\n  @HostListener('document:MSFullscreenChange', [ '$event' ])\r\n  @HostListener('document:onwebkitfullscreenchange', [ '$event' ])\r\n  fullscreenmodes(event): void {\r\n    this.chkScreenMode();\r\n  }\r\n\r\n  /**\r\n * check screen mode\r\n */\r\n  chkScreenMode(): void {\r\n    if (document.fullscreenElement || document['webkitIsFullScreen']) {\r\n      //fullscreen\r\n      this.isFullScreen = true;\r\n    } else {\r\n      //not in full screen\r\n      this.isFullScreen = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n * open in full screen\r\n */\r\n  openFullscreen(): void {\r\n    const elem: any = document.documentElement;\r\n    if (elem.requestFullscreen) {\r\n      elem.requestFullscreen();\r\n    } else if (elem.mozRequestFullScreen) {\r\n      /* Firefox */\r\n      elem.mozRequestFullScreen();\r\n    } else if (elem.webkitRequestFullscreen) {\r\n      /* Chrome, Safari and Opera */\r\n      elem.webkitRequestFullscreen();\r\n    } else if (elem.msRequestFullscreen) {\r\n      /* IE/Edge */\r\n      elem.msRequestFullscreen();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * toggle view\r\n   */\r\n  changeView(): void {\r\n    if(!this.verticalView) {\r\n      setTimeout(() => {\r\n        this.verticalRowWidth = this.verticalRow?.nativeElement?.offsetWidth*0.6;\r\n      });\r\n    }\r\n    this.verticalView = !this.verticalView;\r\n  }\r\n\r\n  /**\r\n   * ngOnDestroy\r\n   */\r\n  ngOnDestroy(): void {\r\n    this.subs.forEach(sub => sub.unsubscribe());\r\n    clearInterval(this.IntervalGetWorkflow);\r\n    clearInterval(this.autoScrollInterval);\r\n    clearInterval(this.timeInterval)\r\n  }\r\n}\r\n","<div class=\"page-container workflow-container mh-0 mt-0 fx-col\">\r\n    <div class=\"fx-0\">\r\n        <div class=\"fx-row date-filter-container\">\r\n            <span class=\"text-muted\" style=\"display: block;\">\r\n                <div class=\"current-data\"> \r\n                    {{'current_date' | translate}}: <span class=\"\" [innerHTML]=\"current_date_format()\"></span>\r\n                </div>\r\n                <div class=\"updated-date\">{{'last_refreshed' | translate}}: {{LastRefreshedDate}}</div>\r\n            </span>\r\n            <span class=\"flex align-center\" style=\"gap: 25px; margin-left: auto;\">               \r\n\r\n                <span class=\"flex align-center\">\r\n                    <mat-icon color=\"dark-gray\" style=\"margin-right:8px\">directions_car</mat-icon>\r\n                    <label><b>{{totalCount}}</b></label>\r\n                </span>\r\n                <span class=\"flex align-center\">\r\n                    <mat-icon style=\"margin-right:8px\" svgIcon=\"double-database\"></mat-icon>\r\n                    <label><b>{{totalCost | xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}</b></label>\r\n                </span>\r\n\r\n                <chq-button [buttonModel]=\"filterButton\" (click)=\"openFilter()\" *chqPermission=\"'workflow'\"></chq-button>\r\n            </span>\r\n        </div>\r\n    </div>\r\n    <div class=\"fx-1\" style=\"overflow: auto;\" *ngIf=\"totalCost > 0 && totalCount > 0\">\r\n        <table class=\"workflow-table\">\r\n            <thead class=\"workflow-table-thead\">\r\n                <tr>\r\n                    <th *ngFor=\"let items of workflowData; let i = index\" class=\"right-border\">\r\n                        <div class=\"workflow-header-card\" [style.background-color]=\"items.Color\">\r\n                            <div class=\"\">\r\n                                <button class=\"bg-white rounded-icon\">{{items.WaterfallRepairs.length}}</button>\r\n                               \r\n                            </div>\r\n                            <div>\r\n                                <p>{{items.TotalAmount | xaCurrency:i18n.currencySymbol:i18n.digitsInfo:i18n.locale:i18n.position}}</p>\r\n                            </div>\r\n                           \r\n                            <span class=\"uppercase\">{{items.JobName}}</span>\r\n                        </div>\r\n                    </th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr>\r\n                    <td *ngFor=\"let items of workflowData; let i = index\" class=\"right-border\">\r\n                        <mat-card class=\"workflow-details-card\" *ngFor=\"let repair of items.WaterfallRepairs; let j = index\">\r\n                            <a class=\"detail-card-link\" (click)=\"bookingStatusUrl(repair)\">\r\n                                <div class=\"img-container\">\r\n                                    <img [src]=\"(repair.ImageUrl !== null && repair.ImageUrl !== '') ? repair.ImageUrl : 'assets/img/front-left.png'\" (load)=\"repair.isloaded=true;\" alt=\"\" />\r\n                                    <chq-customloader [showLoading]=\"!repair.isloaded\"></chq-customloader>\r\n                                </div>\r\n                                <div class=\"workflow-repair-items flex\" style=\"padding: 5px 0px; gap: 5px;\">\r\n                                    <button class=\"repair-items\" style=\"padding:1px 6px;\" matTooltip=\"{{ (repair.Assignees.length === 0?'No Assignee':repair.Assignees.length > 1?'Multi Assignees':'Single Assignee') | translate}}\" matTooltipPosition=\"above\">\r\n                                        <mat-icon [svgIcon]=\"repair.Assignees.length > 1?'multi-users':'single-user'\" \r\n                                            [attr.color]=\"repair.Assignees.length === 0?'dark-gray-disabled':'black'\" class=\"svg-17px\"></mat-icon>\r\n                                    </button>\r\n                                    \r\n                                    <button class=\"repair-items\" style=\"padding:1px 6px;\" matTooltip=\"{{ (repair.JobStatusColor === 'Transparent'?'job_not_started':repair.JobStatusColor === 'Green'?'job_start_today':'job_start_in_past') | translate}}\" matTooltipPosition=\"above\">\r\n                                        <mat-icon [attr.color]=\"repair.JobStatusColor === 'Transparent' ?'dark-gray-disabled': repair.JobStatusColor === 'Green'?'green-medium' : 'dark-red2'\" svgIcon=\"clock2\"></mat-icon>\r\n                                    </button>  \r\n        \r\n                                    <button class=\"repair-items\" style=\"padding:1px 6px;\" [matTooltip]=\"PartTypetoolTip(repair.PartGeneralStatus)\" matTooltipPosition=\"above\">\r\n                                        <mat-icon [svgIcon]=\"PartTypeIcon(repair.PartGeneralStatus)\" class=\"svg-17px\"></mat-icon>\r\n                                    </button>\r\n        \r\n                                    <button class=\"repair-items\" style=\"padding:1px 6px;\" matTooltip=\"{{ (repair.IsAttentionRequired?'attention_required':'attention_not_required') | translate}}\" matTooltipPosition=\"above\">\r\n                                        <mat-icon svgIcon=\"flag-circle\" [attr.color]=\"repair.IsAttentionRequired === null? 'dark-gray-disabled': repair.IsAttentionRequired? 'dark-red2': 'dark-gray-disabled'\" class=\"svg-17px\"></mat-icon>\r\n                                    </button>\r\n        \r\n                                    <!-- <button class=\"repair-items\" style=\"padding:1px 6px;\">\r\n                                        <mat-icon [color]=\"repair.EstimateCost === null?'dark-gray-disabled':repair.EstimateCost === 0?'dark-gray-disabled':'black'\" class=\"svg-17px\" svgIcon=\"dollarsign-circle\"></mat-icon>\r\n                                    </button> -->\r\n        \r\n                                    <!-- <button class=\"repair-items\" style=\"padding:1px 6px;\" >\r\n                                        <mat-icon svgIcon=\"check-circle\" color=\"dark-green\" class=\"svg-17px\"></mat-icon>\r\n                                    </button> -->\r\n        \r\n                                    <button class=\"repair-items\" style=\"padding:1px 6px;\" matTooltip=\"{{ (repair.LastestTaskUpdatedRepairType?repair.LastestTaskUpdatedRepairType:'Others') | lowercase | translate}}\" matTooltipPosition=\"above\">\r\n                                        <mat-icon [svgIcon]=\"jobIconDictionary[repair.LastestTaskUpdatedRepairType]?jobIconDictionary[repair.LastestTaskUpdatedRepairType]:'gears'\" [attr.color]=\"'black'\" class=\"repairType-custom-class\"></mat-icon>\r\n                                    </button>\r\n        \r\n                                    <button class=\"repair-items\" style=\"padding:1px 6px;\" matTooltip=\"{{ (repair.IsTowedIn?'towed_in':'not_towed_in') | translate}}\" matTooltipPosition=\"above\">\r\n                                        <mat-icon [svgIcon]=\"'towing'\" [attr.color]=\"repair.IsTowedIn ? 'black' : 'dark-gray-disabled'\"></mat-icon>\r\n                                    </button>\r\n                                </div>\r\n                                \r\n                                <span class=\"due-date-span\" style=\"margin-top: 6px;\">{{'due_out' | translate}}: <b>{{repair.BookingOutDate | date: 'dd/MM/yy HH:mm' | translate}}</b></span>\r\n                            </a>\r\n                        </mat-card>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n    <div class=\"no-data-wrapper\" *ngIf=\"(workflowData.length === 0 || (totalCost === 0 && totalCount === 0)) && !CallingAPI\">\r\n        <div class=\"no-data-content\">\r\n            <img src=\"assets/img/no-data.png\" alt=\"\">\r\n            <span>{{'no_result_found' | translate}}</span>\r\n            <span>{{'could_not_find_any_data' | translate}}.</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<mat-sidenav-container [hasBackdrop]=\"true\">\r\n    <mat-sidenav #filter [mode]=\"'over'\" [position]=\"'end'\" class=\"filter-sidenav\">\r\n        <div class=\"filter-container\">\r\n            <div class=\"header\">\r\n                <div class=\"title\">\r\n                    Filters\r\n                </div>\r\n                <div class=\"action\">\r\n                    <button (click)=\"filter.toggle()\">\r\n                        <mat-icon [svgIcon]=\"'cross'\" color=\"white\"></mat-icon>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <form class=\"form-container\" [formGroup]=\"filterForm\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input [inputModel]=\"filterModal[0]\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                    </div>\r\n                </div>\r\n                <div class=\"row\">\r\n                    <div class=\"col-12\">\r\n                        <chq-input [inputModel]=\"filterModal[1]\" (controlOutput)=\"onFormUpdate($event)\" class=\"customer-list-w\"></chq-input>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n            <div class=\"footer\">\r\n                <div class=\"row\">\r\n                    <div class=\"col-6\">\r\n                        <chq-button [buttonModel]=\"applyButton\" (click)=\"applyFilter()\"></chq-button>\r\n                    </div>\r\n                    <div class=\"col-6\">\r\n                        <chq-button [buttonModel]=\"resetButton\" (click)=\"resetFilter()\"></chq-button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </mat-sidenav>\r\n</mat-sidenav-container>\r\n\r\n<div class=\"footer-full-wrapper\">\r\n    <div class=\"footer-image-wrapper\">\r\n        <div class=\"image-wrapper\">\r\n            <img src=\"assets/img/addenda-repair.png\" alt=\"\"/>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n","import { AfterViewInit, Component, OnDestroy, OnInit, ViewChild } from '@angular/core';\r\nimport { FormBuilder } from '@angular/forms';\r\nimport { MatSidenav } from '@angular/material/sidenav';\r\nimport { Router } from '@angular/router';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport * as dayjs from 'dayjs';\r\nimport { Observable, Subscription, forkJoin, map, of } from 'rxjs';\r\nimport { RepairStatusMapper } from 'src/app/config/route-mapper/repair-status-mapper';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { ChqWidgetsInputModel, IControlValue } from 'src/app/model/chq-widgets-input-model';\r\nimport { WorkflowService } from 'src/app/services/workflow/workflow.service';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService, i18nInfo } from 'src/app/services/common/common.service';\r\n\r\n@Component({\r\n  selector: 'app-workflow',\r\n  templateUrl: './workflow.component.html',\r\n  styleUrls: [ './workflow.component.scss' ],\r\n  providers: [ WorkflowService ],\r\n})\r\n\r\nexport class WorkflowComponent implements OnInit, OnDestroy, AfterViewInit{\r\n\r\n  totalCost = 0;\r\n  totalCount = 0;\r\n  workflowData: any[] = [];\r\n  CallingAPI = false;\r\n  i18n: i18nInfo;\r\n  IntervalGetWorkflow = null;\r\n  LastRefreshedDate = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n  private userDetail;\r\n  public userIsBM = false;\r\n  @ViewChild('filter') public filter: MatSidenav;\r\n\r\n  public filterButton: ChqWidgetsButtonModel = {\r\n    label: 'filter',\r\n    type: 'outline',\r\n    icon: 'filter'\r\n  }\r\n\r\n  public filterForm = this.formBuilder.group({\r\n    OrgName: [],\r\n    CustomerId: []\r\n  });\r\n\r\n  public applyButton: ChqWidgetsButtonModel = {\r\n    label: 'apply',\r\n    type: 'primary'\r\n  }\r\n\r\n  public resetButton: ChqWidgetsButtonModel = {\r\n    label: 'reset_all',\r\n    type: 'outline'\r\n  }\r\n\r\n  filterModal: ChqWidgetsInputModel[] = [\r\n    {\r\n      placeHolder: 'select_organization',\r\n      label: 'organization',\r\n      name: 'OrgName',\r\n      value: '',\r\n      type: 'select',\r\n      displayValue: 'label',\r\n      fieldValue: 'value',\r\n      options: [],\r\n      isMultiSelect: false\r\n    },\r\n    {\r\n      placeHolder: 'select_type',\r\n      label: 'customer_name',\r\n      name: 'CustomerId',\r\n      value: '',\r\n      type: 'select',\r\n      displayValue: 'label',\r\n      fieldValue: 'value',\r\n      options: [],\r\n      isMultiSelect: true\r\n    }\r\n  ];\r\n  filterDataLoaded: boolean = false;\r\n\r\n  repairSizeColors = { \r\n    'sm': 'bg-light-blue', \r\n    's': 'bg-light-blue',\r\n    'l': 'bg-light-green text-white', \r\n    'm': 'bg-light-pink text-white', \r\n    'xl': 'bg-dark-red text-white' \r\n  };\r\n  settingsButtonModel : ChqWidgetsButtonModel = {\r\n    label: 'filter',\r\n    type: 'outline',\r\n    icon: 'filter',\r\n    width: '13px',\r\n    height: '13px'\r\n  };\r\n\r\n  jobIconDictionary = {\r\n    'Body': 'car',\r\n    'Paint': 'paint-nozzle',\r\n    'Mechanical': 'mechanical',\r\n    'Electrical': 'electric',\r\n    'Tires': 'tire',\r\n    'Preparation': 'car-roof',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Check In': 'checkbox-open',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Panel Repair': 'door-panel',\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    'Panel Fitup': 'door-panel',\r\n    'Polish': 'car-paint',\r\n    'Detailing': 'car-cleaning',\r\n    'Maintenance': 'maintenance',\r\n    'Diagnosis': 'diagnosis',\r\n    'Others': 'gears',\r\n  }\r\n\r\n  subs: Subscription[] = []; \r\n  /**\r\n   * constructor.\r\n   * @constructor\r\n   * @param {WorkflowService} workflowService\r\n   * @param {commonService} commonService\r\n   * @param {caseService} caseService\r\n   * @param {formBuilder} formBuilder\r\n   */\r\n  constructor(private workflowService: WorkflowService,\r\n              private router: Router,\r\n              private commonService: CommonService,\r\n              private caseService: CaseService,\r\n              private translateService: TranslateService,\r\n              private formBuilder: FormBuilder,) {\r\n    this.i18n = this.commonService.geti18nInfo();\r\n  }\r\n\r\n  /**\r\n   * ngOnInit\r\n   */\r\n  ngOnInit(): void{\r\n    this.commonService.userProfileData.subscribe((res) => {\r\n      this.userDetail = res?.data;\r\n      this.userIsBM = this.userDetail?.roleDetail.some(x => x.name == 'Bodyshop Manager');\r\n      if (this.userDetail?.organizationDetail?.id) {\r\n        this.filterForm.get('OrgName').setValue(this.userDetail.organizationDetail.id);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * ngAfterViewInit\r\n   */\r\n  ngAfterViewInit(): void {\r\n    this.getWorkflowDetails(this.generateFilterQuery());\r\n    this.IntervalGetWorkflow = setInterval(()=>{ //call getWorkflow every 5 mins\r\n      this.getWorkflowDetails(this.generateFilterQuery());\r\n    }, 300000);\r\n  }\r\n\r\n  /**\r\n   * getWorkflowData\r\n   */\r\n  public async getWorkflowDetails(query): Promise<any> {\r\n    this.commonService.showLoading();\r\n    this.CallingAPI = true;\r\n    if(query !== '?$filter='){\r\n      this.subs.push(this.workflowService.getWorkflowDetailsWithQuery(query).subscribe({\r\n        next: (data) => {\r\n          this.workflowData = data.value;\r\n          if(this.workflowData) {\r\n            this.workflowData.map(value => \r\n              value?.WaterfallRepairs.map(child => child.isLoaded = false));\r\n          }\r\n          this.CallingAPI = false;\r\n          this.LastRefreshedDate = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n          this.getTotals();\r\n          this.commonService.hideLoading();\r\n        }, error: () =>{\r\n          this.CallingAPI = false;\r\n        }\r\n      }))\r\n    } else{\r\n      this.subs.push(this.workflowService.getWorkflowDetails().subscribe({\r\n        next: (data) => {\r\n          this.workflowData = data.value;\r\n          if(this.workflowData) {\r\n            this.workflowData.map(value => \r\n              value?.WaterfallRepairs.map(child => child.isLoaded = false));\r\n          }\r\n          this.CallingAPI = false;\r\n          this.LastRefreshedDate = dayjs().format('DD/MM/YYYY HH:mm:ss');\r\n          this.getTotals();\r\n          this.commonService.hideLoading();\r\n        }, error: () =>{\r\n          this.CallingAPI = false;\r\n        }\r\n      }))\r\n    }\r\n   \r\n\r\n  }\r\n  \r\n  /**\r\n   * calculate totalCost and totalCount of all repairs\r\n   */\r\n  getTotals(): void{\r\n    this.totalCost = 0;\r\n    this.totalCount = 0;\r\n    this.workflowData.forEach((item)=> {\r\n      this.totalCount += item.WaterfallRepairs.length;\r\n      item.WaterfallRepairs.forEach((itm) => {\r\n        this.totalCost += itm.EstimateCost;\r\n      });\r\n      \r\n    });\r\n  }\r\n  \r\n  /**\r\n   * current_date_format\r\n   * return date format \r\n   * example 28 Wednesday, of June 2023\r\n   *\r\n   * @returns {string}\r\n   */\r\n  current_date_format(): string{\r\n    return dayjs().format('D dddd, of MMMM YYYY');\r\n  }\r\n\r\n  /**\r\n   * pull data and open filter panel\r\n   */\r\n  openFilter(): void{\r\n    if (this.filterDataLoaded) {\r\n      this.filter.open();\r\n    } else {\r\n      this.commonService.showLoading();\r\n\r\n      forkJoin([\r\n        this.getOrgIfBM(),\r\n        this.workflowService.getCustomer(this.userDetail.organizationDetail.id)\r\n      ]\r\n      ).pipe(\r\n        map(([ orgList, CustomerList ]) => {\r\n          return { orgList, CustomerList };\r\n        })\r\n      ).subscribe((result) => {\r\n        \r\n        if (this.userIsBM) {\r\n          this.filterModal[0] =\r\n          {\r\n            ...this.filterModal[0],\r\n            selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n            options: result.orgList.data.map((x) => { return { label: x.name, value: x.id } })\r\n          };\r\n        } else {\r\n          this.filterModal[0] =\r\n          {\r\n            ...this.filterModal[0],\r\n            selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n            options: [ { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id } ],\r\n            disabled: true\r\n          };\r\n        }\r\n\r\n        this.filterModal[1] =\r\n        {\r\n          ...this.filterModal[1],\r\n          options: result.CustomerList.filter((value, index, self) => {\r\n            return self.findIndex(o => o.contactId === value.contactId) === index;\r\n          }).map((x) => { \r\n            const name = x.firstName + ' ' + x.lastName;\r\n            const label = x.isIndividual ? name : x.companyName;\r\n            const subLabel = x.isIndividual ? x.email : x.licenseNumber;\r\n            return { \r\n              label: x.isIndividual ? name : x.companyName, \r\n              subLabel: x.isIndividual ? x.email : x.licenseNumber,\r\n              value: x.id, \r\n              html: `<div class='workflow-customer-item'><span class='name'>${label }</span><span class='email'>${subLabel }</span></div>` \r\n            } \r\n          })\r\n        };\r\n\r\n        this.filter.open();\r\n        this.commonService.hideLoading();\r\n        this.filterDataLoaded = true;\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if user is bm , then call api otherwise return observable\r\n   */\r\n  getOrgIfBM(): Observable<any> {\r\n    if (this.userIsBM) {\r\n      return this.caseService.getOrganizations()\r\n    } else {\r\n      return of(null);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * get customer list\r\n   * @param orgId\r\n   */\r\n  getCustomer(orgId: number): void {\r\n    this.commonService.showLoading();\r\n    this.workflowService.getCustomer(orgId).subscribe({\r\n      next: (data) => {\r\n        this.filterModal[1] =\r\n        {\r\n          ...this.filterModal[1],\r\n          options: data.filter((value, index, self) => {\r\n            return self.findIndex(o => o.contactId === value.contactId) === index;\r\n          }).map((x) => { \r\n            const name = x.firstName + ' ' + x.lastName;\r\n            const label = x.isIndividual ? name : x.companyName;\r\n            const subLabel = x.isIndividual ? x.email : x.licenseNumber;\r\n            return { \r\n              label: x.isIndividual ? name : x.companyName, \r\n              subLabel: x.isIndividual ? x.email : x.licenseNumber,\r\n              value: x.id, \r\n              html: `<div class='workflow-customer-item'><span class='name'>${label }</span><span class='email'>${subLabel }</span></div>` \r\n            } \r\n          })\r\n        };\r\n        console.log(this.filterModal[1]);\r\n        this.commonService.hideLoading();\r\n      }, error: () =>{\r\n        this.commonService.showLoading();\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n  * function\r\n  */\r\n  generateFilterQuery(): string {\r\n\r\n    const filterValue = this.filterForm.value;\r\n    let query = '?$filter=';\r\n  \r\n    if(filterValue.OrgName && filterValue.OrgName > 0) {\r\n      query += `OrgId eq ${filterValue.OrgName}`;\r\n    }\r\n\r\n    if(filterValue.CustomerId && filterValue.CustomerId.length > 0) {\r\n      if(query !== '?$filter=') {\r\n        query += '&';\r\n      } else {\r\n        query = '?';\r\n      }\r\n      query += '$expand=WaterfallRepairs($filter=';\r\n      query += `(${filterValue.CustomerId.map(x => 'CustomerId eq ' + x + '').join(' or ')}))`;\r\n    }\r\n  \r\n    return query;\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param output \r\n   */\r\n  onFormUpdate(output: IControlValue): void {\r\n\r\n    if (output.name === 'CustomerId') {\r\n      this.filterModal[1] = { ...this.filterModal[1], selectedOption: output.value };\r\n      this.filterForm.get(output.name).setValue(output.value.map((x) => { return x.value }));\r\n    } else if (output.name === 'OrgName') {\r\n      this.filterModal[0] = { ...this.filterModal[0], selectedOption: output.value };\r\n      this.filterForm.get(output.name).setValue(output.value.value);\r\n      if(output.value) {\r\n        this.getCustomer(output.value.value);\r\n      } else {\r\n        this.filterModal[1] = {\r\n          ...this.filterModal[1],\r\n          value: '',\r\n          selectedOption: '',\r\n          options: []\r\n        }\r\n      }\r\n    }\r\n  }\r\n    \r\n    \r\n  /**\r\n   * \r\n   */\r\n  applyFilter(): void {\r\n    this.workflowData = [];\r\n    this.getWorkflowDetails(this.generateFilterQuery());\r\n    this.filter.close();\r\n  }\r\n\r\n  /**\r\n   * \r\n   */\r\n  resetFilter(): void {\r\n    this.filterForm.reset();\r\n\r\n    for (let index = 0; index < this.filterModal.length; index++) {\r\n      this.filterModal[index] = {\r\n        ...this.filterModal[index],\r\n        value: '',\r\n        selectedOption: '',\r\n        options: this.filterModal[index].options?.map((x) => { x.checked = false; return x; })\r\n      }\r\n\r\n    }\r\n    \r\n    if (this.userDetail?.organizationDetail?.id) {\r\n      this.filterForm.get('OrgName').setValue(this.userDetail.organizationDetail.id);\r\n      this.filterModal[0] =\r\n      {\r\n        ...this.filterModal[0],\r\n        selectedOption: { 'label': this.userDetail?.organizationDetail.name, 'value': this.userDetail?.organizationDetail.id },\r\n      };\r\n      this.getCustomer(this.userDetail?.organizationDetail.id);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * PartTypeIcon\r\n   *  @param type {string} \r\n   * \r\n   *  @returns {string}\r\n   */\r\n  PartTypeIcon(type: string): string {\r\n    switch (type) {\r\n    case 'NotOrdered':\r\n      return 'parts-not-ordered';\r\n    case 'Ordered':\r\n      return 'parts-ordered';\r\n    case 'Arrived':\r\n      return 'parts-arrived';\r\n    case 'OrderedPartially': \r\n      return 'parts-ordered-partial';\r\n    case 'ArrivedPartially':\r\n      return 'parts-arrived-partial';\r\n    default:\r\n      return 'parts-not-ordered';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * PartTypeIcon\r\n   *  @param type {string} \r\n   * \r\n   *  @returns {string}\r\n   */\r\n  PartTypetoolTip(type: string): string {\r\n    let Tooltip = '';\r\n    switch (type) {\r\n    case 'NotOrdered':\r\n      Tooltip = 'parts_not_ordered';\r\n      break;\r\n    case 'Ordered':\r\n      Tooltip = 'part_ordered';\r\n      break;\r\n    case 'Arrived':\r\n      Tooltip = 'part_arrived';\r\n      break;\r\n    case 'OrderedPartially': \r\n      Tooltip = 'part_ordered_partial';\r\n      break;\r\n    case 'ArrivedPartially':\r\n      Tooltip = 'part_arrived_partial';\r\n      break;\r\n    default:\r\n      Tooltip = 'parts_not_ordered';\r\n      break;\r\n    }\r\n    return this.translateService.instant(Tooltip);\r\n  }\r\n\r\n  /**\r\n   * booking url\r\n   */\r\n  bookingStatusUrl(repair: any): void {\r\n    const { Status, RepairGuid } = repair;\r\n    let routeToRedirect = RepairStatusMapper[Status?.toLowerCase()] || RepairStatusMapper.others;\r\n    routeToRedirect = routeToRedirect.replace('{{repairGUID}}', RepairGuid);\r\n    this.router.navigate([ routeToRedirect ]);\r\n  }\r\n\r\n  /**\r\n   * ngOnDestroy\r\n   */\r\n  ngOnDestroy(): void{\r\n    this.subs.forEach(sub=>sub.unsubscribe());\r\n    clearInterval(this.IntervalGetWorkflow);\r\n  }\r\n}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { EmailRequest } from 'src/app/dialogs/request-approval-dialog/request-approval-dialog.component';\r\nimport { environment } from 'src/environments/environment';\r\nimport { FileService } from '../file-service/file.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MessagesService {\r\n\r\n  /**\r\n   * constructor\r\n   * @param http \r\n   */\r\n  constructor(\r\n    private http: HttpClient,\r\n    private fileService:FileService\r\n  ) {\r\n  }\r\n\r\n  /**\r\n   * send approval message\r\n   */\r\n  sendApprovalMessage(data:any, repairGuid: string):Observable<any>{\r\n    const url = `${environment.caseMgmtUrl}/api/message/${repairGuid}/estimate-approval`;\r\n      return this.http.post(url, data);\r\n  }\r\n\r\n  /**\r\n   * get message template\r\n   */\r\n  getMessageTemplate(repairId:string, domainId: number, id:number):Observable<any>{\r\n    const url = `${environment.xaAggregationApi}/repaircommunicationtemplate/${repairId}/${domainId}/${id}`;\r\n    return this.http.get(url);\r\n  }\r\n\r\n  /**\r\n   * set message\r\n   */\r\n  setMessage(body, repairId):Observable<any>{\r\n    const url = `${environment.caseMgmtUrl}/api/message/${repairId}/send-message`;\r\n    return this.http.post(url, body);\r\n  }\r\n\r\n  /**\r\n   * send customer message\r\n   */\r\n  sendFreeCommunicationMessage(emailBody:EmailRequest, reportProgress?: boolean, observe?: 'events'):Observable<any>{\r\n    const url = `${environment.messageApi}/Message/email`;\r\n    const formData = new FormData();\r\n    formData.append('ToEmail', emailBody.email?.join(','));\r\n    if(emailBody.cc){\r\n      formData.append('CCEmail', emailBody.cc);\r\n    }\r\n    formData.append('Content', emailBody.message);\r\n    formData.append('Subject', emailBody.subject); \r\n    formData.append('ObjectId', emailBody.objectId);\r\n    if(emailBody.files && emailBody.files.length > 0){\r\n      emailBody.files.forEach((file) => {\r\n        formData.append('files', file);\r\n      });\r\n    }\r\n    return this.fileService.uploadFile(url, formData, reportProgress, observe);\r\n  }\r\n}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from 'src/environments/environment';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class OutboundService {\r\n\r\n\r\n  /**\r\n   * @constructor\r\n   * @param {HttpClient} http\r\n   */\r\n  constructor(private http: HttpClient) {}\r\n\r\n  /**\r\n   * getDeparturesDetails\r\n   * @param {string} query\r\n   */\r\n  getDeparturesDetails(query: string) : Observable<any>{\r\n    //return of(departuresData)\r\n    const url = `${environment.caseMgmtUrl}/odata/departures?${query}`;\r\n    return this.http.get(url);\r\n  }\r\n\r\n  /**\r\n   * setPickupDate\r\n   * @param {string} date\r\n   * @param {string} repairId\r\n   */\r\n  setPickupDate(repairId: string, date: string, isPickedup) : Observable<any>{\r\n    const url = `${environment.caseMgmtUrl}/api/departures/${repairId}/pickupdate`;\r\n    return this.http.put(url, { 'pickUpDate': date, 'isPickedUp': isPickedup });\r\n  }\r\n\r\n  /**\r\n  * setPickupDate\r\n  * @param {string} date\r\n  * @param {string} repairId\r\n  */\r\n  getTaskDetails(repairId: string, jobId: string) : Observable<object>{\r\n    const url = `${environment.caseMgmtUrl}/api/departures/tasks/${repairId}/${jobId}`;\r\n    return this.http.get(url);\r\n  }\r\n  \r\n  /**\r\n   * setRepairStatusComplete\r\n   * @param {string} repairId\r\n   */\r\n  setRepairStatusComplete(repairId: string,): Observable<object>{\r\n    const url = `${environment.caseMgmtUrl}/api/repair/${repairId}/status`;\r\n    return this.http.put(url, { 'status': 'Complete', 'reason': 'repair complete' });\r\n  }\r\n}\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable, of } from 'rxjs';\r\nimport { environment } from 'src/environments/environment';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class WorkflowService {\r\n\r\n  /**\r\n   * @constructor\r\n   * @param {HttpClient} http\r\n   */\r\n  constructor(private http: HttpClient) {}\r\n\r\n  /**\r\n     * getWaterfallDetails\r\n     * @returns {Observable<any>}\r\n     */\r\n  getWorkflowDetails() : Observable<any>{\r\n\r\n    const url = `${environment.caseMgmtUrl}/odata/waterfall`;\r\n    return this.http.get(url);\r\n  }\r\n  \r\n  // eslint-disable-next-line require-jsdoc\r\n  getWorkflowDetailsWithQuery(query: string): Observable<any>{\r\n\r\n    const url = `${environment.caseMgmtUrl}/odata/waterfall${query}`;\r\n    return this.http.get(url);\r\n  }\r\n\r\n  /**\r\n * getDraftCustomer\r\n * @returns Observable\r\n */\r\n  public getCustomer(id: number): Observable<any> {\r\n    const url = `${environment.caseMgmtUrl}/api/waterfallcustomer?$filter=OrgId eq ${id}`;\r\n    return this.http.get(url);\r\n  }\r\n\r\n  /**\r\n   * update attention\r\n   * @param repairguid \r\n   * @param obj \r\n   * @returns \r\n   */\r\n  updateAttentionRequired(repairguid: string): Observable<any> {\r\n    const url = `${environment.caseMgmtUrl}/api/repair/${repairguid}`;\r\n    const obj = [ {\r\n      'path': 'isAttentionRequired',\r\n      'op': 'replace',\r\n      'value': 'false'\r\n    } ];\r\n    return this.http.patch(url, obj);\r\n  }\r\n\r\n}\r\n"]}