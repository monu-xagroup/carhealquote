{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UAMsBA;;;;;yBAAAA;AAA+B;;;cAA/BA;AAA+BC;AAAAC;AAAAC;AAAAC;AAAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCH/BC;;;;;;;;;;;;;;AAIpB;;;;AAIA,mCAAa;AACX,mBAAO,CAAC,KAAKC,gBAAL,EAAR;AACD;;;;QAV6CC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDzC,UAAMC,yBAAwB,GAAkC;AACrEC,eAAO,EAAE;AACPC,gBAAM,EAAE,cADD;AAEPC,cAAI,EAAE,2DAFC;AAGPC,qBAAW,EAAE;AACXC,iBAAK,EAAE,cADI;AAEXC,gBAAI,EAAE,SAFK;AAGXC,gBAAI,EAAE;AAHK,WAHN;AAQPC,sBAAY,EAAE,KARP;AASPC,iBAAO,EAAE;AATF,SAD4D;AAYrEC,cAAM,EAAE;AACNR,gBAAM,EAAE,aADF;AAENC,cAAI,EAAE,2DAFA;AAGNC,qBAAW,EAAE;AACXC,iBAAK,EAAE,aADI;AAEXC,gBAAI,EAAE,KAFK;AAGXC,gBAAI,EAAE;AAHK,WAHP;AAQNC,sBAAY,EAAE,KARR;AASNC,iBAAO,EAAE;AATH,SAZ6D;AAuBrEE,aAAK,EAAE;AACLT,gBAAM,EAAE,YADH;AAELC,cAAI,EAAE,yDAFD;AAGLC,qBAAW,EAAE;AACXC,iBAAK,EAAE,YADI;AAEXC,gBAAI,EAAE,SAFK;AAGXC,gBAAI,EAAE;AAHK,WAHR;AAQLC,sBAAY,EAAE,KART;AASLC,iBAAO,EAAE;AATJ,SAvB8D;AAkCrEG,gBAAQ,EAAE;AACRV,gBAAM,EAAE,eADA;AAERC,cAAI,EAAE,4DAFE;AAGRC,qBAAW,EAAE;AACXC,iBAAK,EAAE,eADI;AAEXC,gBAAI,EAAE,SAFK;AAGXC,gBAAI,EAAE;AAHK,WAHL;AAQRC,sBAAY,EAAE,KARN;AASRC,iBAAO,EAAE;AATD;AAlC2D,OAAhE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCoBMI;;;;;;;;;;;;QAAuBC;;;;;qJAAvBD,mBAAcE,KAAdF;AAAc;AAAA;;;eAAdA;AAAcG,iBAAdH,eAAc;;AAY3B,UAAMI,WAAW,GAAY,CAC3B;AACEC,YAAI,EAAE,EADR;AACYC,iBAAS,EAAEC,iGADvB;AAEEC,qBAAa,EAAE,CAAEC,sGAAF,CAFjB;AAGEC,eAAO,EAAE;AAAEC,iBAAO,EAAEC;AAAX;AAHX,OAD2B,EAM3B;AACEP,YAAI,EAAE,SADR;AAEEC,iBAAS,EAAEO,8FAFb;AAGEH,eAAO,EAAE;AAAEC,iBAAO,EAAEC;AAAX;AAHX,OAN2B,EAW3B;AACEP,YAAI,EAAE,UADR;AAEEC,iBAAS,EAAEQ,wGAFb;AAGEJ,eAAO,EAAE;AAAEC,iBAAO,EAAEC;AAAX;AAHX,OAX2B,EAgB3B;AACEP,YAAI,EAAE,QADR;AAEEC,iBAAS,EAAES,+FAFb;AAGEL,eAAO,EAAE;AAAEC,iBAAO,EAAEC;AAAX;AAHX,OAhB2B,EAqB3B;AACEP,YAAI,EAAE,UADR;AAEEC,iBAAS,EAAEU,0GAFb;AAGEN,eAAO,EAAE;AAAEC,iBAAO,EAAEC;AAAX;AAHX,OArB2B,EA0B3B;AACEP,YAAI,EAAE,SADR;AAEEC,iBAAS,EAAEC;AAFb,OA1B2B,CAA7B;;UAoDaU;;;;;yBAAAA;AAAgB;;;cAAhBA;;;mBAPA,CAAER,sGAAF,EACT;AACES,iBAAO,EAAEjB,6EADX;AAEEkB,kBAAQ,EAAEnB;AAFZ,SADS;AAKVoB,kBAhBQ,CACPnB,oEADO,EAEPoB,0DAFO,EAGPC,kEAHO,EAIPC,6DAJO,EAKPC,sEALO,EAMPC,oEAAsBrB,WAAtB,CANO,EAOPsB,6EAPO,EAQPC,+EARO,EASPC,iEATO,CAgBR;;;;6HAEUX,mBAAgB;AAAAY,yBAnBXtB,iGAmBW,EAnBcM,8FAmBd,EAnBsCG,0GAmBtC,EAnBkEc,iIAmBlE;AAnByFV,oBAElHnB,oEAFkH,EAGlHoB,0DAHkH,EAIlHC,kEAJkH,EAKlHC,6DALkH,EAMlHC,sEANkH,EAMtGC,0DANsG,EAQlHC,6EARkH,EASlHC,+EATkH,EAUlHC,iEAVkH;AAmBzF;AATV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/DTG;;AAAgIA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;;;;;AAA5EA;;;;;;;;;;;;;;AAIjGA;;AACEA;;AACEA;;AACEA;;AAAkCA;;;;AAAmCA;;AACrEA;;AAE4CA;AAAAA;;AAAA;;AAAA;AAAA;;AAC3CA;;AACHA;;AACFA;;AACFA;;;;;;AAViBA;;AAGuBA;;AAAAA;;AAGhCA;;AAAAA;;;;;;;;;;;;;;AAKRA;;AACEA;;AACEA;;AACEA;;AAAkCA;;;;AAA2FA;;AAC7HA;;AAGEA;AAAAA;;AAAA;;AAAA;AAAA,aAAiC,eAAjC,EAAiC;AAAAA;;AAAA;;AAAA;AAAA,WAAjC;;AAEDA;;AACDA;;AAIqCA;AAAAA;;AAAA;;AAAA;AAAA;;AACpCA;;AACHA;;AACFA;;AACFA;;;;;;AAfwCA;;AAAAA;;AAKhCA;;AAAAA;;AAKAA;;AAAAA,uMAAwF,YAAxF,EAAwFC,0BAAxF;;;;;;AAqCND;;;;;;AAAuCA;;;;;;AACvCA;;;;;;AAAsEA;;;;;;;;;;;;;;AAhF5EA;;AACEA;;AACAA;;AACEA;;AACEA;;AACEA;;AAA8CA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AACvFA;;AACFA;;AACAA;;AACEA;;AACEA;;AACEA;;AAAkCA;;;;AAAuCA;;AACzEA;;AAAyBA;AAAAA;;AAAA;;AAAA;AAAA,aAAiC,eAAjC,EAAiC;AAAAA;;AAAA;;AAAA;AAAA,WAAjC;;AACxBA;;AACDA;;AACFA;;AACFA;;AACFA;;AACAA;;AAWAA;;AAmBAA;;AACEA;;AACEA;;AACEA;;AAAkCA;;;;AAAuNA;;AACzPA;;AACEA;;AAAmEA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AAC1GA;;AAAkEA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AAC3GA;;AACFA;;AACAA;;AACEA;;AACEA;;AAAyEA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AAChHA;;AACEA;;AACEA;;AAA8DA;AAAAA;;AAAA;;AAAA;AAAA,aAAiC,eAAjC,EAAiC;AAAAA;;AAAA;;AAAA;AAAA,WAAjC;;AAA0HA;;AACxLA;;AAA6FA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AACxIA;;AACAA;;AACFA;;AAEFA;;AACFA;;AACFA;;AACFA;;AACAA;;AACEA;;AACIA;;AACIA;;AACJA;;AACJA;;AACAA;;AACEA;;AACAA;;AACFA;;AACFA;;AACFA;;;;;;AAnF4EA;;AACzDA;;AAAAA;;AAIAA;;AAAAA;;AAMyBA;;AAAAA;;AACkCA;;AAAAA;;AAE1CA;;AAAAA;;AAIuBA;;AAAAA;;AAWrCA;;AAAAA;;AAsBsBA;;AAAAA;;AAEAA;;AAAAA;;AACAA;;AAAAA;;AAKUA;;AAAAA;;AAG0DA;;AAAAA;;AACrDA;;AAAAA;;AAgBxCA;;AAAAA;;AACAA;;AAAAA;;;;;;AAInBA;;;;UC/DaE;;;;;AA+CX;;;;AAIA,0CACUC,MADV,EACiCC,aADjC,EAEUC,cAFV,EAGUC,WAHV,EAG4CC,WAH5C,EAIUC,KAJV,EAI8B;AAAA;;AAAA;;AAE5B;AALQ;AAAuB;AACvB;AACA;AAAkC;AAClC;AAtDH,yBAAgCC,6EAAhC;AAGA,+BAAe,IAAf;AAGA,qCAA4C;AACjDhD,iBAAK,EAAE,EAD0C;AAEjDC,gBAAI,EAAE;AAF2C,WAA5C;AAIA,kCAAyC;AAC9CD,iBAAK,EAAE,EADuC;AAE9CC,gBAAI,EAAE;AAFwC,WAAzC;AAIA,kCAA2B,KAA3B;AACA,2BAAoB,IAApB;AAIA,mCAAqC;AAC1CgD,qBAAS,EAAE,EAD+B;AAE1CC,0BAAc,EAAE,EAF0B;AAG1CC,uBAAW,EAAE,EAH6B;AAI1CC,uBAAW,EAAE,EAJ6B;AAK1CC,oBAAQ,EAAE,CALgC;AAM1CC,4BAAgB,EAAE,IANwB;AAO1CC,qBAAS,EAAE,EAP+B;AAQ1CC,qBAAS,EAAE,EAR+B;AAS1CC,oBAAQ,EAAE,EATgC;AAU1CC,qBAAS,EAAE,CAV+B;AAW1CC,yBAAa,EAAE,CAX2B;AAY1CC,0BAAc,EAAE,CAZ0B;AAa1CC,sBAAU,EAAE,EAb8B;AAc1CC,uBAAW,EAAE,CAd6B;AAe1CC,4BAAgB,EAAE,EAfwB;AAgB1CC,iBAAK,EAAE;AAhBmC,WAArC;AAkBA,yBAAS,GAAT;AACA,+BAAe,CAAf;AACA,+BAAwB,KAAxB;;AAkBL,cAAG,MAAKrB,aAAL,CAAmBsB,WAAnB,CAA+BC,MAAlC,EAA0C;AACxC,kBAAKvB,aAAL,CAAmBsB,WAAnB,GAAiC,IAAIE,2EAAJ,CAA6B,IAA7B,CAAjC;AACD;;AAED,gBAAKxB,aAAL,CAAmByB,eAAnB,CAAmCC,SAAnC,CAA6C,UAACC,GAAD,EAAQ;AACnD,gBAAIA,GAAG,IAAIA,GAAG,CAACC,IAAf,EAAqB;AACnB,kBAAQC,kBAAR,GAA+BF,GAAG,CAACC,IAAnC,CAAQC,kBAAR;;AAEA,kBAAIA,kBAAJ,EAAwB;AACtB,sBAAKC,YAAL,GAAoBD,kBAAkB,CAACE,EAAvC;AACD;AACF;AACF,WARD;;AAP4B;AAgB7B;AAED;;;;;;;iBAGA,4BAAgB;AACd,gBAAG,KAAKC,eAAR,EAAwB;AACtB,qBAAO,KAAP;AACD,aAFD,MAEM,IAAG,KAAKC,YAAR,EAAqB;AACzB,qBAAO,KAAKC,cAAL,CAAoB,KAAKD,YAAzB,EAAuC,KAAKE,gBAA5C,CAAP;AACD,aAFK,MAEA,IAAG,KAAKC,cAAL,EAAH,EAAyB;AAC7B,qBAAO,IAAP;AACD;;AACD,mBAAO,KAAP;AACD;AAED;;;;;;iBAGA,wBAAeC,EAAf,EAAoCC,EAApC,EAAuD;AACrD,gBAAMC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYF,EAAZ,CAAb;;AACA,iBAAI,IAAMI,CAAV,IAAeF,IAAf,EAAoB;AAClB,kBAAMG,GAAG,GAAGH,IAAI,CAACE,CAAD,CAAhB;;AACA,kBAAGJ,EAAE,CAACK,GAAD,CAAF,KAAYJ,EAAE,CAACI,GAAD,CAAjB,EAAuB;AACrB,uBAAO,IAAP;AACD;AACF;;AACD,mBAAO,KAAP;AACD;AAED;;;;;;eAGA,eAAoB;AAClB,gBAAI,CAAC,KAAKP,gBAAL,CAAsB5B,cAA3B,EAA2C;AACzC,qBAAO,KAAP;AACD;;AACD,mBAAO,KAAK4B,gBAAL,CAAsB,gBAAtB,MAA4C,QAAnD;AACD;AAED;;;;;;;iBAIA,2BAAe;AACb,iBAAKnC,aAAL,CAAmB2C,UAAnB,CAA8B,eAA9B;AACA,iBAAK1C,cAAL,CAAoB2C,QAApB,CAA6B,iBAA7B,EAAgD,CAAE,yBAAF,EAA6B,eAA7B,EAA8C;AAC5FC,oBAAM,EAAE,KAAKA;AAD+E,aAA9C,CAAhD;AAGD;AAID;;;;;;eAGA,eAA8B;AAC5B,gBAAI,CAAC,KAAKV,gBAAL,CAAsB5B,cAA3B,EAA2C;AACzC,qBAAO,KAAP;AACD;;AACD,mBAAO,KAAK4B,gBAAL,CAAsB,gBAAtB,MAA4C,QAA5C,IACD,KAAKA,gBAAL,CAAsB,gBAAtB,MAA4C,QAA5C,IAAwD,KAAKA,gBAAL,CAAsB,kBAAtB,CAAxD,IACA,KAAKA,gBAAL,CAAsB,kBAAtB,MAA8C,QAFpD;AAGD;AAED;;;;;;eAGA,eAAU;AACR,gBAAI,CAAC,KAAKA,gBAAL,CAAsB5B,cAA3B,EAA2C;AACzC,qBAAO,EAAP;AACD;;AACD,mBAAO,KAAKuC,SAAL,CAAevC,cAAf,CAA8BwC,cAA9B,CAA6C,KAAKD,SAAL,CAAevC,cAAf,CAA8ByC,YAA3E,CAAP;AACD;AAED;;;;;;iBAGO,wBAAY;AACjB,gBAAMT,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAY,KAAKO,SAAjB,CAAb;;AACA,iBAAK,IAAMG,CAAX,IAAgBV,IAAhB,EAAsB;AACpB,kBAAMG,GAAG,GAAGH,IAAI,CAACU,CAAD,CAAhB;AACA,mBAAKH,SAAL,CAAeJ,GAAf,IAAmBF,gCACd,KAAKM,SAAL,CAAeJ,GAAf,CADc,GACK;AACtBQ,oBAAI,EAAE,KAAKlB,eAAL,GAAuB,OAAvB,GAAiC;AADjB,eADL,CAAnB;AAID;;AACD,iBAAKA,eAAL,GAAuB,CAAC,KAAKA,eAA7B;AACA,iBAAKmB,kBAAL,GAAuBX,gCAClB,KAAKW,kBADa,GACK;AAAE9F,mBAAK,EAAE,KAAK2E,eAAL,GAAuB,gBAAvB,GAA0C,SAAnD;AAC1B1E,kBAAI,EAAE,KAAK0E,eAAL,GAAuB,SAAvB,GAAmC,SADf;AAC0BzE,kBAAI,EAAE,KAAKyE,eAAL,GAAuB,YAAvB,GAAsC;AADtE,aADL,CAAvB;AAIA,iBAAK/B,cAAL,CAAoB2C,QAApB,CAA6B,cAA7B,EAA6C,CAAE,yBAAF,EAA6B,eAA7B,EAA8C;AACzFC,oBAAM,EAAE,KAAKA;AAD4E,aAA9C,CAA7C;AAGD;AAED;;;;;;iBAGO,uBAAW;AAChB,gBAAMN,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAY,KAAKO,SAAjB,CAAb;;AACA,iBAAK,IAAMG,CAAX,IAAgBV,IAAhB,EAAsB;AACpB,kBAAMG,GAAG,GAAGH,IAAI,CAACU,CAAD,CAAhB;;AACA,kBAAGP,GAAG,KAAI,gBAAV,EAA2B;AACzB,oBAAMU,SAAS,GAAG,EAAlB;AACA,0CAAqC,KAAKN,SAAL,CAAeJ,GAAf,CAArC;AAAA,oBAAQM,YAAR,uBAAQA,YAAR;AAAA,oBAAsBK,UAAtB,uBAAsBA,UAAtB;AACAD,yBAAS,CAACC,UAAD,CAAT,GAAwB,KAAKlB,gBAAL,CAAsBO,GAAtB,CAAxB;AACAU,yBAAS,CAACJ,YAAD,CAAT,GAA0B,EAA1B;AACAI,yBAAS,CAACJ,YAAD,CAAT,GAA0B,KAAKb,gBAAL,CAAsBO,GAAtB,CAA1B;AACA,qBAAKI,SAAL,CAAeJ,GAAf,IAAmBF,gCACd,KAAKM,SAAL,CAAeJ,GAAf,CADc,GACK;AACtBQ,sBAAI,EAAE,MADgB;AAEtBH,gCAAc,EAAEK;AAFM,iBADL,CAAnB;AAKD,eAXD,MAWK;AACH,qBAAKN,SAAL,CAAeJ,GAAf,IAAmBF,gCACd,KAAKM,SAAL,CAAeJ,GAAf,CADc,GACK;AACtBQ,sBAAI,EAAE;AADgB,iBADL,CAAnB;AAID;AAGF;;AAED,iBAAKC,kBAAL,GAAuBX,gCAClB,KAAKW,kBADa,GACK;AAAE9F,mBAAK,EAAE,gBAAT;AAC1BC,kBAAI,EAAE,SADoB;AACTC,kBAAI,EAAE;AADG,aADL,CAAvB;AAIA,iBAAK0C,cAAL,CAAoB2C,QAApB,CAA6B,aAA7B,EAA4C,CAAE,yBAAF,EAA6B,eAA7B,EAA8C;AACxFC,oBAAM,EAAE,KAAKA;AAD2E,aAA9C,CAA5C;AAGD;AACD;;;;;;;iBAIO,uBAAW;AAAA;;AAEhB,iBAAK5C,cAAL,CAAoB2C,QAApB,CAA6B,aAA7B,EAA4C,CAAE,yBAAF,EAA6B,eAA7B,EAA8C;AACxFC,oBAAM,EAAE,KAAKA;AAD2E,aAA9C,CAA5C;;AAIA,gBAAI,KAAKb,eAAT,EAA0B;AACxB,kBAAI,CAAC,KAAKc,SAAL,CAAevC,cAAf,CAA8B+C,UAAnC,EAA+C;AAC7C,qBAAKR,SAAL,CAAevC,cAAf,CAA8BwC,cAA9B,CAA6CQ,IAA7C,GAAoD,EAApD;AACA,qBAAKT,SAAL,CAAevC,cAAf,CAA8B+C,UAA9B,GAA2C,KAAKpD,WAAL,CAAiBsD,YAAjB,EAA3C;AACAC,0BAAU,CAAC,YAAI;AACb,wBAAI,CAACC,OAAL,CAAaC,iBAAb;AACD,iBAFS,CAAV;AAID;;AAED,mBAAKC,YAAL;AACA;AACD;;AACD,iBAAK5D,aAAL,CAAmB6D,WAAnB;AACA,gBAAMC,QAAQ,GAAmB;AAC/B,gCAAkB,KAAK3B,gBAAL,CAAsB,gBAAtB,CADa;AAE/B,4BAAc,CAFiB;AAG/B,gCAAkB,KAAKA,gBAAL,CAAsB,gBAAtB,MAA4C,QAA5C,GAAsD,KAAKA,gBAAL,CAAsBlB,cAA5E,GAA2F,IAH9E;AAI/B,0BAAY,IAJmB;AAK/B,0BAAY,KAAKkB,gBAAL,CAAsBzB,QALH;AAM/B,kCAAoB,KAAKyB,gBAAL,CAAsBxB,gBANX;AAO/B,2BAAa,KAAKwB,gBAAL,CAAsBtB,SAPJ;AAQ/B,0BAAY,KAAKsB,gBAAL,CAAsBrB,QARH;AAS/B,6BAAe,KAAKqB,gBAAL,CAAsBjB,UATN;AAU/B,8BAAgB,KAAKiB,gBAAL,CAAsBhB,WAAtB,CAAkC4C,QAAlC,EAVe;AAW/B,uBAAS,KAAK5B,gBAAL,CAAsBd,KAXA;AAY/B,2BAAa,KAAKc,gBAAL,CAAsBpB,SAZJ;AAa/B,+BAAiB,KAAKoB,gBAAL,CAAsBnB,aAbR;AAc/B,6BAAe,KAAKmB,gBAAL,CAAsB,gBAAtB,MAA4C,mBAA5C,GAAgE,KAAKA,gBAAL,CAAsB3B,WAAtF,GAAkG,EAdlF;AAe/B,6BAAe,CAAC,KAAKwD,0BAAN,GAAiC,EAAjC,GAAqC,KAAK7B,gBAAL,CAAsB1B,WAf3C;AAgB/B,sCAAwB,CAAC,KAAKuD,0BAAN,GAAkC,EAAlC,GAAqC,KAAK7B,gBAAL,CAAsBvB;AAhBpD,aAAjC;;AAkBA,gBAAG,CAAC,KAAKZ,aAAL,CAAmBiE,gBAAvB,EAAyC;AACvCH,sBAAQ,CAAC,YAAD,CAAR,GAAyB,KAAK3B,gBAAL,CAAsB7B,SAA/C;AACD;;AACD,gBAAI,KAAKuC,MAAL,IAAe,GAAnB,EAAwB;AACtBiB,sBAAQ,CAACjB,MAAT,GAAkB,KAAKqB,YAAvB;AACAJ,sBAAQ,CAACK,QAAT,GAAoB,KAAKtB,MAAzB;AACA,mBAAK3C,WAAL,CAAiBkE,UAAjB,CAA4BN,QAA5B,EAAsCpC,SAAtC,CAAgD;AAC9C2C,oBAAI,EAAE,cAACC,MAAD,EAAgB;AACpB,sBAAIA,MAAJ,EAAY;AACV,0BAAI,CAACV,YAAL;;AACA,0BAAI,CAAC7D,MAAL,CAAYwE,QAAZ,CAAqB,uBAAiB,MAAI,CAAC1B,MAAtB,cAArB;AACD;;AACD,wBAAI,CAAC7C,aAAL,CAAmBwE,WAAnB;AACD,iBAP6C;AAQ9CC,qBAAK,EAAE,eAACC,GAAD,EAAY;AACjB,wBAAI,CAAC1E,aAAL,CAAmBwE,WAAnB;;AACA,wBAAI,CAACvE,cAAL,CAAoB0E,YAApB,CAAiCD,GAAjC,EAAsCE,oFAAtC;AACD;AAX6C,eAAhD;AAaD,aAhBD,MAgBO;AACL,mBAAK1E,WAAL,CAAiB2E,WAAjB,CAA6Bf,QAA7B,EAAuCpC,SAAvC,CAAiD;AAC/C2C,oBAAI,EAAE,cAACC,MAAD,EAAgB;AACpB,sBAAIA,MAAJ,EAAY;AACV,0BAAI,CAACzB,MAAL,GAAcyB,MAAM,CAAC1C,IAAP,CAAYuC,QAA1B;;AACA,0BAAI,CAACnE,aAAL,CAAmB6C,MAAnB,CAA0BwB,IAA1B,CAA+B,MAAI,CAACxB,MAApC;;AACA,0BAAI,CAACqB,YAAL,GAAoBI,MAAM,CAAC1C,IAAP,CAAYG,EAAhC;AACA,0BAAI,CAAC+C,MAAL,CAAYC,UAAZ,GAAyBT,MAAM,CAAC1C,IAAP,CAAYmD,UAArC;;AACA,0BAAI,CAACnB,YAAL,GALU,CAMV;;;AACA,0BAAI,CAAC7D,MAAL,CAAYwE,QAAZ,CAAqB,uBAAiB,MAAI,CAAC1B,MAAtB,EAArB,EAAuD;AAAEmC,gCAAU,EAAE;AAAd,qBAAvD;;AACA,0BAAI,CAACjF,MAAL,CAAYwE,QAAZ,CAAqB,uBAAiB,MAAI,CAAC1B,MAAtB,cAArB;AACD;;AACD,wBAAI,CAAC7C,aAAL,CAAmBwE,WAAnB;AACD,iBAb8C;AAc/CC,qBAAK,EAAE,eAACC,GAAD,EAAa;AAClB,wBAAI,CAAC1E,aAAL,CAAmBwE,WAAnB;;AACA,wBAAI,CAACvE,cAAL,CAAoB0E,YAApB,CAAiCD,GAAjC,EAAsCE,oFAAtC;AACD;AAjB8C,eAAjD;AAmBD;AACF;AAED;;;;;;iBAGA,sBAAarB,IAAb,EAAqB;;;AACnB,gBAAGA,IAAI,KAAK,KAAKT,SAAL,CAAevC,cAAf,CAA8BgD,IAA1C,EAA+C;AAC7C,mBAAKrC,UAAL,CAAgB+D,aAAhB;AACA,yBAAKC,UAAL,MAAe,IAAf,IAAeC,aAAf,GAAe,MAAf,GAAeA,GAAEF,aAAF,EAAf;AACD,aAHD,MAGM,IAAG1B,IAAI,KAAK,KAAKT,SAAL,CAAerC,WAAf,CAA2B8C,IAAvC,EAA4C;AAChD,mBAAKrC,UAAL,CAAgB+D,aAAhB;AACA,yBAAKvB,OAAL,MAAY,IAAZ,IAAY0B,aAAZ,GAAY,MAAZ,GAAYA,GAAEH,aAAF,EAAZ;AACD,aAHK,MAGD;AACH,yBAAKvB,OAAL,MAAY,IAAZ,IAAY2B,aAAZ,GAAY,MAAZ,GAAYA,GAAEJ,aAAF,EAAZ;AACA,yBAAKC,UAAL,MAAe,IAAf,IAAeI,aAAf,GAAe,MAAf,GAAeA,GAAEL,aAAF,EAAf;AACD;AACF;AAED;;;;;;iBAGA,0BAAiBM,KAAjB,EAA2B;AAAA;;;;AACzB,iBAAKvF,aAAL,CAAmBwE,WAAnB;;AAEA,gBAAI,CAACe,KAAL,EAAY;AACV;AACD;;AACD,gBAAIA,KAAK,IAAIA,KAAK,CAACC,MAAN,GAAe,CAA5B,EAA+B;AAC7B,kBAAMC,YAAY,GAAGF,KAAK,CAACG,MAAN,CAAa,UAACC,EAAD,EAAY;;;AAC5C,uBAAOA,EAAE,CAACC,gBAAH,MAAwB,YAAI,CAAC9C,SAAL,CAAe5B,UAAf,CAA0B6B,cAA1B,MAAwC,IAAxC,IAAwCoC,aAAxC,GAAwC,MAAxC,GAAwCA,GAAES,gBAAlE,CAAP;AACD,eAFoB,CAArB;;AAGA,kBAAIH,YAAY,CAACD,MAAb,GAAsB,CAA1B,EAA6B;AAC3B,oBAAMK,MAAM,GAAGJ,YAAY,CAAC,CAAD,CAA3B;AACA,oBAAMK,iBAAiB,GAAGD,MAAM,CAAC,eAAD,CAAhC;AACA,qBAAK/C,SAAL,CAAe5B,UAAf,GAAyBsB,gCAAQ,KAAKM,SAAL,CAAe5B,UAAvB,GAAiC;AAAE6B,gCAAc,EAAE8C;AAAlB,iBAAjC,CAAzB;AACA,qBAAK1E,WAAL,CAAiB4E,uBAAjB,CAAyCD,iBAAzC,EAA4D,IAA5D;AACD;;AACD,kBAAMjD,MAAM,GAAG,WAAKzC,KAAL,CAAW4F,MAAX,MAAiB,IAAjB,IAAiBb,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEc,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,IAAxB,CAAhC;;AACA,kBAAI,CAACtD,MAAD,IAAWA,MAAM,KAAK,GAA1B,EAA+B;AAC7B,qBAAKuD,cAAL,CAAoBb,KAApB;AACD;AAEF;AACF;AAED;;;;;;iBAGA,sBAAaM,MAAb,EAAkC;AAAA;;;;AAChC,iBAAK5F,cAAL,CAAoB2C,QAApB,CAA6B,cAA7B,EAA6C,CAAE,yBAAF,EAA6B,eAA7B,EAA8C;AACzFC,oBAAM,EAAE,KAAKA,MAD4E;AAEzFgD,oBAAM,EAANA;AAFyF,aAA9C,CAA7C;;AAIA,gBAAIA,MAAM,CAACtC,IAAP,KAAgB,YAApB,EAAkC;AAChC,kBAAMuC,iBAAiB,GAAGD,MAAM,CAACQ,KAAP,CAAa,eAAb,CAA1B;AACA,mBAAKlF,WAAL,CAAiB4E,uBAAjB,CAAyCD,iBAAzC;AACD;;AAED,gBAAID,MAAM,CAACvI,IAAP,KAAgB,QAApB,EAA8B;AAC5B,kBAAMgJ,QAAQ,GAAG,KAAKnE,gBAAL,CAAsB0D,MAAM,CAACtC,IAA7B,CAAjB;AACA,kBAAMgD,QAAQ,GAAG,KAAKzD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4BF,UAA5B,IAA0C,KAAKP,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4BP,YAAvF;;AACA,kBAAG,YAAKF,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,OAA2B,IAA3B,IAA2B4B,aAA3B,GAA2B,MAA3B,GAA2BA,GAAEpC,cAA7B,KAA+C,YAAKD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,OAA2B,IAA3B,IAA2B6B,aAA3B,GAA2B,MAA3B,GAA2BA,GAAErC,cAAF,CAAiBwD,QAAjB,CAA3B,OAA0DV,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEQ,KAAR,CAAcE,QAAd,CAA1D,CAAlD,EAAqI;AACnI;AACD;;AACD,mBAAKzD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,IAA2Bf,gCACtB,KAAKM,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,CADsB,GACK;AAAER,8BAAc,EAAE8C,MAAM,CAACQ;AAAzB,eADL,CAA3B;AAKA,mBAAKlE,gBAAL,CAAsB0D,MAAM,CAACtC,IAA7B,IAAqCsC,MAAM,CAACQ,KAAP,CAAaE,QAAb,CAArC;;AACA,kBAAIV,MAAM,CAACtC,IAAP,KAAgB,gBAApB,EAAsC;AACpC;AACA,oBAAG+C,QAAQ,KAAK,KAAKnE,gBAAL,CAAsB0D,MAAM,CAACtC,IAA7B,CAAhB,EAAmD;AACjDE,4BAAU,CAAC,YAAI;;;AACb,gCAAI,CAACyB,UAAL,MAAe,IAAf,IAAeC,aAAf,GAAe,MAAf,GAAeA,GAAEqB,YAAF,EAAf;AACA,gCAAI,CAAC5F,SAAL,MAAc,IAAd,IAAcwE,aAAd,GAAc,MAAd,GAAcA,GAAEoB,YAAF,EAAd;AACD,mBAHS,CAAV;AAKD;;AAED,oBAAGX,MAAM,CAACQ,KAAP,CAAaE,QAAb,KAA0BV,MAAM,CAACQ,KAAP,CAAa,KAAKvD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4BP,YAAzC,MAA2D,mBAAxF,EAA4G;AAC1G,uBAAKF,SAAL,CAAe,aAAf,IAA6BN,gCACxB,KAAKM,SAAL,CAAe,aAAf,CADwB,GACK;AAChCuD,yBAAK,EAAE;AADyB,mBADL,CAA7B;AAID;;AACD,oBAAIR,MAAM,CAACQ,KAAP,CAAaE,QAAb,KAA0BV,MAAM,CAACQ,KAAP,CAAa,KAAKvD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4BP,YAAzC,MAA2D,QAAzF,EAAmG;AACjG,uBAAKF,SAAL,CAAerC,WAAf,GAA0B+B,gCACrB,KAAKM,SAAL,CAAerC,WADM,GACK;AAC7BuC,gCAAY,EAAE,aADe;AACAK,8BAAU,EAAE,aADZ;AAE7BoD,oCAAgB,EAAE,KAAKC,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAFW;AAG7BC,+BAAW,EAAE,WAHgB;AAGHP,yBAAK,EAAE,EAHJ;AAI7B/I,wBAAI,EAAE,QAJuB;AAIbgG,8BAAU,EAAE,KAAKpD,WAAL,CAAiB2G,cAAjB,CAAgChB,MAAM,CAACQ,KAAP,CAAaE,QAAb,CAAhC,EAAwD,EAAxD;AAJC,mBADL,CAA1B;;AAOA,sBAAI,KAAKzD,SAAL,CAAerC,WAAf,CAA2BsC,cAA3B,KAA6C,WAAKD,SAAL,CAAerC,WAAf,CAA2BsC,cAA3B,MAAyC,IAAzC,IAAyCsC,aAAzC,GAAyC,MAAzC,GAAyCA,GAAE3E,QAAxF,CAAJ,EAAsG;AACpG,yBAAKyB,gBAAL,CAAsBpB,SAAtB,GAAkC,IAAlC;AACA,yBAAKoB,gBAAL,CAAsB1B,WAAtB,GAAoC,IAApC;AACA,yBAAKqC,SAAL,CAAerC,WAAf,CAA2BsC,cAA3B,GAA4C,EAA5C;AACD;;AACD,uBAAKZ,gBAAL,CAAsBvB,SAAtB,GAAkC,EAAlC;AACA,uBAAKkC,SAAL,CAAelC,SAAf,GAAwB4B,gCAAQ,KAAKM,SAAL,CAAelC,SAAvB,GAAgC;AAAEyF,yBAAK,EAAE;AAAT,mBAAhC,CAAxB;AACA5C,4BAAU,CAAC,YAAK;;;AACd,wBAAG6C,QAAQ,IAAIA,QAAQ,KAAK,QAAzB,IAAqC,MAAI,CAACQ,aAA7C,EAA2D;AACzD,kCAAI,CAAC5B,UAAL,MAAe,IAAf,IAAeC,aAAf,GAAe,MAAf,GAAeA,GAAExB,iBAAF,EAAf;AACD;AACF,mBAJS,CAAV;AAKD,iBApBD,MAoBO;AACL,sBAAIkC,MAAM,CAACQ,KAAP,CAAaE,QAAb,KAA0BV,MAAM,CAACQ,KAAP,CAAa,KAAKvD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4BP,YAAzC,MAA2D,QAAzF,EAAmG;AACjG,yBAAKF,SAAL,CAAe,aAAf,IAA6BN,gCACxB,KAAKM,SAAL,CAAe,aAAf,CADwB,GACK;AAChCuD,2BAAK,EAAE;AADyB,qBADL,CAA7B;AAIA,yBAAKvD,SAAL,CAAerC,WAAf,GAA0B+B,gCACrB,KAAKM,SAAL,CAAerC,WADM,GACK;AAC7BmG,iCAAW,EAAE;AADgB,qBADL,CAA1B;AAIA,yBAAKzE,gBAAL,CAAsB3B,WAAtB,GAAoC,EAApC;;AACA,wBAAG,KAAKsG,aAAR,EAAsB;AACpB,2BAAK5G,WAAL,CAAiB2G,cAAjB,CAAgChB,MAAM,CAACQ,KAAP,CAAaE,QAAb,CAAhC,EAAwD,EAAxD,EAA4D7E,SAA5D,CAAsE;AACpE2C,4BAAI,EAAE,cAAC0C,IAAD,EAAc;;;AAClB,8BAAIA,IAAI,IAAI,WAAI,CAACnF,IAAL,MAAS,IAAT,IAASuD,aAAT,GAAS,MAAT,GAASA,GAAEK,MAAX,IAAoB,CAAhC,EAAmC;AACjC,gCAAM5D,IAAI,GAAGmF,IAAI,CAACnF,IAAL,CAAU,CAAV,CAAb;AACA,kCAAI,CAACO,gBAAL,CAAsB,WAAtB,IAAqCP,IAAI,CAAC,WAAD,CAAzC;AACA,kCAAI,CAACO,gBAAL,CAAsB,UAAtB,IAAoCP,IAAI,CAAC,UAAD,CAAxC;;AACA,gCAAI,MAAI,CAACkB,SAAL,CAAerC,WAAf,CAA2BsC,cAA3B,KAA6C,YAAI,CAACD,SAAL,CAAerC,WAAf,CAA2BsC,cAA3B,MAAyC,IAAzC,IAAyCqC,aAAzC,GAAyC,MAAzC,GAAyCA,GAAE1E,QAAxF,CAAJ,EAAsG;AACpG,oCAAI,CAACyB,gBAAL,CAAsBvB,SAAtB,GAAkC,EAAlC;AACA,oCAAI,CAACkC,SAAL,CAAelC,SAAf,GAAwB4B,gCAAQ,YAAI,CAACM,SAAL,MAAc,IAAd,IAAcuC,aAAd,GAAc,MAAd,GAAcA,GAAEzE,SAAxB,GAAiC;AAAEyF,qCAAK,EAAE;AAAT,+BAAjC,CAAxB;AACD;;AACD,gCAAI,MAAI,CAAClE,gBAAL,CAAsB,MAAI,CAACW,SAAL,CAAe1B,gBAAf,CAAgCmC,IAAtD,MAAgE,QAApE,EAA8E;AAC5E,oCAAI,CAACpB,gBAAL,CAAsB,aAAtB,IAAuC,IAAvC;AACA,oCAAI,CAACW,SAAL,CAAerC,WAAf,CAA2B4F,KAA3B,GAAiC,EAAjC;AACD;;AACD,kCAAI,CAAClE,gBAAL,CAAsBxB,gBAAtB,GAAyCiB,IAAI,CAAC,YAAD,CAA7C;AACA,kCAAI,CAACO,gBAAL,CAAsBnB,aAAtB,GAAsCY,IAAI,CAAC,eAAD,CAA1C;AACA,kCAAI,CAACkB,SAAL,CAAerC,WAAf,CAA2BsC,cAA3B,GAA4CnB,IAAI,CAAC,CAAD,CAAhD;;AAGA,kCAAI,CAACoF,sBAAL;AACD;AAEF,yBAtBmE;AAsBjEvC,6BAAK,EAAE,iBAAK;AACb,gCAAI,CAACtC,gBAAL,CAAsB,UAAtB,IAAoC,CAApC;AACA,gCAAI,CAACA,gBAAL,CAAsBxB,gBAAtB,GAAyC,KAAzC;AACD;AAzBmE,uBAAtE;AA2BD;AAEF;;AACD,uBAAKmC,SAAL,CAAerC,WAAf,GAA0B+B,gCACrB,KAAKM,SAAL,CAAerC,WADM,GACK;AAAEnD,wBAAI,EAAE;AAAR,mBADL,CAA1B;AAGD;AACF;;AACD,kBAAIuI,MAAM,CAACtC,IAAP,KAAgB,aAAhB,IAAiCsC,MAAM,CAACQ,KAA5C,EAAmD;AACjD,qBAAKlE,gBAAL,CAAsB,WAAtB,IAAqC0D,MAAM,CAACQ,KAAP,CAAa,WAAb,CAArC;AACA,qBAAKlE,gBAAL,CAAsB,UAAtB,IAAoC0D,MAAM,CAACQ,KAAP,CAAa,UAAb,CAApC;AACA,qBAAKlE,gBAAL,CAAsBxB,gBAAtB,GAAyCkF,MAAM,CAACQ,KAAP,CAAa,YAAb,CAAzC;AACA,qBAAKlE,gBAAL,CAAsBvB,SAAtB,GAAkCiF,MAAM,CAACQ,KAAP,CAAa,WAAb,EAA0BtC,QAA1B,EAAlC;AACA,qBAAKjB,SAAL,CAAelC,SAAf,GAAwB4B,gCAAQ,WAAKM,SAAL,MAAc,IAAd,IAAcwC,aAAd,GAAc,MAAd,GAAcA,GAAE1E,SAAxB,GAAiC;AAAEyF,uBAAK,EAAER,MAAM,CAACQ,KAAP,CAAa,WAAb,EAA0BtC,QAA1B;AAAT,iBAAjC,CAAxB;AACA,qBAAK5B,gBAAL,CAAsBnB,aAAtB,GAAsC6E,MAAM,CAACQ,KAAP,CAAa,eAAb,CAAtC;AACD;;AACD,mBAAKlE,gBAAL,CAAsB,KAAKW,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4B,SAA5B,CAAtB,IAAgEsC,MAAM,CAACQ,KAAP,CAAa,KAAKvD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4BP,YAAzC,CAAhE;AACD,aAxGD,MAwGO;AACL,kBAAI6C,MAAM,CAACtC,IAAP,KAAgB,kBAAhB,IAAsCsC,MAAM,CAACoB,aAA7C,IAA8D,KAAKnE,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4B,SAA5B,CAAlE,EAA0G;AACxG,qBAAKpB,gBAAL,CAAsB,KAAKW,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4B,SAA5B,CAAtB,IAAgEsC,MAAM,CAACoB,aAAvE;AACD;;AACD,kBAAIpB,MAAM,CAACqB,OAAX,EAAoB;AAClB,qBAAKpE,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4B8C,KAA5B,GAAoCR,MAAM,CAACQ,KAA3C;AACA,qBAAKlE,gBAAL,CAAsB0D,MAAM,CAACtC,IAA7B,IAAqCsC,MAAM,CAACQ,KAA5C;AACD,eAHD,MAGO;AACL,qBAAKvD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4B8C,KAA5B,GAAoC,EAApC;;AACA,oBAAGR,MAAM,CAACtC,IAAP,KAAgB,aAAnB,EAAiC;AAC/B,uBAAKpB,gBAAL,CAAsB0D,MAAM,CAACtC,IAA7B,IAAqC,EAArC;AACD,iBAFD,MAEK;AACH,uBAAKpB,gBAAL,CAAsB0D,MAAM,CAACtC,IAA7B,IAAqC,CAArC;AACD;AAEF;AAEF;;AACD,iBAAKpB,gBAAL,GAAqBK,kBAAQ,KAAKL,gBAAb,CAArB;AACA,iBAAK6E,sBAAL;AACD;AAED;;;;;;iBAGA,6BAAiB;AACf,iBAAK/G,cAAL,CAAoB2C,QAApB,CAA6B,mBAA7B,EAAkD,CAAE,yBAAF,EAA6B,eAA7B,EAA8C;AAC9FC,oBAAM,EAAE,KAAKA;AADiF,aAA9C,CAAlD;AAGA,iBAAK9C,MAAL,CAAYwE,QAAZ,CAAqB,uBAAiB,KAAK1B,MAAtB,cAArB;AACD;AAED;;;;;;iBAGA,wBAAe0C,KAAf,EAAyB;AAAA;;;;AACvB,gBAAIA,KAAK,IAAI,KAAKpD,gBAAL,CAAsBpB,SAA/B,IAA4C,CAAC,KAAKoB,gBAAL,CAAsB,UAAtB,CAAjD,EAAoF;AAClF,kBAAMsD,YAAY,GAAGF,KAAK,CAACG,MAAN,CAAa,UAACC,EAAD,EAAY;AAC5C,uBAAOA,EAAE,CAAC5E,SAAH,KAAiB,MAAI,CAACoB,gBAAL,CAAsBpB,SAA9C;AACD,eAFoB,CAArB;;AAGA,kBAAI0E,YAAY,CAACD,MAAb,GAAsB,CAA1B,EAA6B;AAC3B,qBAAKrD,gBAAL,CAAsB,UAAtB,IAAoCsD,YAAY,CAAC,CAAD,CAAZ,CAAgB,UAAhB,CAApC;AACA,qBAAKtD,gBAAL,CAAsBxB,gBAAtB,GAAyC8E,YAAY,CAAC,CAAD,CAAZ,CAAgB,YAAhB,CAAzC;AACA,qBAAK3C,SAAL,CAAelC,SAAf,GAAwB4B,gCAAQ,WAAKM,SAAL,MAAc,IAAd,IAAcqC,aAAd,GAAc,MAAd,GAAcA,GAAEvE,SAAxB,GAAiC;AAAEyF,uBAAK,EAAEZ,YAAY,CAAC,CAAD,CAAZ,CAAgB,WAAhB,EAA6B1B,QAA7B;AAAT,iBAAjC,CAAxB;AACA,qBAAK5B,gBAAL,CAAsBnB,aAAtB,GAAsCyE,YAAY,CAAC,CAAD,CAAZ,CAAgB,eAAhB,CAAtC;AACA,qBAAK3C,SAAL,CAAerC,WAAf,CAA2BsC,cAA3B,GAA4C0C,YAAY,CAAC,CAAD,CAAxD;AACD;AAEF;AACF;AAED;;;;;;eAGA,eAAiB;;;AACf,gBAAI,EAAC,WAAK0B,YAAL,MAAiB,IAAjB,IAAiBhC,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEjI,MAApB,KAA8B,CAAC,KAAK8E,eAAxC,EAAyD;AACvD,qBAAO,IAAP;AACD;;AACD,mBAAO,CAAE,QAAF,EAAY,UAAZ,EAAwB,UAAxB,EAAoC,QAApC,EAA8C,kBAA9C,EAAmEoF,OAAnE,CAA2E,iBAAKD,YAAL,MAAiB,IAAjB,IAAiB/B,aAAjB,GAAiB,MAAjB,GAAiBA,GAAElI,MAAnB,MAAyB,IAAzB,IAAyBmI,aAAzB,GAAyB,MAAzB,GAAyBA,GAAEgC,WAAF,EAApG,MAAyH,CAAC,CAA1H,IACH,CAAC,KAAKrF,eADV;AAED;AAED;;;;;;eAGA,eAAqB;;;AACnB,gBAAI,EAAC,WAAKmF,YAAL,MAAiB,IAAjB,IAAiBhC,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEjI,MAApB,KAA8B,KAAK4E,YAAL,MAAsB,iBAAKqF,YAAL,MAAiB,IAAjB,IAAiB/B,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEvD,kBAAnB,MAAqC,IAArC,IAAqCwD,aAArC,GAAqC,MAArC,GAAqCA,GAAEiC,cAA7D,CAAlC,EAA+G;AAC7G,qBAAO,IAAP;AACD,aAFD,MAEO,IAAG,KAAKtH,aAAL,CAAmBuH,UAAtB,EAAkC;AACvC,qBAAO,KAAP;AACD;;AACD,mBAAO,CAAE,QAAF,EAAY,UAAZ,EAAwB,UAAxB,EAAoC,QAApC,EAA8C,kBAA9C,EAAkE,UAAlE,EAA+EH,OAA/E,CAAuF,iBAAKD,YAAL,MAAiB,IAAjB,IAAiB7B,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEpI,MAAnB,MAAyB,IAAzB,IAAyBsK,aAAzB,GAAyB,MAAzB,GAAyBA,GAAEH,WAAF,EAAhH,MAAqI,CAAC,CAA7I;AACD;AAED;;;;;;iBAGA,2BAAe;AAAA;;;;AACb,gBAAM9E,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAY,KAAKO,SAAjB,CAAb;AAEA,gBAAMD,MAAM,GAAG,WAAKzC,KAAL,CAAW4F,MAAX,MAAiB,IAAjB,IAAiBb,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEc,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,IAAxB,CAAhC;;AACA,gBAAItD,MAAM,IAAIA,MAAM,IAAI,GAAxB,EAA6B;AAC3B,mBAAKA,MAAL,GAAcA,MAAd;AACA,mBAAK4E,YAAL,GAAoB,IAApB;AACA,mBAAKzH,aAAL,CAAmB6C,MAAnB,CAA0BwB,IAA1B,CAA+B,KAAKxB,MAApC;AAEA,mBAAK7C,aAAL,CAAmB6D,WAAnB;AACA,mBAAK3D,WAAL,CAAiBwH,aAAjB,CAA+B,KAAK7E,MAApC,EAA4CnB,SAA5C,CAAsD;AACpD2C,oBAAI,EAAE,cAACC,MAAD,EAAgB;;;AACpB,wBAAI,CAAC6C,YAAL,GAAoB7C,MAAM,CAAC1C,IAA3B;AACA,wBAAI,CAACsC,YAAL,GAAoB,MAAI,CAACiD,YAAL,CAAkBpF,EAAtC;;AACA,wBAAI,CAAC/B,aAAL,CAAmB2H,UAAnB,CAA8BtD,IAA9B,CAAmC,MAAI,CAAC8C,YAAL,CAAkBjK,MAArD;;AACA,sBAAM0K,WAAW,GAAG,MAAI,CAACT,YAAL,CAAkBS,WAAtC;;AACA,sBAAGA,WAAW,CAACpC,MAAZ,GAAqB,CAAxB,EAA0B;AACxB,0BAAI,CAACxF,aAAL,CAAmB6H,YAAnB,CAAgCxD,IAAhC,CAAqC,MAAI,CAAC8C,YAAL,CAAkBS,WAAlB,CAA8B,CAA9B,EAAiCC,YAAtE;AACD;;AAED,sBAAI,MAAI,CAAC/F,YAAL,KAAqB,kBAAI,CAACqF,YAAL,MAAiB,IAAjB,IAAiBhC,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEtD,kBAAnB,MAAqC,IAArC,IAAqCuD,aAArC,GAAqC,MAArC,GAAqCA,GAAEkC,cAA5D,CAAJ,EAAgF;AAC9E,0BAAI,CAACtH,aAAL,CAAmBuH,UAAnB,GAAgC,IAAhC;AACD,mBAFD,MAEK;AACH,0BAAI,CAACvH,aAAL,CAAmBuH,UAAnB,GAAgC,KAAhC;AACD;;AAED,sBAAI,CAAC,MAAI,CAACT,aAAN,IAAuB,MAAI,CAAC9G,aAAL,CAAmBuH,UAA9C,EAA0D;AACxD,0BAAI,CAACO,WAAL;;AACA,0BAAI,CAAC9F,eAAL,GAAuB,IAAvB;AACD;;AAED,wBAAI,CAAC8C,MAAL,CAAYC,UAAZ,GAAyB,MAAI,CAACoC,YAAL,CAAkBpC,UAA3C;AACA,wBAAI,CAACgD,oBAAL,GAA4B,wFAAmB,MAAI,CAACZ,YAAxB,CAA5B;AACA,wBAAI,CAAChF,gBAAL,GAAwB,oFAAe,MAAI,CAAC4F,oBAApB,CAAxB;AACA,wBAAI,CAAC9F,YAAL,GAAoB+F,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAe,MAAI,CAAC/F,gBAApB,CAAX,CAApB;;AACA,uBAAK,IAAMc,CAAX,IAAgBV,IAAhB,EAAsB;AACpB,wBAAM4F,GAAG,GAAG,MAAI,CAACrF,SAAL,CAAeP,IAAI,CAACU,CAAD,CAAnB,CAAZ;AACA,wBAAQ3F,IAAR,GAA2C6K,GAA3C,CAAQ7K,IAAR;AAAA,wBAAc0F,YAAd,GAA2CmF,GAA3C,CAAcnF,YAAd;AAAA,wBAA4BK,UAA5B,GAA2C8E,GAA3C,CAA4B9E,UAA5B;;AACA,wBAAI,MAAI,CAAClB,gBAAL,CAAsBI,IAAI,CAACU,CAAD,CAA1B,CAAJ,EAAoC;AAClC,0BAAI3F,IAAI,KAAK,QAAb,EAAuB;AACrB,4BAAM8F,SAAS,GAAG,EAAlB;AACAA,iCAAS,CAACJ,YAAD,CAAT,GAA0B,EAA1B;AACAI,iCAAS,CAACC,UAAD,CAAT,GAAwB,MAAI,CAAClB,gBAAL,CAAsBI,IAAI,CAACU,CAAD,CAA1B,CAAxB;;AACA,4BAAG,CAAC,MAAI,CAAC6D,aAAN,IAAuBvE,IAAI,CAACU,CAAD,CAAJ,KAAW,gBAArC,EAAsD;AACpDG,mCAAS,CAACJ,YAAD,CAAT,GAA0B,MAAI,CAACb,gBAAL,CAAsBI,IAAI,CAACU,CAAD,CAA1B,CAA1B;AACD;;AACD,8BAAI,CAACH,SAAL,CAAeP,IAAI,CAACU,CAAD,CAAnB,IAAuBT,gCAClB,MAAI,CAACM,SAAL,CAAeP,IAAI,CAACU,CAAD,CAAnB,CADkB,GACK;AAC1BoD,+BAAK,EAAE,EADmB;AAE1BtD,wCAAc,EAAEK;AAFU,yBADL,CAAvB;AAKD,uBAZD,MAYO;AACL,4BAAIL,cAAc,GAAG,EAArB;;AACA,4BAAIR,IAAI,CAACU,CAAD,CAAJ,KAAY,aAAhB,EAA+B;AAC7BF,wCAAc,GAAC;AAAE,2CAAe,MAAI,CAACZ,gBAAL,CAAsBI,IAAI,CAACU,CAAD,CAA1B;AAAjB,2BAAf;AACD;;AACD,8BAAI,CAACH,SAAL,CAAeP,IAAI,CAACU,CAAD,CAAnB,IAAuBT,gCAClB,MAAI,CAACM,SAAL,CAAeP,IAAI,CAACU,CAAD,CAAnB,CADkB,GACK;AAC1BoD,+BAAK,EAAE,MAAI,CAAClE,gBAAL,CAAsBI,IAAI,CAACU,CAAD,CAA1B,CADmB;AAE1BF,wCAAc,EAAdA;AAF0B,yBADL,CAAvB;AAKD;AAEF;AACF;;AACD,wBAAI,CAACqF,gBAAL;;AAEA,wBAAI,CAACpI,aAAL,CAAmBwE,WAAnB;AACD,iBA1DmD;AA2DpDC,qBAAK,EAAE,iBAAK;AACV,wBAAI,CAACzE,aAAL,CAAmBwE,WAAnB;AACD,iBA7DmD;AA8DpD5G,wBAAQ,EAAE,oBAAK;AACb,wBAAI,CAAC6J,YAAL,GAAoB,KAApB;AACD;AAhEmD,eAAtD;AAkED,aAxED,MAwEO;AACL,mBAAKA,YAAL,GAAoB,KAApB;;AACA,kBAAI,CAAC,KAAK3E,SAAL,CAAevC,cAAf,CAA8B+C,UAAnC,EAA+C;AAC7C,qBAAKR,SAAL,CAAevC,cAAf,CAA8B+C,UAA9B,GAA2C,KAAKpD,WAAL,CAAiBsD,YAAjB,EAA3C;AACD;;AACD,mBAAK,IAAMP,CAAX,IAAgBV,IAAhB,EAAsB;AACpB,oBAAMG,GAAG,GAAGH,IAAI,CAACU,CAAD,CAAhB;;AACA,oBAAGP,GAAG,KAAI,YAAV,EAAuB;AACrB,uBAAKI,SAAL,CAAeJ,GAAf,IAAmBF,gCACd,KAAKM,SAAL,CAAeJ,GAAf,CADc,GACK;AACtB2D,yBAAK,EAAE,EADe;AAEtBtD,kCAAc,EAAE;AAFM,mBADL,CAAnB;AAKD,iBAND,MAMK;AACH,uBAAKD,SAAL,CAAeJ,GAAf,IAAmBF,gCACd,KAAKM,SAAL,CAAeJ,GAAf,CADc,GACK;AACtB2D,yBAAK,EAAE,EADe;AAEtBtD,kCAAc,EAAE;AAAE,0CAAoB;AAAtB;AAFM,mBADL,CAAnB;AAKA,uBAAKZ,gBAAL,CAAsBjB,UAAtB,GAAmC,KAAnC;AACD;AAEF;AACF;AACF;AAED;;;;;;iBAGA,wBAAeqE,KAAf,EAAwB;;;AACtB,gBAAM8C,WAAW,GAAG,KAAKrI,aAAL,CAAmBsI,iBAAnB,CAAqC,oBAArC,CAApB;;AACA,gBAAGD,WAAH,EAAe;AACb,kBAAME,UAAU,GAAGP,IAAI,CAACC,KAAL,CAAWI,WAAX,CAAnB;AACA,mBAAKvF,SAAL,CAAezB,KAAf,GAAoBmB,gCACf,KAAKM,SAAL,CAAezB,KADA,GACK;AACvBgF,qBAAK,EAAEkC,UAAU,CAAClH,KADK;AAEvB0B,8BAAc,EAAE;AAFO,eADL,CAApB;AAKA,mBAAKZ,gBAAL,CAAsBd,KAAtB,GAA8BkH,UAAU,CAAClH,KAAzC;;AACA,kBAAIkH,UAAU,CAAC1H,SAAf,EAA0B;AACxB,qBAAKsB,gBAAL,CAAsBtB,SAAtB,GAAkC0H,UAAU,CAAC1H,SAA7C;AACA,qBAAKiC,SAAL,CAAejC,SAAf,GAAwB2B,gCACnB,KAAKM,SAAL,CAAejC,SADI,GACK;AAC3BwF,uBAAK,EAAE,KAAKlE,gBAAL,CAAsBtB,SADF;AAE3BkC,gCAAc,EAAE;AAFW,iBADL,CAAxB;AAKD;;AAED,kBAAGwF,UAAU,CAACzH,QAAd,EAAuB;AACrB,qBAAKqB,gBAAL,CAAsBrB,QAAtB,GAAiCyH,UAAU,CAACzH,QAA5C;AACA,qBAAKgC,SAAL,CAAehC,QAAf,GAAuB0B,gCAClB,KAAKM,SAAL,CAAehC,QADG,GACK;AAC1BuF,uBAAK,EAAE,KAAKlE,gBAAL,CAAsBrB,QADH;AAE1BiC,gCAAc,EAAE;AAFU,iBADL,CAAvB;AAKD;;AACD,kBAAGwF,UAAU,CAACC,WAAd,EAA0B;AACxB,oBAAMC,IAAI,GAAG,gBAAU,CAACD,WAAX,MAAsB,IAAtB,IAAsBrD,aAAtB,GAAsB,MAAtB,GAAsBA,GAAEuD,SAAF,CAAY,CAAZ,EAAe,CAAf,CAAnC;AACA,oBAAMC,KAAK,GAAG,gBAAU,CAACH,WAAX,MAAsB,IAAtB,IAAsBpD,aAAtB,GAAsB,MAAtB,GAAsBA,GAAEsD,SAAF,CAAY,CAAZ,EAAe,CAAf,CAApC;AACA,oBAAIE,kBAAkB,GAAG,EAAzB;AACA,oBAAInD,YAAY,GAAGF,KAAK,CAACG,MAAN,CAAa,UAACC,EAAD,EAAY;AAC1C,yBAAOA,EAAE,CAACC,gBAAH,KAAwB6C,IAA/B;AACD,iBAFkB,CAAnB;;AAGA,oBAAGhD,YAAY,CAACD,MAAb,KAAwB,CAA3B,EAA8B;AAC5BoD,oCAAkB,GAAG,gBAAU,CAACJ,WAAX,MAAsB,IAAtB,IAAsBnD,aAAtB,GAAsB,MAAtB,GAAsBA,GAAEqD,SAAF,CAAY,CAAZ,EAAe,gBAAU,CAACF,WAAX,MAAsB,IAAtB,IAAsBlD,aAAtB,GAAsB,MAAtB,GAAsBA,GAAEE,MAAvC,CAA3C;AACAC,8BAAY,GAAGF,KAAK,CAACG,MAAN,CAAa,UAACC,EAAD,EAAY;AACtC,2BAAOA,EAAE,CAACC,gBAAH,KAAwB+C,KAA/B;AACD,mBAFc,CAAf;AAGD,iBALD,MAKK;AACHC,oCAAkB,GAAG,gBAAU,CAACJ,WAAX,MAAsB,IAAtB,IAAsBhB,aAAtB,GAAsB,MAAtB,GAAsBA,GAAEkB,SAAF,CAAY,CAAZ,EAAe,gBAAU,CAACF,WAAX,MAAsB,IAAtB,IAAsBK,aAAtB,GAAsB,MAAtB,GAAsBA,GAAErD,MAAvC,CAA3C;AACD;;AACD,oBAAIC,YAAY,CAACD,MAAb,GAAsB,CAA1B,EAA6B;AAC3B,sBAAMK,MAAM,GAAGJ,YAAY,CAAC,CAAD,CAA3B;AACA,sBAAMK,iBAAiB,GAAGD,MAAM,CAAC,eAAD,CAAhC;AACA,uBAAK1D,gBAAL,CAAsBjB,UAAtB,GAAmC2E,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAED,gBAA3C;AACA,uBAAK9C,SAAL,CAAe5B,UAAf,GAAyBsB,gCAAQ,KAAKM,SAAL,CAAe5B,UAAvB,GAAiC;AAAE6B,kCAAc,EAAE8C;AAAlB,mBAAjC,CAAzB;AACA,6BAAK1E,WAAL,MAAgB,IAAhB,IAAgB2H,aAAhB,GAAgB,MAAhB,GAAgBA,GAAE/C,uBAAF,CAA0BD,iBAA1B,EAA6C,IAA7C,CAAhB;AACD;;AACD,qBAAKhD,SAAL,CAAe3B,WAAf,GAA0BqB,gCACrB,KAAKM,SAAL,CAAe3B,WADM,GACK;AAC7BkF,uBAAK,EAAEuC,kBADsB;AAE7B7F,gCAAc,EAAE;AAFa,iBADL,CAA1B;AAKA,qBAAKZ,gBAAL,CAAsBhB,WAAtB,GAAoC4H,QAAQ,CAACH,kBAAD,CAA5C;AACD;;AACD,kBAAGL,UAAU,CAAClH,KAAX,IAAoBkH,UAAU,CAACC,WAA/B,IAA8CD,UAAU,CAAC1H,SAA5D,EAAsE;AACpE,oBAAG0H,UAAU,CAACS,IAAX,IAAmBT,UAAU,CAACU,KAA9B,IAAuCV,UAAU,CAACW,GAAlD,IAAyDX,UAAU,CAACY,KAAvE,EAA6E;AAC3E;AACD;;AACD,qBAAKnJ,aAAL,CAAmBoJ,iBAAnB,CAAqC,oBAArC,EAA2D,EAA3D;AACD;AACF;AACF;AAED;;;;;;iBAGA,0BAAc;AACZ,gBAAM7G,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAY,KAAKJ,gBAAjB,CAAb;AACA,gBAAMkH,aAAa,GAAqB;AACtC/I,uBAAS,EAAE,EAD2B;AAEtCC,4BAAc,EAAE,EAFsB;AAGtCC,yBAAW,EAAE,EAHyB;AAItCC,yBAAW,EAAE,EAJyB;AAKtCC,sBAAQ,EAAE,CAL4B;AAMtCC,8BAAgB,EAAE,IANoB;AAOtCC,uBAAS,EAAE,EAP2B;AAQtCC,uBAAS,EAAE,EAR2B;AAStCC,sBAAQ,EAAE,EAT4B;AAUtCC,uBAAS,EAAE,CAV2B;AAWtCC,2BAAa,EAAE,CAXuB;AAYtCC,4BAAc,EAAE,CAZsB;AAatCC,wBAAU,EAAE,KAb0B;AActCC,yBAAW,EAAE,CAdyB;AAetCC,8BAAgB,EAAE,EAfoB;AAgBtCC,mBAAK,EAAE;AAhB+B,aAAxC;AAkBA,mBAAO,KAAKa,cAAL,CAAoB,KAAKC,gBAAzB,EAA2CkH,aAA3C,CAAP;AACD;AAED;;;;;;iBAGA,kCAAsB;AACpB,gBAAM9G,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAY,KAAKJ,gBAAjB,CAAb;AACA,gBAAImH,WAAW,GAAG,EAAlB;;AACA,gBAAI,KAAKC,MAAL,KAAgB,QAApB,EAA8B;AAC5B,kBAAI,KAAKpH,gBAAL,CAAsB,kBAAtB,MAA8C,QAAlD,EAA4D;AAC1DmH,2BAAW,GAAG,CAAE,aAAF,EAAiB,aAAjB,EAAgC,WAAhC,EAA6C,WAA7C,CAAd;AACD,eAFD,MAEM,IAAG,KAAKnH,gBAAL,CAAsB,kBAAtB,MAA8C,SAAjD,EAA2D;AAC/DmH,2BAAW,GAAG,CAAE,aAAF,EAAiB,WAAjB,CAAd;AACD;AACF,aAND,MAMO,IAAI,KAAKnH,gBAAL,CAAsB5B,cAAtB,IAAwC,mBAA5C,EAAiE;AACtE+I,yBAAW,GAAG,CAAE,aAAF,CAAd;AACD;;AACD,gBAAG,KAAKtJ,aAAL,CAAmBiE,gBAAtB,EAAwC;AACtCqF,yBAAW,CAACE,IAAZ,CAAiB,WAAjB;AACD;;AACD,gBAAItC,OAAO,GAAG,IAAd;;AACA,iBAAK,IAAMjE,CAAX,IAAgBV,IAAhB,EAAsB;AACpB,kBAAMkH,IAAI,GAAGlH,IAAI,CAACU,CAAD,CAAjB;;AACA,kBAAIwG,IAAI,KAAK,kBAAT,IAA+BA,IAAI,KAAK,kBAAxC,IAA8DH,WAAW,CAAClC,OAAZ,CAAoBqC,IAApB,MAA8B,CAAC,CAAjG,EAAoG;AAClG;AACD;;AACD,kBAAI,CAAC,KAAKtH,gBAAL,CAAsBsH,IAAtB,CAAL,EAAkC;AAChCvC,uBAAO,GAAG,KAAV;AACD;AACF;;AACD,gBAAI,KAAKlF,eAAT,EAA0B;AACxB,mBAAKmB,kBAAL,CAAwB7F,IAAxB,GAA+B,SAA/B;AACD,aAFD,MAGA,IAAI,CAAC4J,OAAL,EAAc;AACZ,mBAAK/D,kBAAL,CAAwB7F,IAAxB,GAA+B,UAA/B;AACD,aAFD,MAEO;AACL,kBAAI,KAAK0E,eAAT,EAA0B;AACxB,qBAAKmB,kBAAL,CAAwB7F,IAAxB,GAA+B,SAA/B;AACA;AACD;;AACD,mBAAK6F,kBAAL,CAAwB7F,IAAxB,GAA+B,SAA/B;AACD;;AACD,iBAAK2C,cAAL,CAAoB2C,QAApB,CAA6B,wBAA7B,EAAuD,CAAE,yBAAF,EAA6B,eAA7B,EAA8C;AACnG8G,8BAAgB,EAAExC,OAAO,GAAG,eAAH,GAAqB;AADqD,aAA9C,CAAvD;AAID;AAED;;;;;;iBAGA,4BAAgB;AAAA;;AACd,iBAAK9G,KAAL,CAAWuJ,WAAX,CAAuBjI,SAAvB,CAAiC,UAACkI,MAAD,EAAU;AACzC,kBAAMC,SAAS,GAAGD,MAAM,CAAC,QAAD,CAAxB;;AACA,kBAAIC,SAAS,KAAK,MAAd,IAAwBA,SAAS,KAAK,IAA1C,EAAgD;AAC9C,sBAAI,CAAC7H,eAAL,GAAuB,IAAvB;;AACA,sBAAI,CAAC8F,WAAL;AACD,eAHD,MAGM,IAAG,MAAI,CAAChB,aAAR,EAAsB;AAC1B,oBAAI,CAAC,MAAI,CAAChE,SAAL,CAAevC,cAAf,CAA8B+C,UAAnC,EAA+C;AAC7C,wBAAI,CAACR,SAAL,CAAevC,cAAf,CAA8B+C,UAA9B,GAA2C,MAAI,CAACpD,WAAL,CAAiBsD,YAAjB,EAA3C;AACD;AACF;AACF,aAVD;AAWD;AAED;;;;;;iBAGA,oBAAQ;AAAA;;AACN,iBAAKvD,cAAL,CAAoB2C,QAApB,CAA6B,UAA7B,EAAyC,CAAE,yBAAF,EAA6B,eAA7B,CAAzC;AACA,iBAAKE,SAAL,GAAiB,kFAAjB;;AACA,gBAAG,KAAK9C,aAAL,CAAmBiE,gBAAtB,EAAwC;AACtC,mBAAKnB,SAAL,CAAexC,SAAf,GAAwBkC,gCACnB,KAAKM,SAAL,CAAexC,SADI,GACK;AAC3BwJ,wBAAQ,EAAE,IADiB;AAE3BC,0BAAU,EAAE;AAFe,eADL,CAAxB;AAKD;;AACD,iBAAK5G,kBAAL,GAA0B;AACxB9F,mBAAK,EAAE,SADiB;AAExBC,kBAAI,EAAE,SAFkB;AAGxBC,kBAAI,EAAE,OAHkB;AAIxByM,qBAAO,EAAE,KAAKC,WAAL,CAAiBtD,IAAjB,CAAsB,IAAtB;AAJe,aAA1B;AAMA,iBAAKuD,eAAL,GAAuB;AACrB7M,mBAAK,EAAE,kBADc;AAErBC,kBAAI,EAAE,SAFe;AAGrBC,kBAAI,EAAE,aAHe;AAIrByM,qBAAO,EAAE,KAAKG,iBAAL,CAAuBxD,IAAvB,CAA4B,IAA5B;AAJY,aAAvB;;AAQA,gBAAI,CAAC,KAAK7D,SAAL,CAAe5B,UAAf,CAA0BoC,UAA/B,EAA2C;AACzC,mBAAKR,SAAL,CAAe5B,UAAf,CAA0BoC,UAA1B,GAAuC,KAAKnD,WAAL,CAAiBiK,cAAjB,EAAvC;AACA,mBAAKtH,SAAL,CAAe5B,UAAf,CAA0BuF,gBAA1B,GAA6C,KAAKA,gBAAL,CAAsBE,IAAtB,CAA2B,IAA3B,CAA7C;AACD;;AACD,iBAAK7B,MAAL,CAAYC,UAAZ,GAAyB,EAAzB;AACA,iBAAKiC,sBAAL;AACA,iBAAKqD,eAAL;AAEA,iBAAKrK,aAAL,CAAmBsB,WAAnB,CAA+BI,SAA/B,CAAyC;AACvC2C,kBAAI,EAAE,cAAC1C,GAAD,EAAiB;AACrB,oBAAI,CAACA,GAAL,EAAU;AACR,wBAAI,CAAC2I,YAAL,GAAoB,IAApB;AACD;AACF;AALsC,aAAzC;AAQA,gBAAMC,SAAS,GAAQC,QAAQ,CAACC,aAAT,CAAuB,oBAAvB,CAAvB;;AACA,gBAAGF,SAAH,EAAa;AACXA,uBAAS,CAACG,SAAV,GAAsB,CAAtB;AACD;AACF;AAED;;;;;;iBAGA,uBAAW;AACT,iBAAKzK,cAAL,CAAoB2C,QAApB,CAA6B,aAA7B,EAA4C,CAAE,yBAAF,EAA6B,eAA7B,CAA5C;AACA,iBAAK5C,aAAL,CAAmBsB,WAAnB,CAA+BqJ,WAA/B;AACA,iBAAK3K,aAAL,CAAmBuH,UAAnB,GAAgC,KAAhC;AACD;;;;QAx0B0CqD;;;yBAAhC9K,0BAAuBF;AAAA;;;cAAvBE;AAAuBtD;AAAAqO;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ADrBpCjL;;AAoFAA;;;;AApFsCA;;AAoFpBA;;AAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AE9CNkL;;;;;;AAAkCA;;;;;;AAClCA;;;;;;AAAsEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAvClFA;;AACIA;;AACAA;;AAAqBA;;;;AAAgCA;;AACrDA;;AACIA;;AAAsDA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AACjGA;;AACAA;;AACIA;;AACIA;;AACIA;AAAAA;;AAAA;;AAAA;AAAA,aAAiC,eAAjC,EAAiC;AAAAA;;AAAA;;AAAA;AAAA,WAAjC;;AAC+DA;;AACnEA;;AACIA;AAAAA;;AAAA;;AAAA;AAAA,aAAiC,eAAjC,EAAiC;AAAAA;;AAAA;;AAAA;AAAA,WAAjC;;AACgEA;;AACpEA;;AACIA;AAAAA;;AAAA;;AAAA;AAAA,aAAiC,eAAjC,EAAiC;AAAAA;;AAAA;;AAAA;AAAA,WAAjC;;AAC+DA;;AACvEA;;AACAA;;AACIA;;AACIA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AAC3CA;;AACIA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AAC3CA;;AACIA;AAAAA;;AAAA;;AAAA;AAAA;;AAAuCA;;AAC/CA;;AACJA;;AACAA;;AACIA;;AACJA;;AAEAA;;AACIA;;AACIA;;AACIA;;AACJA;;AACJA;;AACAA;;AACIA;;AACAA;;AACJA;;AACFA;;AACNA;;;;;;AA1CmCA;;AACdA;;AAAAA;;AACIA;;AAAAA;;AACGA;;AAAAA;;AACKA;;AAAAA;;AAGcA;;AAAAA;;AACYA;;AAAAA,yGAA6B,SAA7B,EAA6BA,4FAA7B;;AAGEA;;AAAAA,0GAA8B,SAA9B,EAA8BA,6FAA9B;;AAGFA;;AAAAA,yGAA6B,SAA7B,EAA6BA,4FAA7B;;AAIZA;;AAAAA;;AACVA;;AAAAA;;AAEAA;;AAAAA;;AAEkBA;;AAAAA;;AAe9BA;;AAAAA;;AACAA;;AAAAA;;;;;;AAKzBA;;;;UCpBaC;AAuDX;;;;AAIA,yCAAoBhL,MAApB,EACSC,aADT,EAEUI,KAFV,EAGUF,WAHV,EAIU8K,cAJV,EAKUC,iBALV,EAMUhL,cANV,EAOUiL,aAPV,EAQUC,sBARV,EASSC,EATT,EAS8B;AAAA;;AAAA;;AATV;AACX;AACC;AACA;AACA;AACA;AACA;AACA;AACA;AACD;AAnEF,+BAAuCC,qFAAvC;AAEA,wBAAS,GAAT;AAEA,wBAAS,EAAT;AACA,0BAAW,CAAX;AAEA,iCAAmC;AACxCnC,eAAG,EAAE,EADmC;AAExCF,gBAAI,EAAE,EAFkC;AAGxCC,iBAAK,EAAE,EAHiC;AAIxCqC,gBAAI,EAAE,EAJkC;AAKxCC,qBAAS,EAAE,EAL6B;AAMxCC,wBAAY,EAAE,EAN0B;AAOxCC,4BAAgB,EAAE;AAPsB,WAAnC;AAUA,iCAA2B,KAA3B;AACA,6BAAsB,KAAtB;AAKA,+BAAyB,IAAzB;AAEA,8BAAwB,IAAxB;AACA,gCAA0B,KAA1B;AACA,6BAA6B,EAA7B;AACA,2BAAoB,CAApB;AAEA,6BAAmB,EAAnB;AACA,0BAAmB,CAAnB;AACA,+BAAwB,CAAxB;AAIA,4BAAkB,IAAlB;AACA,8BAAwB,KAAxB;AACA,gCAA0B,KAA1B;AACC,iCAA0B,EAA1B;AACA,qBAAc,EAAd;AACA,6BAAsB,EAAtB;AACD,+BAAyB,KAAzB;AACA,8BAAwB,KAAxB;AACC,sCAA+B,CAA/B;AACD,8BAAwB,KAAxB;AACA,8BAAuB,EAAvB;AACA,uBAAgB,EAAhB;AACA,sCAA4B,EAA5B;AAEC,gCAAsB,EAAtB;AAkBN,eAAKzL,aAAL,CAAmB0L,wBAAnB,CAA4ChK,SAA5C,CAAsD,UAACiK,KAAD,EAAmB;AACvE,gBAAIA,KAAJ,EAAW;AACT,oBAAI,CAAC1L,cAAL,CAAoB2C,QAApB,CAA6B,yBAA7B,EAAwD,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AACnGC,sBAAM,EAAE,MAAI,CAACA;AADsF,eAA7C,CAAxD;;AAGA,oBAAI,CAAC9C,MAAL,CAAYwE,QAAZ,CAAqB,uBAAiB,MAAI,CAAC1B,MAAtB,eAArB;AACD;AACF,WAPD;;AASA,cAAI,KAAK7C,aAAL,CAAmBsB,WAAnB,CAA+BC,MAAnC,EAA2C;AACzC,iBAAKvB,aAAL,CAAmBsB,WAAnB,GAAiC,IAAIsK,kDAAJ,CAA6B,IAA7B,CAAjC;AACD;;AAED,eAAK5L,aAAL,CAAmByB,eAAnB,CAAmCC,SAAnC,CAA6C,UAACC,GAAD,EAAQ;AACnD,gBAAIA,GAAG,IAAIA,GAAG,CAACC,IAAf,EAAqB;AACnB,8BAAkED,GAAG,CAACC,IAAtE;AAAA,kBAAQiK,cAAR,aAAQA,cAAR;AAAA,kBAAwBC,iBAAxB,aAAwBA,iBAAxB;AAAA,kBAA2CjK,kBAA3C,aAA2CA,kBAA3C;AACA,oBAAI,CAACgK,cAAL,GAAsBA,cAAc,IAAI,EAAxC;AACA,oBAAI,CAACE,UAAL,GAAkBD,iBAAlB;;AACA,kBAAIjK,kBAAJ,EAAwB;AACtB,sBAAI,CAACC,YAAL,GAAoBD,kBAAkB,CAACE,EAAvC;AACD;AACF;AACF,WATD;AAUD;AAED;;;;;;;iBAGA,qCAAyB;AACvB,wCAA6B,KAAK8J,cAAlC,CAAQG,WAAR;AAAA,gBAAQA,WAAR,sCAAsB,EAAtB;AACA,gBAAMC,qBAAqB,GAAGD,WAAW,CAACtG,MAAZ,CAAmB,UAACwG,UAAD,EAAoB;AACnE,qBAAOA,UAAU,CAACC,qBAAX,KAAqC,iBAA5C;AACD,aAF6B,CAA9B;;AAIA,gBAAIF,qBAAqB,IAAIA,qBAAqB,CAACzG,MAAtB,GAA+B,CAA5D,EAA+D;AAC7D,kBAAQ4G,WAAR,GAAwBH,qBAAqB,CAAC,CAAD,CAA7C,CAAQG,WAAR;AACA,kBAAMC,oBAAoB,GAAGD,WAAW,CAAC1G,MAAZ,CAAmB,UAAC4G,IAAD,EAAc;AAC5D,uBAAOA,IAAI,CAACC,cAAL,KAAwB,aAAxB,IAAyCD,IAAI,CAACC,cAAL,KAAwB,sBAAxE;AACD,eAF4B,CAA7B;;AAGA,kBAAIF,oBAAoB,IAAIA,oBAAoB,CAAC7G,MAArB,GAA8B,CAA1D,EAA6D;AAC3D,uBAAO,IAAP;AACD;AACF;;AACD,mBAAO,KAAP;AACD;AAED;;;;;;iBAGa,iBAAQ3C,MAAR,EAAsB;;;;;;;AACjC,yBAAKA,MAAL,GAAcA,MAAd;AACA,yBAAK7C,aAAL,CAAmB6D,WAAnB;;AACA,2BAAM,KAAK2I,sBAAL,CAA4B3J,MAA5B,EAAoC4J,IAApC,CAAyC,UAACnI,MAAD,EAAgB;;;AAC7D,0BAAIA,MAAM,CAAC1C,IAAP,IAAe,IAAnB,EAAyB;AACvB,+BAAI,CAAC5B,aAAL,CAAmBwE,WAAnB;;AACA;AACD;;AACD,6BAAI,CAACkI,SAAL,GAAiBpI,MAAM,CAAC1C,IAAP,CAAY8K,SAAZ,IAAyB,CAA1C;AACA,6BAAI,CAACC,aAAL,CAAmB5H,UAAnB,GAAgCT,MAAM,CAAC1C,IAAP,CAAYmD,UAA5C;AAEA,yCAC+ET,MAAM,CAAC1C,IADtF;AAAA,0BAAQgL,SAAR,gBAAQA,SAAR;AAAA,0BAAmBC,kBAAnB,gBAAmBA,kBAAnB;AAAA,0BAAuCC,cAAvC,gBAAuCA,cAAvC;AAAA,0BAAuDrB,gBAAvD,gBAAuDA,gBAAvD;AAAA,0BACEsB,WADF,gBACEA,WADF;AAAA,0BACeC,YADf,gBACeA,YADf;AAAA,0BAC6BC,SAD7B,gBAC6BA,SAD7B;AAAA,0BACwC/P,MADxC,gBACwCA,MADxC;AAAA,0BACgDgQ,OADhD,gBACgDA,OADhD;AAAA,0BACyDC,QADzD,gBACyDA,QADzD;AAAA,0BACmEC,GADnE,gBACmEA,GADnE;AAAA,0BACwErL,EADxE,gBACwEA,EADxE;AAEA,6BAAI,CAACA,EAAL,GAAUA,EAAV;;AACA,0BAAI,OAAI,CAAC2K,SAAL,IAAkB,CAAtB,EAAyB;AACvB,+BAAI,CAACW,YAAL,GAAoB,KAApB;AACA,+BAAI,CAACC,cAAL,GAAsB,KAAtB;AACA,+BAAI,CAACC,aAAL,GAAqB,KAArB;AACA,+BAAI,CAACC,cAAL,GAAsB,IAAtB;AACA,+BAAI,CAACC,WAAL,GAAmBb,SAAnB;AAEA,+BAAI,CAACc,UAAL,GAAmBR,OAAO,CAAC1H,MAAR,GAAiB,CAAlB,GAAuB0H,OAAO,CAAC,CAAD,CAA9B,GAAoC,EAAtD;AACD;;AAED,6BAAI,CAACS,YAAL,GAAoB,YAAM,CAAC/L,IAAP,CAAYgM,UAAZ,MAAsB,IAAtB,IAAsBzI,aAAtB,GAAsB,MAAtB,GAAsBA,GAAEtE,SAA5C;AACA,6BAAI,CAACQ,KAAL,GAAa,YAAM,CAACO,IAAP,CAAYgM,UAAZ,MAAsB,IAAtB,IAAsBxI,aAAtB,GAAsB,MAAtB,GAAsBA,GAAE/D,KAArC;AAEA,6BAAI,CAACsL,aAAL,CAAmB5H,UAAnB,GAAgCT,MAAM,CAAC1C,IAAP,CAAYmD,UAA5C;AACA,6BAAI,CAAC8I,eAAL,GAAuBvJ,MAAM,CAAC1C,IAAP,CAAYkM,WAAnC;AACA,6BAAI,CAAChL,SAAL,CAAeoG,GAAf,GAAkB1G,gCAAQ,OAAI,CAACM,SAAL,CAAeoG,GAAvB,GAA0B;AAAE7C,6BAAK,EAAEuG;AAAT,uBAA1B,CAAlB;AACA,6BAAI,CAAC1P,MAAL,GAAcA,MAAd;;AACA,6BAAI,CAAC8C,aAAL,CAAmB2H,UAAnB,CAA8BtD,IAA9B,CAAmCnH,MAAnC;;AACA,6BAAI,CAAC4F,SAAL,CAAe0I,YAAf,GAA2BhJ,gCAAQ,OAAI,CAACM,SAAL,CAAe0I,YAAvB,GAAmC;AAAEnF,6BAAK,EAAEwG;AAAT,uBAAnC,CAA3B;AACA,6BAAI,CAAC/J,SAAL,CAAeyI,SAAf,GAAwB/I,gCAAQ,OAAI,CAACM,SAAL,CAAeyI,SAAvB,GAAgC;AAAElF,6BAAK,EAAEyG;AAAT,uBAAhC,CAAxB;AACA,6BAAI,CAAChK,SAAL,CAAe2I,gBAAf,GAA+BjJ,gCAAQ,OAAI,CAACM,SAAL,CAAe2I,gBAAvB,GAAuC;AAAEpF,6BAAK,EAAEoF;AAAT,uBAAvC,CAA/B;AACA,6BAAI,CAAC3I,SAAL,CAAekG,IAAf,GAAmBxG,gCAAQ,OAAI,CAACM,SAAL,CAAekG,IAAvB,GAA2B;AAAEjG,sCAAc,EAAE;AAAE,kCAAQgK;AAAV;AAAlB,uBAA3B,CAAnB;AACA,6BAAI,CAACjK,SAAL,CAAewI,IAAf,GAAmB9I,gCAAQ,OAAI,CAACM,SAAL,CAAewI,IAAvB,GAA2B;AAAEvI,sCAAc,EAAE;AAAE,kCAAQkK,SAAS,IAAI3I,MAAM,CAAC1C,IAAP,CAAYmM;AAAnC;AAAlB,uBAA3B,CAAnB;AACA,6BAAI,CAACjL,SAAL,CAAemG,KAAf,GAAoBzG,gCAAQ,OAAI,CAACM,SAAL,CAAemG,KAAvB,GAA4B;AAAElG,sCAAc,EAAE;AAAE,8CAAoBiK;AAAtB;AAAlB,uBAA5B,CAApB;AAEA,6BAAI,CAACI,GAAL,GAAWA,GAAX;AAEA,6BAAI,CAAC1M,QAAL,GAAgB,aAAO,CAAC,CAAD,CAAP,MAAU,IAAV,IAAU2E,aAAV,GAAU,MAAV,GAAUA,GAAE3E,QAA5B;AACA,6BAAI,CAACC,gBAAL,GAAwB,aAAO,CAAC,CAAD,CAAP,MAAU,IAAV,IAAU2E,aAAV,GAAU,MAAV,GAAUA,GAAE0I,UAApC;AACA,6BAAI,CAAChN,aAAL,GAAqB,aAAO,CAAC,CAAD,CAAP,MAAU,IAAV,IAAUwG,aAAV,GAAU,MAAV,GAAUA,GAAExG,aAAjC;AACA,6BAAI,CAACmM,QAAL,GAAgBA,QAAhB;AACA,6BAAI,CAACvF,WAAL,GAAmBtD,MAAM,CAAC1C,IAAP,CAAYgG,WAAZ,CAAwB,CAAxB,CAAnB;;AAEA,0BAAI,OAAI,CAACA,WAAT,EAAsB;AACpB,+BAAI,CAAC5H,aAAL,CAAmB6H,YAAnB,CAAgCxD,IAAhC,CAAqC,OAAI,CAACuD,WAAL,CAAiBC,YAAtD;AACD;;AAED,6BAAI,CAACoG,oBAAL,GAA4B;AAC1B,gCAAQlB,WADkB;AAE1B,yCAAiB,OAAI,CAAC/L,aAFI;AAG1B,4CAAoBkN,kCAAK,CAACzC,gBAAD,CAAL,CAAwB0C,MAAxB,CAA+B,qBAA/B;AAHM,uBAA5B;AAMA,6BAAI,CAACC,eAAL,GAAoB5L,gCACf,OAAI,CAAC4L,eADU,GACK;AAAElF,2BAAG,EAAE0D,SAAP;AAAkB5D,4BAAI,EAAE+D,WAAxB;AAAqC9D,6BAAK,EAAE+D,YAA5C;AACvB1B,4BAAI,EAAE2B,SAAS,IAAI3I,MAAM,CAAC1C,IAAP,CAAYmM,cADR;AACwBxC,iCAAS,EAAEuB,cADnC;AAEvBtB,oCAAY,EAAEqB,kBAFS;AAEWpB,wCAAgB,EAAEA;AAF7B,uBADL,CAApB;;AAMA,0BAAI,OAAI,CAAC3J,YAAL,KAAqB,YAAM,CAACF,IAAP,CAAYC,kBAAZ,MAA8B,IAA9B,IAA8BgH,aAA9B,GAA8B,MAA9B,GAA8BA,GAAEvB,cAArD,CAAJ,EAAyE;AACvE,+BAAI,CAACtH,aAAL,CAAmBuH,UAAnB,GAAgC,IAAhC;AACD,uBAFD,MAEO;AACL,+BAAI,CAACvH,aAAL,CAAmBuH,UAAnB,GAAgC,KAAhC;AACD;;AAED,6BAAI,CAAC8G,QAAL;;AACA,6BAAI,CAACrO,aAAL,CAAmBwE,WAAnB;AACD,qBApEK,WAoEG,YAAK;AACZ,6BAAI,CAACxE,aAAL,CAAmBwE,WAAnB;AACD,qBAtEK,CAAN;;;AAwEA,yBAAK8J,kBAAL;AAEA;;;;;;0BAKI,KAAK5B,SAAL,IAAkB,CAAlB,IAAuB,KAAK1M,aAAL,CAAmBuH;;;;;AAC5C,yBAAKO,WAAL;AACA,yBAAK9F,eAAL,GAAuB,IAAvB;;;;;AAIF,2BAAM,KAAKuM,iBAAL,EAAN;;;;;;;;AACD;AAGD;;;;;;iBAGA,8BAAkB;AAChB,gBAAMlG,WAAW,GAAG,KAAKrI,aAAL,CAAmBsI,iBAAnB,CAAqC,oBAArC,CAApB;;AACA,gBAAID,WAAJ,EAAiB;AACf,kBAAME,UAAU,GAAGP,IAAI,CAACC,KAAL,CAAWI,WAAX,CAAnB;;AACA,kBAAIE,UAAU,CAACW,GAAX,IAAkB,CAAC,KAAKkF,eAAL,CAAqBlF,GAA5C,EAAiD;AAC/C,qBAAKsE,cAAL,GAAsB,IAAtB;AACA,qBAAKY,eAAL,CAAqBlF,GAArB,GAA2BX,UAAU,CAACW,GAAtC;AACA,qBAAKpG,SAAL,CAAeoG,GAAf,GAAkB1G,gCAAQ,KAAKM,SAAL,CAAeoG,GAAvB,GAA0B;AAAE7C,uBAAK,EAAEkC,UAAU,CAACW;AAApB,iBAA1B,CAAlB;AACD;;AACD,kBAAIX,UAAU,CAACS,IAAX,IAAmB,CAAC,KAAKoF,eAAL,CAAqBpF,IAA7C,EAAmD;AACjD,qBAAKoF,eAAL,CAAqBpF,IAArB,GAA4BT,UAAU,CAACS,IAAvC;AACA,qBAAKlG,SAAL,CAAekG,IAAf,GAAmBxG,gCAAQ,KAAKM,SAAL,CAAekG,IAAvB,GAA2B;AAAEjG,gCAAc,EAAE;AAAE,4BAAQwF,UAAU,CAACS;AAArB;AAAlB,iBAA3B,CAAnB;AACD;;AACD,kBAAIT,UAAU,CAACU,KAAX,IAAoB,CAAC,KAAKmF,eAAL,CAAqBnF,KAA9C,EAAqD;AACnD,qBAAKmF,eAAL,CAAqBnF,KAArB,GAA6BV,UAAU,CAACU,KAAxC;AACA,qBAAKnG,SAAL,CAAemG,KAAf,GAAoBzG,gCAAQ,KAAKM,SAAL,CAAemG,KAAvB,GAA4B;AAAElG,gCAAc,EAAE;AAAE,wCAAoBwF,UAAU,CAACU;AAAjC;AAAlB,iBAA5B,CAApB;AACD;;AACD,kBAAIV,UAAU,CAACiG,cAAX,IAA6B,CAAC,KAAKJ,eAAL,CAAqB9C,IAAvD,EAA6D;AAC3D,qBAAK8C,eAAL,CAAqB9C,IAArB,GAA4B/C,UAAU,CAACiG,cAAvC;AACA,qBAAK1L,SAAL,CAAewI,IAAf,GAAmB9I,gCACd,KAAKM,SAAL,CAAewI,IADD,GACK;AAAEjF,uBAAK,EAAEkC,UAAU,CAACiG,cAApB;AACtBzL,gCAAc,EAAE;AAAE,4BAAQwF,UAAU,CAACiG;AAArB;AADM,iBADL,CAAnB;AAID;;AACD,kBAAIjG,UAAU,CAACY,KAAX,IAAoB,CAAC,KAAKiF,eAAL,CAAqB5C,YAA9C,EAA4D;AAC1D,qBAAK4C,eAAL,CAAqB5C,YAArB,GAAoCjD,UAAU,CAACY,KAA/C;AACA,qBAAKrG,SAAL,CAAe0I,YAAf,GAA2BhJ,gCAAQ,KAAKM,SAAL,CAAe0I,YAAvB,GAAmC;AAAEnF,uBAAK,EAAEkC,UAAU,CAACY;AAApB,iBAAnC,CAA3B;AACD;;AACD,kBAAIZ,UAAU,CAACS,IAAX,IAAmBT,UAAU,CAACU,KAA9B,IAAuCV,UAAU,CAACW,GAAlD,IAAyDX,UAAU,CAACY,KAAxE,EAA+E;AAC7E,qBAAKnJ,aAAL,CAAmBoJ,iBAAnB,CAAqC,oBAArC,EAA2D,EAA3D;AACA,qBAAKmE,aAAL,GAAqB,KAArB;AACA,qBAAKF,YAAL,GAAoB,KAApB;AACA,qBAAKoB,YAAL,GAAoB,IAApB;AACA,qBAAKC,eAAL;AACD;AACF;AACF;AAED;;;;;;iBAGa,6BAAiB;;;;;;;;;AAIf,2BAAM,uDAAe,KAAK1D,cAAL,CAAoB2D,cAApB,EAAf,CAAN;;;AAAP/M;AACN,yBAAKkB,SAAL,CAAekG,IAAf,GAAmBxG,gCAAQ,KAAKM,SAAL,CAAekG,IAAvB,GAA2B;AAAE4F,6BAAO,EAAEhN,IAAI,CAACiN,IAAL,CAAU,UAACC,CAAD,EAAIC,CAAJ;AAAA,+BAAUD,CAAC,CAACvL,IAAF,CAAOyL,aAAP,CAAqBD,CAAC,CAACxL,IAAvB,CAAV;AAAA,uBAAV;AAAX,qBAA3B,CAAnB;AAEM0L,+BAAW,KAAKnM,SAAL,CAAekG,IAAf,CAAoB4F;AAC/BM,mCAAeD,QAAQ,CAACvJ,MAAT,CAAgB,WAAC;AAAA,6BAAIyJ,CAAC,CAAC5L,IAAF,KAAW,OAAI,CAAC6K,eAAL,CAAqBpF,IAApC;AAAA,qBAAjB;;AACrB,wBAAIkG,YAAY,CAAC1J,MAAb,GAAsB,CAA1B,EAA6B;AAC3B,2BAAKwF,cAAL,CAAoBoE,eAApB,CAAoCF,YAAY,CAAC,CAAD,CAAZ,CAAgBnN,EAApD,EAAwD,KAAKgK,UAA7D,EAAyErK,SAAzE,CAAmF,UAACE,IAAD,EAAS;;;AAC1F,+BAAI,CAACkB,SAAL,CAAemG,KAAf,GAAoBzG,gCAAQ,OAAI,CAACM,SAAL,CAAemG,KAAvB,GAA4B;AAAE2F,iCAAO,EAAEhN;AAAX,yBAA5B,CAApB;AACA,4BAAMqH,KAAK,GAAG,aAAI,CAACnG,SAAL,CAAemG,KAAf,CAAqB2F,OAArB,MAA4B,IAA5B,IAA4BzJ,aAA5B,GAA4B,MAA5B,GAA4BA,GAAEO,MAAF,CAAS,WAAC;AAAA,iCAAIyJ,CAAC,CAAC/B,GAAF,IAAS,OAAI,CAACA,GAAlB;AAAA,yBAAV,CAA1C;;AACA,4BAAInE,KAAK,CAACzD,MAAN,GAAe,CAAnB,EAAsB;AACpB,uCAAI,CAACwF,cAAL,CAAoBqE,qBAApB,CAA0CpG,KAAK,CAAC,CAAD,CAAL,CAASlH,EAAnD,EAAuD,OAAI,CAACgK,UAA5D,OAAuE,IAAvE,IAAuE3G,aAAvE,GAAuE,MAAvE,GAAuEA,GAAE1D,SAAF,CAAY,UAACE,IAAD,EAAS;AAC1F,mCAAI,CAACkB,SAAL,CAAewI,IAAf,GAAmB9I,gCAAQ,OAAI,CAACM,SAAL,CAAewI,IAAvB,GAA2B;AAAEsD,qCAAO,EAAEhN;AAAX,6BAA3B,CAAnB;AACD,2BAFsE,CAAvE;AAGD;AACF,uBARD;AASD;;;;;;;;AACF;AAED;;;;;;iBAGa,gCAAuBiB,MAAvB,EAAqC;;;;;0BAC5CA,MAAM,IAAIA,MAAM,IAAI;;;;;AACtB,yBAAKA,MAAL,GAAcA,MAAd;AACA,yBAAK7C,aAAL,CAAmB6D,WAAnB;sDACO,uDAAe,KAAK3D,WAAL,CAAiBwH,aAAjB,CAA+B7E,MAA/B,CAAf;;;;;;;;AAEV;AACD;;;;;;iBAGA,8BAAkB;AAChB,iBAAK5C,cAAL,CAAoB2C,QAApB,CAA6B,oBAA7B,EAAmD,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AAC9FC,oBAAM,EAAE,KAAKA;AADiF,aAA7C,CAAnD;AAGA,iBAAK9C,MAAL,CAAYwE,QAAZ,CAAqB,uBAAiB,KAAK1B,MAAtB,eAArB;AACD;AAED;;;;;;iBAGM,oBAAQ;;;;;;;;;;AACZ,yBAAKC,SAAL,GAAiB,0FAAjB;AACA,yBAAKK,kBAAL,GAA0B;AACxB9F,2BAAK,EAAE,SADiB;AAExBC,0BAAI,EAAE,SAFkB;AAGxBC,0BAAI,EAAE,OAHkB;AAIxByM,6BAAO,EAAE,KAAKC,WAAL,CAAiBtD,IAAjB,CAAsB,IAAtB;AAJe,qBAA1B;AAOA,yBAAKuD,eAAL,GAAuB;AACrB7M,2BAAK,EAAE,oBADc;AAErBC,0BAAI,EAAE,SAFe;AAGrBC,0BAAI,EAAE,aAHe;AAIrByM,6BAAO,EAAE,KAAKsF,kBAAL,CAAwB3I,IAAxB,CAA6B,IAA7B;AAJY,qBAAvB;AAOM9D,6BAAS,6BAAKzC,KAAL,MAAU,IAAV,IAAU+E,aAAV,GAAU,MAAV,GAAUA,GAAEa,MAAZ,MAAkB,IAAlB,IAAkBZ,aAAlB,GAAkB,MAAlB,GAAkBA,GAAEa,QAApB,MAA4B,IAA5B,IAA4BZ,aAA5B,GAA4B,MAA5B,GAA4BA,GAAEa,QAA9B,MAAsC,IAAtC,IAAsCZ,aAAtC,GAAsC,MAAtC,GAAsCA,GAAEa,GAAF,CAAM,IAAN;AAErD,yBAAKlG,cAAL,CAAoB2C,QAApB,CAA6B,UAA7B,EAAyC,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AACpFC,4BAAM,EAANA;AADoF,qBAA7C,CAAzC;AAIA,yBAAK7C,aAAL,CAAmBsB,WAAnB,CAA+BI,SAA/B,CAAyC;AACvC2C,0BAAI,EAAE,cAAC1C,GAAD,EAAiB;AACrB,4BAAI,CAACA,GAAL,EAAU;AACR,iCAAI,CAAC2I,YAAL,GAAoB,IAApB;AACD;AACF;AALsC,qBAAzC;AAQA,yBAAKW,iBAAL,CAAuBsE,yBAAvB,GAAmD7N,SAAnD,CAA6D;AAC3D2C,0BAAI,EAAE,cAACmL,cAAD,EAAwB;AAC5B,4BAAMC,wBAAwB,GAAGD,cAAc,SAAd,kBAAc,WAAd,GAAc,MAAd,iBAAc,CAAE5N,IAAjD;;AACA,4BAAI6N,wBAAwB,CAACjK,MAAzB,GAAkC,CAAtC,EAAyC;AACvC,iCAAI,CAACkK,oBAAL,GAA4BD,wBAAwB,CAAC,CAAD,CAAxB,CAA4B1N,EAAxD;AACD;AACF;AAN0D,qBAA7D;;AASA,2BAAM,KAAK4N,OAAL,CAAa9M,MAAb,CAAN;;;AAEM0H,gCAAiBC,QAAQ,CAACC,aAAT,CAAuB,oBAAvB;;AACvB,wBAAIF,SAAJ,EAAe;AACbA,+BAAS,CAACG,SAAV,GAAsB,CAAtB;AACD;;;;;;;;AACF;AAGD;;;;;;;iBAIA,2BAAe;AACb,iBAAK1K,aAAL,CAAmB2C,UAAnB,CAA8B,eAA9B,EAA+C,SAA/C;AACA,iBAAK1C,cAAL,CAAoB2C,QAApB,CAA6B,iBAA7B,EAAgD,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AAC3FC,oBAAM,EAAE,KAAKA;AAD8E,aAA7C,CAAhD;AAGD;AAGD;;;;;;iBAGO,uBAAW;AAChB,iBAAK0K,aAAL,GAAqB,KAArB;AACA,iBAAKkB,YAAL,GAAoB,KAApB;AACA,gBAAMlM,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAY,KAAKO,SAAjB,CAAb;;AACA,iBAAK,IAAMG,CAAX,IAAgBV,IAAhB,EAAsB;AACpB,kBAAMG,GAAG,GAAGH,IAAI,CAACU,CAAD,CAAhB;AACA,mBAAKH,SAAL,CAAeJ,GAAf,IAAmBF,gCACd,KAAKM,SAAL,CAAeJ,GAAf,CADc,GACK;AACtBQ,oBAAI,EAAE;AADgB,eADL,CAAnB;AAID;;AACD,iBAAKC,kBAAL,GAAuBX,gCAClB,KAAKW,kBADa,GACK;AAAE9F,mBAAK,EAAE,YAAT;AAC1BC,kBAAI,EAAE,SADoB;AACTC,kBAAI,EAAE;AADG,aADL,CAAvB;AAID;AAED;;;;AAGA;;;;;;;;;;AAWA;;;;;;iBAGa,wBAAY;;;;;;;;AACjBgF,2BAAOC,MAAM,CAACD,IAAP,CAAY,KAAKO,SAAjB;;AACb,yBAAWG,CAAX,IAAgBV,IAAhB,EAAsB;AACdG,yBADc,GACRH,IAAI,CAACU,CAAD,CADI;AAEpB,2BAAKH,SAAL,CAAeJ,GAAf,IAAmBF,gCACd,KAAKM,SAAL,CAAeJ,GAAf,CADc,GACK;AACtBQ,4BAAI,EAAE,KAAKlB,eAAL,GAAuB,OAAvB,GAAiC;AADjB,uBADL,CAAnB;AAID;;0BAEG,KAAKmB,kBAAL,CAAwB9F,KAAxB,IAAiC;;;;;AACnC,yBAAKmQ,cAAL,GAAsB,IAAtB;AACA,yBAAKxC,cAAL,CAAoB4E,aAApB,CAAkC,KAAKxB,eAAL,CAAqBlF,GAAvD,EAA4DxH,SAA5D,CAAsE;AACpE2C,0BAAI,EAAE,cAACC,MAAD,EAAgB;AACpB,4BAAIA,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEuL,OAAZ,EAAqB;AACnB,iCAAI,CAACpB,YAAL,GAAoB,IAApB;AACD,yBAFD,MAEO;AACL,iCAAI,CAACA,YAAL,GAAoB,KAApB;AACD;AACF;AAPmE,qBAAtE;AASA,yBAAKzO,aAAL,CAAmB6D,WAAnB;;AACA,2BAAM,KAAK0K,iBAAL,EAAN;;;AACA,yBAAKvO,aAAL,CAAmBwE,WAAnB;;;AAGF,yBAAKxC,eAAL,GAAuB,CAAC,KAAKA,eAA7B;AACA,yBAAKmB,kBAAL,GAAuBX,gCAClB,KAAKW,kBADa,GACK;AAAE9F,2BAAK,EAAE,KAAK2E,eAAL,GAAuB,YAAvB,GAAsC,SAA/C;AAC1B1E,0BAAI,EAAE,KAAK0E,eAAL,GAAuB,SAAvB,GAAmC,SADf;AAC0BzE,0BAAI,EAAE,KAAKyE,eAAL,GAAuB,SAAvB,GAAmC;AADnE,qBADL,CAAvB;;;;;;;;AAID;AAED;;;;;;;iBAIO,uBAAW;AAAA;;AAChB,gBAAI,KAAKA,eAAT,EAA0B;AACxB,mBAAK4B,YAAL;AACA;AACD;;AAED,iBAAK5D,aAAL,CAAmB6D,WAAnB,GANgB,CAOhB;;AACA,gBAAI,KAAK6I,SAAL,IAAkB,KAAK0B,eAAL,CAAqBlF,GAArB,KAA6B,KAAKuE,WAAxD,EAAqE;AACnE,mBAAKqC,aAAL;AACD,aAFD,MAEO;AACL,kBAAMhM,QAAQ,GAAmB;AAC/B,uBAAO,KAAKsK,eAAL,CAAqBlF,GADG;AAE/B,oCAAoB,CAFW;AAG/B,uBAAO,KAAKkE,GAHmB;AAI/B,wBAAQ,KAAKgB,eAAL,CAAqBpF,IAJE;AAK/B,yBAAS,KAAKoF,eAAL,CAAqBnF,KALC;AAM/B,2BAAW8G,MAAM,CAAC,KAAK3B,eAAL,CAAqB7C,SAAtB,CANc;AAO/B,yCAAyB2C,kCAAK,CAAC,KAAKE,eAAL,CAAqB3C,gBAAtB,CAAL,CAA6C0C,MAA7C,CAAoD,qBAApD,CAPM;AAQ/B,sCAAsB,KAAKC,eAAL,CAAqB5C,YARZ;AAS/B,6BAAa,CATkB;AAU/B,kCAAkB,KAAK4C,eAAL,CAAqB9C,IAVR;AAW/B,wCAAwB,KAAKoE,oBAXE;AAY/B,gCAAgB,KAAK/B,YAZU;AAa/B,iCAAiB,KAAKtM;AAbS,eAAjC;AAgBA,mBAAK2J,cAAL,CAAoBgF,UAApB,CAA+BlM,QAA/B,EAAyC,KAAKqJ,QAA9C,EAAwD,KAAKpL,EAA7D,EAAiEL,SAAjE,CAA2E;AACzE2C,oBAAI,EAAE,cAACC,MAAD,EAAgB;AACpB,sBAAIA,MAAJ,EAAY;AACV,2BAAI,CAACoI,SAAL,GAAiBpI,MAAM,CAACvC,EAAxB;AAEA,2BAAI,CAAC6F,WAAL,GAAmB,EAAnB;AACA,2BAAI,CAACA,WAAL,CAAiBC,YAAjB,GAAgCvD,MAAM,CAACuD,YAAvC;AACA,2BAAI,CAACD,WAAL,CAAiBqI,cAAjB,GAAkC3L,MAAM,CAAC2L,cAAzC;;AAEA,2BAAI,CAACH,aAAL;AACD;AACF,iBAXwE;AAYzErL,qBAAK,EAAE,eAACC,GAAD,EAAQ;AACb,yBAAI,CAAC1E,aAAL,CAAmBwE,WAAnB;AACD;AAdwE,eAA3E,EAjBK,CAiCL;AACD,aA5Ce,CA6ChB;;AACD;AAED;;;;;;;iBAIa,yBAAa;;;;;;;;;;AACxB,yBAAKvE,cAAL,CAAoB2C,QAApB,CAA6B,eAA7B,EAA8C,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AACzFC,4BAAM,EAAE,KAAKA;AAD4E,qBAA7C,CAA9C;AAGA,yBAAK7C,aAAL,CAAmB6D,WAAnB;AACMC,+BAAkC;AACtC,6BAAO,KAAKsK,eAAL,CAAqBlF,GADU;AAEtC,6BAAO,KAAKkE,GAF0B;AAGtC,qCAAe,KAAKgB,eAAL,CAAqBpF,IAHE;AAItC,sCAAgB,KAAKoF,eAAL,CAAqBnF,KAJC;AAKtC,wCAAkB,YAAKiH,WAAL,MAAgB,IAAhB,IAAgB/K,aAAhB,GAAgB,MAAhB,GAAgBA,GAAE4I,cAAlB,KAAoC,KAAKK,eAAL,CAAqB9C,IALrC;AAMtC,mCAAa,KAAKoB,SANoB;AAOtC,4CAAsB,KAAK0B,eAAL,CAAqB5C,YAPL;AAQtC,wCAAkBuE,MAAM,CAAC,KAAK3B,eAAL,CAAqB7C,SAAtB,CARc;AAStC,0CAAoB2C,kCAAK,CAAC,KAAKE,eAAL,CAAqB3C,gBAAtB,CAAL,CAA6C0C,MAA7C,CAAoD,qBAApD;AATkB;AAYlCgC,iCAAa;AACjB,sCAAgB,KAAKvI,WAAL,CAAiBC,YADhB;AAEjB,wCAAkB,KAAKD,WAAL,CAAiBqI;AAFlB;AAKb3E,2BAAO4C,kCAAK,CAAC,KAAKE,eAAL,CAAqB3C,gBAAtB,CAAL,CAA6CH,IAA7C,GAAoDvH,QAApD,IACb;AAEA;;0BACK,KAAKkK,oBAAL,CAA0BjF,IAA1B,IAAkC,KAAKoF,eAAL,CAAqBpF,IAAvD,IACA,KAAKhI,aAAL,IAAsB,KAAKiN,oBAAL,CAA0BjN,aADhD,IAEAkN,kCAAK,CAAC,KAAKE,eAAL,CAAqB3C,gBAAtB,CAAL,CAA6C0C,MAA7C,CAAoD,qBAApD,KAA8E,KAAKF,oBAAL,CAA0BxC,gBAFzG,IAGD,EAAC,iBAAKiC,UAAL,MAAe,IAAf,IAAetI,aAAf,GAAe,MAAf,GAAeA,GAAEgL,iBAAjB,MAAkC,IAAlC,IAAkC/K,aAAlC,GAAkC,MAAlC,GAAkCA,GAAEG,MAArC;;;;;;AAED,2BAAM,KAAK6K,aAAL,CAAmB,KAAK3P,QAAxB,EAAkC,KAAKC,gBAAvC,EAAyD,KAAKK,aAA9D,EAA6E,KAAKoN,eAAL,CAAqBpF,IAAlG,EAAwGsC,IAAxG,CAAN;;;AAEF;AAEMgF,mCAAe;AACnB,iCAAWxM,QADQ;AAEnB,oCAAcqM,UAFK;AAGnB,gCAAU,KAAKzC;AAHI;AAMrB,yBAAK1C,cAAL,CAAoBuF,iBAApB,CAAsCD,YAAtC,EAAoD,KAAKzN,MAAzD,EAAiEnB,SAAjE,CAA2E;AACzE2C,0BAAI,EAAE,cAACC,MAAD,EAAgB;AACpB,4BAAIA,MAAJ,EAAY;AAEV,8BAAI,OAAI,CAACoJ,UAAL,CAAgBM,UAApB,EAAgC;AAC9B,gCAAIwC,WAAW,GAAY,IAA3B;;AACA,mCAAI,CAAC9C,UAAL,CAAgB0C,iBAAhB,CAAkCK,OAAlC,CAA0C,UAACC,OAAD,EAAiB;AACzD,kCAAIA,OAAO,CAACC,MAAR,GAAiB,CAArB,EAAwB;AACtBH,2CAAW,GAAG,KAAd;AACA;AACD;AACF,6BALD;;AAOA,gCAAIA,WAAJ,EAAiB;AACf,kCAAMI,MAAM,GAAG;AACb,4CAAY,OAAI,CAAC/N,MADJ;AAEb,wCAAQ,MAFK;AAGb,8CAAc,OAAI,CAAC6K;AAHN,+BAAf;;AAKA,qCAAI,CAAC1N,aAAL,CAAmBwE,WAAnB;;AACA,qCAAI,CAACxE,aAAL,CAAmB6Q,aAAnB,CAAiC,MAAjC,EAAyC,qBAAzC,EAAgED,MAAhE;;AACA;AACD;AACF;;AACD,iCAAI,CAAC7Q,MAAL,CAAYwE,QAAZ,CAAqB,uBAAiB,OAAI,CAAC1B,MAAtB,eAArB;AACD;;AAED,+BAAI,CAAC7C,aAAL,CAAmBwE,WAAnB;AACD,uBA5BwE;AA6BzEC,2BAAK,EAAE,eAACC,GAAD,EAAQ;AACb,+BAAI,CAAC1E,aAAL,CAAmBwE,WAAnB;AACD;AA/BwE,qBAA3E;;;;;;;;AAiCD;AAED;;;;;;;iBAIO,sBAAaqB,MAAb,EAAkC;AAAA;;AACvC,iBAAK5F,cAAL,CAAoB2C,QAApB,CAA6B,cAA7B,EAA6C,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AACxFC,oBAAM,EAAE,KAAKA,MAD2E;AAExFgD,oBAAM,EAANA;AAFwF,aAA7C,CAA7C;;AAIA,gBAAIA,MAAM,CAACvI,IAAP,KAAgB,QAApB,EAA8B;AAC5B,mBAAKwF,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,IAA2Bf,gCACtB,KAAKM,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,CADsB,GACK;AAAER,8BAAc,EAAE8C,MAAM,CAACQ;AAAzB,eADL,CAA3B;AAGA,mBAAK+H,eAAL,CAAqBvI,MAAM,CAACtC,IAA5B,IAAoCsC,MAAM,CAACQ,KAAP,CAAa,KAAKvD,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4BF,UAAzC,CAApC;;AAEA,kBAAIwC,MAAM,CAACtC,IAAP,IAAe,MAAnB,EAA2B;AACzB,qBAAK6K,eAAL,CAAqB,OAArB,IAAgC,EAAhC;AACA,qBAAKA,eAAL,CAAqB,MAArB,IAA+B,IAA/B;AACA,qBAAK0C,aAAL,GAAqB,IAArB;AACA,qBAAKC,YAAL,GAAoB,IAApB;AACA,qBAAKjO,SAAL,CAAewI,IAAf,GAAmB9I,gCACd,KAAKM,SAAL,CAAewI,IADD,GACK;AAAEvI,gCAAc,EAAE,EAAlB;AAAsB6L,yBAAO,EAAE,EAA/B;AAAmCtL,4BAAU,EAAE;AAA/C,iBADL,CAAnB,CALyB,CAQzB;;AACA,qBAAKR,SAAL,CAAemG,KAAf,GAAoBzG,gCACf,KAAKM,SAAL,CAAemG,KADA,GACK;AAAElG,gCAAc,EAAE;AAAlB,iBADL,CAApB;;AAIA,oBAAI8C,MAAM,CAACQ,KAAX,EAAkB;AAChB,uBAAKvD,SAAL,CAAemG,KAAf,GAAoBzG,gCACf,KAAKM,SAAL,CAAemG,KADA,GACK;AACvB3F,8BAAU,EAAE,KAAK0H,cAAL,CAAoBoE,eAApB,CAAoCvJ,MAAM,CAACQ,KAAP,CAAatE,EAAjD,EAAqD,KAAKgK,UAA1D,CADW;AAEvBtF,oCAAgB,EAAE,KAAKiI,eAAL,CAAqB/H,IAArB,CAA0B,IAA1B;AAFK,mBADL,CAApB;AAKAlD,4BAAU,CAAC,YAAK;AACd,2BAAI,CAACwF,KAAL,CAAWtF,iBAAX;AAED,mBAHS,CAAV;AAID;AACF,eAxBD,MAwBO,IAAIkC,MAAM,CAACtC,IAAP,IAAe,OAAnB,EAA4B;AACjC,qBAAKwN,YAAL,GAAoB,IAApB;AACA,qBAAKjO,SAAL,CAAewI,IAAf,GAAmB9I,gCACd,KAAKM,SAAL,CAAewI,IADD,GACK;AAAEvI,gCAAc,EAAE,EAAlB;AAAsBO,4BAAU,EAAE,IAAlC;AAAwCsL,yBAAO,EAAE;AAAjD,iBADL,CAAnB;AAIA,qBAAKR,eAAL,CAAqB,MAArB,IAA+B,IAA/B;;AACA,oBAAIvI,MAAM,CAACQ,KAAX,EAAkB;AAChB,uBAAK+G,GAAL,GAAWvH,MAAM,CAACQ,KAAP,CAAa+G,GAAxB;AACA,uBAAKtK,SAAL,CAAewI,IAAf,GAAmB9I,gCACd,KAAKM,SAAL,CAAewI,IADD,GACK;AACtBhI,8BAAU,EAAE,KAAK0H,cAAL,CAAoBqE,qBAApB,CAA0CxJ,MAAM,CAACQ,KAAP,CAAatE,EAAvD,EAA2D,KAAKgK,UAAhE,CADU;AAEtBtF,oCAAgB,EAAE,KAAKiI,eAAL,CAAqB/H,IAArB,CAA0B,IAA1B;AAFI,mBADL,CAAnB;AAKAlD,4BAAU,CAAC,YAAK;AACd,2BAAI,CAAC6H,IAAL,CAAU3H,iBAAV;AACD,mBAFS,CAAV;AAGD;AACF;AACF,aAjDD,MAiDO;AAEL,kBAAI,CAACkC,MAAM,CAACqB,OAAZ,EAAqB;AACnB,qBAAKpE,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4B8C,KAA5B,GAAoC,EAApC;AACA,qBAAK+H,eAAL,CAAqBvI,MAAM,CAACtC,IAA5B,IAAoC,EAApC;AACD,eAHD,MAGO;AACL,qBAAKT,SAAL,CAAe+C,MAAM,CAACtC,IAAtB,EAA4B8C,KAA5B,GAAoCR,MAAM,CAACQ,KAA3C;AACA,qBAAK+H,eAAL,CAAqBvI,MAAM,CAACtC,IAA5B,IAAoCsC,MAAM,CAACQ,KAA3C;AACD;AACF;;AAED,iBAAK+H,eAAL,GAAoB5L,kBAAQ,KAAK4L,eAAb,CAApB;;AAEA,gBAAIvI,MAAM,CAACtC,IAAP,IAAe,KAAnB,EAA0B;AACxB,kBAAIsC,MAAM,CAACqB,OAAX,EAAoB;AAClB,qBAAK8J,YAAL;AACD;AACF;;AAED,iBAAK3C,QAAL;AACD;AAED;;;;;;iBAGA,2BAAe;AACb,iBAAKyC,aAAL,GAAqB,KAArB;AACA,iBAAKC,YAAL,GAAoB,KAApB;AACD;AACD;;;;;;iBAGA,sBAAaxN,IAAb,EAAsB;AACpB,gBAAIA,IAAI,KAAK,KAAKT,SAAL,CAAekG,IAAf,CAAoBzF,IAAjC,EAAuC;AACrC,mBAAK0F,KAAL,CAAWhE,aAAX;AACA,mBAAKqG,IAAL,CAAUrG,aAAV;AACD,aAHD,MAGO,IAAI1B,IAAI,KAAK,KAAKT,SAAL,CAAemG,KAAf,CAAqB1F,IAAlC,EAAwC;AAC7C,mBAAKyF,IAAL,CAAU/D,aAAV;AACA,mBAAKqG,IAAL,CAAUrG,aAAV;AACD,aAHM,MAGA;AACL,mBAAKgE,KAAL,CAAWhE,aAAX;AACA,mBAAK+D,IAAL,CAAU/D,aAAV;AACD;AACF;AAED;;;;;;iBAGO,oBAAQ;AACb,gBAAM1C,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAY,KAAK6L,eAAjB,CAAb;AACA,iBAAKnO,cAAL,CAAoB2C,QAApB,CAA6B,UAA7B,EAAyC,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AACpFC,oBAAM,EAAE,KAAKA;AADuE,aAA7C,CAAzC;AAGA,gBAAIqE,OAAO,GAAG,IAAd;;AACA,iBAAK,IAAMjE,CAAX,IAAgBV,IAAhB,EAAsB;AACpB,kBAAMkH,IAAI,GAAGlH,IAAI,CAACU,CAAD,CAAjB;;AACA,kBAAI,CAAC,KAAKmL,eAAL,CAAqB3E,IAArB,CAAL,EAAiC;AAC/BvC,uBAAO,GAAG,KAAV;AACA;AACD;AACF;;AAED,gBAAI,KAAKlF,eAAT,EAA0B;AACxB,mBAAKmB,kBAAL,CAAwB7F,IAAxB,GAA+B,SAA/B;AACD,aAFD,MAEO,IAAI,CAAC4J,OAAL,EAAc;AACnB,mBAAK/D,kBAAL,CAAwB7F,IAAxB,GAA+B,UAA/B;AACD,aAFM,MAEA;AACL,mBAAK6F,kBAAL,CAAwB7F,IAAxB,GAA+B,SAA/B;AACD;AACF;AAED;;;;;;iBAGO,wBAAY;AAAA;;;;AACjB,gBAAMsP,SAAS,GAAG,WAAK9J,SAAL,CAAeoG,GAAf,CAAmB7C,KAAnB,MAAwB,IAAxB,IAAwBlB,aAAxB,GAAwB,MAAxB,GAAwBA,GAAE8L,cAAF,EAA1C;AACA,iBAAKhR,cAAL,CAAoB2C,QAApB,CAA6B,cAA7B,EAA6C,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AACxFC,oBAAM,EAAE,KAAKA;AAD2E,aAA7C,CAA7C;AAGA,yDAAK+J,SAAL,EACGsE,IADH,GAEGxP,SAFH,CAEa;AACT9D,sBAAQ,EAAE,oBAAK;AACb,oBAAIgP,SAAS,CAACpH,MAAV,IAAoB,EAApB,IAA0B,CAAC,OAAI,CAACxD,eAAhC,IAAmD,CAAC,OAAI,CAACwL,cAA7D,EAA6E;AAC3E,yBAAI,CAACxN,aAAL,CAAmB6D,WAAnB;;AACA,yBAAI,CAACmH,cAAL,CAAoB4E,aAApB,CAAkChD,SAAlC,EAA6ClL,SAA7C,CAAuD;AACrD+C,yBAAK,EAAE,iBAAK;AACV,6BAAI,CAACzE,aAAL,CAAmBwE,WAAnB;;AACA,6BAAI,CAAC0L,WAAL,GAAmB,IAAnB;;AAEA,6BAAI,CAACiB,aAAL;AACD,qBANoD;AAOrD9M,wBAAI,EAAE,cAACC,MAAD,EAAW;;;AACf,0BAAIA,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAEuL,OAAZ,EAAqB;AACnB,+BAAI,CAACK,WAAL,GAAmB5L,MAAM,CAAC1C,IAA1B;AAEA,+BAAI,CAACwL,GAAL,GAAW,aAAI,CAAC8C,WAAL,MAAgB,IAAhB,IAAgB/K,aAAhB,GAAgB,MAAhB,GAAgBA,GAAEiI,GAA7B;AACA,+BAAI,CAACtK,SAAL,CAAe,MAAf,IAAsBN,gCACjB,OAAI,CAACM,SAAL,CAAe,MAAf,CADiB,GACK;AAAEC,wCAAc,EAAE;AAAE,oCAAQuB,MAAM,CAAC1C,IAAP,CAAYmL;AAAtB;AAAlB,yBADL,CAAtB;AAIA,+BAAI,CAACjK,SAAL,CAAemG,KAAf,GAAoBzG,gCACf,OAAI,CAACM,SAAL,CAAe,OAAf,CADe,GACQ;AAAEC,wCAAc,EAAE;AAAE,gDAAoBuB,MAAM,CAAC1C,IAAP,CAAYoL;AAAlC;AAAlB,yBADR,CAApB;AAIA,4BAAMiC,QAAQ,GAAG,OAAI,CAACnM,SAAL,CAAekG,IAAf,CAAoB4F,OAArC;AACA,4BAAMM,YAAY,GAAGD,QAAQ,CAACvJ,MAAT,CAAgB,WAAC;AAAA,iCAAIyJ,CAAC,CAAC5L,IAAF,KAAWe,MAAM,CAAC1C,IAAP,CAAYmL,WAA3B;AAAA,yBAAjB,CAArB;;AACA,4BAAImC,YAAY,CAAC1J,MAAb,GAAsB,CAA1B,EAA6B;AAC3B,iCAAI,CAAC1C,SAAL,CAAemG,KAAf,GAAoBzG,gCAAQ,OAAI,CAACM,SAAL,CAAemG,KAAvB,GAA4B;AAAE3F,sCAAU,EAAE,OAAI,CAAC0H,cAAL,CAAoBoE,eAApB,CAAoCF,YAAY,CAAC,CAAD,CAAZ,CAAgBnN,EAApD,EAAwD,OAAI,CAACgK,UAA7D;AAAd,2BAA5B,CAApB;AACAtI,oCAAU,CAAC,YAAK;AACd,mCAAI,CAACwF,KAAL,CAAWtF,iBAAX;AACD,2BAFS,CAAV;AAGD;;AAED,+BAAI,CAACb,SAAL,CAAewI,IAAf,GAAmB9I,gCACd,OAAI,CAACM,SAAL,CAAe,MAAf,CADc,GACQ;AAAEC,wCAAc,EAAE;AAAE,oCAAQuB,MAAM,CAAC1C,IAAP,CAAYmM;AAAtB;AAAlB,yBADR,CAAnB;AAIA,+BAAI,CAACK,eAAL,CAAqB,MAArB,IAA+B9J,MAAM,CAAC1C,IAAP,CAAYmL,WAA3C;AACA,+BAAI,CAACqB,eAAL,CAAqB,OAArB,IAAgC9J,MAAM,CAAC1C,IAAP,CAAYoL,YAA5C;AACA,+BAAI,CAACoB,eAAL,CAAqB,MAArB,IAA+B9J,MAAM,CAAC1C,IAAP,CAAYmM,cAA3C;AAEA,+BAAI,CAACR,aAAL,GAAqB,KAArB;AACA,+BAAI,CAACF,YAAL,GAAoB,KAApB;AACA,+BAAI,CAACoB,YAAL,GAAoB,IAApB;;AACA,+BAAI,CAACC,eAAL;AACD,uBAjCD,MAiCO;AACL,+BAAI,CAACwB,WAAL,GAAmB,IAAnB;;AACA,+BAAI,CAAClQ,aAAL,CAAmB6Q,aAAnB,CAAiC,IAAjC,EAAuC,kBAAiBvM,MAAM,SAAN,UAAM,WAAN,GAAM,MAAN,SAAM,CAAE8M,OAAzB,CAAvC;;AAEA,+BAAI,CAACD,aAAL;AACD;;AAED1N,gCAAU,CAAC,YAAK;AACd,+BAAI,CAACuF,IAAL,CAAUqI,yBAAV,GAAsC,EAAtC;AACA,+BAAI,CAACrI,IAAL,CAAUsI,iBAAV,CAA4BC,cAA5B,CAA2CC,SAA3C,GAAuD,KAAvD;AACA,+BAAI,CAACxI,IAAL,CAAUsI,iBAAV,CAA4BC,cAA5B,CAA2CE,OAA3C,GAAqD,KAArD;AAEA,+BAAI,CAACxI,KAAL,CAAWoI,yBAAX,GAAuC,EAAvC;AACA,+BAAI,CAACpI,KAAL,CAAWqI,iBAAX,CAA6BC,cAA7B,CAA4CC,SAA5C,GAAwD,KAAxD;AACA,+BAAI,CAACvI,KAAL,CAAWqI,iBAAX,CAA6BC,cAA7B,CAA4CE,OAA5C,GAAsD,KAAtD;AAEA,+BAAI,CAACnG,IAAL,CAAU+F,yBAAV,GAAsC,EAAtC;AACA,+BAAI,CAAC/F,IAAL,CAAUgG,iBAAV,CAA4BC,cAA5B,CAA2CC,SAA3C,GAAuD,KAAvD;AACA,+BAAI,CAAClG,IAAL,CAAUgG,iBAAV,CAA4BC,cAA5B,CAA2CE,OAA3C,GAAqD,KAArD;AACD,uBAZS,EAYP,CAZO,CAAV;;AAcA,6BAAI,CAACpD,QAAL;AACD,qBA/DoD;AAgErDzQ,4BAAQ,EAAE,oBAAK;AACb,6BAAI,CAACoC,aAAL,CAAmBwE,WAAnB;AACD;AAlEoD,mBAAvD;AAoED;;AAED,oBAAI,OAAI,CAACgJ,cAAL,IAAuBZ,SAAS,CAACpH,MAAV,IAAoB,EAA/C,EAAmD;AACjD,yBAAI,CAACgI,cAAL,GAAsB,KAAtB;AACD;AACF;AA7EQ,aAFb;AAiFD;AAED;;;;;;iBAGQ,yBAAa;AACnB,iBAAKD,aAAL,GAAqB,KAArB;AACA,iBAAKF,YAAL,GAAoB,KAApB;AACA,iBAAKoB,YAAL,GAAoB,KAApB;AAEA,iBAAKL,eAAL,CAAqB,MAArB,IAA+B,EAA/B;AACA,iBAAKA,eAAL,CAAqB,OAArB,IAAgC,EAAhC;AACA,iBAAKA,eAAL,CAAqB,MAArB,IAA+B,IAA/B;AAEA,iBAAKtL,SAAL,CAAemG,KAAf,CAAqB2F,OAArB,GAA+B,EAA/B;AACA,iBAAK9L,SAAL,CAAewI,IAAf,CAAoBsD,OAApB,GAA8B,EAA9B;AAEA,iBAAK9L,SAAL,CAAe,MAAf,IAAsBN,gCACjB,KAAKM,SAAL,CAAe,MAAf,CADiB,GACK;AAAEC,4BAAc,EAAE;AAAlB,aADL,CAAtB;AAGA,iBAAKD,SAAL,CAAemG,KAAf,GAAoBzG,gCACf,KAAKM,SAAL,CAAe,OAAf,CADe,GACQ;AAAEC,4BAAc,EAAE;AAAlB,aADR,CAApB;AAGA,iBAAKD,SAAL,CAAewI,IAAf,GAAmB9I,gCACd,KAAKM,SAAL,CAAe,MAAf,CADc,GACQ;AAAEC,4BAAc,EAAE;AAAlB,aADR,CAAnB;AAGD;AAED;;;;;;eAGA,eAAiB;;;AACf,gBAAI,CAAC,KAAK7F,MAAN,IAAgB,CAAC,KAAK8C,aAAL,CAAmBuH,UAAxC,EAAoD;AAClD,qBAAO,IAAP;AACD,aAFD,MAEO,IAAI,KAAKvH,aAAL,CAAmBuH,UAAvB,EAAmC;AACxC,qBAAO,KAAP;AACD;;AACD,mBAAO,CAAE,QAAF,EAAY,UAAZ,EAAwB,UAAxB,EAAoC,QAApC,EAA8C,kBAA9C,EAAkE,UAAlE,EAA+EH,OAA/E,CAAuF,WAAKlK,MAAL,MAAW,IAAX,IAAWiI,aAAX,GAAW,MAAX,GAAWA,GAAEkC,WAAF,EAAlG,MAAuH,CAAC,CAA/H;AACD;AAED;;;;;;iBAGM,uBAAc3G,QAAd,EAAgCsN,UAAhC,EAAqDhN,aAArD,EAA4EgI,IAA5E,EAA0FsC,IAA1F,EAAsG;;;;;;;AAC1G,yBAAKrL,cAAL,CAAoB2C,QAApB,CAA6B,eAA7B,EAA8C,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AACzFC,4BAAM,EAAE,KAAKA;AAD4E,qBAA7C,CAA9C;sDAGO,uDAAe,KAAKqI,aAAL,CAAmBmF,aAAnB,CAAiC3P,QAAjC,EAA2CsI,IAA3C,EACpBkF,kCAAK,CAAC,KAAKE,eAAL,CAAqB3C,gBAAtB,CAAL,CAA6C0C,MAA7C,CAAoD,qBAApD,CADoB,EAEpB,KAAKN,eAFe,CAAf,EAGJpB,IAHI,CAGC,UAACnI,MAAD,EAAW;AACjB,0BAAIA,MAAM,CAAC1C,IAAX,EAAiB;AACf,+BAAI,CAAC8L,UAAL,GAAkB;AAChBhN,kCAAQ,EAAE4D,MAAM,CAAC1C,IAAP,CAAYG,EADN;AAEhB2P,6CAAmB,EAAEpN,MAAM,CAAC1C,IAAP,CAAY8P,mBAFjB;AAGhBtB,2CAAiB,EAAE9L,MAAM,CAAC1C,IAAP,CAAY+P,gBAHf;AAIhB3D,oCAAU,EAAEA,UAJI;AAKhBhN,uCAAa,EAAEA;AALC,yBAAlB;AAOD;AACF,qBAbM;;;;;;;;AAcR;AAED;;;;;;iBAGA,uBAAW;AAAA;;AACT,iBAAKmK,sBAAL,CAA4ByG,gBAA5B,GAA+ClQ,SAA/C,CAAyD;AACvD2C,kBAAI,EAAE,cAACwN,QAAD,EAAa;AACjB,oBAAI,SAAQ,SAAR,YAAQ,WAAR,GAAQ,MAAR,WAAQ,CAAEjQ,IAAV,CAAe4D,MAAf,IAAwB,CAA5B,EAA+B;AAC7B,yBAAI,CAAC2H,QAAL,GAAgB0E,QAAQ,CAACjQ,IAAT,CAAc,CAAd,EAAiBuL,QAAjC;AACD;AACF;AALsD,aAAzD;AAOD;AAED;;;;;;iBAGA,uBAAW;AACT,iBAAKlN,cAAL,CAAoB2C,QAApB,CAA6B,aAA7B,EAA4C,CAAE,wBAAF,EAA4B,eAA5B,EAA6C;AACvFC,oBAAM,EAAE,KAAKA;AAD0E,aAA7C,CAA5C;AAGA,iBAAKC,SAAL,GAAiB,0FAAjB;AACA,iBAAK9C,aAAL,CAAmBsB,WAAnB,CAA+BqJ,WAA/B;AACA,iBAAK3K,aAAL,CAAmBuH,UAAnB,GAAgC,KAAhC;AACD;;;;;;;yBAj2BUwD,yBAAsBD;AAAA;;;cAAtBC;AAAsBvO;AAAAqO;AAAA;;;;;;;;;;;;;;;;;;;;;ADxBnCC;;AA4CAA;;;;AA5C8EA;;AA4C5DA;;AAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEzCdgH;;AACIA;;AACIA;;AACIA;;AAAOA;;AAA0BA;;AACrCA;;AACAA;;AACIA;;AAAOA;;AAAyDA;;AAChEA;;AAAMA;;AAAgEA;;AAC1EA;;AACJA;;AACAA;;AACIA;;AACAA;;AACIA;;AACAA;;AAAOA;;AAA2BA;;AAClCA;;AAAMA;;AAA4BA;;AACtCA;;AACJA;;AACJA;;;;;;AAfmBA;;AAAAA;;AAGAA;;AAAAA;;AACDA;;AAAAA;;AAMHA;;AAAAA,8JAAoB,QAApB,EAAoB,IAApB,EAAoB,UAApB,EAAoBC,cAApB;;AACID;;AAAAA;;AACDA;;AAAAA;;;;;;;;AASNA;;AAKIA;AAAAA;;AAAA;;AAAA;AAAA;;AAEFA;;;;;;AANEA,iHAAqC,cAArC,EAAqCE,mBAArC,EAAqC,gBAArC,EAAqCA,qBAArC,EAAqC,MAArC,EAAqCA,WAArC;;;;;;;;AAwBRF;;AAA0IA;AAAAA;;AAAA;;AAAA,mCAAiB,QAAjB,EAA2B,EAA3B;AAA6B,WAA7B;;AAAgCA;;;;;;AAA9JA;;;;;;;;AACZA;;AAA2FA;AAAAA;;AAAA;;AAAA,mCAAiB,MAAjB,EAAuBG,gBAAvB;AAAuB,WAAvB;;AAAoCH;;;;;;AAAnHA;;;;;;;;AACZA;;AAAwIA;AAAAA;;AAAA;;AAAA;AAAA;;AAAkDA;;;;;;AAA9KA;;;;;;;;AACZA;;AAA6JA;AAAAA;;AAAA;;AAAA;AAAA;;AAAoDA;;;;;;AAArMA;;;;;;;;AACZA;;AAAqJA;AAAAA;;AAAA;;AAAA;AAAA;;AAA+CA;;;;;;AAAxLA;;;;;;AACZA;;;;;;AAA2HA;;;;;;AAN/HA;;AACIA;;AACAA;;AACAA;;AACAA;;AACAA;;AACAA;;AACJA;;;;;;AAN+CA;;AAAAA;;AACFA;;AAAAA;;AACIA;;AAAAA;;AACEA;;AAAAA;;AACLA;;AAAAA;;AAC7BA;;AAAAA;;;;;;;;AAGbA;;AAAgPA;AAAAA;;AAAA;;AAAA;AAAA;;AAA4CA;;;;;;AAAlFA;;;;;;;;AAC1MA;;AAA0IA;AAAAA;;AAAA;;AAAA,mCAAiB,QAAjB,EAA2B,EAA3B;AAA6B,WAA7B;;AAAgCA;;;;;;AAA9JA;;;;;;;;AACZA;;AAA2FA;AAAAA;;AAAA;;AAAA,mCAAiB,MAAjB,EAAuBI,gBAAvB;AAAuB,WAAvB;;AAAoCJ;;;;;;AAAnHA;;;;;;AAHhBA;;AACIA;;AACAA;;AACAA;;AACJA;;;;;;AAH2CA;;AAAAA;;AACIA;;AAAAA;;AACFA;;AAAAA;;;;;;;;;;;;;;AA9DrDA;;AACIA;;AACIA;AAAAA;;AAAA;;AAAA;AAAA;;AAA4BA;;AAChCA;;AAoBAA;;AACIA;;AAGQA;;AAQAA;;AACRA;;AAQJA;;AACAA;;AACIA;;AACIA;;AACIA;;AACJA;;AACJA;;AACAA;;AAQAA;;AAKFA;;AAGAA;;AAASA;AAAAA;;AAAA;;AAAA;AAAA;;AAAyGA;;AACxHA;;;;;;AApEgCA;;AACXA;;AAAAA,+FAAmB,YAAnB,EAAmB,IAAnB;;AAEYA;;AAAAA;;AAwBMA;;AAAAA;;AAQLA;;AAAAA;;AAgBkBA;;AAAAA;;AAQAA;;AAAAA;;AAQHA;;AAAAA,+FAAmB,WAAnB,EAAmBK,uBAAnB;;;;;;;;AAEjDL;;AAAwFA;AAAAA;;AAAA;;AAAA;AAAA;;AAAiCA;;;;;;AAA7EA,sFAAiB,YAAjB,EAAiBM,iBAAjB;;;;;;AAC5CN;;;;AClDA,UAAMO,cAAc,GAA0B;AAC5CC,aAAK,EAAE,iBADqC;AAE5CC,YAAI,EAAE,CAFsC;AAG5CC,mBAAW,EAAE,qBAH+B;AAI5CC,gBAAQ,EAAE;AAJkC,OAA9C;;UAYaC;AAqFX;;;;AAIA,6CAAoBtH,EAApB,EACSpL,aADT,EAEUE,WAFV,EAGUyS,qBAHV,EAIUvS,KAJV,EAKUH,cALV,EAMUgL,iBANV,EAOS2H,MAPT,EAQU7S,MARV,EAQwB;AAAA;;AAAA;;AARJ;AACX;AACC;AACA;AACA;AACA;AACA;AACD;AACC;AAhGH,wBAAgCsS,cAAhC;AAEE,kCAAqC;AAC5C/R,qBAAS,EAAE,MADiC;AAE5CC,0BAAc,EAAE,EAF4B;AAG5CC,uBAAW,EAAE,EAH+B;AAI5CC,uBAAW,EAAE,EAJ+B;AAK5CC,oBAAQ,EAAE,CALkC;AAM5CC,4BAAgB,EAAE,IAN0B;AAO5CC,qBAAS,EAAE,EAPiC;AAQ5CG,qBAAS,EAAE,CARiC;AAS5CC,yBAAa,EAAE,CAT6B;AAU5CH,qBAAS,EAAE,MAViC;AAW5CC,oBAAQ,EAAE,KAXkC;AAY5CI,sBAAU,EAAE,MAZgC;AAa5CC,uBAAW,EAAE,SAb+B;AAc5CC,4BAAgB,EAAE,QAd0B;AAe5CC,iBAAK,EAAE;AAfqC,WAArC;AAkBD,8BAAsB,KAAtB;AAeD,4BAA4CwR,2FAA5C;AAEA,yBAAmB,IAAnB;AACA,2BAAqB,KAArB;AAeA,0BAAoB,KAApB;AACA,gCAA0B,KAA1B;AACA,yBAAkB,EAAlB;AACA,8BAAwB,KAAxB;AACA,8BAAwB,KAAxB;AACA,gCAAyB,EAAzB;AAOA,qCAA+C;AACpDjE,mBAAO,EAAE,CACP;AAAE,uBAAS,mBAAX;AAAgC,kCAAoB;AAApD,aADO,EAEP;AAAE,uBAAS,QAAX;AAAqB,kCAAoB,OAAzC;AAAkD,uBAAS;AAA3D,aAFO,EAGP;AAAE,uBAAS,SAAX;AAAsB,kCAAoB;AAA1C,aAHO,EAIP;AACA;AAAE,uBAAS,UAAX;AAAuB,kCAAoB;AAA3C,aALO,CAD2C;AAQpDhI,uBAAW,EAAE,SARuC;AASpDvJ,iBAAK,EAAE,EAT6C;AAUpDyV,sBAAU,EAAE,QAVwC;AAWpDC,2BAAe,EAAE,UAXmC;AAYpDxP,gBAAI,EAAE,QAZ8C;AAapDP,wBAAY,EAAE,OAbsC;AAcpDD,0BAAc,EAAE;AAdoC,WAA/C;AAgBP,yBAAiB,EAAjB;AACA,kCAAmB,KAAnB;;AAeE,cAAI,KAAK/C,aAAL,CAAmBsB,WAAnB,CAA+BC,MAAnC,EAA2C;AACzC,iBAAKvB,aAAL,CAAmBsB,WAAnB,GAAiC,IAAI0R,kDAAJ,CAA6B,IAA7B,CAAjC;AACD;;AAED,eAAKhT,aAAL,CAAmByB,eAAnB,CAAmCC,SAAnC,CAA6C,UAACC,GAAD,EAAQ;AACnD,gBAAIA,GAAG,IAAIA,GAAG,CAACC,IAAf,EAAqB;AACnB,kBAAQC,kBAAR,GAA+BF,GAAG,CAACC,IAAnC,CAAQC,kBAAR;;AACA,kBAAIA,kBAAJ,EAAwB;AACtB,uBAAI,CAACC,YAAL,GAAoBD,kBAAkB,CAACE,EAAvC;AACD;AACF;AACF,WAPD;AASA,eAAKkR,IAAL,GAAY,KAAKjT,aAAL,CAAmBkT,WAAnB,EAAZ;AACD;AAGD;;;;;;;;eAIA,eAAS;AACP,mBAAO,CACL,gBADK,EAEL,kBAFK,EAGL,gBAHK,EAIL,MAJK,EAKL,QALK,EAML,MANK,EAOLC,QAPK,CAOIC,SAAS,CAACC,QAPd,EAQL;AARK,eASDD,SAAS,CAACE,SAAV,CAAoBH,QAApB,CAA6B,KAA7B,KAAuC,gBAAgB3I,QAT7D;AAUD;AAGD;;;;;;;iBAKA,gCAAuBmB,KAAvB,EAAiC;;;AAC/B,gBAAI,CAAC,KAAK4H,YAAN,IAAsB,CAAC,KAAKC,KAA5B,IAAqC,CAAC,KAAKC,OAA/C,EAAwD;AACtD;AACD;;AAED,gBAAI,kBAAKC,gBAAL,MAAqB,IAArB,IAAqBvO,aAArB,GAAqB,MAArB,GAAqBA,GAAEwO,eAAvB,MAAsC,IAAtC,IAAsCvO,aAAtC,GAAsC,MAAtC,GAAsCA,GAAEI,MAAxC,KAAkD,CAAtD,EAAyD;AACvD,mBAAKoO,mBAAL,CAAyB,KAAKH,OAA9B;AACD;AACF;AAED;;;;;;;iBAKA,oBAAW9H,KAAX,EAAgB;AACdkI,0BAAc,CAACC,OAAf,CAAuB,QAAvB,EAAiC,GAAjC;AACD;AAEC;;;;;;;iBAIA,2BAAe;AACb,iBAAK9T,aAAL,CAAmB2C,UAAnB,CAA8B,eAA9B,EAA+C,UAA/C;AACA,iBAAKyI,EAAL,CAAQ2I,aAAR;AACA,iBAAKC,OAAL,GAAe,KAAf;AACA,iBAAK/T,cAAL,CAAoB2C,QAApB,CAA6B,iBAA7B,EAAgD,CAAE,4BAAF,EAAgC,eAAhC,EAAiD;AAC/FC,oBAAM,EAAE,KAAKsB;AADkF,aAAjD,CAAhD;AAGD;AAED;;;;;;iBAGA,oBAAW8P,MAAX,EAAoC;AAClC,iBAAKC,kBAAL,GAA0B,CAACD,MAAM,CAACE,IAAlC;;AACA,gBAAI,CAAC,KAAKD,kBAAV,EAA8B,CAC5B;AACD;;AAED,iBAAKjU,cAAL,CAAoB2C,QAApB,CAA6B,YAA7B,EAA2C,CAAE,4BAAF,EAAgC,eAAhC,EAAiD;AAC1FC,oBAAM,EAAE,KAAKsB;AAD6E,aAAjD,CAA3C;AAID;AAED;;;;;;iBAGA,oBAAQ;AAAA;;;;AACN,iBAAKA,QAAL,GAAgB,WAAK/D,KAAL,CAAW4F,MAAX,MAAiB,IAAjB,IAAiBb,aAAjB,GAAiB,MAAjB,GAAiBA,GAAEc,QAAF,CAAWC,QAAX,CAAoBC,GAApB,CAAwB,IAAxB,CAAjC,CADM,CAEN;;AACA,iBAAKuB,aAAL;AACA,iBAAK6L,YAAL,GAAoB,IAApB;AACA,iBAAKa,eAAL,GAAuB;AACvB;AACE/W,mBAAK,EAAE,UAFc;AAGrBC,kBAAI,EAAE,SAHe;AAIrBC,kBAAI,EAAE;AAJe,aAAvB;AAOA,iBAAK8W,iBAAL,GAAyB;AACvBhX,mBAAK,EAAE,SADgB;AAEvBC,kBAAI,EAAE,SAFiB;AAGvBC,kBAAI,EAAE;AAHiB,aAAzB;AAMA,iBAAK+W,YAAL,GAAoB;AAClBjX,mBAAK,EAAE,QADW;AAElBC,kBAAI,EAAE,gBAFY;AAGlBC,kBAAI,EAAE;AAHY,aAApB;AAMA,iBAAKgX,iBAAL,GAAyB;AACvBlX,mBAAK,EAAE,mBADgB;AAEvBC,kBAAI,EAAE,SAFiB;AAGvBC,kBAAI,EAAE,MAHiB;AAIvByM,qBAAO,EAAE,KAAKwK,YAAL,CAAkB7N,IAAlB,CAAuB,IAAvB;AAJc,aAAzB;AAOA,iBAAK8N,aAAL,GAAqB;AACnBpX,mBAAK,EAAE,gBADY;AAEnBC,kBAAI,EAAE,SAFa;AAGnBC,kBAAI,EAAE;AAHa,aAArB;AAKA,iBAAKmX,WAAL,GAAmB;AACjBrX,mBAAK,EAAE,cADU;AAEjBC,kBAAI,EAAE,SAFW;AAGjBC,kBAAI,EAAE;AAHW,aAAnB;AAMA,iBAAKyC,aAAL,CAAmBsB,WAAnB,CAA+BI,SAA/B,CAAyC;AACvC2C,kBAAI,EAAE,cAAC1C,GAAD,EAAiB;AACrB,oBAAI,CAACA,GAAL,EAAU;AACR,yBAAI,CAAC2I,YAAL,GAAoB,IAApB;AACD;AACF;AALsC,aAAzC;AAOA,gBAAMC,SAAS,GAAQC,QAAQ,CAACC,aAAT,CAAuB,oBAAvB,CAAvB;;AACA,gBAAIF,SAAJ,EAAe;AACbA,uBAAS,CAACG,SAAV,GAAsB,CAAtB;AACD;;AAED,iBAAKzK,cAAL,CAAoB2C,QAApB,CAA6B,UAA7B,EAAyC,CAAE,4BAAF,EAAgC,eAAhC,EAAiD;AACxFC,oBAAM,EAAE,KAAKsB;AAD2E,aAAjD,CAAzC;AAID;AAED;;;;;;iBAGA,wBAAY;AACV,gBAAI,KAAKwQ,QAAT,EAAmB;AACjB,mBAAK3U,aAAL,CAAmB4U,wBAAnB,CAA4C,KAAKC,oBAAL,CAA0BlO,IAA1B,CAA+B,IAA/B,CAA5C,EAAkFmO,0EAAlF;AACD,aAFD,MAEO;AACL,mBAAKD,oBAAL;AACD;AACF;AAED;;;;;;iBAGA,gCAAuB5L,KAAvB,EAAiC;AAAA;;;;AAC/B,gBAAIrH,IAAI,GAAG,IAAX;AACA,gBAAI1E,MAAM,GAAG,EAAb;;AACA,gBAAI,YAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEmJ,KAAP,MAAY,IAAZ,IAAYlB,aAAZ,GAAY,MAAZ,GAAYA,GAAE9H,KAAd,KAAuB,mBAAvB,IAA8C,MAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEA,KAAP,KAAgB,mBAAlE,EAAuF;AACrF,kBAAI,KAAKsX,QAAT,EAAmB;AACjB,qBAAK3U,aAAL,CAAmB4U,wBAAnB,CAA4C,KAAKC,oBAAL,CAA0BlO,IAA1B,CAA+B,IAA/B,CAA5C,EAAkFmO,0EAAlF;AACD,eAFD,MAEO;AACL,qBAAKD,oBAAL;AACD;;AACD;AACD,aAPD,MAOO,IAAI,YAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAExO,KAAP,MAAY,IAAZ,IAAYjB,aAAZ,GAAY,MAAZ,GAAYA,GAAE/H,KAAd,KAAuB,SAAvB,IAAoC,MAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEA,KAAP,KAAgB,SAAxD,EAAmE;AACxEuE,kBAAI,GAAG,KAAKmT,UAAL,CAAgB9X,OAAvB;AACAC,oBAAM,GAAG,UAAT;AACD,aAHM,MAGA,IAAI,YAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEmJ,KAAP,MAAY,IAAZ,IAAYhB,aAAZ,GAAY,MAAZ,GAAYA,GAAEhI,KAAd,KAAuB,UAAvB,IAAqC,MAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEA,KAAP,KAAgB,UAAzD,EAAqE;AAC1EuE,kBAAI,GAAG,KAAKmT,UAAL,CAAgBnX,QAAvB;AACAV,oBAAM,GAAG,UAAT;AACD,aAHM,MAGA,IAAI,YAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEmJ,KAAP,MAAY,IAAZ,IAAYf,aAAZ,GAAY,MAAZ,GAAYA,GAAEjI,KAAd,KAAuB,QAAvB,IAAmC,MAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEA,KAAP,KAAgB,QAAvD,EAAiE;AACtEuE,kBAAI,GAAG,KAAKmT,UAAL,CAAgBrX,MAAvB;AACAR,oBAAM,GAAG,UAAT;AACD,aAHM,MAGA,IAAI,YAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEmJ,KAAP,MAAY,IAAZ,IAAYmB,aAAZ,GAAY,MAAZ,GAAYA,GAAEnK,KAAd,KAAuB,cAAvB,IAAyC,MAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEA,KAAP,KAAgB,cAA7D,EAA6E;AAClF,mBAAK2X,OAAL,CAAa,MAAb,EAAqB,KAAKL,QAA1B;AACA;AACD,aAHM,MAGA,IAAI,YAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEtO,KAAP,MAAY,IAAZ,IAAYwC,aAAZ,GAAY,MAAZ,GAAYA,GAAExL,KAAd,KAAuB,gBAAvB,IAA2C,MAAK,SAAL,SAAK,WAAL,GAAK,MAAL,QAAK,CAAEA,KAAP,KAAgB,gBAA/D,EAAiF;AACtF,mBAAK2X,OAAL,CAAa,QAAb,EAAuB,EAAvB;AACA;AACD;;AAED,iBAAK/U,cAAL,CAAoB2C,QAApB,CAA6B,wBAA7B,EAAuD,CAAE,4BAAF,EAAgC,eAAhC,EAAiD;AACtGC,oBAAM,EAAE,KAAKsB,QADyF;AAEtGjH,oBAAM,EAANA;AAFsG,aAAjD,CAAvD;AAKA,gBAAM+X,SAAS,GAAG,KAAKrC,MAAL,CAAYsC,IAAZ,CAAiBC,mHAAjB,EAA2C;AAC3DC,uBAAS,EAAE,KADgD;AAE3DxT,kBAAI,EACJA;AAH2D,aAA3C,CAAlB;AAMAqT,qBAAS,CAACI,WAAV,GAAwB3T,SAAxB,CAAkC;AAChC2C,kBAAI,EAAE,cAACzC,IAAD,EAAc;AAClB,uBAAI,CAAC5B,aAAL,CAAmB6D,WAAnB;;AACA,oBAAI,CAACjC,IAAL,EAAW;AACT,yBAAI,CAAC5B,aAAL,CAAmBwE,WAAnB;;AACA;AACD;;AAGD,uBAAI,CAACtE,WAAL,CAAiBoV,gBAAjB,CAAkC,OAAI,CAACnR,QAAvC,EAAiDjH,MAAjD,EAAyD0E,IAAI,CAACA,IAA9D,EAAoEF,SAApE,CAA8E;AAC5E2C,sBAAI,EAAE,gBAAK;AACT,2BAAI,CAACpE,cAAL,CAAoB2C,QAApB,CAA6B,kBAA7B,EAAiD,CAAE,4BAAF,EAAgC,eAAhC,EAAiD;AAChGC,4BAAM,EAAE,OAAI,CAACsB,QADmF;AAEhGjH,4BAAM,EAANA;AAFgG,qBAAjD,CAAjD;;AAIA,2BAAI,CAACyK,UAAL,GAAkBzK,MAAlB,CALS,CAMT;;AACA,2BAAI,CAACqY,YAAL,CAAkBrY,MAAlB;AACD,mBAT2E;AAU5EU,0BAAQ,EAAE,oBAAK;AACb,2BAAI,CAACoC,aAAL,CAAmBwE,WAAnB;AACD,mBAZ2E;AAa5EC,uBAAK,EAAE,iBAAK;AACV,2BAAI,CAACzE,aAAL,CAAmBwE,WAAnB;AACD;AAf2E,iBAA9E;AAiBD;AA1B+B,aAAlC;AA4BD;AAED;;;;;;iBAGA,gCAAoB;AAAA;;AAClB,iBAAKxE,aAAL,CAAmB6D,WAAnB;AACA,iBAAK5D,cAAL,CAAoB2C,QAApB,CAA6B,sBAA7B,EAAqD,CAAE,4BAAF,EAAgC,eAAhC,EAAiD;AACpGC,oBAAM,EAAE,KAAKsB,QADuF;AAEpGjH,oBAAM,EAANA;AAFoG,aAAjD,CAArD;;AAIA,gBAAI,KAAKkD,KAAL,CAAW6F,QAAX,CAAoB0D,WAApB,CAAgC,MAAhC,KAA2C,KAAKvJ,KAAL,CAAW6F,QAAX,CAAoB0D,WAApB,CAAgC,MAAhC,KAA2C,MAA1F,EAAkG;AAChG,mBAAK5J,MAAL,CAAYwE,QAAZ,CACE,EADF,EAEE;AACEiR,0BAAU,EAAE,KAAKpV,KADnB;AAEEuJ,2BAAW,EAAE;AAAE8L,sBAAI,EAAE;AAAR,iBAFf;AAGEC,mCAAmB,EAAE;AAHvB,eAFF;AAOD;;AACD,iBAAK/C,qBAAL,CAA2BgD,cAA3B,CAA0C,KAAKxR,QAA/C,EAAyD,KAAK0D,YAA9D,EAA4E,KAAK6E,SAAjF,EAA4F,KAAKkJ,QAAjG,EAA2GlU,SAA3G,CAAqH;AACnH2C,kBAAI,EAAE,cAAC0C,IAAD,EAAc;AAClB,oBAAIA,IAAJ,EAAU;AACR8O,0BAAQ,CAACC,IAAT,GAAgB/O,IAAI,CAACnF,IAAL,CAAUmU,GAA1B;AACAlC,gCAAc,CAACC,OAAf,CAAuB,QAAvB,EAAiC,GAAjC;AACD;AACF,eANkH;AAOnHlW,sBAAQ,EAAE,oBAAK;AACb,uBAAI,CAACoC,aAAL,CAAmBwE,WAAnB;AACD;AATkH,aAArH;AAWD;AAED;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;;;;;;iBAGO,uBAAW;AAAA;;AAChB,iBAAKxE,aAAL,CAAmB6D,WAAnB;AACA,gBAAMmS,OAAO,GAAG,kBAAhB;AACA,iBAAK/V,cAAL,CAAoB2C,QAApB,CAA6B,aAA7B,EAA4C,CAAE,4BAAF,EAAgC,eAAhC,EAAiD;AAC3FC,oBAAM,EAAE,KAAKsB;AAD8E,aAAjD,CAA5C;AAGA,iBAAKwO,qBAAL,CAA2BqD,OAA3B,EAAoC,KAAK7R,QAAzC,EAAmDzC,SAAnD,CAA6D;AAC3D2C,kBAAI,EAAE,cAACC,MAAD,EAAgB;AACpB2R,sBAAM,CAACf,IAAP,CAAY5Q,MAAM,CAAC1C,IAAP,CAAYmU,GAAxB,EAA6B,MAA7B;;AACA,uBAAI,CAAC/V,aAAL,CAAmBwE,WAAnB;AACD,eAJ0D;AAK3DC,mBAAK,EAAE,iBAAK;AACV,uBAAI,CAACzE,aAAL,CAAmBwE,WAAnB;AACD;AAP0D,aAA7D;AASD;AAED;;;;;;eAGA,eAAoB;;;AAClB,gBAAI,CAAC,KAAKmD,UAAV,EAAsB;AACpB,qBAAO,KAAP;AACD;;AACD,mBAAO,CAAE,UAAF,EAAc,QAAd,EAAwB,UAAxB,EAAqCP,OAArC,CAA6C,WAAKO,UAAL,MAAe,IAAf,IAAexC,aAAf,GAAe,MAAf,GAAeA,GAAEkC,WAAF,EAA5D,MAAiF,CAAC,CAAzF;AACD;AAED;;;;;;eAGA,eAAiB;;;AACf,gBAAI,CAAC,KAAKM,UAAV,EAAsB;AACpB,qBAAO,KAAP;AACD;;AACD,mBAAO,CAAE,UAAF,EAAc,QAAd,EAAwB,UAAxB,EAAqCP,OAArC,CAA6C,WAAKO,UAAL,MAAe,IAAf,IAAexC,aAAf,GAAe,MAAf,GAAeA,GAAEkC,WAAF,EAA5D,MAAiF,CAAC,CAAzF;AACD;AAED;;;;;;iBAGA,0BAAc;AAAA;;AACZ,iBAAK6O,OAAL,GAAe,EAAf;AACA,iBAAKC,gBAAL,GAAwB,IAAxB;AACA,iBAAKjW,WAAL,CAAiBkW,cAAjB,CAAgC,KAAKjS,QAArC,EAA+C,KAAKyR,QAApD,EAA8DlU,SAA9D,CAAwE;AACtE2C,kBAAI,EAAE,cAACwN,QAAD,EAAa;AACjB,uBAAI,CAACqE,OAAL,GAAerE,QAAf;AACD,eAHqE;AAItEjU,sBAAQ,EAAE,oBAAK;AACb,uBAAI,CAACuY,gBAAL,GAAwB,KAAxB;AACD;AANqE,aAAxE;AAQD;AAED;;;;;;iBAGA,yBAAa;AAAA;;AACX,iBAAKjW,WAAL,CAAiBwH,aAAjB,CAA+B,KAAKvD,QAApC,EAA8CzC,SAA9C,CAAwD;AACtD2C,kBAAI,EAAE,cAACwN,QAAD,EAAkB;;;AAEtB,oBAAIA,QAAQ,SAAR,YAAQ,WAAR,GAAQ,MAAR,WAAQ,CAAEjQ,IAAd,EAAoB;AAClB,uCAA0EiQ,QAAQ,CAACjQ,IAAnF;AAAA,sBAAQgG,WAAR,kBAAQA,WAAR;AAAA,sBAAqB8E,SAArB,kBAAqBA,SAArB;AAAA,sBAAgCxP,OAAhC,kBAAgCA,MAAhC;AAAA,sBAAwCuW,OAAxC,kBAAwCA,OAAxC;AAAA,sBAAiD4C,UAAjD,kBAAiDA,UAAjD;AAAA,sBAA6DlJ,QAA7D,kBAA6DA,QAA7D;;AAEA,yBAAI,CAACnN,aAAL,CAAmB2H,UAAnB,CAA8BtD,IAA9B,CAAmCnH,OAAnC;;AACA,yBAAI,CAAC2K,YAAL,GAAoBD,WAAW,GAAG,iBAAW,CAAC,CAAD,CAAX,MAAc,IAAd,IAAczC,aAAd,GAAc,MAAd,GAAcA,GAAE0C,YAAnB,GAAkC,EAAjE;;AACA,sBAAI,CAAE,cAAF,EAAkB,kBAAlB,EAAsC,QAAtC,EAAgD,UAAhD,EAA4D,UAA5D,EAAwE,UAAxE,EAAoF,iBAApF,EAAuG,gBAAvG,EAAyH,cAAzH,EAA0IT,OAA1I,CAAkJlK,OAAM,CAACmK,WAAP,EAAlJ,MAA4K,CAAC,CAAjL,EAAoL;AAClL;AACD;;AACD,yBAAI,CAACqF,SAAL,GAAiBA,SAAjB;AACA,yBAAI,CAACiI,QAAL,GAAgB0B,UAAhB;AACA,yBAAI,CAAC1O,UAAL,GAAkBzK,OAAlB;AACA,yBAAI,CAAC0Y,QAAL,GAAgBzI,QAAhB;;AAEA,yBAAI,CAACoI,YAAL,CAAkBrY,OAAlB;;AACA,yBAAI,CAAC4H,MAAL,CAAYC,UAAZ,GAAyB8M,QAAQ,CAACjQ,IAAT,CAAcmD,UAAvC;AAGA,yBAAI,CAACuR,UAAL,GAAkBzE,QAAQ,CAACjQ,IAA3B;AACA,yBAAI,CAAC2U,YAAL,GAAoB1E,QAAQ,CAACjQ,IAAT,CAAcgM,UAAlC;AACA,yBAAI,CAAC6F,OAAL,GAAeA,OAAf;AAEA,yBAAI,CAAC8C,YAAL,GAAiB/T,gCACZ,OAAI,CAAC+T,YADO,GACK;AAAEC,2BAAO,EAAE,cAAI,CAACD,YAAL,CAAkB1V,SAAlB,MAA2B,IAA3B,IAA2BuE,aAA3B,GAA2B,MAA3B,GAA2BA,GAAEsD,SAAF,CAAY,CAAZ,EAAe,CAAf,EAAkB+N,WAAlB,EAA3B,KAC7B,aAAI,CAACF,YAAL,CAAkBzV,QAAlB,MAA0B,IAA1B,IAA0BuE,aAA1B,GAA0B,MAA1B,GAA0BA,GAAEqD,SAAF,CAAY,CAAZ,EAAe,CAAf,EAAkB+N,WAAlB,EADG;AAAX,mBADL,CAAjB;AAIA,yBAAI,CAACC,SAAL,GAAiB,IAAjB;;AAEA,sBAAI,OAAI,CAAC5U,YAAL,KAAqB,cAAQ,CAACF,IAAT,CAAcC,kBAAd,MAAgC,IAAhC,IAAgCyD,aAAhC,GAAgC,MAAhC,GAAgCA,GAAEgC,cAAvD,CAAJ,EAA2E;AACzE,2BAAI,CAACtH,aAAL,CAAmBuH,UAAnB,GAAgC,IAAhC;AACD,mBAFD,MAEK;AACH,2BAAI,CAACvH,aAAL,CAAmBuH,UAAnB,GAAgC,KAAhC;AACD;;AAED,sBAAMoP,QAAQ,GAAG9C,cAAc,CAAC+C,OAAf,CAAuB,QAAvB,KAAoC,GAArD;;AACA,sBAAID,QAAQ,KAAK,GAAjB,EAAsB;AACpB,2BAAI,CAAC/C,mBAAL,CAAyBH,OAAzB;;AACA,2BAAI,CAACzT,aAAL,CAAmB2C,UAAnB,CAA8B,eAA9B,EAA+C,UAA/C;AACD,mBAHD,MAGO,IAAIgU,QAAQ,KAAK,GAAb,IAAoB,OAAI,CAACvW,KAAL,CAAW6F,QAAX,CAAoB0D,WAApB,CAAgC,MAAhC,CAApB,IAA+D,OAAI,CAACvJ,KAAL,CAAW6F,QAAX,CAAoB0D,WAApB,CAAgC,MAAhC,KAA2C,MAA9G,EAAsH;AAC3H,2BAAI,CAACgJ,qBAAL,CAA2BkE,kBAA3B,CAA8C,OAAI,CAAC1S,QAAnD,EAA6D0N,QAAQ,CAACjQ,IAAT,CAAcgG,WAAd,CAA0B,CAA1B,EAA6BC,YAA1F,EACEgK,QAAQ,CAACjQ,IAAT,CAAc8K,SADhB,EAC2B,KAD3B,EACkC,OAAI,CAACkJ,QADvC,EAEGlU,SAFH,CAEa;AACT2C,0BAAI,EAAE,gBAAK;AACX;AACEwP,sCAAc,CAACC,OAAf,CAAuB,QAAvB,EAAiC,GAAjC;;AAEA,+BAAI,CAACF,mBAAL,CAAyBH,OAAzB;;AAEA,+BAAI,CAAC1T,MAAL,CAAYwE,QAAZ,CACE,EADF,EAEE;AACEiR,oCAAU,EAAE,OAAI,CAACpV,KADnB;AAEEuJ,qCAAW,EAAE;AAAE8L,gCAAI,EAAE;AAAR,2BAFf;AAGEC,6CAAmB,EAAE;AAHvB,yBAFF;;AAQA,+BAAI,CAAC1V,aAAL,CAAmBwE,WAAnB;;AACAf,kCAAU,CAAC,YAAI;AACb,iCAAI,CAACzD,aAAL,CAAmB2C,UAAnB,CAA8B,eAA9B,EAA+C,UAA/C;AACD,yBAFS,CAAV;AAID;AApBQ,qBAFb;AAwBD,mBAzBM,MAyBA;AACL,2BAAI,CAACiR,mBAAL,CAAyBH,OAAzB;AACD;AAEF;AACF,eAtEqD;AAuEtDhP,mBAAK,EAAE,iBAAK;AACV,uBAAI,CAACzE,aAAL,CAAmBwE,WAAnB;AACD;AAzEqD,aAAxD;AA2ED;AAED;;;;;;iBAGA,6BAAoBiP,OAApB,EAAmC;AAAA;;AACjC,iBAAKd,qBAAL,CAA2BmE,WAA3B,CAAuC,KAAK3S,QAA5C,EAAsD,KAAK0D,YAA3D,EAAyE,KAAK6E,SAA9E,EAAyF,KAAKkJ,QAA9F,EAAwGlU,SAAxG,CAAkH;AAChH2C,kBAAI,EAAE,cAACwN,QAAD,EAAa;;;AACjB,uBAAI,CAAC6B,gBAAL,GAAwB7B,QAAQ,CAACjQ,IAAjC;AACA,uBAAI,CAACmV,QAAL,GAAgB;AAAE,iCAAe,OAAI,CAACrD,gBAAL,CAAsB1K,IAAvC;AAA6C,kCAAgB,OAAI,CAAC0K,gBAAL,CAAsBsD;AAAnF,iBAAhB;AACA,uBAAI,CAACtD,gBAAL,CAAsBD,OAAtB,GAAgCA,OAAhC;AACA,uBAAI,CAACwD,cAAL,GAAsB,cAAQ,CAACrV,IAAT,MAAa,IAAb,IAAauD,aAAb,GAAa,MAAb,GAAaA,GAAE+R,cAArC;;AACA,oBAAG,CAAC,OAAI,CAACxD,gBAAL,CAAsByD,YAA1B,EAAwC;AACtC,yBAAI,CAACzD,gBAAL,CAAsByD,YAAtB,GAAqC,OAAI,CAAClE,IAAL,CAAUmE,cAA/C;AACD;;AACD,oBAAI,oBAAI,CAAC1D,gBAAL,MAAqB,IAArB,IAAqBtO,aAArB,GAAqB,MAArB,GAAqBA,GAAEuO,eAAvB,MAAsC,IAAtC,IAAsCtO,aAAtC,GAAsC,MAAtC,GAAsCA,GAAEG,MAAxC,KAAkD,CAAtD,EAAyD;AACvD,yBAAI,CAACxF,aAAL,CAAmBwE,WAAnB;;AACA,yBAAI,CAAC6S,qBAAL;AACD,iBAHD,MAGO;AACP;AACE,yBAAI,CAACC,aAAL;;AACA,yBAAI,CAACC,QAAL,GAAgB,IAAhB;AACD;;AAED,uBAAI,CAACvX,aAAL,CAAmBwE,WAAnB;AACD,eAnB+G;AAoBhHC,mBAAK,EAAE,iBAAK;AACV,uBAAI,CAACzE,aAAL,CAAmBwE,WAAnB;AACD;AAtB+G,aAAlH;AAwBD;AAED;;;;;;iBAGA,yBAAa;AAAA;;AAEX,iBAAKyG,iBAAL,CAAuBsE,yBAAvB,GAAmD7N,SAAnD,CAA6D;AAC3D2C,kBAAI,EAAE,cAACwN,QAAD,EAAkB;AACtB,oBAAMpC,wBAAwB,GAAGoC,QAAQ,SAAR,YAAQ,WAAR,GAAQ,MAAR,WAAQ,CAAEjQ,IAA3C;;AAEA,oBAAG,yBAAwB,SAAxB,4BAAwB,WAAxB,GAAwB,MAAxB,2BAAwB,CAAE4D,MAA1B,IAAmC,CAAtC,EAAwC;AACtC,yBAAI,CAACxF,aAAL,CAAmByP,wBAAnB,GAA8CA,wBAAwB,CAAC,CAAD,CAAtE;AACA,sBAAMC,oBAAoB,GAAGD,wBAAwB,CAAC,CAAD,CAAxB,CAA4B1N,EAAzD;AAEA,sBAAMyV,OAAO,GAAG,iDAAS;AACvBC,sCAAkB,EAAE,OAAI,CAACxM,iBAAL,CAAuByM,qBAAvB,CAA6ChI,oBAA7C,CADG;AAEvBiI,oCAAgB,EAAE,OAAI,CAAC1M,iBAAL,CAAuBqM,aAAvB,CAAqC,OAAI,CAACzP,YAA1C;AAFK,mBAAT,EAGbqJ,IAHa,CAId,mDAAW,eAAK;AAAA,2BAAI,2CAAGzM,KAAH,CAAJ;AAAA,mBAAhB,CAJc,CAAhB;AAMA+S,yBAAO,CAAC9V,SAAR,CAAkB,UAACkW,SAAD,EAAmB;;;AACnC,wBAAMC,wBAAwB,GAAG,eAAS,CAACJ,kBAAV,MAA4B,IAA5B,IAA4BtS,aAA5B,GAA4B,MAA5B,GAA4BA,GAAE2S,uBAA/D;AACA,wBAAMC,eAAe,GAAGH,SAAS,CAACD,gBAAlC;AACA,wBAAMK,sBAAsB,GAAGH,wBAAwB,SAAxB,4BAAwB,WAAxB,GAAwB,MAAxB,2BAAwB,CAAEnS,MAA1B,CAAiC,cAAI;AAAA,6BAAI6M,IAAI,CAAChP,IAAL,KAAc,mBAAlB;AAAA,qBAArC,CAA/B;AACA,2BAAI,CAAC0U,MAAL,GAAc,qBAAe,SAAf,mBAAe,WAAf,GAAe,MAAf,kBAAe,CAAEF,eAAjB,MAAgC,IAAhC,IAAgC3S,aAAhC,GAAgC,MAAhC,GAAgCA,GAAEM,MAAF,CAAS,WAAC;AAAA,6BAAK,CAACyJ,CAAC,CAAC5L,IAAF,IAAU,mBAAV,IAC9D4L,CAAC,CAAC+I,wBAAF,KAA+BF,sBAAsB,CAAC,CAAD,CAAtB,CAA0BjW,EADI,KAE1DoN,CAAC,CAACgJ,eAAF,IAAqB,EAFgC;AAAA,qBAAV,EAEjBC,GAFiB,CAEb,WAAC;AAAA,6BAAIjJ,CAAC,CAACgJ,eAAN;AAAA,qBAFY,CAA9C;;AAGA,wBAAI,cAAI,CAACF,MAAL,MAAW,IAAX,IAAW5S,aAAX,GAAW,MAAX,GAAWA,GAAEG,MAAb,KAAuB,CAA3B,EAA8B;AAC5B,6BAAI,CAACyS,MAAL,GAAc,qBAAe,SAAf,mBAAe,WAAf,GAAe,MAAf,kBAAe,CAAEF,eAAjB,MAAgC,IAAhC,IAAgCzS,aAAhC,GAAgC,MAAhC,GAAgCA,GAAEI,MAAF,CAC5C,WAAC;AAAA,+BAAKyJ,CAAC,CAAC5L,IAAF,IAAU,mBAAV,IAAiC4L,CAAC,CAACgJ,eAAF,IAAqB,EAA3D;AAAA,uBAD2C,EACqBC,GADrB,CACyB,WAAC;AAAA,+BAAIjJ,CAAC,CAACgJ,eAAN;AAAA,uBAD1B,CAA9C;AAGD;;AAED,2BAAI,CAACE,cAAL,GAAsB,IAAtB;AACD,mBAdD;AAeD;AACF;AA9B0D,aAA7D;AAiCD;AAED;;;;;;iBAGA,iCAAqB;AAAA;;AACnB,gBAAMpD,SAAS,GAAG,KAAKrC,MAAL,CAAYsC,IAAZ,CAAiBoD,gJAAjB,EAAoD;AACpEC,0BAAY,EAAE,IADsD;AAEpE3W,kBAAI,EAAE;AACJwP,uBAAO,EAAE;AADL,eAF8D;AAKpEoH,2BAAa,EAAE;AALqD,aAApD,CAAlB;AAQAvD,qBAAS,CAACI,WAAV,GAAwB3T,SAAxB,CAAkC;AAChC2C,kBAAI,EAAE,cAACwN,QAAD,EAAkB;AACtB4G,uBAAO,CAACC,GAAR,CAAY7G,QAAZ;;AACA,oBAAIA,QAAJ,EAAc;AACZ,yBAAI,CAACgD,oBAAL;AACD;AACF;AAN+B,aAAlC;AAQD;AAED;;;;;;;iBAIA,sBAAa3X,MAAb,EAA2B;AAEzB,gBAAIA,MAAM,CAACmK,WAAP,OAAyB,QAAzB,IAAqCnK,MAAM,CAACmK,WAAP,OAAyB,UAAlE,EAA8E;AAC5E,mBAAKsR,mBAAL,GAAwBnW,gCACnB,KAAKmW,mBADc,GAEnB;AACD/J,uBAAO,EAAE,CACP;AAAE,2BAAS,mBAAX;AAAgC,sCAAoB;AAApD,iBADO,EAEP;AAAE,2BAAS,QAAX;AAAqB,sCAAoB,OAAzC;AAAkD,2BAAS;AAA3D,iBAFO,EAGP;AAAE,2BAAS,SAAX;AAAsB,sCAAoB;AAA1C,iBAHO,EAIP;AACA;AAAE,2BAAS,UAAX;AAAuB,sCAAoB;AAA3C,iBALO;AADR,eAFmB,CAAxB;AAYD,aAbD,MAaO,IAAI1R,MAAM,CAACmK,WAAP,OAAyB,UAA7B,EAAyC;AAC9C,mBAAKsR,mBAAL,GAAwBnW,gCACnB,KAAKmW,mBADc,GAEnB;AACD/J,uBAAO,EAAE,CACT;AACE;AAAE,2BAAS,UAAX;AAAuB,sCAAoB;AAA3C,iBAFO;AADR,eAFmB,CAAxB;AASD,aAVM,MAUA,IAAG1R,MAAM,CAACmK,WAAP,OAAyB,UAA5B,EAAuC;AAC5C,mBAAKsR,mBAAL,GAAwBnW,gCACnB,KAAKmW,mBADc,GAEnB;AACD/J,uBAAO,EAAE;AADR,eAFmB,CAAxB;AAMD,aAPM,MAOA;AACL,mBAAK+J,mBAAL,GAAwBnW,gCACnB,KAAKmW,mBADc,GAEnB;AACD/J,uBAAO,EAAE,CACP;AAAE,2BAAS,mBAAX;AAAgC,sCAAoB;AAApD,iBADO,EAEP;AAAE,2BAAS,QAAX;AAAqB,sCAAoB,OAAzC;AAAkD,2BAAS;AAA3D,iBAFO,EAGP;AAAE,2BAAS,SAAX;AAAsB,sCAAoB;AAA1C,iBAHO,EAIP;AACA;AAAE,2BAAS,UAAX;AAAuB,sCAAoB;AAA3C,iBALO;AADR,eAFmB,CAAxB;AAYD;AAEF;AAED;;;;;;;iBAIA,iBAAQgC,MAAR,EAAwBgI,SAAxB,EAAwC;AACtC,gBAAGhI,MAAM,KAAK,QAAd,EAAwB;AACtB,mBAAK7Q,MAAL,CAAYwE,QAAZ,CAAqB,CAAE,kBAAF,CAArB,EAA6C;AAAEoF,2BAAW,EAAE;AAAE,4BAAU,KAAKxF;AAAjB;AAAf,eAA7C;AACD,aAFD,MAEO;AACL,mBAAKpE,MAAL,CAAYwE,QAAZ,CAAqB,0BAAoBqU,SAApB,EAArB;AACD;AACF;AAED;;;;;;iBAGA,uBAAW;AACT,iBAAK5Y,aAAL,CAAmBsB,WAAnB,CAA+BqJ,WAA/B;AACA,iBAAK1K,cAAL,CAAoB2C,QAApB,CAA6B,aAA7B,EAA4C,CAAE,4BAAF,EAAgC,eAAhC,CAA5C;AACA,iBAAK5C,aAAL,CAAmBuH,UAAnB,GAAgC,KAAhC;AACD;AAED;;;;;;;iBAIA,wBAAY;AACV,gBAAG,KAAK0P,cAAL,KAAwB,UAA3B,EAAuC;AACrC,qBAAO,IAAP;AACD;;AACD,mBAAO,KAAP;AACD;AAED;;;;;;;iBAIA,6BAAiB;;;AACf,gBAAG,YAAKtP,UAAL,MAAe,IAAf,IAAexC,aAAf,GAAe,MAAf,GAAeA,GAAEkC,WAAF,EAAf,MAAmC,iBAAtC,EAAyD;AACvD,qBAAO,IAAP;AACD;;AACD,mBAAO,KAAP;AACD;;;;;;;yBArrBQqL,6BAA0BZ;AAAA;;;cAA1BY;AAA0BlW;AAAAqO;AAAA;uEA+D1BgO,qHAAwB;;;;;;;;;;;;;;;qBA/DxBC;AAA8B;AAAA,qBAA9BA,sBAA8B;AAAZ;;;;;;;;;;;ADhC/BhH;;AAqEAA;;AACAA;;;;AAtE2EA;;AAqEzDA;;AAAAA;;AACAA;;AAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UE7DLiH;AACX;;;;AAIA,yCAAoB/Y,aAApB,EAAgD;AAAA;;AAA5B;AAAiC;AACrD;;;;;;;;iBAIA,mBAAO;AAAA;;AACL,iBAAKA,aAAL,CAAmB6D,WAAnB;AACA,mBAAO,KAAK7D,aAAL,CAAmBgZ,YAAnB,GAAkC9H,IAAlC,CACL,2CAAI,UAACvP,GAAD,EAAQ;AACV,qBAAI,CAAC3B,aAAL,CAAmBwE,WAAnB;;AACA,kBAAMyU,YAAY,GAAGC,YAAY,CAACtC,OAAb,CAAqB,YAArB,CAArB;AACA,kBAAMuC,UAAU,GAAGxX,GAAG,CAACyX,aAAvB;;AACA,kBAAIH,YAAY,IAAIA,YAAY,IAAIE,UAApC,EAAgD;AAC9CD,4BAAY,CAACpF,OAAb,CAAqB,YAArB,EAAmCqF,UAAnC;AACA1V,0BAAU,CAAC,YAAK;AACdoS,0BAAQ,CAACwD,MAAT;AACD,iBAFS,EAEP,EAFO,CAAV;AAGA,uBAAO,0CAAG,uBAAH,CAAP;AACD,eAND,MAMO;AACLH,4BAAY,CAACpF,OAAb,CAAqB,YAArB,EAAmCqF,UAAnC;AACA,uBAAO,0CAAG,8BAAH,CAAP;AACD;AACF,aAdD,CADK,EAgBL,kDAAW,YAAK;AACd,qBAAI,CAACnZ,aAAL,CAAmBwE,WAAnB;;AACA,qBAAO,0CAAG,iCAAH,CAAP;AACD,aAHD,CAhBK,CAAP;AAqBD;;;;;;;yBAjCUuU,yBAAsBO;AAAA;;;eAAtBP;AAAsB/a,iBAAtB+a,uBAAsB;AAAAQ,oBAFrB;;;;","names":["ComponentCanDeactivateComponent","selectors","decls","vars","template","encapsulation","FormCanDeactivate","checkDataChanged","_component_can_deactivate__WEBPACK_IMPORTED_MODULE_0__","RepairEstimateDialogData","approve","status","info","buttonModel","label","type","icon","imageGallery","gallery","reject","close","complete","MyHammerConfig","_angular_platform_browser__WEBPACK_IMPORTED_MODULE_12__","t","factory","casesRoutes","path","component","_chq_new_customer_chq_new_customer_component__WEBPACK_IMPORTED_MODULE_2__","canDeactivate","src_app_guards_deactivate_gaurd_deactivate_gaurd_guard__WEBPACK_IMPORTED_MODULE_5__","resolve","version","src_app_resolvers_versionControl_resolver__WEBPACK_IMPORTED_MODULE_7__","_chq_new_vehicle_chq_new_vehicle_component__WEBPACK_IMPORTED_MODULE_3__","src_app_shared_new_documents_new_documents_component__WEBPACK_IMPORTED_MODULE_11__","src_app_shared_new_photos_new_photos_component__WEBPACK_IMPORTED_MODULE_10__","_chq_repair_estimate_chq_repair_estimate_component__WEBPACK_IMPORTED_MODULE_4__","ChqNewCaseModule","provide","useClass","imports","_angular_common__WEBPACK_IMPORTED_MODULE_14__","_angular_material_icon__WEBPACK_IMPORTED_MODULE_15__","src_app_icons_module__WEBPACK_IMPORTED_MODULE_1__","src_app_shared_shared_module__WEBPACK_IMPORTED_MODULE_9__","_angular_router__WEBPACK_IMPORTED_MODULE_16__","src_app_widgets_chq_widgets_module__WEBPACK_IMPORTED_MODULE_0__","src_app_shared_error_page_error_module__WEBPACK_IMPORTED_MODULE_8__","_ngx_translate_core__WEBPACK_IMPORTED_MODULE_17__","declarations","src_app_dialogs_form_data_dialog_form_data_dialog_form_data_dialog_component__WEBPACK_IMPORTED_MODULE_6__","_angular_core__WEBPACK_IMPORTED_MODULE_10__","ctx_r5","ChqNewCustomerComponent","router","commonService","monitorService","caseService","coreService","route","_chq_new_customer_form_data_helper__WEBPACK_IMPORTED_MODULE_1__","jobNumber","companyOrgType","claimNumber","companyName","tariffId","isTariffEditable","licenseId","firstName","lastName","companyId","partnershipId","customerTypeID","driverCode","driverPhone","carOwnerSelector","email","accessRight","closed","rxjs_internal_BehaviorSubject__WEBPACK_IMPORTED_MODULE_11__","userProfileData","subscribe","res","data","organizationDetail","currentOrgId","id","isFormConfirmed","originalData","compareObjects","customerFormData","checkDataDirty","o1","o2","keys","Object","p","key","updatePage","logEvent","caseId","formModel","selectedOption","displayValue","k","mode","confirmButtonModel","selectObj","fieldValue","observable","name","getProviders","setTimeout","orgType","triggerObservable","updateButton","showLoading","formData","toString","isRetailAndCompanyProvider","repairPermission","caseObjectId","caseGuid","updateCase","next","result","navigate","hideLoading","error","err","logException","_microsoft_applicationinsights_web__WEBPACK_IMPORTED_MODULE_12__","saveNewCase","header","caseNumber","replaceUrl","closeDropdown","companyOrg","_a","_b","_c","_d","items","length","selectedItem","filter","it","phoneCountryCode","output","validationPattern","updateCurrentValidation","parent","snapshot","paramMap","get","setPrefillData","value","oldValue","keyValue","setUnTouched","onObservableLoad","updateCaseData","bind","placeHolder","getCompanyData","currentStatus","resp","checkForFormValidation","keyFieldValue","isValid","caseResponse","indexOf","toLowerCase","organizationId","isViewOnly","_e","isApiLoading","getCaseDetail","caseStatus","inspections","inspectionId","setTextMode","formDataFromResponse","JSON","parse","stringify","obj","checkRouteParams","prefillData","getSessionStorage","prefillObj","phoneNumber","code","substring","code1","currentPhoneNumber","_f","_g","parseInt","make","model","vin","plate","setSessionStorage","defaultObject","keysToAvoid","retail","push","prop","validationStatus","queryParams","params","codeParam","disabled","validation","onclick","confirmData","nextButtonModel","navigateToVehicle","getPhoneNumber","loadCaseDetails","showNoAccess","container","document","querySelector","scrollTop","unsubscribe","src_app_guards_deactivate_gaurd_form_can_deactivate__WEBPACK_IMPORTED_MODULE_0__","viewQuery","_angular_core__WEBPACK_IMPORTED_MODULE_13__","ChqNewVehicleComponent","vehicleService","inspectionService","labourService","mediaCollectionService","cd","src_app_helper_form_vehicle_form_helper__WEBPACK_IMPORTED_MODULE_0__","year","carMilege","licensePlate","registrationDate","eventfromToastComponent$","event","rxjs__WEBPACK_IMPORTED_MODULE_14__","userPermission","vehicleSourceType","estimateId","orgPackages","repairEstimatePackage","orgPackage","automotiveServiceName","permissions","gtEstimatePermission","perm","permissionName","populateReadonlyFields","then","vehicleId","vehicleHeader","vinNumber","licensePlateNumber","vehicleMileage","vehicleMake","vehicleModel","modelYear","tariffs","domainID","umc","infoDisabled","searchDisabled","inputDisabled","preventVinCall","originalVin","labourData","customerName","caseDetail","caseCreatedDate","createdDate","modelYearRange","isEditable","originalTariffObject","dayjs__WEBPACK_IMPORTED_MODULE_1__","format","vehicleFormData","validate","prefillVehicleData","populateDropdowns","importInterval","makeDisabled","enableDropdowns","getVehicleMake","options","sort","a","b","localeCompare","makeList","selectedMake","q","getVehicleModel","getVehicleYearByModel","navigateToDocument","getInspectionTemplateList","inspectionList","repairInspectionTemplate","inspectionTemplateId","process","getVinDecoder","success","updateVehicle","Number","addVehicle","inspectionGuid","vinGTMotive","inspection","tariffLabourRates","getLabourData","mainFormData","updateVehicleCase","showMessage","forEach","element","amount","action","showInfoToast","modelDisabled","yearDisabled","populateForm","toLocaleString","pipe","resetDropdown","message","dropdownValidationMessage","dropdownContainer","dropdownConfig","isTouched","isDirty","tariffDiscountRates","tariffLaborRates","getMediaTemplate","response","_angular_core__WEBPACK_IMPORTED_MODULE_17__","ctx_r3","ctx_r4","ctx_r18","ctx_r33","ctx_r0","ctx_r1","repairEstimate","title","step","description","stepName","ChqRepairEstimateComponent","repairEstimateService","dialog","src_app_model_chq_repair_dialog_model__WEBPACK_IMPORTED_MODULE_0__","appearance","placeHolderIcon","rxjs__WEBPACK_IMPORTED_MODULE_18__","i18n","geti18nInfo","includes","navigator","platform","userAgent","isInitCalled","isiOS","orgName","estimateResponse","estimateCharges","getEstimationDetail","sessionStorage","setItem","detectChanges","showGen","$event","showDamageAnalysis","back","closeCaseButton","approveCaseButton","rejectButton","calculationButton","editGtMotive","createBooking","viewBooking","repairId","showChangeWarningMessage","redirectToGtEstimate","src_app_model_chq_upload_model__WEBPACK_IMPORTED_MODULE_4__","dialogData","booking","dialogRef","open","src_app_widgets_chq_repair_dialog_chq_repair_dialog_component__WEBPACK_IMPORTED_MODULE_1__","autoFocus","afterClosed","updateCaseStatus","toggleOption","relativeTo","send","queryParamsHandling","createEstimate","domainId","location","href","url","apiCall","window","history","isHistoryLoading","getCaseHistory","repairGuid","caseResult","customerData","initial","toUpperCase","pageReady","isUpdate","getItem","readUpdateEstimate","getEstimate","caseData","modelCode","estimateSource","externalSource","currencyCode","currencySymbol","showConfirmationPopup","getInspection","showData","apiData","inspectionTemplate","getInspectionTemplate","inspectionDetail","resultMap","inspectionTemplateDetail","inspectionItemTemplates","inspectionItems","bulkUploadTemplateItem","images","inspectionItemTemplateID","rawAzureBlobUrl","map","showInspection","src_app_dialogs_gt_motive_estimation_dialog_gt_motive_estimation_dialog_component__WEBPACK_IMPORTED_MODULE_3__","disableClose","backdropClass","console","log","dropdownModelFilter","bookingId","src_app_widgets_chq_pdf_generator_chq_pdf_generator_component__WEBPACK_IMPORTED_MODULE_2__","ctx","VersionControlResolver","checkVersion","localVersion","localStorage","appVersion","buildRevision","reload","_angular_core__WEBPACK_IMPORTED_MODULE_4__","providedIn"],"sources":["webpack:///src/app/guards/deactivate-gaurd/component-can-deactivate.ts","webpack:///src/app/guards/deactivate-gaurd/form-can-deactivate.ts","webpack:///src/app/model/chq-repair-dialog-model.ts","webpack:///src/app/modules/quote/chq-new-cases/chq-new-case.module.ts","webpack:///src/app/modules/quote/chq-new-cases/chq-new-customer/chq-new-customer.component.html","webpack:///src/app/modules/quote/chq-new-cases/chq-new-customer/chq-new-customer.component.ts","webpack:///src/app/modules/quote/chq-new-cases/chq-new-vehicle/chq-new-vehicle.component.html","webpack:///src/app/modules/quote/chq-new-cases/chq-new-vehicle/chq-new-vehicle.component.ts","webpack:///src/app/modules/quote/chq-new-cases/chq-repair-estimate/chq-repair-estimate.component.html","webpack:///src/app/modules/quote/chq-new-cases/chq-repair-estimate/chq-repair-estimate.component.ts","webpack:///src/app/resolvers/versionControl.resolver.ts"],"sourcesContent":["import { Component, HostListener } from '@angular/core';\r\n\r\n@Component({\r\n  template: ''\r\n})\r\n\r\nexport abstract class ComponentCanDeactivateComponent {\r\n \r\n abstract canDeactivate(): boolean;\r\n\r\n \r\n}","import { NgForm } from '@angular/forms';\r\nimport { ComponentCanDeactivateComponent } from './component-can-deactivate';\r\n\r\nexport abstract class FormCanDeactivate extends ComponentCanDeactivateComponent{\r\n\r\n  abstract checkDataChanged():boolean;\r\n \r\n  /**\r\n   * can Deactiate\r\n   * @returns boolean\r\n   */\r\n  canDeactivate():boolean{\r\n    return !this.checkDataChanged();\r\n  }\r\n}","import { ChqWidgetsButtonModel } from './chq-widgets-button-model';\r\n\r\nexport const RepairEstimateDialogData: RepairEstimateDialogDataModel = {\r\n  approve: {\r\n    status: 'Approve Case',\r\n    info: 'Please fill out a reason why you are approving this case.',\r\n    buttonModel: {\r\n      label: 'Approve Case',\r\n      type: 'success',\r\n      icon: 'check',\r\n    },\r\n    imageGallery: false,\r\n    gallery: []\r\n  },\r\n  reject: {\r\n    status: 'Reject Case',\r\n    info: 'Please fill out a reason why you are rejecting this case.',\r\n    buttonModel: {\r\n      label: 'Reject Case',\r\n      type: 'red',\r\n      icon: 'cross',\r\n    },\r\n    imageGallery: false,\r\n    gallery: []\r\n  },\r\n  close: {\r\n    status: 'Close Case',\r\n    info: 'Please fill out a reason why you are closing this case.',\r\n    buttonModel: {\r\n      label: 'Close Case',\r\n      type: 'primary',\r\n      icon: 'folder-plus',\r\n    },\r\n    imageGallery: false,\r\n    gallery: [],\r\n  },\r\n  complete: {\r\n    status: 'Complete Case',\r\n    info: 'Please fill out a reason why you are completing this case.',\r\n    buttonModel: {\r\n      label: 'Complete Case',\r\n      type: 'primary',\r\n      icon: 'folder-plus',\r\n    },\r\n    imageGallery: false,\r\n    gallery: [],\r\n  }\r\n};\r\n\r\nexport interface RepairEstimateDialogDataModel {\r\n    approve: DialogModel,\r\n    reject: DialogModel,\r\n    close: DialogModel,\r\n    complete: DialogModel\r\n}\r\n\r\nexport interface DialogModel {\r\n    status: string;\r\n    info: string;\r\n    buttonModel: ChqWidgetsButtonModel;\r\n    imageGallery: boolean;\r\n    gallery: any;\r\n    comment?: string;\r\n    email?:string;\r\n}\r\n","import { Injectable, NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { Route, RouterModule } from '@angular/router';\r\nimport { WidgetsModule } from 'src/app/widgets/chq-widgets.module';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { IconsModule } from 'src/app/icons.module';\r\nimport { ChqNewCustomerComponent } from './chq-new-customer/chq-new-customer.component';\r\nimport { ChqNewVehicleComponent } from './chq-new-vehicle/chq-new-vehicle.component';\r\nimport { ChqRepairEstimateComponent } from './chq-repair-estimate/chq-repair-estimate.component';\r\nimport { CanDeactivateGuard } from 'src/app/guards/deactivate-gaurd/deactivate-gaurd.guard';\r\nimport { FormDataDialogComponent } from 'src/app/dialogs/form-data-dialog/form-data-dialog/form-data-dialog.component';\r\nimport * as Hammer from 'hammerjs'\r\nimport { HammerGestureConfig, HammerModule, HAMMER_GESTURE_CONFIG } from '@angular/platform-browser';\r\nimport { VersionControlResolver } from 'src/app/resolvers/versionControl.resolver';\r\nimport { ErrorModule } from 'src/app/shared/error-page/error.module';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\nimport { NewPhotosComponent } from 'src/app/shared/new-photos/new-photos.component';\r\nimport { NewDocumentsComponent } from 'src/app/shared/new-documents/new-documents.component';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { HistoryComponent } from 'src/app/shared/history/history.component';\r\n\r\n@Injectable()\r\nexport class MyHammerConfig extends HammerGestureConfig {\r\n  // override overrides = <any>{\r\n  //   'swipe': {\r\n  //     // override default settings\r\n  //     velocity: 0.4,\r\n  //     threshold: 20,\r\n  //     direction: Hammer.DIRECTION_ALL,\r\n  //     enabled: true\r\n  //   }\r\n  // }\r\n}\r\n\r\nconst casesRoutes: Route[] = [\r\n  {\r\n    path: '', component: ChqNewCustomerComponent,\r\n    canDeactivate: [ CanDeactivateGuard ],\r\n    resolve: { version: VersionControlResolver }\r\n  },\r\n  {\r\n    path: 'vehicle',\r\n    component: ChqNewVehicleComponent,\r\n    resolve: { version: VersionControlResolver }\r\n  },\r\n  {\r\n    path: 'document',\r\n    component: NewDocumentsComponent,\r\n    resolve: { version: VersionControlResolver }\r\n  },\r\n  {\r\n    path: 'photos',\r\n    component: NewPhotosComponent,\r\n    resolve: { version: VersionControlResolver }\r\n  },\r\n  {\r\n    path: 'estimate',\r\n    component: ChqRepairEstimateComponent,\r\n    resolve: { version: VersionControlResolver }\r\n  },\r\n  {\r\n    path: 'refresh',\r\n    component: ChqNewCustomerComponent\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  declarations: [ ChqNewCustomerComponent, ChqNewVehicleComponent, ChqRepairEstimateComponent, FormDataDialogComponent ],\r\n  imports: [\r\n    HammerModule,\r\n    CommonModule,\r\n    MatIconModule,\r\n    IconsModule,\r\n    SharedModule,\r\n    RouterModule.forChild(casesRoutes),\r\n    WidgetsModule,\r\n    ErrorModule,\r\n    TranslateModule,\r\n  ],\r\n  providers: [ CanDeactivateGuard,\r\n    {\r\n      provide: HAMMER_GESTURE_CONFIG,\r\n      useClass: MyHammerConfig\r\n    }\r\n  ]\r\n})\r\nexport class ChqNewCaseModule { }\r\n","<div class=\"new-case-container mh-0\" *ngIf=\"!isApiLoading && !showNoAccess\" [ngClass]=\"{'text-mode':isFormConfirmed}\">\r\n  <chq-step-header [chqModel]=\"header\"></chq-step-header>\r\n  <form class=\"form-container\">\r\n    <div class=\"row\">\r\n      <div class=\"job-number col-3\">\r\n        <chq-input [inputModel]=\"formModel.jobNumber\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n      </div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"work-provider col-6\">\r\n        <div class=\"work-input-wrapper row\">\r\n          <label class=\"col-12 sub-heading\">{{'work_provider_details' | translate}}</label>\r\n          <chq-input class=\"col-6\" (clicked)=\"hideDropdown($event);\" #orgType [inputModel]=\"formModel.companyOrgType\" (controlOutput)=\"onFormUpdate($event)\"\r\n          ></chq-input>\r\n          <chq-input class=\"col-6\" *ngIf=\"customerFormData['companyOrgType'] ==='Insurance Company'\" [inputModel]=\"formModel.claimNumber\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"row\" [ngClass]=\"{'hide':isFormConfirmed}\" *ngIf=\"isRetailProvider\">\r\n      <div class=\"insurer-details col-12\">\r\n        <div class=\"insurance-input-wrapper row\">\r\n          <label class=\"col-12 sub-heading\">{{'car_owner_details' | translate}}</label>\r\n          <chq-input\r\n            class=\"company-input col-3\"\r\n            [inputModel]=\"formModel.carOwnerSelector\" (controlOutput)=\"onFormUpdate($event)\"\r\n          ></chq-input>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"row\" *ngIf=\" !isRetailProvider || (customerFormData[formModel.carOwnerSelector.name] && customerFormData[formModel.carOwnerSelector.name] !== 'Person')\">\r\n      <div class=\"insurer-details col-12\">\r\n        <div class=\"insurance-input-wrapper row\">\r\n          <label class=\"col-12 sub-heading\">{{isRetailProvider && isFormConfirmed ? 'car_owner_details':'company_details' | translate}}</label>\r\n          <chq-input\r\n           #companyOrg\r\n            class=\"company-input col-6\"\r\n            (clicked)=\"hideDropdown($event);\"\r\n            [inputModel]=\"formModel.companyName\" (controlOutput)=\"onFormUpdate($event)\"\r\n          ></chq-input>\r\n          <chq-input\r\n            class=\"col-6\"\r\n            #licenseId\r\n            [ngClass]=\"{'disable-input disable-controls' : formModel.companyName.type ==='select' }\"\r\n            [inputModel]=\"formModel.licenseId\" (controlOutput)=\"onFormUpdate($event)\"\r\n          ></chq-input>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"row\">\r\n      <div class=\"driver-details col-12\">\r\n        <div class=\"driver-input-wrapper row\">\r\n          <label class=\"col-12 sub-heading\">{{isRetailProvider && isFormConfirmed && (customerFormData[formModel.carOwnerSelector.name] && customerFormData[formModel.carOwnerSelector.name] === 'Person')  ? 'car_owner_details': 'drivers_details'  | translate}}</label>\r\n          <div class=\"driver-fields-wrapper\">\r\n            <chq-input class=\"driver-field\" [inputModel]=\"formModel.firstName\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n            <chq-input class=\"driver-field\" [inputModel]=\"formModel.lastName\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n          </div>\r\n        </div>\r\n        <div class=\"driver-address-wrapper row\">\r\n          <div class=\"driver-fields-wrapper\">\r\n            <chq-input class=\"driver-field basis-272\" [inputModel]=\"formModel.email\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n            <div class=\"driver-field basis-272\">\r\n              <div class=\"driver-fields-wrapper\">\r\n                <chq-input class=\"driver-field  driver-code-field no-padding\" (clicked)=\"hideDropdown($event);\" [inputModel]=\"formModel.driverCode\"  #driverCode (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n                <chq-input class=\"driver-field no-padding\" [inputModel]=\"formModel.driverPhone\" #driverPhone (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n            </div>\r\n            </div>\r\n          </div>\r\n          <!-- <chq-input class=\"col-6\" [inputModel]=\"formModel.address\" (controlOutput)=\"onFormUpdate($event)\"></chq-input> -->\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </form>\r\n  <div class=\"footer-full-wrapper\">\r\n    <div class=\"footer-image-wrapper\">\r\n        <div class=\"image-wrapper\">\r\n            <img src=\"assets/img/addenda-quote.png\" />\r\n        </div>\r\n    </div>\r\n    <div class=\"footer-button-wrapper\">\r\n      <chq-button *ngIf=\"currentCaseStatus\"  [buttonModel]=\"confirmButtonModel\"></chq-button>\r\n      <chq-button *ngIf=\"isFormConfirmed && !this.commonService.isViewOnly\" [buttonModel]=\"nextButtonModel\"></chq-button>\r\n    </div>\r\n  </div>\r\n</div>\r\n<no-access-error *ngIf=\"showNoAccess\"></no-access-error>\r\n","import { AfterViewInit, Component, OnDestroy, OnInit, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { SeverityLevel } from '@microsoft/applicationinsights-web';\r\nimport { BehaviorSubject } from 'rxjs/internal/BehaviorSubject';\r\nimport { FormCanDeactivate } from 'src/app/guards/deactivate-gaurd/form-can-deactivate';\r\nimport { AddCustomerData, AddCustomerForm, CustomerFormData } from 'src/app/model/chq-new-case-form.model';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { ChqWidgetsHeaderModel } from 'src/app/model/chq-widgets-header-model';\r\nimport { IControlValue } from 'src/app/model/chq-widgets-input-model';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\nimport { CoreService } from 'src/app/services/core/core.service.service';\r\nimport { MonitorService } from 'src/app/services/monitor-service/monitor.service';\r\nimport { ChqInputComponent } from 'src/app/widgets/chq-input/chq-input.component';\r\nimport { caseDataMapper, caseResponseMapper, newCaseForm, newCaseHeader } from './chq-new-customer-form-data-helper';\r\n\r\n@Component({\r\n  selector: 'chq-new-case',\r\n  templateUrl: './chq-new-customer.component.html',\r\n  styleUrls: [ './chq-new-customer.component.scss' ],\r\n})\r\nexport class ChqNewCustomerComponent extends FormCanDeactivate implements OnInit, AfterViewInit, OnDestroy {\r\n  public header: ChqWidgetsHeaderModel = newCaseHeader;\r\n  public formModel?: AddCustomerForm;\r\n  public caseResponse: any;\r\n  public isApiLoading = true;\r\n  public originalData?:CustomerFormData;\r\n  public formDataFromResponse: AddCustomerData;\r\n  public confirmButtonModel: ChqWidgetsButtonModel = {\r\n    label: '',\r\n    type: 'primary'\r\n  }\r\n  public nextButtonModel: ChqWidgetsButtonModel = {\r\n    label: '',\r\n    type: 'primary'\r\n  }\r\n  public isFormConfirmed: boolean = false;\r\n  public isRetail: boolean = true;\r\n  public isScrolling:any;\r\n  @ViewChild('companyOrg') companyOrg: ChqInputComponent; \r\n  @ViewChild('licenseId') licenseId: ChqInputComponent;\r\n  public customerFormData: CustomerFormData = {\r\n    jobNumber: '',\r\n    companyOrgType: '',\r\n    claimNumber: '',\r\n    companyName: '',\r\n    tariffId: 0,\r\n    isTariffEditable: true,\r\n    licenseId: '',\r\n    firstName: '',\r\n    lastName: '',\r\n    companyId: 0,\r\n    partnershipId: 0,\r\n    customerTypeID: 1,\r\n    driverCode: '',\r\n    driverPhone: 0,\r\n    carOwnerSelector: '',\r\n    email: ''\r\n  };\r\n  public caseId = '0';\r\n  public caseObjectId = 0;\r\n  public showNoAccess: boolean = false;\r\n  private currentOrgId: number;\r\n\r\n  @ViewChild('driverPhone') driverPhone: ChqInputComponent;\r\n  @ViewChild('driverCode') driverCode: ChqInputComponent;\r\n  @ViewChild('orgType') orgType: ChqInputComponent;\r\n\r\n  /**\r\n   * constructor\r\n   * @param router \r\n   */\r\n  constructor(\r\n    private router: Router, public commonService: CommonService,\r\n    private monitorService:MonitorService,\r\n    private caseService: CaseService, private coreService: CoreService,\r\n    private route:ActivatedRoute\r\n  ) {\r\n    super();\r\n    if(this.commonService.accessRight.closed) {\r\n      this.commonService.accessRight = new BehaviorSubject<boolean>(true);\r\n    }\r\n\r\n    this.commonService.userProfileData.subscribe((res) => {\r\n      if (res && res.data) {\r\n        const { organizationDetail } = res.data;\r\n\r\n        if (organizationDetail) {\r\n          this.currentOrgId = organizationDetail.id;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * check data changed\r\n   */\r\n  checkDataChanged():boolean{\r\n    if(this.isFormConfirmed){\r\n      return false;\r\n    }else if(this.originalData){\r\n      return this.compareObjects(this.originalData, this.customerFormData);\r\n    }else if(this.checkDataDirty()){\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * compare objects\r\n   */\r\n  compareObjects(o1:CustomerFormData, o2:CustomerFormData):boolean{\r\n    const keys = Object.keys(o1);\r\n    for(const p in keys){\r\n      const key = keys[p];\r\n      if(o1[key] !== o2[key]){\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  } \r\n\r\n  /**\r\n   * get is Retail\r\n   */\r\n  get isRetailProvider(): boolean {\r\n    if (!this.customerFormData.companyOrgType) {\r\n      return false;\r\n    }\r\n    return this.customerFormData['companyOrgType'] === 'Retail';\r\n  }\r\n\r\n  /**\r\n   * ngAfterViewInit hook\r\n   * @param fb FormBuilder \r\n   */\r\n  ngAfterViewInit(): void {\r\n    this.commonService.updatePage('/quote/case/0');\r\n    this.monitorService.logEvent('ngAfterViewInit', [ 'ChqNewCustomerComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * get is Retail\r\n   */\r\n  get isRetailAndCompanyProvider(): boolean {\r\n    if (!this.customerFormData.companyOrgType) {\r\n      return false;\r\n    }\r\n    return this.customerFormData['companyOrgType'] !== 'Retail'\r\n      || (this.customerFormData['companyOrgType'] === 'Retail' && this.customerFormData['carOwnerSelector']\r\n       && this.customerFormData['carOwnerSelector'] !== 'Person');\r\n  }\r\n\r\n  /**\r\n   * get retail\r\n   */\r\n  get retail(): string{\r\n    if (!this.customerFormData.companyOrgType) {\r\n      return '';\r\n    }\r\n    return this.formModel.companyOrgType.selectedOption[this.formModel.companyOrgType.displayValue];\r\n  }\r\n\r\n  /**\r\n   * update button\r\n   */\r\n  public updateButton(): void{\r\n    const keys = Object.keys(this.formModel);\r\n    for (const k in keys) {\r\n      const key = keys[k];\r\n      this.formModel[key] = {\r\n        ...this.formModel[key],\r\n        mode: this.isFormConfirmed ? 'value' : 'text',\r\n      };\r\n    }\r\n    this.isFormConfirmed = !this.isFormConfirmed;\r\n    this.confirmButtonModel = {\r\n      ...this.confirmButtonModel, label: this.isFormConfirmed ? 'Change details' : 'Confirm',\r\n      type: this.isFormConfirmed ? 'outline' : 'primary', icon: this.isFormConfirmed ? 'gobackward' : 'check'\r\n    };\r\n    this.monitorService.logEvent('updateButton', [ 'ChqNewCustomerComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n  }\r\n\r\n  /**\r\n   * setTextMode\r\n   */\r\n  public setTextMode(): void{\r\n    const keys = Object.keys(this.formModel);\r\n    for (const k in keys) {\r\n      const key = keys[k];\r\n      if(key ==='companyOrgType'){\r\n        const selectObj = {};\r\n        const { displayValue, fieldValue } = this.formModel[key];\r\n        selectObj[fieldValue] = this.customerFormData[key];\r\n        selectObj[displayValue] = '';\r\n        selectObj[displayValue] = this.customerFormData[key];\r\n        this.formModel[key] = {\r\n          ...this.formModel[key],\r\n          mode: 'text',\r\n          selectedOption: selectObj\r\n        };\r\n      }else{\r\n        this.formModel[key] = {\r\n          ...this.formModel[key],\r\n          mode: 'text',\r\n        };\r\n      }\r\n     \r\n      \r\n    }\r\n\r\n    this.confirmButtonModel = {\r\n      ...this.confirmButtonModel, label: 'Change details',\r\n      type: 'outline', icon: 'gobackward'\r\n    };\r\n    this.monitorService.logEvent('setTextMode', [ 'ChqNewCustomerComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n  }\r\n  /**\r\n   * handles confirm click\r\n   * returns void\r\n   */\r\n  public confirmData(): void {\r\n\r\n    this.monitorService.logEvent('confirmData', [ 'ChqNewCustomerComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n\r\n    if (this.isFormConfirmed) {\r\n      if (!this.formModel.companyOrgType.observable) {\r\n        this.formModel.companyOrgType.selectedOption.name = '';\r\n        this.formModel.companyOrgType.observable = this.caseService.getProviders();\r\n        setTimeout(()=>{\r\n          this.orgType.triggerObservable();\r\n        })\r\n       \r\n      }\r\n      \r\n      this.updateButton();\r\n      return;\r\n    }\r\n    this.commonService.showLoading();\r\n    const formData:AddCustomerData = {\r\n      'companyOrgType': this.customerFormData['companyOrgType'],\r\n      'caseTypeID': 1,\r\n      'customerTypeID': this.customerFormData['companyOrgType'] === 'Retail'? this.customerFormData.customerTypeID:null,\r\n      'domainID': 2100,\r\n      'tariffId': this.customerFormData.tariffId,\r\n      'isTariffEditable': this.customerFormData.isTariffEditable,\r\n      'firstName': this.customerFormData.firstName,\r\n      'lastName': this.customerFormData.lastName,\r\n      'countryCode': this.customerFormData.driverCode,\r\n      'mobileNumber': this.customerFormData.driverPhone.toString(),\r\n      'email': this.customerFormData.email,\r\n      'companyId': this.customerFormData.companyId,\r\n      'partnershipId': this.customerFormData.partnershipId,\r\n      'claimNumber': this.customerFormData['companyOrgType'] === 'Insurance Company'?this.customerFormData.claimNumber:'',\r\n      'companyName': !this.isRetailAndCompanyProvider?'': this.customerFormData.companyName,\r\n      'companyLicenseNumber': !this.isRetailAndCompanyProvider? '':this.customerFormData.licenseId\r\n    }\r\n    if(!this.commonService.repairPermission) {\r\n      formData['externalID'] = this.customerFormData.jobNumber;\r\n    }\r\n    if (this.caseId != '0') {\r\n      formData.caseId = this.caseObjectId;\r\n      formData.caseGuid = this.caseId;\r\n      this.caseService.updateCase(formData).subscribe({\r\n        next: (result: any) => {\r\n          if (result) {\r\n            this.updateButton();\r\n            this.router.navigate([ `/quote/case/${this.caseId}/vehicle` ]);\r\n          }\r\n          this.commonService.hideLoading();\r\n        },\r\n        error: (err:any) => {\r\n          this.commonService.hideLoading();\r\n          this.monitorService.logException(err, SeverityLevel.Error);\r\n        }\r\n      });\r\n    } else {\r\n      this.caseService.saveNewCase(formData).subscribe({\r\n        next: (result: any) => {\r\n          if (result) {\r\n            this.caseId = result.data.caseGuid;\r\n            this.commonService.caseId.next(this.caseId);\r\n            this.caseObjectId = result.data.id;\r\n            this.header.caseNumber = result.data.caseNumber;\r\n            this.updateButton();\r\n            //sessionStorage.setItem('key', result.data.key);\r\n            this.router.navigate([ `/quote/case/${this.caseId}` ], { replaceUrl: true });\r\n            this.router.navigate([ `/quote/case/${this.caseId}/vehicle` ]);\r\n          }\r\n          this.commonService.hideLoading();\r\n        },\r\n        error: (err: any) => {        \r\n          this.commonService.hideLoading();\r\n          this.monitorService.logException(err, SeverityLevel.Error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * hide dropdown\r\n   */\r\n  hideDropdown(name:any):void{\r\n    if(name === this.formModel.companyOrgType.name){\r\n      this.driverCode.closeDropdown();\r\n      this.companyOrg?.closeDropdown();\r\n    }else if(name === this.formModel.companyName.name){\r\n      this.driverCode.closeDropdown();\r\n      this.orgType?.closeDropdown();\r\n    }else{\r\n      this.orgType?.closeDropdown();\r\n      this.companyOrg?.closeDropdown();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * on dropdown observable load\r\n   */\r\n  onObservableLoad(items: any): void {\r\n    this.commonService.hideLoading();\r\n    \r\n    if (!items) {\r\n      return;\r\n    }\r\n    if (items && items.length > 0) {\r\n      const selectedItem = items.filter((it: any) => {\r\n        return it.phoneCountryCode === this.formModel.driverCode.selectedOption?.phoneCountryCode;\r\n      });\r\n      if (selectedItem.length > 0) {\r\n        const output = selectedItem[0];\r\n        const validationPattern = output['regExpression'];        \r\n        this.formModel.driverCode = { ...this.formModel.driverCode, selectedOption: output };\r\n        this.driverPhone.updateCurrentValidation(validationPattern, true);\r\n      }\r\n      const caseId = this.route.parent?.snapshot.paramMap.get('id');  \r\n      if (!caseId || caseId === '0') {\r\n        this.setPrefillData(items);\r\n      }\r\n      \r\n    }\r\n  }\r\n\r\n  /**\r\n   * get Control Output\r\n  */\r\n  onFormUpdate(output: IControlValue): void {\r\n    this.monitorService.logEvent('onFormUpdate', [ 'ChqNewCustomerComponent', 'addenda-quote', {\r\n      caseId: this.caseId,\r\n      output\r\n    } ]);\r\n    if (output.name === 'driverCode') {\r\n      const validationPattern = output.value['regExpression'];      \r\n      this.driverPhone.updateCurrentValidation(validationPattern);\r\n    }\r\n    \r\n    if (output.type === 'select') {\r\n      const oldValue = this.customerFormData[output.name];\r\n      const keyValue = this.formModel[output.name].fieldValue || this.formModel[output.name].displayValue;\r\n      if(this.formModel[output.name]?.selectedOption && this.formModel[output.name]?.selectedOption[keyValue] === output?.value[keyValue]) {\r\n        return;\r\n      }\r\n      this.formModel[output.name] = {\r\n        ...this.formModel[output.name], selectedOption: output.value\r\n      };\r\n      \r\n     \r\n      this.customerFormData[output.name] = output.value[keyValue];\r\n      if (output.name === 'companyOrgType') {\r\n        //this.formModel.companyOrgType.label = output.value[this.formModel[output.name].displayValue];\r\n        if(oldValue !== this.customerFormData[output.name]){\r\n          setTimeout(()=>{\r\n            this.companyOrg?.setUnTouched();\r\n            this.licenseId?.setUnTouched();\r\n          })\r\n          \r\n        }\r\n\r\n        if(output.value[keyValue] && output.value[this.formModel[output.name].displayValue] !== 'Insurance Company'){\r\n          this.formModel['claimNumber'] = {\r\n            ...this.formModel['claimNumber'],\r\n            value: ''\r\n          }\r\n        }\r\n        if (output.value[keyValue] && output.value[this.formModel[output.name].displayValue] !== 'Retail') {\r\n          this.formModel.companyName = {\r\n            ...this.formModel.companyName,\r\n            displayValue: 'companyName', fieldValue: 'companyName',\r\n            onObservableLoad: this.updateCaseData.bind(this),\r\n            placeHolder: 'Select...', value: '',\r\n            type: 'select', observable: this.caseService.getCompanyData(output.value[keyValue], '')\r\n          }\r\n          if (this.formModel.companyName.selectedOption && this.formModel.companyName.selectedOption?.tariffId) {\r\n            this.customerFormData.companyId = null;\r\n            this.customerFormData.companyName = null;\r\n            this.formModel.companyName.selectedOption = {};\r\n          }\r\n          this.customerFormData.licenseId = '';\r\n          this.formModel.licenseId = { ...this.formModel.licenseId, value: '' };\r\n          setTimeout(() => {\r\n            if(oldValue && oldValue !== 'Retail' && this.currentStatus){\r\n              this.companyOrg?.triggerObservable();\r\n            }\r\n          });\r\n        } else {\r\n          if (output.value[keyValue] && output.value[this.formModel[output.name].displayValue] === 'Retail') {\r\n            this.formModel['claimNumber'] = {\r\n              ...this.formModel['claimNumber'],\r\n              value: ''\r\n            };\r\n            this.formModel.companyName = {\r\n              ...this.formModel.companyName,\r\n              placeHolder: 'Company Name'\r\n            }\r\n            this.customerFormData.claimNumber = '';\r\n            if(this.currentStatus){\r\n              this.caseService.getCompanyData(output.value[keyValue], '').subscribe({\r\n                next: (resp: any) => {\r\n                  if (resp && resp.data?.length > 0) {\r\n                    const data = resp.data[0];\r\n                    this.customerFormData['companyId'] = data['companyId'];\r\n                    this.customerFormData['tariffId'] = data['tariffId'];\r\n                    if (this.formModel.companyName.selectedOption && this.formModel.companyName.selectedOption?.tariffId) {\r\n                      this.customerFormData.licenseId = '';\r\n                      this.formModel.licenseId = { ...this.formModel?.licenseId, value: '' };\r\n                    }\r\n                    if (this.customerFormData[this.formModel.carOwnerSelector.name] === 'Person') {\r\n                      this.customerFormData['companyName'] = null;\r\n                      this.formModel.companyName.value='';\r\n                    }\r\n                    this.customerFormData.isTariffEditable = data['isEditable'];\r\n                    this.customerFormData.partnershipId = data['partnershipId'];\r\n                    this.formModel.companyName.selectedOption = data[0];\r\n                    \r\n                 \r\n                    this.checkForFormValidation();\r\n                  }\r\n                 \r\n                }, error: () => {\r\n                  this.customerFormData['tariffId'] = 0;\r\n                  this.customerFormData.isTariffEditable = false;\r\n                }\r\n              });\r\n            }\r\n           \r\n          }\r\n          this.formModel.companyName = {\r\n            ...this.formModel.companyName, type: 'text'\r\n          }\r\n        }\r\n      }\r\n      if (output.name === 'companyName' && output.value) {\r\n        this.customerFormData['companyId'] = output.value['companyId'];\r\n        this.customerFormData['tariffId'] = output.value['tariffId'];\r\n        this.customerFormData.isTariffEditable = output.value['isEditable'];\r\n        this.customerFormData.licenseId = output.value['licenseId'].toString();\r\n        this.formModel.licenseId = { ...this.formModel?.licenseId, value: output.value['licenseId'].toString() };\r\n        this.customerFormData.partnershipId = output.value['partnershipId'];\r\n      }\r\n      this.customerFormData[this.formModel[output.name]['idField']] = output.value[this.formModel[output.name].displayValue];\r\n    } else {\r\n      if (output.name === 'carOwnerSelector' && output.keyFieldValue && this.formModel[output.name]['idField']) {\r\n        this.customerFormData[this.formModel[output.name]['idField']] = output.keyFieldValue;\r\n      }\r\n      if (output.isValid) {\r\n        this.formModel[output.name].value = output.value;\r\n        this.customerFormData[output.name] = output.value;\r\n      } else {\r\n        this.formModel[output.name].value = '';\r\n        if(output.name !== 'driverPhone'){\r\n          this.customerFormData[output.name] = '';\r\n        }else{\r\n          this.customerFormData[output.name] = 0;\r\n        }\r\n        \r\n      }\r\n     \r\n    }\r\n    this.customerFormData = { ...this.customerFormData };\r\n    this.checkForFormValidation();\r\n  }\r\n\r\n  /**\r\n   * navigate to vehicle\r\n   */\r\n  navigateToVehicle(): void {\r\n    this.monitorService.logEvent('navigateToVehicle', [ 'ChqNewCustomerComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n    this.router.navigate([ `/quote/case/${this.caseId}/vehicle` ]);\r\n  }\r\n\r\n  /**\r\n   * handle company observable load\r\n   */\r\n  updateCaseData(items: any):void {\r\n    if (items && this.customerFormData.companyId && !this.customerFormData['tariffId']) {\r\n      const selectedItem = items.filter((it: any) => {\r\n        return it.companyId === this.customerFormData.companyId\r\n      });\r\n      if (selectedItem.length > 0) {\r\n        this.customerFormData['tariffId'] = selectedItem[0]['tariffId'];\r\n        this.customerFormData.isTariffEditable = selectedItem[0]['isEditable'];\r\n        this.formModel.licenseId = { ...this.formModel?.licenseId, value: selectedItem[0]['licenseId'].toString() };\r\n        this.customerFormData.partnershipId = selectedItem[0]['partnershipId'];\r\n        this.formModel.companyName.selectedOption = selectedItem[0];\r\n      }\r\n     \r\n    } \r\n  }\r\n\r\n  /**\r\n   * is case pending\r\n   */\r\n  get currentStatus(): boolean {\r\n    if (!this.caseResponse?.status && !this.isFormConfirmed) {\r\n      return true;\r\n    }\r\n    return [ 'reject', 'rejected', 'approved', 'closed', 'repairestimation' ].indexOf(this.caseResponse?.status?.toLowerCase()) === -1\r\n     && !this.isFormConfirmed; \r\n  }\r\n\r\n  /**\r\n   * is case pending\r\n   */\r\n  get currentCaseStatus(): boolean {\r\n    if (!this.caseResponse?.status && this.currentOrgId === this.caseResponse?.organizationDetail?.organizationId) {\r\n      return true;\r\n    } else if(this.commonService.isViewOnly) {\r\n      return false;\r\n    }\r\n    return [ 'reject', 'rejected', 'approved', 'closed', 'repairestimation', 'complete' ].indexOf(this.caseResponse?.status?.toLowerCase()) === -1; \r\n  }\r\n\r\n  /**\r\n   * load caseDetail\r\n   */\r\n  loadCaseDetails():void {\r\n    const keys = Object.keys(this.formModel);\r\n    \r\n    const caseId = this.route.parent?.snapshot.paramMap.get('id');   \r\n    if (caseId && caseId != '0') {\r\n      this.caseId = caseId;\r\n      this.isApiLoading = true;\r\n      this.commonService.caseId.next(this.caseId);\r\n      \r\n      this.commonService.showLoading();\r\n      this.caseService.getCaseDetail(this.caseId).subscribe({\r\n        next: (result: any) => {\r\n          this.caseResponse = result.data;\r\n          this.caseObjectId = this.caseResponse.id;\r\n          this.commonService.caseStatus.next(this.caseResponse.status);\r\n          const inspections = this.caseResponse.inspections;\r\n          if(inspections.length > 0){\r\n            this.commonService.inspectionId.next(this.caseResponse.inspections[0].inspectionId);\r\n          }\r\n\r\n          if (this.currentOrgId != this.caseResponse?.organizationDetail?.organizationId) {\r\n            this.commonService.isViewOnly = true;\r\n          }else{\r\n            this.commonService.isViewOnly = false;\r\n          }\r\n\r\n          if (!this.currentStatus || this.commonService.isViewOnly) {\r\n            this.setTextMode();\r\n            this.isFormConfirmed = true;\r\n          }\r\n        \r\n          this.header.caseNumber = this.caseResponse.caseNumber;\r\n          this.formDataFromResponse = caseResponseMapper(this.caseResponse);\r\n          this.customerFormData = caseDataMapper(this.formDataFromResponse);\r\n          this.originalData = JSON.parse(JSON.stringify(this.customerFormData));\r\n          for (const k in keys) {\r\n            const obj = this.formModel[keys[k]];\r\n            const { type, displayValue, fieldValue } = obj\r\n            if (this.customerFormData[keys[k]]) {\r\n              if (type === 'select') {\r\n                const selectObj = {};\r\n                selectObj[displayValue] = '';\r\n                selectObj[fieldValue] = this.customerFormData[keys[k]];\r\n                if(!this.currentStatus && keys[k] ==='companyOrgType'){\r\n                  selectObj[displayValue] = this.customerFormData[keys[k]];\r\n                }\r\n                this.formModel[keys[k]] = {\r\n                  ...this.formModel[keys[k]],\r\n                  value: '',\r\n                  selectedOption: selectObj\r\n                };\r\n              } else {\r\n                let selectedOption = {};\r\n                if (keys[k] === 'companyName') {\r\n                  selectedOption={ 'companyName': this.customerFormData[keys[k]] }\r\n                }\r\n                this.formModel[keys[k]] = {\r\n                  ...this.formModel[keys[k]],\r\n                  value: this.customerFormData[keys[k]],\r\n                  selectedOption\r\n                };\r\n              }\r\n            \r\n            }\r\n          }\r\n          this.checkRouteParams();\r\n          \r\n          this.commonService.hideLoading();\r\n        },\r\n        error: () => {\r\n          this.commonService.hideLoading();\r\n        },\r\n        complete: () => {\r\n          this.isApiLoading = false;\r\n        }\r\n      });\r\n    } else {\r\n      this.isApiLoading = false;\r\n      if (!this.formModel.companyOrgType.observable) {\r\n        this.formModel.companyOrgType.observable = this.caseService.getProviders();\r\n      }\r\n      for (const k in keys) {\r\n        const key = keys[k];\r\n        if(key !=='driverCode'){\r\n          this.formModel[key] = {\r\n            ...this.formModel[key],\r\n            value: '',\r\n            selectedOption: {}\r\n          };\r\n        }else{\r\n          this.formModel[key] = {\r\n            ...this.formModel[key],\r\n            value: '',\r\n            selectedOption: { 'phoneCountryCode': '+91' }\r\n          };\r\n          this.customerFormData.driverCode = '+91';\r\n        }\r\n       \r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * prefill search data\r\n   */\r\n  setPrefillData(items:any):void{\r\n    const prefillData = this.commonService.getSessionStorage('selectedSearchItem');\r\n    if(prefillData){\r\n      const prefillObj = JSON.parse(prefillData);\r\n      this.formModel.email = {\r\n        ...this.formModel.email,\r\n        value: prefillObj.email,\r\n        selectedOption: {}\r\n      };\r\n      this.customerFormData.email = prefillObj.email;\r\n      if (prefillObj.firstName) {\r\n        this.customerFormData.firstName = prefillObj.firstName;\r\n        this.formModel.firstName = {\r\n          ...this.formModel.firstName,\r\n          value: this.customerFormData.firstName,\r\n          selectedOption: {}\r\n        };\r\n      }\r\n\r\n      if(prefillObj.lastName){\r\n        this.customerFormData.lastName = prefillObj.lastName;\r\n        this.formModel.lastName = {\r\n          ...this.formModel.lastName,\r\n          value: this.customerFormData.lastName,\r\n          selectedOption: {}\r\n        };\r\n      }\r\n      if(prefillObj.phoneNumber){\r\n        const code = prefillObj.phoneNumber?.substring(0, 3);\r\n        const code1 = prefillObj.phoneNumber?.substring(0, 4);\r\n        let currentPhoneNumber = '';\r\n        let selectedItem = items.filter((it: any) => {\r\n          return it.phoneCountryCode === code;\r\n        });\r\n        if(selectedItem.length === 0 ){\r\n          currentPhoneNumber = prefillObj.phoneNumber?.substring(4, prefillObj.phoneNumber?.length); \r\n          selectedItem = items.filter((it: any) => {\r\n            return it.phoneCountryCode === code1;\r\n          });\r\n        }else{\r\n          currentPhoneNumber = prefillObj.phoneNumber?.substring(3, prefillObj.phoneNumber?.length); \r\n        }\r\n        if (selectedItem.length > 0) {\r\n          const output = selectedItem[0];\r\n          const validationPattern = output['regExpression'];  \r\n          this.customerFormData.driverCode = output?.phoneCountryCode;     \r\n          this.formModel.driverCode = { ...this.formModel.driverCode, selectedOption: output };\r\n          this.driverPhone?.updateCurrentValidation(validationPattern, true);\r\n        }\r\n        this.formModel.driverPhone = {\r\n          ...this.formModel.driverPhone,\r\n          value: currentPhoneNumber,\r\n          selectedOption: {}\r\n        }\r\n        this.customerFormData.driverPhone = parseInt(currentPhoneNumber);\r\n      }\r\n      if(prefillObj.email || prefillObj.phoneNumber || prefillObj.firstName){\r\n        if(prefillObj.make || prefillObj.model || prefillObj.vin || prefillObj.plate){\r\n          return;\r\n        }\r\n        this.commonService.setSessionStorage('selectedSearchItem', '');\r\n      } \r\n    }\r\n  }\r\n\r\n  /**\r\n   * check data\r\n   */\r\n  checkDataDirty():boolean{\r\n    const keys = Object.keys(this.customerFormData);\r\n    const defaultObject: CustomerFormData = {\r\n      jobNumber: '',\r\n      companyOrgType: '',\r\n      claimNumber: '',\r\n      companyName: '',\r\n      tariffId: 0,\r\n      isTariffEditable: true,\r\n      licenseId: '',\r\n      firstName: '',\r\n      lastName: '',\r\n      companyId: 0,\r\n      partnershipId: 0,\r\n      customerTypeID: 1,\r\n      driverCode: '+91',\r\n      driverPhone: 0,\r\n      carOwnerSelector: '',\r\n      email: ''\r\n    };\r\n    return this.compareObjects(this.customerFormData, defaultObject);\r\n  }\r\n\r\n  /**\r\n   * check validation\r\n   */\r\n  checkForFormValidation(): void {\r\n    const keys = Object.keys(this.customerFormData);\r\n    let keysToAvoid = [];\r\n    if (this.retail === 'Retail') {\r\n      if (this.customerFormData['carOwnerSelector'] === 'Person') {\r\n        keysToAvoid = [ 'companyName', 'claimNumber', 'licenseId', 'companyId' ]\r\n      }else if(this.customerFormData['carOwnerSelector'] === 'Company'){\r\n        keysToAvoid = [ 'claimNumber', 'companyId' ]\r\n      }\r\n    } else if (this.customerFormData.companyOrgType != 'Insurance Company') {\r\n      keysToAvoid = [ 'claimNumber' ]\r\n    }\r\n    if(this.commonService.repairPermission) {\r\n      keysToAvoid.push('jobNumber');\r\n    }\r\n    let isValid = true;\r\n    for (const k in keys) {\r\n      const prop = keys[k];\r\n      if (prop === 'carOwnerSelector' || prop === 'isTariffEditable' || keysToAvoid.indexOf(prop) !== -1) {\r\n        continue;\r\n      }\r\n      if (!this.customerFormData[prop]) {\r\n        isValid = false;\r\n      }\r\n    }\r\n    if (this.isFormConfirmed) {\r\n      this.confirmButtonModel.type = 'outline';\r\n    }else\r\n    if (!isValid) {\r\n      this.confirmButtonModel.type = 'disabled';\r\n    } else {\r\n      if (this.isFormConfirmed) {\r\n        this.confirmButtonModel.type = 'outline';\r\n        return;\r\n      }\r\n      this.confirmButtonModel.type = 'primary';\r\n    }\r\n    this.monitorService.logEvent('checkForFormValidation', [ 'ChqNewCustomerComponent', 'addenda-quote', {\r\n      validationStatus: isValid ? 'Form is valid' : 'Form is invalid'\r\n    } ]);\r\n\r\n  }\r\n\r\n  /**\r\n   * check route params\r\n   */\r\n  checkRouteParams():void {\r\n    this.route.queryParams.subscribe((params)=>{\r\n      const codeParam = params['isBack']  \r\n      if (codeParam === 'true' || codeParam === true) {\r\n        this.isFormConfirmed = true;\r\n        this.setTextMode();\r\n      }else if(this.currentStatus){\r\n        if (!this.formModel.companyOrgType.observable) {\r\n          this.formModel.companyOrgType.observable = this.caseService.getProviders();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * onInit lifecycle hook\r\n   */\r\n  ngOnInit(): void {\r\n    this.monitorService.logEvent('ngOnInit', [ 'ChqNewCustomerComponent', 'addenda-quote' ]);\r\n    this.formModel = newCaseForm();\r\n    if(this.commonService.repairPermission) {\r\n      this.formModel.jobNumber = {\r\n        ...this.formModel.jobNumber,\r\n        disabled: true,\r\n        validation: null\r\n      }\r\n    }\r\n    this.confirmButtonModel = {\r\n      label: 'Confirm',\r\n      type: 'primary',\r\n      icon: 'check',\r\n      onclick: this.confirmData.bind(this)\r\n    }\r\n    this.nextButtonModel = {\r\n      label: 'Next add vehicle',\r\n      type: 'primary',\r\n      icon: 'plus-filled',\r\n      onclick: this.navigateToVehicle.bind(this)\r\n    }\r\n   \r\n\r\n    if (!this.formModel.driverCode.observable) {\r\n      this.formModel.driverCode.observable = this.coreService.getPhoneNumber();\r\n      this.formModel.driverCode.onObservableLoad = this.onObservableLoad.bind(this);\r\n    }\r\n    this.header.caseNumber = '';\r\n    this.checkForFormValidation();\r\n    this.loadCaseDetails();\r\n\r\n    this.commonService.accessRight.subscribe({\r\n      next: (res: boolean) => {\r\n        if (!res) {\r\n          this.showNoAccess = true;\r\n        } \r\n      }\r\n    });\r\n\r\n    const container: any = document.querySelector('.addenda-container');\r\n    if(container){\r\n      container.scrollTop = 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * on destroy\r\n   */\r\n  ngOnDestroy(): void {\r\n    this.monitorService.logEvent('ngOnDestroy', [ 'ChqNewCustomerComponent', 'addenda-quote' ]);\r\n    this.commonService.accessRight.unsubscribe();\r\n    this.commonService.isViewOnly = false;\r\n  }\r\n}\r\n","<div class=\"new-vehicle-container\" [ngClass]=\"{'text-mode':isFormConfirmed}\" *ngIf=\"!showNoAccess\">\r\n    <chq-step-header [chqModel]=\"vehicleHeader\"></chq-step-header>\r\n    <label class=\"label\">{{'vehicle_detail' | translate}}</label>\r\n    <div class=\"search-box\" [ngClass]=\"{'partial-disable-info' : searchDisabled }\">\r\n        <chq-input class=\"col-4\" [inputModel]=\"formModel.vin\" (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n    </div>\r\n    <form class=\"form-container\">\r\n        <div class=\"vehicle-brand-wrapper row\" [ngClass]=\"{'disable-input disable-controls' : inputDisabled }\">\r\n            <chq-input #make id='input-make' class=\"col-4\" [inputModel]=\"formModel.make\"\r\n                (clicked)=\"hideDropdown($event);\" (controlOutput)=\"onFormUpdate($event)\"\r\n                [ngClass]=\"{'disable-input disable-controls' : makeDisabled }\"></chq-input>\r\n            <chq-input #model id='input-model' class=\"col-4\" [inputModel]=\"formModel.model\"\r\n                (clicked)=\"hideDropdown($event);\" (controlOutput)=\"onFormUpdate($event)\"\r\n                [ngClass]=\"{'disable-input disable-controls' : modelDisabled }\"></chq-input>\r\n            <chq-input #year id='input-year' class=\"col-4\" [inputModel]=\"formModel.year\"\r\n                (clicked)=\"hideDropdown($event);\" (controlOutput)=\"onFormUpdate($event)\"\r\n                [ngClass]=\"{'disable-input disable-controls' : yearDisabled }\"></chq-input>\r\n        </div>\r\n        <div class=\"vehicle-info-wrapper row \" [ngClass]=\"{'partial-disable-info disable-controls' : infoDisabled }\">\r\n            <chq-input class=\"col-4\" [inputModel]=\"formModel.licensePlate\"\r\n                (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n            <chq-input class=\"col-4\" [inputModel]=\"formModel.carMilege\"\r\n                (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n            <chq-input class=\"col-4 registration-date\" [inputModel]=\"formModel.registrationDate\"\r\n                (controlOutput)=\"onFormUpdate($event)\"></chq-input>\r\n        </div>\r\n    </form>\r\n    <div class=\"image-car\">\r\n        <img src=\"assets/img/half-car.png\" />\r\n    </div>\r\n\r\n    <div class=\"footer-full-wrapper\">\r\n        <div class=\"footer-image-wrapper\">\r\n            <div class=\"image-wrapper\">\r\n                <img src=\"assets/img/addenda-quote.png\" />\r\n            </div>\r\n        </div>\r\n        <div class=\"footer-button-wrapper\">\r\n            <chq-button *ngIf=\"currentStatus\" [buttonModel]=\"confirmButtonModel\"></chq-button>\r\n            <chq-button *ngIf=\"isFormConfirmed && !this.commonService.isViewOnly\" [buttonModel]=\"nextButtonModel\"></chq-button>\r\n        </div>\r\n      </div>\r\n</div>\r\n\r\n<no-access-error *ngIf=\"showNoAccess\"></no-access-error>","import { AfterViewInit, ChangeDetectorRef, Component, OnDestroy, OnInit, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { BehaviorSubject, firstValueFrom, from } from 'rxjs';\r\nimport { newVehicleForm, newVehicleHeader } from 'src/app/helper/form/vehicle-form.helper';\r\nimport { AddVehicleData, AddVehicleForm, UpdateVehicleCaseData, VehicleFormData, VinGTMotiveModel } from 'src/app/model/chq-new-case-form.model';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { ChqWidgetsHeaderModel } from 'src/app/model/chq-widgets-header-model';\r\nimport { IControlValue } from 'src/app/model/chq-widgets-input-model';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\nimport { InspectionService } from 'src/app/services/inspection-service/inspection.service';\r\nimport { VehicleService } from 'src/app/services/vehicle/vehicle.service';\r\nimport * as dayjs from 'dayjs'\r\nimport { ChqInputComponent } from 'src/app/widgets/chq-input/chq-input.component';\r\nimport { LabourRateService } from 'src/app/services/labour/labour-rate.service';\r\nimport { MediacollectionService } from 'src/app/services/mediacollection-service/mediacollection.service';\r\nimport { MonitorService } from 'src/app/services/monitor-service/monitor.service';\r\n\r\n@Component({\r\n  selector: 'chq-new-vehicle',\r\n  templateUrl: './chq-new-vehicle.component.html',\r\n  styleUrls: [ './chq-new-vehicle.component.scss' ]\r\n})\r\n\r\nexport class ChqNewVehicleComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  public vehicleHeader: ChqWidgetsHeaderModel = newVehicleHeader;\r\n  public formModel: AddVehicleForm;\r\n  public caseId = '0';\r\n  public id: number;\r\n  public status = '';\r\n  public tariffId = 0;\r\n  public isTariffEditable: boolean;\r\n  public vehicleFormData: VehicleFormData = {\r\n    vin: '',\r\n    make: '',\r\n    model: '',\r\n    year: '',\r\n    carMilege: '',\r\n    licensePlate: '',\r\n    registrationDate: ''\r\n  }\r\n\r\n  public isFormConfirmed: boolean = false;\r\n  public serviceName: string = 'vin';\r\n\r\n  public confirmButtonModel: ChqWidgetsButtonModel;\r\n  public nextButtonModel: ChqWidgetsButtonModel;\r\n\r\n  public inputDisabled: boolean = true;\r\n  public currentPartnership: any;\r\n  public infoDisabled: boolean = true;\r\n  public searchDisabled: boolean = false;\r\n  public importTerms: Array<string> = [];\r\n  public vehicleId: number = 0;\r\n  public vinGTMotive: VinGTMotiveModel;\r\n  public inspections: any = {};\r\n  public domainID: number = 0;\r\n  public partnershipId: number = 0;\r\n  @ViewChild('make') make: ChqInputComponent;\r\n  @ViewChild('model') model: ChqInputComponent;\r\n  @ViewChild('year') year: ChqInputComponent;\r\n  public labourData: any = null;\r\n  public makeDisabled: boolean = false;\r\n  public preventVinCall: boolean = false;\r\n  private caseCreatedDate: string = '';\r\n  private umc: string = '';\r\n  private originalVin: string = '';\r\n  public modelDisabled: boolean = false;\r\n  public yearDisabled: boolean = false;\r\n  private inspectionTemplateId: number = 0;\r\n  public showNoAccess: boolean = false;\r\n  public customerName: string = '';\r\n  public email: string = '';\r\n  public originalTariffObject: any = {};\r\n\r\n  private userPermission: any = {};\r\n  private estimateId: number;\r\n  public currentOrgId: number;\r\n\r\n  /**\r\n   * constructor\r\n   * @param fb ChangeDetectorRef \r\n   */\r\n  constructor(private router: Router,\r\n    public commonService: CommonService,\r\n    private route: ActivatedRoute,\r\n    private caseService: CaseService,\r\n    private vehicleService: VehicleService,\r\n    private inspectionService: InspectionService,\r\n    private monitorService: MonitorService,\r\n    private labourService: LabourRateService,\r\n    private mediaCollectionService: MediacollectionService,\r\n    public cd: ChangeDetectorRef) {\r\n    this.commonService.eventfromToastComponent$.subscribe((event: boolean) => {\r\n      if (event) {\r\n        this.monitorService.logEvent('eventfromToastComponent', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n          caseId: this.caseId\r\n        } ]);\r\n        this.router.navigate([ `/quote/case/${this.caseId}/document` ])\r\n      }\r\n    });\r\n\r\n    if (this.commonService.accessRight.closed) {\r\n      this.commonService.accessRight = new BehaviorSubject<boolean>(true);\r\n    }\r\n\r\n    this.commonService.userProfileData.subscribe((res) => {\r\n      if (res && res.data) {\r\n        const { userPermission, vehicleSourceType, organizationDetail } = res.data;\r\n        this.userPermission = userPermission || {};\r\n        this.estimateId = vehicleSourceType;\r\n        if (organizationDetail) {\r\n          this.currentOrgId = organizationDetail.id;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * check gtEstimate permission\r\n   */\r\n  checkGTEstimatePermission(): boolean {\r\n    const { orgPackages = [] } = this.userPermission;\r\n    const repairEstimatePackage = orgPackages.filter((orgPackage: any) => {\r\n      return orgPackage.automotiveServiceName === 'Repair Estimate';\r\n    });\r\n  \r\n    if (repairEstimatePackage && repairEstimatePackage.length > 0) {\r\n      const { permissions } = repairEstimatePackage[0];\r\n      const gtEstimatePermission = permissions.filter((perm: any) => {\r\n        return perm.permissionName === 'gt.estimate' || perm.permissionName === 'gt.estimate.vinquery';\r\n      });\r\n      if (gtEstimatePermission && gtEstimatePermission.length > 0) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * process \r\n   */\r\n  public async process(caseId: string): Promise<void> {\r\n    this.caseId = caseId;\r\n    this.commonService.showLoading();\r\n    await this.populateReadonlyFields(caseId).then((result: any) => {\r\n      if (result.data == null) {\r\n        this.commonService.hideLoading();\r\n        return;\r\n      }\r\n      this.vehicleId = result.data.vehicleId || 0;\r\n      this.vehicleHeader.caseNumber = result.data.caseNumber;\r\n\r\n      const { vinNumber, licensePlateNumber, vehicleMileage, registrationDate,\r\n        vehicleMake, vehicleModel, modelYear, status, tariffs, domainID, umc, id } = result.data;\r\n      this.id = id;\r\n      if (this.vehicleId != 0) {\r\n        this.infoDisabled = false;\r\n        this.searchDisabled = false;\r\n        this.inputDisabled = false;\r\n        this.preventVinCall = true;\r\n        this.originalVin = vinNumber;\r\n\r\n        this.labourData = (tariffs.length > 0) ? tariffs[0] : [];\r\n      }\r\n\r\n      this.customerName = result.data.caseDetail?.firstName;\r\n      this.email = result.data.caseDetail?.email;\r\n\r\n      this.vehicleHeader.caseNumber = result.data.caseNumber;\r\n      this.caseCreatedDate = result.data.createdDate;\r\n      this.formModel.vin = { ...this.formModel.vin, value: vinNumber };\r\n      this.status = status;\r\n      this.commonService.caseStatus.next(status);\r\n      this.formModel.licensePlate = { ...this.formModel.licensePlate, value: licensePlateNumber };\r\n      this.formModel.carMilege = { ...this.formModel.carMilege, value: vehicleMileage };\r\n      this.formModel.registrationDate = { ...this.formModel.registrationDate, value: registrationDate };\r\n      this.formModel.make = { ...this.formModel.make, selectedOption: { 'name': vehicleMake } };\r\n      this.formModel.year = { ...this.formModel.year, selectedOption: { 'name': modelYear || result.data.modelYearRange } };\r\n      this.formModel.model = { ...this.formModel.model, selectedOption: { 'modelDescription': vehicleModel } };\r\n\r\n      this.umc = umc;\r\n\r\n      this.tariffId = tariffs[0]?.tariffId;\r\n      this.isTariffEditable = tariffs[0]?.isEditable;\r\n      this.partnershipId = tariffs[0]?.partnershipId;\r\n      this.domainID = domainID;\r\n      this.inspections = result.data.inspections[0];\r\n\r\n      if (this.inspections) {\r\n        this.commonService.inspectionId.next(this.inspections.inspectionId);\r\n      }\r\n\r\n      this.originalTariffObject = {\r\n        'make': vehicleMake,\r\n        'partnershipId': this.partnershipId,\r\n        'registrationDate': dayjs(registrationDate).format('YYYY-MM-DDT00:00:00')\r\n      }\r\n\r\n      this.vehicleFormData = {\r\n        ...this.vehicleFormData, vin: vinNumber, make: vehicleMake, model: vehicleModel,\r\n        year: modelYear || result.data.modelYearRange, carMilege: vehicleMileage,\r\n        licensePlate: licensePlateNumber, registrationDate: registrationDate\r\n      }\r\n\r\n      if (this.currentOrgId != result.data.organizationDetail?.organizationId) {\r\n        this.commonService.isViewOnly = true;\r\n      } else {\r\n        this.commonService.isViewOnly = false;\r\n      }\r\n\r\n      this.validate();\r\n      this.commonService.hideLoading();\r\n    }).catch(() => {\r\n      this.commonService.hideLoading();\r\n    });\r\n\r\n    this.prefillVehicleData();\r\n\r\n    /*if (!this.currentStatus || this.isFormConfirmed) {\r\n      this.setTextMode();\r\n      this.isFormConfirmed = true;\r\n      return;\r\n    }*/\r\n    if (this.vehicleId != 0 || this.commonService.isViewOnly) {\r\n      this.setTextMode();\r\n      this.isFormConfirmed = true;\r\n      return;\r\n    }\r\n\r\n    await this.populateDropdowns();\r\n  }\r\n\r\n\r\n  /**\r\n   * prefill vehicle data\r\n   */\r\n  prefillVehicleData(): void {\r\n    const prefillData = this.commonService.getSessionStorage('selectedSearchItem');\r\n    if (prefillData) {\r\n      const prefillObj = JSON.parse(prefillData);\r\n      if (prefillObj.vin && !this.vehicleFormData.vin) {\r\n        this.preventVinCall = true;\r\n        this.vehicleFormData.vin = prefillObj.vin;\r\n        this.formModel.vin = { ...this.formModel.vin, value: prefillObj.vin };\r\n      }\r\n      if (prefillObj.make && !this.vehicleFormData.make) {\r\n        this.vehicleFormData.make = prefillObj.make;\r\n        this.formModel.make = { ...this.formModel.make, selectedOption: { 'name': prefillObj.make } };\r\n      }\r\n      if (prefillObj.model && !this.vehicleFormData.model) {\r\n        this.vehicleFormData.model = prefillObj.model;\r\n        this.formModel.model = { ...this.formModel.model, selectedOption: { 'modelDescription': prefillObj.model } };\r\n      }\r\n      if (prefillObj.importInterval && !this.vehicleFormData.year) {\r\n        this.vehicleFormData.year = prefillObj.importInterval;\r\n        this.formModel.year = {\r\n          ...this.formModel.year, value: prefillObj.importInterval,\r\n          selectedOption: { 'name': prefillObj.importInterval }\r\n        };\r\n      }\r\n      if (prefillObj.plate && !this.vehicleFormData.licensePlate) {\r\n        this.vehicleFormData.licensePlate = prefillObj.plate;\r\n        this.formModel.licensePlate = { ...this.formModel.licensePlate, value: prefillObj.plate };\r\n      }\r\n      if (prefillObj.make || prefillObj.model || prefillObj.vin || prefillObj.plate) {\r\n        this.commonService.setSessionStorage('selectedSearchItem', '');\r\n        this.inputDisabled = false;\r\n        this.infoDisabled = false;\r\n        this.makeDisabled = true;\r\n        this.enableDropdowns();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * populate make, year, model dropdowns\r\n   */\r\n  public async populateDropdowns(): Promise<void> {\r\n\r\n    //this.estimateId = this.checkGTEstimatePermission() ? 3 : 1;\r\n\r\n    const data = await firstValueFrom(this.vehicleService.getVehicleMake());\r\n    this.formModel.make = { ...this.formModel.make, options: data.sort((a, b) => a.name.localeCompare(b.name)) };\r\n\r\n    const makeList = this.formModel.make.options;\r\n    const selectedMake = makeList.filter(q => q.name === this.vehicleFormData.make);\r\n    if (selectedMake.length > 0) {\r\n      this.vehicleService.getVehicleModel(selectedMake[0].id, this.estimateId).subscribe((data) => {\r\n        this.formModel.model = { ...this.formModel.model, options: data };\r\n        const model = this.formModel.model.options?.filter(q => q.umc == this.umc);\r\n        if (model.length > 0) {\r\n          this.vehicleService.getVehicleYearByModel(model[0].id, this.estimateId)?.subscribe((data) => {\r\n            this.formModel.year = { ...this.formModel.year, options: data };\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * populate readonly fields\r\n   */\r\n  public async populateReadonlyFields(caseId: string): Promise<any> {\r\n    if (caseId && caseId != '0') {\r\n      this.caseId = caseId;\r\n      this.commonService.showLoading();\r\n      return firstValueFrom(this.caseService.getCaseDetail(caseId));\r\n    }\r\n  }\r\n  /**\r\n   * navigates to next page\r\n   */\r\n  navigateToDocument(): void {\r\n    this.monitorService.logEvent('navigateToDocument', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n    this.router.navigate([ `/quote/case/${this.caseId}/document` ]);\r\n  }\r\n\r\n  /**\r\n   * onInit lifecycle hook\r\n  */\r\n  async ngOnInit(): Promise<void> {\r\n    this.formModel = newVehicleForm();\r\n    this.confirmButtonModel = {\r\n      label: 'Confirm',\r\n      type: 'primary',\r\n      icon: 'check',\r\n      onclick: this.confirmData.bind(this)\r\n    }\r\n\r\n    this.nextButtonModel = {\r\n      label: 'Next add documents',\r\n      type: 'primary',\r\n      icon: 'plus-filled',\r\n      onclick: this.navigateToDocument.bind(this)\r\n    }\r\n\r\n    const caseId = this.route?.parent?.snapshot?.paramMap?.get('id');\r\n\r\n    this.monitorService.logEvent('ngOnInit', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId\r\n    } ]);\r\n\r\n    this.commonService.accessRight.subscribe({\r\n      next: (res: boolean) => {\r\n        if (!res) {\r\n          this.showNoAccess = true;\r\n        }\r\n      }\r\n    });\r\n\r\n    this.inspectionService.getInspectionTemplateList().subscribe({\r\n      next: (inspectionList: any) => {\r\n        const repairInspectionTemplate = inspectionList?.data;\r\n        if (repairInspectionTemplate.length > 0) {\r\n          this.inspectionTemplateId = repairInspectionTemplate[0].id\r\n        }\r\n      }\r\n    })\r\n\r\n    await this.process(caseId);\r\n\r\n    const container: any = document.querySelector('.addenda-container');\r\n    if (container) {\r\n      container.scrollTop = 0;\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * ngAfterViewInit hook\r\n   * @param fb FormBuilder \r\n   */\r\n  ngAfterViewInit(): void {\r\n    this.commonService.updatePage('/quote/case/0', 'vehicle');\r\n    this.monitorService.logEvent('ngAfterViewInit', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n  }\r\n\r\n\r\n  /**\r\n   * setTextMode\r\n   */\r\n  public setTextMode(): void {\r\n    this.inputDisabled = false;\r\n    this.makeDisabled = false;\r\n    const keys = Object.keys(this.formModel);\r\n    for (const k in keys) {\r\n      const key = keys[k];\r\n      this.formModel[key] = {\r\n        ...this.formModel[key],\r\n        mode: 'text',\r\n      };\r\n    }\r\n    this.confirmButtonModel = {\r\n      ...this.confirmButtonModel, label: 'Change car',\r\n      type: 'outline', icon: 'gobackward'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * check route params\r\n   */\r\n  /*checkRouteParams(caseId): void {\r\n    this.route.queryParams.subscribe((params) => {\r\n      const codeParam = params['isBack']\r\n      if (codeParam === 'true' || codeParam === true) {\r\n        this.isFormConfirmed = true;\r\n      } \r\n\r\n      this.process(caseId);\r\n    });\r\n  }*/\r\n\r\n  /**\r\n    * update button\r\n  */\r\n  public async updateButton(): Promise<void> {\r\n    const keys = Object.keys(this.formModel);\r\n    for (const k in keys) {\r\n      const key = keys[k];\r\n      this.formModel[key] = {\r\n        ...this.formModel[key],\r\n        mode: this.isFormConfirmed ? 'value' : 'text',\r\n      };\r\n    }\r\n\r\n    if (this.confirmButtonModel.label == 'Change car') {\r\n      this.preventVinCall = true;\r\n      this.vehicleService.getVinDecoder(this.vehicleFormData.vin).subscribe({\r\n        next: (result: any) => {\r\n          if (result?.success) {\r\n            this.makeDisabled = true;\r\n          } else {\r\n            this.makeDisabled = false;\r\n          }\r\n        }\r\n      });\r\n      this.commonService.showLoading();\r\n      await this.populateDropdowns();\r\n      this.commonService.hideLoading();\r\n    }\r\n\r\n    this.isFormConfirmed = !this.isFormConfirmed;\r\n    this.confirmButtonModel = {\r\n      ...this.confirmButtonModel, label: this.isFormConfirmed ? 'Change car' : 'Confirm',\r\n      type: this.isFormConfirmed ? 'outline' : 'primary', icon: this.isFormConfirmed ? 'refresh' : 'check'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * handles confirm click\r\n   * returns void\r\n   */\r\n  public confirmData(): void {\r\n    if (this.isFormConfirmed) {\r\n      this.updateButton();\r\n      return;\r\n    }\r\n\r\n    this.commonService.showLoading();\r\n    // add/update vehicle\r\n    if (this.vehicleId && this.vehicleFormData.vin === this.originalVin) {\r\n      this.updateVehicle();\r\n    } else {\r\n      const formData: AddVehicleData = {\r\n        'vin': this.vehicleFormData.vin,\r\n        'vehicleCountryId': 1,\r\n        'umc': this.umc,\r\n        'make': this.vehicleFormData.make,\r\n        'model': this.vehicleFormData.model,\r\n        'mileage': Number(this.vehicleFormData.carMilege),\r\n        'firstRegistrationDate': dayjs(this.vehicleFormData.registrationDate).format('YYYY-MM-DDT00:00:00'),\r\n        'registrationNumber': this.vehicleFormData.licensePlate,\r\n        'condition': 1,\r\n        'ModelYearRange': this.vehicleFormData.year,\r\n        'InspectionTemplateId': this.inspectionTemplateId,\r\n        'CustomerName': this.customerName,\r\n        'CustomerEmail': this.email\r\n      }\r\n\r\n      this.vehicleService.addVehicle(formData, this.domainID, this.id).subscribe({\r\n        next: (result: any) => {\r\n          if (result) {\r\n            this.vehicleId = result.id;\r\n\r\n            this.inspections = {};\r\n            this.inspections.inspectionId = result.inspectionId;\r\n            this.inspections.inspectionGuid = result.inspectionGuid;\r\n\r\n            this.updateVehicle();\r\n          }\r\n        },\r\n        error: (err) => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      });\r\n      //\r\n    }\r\n    //   \r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param inspectionId \r\n   */\r\n  public async updateVehicle(): Promise<void> {\r\n    this.monitorService.logEvent('updateVehicle', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n    this.commonService.showLoading();\r\n    const formData: UpdateVehicleCaseData = {\r\n      'vin': this.vehicleFormData.vin,\r\n      'umc': this.umc,\r\n      'vehicleMake': this.vehicleFormData.make,\r\n      'vehicleModel': this.vehicleFormData.model,\r\n      'modelYearRange': this.vinGTMotive?.modelYearRange || this.vehicleFormData.year,\r\n      'vehicleID': this.vehicleId,\r\n      'licensePlateNumber': this.vehicleFormData.licensePlate,\r\n      'vehicleMileage': Number(this.vehicleFormData.carMilege),\r\n      'registrationDate': dayjs(this.vehicleFormData.registrationDate).format('YYYY-MM-DDT00:00:00')\r\n    }\r\n\r\n    const inspection = {\r\n      'inspectionID': this.inspections.inspectionId,\r\n      'inspectionGuid': this.inspections.inspectionGuid\r\n    }\r\n\r\n    const year = dayjs(this.vehicleFormData.registrationDate).year().toString();\r\n    //}\r\n\r\n    //if(!this.labourData){\r\n    if ((this.originalTariffObject.make != this.vehicleFormData.make\r\n      || this.partnershipId != this.originalTariffObject.partnershipId\r\n      || dayjs(this.vehicleFormData.registrationDate).format('YYYY-MM-DDT00:00:00') != this.originalTariffObject.registrationDate) ||\r\n      (!this.labourData?.tariffLabourRates?.length)) {\r\n\r\n      await this.getLabourData(this.tariffId, this.isTariffEditable, this.partnershipId, this.vehicleFormData.make, year);\r\n    }\r\n    //}\r\n\r\n    const mainFormData = {\r\n      'vehicle': formData,\r\n      'inspection': inspection,\r\n      'tariff': this.labourData\r\n    }\r\n\r\n    this.vehicleService.updateVehicleCase(mainFormData, this.caseId).subscribe({\r\n      next: (result: any) => {\r\n        if (result) {\r\n\r\n          if (this.labourData.isEditable) {\r\n            let showMessage: boolean = true;\r\n            this.labourData.tariffLabourRates.forEach((element: any) => {\r\n              if (element.amount > 0) {\r\n                showMessage = false;\r\n                return;\r\n              }\r\n            });\r\n\r\n            if (showMessage) {\r\n              const action = {\r\n                'objectId': this.caseId,\r\n                'link': 'here',\r\n                'labourData': this.labourData\r\n              };\r\n              this.commonService.hideLoading();\r\n              this.commonService.showInfoToast(500000, 'labour_value_update', action);\r\n              return;\r\n            }\r\n          }\r\n          this.router.navigate([ `/quote/case/${this.caseId}/document` ]);\r\n        }\r\n\r\n        this.commonService.hideLoading();\r\n      },\r\n      error: (err) => {\r\n        this.commonService.hideLoading();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param event \r\n   */\r\n  public onFormUpdate(output: IControlValue): void {\r\n    this.monitorService.logEvent('onFormUpdate', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId: this.caseId,\r\n      output\r\n    } ]);\r\n    if (output.type === 'select') {\r\n      this.formModel[output.name] = {\r\n        ...this.formModel[output.name], selectedOption: output.value\r\n      };\r\n      this.vehicleFormData[output.name] = output.value[this.formModel[output.name].fieldValue];\r\n\r\n      if (output.name == 'make') {\r\n        this.vehicleFormData['model'] = '';\r\n        this.vehicleFormData['year'] = null;\r\n        this.modelDisabled = true;\r\n        this.yearDisabled = true;\r\n        this.formModel.year = {\r\n          ...this.formModel.year, selectedOption: {}, options: [], observable: null\r\n        }\r\n        //this.formModel.year.options = [];\r\n        this.formModel.model = {\r\n          ...this.formModel.model, selectedOption: {}\r\n        }\r\n\r\n        if (output.value) {\r\n          this.formModel.model = {\r\n            ...this.formModel.model,\r\n            observable: this.vehicleService.getVehicleModel(output.value.id, this.estimateId),\r\n            onObservableLoad: this.enableDropdowns.bind(this)\r\n          };\r\n          setTimeout(() => {\r\n            this.model.triggerObservable();\r\n\r\n          });\r\n        }\r\n      } else if (output.name == 'model') {\r\n        this.yearDisabled = true;\r\n        this.formModel.year = {\r\n          ...this.formModel.year, selectedOption: {}, observable: null, options: []\r\n        }\r\n\r\n        this.vehicleFormData['year'] = null;\r\n        if (output.value) {\r\n          this.umc = output.value.umc;\r\n          this.formModel.year = {\r\n            ...this.formModel.year,\r\n            observable: this.vehicleService.getVehicleYearByModel(output.value.id, this.estimateId),\r\n            onObservableLoad: this.enableDropdowns.bind(this)\r\n          };\r\n          setTimeout(() => {\r\n            this.year.triggerObservable();\r\n          });\r\n        }\r\n      }\r\n    } else {\r\n\r\n      if (!output.isValid) {\r\n        this.formModel[output.name].value = '';\r\n        this.vehicleFormData[output.name] = '';\r\n      } else {\r\n        this.formModel[output.name].value = output.value;\r\n        this.vehicleFormData[output.name] = output.value;\r\n      }\r\n    }\r\n\r\n    this.vehicleFormData = { ...this.vehicleFormData };\r\n\r\n    if (output.name == 'vin') {\r\n      if (output.isValid) {\r\n        this.populateForm();\r\n      }\r\n    }\r\n\r\n    this.validate();\r\n  }\r\n\r\n  /**\r\n   * function to enable dropdowns\r\n   */\r\n  enableDropdowns(): void {\r\n    this.modelDisabled = false;\r\n    this.yearDisabled = false;\r\n  }\r\n  /**\r\n   * hide dropdown\r\n   */\r\n  hideDropdown(name: any): void {\r\n    if (name === this.formModel.make.name) {\r\n      this.model.closeDropdown();\r\n      this.year.closeDropdown();\r\n    } else if (name === this.formModel.model.name) {\r\n      this.make.closeDropdown();\r\n      this.year.closeDropdown();\r\n    } else {\r\n      this.model.closeDropdown();\r\n      this.make.closeDropdown();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * check validation\r\n   */\r\n  public validate(): void {\r\n    const keys = Object.keys(this.vehicleFormData);\r\n    this.monitorService.logEvent('validate', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n    let isValid = true;\r\n    for (const k in keys) {\r\n      const prop = keys[k];\r\n      if (!this.vehicleFormData[prop]) {\r\n        isValid = false;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (this.isFormConfirmed) {\r\n      this.confirmButtonModel.type = 'outline';\r\n    } else if (!isValid) {\r\n      this.confirmButtonModel.type = 'disabled';\r\n    } else {\r\n      this.confirmButtonModel.type = 'primary';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * populate vin number d\r\n   */\r\n  public populateForm(): void {\r\n    const vinNumber = this.formModel.vin.value?.toLocaleString();\r\n    this.monitorService.logEvent('populateForm', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n    from(vinNumber)\r\n      .pipe()\r\n      .subscribe({\r\n        complete: () => {\r\n          if (vinNumber.length == 17 && !this.isFormConfirmed && !this.preventVinCall) {\r\n            this.commonService.showLoading();\r\n            this.vehicleService.getVinDecoder(vinNumber).subscribe({\r\n              error: () => {\r\n                this.commonService.hideLoading();\r\n                this.vinGTMotive = null;\r\n\r\n                this.resetDropdown();\r\n              },\r\n              next: (result) => {\r\n                if (result?.success) {\r\n                  this.vinGTMotive = result.data;\r\n\r\n                  this.umc = this.vinGTMotive?.umc;\r\n                  this.formModel['make'] = {\r\n                    ...this.formModel['make'], selectedOption: { 'name': result.data.vehicleMake }\r\n                  };\r\n\r\n                  this.formModel.model = {\r\n                    ...this.formModel['model'], selectedOption: { 'modelDescription': result.data.vehicleModel }\r\n                  };\r\n\r\n                  const makeList = this.formModel.make.options;\r\n                  const selectedMake = makeList.filter(q => q.name === result.data.vehicleMake);\r\n                  if (selectedMake.length > 0) {\r\n                    this.formModel.model = { ...this.formModel.model, observable: this.vehicleService.getVehicleModel(selectedMake[0].id, this.estimateId) };\r\n                    setTimeout(() => {\r\n                      this.model.triggerObservable();\r\n                    });\r\n                  }\r\n\r\n                  this.formModel.year = {\r\n                    ...this.formModel['year'], selectedOption: { 'name': result.data.modelYearRange }\r\n                  };\r\n\r\n                  this.vehicleFormData['make'] = result.data.vehicleMake;\r\n                  this.vehicleFormData['model'] = result.data.vehicleModel;\r\n                  this.vehicleFormData['year'] = result.data.modelYearRange;\r\n\r\n                  this.inputDisabled = false;\r\n                  this.infoDisabled = false;\r\n                  this.makeDisabled = true;\r\n                  this.enableDropdowns();\r\n                } else {\r\n                  this.vinGTMotive = null;\r\n                  this.commonService.showInfoToast(5000, 'show-info | ' + result?.message);\r\n\r\n                  this.resetDropdown();\r\n                }\r\n\r\n                setTimeout(() => {\r\n                  this.make.dropdownValidationMessage = '';\r\n                  this.make.dropdownContainer.dropdownConfig.isTouched = false;\r\n                  this.make.dropdownContainer.dropdownConfig.isDirty = false;\r\n\r\n                  this.model.dropdownValidationMessage = '';\r\n                  this.model.dropdownContainer.dropdownConfig.isTouched = false;\r\n                  this.model.dropdownContainer.dropdownConfig.isDirty = false;\r\n\r\n                  this.year.dropdownValidationMessage = '';\r\n                  this.year.dropdownContainer.dropdownConfig.isTouched = false;\r\n                  this.year.dropdownContainer.dropdownConfig.isDirty = false;\r\n                }, 0);\r\n\r\n                this.validate();\r\n              },\r\n              complete: () => {\r\n                this.commonService.hideLoading();\r\n              }\r\n            });\r\n          }\r\n\r\n          if (this.preventVinCall && vinNumber.length == 17) {\r\n            this.preventVinCall = false;\r\n          }\r\n        }\r\n      });\r\n  }\r\n\r\n  /**\r\n   * reset import term\r\n   */\r\n  private resetDropdown(): void {\r\n    this.inputDisabled = false;\r\n    this.infoDisabled = false;\r\n    this.makeDisabled = false;\r\n\r\n    this.vehicleFormData['make'] = '';\r\n    this.vehicleFormData['model'] = '';\r\n    this.vehicleFormData['year'] = null;\r\n\r\n    this.formModel.model.options = [];\r\n    this.formModel.year.options = [];\r\n\r\n    this.formModel['make'] = {\r\n      ...this.formModel['make'], selectedOption: {}\r\n    };\r\n    this.formModel.model = {\r\n      ...this.formModel['model'], selectedOption: {}\r\n    };\r\n    this.formModel.year = {\r\n      ...this.formModel['year'], selectedOption: {}\r\n    }\r\n  }\r\n\r\n  /**\r\n   * is case pending\r\n   */\r\n  get currentStatus(): boolean {\r\n    if (!this.status && !this.commonService.isViewOnly) {\r\n      return true;\r\n    } else if (this.commonService.isViewOnly) {\r\n      return false;\r\n    }\r\n    return [ 'reject', 'rejected', 'approved', 'closed', 'repairestimation', 'complete' ].indexOf(this.status?.toLowerCase()) === -1;\r\n  }\r\n\r\n  /**\r\n   * get labour data to show\r\n   */\r\n  async getLabourData(tariffId: number, isEditable: boolean, partnershipId: number, make: string, year: string): Promise<any> {\r\n    this.monitorService.logEvent('getLabourData', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n    return firstValueFrom(this.labourService.getLabourData(tariffId, make,\r\n      dayjs(this.vehicleFormData.registrationDate).format('YYYY-MM-DDT00:00:00'),\r\n      this.caseCreatedDate\r\n    )).then((result) => {\r\n      if (result.data) {\r\n        this.labourData = {\r\n          tariffId: result.data.id,\r\n          tariffDiscountRates: result.data.tariffDiscountRates,\r\n          tariffLabourRates: result.data.tariffLaborRates,\r\n          isEditable: isEditable,\r\n          partnershipId: partnershipId\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * get domain id\r\n   */\r\n  getDomainId(): void {\r\n    this.mediaCollectionService.getMediaTemplate().subscribe({\r\n      next: (response) => {\r\n        if (response?.data.length > 0) {\r\n          this.domainID = response.data[0].domainID;\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * on destroy\r\n   */\r\n  ngOnDestroy(): void {\r\n    this.monitorService.logEvent('ngOnDestroy', [ 'ChqNewVehicleComponent', 'addenda-quote', {\r\n      caseId: this.caseId\r\n    } ]);\r\n    this.formModel = newVehicleForm();\r\n    this.commonService.accessRight.unsubscribe();\r\n    this.commonService.isViewOnly = false;\r\n  }\r\n}\r\n\r\n","<div class=\"estimate-container\" [ngClass]=\"{'hidden':showDamageAnalysis}\" *ngIf=\"!showNoAccess\">\r\n    <chq-step-header [chqModel]=\"header\" class=\"header\" [showButton]=\"true\"\r\n        (back)=\"handleBack($event)\"></chq-step-header>\r\n    <div class=\"info-container\" *ngIf=\"pageReady\">\r\n        <div class=\"info-block\">\r\n            <div class=\"avatar\">\r\n                <label>{{ customerData.initial }}</label>\r\n            </div>\r\n            <div class=\"text-block\">\r\n                <label>{{ customerData.firstName +' ' + customerData.lastName }}</label>\r\n                <span>{{ customerData.countryCode + \" \" + customerData.mobileNumber }}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"vehicle-block\">\r\n            <img src=\"assets/img/default_car.png\" />\r\n            <div class=\"text-block\">\r\n                <a [href]=\"downloadUrl\" [hidden]=\"true\" #anchor [download]=\"pdfName\"></a>\r\n                <label>{{ caseData?.vehicleMake }}</label>\r\n                <span>{{ caseData?.vehicleModel }}</span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"estimate-block row\">\r\n        <div class=\"quote-estimate-step col-12\">\r\n            <!-- <chq-images-tables [estimateResponse]=\"estimateResponse\" (downloadPdf)=\"downloadPdf();\"\r\n                *ngIf=\"showData\"></chq-images-tables> -->\r\n                <chq-estimate-details *ngIf=\"showData\"\r\n                    [estimateResponse]=\"estimateResponse\"\r\n                    [editEstimate]=\"editEstimate\"\r\n                    [estimateSource]=\"estimateSource\"\r\n                    serviceType=\"repair\"\r\n                    (downloadPdf)=\"downloadPdf()\"\r\n                    [i18n]=\"i18n\"\r\n                > </chq-estimate-details>\r\n                <chq-customloader [showLoading]=\"!showData\" ></chq-customloader>\r\n        </div>\r\n\r\n        <!-- Disabled Case history -->\r\n        <!-- <div class=\"image-slider col-4\">\r\n            <chq-images-slider [sliderModel]=\"images\" ></chq-images-slider>\r\n            <chq-customloader [showLoading]=\"!showInspection\" ></chq-customloader>\r\n            <chq-case-history [domainId]=\"domainId\" [caseGuid]=\"caseGuid\" #caseHistory *ngIf=\"showData\"></chq-case-history>\r\n        </div> -->\r\n    </div>\r\n    <div class=\"footer-full-wrapper\">\r\n        <div class=\"footer-image-wrapper\">\r\n            <div class=\"image-wrapper\">\r\n                <img src=\"assets/img/addenda-quote.png\" />\r\n            </div>\r\n        </div>\r\n        <div class=\"footer-button-wrapper show-md\" *ngIf=\"estimateResponse && !this.commonService.isViewOnly\">\r\n            <chq-button [buttonModel]=\"createBooking\" *ngIf=\"commonService.repairPermission && !repairId && caseStatus?.toLowerCase() !== 'rejected'\" (click)=\"booking('create', '')\"></chq-button>\r\n            <chq-button [buttonModel]=\"viewBooking\" *ngIf=\"commonService.repairPermission && repairId\" (click)=\"booking('view', repairId)\"></chq-button>\r\n            <chq-button [buttonModel]=\"closeCaseButton\" *ngIf=\"!isPendingApproval() && isGTEstimate() && caseStatus?.toLowerCase() !== 'complete'\"  (click)=\"changeCaseStatusDialog(closeCaseButton)\"></chq-button>\r\n            <chq-button [buttonModel]=\"approveCaseButton\" *ngIf=\"!isPendingApproval() && isGTEstimate() && currentRejStatus && caseStatus?.toLowerCase() !== 'complete'\" (click)=\"changeCaseStatusDialog(approveCaseButton)\"></chq-button>\r\n            <chq-button [buttonModel]=\"rejectButton\" *ngIf=\"!isPendingApproval() && isGTEstimate() && currentStatus && caseStatus?.toLowerCase() !== 'complete'\" (click)=\"changeCaseStatusDialog(rejectButton)\"></chq-button>\r\n            <chq-button *ngIf=\"!isPendingApproval() && isGTEstimate() && currentRejStatus && caseStatus?.toLowerCase() !== 'complete'\" [buttonModel]=\"calculationButton\"></chq-button>\r\n        </div>\r\n        <div class=\"footer-button-wrapper show-sm\" *ngIf=\"estimateResponse && !this.commonService.isViewOnly\">\r\n            <chq-dropdown class=\"option-dropdown\" *ngIf=\"!isPendingApproval() && isGTEstimate() && (commonService.repairPermission || (caseStatus?.toLowerCase() !== 'complete' && !commonService.repairPermission))\" [dropdownModel]=\"dropdownModelFilter\" (selected)=\"changeCaseStatusDialog($event)\"></chq-dropdown>\r\n            <chq-button [buttonModel]=\"createBooking\" *ngIf=\"commonService.repairPermission && !repairId && caseStatus?.toLowerCase() !== 'rejected'\" (click)=\"booking('create', '')\"></chq-button>\r\n            <chq-button [buttonModel]=\"viewBooking\" *ngIf=\"commonService.repairPermission && repairId\" (click)=\"booking('view', repairId)\"></chq-button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Case History -->\r\n      <history (toggleExpand)=\"getCaseHistory()\" [history]=\"history\" [isLoading]=\"isHistoryLoading\" serviceType=\"quote\"></history>\r\n</div>\r\n<damage-analysis *ngIf=\"showDamageAnalysis\" [hideNext]=\"true\" [caseDetail]=\"caseResult\" (backEvent)=\"handleBack($event)\"></damage-analysis>\r\n<no-access-error *ngIf=\"showNoAccess\"></no-access-error>\r\n","import { AfterViewInit, ApplicationRef, ChangeDetectorRef, Component, HostListener, Input, NgZone, OnDestroy, OnInit, ViewChild } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { ImageSliderModel } from 'src/app/model/chq-images-slider';\r\nimport { CustomerFormData } from 'src/app/model/chq-new-case-form.model';\r\nimport { RepairEstimateDialogData, RepairEstimateDialogDataModel } from 'src/app/model/chq-repair-dialog-model';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { ChqWidgetsHeaderModel } from 'src/app/model/chq-widgets-header-model';\r\nimport { CommonService, i18nInfo } from 'src/app/services/common/common.service';\r\nimport { ChqRepairDialogComponent } from 'src/app/widgets/chq-repair-dialog/chq-repair-dialog.component';\r\nimport { ChqPdfGeneratorComponent } from 'src/app/widgets/chq-pdf-generator/chq-pdf-generator.component';\r\nimport { RepairEstimateService } from 'src/app/services/repair-estimate/repair-estimate.service';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { InspectionService } from 'src/app/services/inspection-service/inspection.service';\r\nimport { ChqWidgetsDropdownModel } from 'src/app/model/chq-widgets-dropdown-model';\r\nimport { BehaviorSubject, catchError, forkJoin, of } from 'rxjs';\r\nimport { MonitorService } from 'src/app/services/monitor-service/monitor.service';\r\nimport { GtMotiveEstimationDialogComponent } from 'src/app/dialogs/gt-motive-estimation-dialog/gt-motive-estimation-dialog.component';\r\nimport { Modules } from 'src/app/model/chq-upload-model';\r\n\r\nconst repairEstimate: ChqWidgetsHeaderModel = {\r\n  title: 'create_estimate',\r\n  step: 5,\r\n  description: 'create_estimate_msg',\r\n  stepName: 'step_five',\r\n};\r\n\r\n@Component({\r\n  selector: 'chq-repair-estimate',\r\n  templateUrl: './chq-repair-estimate.component.html',\r\n  styleUrls: [ './chq-repair-estimate.component.scss' ]\r\n})\r\nexport class ChqRepairEstimateComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  public header: ChqWidgetsHeaderModel = repairEstimate;\r\n\r\n  @Input() customerFormData: CustomerFormData = {\r\n    jobNumber: '1212',\r\n    companyOrgType: '',\r\n    claimNumber: '',\r\n    companyName: '',\r\n    tariffId: 0,\r\n    isTariffEditable: true,\r\n    licenseId: '',\r\n    companyId: 0,\r\n    partnershipId: 0,\r\n    firstName: 'John',\r\n    lastName: 'Doe',\r\n    driverCode: '+971',\r\n    driverPhone: 502302030,\r\n    carOwnerSelector: 'Person',\r\n    email: ''\r\n  };\r\n\r\n  private isInitCalled: boolean=false;\r\n  public closeCaseButton: ChqWidgetsButtonModel;\r\n  public approveCaseButton: ChqWidgetsButtonModel;\r\n  public rejectButton: ChqWidgetsButtonModel;\r\n  public calculationButton: ChqWidgetsButtonModel;\r\n  public createBooking: ChqWidgetsButtonModel;\r\n  public viewBooking: ChqWidgetsButtonModel;\r\n  public showDamageAnalysis: boolean;\r\n  public inspectionId: number;\r\n  public vehicleId: number;\r\n  public downloadUrl: string;\r\n  public repairId: string;\r\n  public domainId:number;\r\n\r\n  public images: ImageSliderModel[];\r\n  public dialogData: RepairEstimateDialogDataModel = RepairEstimateDialogData;\r\n  public pdfHTML: any;\r\n  public showGen: boolean = true;\r\n  public pageReady: boolean = false;\r\n  public caseGuid: string;\r\n  public customerData: any;\r\n  public caseData: any;\r\n  public caseResult: any;\r\n  public orgName:string;\r\n  public caseStatus: string;\r\n\r\n  public parts: any;\r\n  public paintCost: any;\r\n  public labourCost: any;\r\n  public paintLabour: any;\r\n  public paintMaterial: any;\r\n  public estimateResponse: any;\r\n\r\n  public showData: boolean = false;\r\n  public showInspection: boolean = false;\r\n  public pdfName: string = '';\r\n  public showNoAccess: boolean = false;\r\n  public editEstimate: boolean = false;\r\n  public estimateSource: string = '';\r\n  i18n: i18nInfo;\r\n  private currentOrgId: number;\r\n\r\n  @ViewChild(ChqPdfGeneratorComponent) elementRef: ChqPdfGeneratorComponent;\r\n  @ViewChild('anchor') anchor: any;\r\n\r\n  public dropdownModelFilter: ChqWidgetsDropdownModel = {\r\n    options: [\r\n      { 'label': 'Edit Calculations', 'dropdownItemIcon': 'edit' },\r\n      { 'label': 'Reject', 'dropdownItemIcon': 'cross', 'color': 'var(--xa-red) !important' },\r\n      { 'label': 'Approve', 'dropdownItemIcon': 'check' },\r\n      //{ 'label': 'Close Case', 'dropdownItemIcon': 'folderplus' },\r\n      { 'label': 'Complete', 'dropdownItemIcon': 'folderplus' }\r\n    ],\r\n    placeHolder: 'Options',\r\n    label: '',\r\n    appearance: 'button',\r\n    placeHolderIcon: 'settings',\r\n    name: 'option',\r\n    displayValue: 'label',\r\n    selectedOption: {}\r\n  };\r\n  history: any[] = [];\r\n  isHistoryLoading = false;\r\n\r\n  /**\r\n   * constructor\r\n   * @param fb ChangeDetectorRef\r\n   */\r\n  constructor(private cd: ChangeDetectorRef,\r\n    public commonService: CommonService,\r\n    private caseService: CaseService,\r\n    private repairEstimateService: RepairEstimateService,\r\n    private route: ActivatedRoute,\r\n    private monitorService: MonitorService,\r\n    private inspectionService: InspectionService,\r\n    public dialog: MatDialog,\r\n    private router: Router) {\r\n    if (this.commonService.accessRight.closed) {\r\n      this.commonService.accessRight = new BehaviorSubject<boolean>(true);\r\n    }\r\n\r\n    this.commonService.userProfileData.subscribe((res) => {\r\n      if (res && res.data) {\r\n        const { organizationDetail } = res.data;\r\n        if (organizationDetail) {\r\n          this.currentOrgId = organizationDetail.id;\r\n        }\r\n      }\r\n    });\r\n\r\n    this.i18n = this.commonService.geti18nInfo();\r\n  }\r\n\r\n\r\n  /**\r\n   * CHecks if current browser is mac or not\r\n   * @returns boolean\r\n   */\r\n  get isiOS(): boolean {\r\n    return [\r\n      'iPad Simulator',\r\n      'iPhone Simulator',\r\n      'iPod Simulator',\r\n      'iPad',\r\n      'iPhone',\r\n      'iPod'\r\n    ].includes(navigator.platform)\r\n      // iPad on iOS 13 detection\r\n      || (navigator.userAgent.includes('Mac') && 'ontouchend' in document)\r\n  }\r\n\r\n\r\n  /**\r\n   *\r\n   * @param event visibility listener\r\n   */\r\n  @HostListener('document:visibilitychange', [ '$event' ])\r\n  handleVisibilityChange(event: any): void {\r\n    if (!this.isInitCalled || !this.isiOS || !this.orgName) {\r\n      return;\r\n    }\r\n\r\n    if (this.estimateResponse?.estimateCharges?.length == 0) {\r\n      this.getEstimationDetail(this.orgName);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * host listener\r\n   * @param event\r\n   */\r\n    @HostListener('window:popstate', [ '$event' ])\r\n  onPopState(event): void {\r\n    sessionStorage.setItem('update', '0');\r\n  }\r\n\r\n    /**\r\n   * ngAfterViewInit hook\r\n   * @param fb FormBuilder\r\n   */\r\n    ngAfterViewInit(): void {\r\n      this.commonService.updatePage('/quote/case/0', 'estimate');\r\n      this.cd.detectChanges();\r\n      this.showGen = false;\r\n      this.monitorService.logEvent('ngAfterViewInit', [ 'ChqRepairEstimateComponent', 'addenda-quote', {\r\n        caseId: this.caseGuid\r\n      } ]);\r\n    }\r\n\r\n    /**\r\n   * handle back\r\n   */\r\n    handleBack($event: { back: boolean }): void {\r\n      this.showDamageAnalysis = !$event.back;\r\n      if (!this.showDamageAnalysis) {\r\n        // this.triggerCaseHistory();\r\n      }\r\n\r\n      this.monitorService.logEvent('handleBack', [ 'ChqRepairEstimateComponent', 'addenda-quote', {\r\n        caseId: this.caseGuid\r\n      } ]);\r\n\r\n    }\r\n\r\n    /**\r\n   * onInit lifecycle hook\r\n  */\r\n    ngOnInit(): void {\r\n      this.caseGuid = this.route.parent?.snapshot.paramMap.get('id');\r\n      //this.checkRouteParams();\r\n      this.getCaseDetail();\r\n      this.isInitCalled = true;\r\n      this.closeCaseButton = {\r\n      //label: 'Close Case',\r\n        label: 'Complete',\r\n        type: 'primary',\r\n        icon: 'folderplus'\r\n      }\r\n\r\n      this.approveCaseButton = {\r\n        label: 'Approve',\r\n        type: 'success',\r\n        icon: 'check'\r\n      }\r\n\r\n      this.rejectButton = {\r\n        label: 'Reject',\r\n        type: 'outline-danger',\r\n        icon: 'cross'\r\n      }\r\n\r\n      this.calculationButton = {\r\n        label: 'Edit Calculations',\r\n        type: 'outline',\r\n        icon: 'edit',\r\n        onclick: this.editGtMotive.bind(this)\r\n      }\r\n\r\n      this.createBooking = {\r\n        label: 'Create Booking',\r\n        type: 'outline',\r\n        icon: 'calendar',\r\n      }\r\n      this.viewBooking = {\r\n        label: 'View Booking',\r\n        type: 'outline',\r\n        icon: 'view'\r\n      }\r\n\r\n      this.commonService.accessRight.subscribe({\r\n        next: (res: boolean) => {\r\n          if (!res) {\r\n            this.showNoAccess = true;\r\n          }\r\n        }\r\n      });\r\n      const container: any = document.querySelector('.addenda-container');\r\n      if (container) {\r\n        container.scrollTop = 0;\r\n      }\r\n\r\n      this.monitorService.logEvent('ngOnInit', [ 'ChqRepairEstimateComponent', 'addenda-quote', {\r\n        caseId: this.caseGuid\r\n      } ]);\r\n\r\n    }\r\n\r\n    /**\r\n     * edit gt motive\r\n     */\r\n    editGtMotive(): void {\r\n      if (this.repairId) {\r\n        this.commonService.showChangeWarningMessage(this.redirectToGtEstimate.bind(this), Modules.repair);\r\n      } else {\r\n        this.redirectToGtEstimate();\r\n      }\r\n    }\r\n\r\n    /**\r\n   * opens close case dialog\r\n   */\r\n    changeCaseStatusDialog(model: any): void {\r\n      let data = null;\r\n      let status = '';\r\n      if (model?.value?.label == 'Edit Calculations' || model?.label == 'Edit Calculations') {\r\n        if (this.repairId) {\r\n          this.commonService.showChangeWarningMessage(this.redirectToGtEstimate.bind(this), Modules.repair);\r\n        } else {\r\n          this.redirectToGtEstimate();\r\n        }\r\n        return;\r\n      } else if (model?.value?.label == 'Approve' || model?.label == 'Approve') {\r\n        data = this.dialogData.approve;\r\n        status = 'Approved';\r\n      } else if (model?.value?.label == 'Complete' || model?.label == 'Complete') {\r\n        data = this.dialogData.complete;\r\n        status = 'Complete';\r\n      } else if (model?.value?.label == 'Reject' || model?.label == 'Reject') {\r\n        data = this.dialogData.reject;\r\n        status = 'Rejected';\r\n      } else if (model?.value?.label == 'View Booking' || model?.label == 'View Booking') {\r\n        this.booking('view', this.repairId);\r\n        return;\r\n      } else if (model?.value?.label == 'Create Booking' || model?.label == 'Create Booking') {\r\n        this.booking('create', '');\r\n        return;\r\n      }\r\n\r\n      this.monitorService.logEvent('changeCaseStatusDialog', [ 'ChqRepairEstimateComponent', 'addenda-quote', {\r\n        caseId: this.caseGuid,\r\n        status\r\n      } ]);\r\n\r\n      const dialogRef = this.dialog.open(ChqRepairDialogComponent, {\r\n        autoFocus: false,\r\n        data:\r\n        data\r\n      });\r\n\r\n      dialogRef.afterClosed().subscribe({\r\n        next: (data: any) => {\r\n          this.commonService.showLoading();\r\n          if (!data) {\r\n            this.commonService.hideLoading();\r\n            return;\r\n          }\r\n\r\n\r\n          this.caseService.updateCaseStatus(this.caseGuid, status, data.data).subscribe({\r\n            next: () => {\r\n              this.monitorService.logEvent('updateCaseStatus', [ 'ChqRepairEstimateComponent', 'addenda-quote', {\r\n                caseId: this.caseGuid,\r\n                status\r\n              } ]);\r\n              this.caseStatus = status;\r\n              // this.childC.pageReady = false;\r\n              this.toggleOption(status)\r\n            },\r\n            complete: () => {\r\n              this.commonService.hideLoading();\r\n            },\r\n            error: () => {\r\n              this.commonService.hideLoading();\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n\r\n    /**\r\n   * go to gtEstimate\r\n   */\r\n    redirectToGtEstimate(): void {\r\n      this.commonService.showLoading();\r\n      this.monitorService.logEvent('redirectToGtEstimate', [ 'ChqRepairEstimateComponent', 'addenda-quote', {\r\n        caseId: this.caseGuid,\r\n        status\r\n      } ]);\r\n      if (this.route.snapshot.queryParams['send'] && this.route.snapshot.queryParams['send'] == 'true') {\r\n        this.router.navigate(\r\n          [],\r\n          {\r\n            relativeTo: this.route,\r\n            queryParams: { send: 'false' },\r\n            queryParamsHandling: 'merge'\r\n          });\r\n      }\r\n      this.repairEstimateService.createEstimate(this.caseGuid, this.inspectionId, this.vehicleId, this.domainId).subscribe({\r\n        next: (resp: any) => {\r\n          if (resp) {\r\n            location.href = resp.data.url;\r\n            sessionStorage.setItem('update', '1');\r\n          }\r\n        },\r\n        complete: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      });\r\n    }\r\n\r\n    /**\r\n   * trigger case history\r\n  */\r\n    // triggerCaseHistory(): void {\r\n    //   this.childC.pageReady = false;\r\n    //   this.childC.getCaseHistory(3000);\r\n    //   this.getCaseHistory();\r\n    // }\r\n\r\n    /**\r\n   * downloadPdf()\r\n  */\r\n    public downloadPdf(): void {\r\n      this.commonService.showLoading();\r\n      const apiCall = 'getXADownloadUrl';\r\n      this.monitorService.logEvent('downloadPdf', [ 'ChqRepairEstimateComponent', 'addenda-quote', {\r\n        caseId: this.caseGuid\r\n      } ]);\r\n      this.repairEstimateService[apiCall](this.caseGuid).subscribe({\r\n        next: (result: any) => {\r\n          window.open(result.data.url, '_top');\r\n          this.commonService.hideLoading();\r\n        },\r\n        error: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      })\r\n    }\r\n\r\n    /**\r\n   * is case rejection/approved\r\n   */\r\n    get currentRejStatus(): boolean {\r\n      if (!this.caseStatus) {\r\n        return false;\r\n      }\r\n      return [ 'approved', 'closed', 'complete' ].indexOf(this.caseStatus?.toLowerCase()) === -1;\r\n    }\r\n\r\n    /**\r\n   * is case pending\r\n   */\r\n    get currentStatus(): boolean {\r\n      if (!this.caseStatus) {\r\n        return false;\r\n      }\r\n      return [ 'approved', 'closed', 'complete' ].indexOf(this.caseStatus?.toLowerCase()) === -1;\r\n    }\r\n\r\n    /**\r\n   * Get Case History\r\n   */\r\n    getCaseHistory(): void {\r\n      this.history = [];\r\n      this.isHistoryLoading = true;\r\n      this.caseService.getCaseHistory(this.caseGuid, this.domainId).subscribe({\r\n        next: (response) => {\r\n          this.history = response;\r\n        },\r\n        complete: () => {\r\n          this.isHistoryLoading = false\r\n        }\r\n      });\r\n    }\r\n\r\n    /**\r\n   * get case Detail\r\n  */\r\n    getCaseDetail(): void {\r\n      this.caseService.getCaseDetail(this.caseGuid).subscribe({\r\n        next: (response: any) => {\r\n\r\n          if (response?.data) {\r\n            const { inspections, vehicleId, status, orgName, repairGuid, domainID } = response.data;\r\n\r\n            this.commonService.caseStatus.next(status);\r\n            this.inspectionId = inspections ? inspections[0]?.inspectionId : '';\r\n            if ([ 'uploadphotos', 'repairestimation', 'closed', 'rejected', 'approved', 'complete', 'pendingapproval', 'readytoinvoice', 'invoiceready' ].indexOf(status.toLowerCase()) === -1) {\r\n              return;\r\n            }\r\n            this.vehicleId = vehicleId;\r\n            this.repairId = repairGuid;\r\n            this.caseStatus = status;\r\n            this.domainId = domainID;\r\n\r\n            this.toggleOption(status);\r\n            this.header.caseNumber = response.data.caseNumber;\r\n\r\n\r\n            this.caseResult = response.data;\r\n            this.customerData = response.data.caseDetail;\r\n            this.orgName = orgName;\r\n\r\n            this.customerData = {\r\n              ...this.customerData, initial: this.customerData.firstName?.substring(0, 1).toUpperCase()\r\n              + this.customerData.lastName?.substring(0, 1).toUpperCase()\r\n            };\r\n            this.pageReady = true;\r\n\r\n            if (this.currentOrgId != response.data.organizationDetail?.organizationId) {\r\n              this.commonService.isViewOnly = true;\r\n            }else{\r\n              this.commonService.isViewOnly = false;\r\n            }\r\n\r\n            const isUpdate = sessionStorage.getItem('update') || '0';\r\n            if (isUpdate === '0') {\r\n              this.getEstimationDetail(orgName);\r\n              this.commonService.updatePage('/quote/case/0', 'estimate');\r\n            } else if (isUpdate === '1' && this.route.snapshot.queryParams['send'] && this.route.snapshot.queryParams['send'] == 'true') {\r\n              this.repairEstimateService.readUpdateEstimate(this.caseGuid, response.data.inspections[0].inspectionId,\r\n                response.data.vehicleId, 'put', this.domainId)\r\n                .subscribe({\r\n                  next: () => {\r\n                  //get call\r\n                    sessionStorage.setItem('update', '0');\r\n\r\n                    this.getEstimationDetail(orgName);\r\n\r\n                    this.router.navigate(\r\n                      [],\r\n                      {\r\n                        relativeTo: this.route,\r\n                        queryParams: { send: 'false' },\r\n                        queryParamsHandling: 'merge'\r\n                      });\r\n\r\n                    this.commonService.hideLoading();\r\n                    setTimeout(()=>{\r\n                      this.commonService.updatePage('/quote/case/0', 'estimate');\r\n                    });\r\n\r\n                  }\r\n                });\r\n            } else {\r\n              this.getEstimationDetail(orgName);\r\n            }\r\n\r\n          }\r\n        },\r\n        error: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      });\r\n    }\r\n\r\n    /**\r\n   * get estimation detail\r\n   */\r\n    getEstimationDetail(orgName: string): void {\r\n      this.repairEstimateService.getEstimate(this.caseGuid, this.inspectionId, this.vehicleId, this.domainId).subscribe({\r\n        next: (response) => {\r\n          this.estimateResponse = response.data;\r\n          this.caseData = { 'vehicleMake': this.estimateResponse.make, 'vehicleModel': this.estimateResponse.modelCode }\r\n          this.estimateResponse.orgName = orgName;\r\n          this.estimateSource = response.data?.externalSource;\r\n          if(!this.estimateResponse.currencyCode) {\r\n            this.estimateResponse.currencyCode = this.i18n.currencySymbol;\r\n          }\r\n          if (this.estimateResponse?.estimateCharges?.length == 0) {\r\n            this.commonService.hideLoading();\r\n            this.showConfirmationPopup();\r\n          } else {\r\n          //this.pageReady = true;\r\n            this.getInspection();\r\n            this.showData = true;\r\n          }\r\n\r\n          this.commonService.hideLoading();\r\n        },\r\n        error: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      })\r\n    }\r\n\r\n    /**\r\n   * get inspection call\r\n   */\r\n    getInspection(): void {\r\n\r\n      this.inspectionService.getInspectionTemplateList().subscribe({\r\n        next: (response: any) => {\r\n          const repairInspectionTemplate = response?.data;\r\n\r\n          if(repairInspectionTemplate?.length > 0){\r\n            this.commonService.repairInspectionTemplate = repairInspectionTemplate[0];\r\n            const inspectionTemplateId = repairInspectionTemplate[0].id;\r\n\r\n            const apiData = forkJoin({\r\n              inspectionTemplate: this.inspectionService.getInspectionTemplate(inspectionTemplateId),\r\n              inspectionDetail: this.inspectionService.getInspection(this.inspectionId)\r\n            }).pipe(\r\n              catchError(error => of(error))\r\n            )\r\n            apiData.subscribe((resultMap: any) => {\r\n              const inspectionTemplateDetail = resultMap.inspectionTemplate?.inspectionItemTemplates;\r\n              const inspectionItems = resultMap.inspectionDetail;\r\n              const bulkUploadTemplateItem = inspectionTemplateDetail?.filter(step => step.name === 'Bulk Upload Image');\r\n              this.images = inspectionItems?.inspectionItems?.filter(q => ((q.name == 'Bulk Upload Image' ||\r\n              q.inspectionItemTemplateID === bulkUploadTemplateItem[0].id)\r\n              && q.rawAzureBlobUrl != '')).map(q => q.rawAzureBlobUrl);\r\n              if (this.images?.length == 0) {\r\n                this.images = inspectionItems?.inspectionItems?.filter(\r\n                  q => (q.name != 'Bulk Upload Image' && q.rawAzureBlobUrl != '')).map(q => q.rawAzureBlobUrl\r\n                );\r\n              }\r\n\r\n              this.showInspection = true;\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n    }\r\n\r\n    /**\r\n   * show confirmation popup to navigate to gt estimate if all the estimate charges are 0\r\n   */\r\n    showConfirmationPopup(): void {\r\n      const dialogRef = this.dialog.open(GtMotiveEstimationDialogComponent, {\r\n        disableClose: true,\r\n        data: {\r\n          message: 'The estimate values are 0. Press continue to navigate to gtmotive.'\r\n        },\r\n        backdropClass: 'confirmation-popup-backdrop'\r\n      });\r\n\r\n      dialogRef.afterClosed().subscribe({\r\n        next: (response: any) => {\r\n          console.log(response);\r\n          if (response) {\r\n            this.redirectToGtEstimate();\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    /**\r\n   * tooggle options\r\n   * @param status\r\n   */\r\n    toggleOption(status: string): void {\r\n\r\n      if (status.toLowerCase() === 'reject' || status.toLowerCase() === 'rejected') {\r\n        this.dropdownModelFilter = {\r\n          ...this.dropdownModelFilter,\r\n          ...{\r\n            options: [\r\n              { 'label': 'Edit Calculations', 'dropdownItemIcon': 'edit' },\r\n              { 'label': 'Reject', 'dropdownItemIcon': 'cross', 'color': 'var(--xa-red) !important' },\r\n              { 'label': 'Approve', 'dropdownItemIcon': 'check' },\r\n              //{ 'label': 'Close Case', 'dropdownItemIcon': 'folderplus' }\r\n              { 'label': 'Complete', 'dropdownItemIcon': 'folderplus' }\r\n            ]\r\n          }\r\n        }\r\n      } else if (status.toLowerCase() === 'approved') {\r\n        this.dropdownModelFilter = {\r\n          ...this.dropdownModelFilter,\r\n          ...{\r\n            options: [\r\n            //{ 'label': 'Close Case', 'dropdownItemIcon': 'folderplus' }\r\n              { 'label': 'Complete', 'dropdownItemIcon': 'folderplus' }\r\n            ]\r\n          }\r\n        }\r\n      } else if(status.toLowerCase() === 'complete'){\r\n        this.dropdownModelFilter = {\r\n          ...this.dropdownModelFilter,\r\n          ...{\r\n            options: []\r\n          }\r\n        }\r\n      } else {\r\n        this.dropdownModelFilter = {\r\n          ...this.dropdownModelFilter,\r\n          ...{\r\n            options: [\r\n              { 'label': 'Edit Calculations', 'dropdownItemIcon': 'edit' },\r\n              { 'label': 'Reject', 'dropdownItemIcon': 'cross', 'color': 'var(--xa-red) !important' },\r\n              { 'label': 'Approve', 'dropdownItemIcon': 'check' },\r\n              //{ 'label': 'Close Case', 'dropdownItemIcon': 'folderplus' }\r\n              { 'label': 'Complete', 'dropdownItemIcon': 'folderplus' }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    /**\r\n   * navigate to booking\r\n   * @param action\r\n   */\r\n    booking(action: string, bookingId:string): void {\r\n      if(action === 'create') {\r\n        this.router.navigate([ 'repair/booking/0' ], { queryParams: { 'caseId': this.caseGuid } });\r\n      } else {\r\n        this.router.navigate([ `repair/booking/${bookingId}` ]);\r\n      }\r\n    }\r\n\r\n    /**\r\n   * on destroy\r\n   */\r\n    ngOnDestroy(): void {\r\n      this.commonService.accessRight.unsubscribe();\r\n      this.monitorService.logEvent('ngOnDestroy', [ 'ChqRepairEstimateComponent', 'addenda-quote' ]);\r\n      this.commonService.isViewOnly = false;\r\n    }\r\n\r\n    /**\r\n      Returns a boolean value indicating whether the estimate source is 'GTmotive'.\r\n      @returns {string} A boolean value indicating whether the estimate source is 'GTmotive'.\r\n    */\r\n    isGTEstimate(): boolean {\r\n      if(this.estimateSource === 'GTMotive') {\r\n        return true\r\n      }\r\n      return false;\r\n    }\r\n\r\n    /**\r\n      Returns a boolean value indicating whether the estimate source is 'GTmotive'.\r\n      @returns {string} A boolean value indicating whether the estimate source is 'GTmotive'.\r\n    */\r\n    isPendingApproval(): boolean {\r\n      if(this.caseStatus?.toLowerCase() === 'pendingapproval') {\r\n        return true\r\n      }\r\n      return false;\r\n    }\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Resolve } from '@angular/router';\r\n\r\nimport { catchError, map, Observable, of } from 'rxjs';\r\nimport { CommonService } from '../services/common/common.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class VersionControlResolver implements Resolve<Observable<any>> {\r\n  /**\r\n   * contructor\r\n   * @param commonService \r\n   */\r\n  constructor(private commonService: CommonService) { }\r\n  /**\r\n   * resolve the \r\n   * @returns \r\n   */\r\n  resolve(): Observable<any> {\r\n    this.commonService.showLoading();\r\n    return this.commonService.checkVersion().pipe(\r\n      map((res) => {\r\n        this.commonService.hideLoading();\r\n        const localVersion = localStorage.getItem('appVersion');\r\n        const appVersion = res.buildRevision;\r\n        if (localVersion && localVersion != appVersion) {\r\n          localStorage.setItem('appVersion', appVersion);\r\n          setTimeout(() => {\r\n            location.reload();\r\n          }, 10);\r\n          return of('new version available');\r\n        } else {\r\n          localStorage.setItem('appVersion', appVersion);\r\n          return of('new version is not available');\r\n        }\r\n      }),\r\n      catchError(() => {\r\n        this.commonService.hideLoading();\r\n        return of('data not available at this time');\r\n      })\r\n    )\r\n  }\r\n}"]}