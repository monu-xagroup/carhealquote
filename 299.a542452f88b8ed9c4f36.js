"use strict";(self.webpackChunkcar_heal_quote=self.webpackChunkcar_heal_quote||[]).push([[299],{14368:(ae,K,d)=>{d.d(K,{I:()=>j});var e=d(22238),n=d(37716),D=d(95016),F=d(29790);let j=(()=>{class b{constructor(p,Q,V){this.dialogRef=p,this.monitorService=Q,this.data=V}continue(){this.dialogRef.close(!0),this.monitorService.logEvent("close",["GtMotiveEstimationDialogComponent","addenda-quote"])}}return b.\u0275fac=function(p){return new(p||b)(n.Y36(e.so),n.Y36(D.M),n.Y36(e.WI))},b.\u0275cmp=n.Xpm({type:b,selectors:[["app-gt-motive-estimation-dialog"]],decls:11,vars:3,consts:[[1,"message-container"],[1,"header"],[1,"content"],[1,"footer","form-data-footer"],["mat-dialog-close","",1,"btn-confirm",3,"click"]],template:function(p,Q){1&p&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"h3"),n._uU(3,"Notification!"),n.qZA(),n.qZA(),n.TgZ(4,"div",2),n.TgZ(5,"label"),n._uU(6),n.ALo(7,"translate"),n.qZA(),n.qZA(),n.TgZ(8,"div",3),n.TgZ(9,"button",4),n.NdJ("click",function(){return Q.continue()}),n._uU(10,"Continue"),n.qZA(),n.qZA(),n.qZA()),2&p&&(n.xp6(6),n.Oqu(n.lcZ(7,1,Q.data.message)))},directives:[e.ZT],pipes:[F.X$],styles:[".message-container[_ngcontent-%COMP%]{padding:20px 20px 40px 62px;width:480px;background-color:var(--xa-white)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:38px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:32px;margin-right:38px}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;margin-top:52px;margin-right:38px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;display:block;background-color:var(--xa-black);color:#fff}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{margin-right:4px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:4px}"]}),b})()},60562:(ae,K,d)=>{d.d(K,{br:()=>n,mo:()=>D,nG:()=>F,Gp:()=>j});var e=d(3679);const n=()=>({vin:{placeHolder:"search_vin",name:"vin",label:"vin_number",type:"text",value:0,icon:"search",maxLength:17,validation:{name:"vin",validationFunction:()=>e.kI.compose([e.kI.minLength(17),e.kI.pattern("^[a-hA-Hj-nJ-NpPr-zR-Z0-9]+$")]),validationMessage:b=>b.pattern?"pattern_vin":b.minlength?"min_length_vin":""}},make:{placeHolder:"make",name:"make",label:"make",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:0,validation:{name:"make",validationFunction:()=>e.kI.compose([e.kI.required]),validationMessage:b=>b.required?"required_make":""}},model:{placeHolder:"model",name:"model",label:"model",options:[{}],displayValue:"modelDescription",fieldValue:"modelDescription",type:"select",value:0,validation:{name:"model",validationFunction:()=>e.kI.compose([e.kI.required]),validationMessage:b=>b.required?"required_model":""}},year:{placeHolder:"import_interval",label:"import_interval",name:"year",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:0,validation:{name:"year",validationFunction:()=>e.kI.compose([e.kI.required]),validationMessage:b=>b.required?"required_year":""}},licensePlate:{placeHolder:"license_plate",label:"license_plate",name:"licensePlate",value:0,type:"text",maxLength:12,validation:{name:"licensePlate",validationFunction:()=>e.kI.compose([e.kI.required,e.kI.maxLength(12),e.kI.pattern("^[a-zA-Z0-9]*$"),j()]),validationMessage:b=>b.required?"required_license_plate":b.maxlength?"max_length_license_plate":b.pattern?"pattern_digit_alphabets":b.invalidLicensePlate?"invalid_license_plate":""}},carMilege:{placeHolder:"car_mileage",label:"mileage",name:"carMilege",value:0,type:"text",maxLength:7,validation:{name:"carMilege",validationFunction:()=>e.kI.compose([e.kI.required,e.kI.maxLength(7),e.kI.pattern("^[0-9]+$"),F()]),validationMessage:b=>b.required?"required_car_mileage":b.maxlength?"max_length_car_mileage":b.pattern?"pattern_numeric":b.invalidCarMileage?"invalid_car_mileage":""}},registrationDate:{placeHolder:"first_reg_mfg_date",label:"reg_mfg_date",name:"registrationDate",value:"",type:"date",maxDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-1),minDate:new Date("1980-01-01"),disabled:!0,validation:{name:"registrationDate",validationFunction:()=>e.kI.compose([e.kI.required]),validationMessage:b=>b.required?"required_date":""}}}),D={title:"add_vehicle",step:2,description:"add_vehicle_msg",stepName:"step_two"};function F(){const b={invalidCarMileage:!1};return N=>N.value<1&&""!=N.value?(b.invalidCarMileage=!0,b):null}function j(){const b={invalidLicensePlate:!1};return N=>"0"===N.value?(b.invalidLicensePlate=!0,b):null}},74743:(ae,K,d)=>{d.d(K,{n:()=>b});var e=d(27969),n=d(84945),D=d(33568),F=d(37716),j=d(4893);let b=(()=>{class N{constructor(Q){this.commonService=Q}resolve(){return this.commonService.showLoading(),this.commonService.checkVersion().pipe((0,e.U)(Q=>{this.commonService.hideLoading();const V=localStorage.getItem("appVersion"),Y=Q.buildRevision;return V&&V!=Y?(localStorage.setItem("appVersion",Y),setTimeout(()=>{location.reload()},10),(0,n.of)("new version available")):(localStorage.setItem("appVersion",Y),(0,n.of)("new version is not available"))}),(0,D.K)(()=>(this.commonService.hideLoading(),(0,n.of)("data not available at this time"))))}}return N.\u0275fac=function(Q){return new(Q||N)(F.LFG(j.v))},N.\u0275prov=F.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})()},62119:(ae,K,d)=>{d.d(K,{b:()=>le});var e=d(37716),n=d(95016),D=d(4893),F=d(55278),j=d(22238),b=d(38709),N=d(13975),p=d(87855),Q=d(56785),V=d(38583),Y=d(35782),te=d(36978),A=d(29790);function v(U,$){if(1&U&&e._UZ(0,"chq-step-header",11),2&U){const O=e.oxw();e.Q6J("chqModel",O.photosHeader)}}function w(U,$){if(1&U&&(e.TgZ(0,"div",15),e.TgZ(1,"label",16),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"p",17),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"p",18),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"chq-button",19),e.qZA()),2&U){const O=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,4,"smart_photo_inspection")),e.xp6(3),e.Oqu(e.lcZ(6,6,"open_your_camera")),e.xp6(3),e.hij(" ",e.lcZ(9,8,"add_photo_msg")," "),e.xp6(2),e.Q6J("buttonModel",O.cameraButtonModel)}}function B(U,$){if(1&U&&(e.TgZ(0,"div",15),e.TgZ(1,"label",16),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"p",17),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"p",18),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"chq-button",19),e.qZA()),2&U){const O=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,4,"bulk_upload")),e.xp6(3),e.Oqu(e.lcZ(6,6,"upload_device")),e.xp6(3),e.hij(" ",e.lcZ(9,8,"bulk_msg")," "),e.xp6(2),e.Q6J("buttonModel",O.bulkUploadButtonModel)}}function ee(U,$){if(1&U&&(e.TgZ(0,"div",12),e.TgZ(1,"div",13),e.YNc(2,w,11,10,"div",14),e.YNc(3,B,11,10,"div",14),e.qZA(),e.qZA()),2&U){const O=e.oxw();e.xp6(2),e.Q6J("ngIf",O.showSPI),e.xp6(1),e.Q6J("ngIf",!O.hideBulk)}}function ie(U,$){if(1&U&&(e.TgZ(0,"div",20),e.TgZ(1,"div",21),e._UZ(2,"img",22),e.TgZ(3,"label",23),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.qZA(),e.qZA()),2&U){const O=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,1,O.repairUnapproved?"start_job":"bulk_spi_disabled")," ")}}function oe(U,$){if(1&U&&e._UZ(0,"chq-button",19),2&U){const O=e.oxw();e.Q6J("buttonModel",O.cancelButtonModel)}}function J(U,$){if(1&U&&e._UZ(0,"chq-button",24),2&U){const O=e.oxw();e.Q6J("buttonModel",O.nextButton)}}const se={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let le=(()=>{class U{constructor(O,f,L,u,g,x,q,E,y){this.monitorService=O,this.commonService=f,this.route=L,this.dialog=u,this.caseService=g,this.router=x,this.inspectionService=q,this.estimateService=E,this.calendarService=y,this.mode=new e.vpe,this.showEstimate=!1,this.nextButton={label:"Next create estimate",type:"primary",color:"primary",icon:"boardview"},this.photosHeader=se,this.cameraButtonModel={label:"camera_upload",type:"primary",icon:"camera",color:"primary",onclick:this.allowSingleUpload.bind(this)},this.bulkUploadButtonModel={label:"btn_bulk_upload",type:"primary",icon:"upload",color:"primary",onclick:this.allowMultipleUpload.bind(this)},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)}}allowSingleUpload(){this.mode.emit({mode:"single"})}get showDelete(){var O,f,L,u,g,x,q;return!(!(null===(O=this.repairData)||void 0===O?void 0:O.repairGuid)||"draft"!==(null===(L=null===(f=this.repairData)||void 0===f?void 0:f.status)||void 0===L?void 0:L.toLowerCase()))||!(!(null===(u=this.repairData)||void 0===u?void 0:u.repairGuid)||1!=(null===(g=this.repairData)||void 0===g?void 0:g.repairGuidisRepairCreatedFromCase)||"repairestimation"!=(null===(q=null===(x=this.repairData)||void 0===x?void 0:x.status)||void 0===q?void 0:q.toLowerCase()))}ngOnChanges(O){this.monitorService.logEvent("allowMultipleUpload",["ChqAddPhotosComponent","addenda-quote",{changes:O}]),O&&O.caseNumber&&O.caseNumber.currentValue&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{caseNumber:this.caseNumber}))}allowMultipleUpload(){this.monitorService.logEvent("allowMultipleUpload",["ChqAddPhotosComponent","addenda-quote"]),this.mode.emit({mode:"multiple"})}redirectToGtEstimate(){this.commonService.showLoading();const{status:O,caseGuid:f,inspections:L,vehicleId:u,domainID:g}=this.caseData;let x=0;(null==L?void 0:L.length)>0&&(x=L[0].inspectionId),"uploaddocuments"===(null==O?void 0:O.toLowerCase())?(this.monitorService.logEvent("redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:f}]),this.caseService.updateCaseStatus(f,"UploadPhotos").subscribe({next:q=>{this.estimateService.createEstimate(f,x,u,g).subscribe({next:E=>{var y,I;E&&(null===(y=null==E?void 0:E.data)||void 0===y?void 0:y.url)&&(location.href=null===(I=null==E?void 0:E.data)||void 0===I?void 0:I.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}})},error:()=>{this.commonService.hideLoading()}})):"uploadphotos"===(null==O?void 0:O.toLowerCase())?(this.monitorService.logEvent("redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:f}]),this.estimateService.createEstimate(f,x,u,g).subscribe({next:q=>{q&&(null==q?void 0:q.data)&&(location.href=q.data.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}})):(this.monitorService.logEvent("skipped_redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:f}]),this.router.navigate([`/case/${f}/estimate`]))}ngOnInit(){this.nextButton.onclick=this.redirectToGtEstimate.bind(this)}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(O=>{var f,L;O&&(this.commonService.showLoading(),this.calendarService.deleteBooking(null===(L=null===(f=this.repairData)||void 0===f?void 0:f.booking)||void 0===L?void 0:L.bookingGuid).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}}return U.\u0275fac=function(O){return new(O||U)(e.Y36(n.M),e.Y36(D.v),e.Y36(F.gz),e.Y36(j.uw),e.Y36(b.n),e.Y36(F.F0),e.Y36(N.a),e.Y36(p.H),e.Y36(Q.o))},U.\u0275cmp=e.Xpm({type:U,selectors:[["add-photos"]],inputs:{caseNumber:"caseNumber",caseData:"caseData",showEstimate:"showEstimate",repairUnapproved:"repairUnapproved",repairData:"repairData",photosHeader:"photosHeader",showSPI:"showSPI",hideBulk:"hideBulk"},outputs:{mode:"mode"},features:[e.TTD],decls:11,vars:6,consts:[[1,"add-photo-container"],[3,"chqModel",4,"ngIf"],["class","photo-container",4,"ngIf"],["class","wrapper",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper","wrapper-flex"],[1,"image-wrapper"],[3,"src"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"],["class","margin-right",3,"buttonModel",4,"ngIf"],[3,"chqModel"],[1,"photo-container"],[1,"card-container"],["class","card",4,"ngIf"],[1,"card"],[1,"card-title"],[1,"card-action"],[1,"card-description"],[3,"buttonModel"],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"margin-right",3,"buttonModel"]],template:function(O,f){1&O&&(e.TgZ(0,"div",0),e.YNc(1,v,1,1,"chq-step-header",1),e.YNc(2,ee,4,2,"div",2),e.YNc(3,ie,6,3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e.TgZ(6,"div",6),e._UZ(7,"img",7),e.qZA(),e.TgZ(8,"div",8),e.YNc(9,oe,1,1,"chq-button",9),e.YNc(10,J,1,1,"chq-button",10),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&O&&(e.xp6(1),e.Q6J("ngIf",!0!==f.photosHeader.isRepairModule||!0===f.photosHeader.isHeaderOnly),e.xp6(1),e.Q6J("ngIf",(f.showSPI||!f.hideBulk)&&!f.repairUnapproved&&!f.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",!f.showSPI&&f.hideBulk||f.repairUnapproved||f.commonService.isViewOnly),e.xp6(4),e.MGl("src","assets/img/",+f.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",e.LSH),e.xp6(2),e.Q6J("ngIf",f.showDelete&&(null==f.photosHeader?null:f.photosHeader.isRepairModule)),e.xp6(1),e.Q6J("ngIf",f.showEstimate&&!f.photosHeader.isRepairModule))},directives:[V.O5,Y._,te.E],pipes:[A.X$],styles:[".photo-container[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:calc(100vh - 170px - (calc(1.5vw)) - (calc(5px + 1.5vw + 48px + 1.6vw)));justify-content:space-evenly;border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-card-dark);margin-top:calc(18px + 1.5vh);margin-bottom:calc(12px + 1.5vh)}.card-container[_ngcontent-%COMP%]{display:flex;justify-content:center;grid-gap:27px;gap:27px}.wrapper-flex[_ngcontent-%COMP%]{flex:1;justify-content:space-between;align-items:center}.margin-right[_ngcontent-%COMP%]{margin-right:20px}.card[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray);padding:16px;width:202px;background-color:var(--xa-white);border-radius:8px}.card-title[_ngcontent-%COMP%]{font-weight:600;font-size:16px;line-height:20px}.card-action[_ngcontent-%COMP%]{font-weight:600;font-size:12px;line-height:21px;margin:0;color:var(--xa-black-medium)}.card-description[_ngcontent-%COMP%]{font-size:12px;line-height:18px;margin-bottom:30px;color:var(--xa-dark-gray)}.image-car[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:654px}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:50px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),U})()},54135:(ae,K,d)=>{d.d(K,{U:()=>n});var e=d(37716);let n=(()=>{class D{}return D.\u0275fac=function(j){return new(j||D)},D.\u0275cmp=e.Xpm({type:D,selectors:[["no-access-error"]],decls:3,vars:0,consts:[[1,"main-container"],[1,""],["src","assets/img/no-access.png"]],template:function(j,b){1&j&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"img",2),e.qZA(),e.qZA())},styles:[".main-container[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column;align-items:center;justify-content:center}"]}),D})()},64307:(ae,K,d)=>{d.d(K,{O:()=>O});var e=d(97582),n=d(7408),D=d(54121),F=d(84967),j=d(33568),b=d(84945),N=d(83853),p=d(37716),Q=d(4893),V=d(55278),Y=d(38709),te=d(95016),A=d(8985),v=d(74178),w=d(38583),B=d(39912),ee=d(54135);const ie=["imageUploaders"];function oe(f,L){if(1&f){const u=p.EpF();p.TgZ(0,"chq-images-uploader",4,5),p.NdJ("cardSelection",function(x){return p.CHM(u),p.oxw(2).setObservable(x)})("stepSkipped",function(){return p.CHM(u),p.oxw(2).stepSkipped()}),p.qZA()}if(2&f){const u=p.oxw(2);p.Q6J("fileUploaderService",u.currentObservable)("footerOptions",u.footer)("imageStatusSteps",u.imageStatusSteps)("header",u.documentHeader)}}function J(f,L){1&f&&(p.TgZ(0,"div",6),p.TgZ(1,"div",7),p._UZ(2,"img",8),p.TgZ(3,"label",9),p._uU(4," No Content Available "),p.qZA(),p.qZA(),p.TgZ(5,"div",10),p._UZ(6,"div",11),p._UZ(7,"div",11),p._UZ(8,"div",11),p._UZ(9,"div",11),p.qZA(),p.qZA())}function se(f,L){if(1&f&&(p.TgZ(0,"div",12),p.TgZ(1,"div",13),p.TgZ(2,"div",14),p._UZ(3,"img",15),p.qZA(),p.qZA(),p.qZA()),2&f){const u=p.oxw(2);p.xp6(3),p.MGl("src","assets/img/",+u.documentHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",p.LSH)}}function le(f,L){if(1&f&&(p.TgZ(0,"div"),p.YNc(1,oe,2,4,"chq-images-uploader",1),p.YNc(2,J,10,0,"div",2),p.YNc(3,se,4,1,"div",3),p.qZA()),2&f){const u=p.oxw();p.xp6(1),p.Q6J("ngIf",u.imageStatusSteps&&u.imageStatusSteps.length>0),p.xp6(1),p.Q6J("ngIf",u.noDocumentData),p.xp6(1),p.Q6J("ngIf",u.noDocumentData)}}function U(f,L){1&f&&p._UZ(0,"no-access-error")}const $={title:"add_documents",step:3,description:"add_documents_msg",stepName:"step_three"};let O=(()=>{class f{constructor(u,g,x,q,E,y,I){this.cd=u,this.commonService=g,this.route=x,this.caseService=q,this.monitorService=E,this.bookingService=y,this.mediaCollectionService=I,this.documentHeader=$,this.imageStatusSteps=[],this.allowExtension=["jpg","jpeg","png"],this.skipButtonModel={label:"Skip",type:"primary"},this.footer={text:"Next add photos",icon:"review",route:"quote/case/photos",currentStatus:"",status:"UploadDocuments",caseId:""},this.documentSizeLimit=5242880,this.noDocumentData=!1,this.repairId="",this.currentRepairStatus="",this.showNoAccess=!1,this.statusUpdated=!1,g.pageName.closed&&(g.pageName=new D.X(null)),g.pageName.next("document"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new D.X(!0))}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","document"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["ChqNewDocumentsComponent","addenda-quote"])}checkRouteParams(){var u;null===(u=this.route.queryParams)||void 0===u||u.subscribe(g=>{const x=g.fromPersonal;("true"===x||!0===x)&&(this.imageStatusSteps=this.imageStatusSteps.filter(q=>-1!=q.stepName.indexOf("Vehicle Registration")))})}setObservable(u){this.currentObservable=u.uploadedGuid&&u.uploadedPartGuid?this.updateFile.bind(this):this.uploadFile.bind(this)}getMediaTemplateByObject(){var u;this.mediaPartTemplates=this.commonService.getAllChild(null===(u=this.mediaTemplate)||void 0===u?void 0:u.mediaTemplates,"mediaPartTemplates","mediaTemplateGuid",{parentProp:"name",childProp:"parentName"});for(let g=0;g<this.mediaPartTemplates.length;g++){const x=this.mediaPartTemplates[g],q=(0,N.sH)(x,g),y=-1!=q.stepName.toLowerCase().indexOf("additional document")&&!q.url;this.imageStatusSteps.push(Object.assign(Object.assign({},q),{mandatory:x.mandatory,index:g,isAdditionalDocumentFromReviewPageOnly:y,parentName:x.parentName,isFront:x.frontSide,updatedDate:"00000000-0000-0000-0000-000000000000"!=x.mediaPartGuid?x.updatedDate:"",uploadedDate:"00000000-0000-0000-0000-000000000000"!=x.mediaPartGuid?x.createdDate:"",domainId:this.domainId,objectId:this.objectId,sizeLimit:x.sizeLimit,allowExtension:x.allowExtension,uploadedPartGuid:"00000000-0000-0000-0000-000000000000"!=x.mediaPartGuid?x.mediaPartGuid:"",uploadedGuid:"00000000-0000-0000-0000-000000000000"!=x.mediaGuid?x.mediaGuid:"",partTemplateGuid:x.mediaPartTemplateGuid,templateGuid:x.mediaTemplateGuid})),this.checkRouteParams()}}updateRepairStatus(u){this.statusUpdated||(this.statusUpdated=!0,this.bookingService.updateRepairStatus("UploadDocuments",u,"").subscribe({next:()=>{this.currentRepairStatus="UploadDocuments",this.footer.currentStatus=this.currentRepairStatus,this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairId).subscribe({next:g=>(0,e.mG)(this,void 0,void 0,function*(){(null==g?void 0:g.data)&&(this.commonService.repairDetails.next(g.data),this.commonService.bookingId.next(g.data.repairNumber),this.commonService.hideLoading())}),error:g=>{this.monitorService.logException(g,n._.Error),this.commonService.hideLoading()}})}}))}uploadFile(u){const g={mediaCollectionId:this.mediaTemplate.collectionGuid,domainId:this.domainId,objectId:this.objectId,mediaTemplateId:u.templateGuid,mediaPartTemplateId:u.partTemplateGuid};this.monitorService.logEvent("uploadFile",["ChqNewDocumentsComponent","addenda-quote",{obj:g}]),u.uploadInProgress=!0,u.isSkipped=!1,u.isUploadFailed=!1,u.isUploadSuccess=!1,this.commonService.showNotification("Your photo is currently uploading won\u2019t be long and we\u2019ll \n    notify you when its uploaded, you can continue to take your photos."),this.mediaCollectionService.uploadDocument(u.imageFile,g).subscribe({next:q=>{var E,y,I;const W=null==q?void 0:q.data,Z=null===(E=this.mediaPartTemplates)||void 0===E?void 0:E.find(G=>G.mediaPartTemplateGuid==(null==W?void 0:W.mediaPartTemplateId));Z&&(Z.mediaGuid=W.mediaGuid,Z.mediaPartGuid=W.mediaPartGuid,location.href.includes("repair")&&"draft"===(null===(y=this.currentRepairStatus)||void 0===y?void 0:y.toLowerCase())&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"vehicledetails"===(null===(I=this.footer.currentStatus)||void 0===I?void 0:I.toLowerCase())&&this.updateStatus(),this.imageUploaders.updateUploadStatus("success",u,null,W))},error:q=>{if(401!=q.status)try{this.imageUploaders.updateUploadStatus("failed",u,q)}catch(E){this.imageUploaders.updateUploadStatus("failed",u)}this.monitorService.logException(q,n._.Error)},complete:()=>this.commonService.hideLoading()})}updateFile(u){const g={objectId:this.objectId,mediaGuid:u.uploadedGuid,mediaPartGuid:u.uploadedPartGuid};this.monitorService.logEvent("updateFile",["ChqNewDocumentsComponent","addenda-quote",{obj:g}]),u.uploadInProgress=!0,u.isSkipped=!1,u.isUploadFailed=!1,u.isUploadSuccess=!1,this.mediaCollectionService.updateDocument(u.imageFile,g).subscribe({next:x=>{this.imageUploaders.updateUploadStatus("success",u)},error:x=>{if(401!=x.status)try{this.imageUploaders.updateUploadStatus("failed",u,x)}catch(q){this.imageUploaders.updateUploadStatus("failed",u)}this.monitorService.logException(x,n._.Error)},complete:()=>this.commonService.hideLoading()})}updateStatus(){this.statusUpdated||(this.statusUpdated=!0,this.monitorService.logEvent("updateStatus",["ChqNewDocumentsComponent","addenda-quote",{caseId:this.footer.caseId}]),this.caseService.updateCaseStatus(this.footer.caseId,"UploadDocuments").subscribe({next:()=>{this.footer=Object.assign(Object.assign({},this.footer),{status:""})}}))}mapMediaTemplate(u){if(this.mediaTemplate)try{for(let g=0;g<this.mediaTemplate.mediaTemplates.length;g++){const x=this.mediaTemplate.mediaTemplates[g],q=u.find(E=>E.mediaTemplateGuid==x.mediaTemplateGuid);if(q)for(let E=0;E<x.mediaPartTemplates.length;E++){const y=x.mediaPartTemplates[E],I=q.mediaParts.find(W=>W.mediaPartTemplateGuid==y.mediaPartTemplateGuid);y.mediaGuid=q.mediaGuid,y.mediaPartGuid=I.mediaPartGuid,y.createdDate=I.createdDate,y.updatedDate=I.updatedDate,y.image=I.getURL,y.isUploadSuccess=!1,y.mediaPartGuid&&"00000000-0000-0000-0000-000000000000"!=y.mediaPartGuid&&(y.isUploadSuccess=!0)}}this.mediaTemplate=Object.assign({},this.mediaTemplate)}catch(g){console.log(g)}}ngOnInit(){var u;this.commonService.showLoading();const g=null===(u=this.route.parent)||void 0===u?void 0:u.snapshot.paramMap.get("id");this.monitorService.logEvent("ngOnInit",["ChqNewDocumentsComponent","addenda-quote",{caseId:g}]),this.footer=Object.assign(Object.assign({},this.footer),{route:`quote/case/${g}/photos`,caseId:g}),this.commonService.accessRight.subscribe({next:I=>{I||(this.showNoAccess=!0)}});const x={mediaTemplate:this.mediaCollectionService.getMediaTemplate()};let q=!1;location.href.includes("repair")?(x.bookingDetail=this.bookingService.getRepairDetailByGuid(g),q=!0):(this.commonService.userProfileData.subscribe(I=>{if(I&&I.data){const{organizationDetail:W}=I.data;this.currentOrgId=W.id}}),x.caseDetail=this.caseService.getCaseDetail(g)),(0,F.D)(x).pipe((0,j.K)(I=>(0,b.of)(I))).subscribe(I=>{if(I){const W=I.mediaTemplate;if(W){const Z=W.data;if(I.caseDetail){const{caseNumber:G,id:s,status:m,inspections:o,repairGuid:_,organizationDetail:a}=I.caseDetail.data;this.commonService.isViewOnly=this.currentOrgId!=(null==a?void 0:a.organizationId),o.length>0&&this.commonService.inspectionId.next(o[0].inspectionId),this.commonService.caseStatus.next(m),"vehicledetails"===m.toLowerCase()||(this.footer=Object.assign(Object.assign({},this.footer),{status:""})),this.footer.currentStatus=m,this.documentHeader.caseNumber=G,this.objectId=s,_&&(this.footer.repairId=_,this.footer.from="Quote")}if(I.bookingDetail){const{id:G,status:s,repairGuid:m,quoteId:o,repairNumber:_,isRepairCreatedFromCase:a,booking:t}=I.bookingDetail.data;this.objectId=G,this.repairId=m,o&&(this.footer.caseId=o,this.footer.from="Repair"),this.footer.isRepairCreatedFromCase=a,this.footer.repairId=m,this.footer.bookingId=null==t?void 0:t.bookingGuid,this.footer.currentStatus=s,this.commonService.repairStatus.next(s),this.currentRepairStatus=s,this.commonService.repairDetails.next(I.bookingDetail.data),this.commonService.bookingId.next(_)}if(Z.length>0){const{id:G,collectionGuid:s}=Z[0];this.mediaTemplateId=G,this.domainId=2100,q&&(this.domainId=3100),this.collectionGuid=s,(0,F.D)({mediaTemplateDetail:this.mediaCollectionService.getMediaTemplateById(s),mediaDetail:this.mediaCollectionService.getMediaDocumentData(G,this.objectId,this.domainId)}).pipe((0,j.K)(o=>(0,b.of)(o))).subscribe(o=>{if(o){const{mediaTemplateDetail:_,mediaDetail:a}=o;this.mediaTemplate=_.data,this.mediaTemplate.mediaTemplates=_.data.mediaTemplates.sort((t,S)=>t.orderNumber-S.orderNumber),a.data&&this.mapMediaTemplate(a.data.medias),this.getMediaTemplateByObject()}this.commonService.hideLoading()},o=>{this.commonService.hideLoading(),this.monitorService.logException(o,n._.Error)})}else this.commonService.hideLoading()}else this.noDocumentData=!0,this.commonService.hideLoading()}else this.noDocumentData=!0,this.commonService.hideLoading()});const y=document.querySelector(".addenda-container");y&&(y.scrollTop=0)}stepSkipped(){var u,g;location.href.includes("repair")&&"draft"===(null===(u=this.currentRepairStatus)||void 0===u?void 0:u.toLowerCase())&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"vehicledetails"===(null===(g=this.footer.currentStatus)||void 0===g?void 0:g.toLowerCase())&&this.updateStatus()}ngOnDestroy(){this.monitorService.logEvent("ngOnDestroy",["ChqNewDocumentComponent","addenda-quote"]),this.commonService.accessRight.unsubscribe(),location.href.includes("quote")&&(this.commonService.isViewOnly=!1)}}return f.\u0275fac=function(u){return new(u||f)(p.Y36(p.sBO),p.Y36(Q.v),p.Y36(V.gz),p.Y36(Y.n),p.Y36(te.M),p.Y36(A.q),p.Y36(v.m))},f.\u0275cmp=p.Xpm({type:f,selectors:[["new-documents"]],viewQuery:function(u,g){if(1&u&&p.Gf(ie,5),2&u){let x;p.iGM(x=p.CRH())&&(g.imageUploaders=x.first)}},inputs:{documentHeader:"documentHeader"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"fileUploaderService","footerOptions","imageStatusSteps","header","cardSelection","stepSkipped",4,"ngIf"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"fileUploaderService","footerOptions","imageStatusSteps","header","cardSelection","stepSkipped"],["imageUploaders",""],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"]],template:function(u,g){1&u&&(p.YNc(0,le,4,3,"div",0),p.YNc(1,U,1,0,"no-access-error",0)),2&u&&(p.Q6J("ngIf",!g.showNoAccess),p.xp6(1),p.Q6J("ngIf",g.showNoAccess))},directives:[w.O5,B.q,ee.U],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),f})()},4704:(ae,K,d)=>{d.d(K,{X:()=>W});var e=d(97582),n=d(37716),D=d(7408),F=d(54121),j=d(84967),b=d(33568),N=d(84945),p=d(75983),Q=d(83853),V=d(4893),Y=d(55278),te=d(38709),A=d(95016),v=d(13975),w=d(8985),B=d(87855),ee=d(38583),ie=d(22406),oe=d(62119),J=d(39912),se=d(9988),le=d(54135),U=d(29790);const $=["imageUploaders"];function O(Z,G){if(1&Z){const s=n.EpF();n.TgZ(0,"add-photos",9),n.NdJ("mode",function(o){return n.CHM(s),n.oxw(3).handleMode(o)}),n.qZA()}if(2&Z){const s=n.oxw(3);n.Q6J("caseData",s.caseData)("caseNumber",s.photosHeader.caseNumber)("showSPI",s.checkRepairTypes)("photosHeader",s.addPhotosHeader)("hidden",s.hideContent)("showEstimate",s.showEstimateButton)("repairData",s.repairDetail)}}function f(Z,G){if(1&Z&&(n.ynx(0),n.YNc(1,O,1,7,"add-photos",8),n.BQk()),2&Z){const s=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!1===s.showUploading)}}function L(Z,G){1&Z&&(n.TgZ(0,"div",10),n.TgZ(1,"div",11),n._UZ(2,"img",12),n.TgZ(3,"label",13),n._uU(4),n.ALo(5,"translate"),n.qZA(),n.qZA(),n.TgZ(6,"div",14),n._UZ(7,"div",15),n._UZ(8,"div",15),n._UZ(9,"div",15),n._UZ(10,"div",15),n.qZA(),n.qZA()),2&Z&&(n.xp6(4),n.hij(" ",n.lcZ(5,1,"no_photos_configured")," "))}function u(Z,G){if(1&Z&&(n.TgZ(0,"div",16),n.TgZ(1,"div",17),n.TgZ(2,"div",18),n._UZ(3,"img",19),n.qZA(),n.qZA(),n.qZA()),2&Z){const s=n.oxw(2);n.xp6(3),n.MGl("src","assets/img/",+s.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",n.LSH)}}function g(Z,G){if(1&Z){const s=n.EpF();n.TgZ(0,"chq-images-uploader",20,21),n.NdJ("handleDeleteAllEvent",function(){return n.CHM(s),n.oxw(2).handleDeleteAll()})("backToUpload",function(){return n.CHM(s),n.oxw(2).setInitialMode()})("updateMassUpload",function(o){return n.CHM(s),n.oxw(2).updateCurrentStatus(o)})("stepSkipped",function(){return n.CHM(s),n.oxw(2).stepSkipped()}),n.qZA()}if(2&Z){const s=n.oxw(2);n.Q6J("hidden",s.showDamageAnalysis||!s.showUploading)("currentAdditionalModeMultiple",s.currentAdditionalModeMultiple)("fileUploaderService",s.currentObservable)("footerOptions",s.footer)("isMassUpload",s.isMultipleUpload)("showReTakeDelete",!0)("imageStatusSteps",s.imageStatusSteps)("header",s.photosHeader)("inspectionId",s.inspectionId)("inspection","photos")}}function x(Z,G){if(1&Z){const s=n.EpF();n.TgZ(0,"damage-analysis",22),n.NdJ("backEvent",function(o){return n.CHM(s),n.oxw(2).handleBack(o)}),n.qZA()}if(2&Z){const s=n.oxw(2);n.Q6J("isBulkUpload",s.isMultipleUpload)("minPhotoRequired",s.minimumPhotosRequired)("caseDetail",s.partialCaseDetail||s.repairDetail)("steps",s.imageStatusSteps)("isRepairModule",s.photosHeader.isRepairModule)}}const q=function(Z){return{"photo-container":Z}};function E(Z,G){if(1&Z&&(n.TgZ(0,"div",2),n.YNc(1,f,2,1,"ng-container",3),n.YNc(2,L,11,3,"div",4),n.YNc(3,u,4,1,"div",5),n.YNc(4,g,2,10,"chq-images-uploader",6),n.YNc(5,x,1,5,"damage-analysis",7),n.qZA()),2&Z){const s=n.oxw();n.Q6J("ngClass",n.VKq(6,q,s.photosHeader.isRepairModule)),n.xp6(1),n.Q6J("chqPermission","newBooking"),n.xp6(1),n.Q6J("ngIf",s.noImagesData),n.xp6(1),n.Q6J("ngIf",s.noImagesData),n.xp6(1),n.Q6J("ngIf",!0===s.showUploading||s.isMultipleUpload||s.imageStatusSteps&&s.imageStatusSteps.length>0),n.xp6(1),n.Q6J("ngIf",s.showDamageAnalysis)}}function y(Z,G){1&Z&&n._UZ(0,"no-access-error")}const I={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let W=(()=>{class Z{constructor(s,m,o,_,a,t,S,T,R){this.cd=s,this.commonService=m,this.route=o,this.router=_,this.caseService=a,this.monitorService=t,this.inspectionService=S,this.bookingService=T,this.estimateService=R,this.photosHeader=I,this.currentUploadMode=new n.vpe,this.imageStatusSteps=[],this.showUploading=!1,this.isMultipleUpload=!1,this.triggerMassUpload=!1,this.caseStatus="",this.caseId="0",this.bookingId="",this.minimumPhotosRequired=0,this.hideContent=!0,this.currentAdditionalModeMultiple=!1,this.hideUploaders=!1,this.repairTypes=[],this.repairType="",this.noImagesData=!1,this.repairId="",this.inspectionTemplatesJSONString="",this.currentRepairStatus="",this.originalSteps=[],this.showNoAccess=!1,this.footer={text:"Next create estimate",icon:"boardview",route:"case/gt",status:"UploadPhotos",caseId:"",currentStatus:"",showButton:!0,showUploadOption:!0},this.statusUpdated=!1,m.pageName.closed&&(m.pageName=new F.X(null)),m.pageName.next("photos"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new F.X(!0))}handleBack(s){this.showDamageAnalysis=!s.back}get checkRepairTypes(){return-1===location.href.indexOf("repair")||"repair"!==this.repairType||this.repairTypes.filter(s=>"Body"===s.repairServiceType||"Paint"===s.repairServiceType).length>0}redirectToGtEstimate(){var s,m;this.commonService.showLoading(),"uploaddocuments"===(null===(s=this.caseStatus)||void 0===s?void 0:s.toLowerCase())||"uploadphotos"===(null===(m=this.caseStatus)||void 0===m?void 0:m.toLowerCase())?this.estimateService.createEstimate(this.caseId,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:o=>{var _;o&&(null===(_=null==o?void 0:o.data)||void 0===_?void 0:_.url)&&(location.href=o.data.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}}):this.router.navigate([`/quote/case/${this.caseId}/estimate`])}updateCurrentStatus(s){this.monitorService.logEvent("updateCurrentStatus",["ChqNewPhotosComponent","addenda-quote",{caseId:s}]),s.initial?this.setInitialMode():(this.showUploading=!0,this.uploadBulkUploadFile(s.steps))}handleDeleteAll(){this.setInitialMode()}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","photos"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["ChqNewPhotosComponent","addenda-quote"])}uploadBulkUploadFile(s){for(let m=0;m<(null==s?void 0:s.length);m++){const o=new Image;o.src=s[m].image,o.onload=()=>{const _={height:o.height,width:o.width,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,type:this.vehicelType||"",isBulk:!0},a=s[m];a.uploadInProgress=!0,a.isSkipped=!1,a.isUploadFailed=!1,a.isUploadSuccess=!1,this.monitorService.logEvent("uploadBulkUploadFile",["ChqNewPhotosComponent","addenda-quote",{uploadObject:_}]),this.inspectionService.uploadImageBulk(_,a.imageFile).subscribe({next:t=>{var S,T,R,k;a.url=null===(S=t.rawImage)||void 0===S?void 0:S.rawAzureBlobUrl,a.inspectionItem=t,a.procedureSteps="Bulk Upload Image",this.imageUploaders.updateUploadStatus("success",a,null,t),this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1}),location.href.includes("repair")&&("draft"===(null===(T=this.currentRepairStatus)||void 0===T?void 0:T.toLowerCase())||"uploaddocuments"===(null===(R=this.currentRepairStatus)||void 0===R?void 0:R.toLowerCase()))&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===(null===(k=this.footer.currentStatus)||void 0===k?void 0:k.toLowerCase())&&this.updateStatus()},error:t=>{401!=t.status&&(this.imageUploaders.imageStatusSteps=this.imageUploaders.imageStatusSteps.filter(S=>S.index!==a.index||S.stepName!==a.stepName||!0!==S.uploadInProgress),this.imageUploaders.updateUploadStatus("failed",a,t,null,!0)),this.monitorService.logException(t,D._.Error)}})}}}updateRepairStatus(s){this.statusUpdated||(this.statusUpdated=!0,this.bookingService.updateRepairStatus("UploadPhotos",s,"").subscribe({next:()=>{this.currentRepairStatus="UploadPhotos",this.footer.currentStatus=this.currentRepairStatus,this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairId).subscribe({next:m=>(0,e.mG)(this,void 0,void 0,function*(){(null==m?void 0:m.data)&&(this.commonService.repairDetails.next(m.data),this.commonService.bookingId.next(m.data.repairNumber),this.commonService.hideLoading())}),error:m=>{this.monitorService.logException(m,D._.Error),this.commonService.hideLoading()}})}}))}uploadFile(s){const m={height:s.imageHeight,width:s.imageWidth,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,inspectionitemId:s.inspectionItem.id,type:this.vehicelType||"",isBulk:!1};this.monitorService.logEvent("uploadFile",["ChqNewPhotosComponent","addenda-quote",{uploadObject:m}]),s.uploadInProgress=!0,s.isSkipped=!1,s.isUploadFailed=!1,s.isUploadSuccess=!1,this.commonService.inProgressSteps.next(1),this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1}),this.commonService.showNotification(`Your photo \u2018${s.stepName}\u2019 is currently uploading won\u2019t be long and we\u2019ll notify \n       you when its uploaded, you can continue to take your photos.`),this.inspectionService.uploadImageBulk(m,s.imageFile).subscribe({next:o=>{var _,a,t,S;this.commonService.showNotification(`Your photo \u2018${s.stepName}\u2019 is uploaded successfully.`);const R=null===(_=this.inspectionItemTemplates)||void 0===_?void 0:_.find(k=>k.inspectionItem.id==(null==o?void 0:o.id));R.inspectionItem.rawAzureBlobUrl=null===(a=o.rawImage)||void 0===a?void 0:a.rawAzureBlobUrl,R&&(s.url=null===(t=o.rawImage)||void 0===t?void 0:t.rawAzureBlobUrl,this.imageUploaders.updateUploadStatus("success",s,null,o)),location.href.includes("repair")&&("Draft"==this.currentRepairStatus||"UploadDocuments"===this.currentRepairStatus)&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===(null===(S=this.footer.currentStatus)||void 0===S?void 0:S.toLowerCase())&&this.updateStatus()},error:o=>{401!=o.status&&(this.commonService.showNotification(`Your photo \u2018${s.stepName}\u2019 failed to upload. Please try to upload again.`),this.imageUploaders.updateUploadStatus("failed",s,o),this.monitorService.logException(o,D._.Error))}})}ngOnDestroy(){this.commonService.pageName.unsubscribe(),this.commonService.accessRight.unsubscribe(),location.href.includes("quote")&&(this.commonService.isViewOnly=!1),this.monitorService.logEvent("ngOnDestroy",["ChqNewPhotosComponent","addenda-quote"])}get showEstimateButton(){var s,m;return 0===(null===(s=this.currentInspectionTemplate)||void 0===s?void 0:s.minImageLimit)&&0===(null===(m=this.inspectionItemTemplates)||void 0===m?void 0:m.filter(o=>!0!==o.isSkipEnabled).length)}mapInspection(s){var m,o,_,a,t,S;if(s)try{this.inspection=s,this.uploadType=this.inspection.uploadType;let T="SPI";this.uploadType&&(this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1})),"Bulk"===this.uploadType&&(T="BULK");const R=null===(m=this.inspectionTemplates)||void 0===m?void 0:m.filter(r=>"Bulk Upload Image"===r.name),k=null===(o=this.inspection.inspectionItems)||void 0===o?void 0:o.filter(r=>("Bulk Upload Image"===r.name||r.inspectionItemTemplateID===R[0].id)&&r.rawAzureBlobUrl);if((null==k?void 0:k.length)>0||"Bulk"===this.uploadType){const r=[];this.currentUploadMode.emit({mode:"multiple"});for(const C in k){const i=Object.assign(Object.assign({},R[0]),{name:k[C].name||R[0].name,inspectionItem:k[C]});r.push(i)}this.inspectionItemTemplates=r}else this.currentUploadMode.emit({mode:"single"}),null===(_=this.inspectionTemplates)||void 0===_||_.map(r=>{var C;const i=null===(C=this.inspection.inspectionItems)||void 0===C?void 0:C.find(l=>l.inspectionItemTemplateID==r.id);i&&(r.inspectionItem=i)}),this.inspectionItemTemplates=null===(a=this.inspectionTemplates)||void 0===a?void 0:a.filter(r=>"Bulk Upload Image"!=r.name);(null==R?void 0:R.length)>0&&(this.inspectionTemplateId=R[0].id),null===(t=this.inspectionItemTemplates)||void 0===t||t.map(r=>{var C,i;(null===(C=r.inspectionItem)||void 0===C?void 0:C.rawAzureBlobUrl)?(r.isUploadSuccess=!0,r.image=null===(i=r.inspectionItem)||void 0===i?void 0:i.rawAzureBlobUrl):(r.inspectionItem||(r.inspectionItem={rawAzureBlobUrl:""}),r.inspectionItem.rawAzureBlobUrl="",r.isUploadFailed=!1,r.isUploadSuccess=!1,r.uploadInProgress=!1)}),this.uploadType&&("SPI"===T?(this.isMultipleUpload=!1,this.showUploading=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{title:"back_smart_photo"})),this.minimumPhotosRequired=null===(S=this.inspectionItemTemplates)||void 0===S?void 0:S.filter(r=>!0!==r.isSkipEnabled).length,this.currentObservable=this.uploadFile.bind(this)):(this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.minimumPhotosRequired=this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!0,this.isBulkUploaded=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{title:"bulk_upload"}))))}catch(T){console.log(T)}}getInspectionTemplateByObject(){var s,m,o,_,a;for(let t=0;t<(null===(s=this.inspectionItemTemplates)||void 0===s?void 0:s.length);t++){const S=this.inspectionItemTemplates[t],T=(0,Q.A1)(S,t),R=-1!=(null===(m=T.stepName)||void 0===m?void 0:m.toLowerCase().indexOf("additional photo")),k=-1!=(null===(o=T.stepName)||void 0===o?void 0:o.toLowerCase().indexOf("bulk upload image")),r=R&&!T.url;this.imageStatusSteps.push(Object.assign(Object.assign({},T),{mandatory:!S.isSkipEnabled,index:t,isAdditionalDocumentFromReviewPageOnly:r,isMassUpload:k,updatedDate:T.url?null===(_=null==S?void 0:S.inspectionItem)||void 0===_?void 0:_.updatedDate:"",uploadedDate:T.url?null===(a=null==S?void 0:S.inspectionItem)||void 0===a?void 0:a.created:"",domainId:this.domainId,objectId:this.objectId,uploadedPartGuid:"",uploadedGuid:""}))}}updateStatus(){this.statusUpdated||(this.statusUpdated=!0,this.monitorService.logEvent("updateStatus",["ChqNewPhotosComponent","addenda-quote"]),this.caseService.updateCaseStatus(this.caseId,"UploadPhotos").subscribe({next:()=>{this.footer=Object.assign(Object.assign({},this.footer),{status:""}),this.partialCaseDetail.status="UploadPhotos"}}))}stepSkipped(){var s,m,o;location.href.includes("repair")&&("draft"===(null===(s=this.currentRepairStatus)||void 0===s?void 0:s.toLowerCase())||"uploaddocuments"===(null===(m=this.currentRepairStatus)||void 0===m?void 0:m.toLowerCase()))&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===(null===(o=this.footer.currentStatus)||void 0===o?void 0:o.toLowerCase())&&this.updateStatus()}loadApiData(s){s&&"0"!=s&&(this.caseId=s,this.bookingId=s,this.commonService.showLoading(),this.inspectionService.getInspectionTemplateList().subscribe({next:m=>{let o=!1,_=0;location.href.includes("repair")&&(o=!0);const a=null==m?void 0:m.data;(null==a?void 0:a.length)>0&&(this.commonService.repairInspectionTemplate=a[0],_=a[0].id);const t={};t.inspectionTemplate=this.inspectionService.getInspectionTemplate(_),o?t.bookingDetail=this.bookingService.getRepairDetailByGuid(s):(this.commonService.userProfileData.subscribe(T=>{if(T&&T.data){const{organizationDetail:R}=T.data;this.currentOrgId=R.id}}),t.caseDetail=this.caseService.getCaseDetail(s)),(0,j.D)(t).pipe((0,b.K)(T=>(0,N.of)(T))).subscribe({next:T=>{if(T.inspectionTemplate){const R=T.inspectionTemplate.inspectionItemTemplates;if(this.currentInspectionTemplate=T.inspectionTemplate,T.inspectionDetail&&(this.inspectionDetail=T.inspectionDetail),this.inspectionTemplates=R,this.inspectionTemplatesJSONString=JSON.stringify(this.inspectionTemplates),T.caseDetail){const{caseNumber:k,id:r,status:C,domainID:l,inspections:c,vehicleModel:h,vehicleId:M,organizationDetail:P}=T.caseDetail.data;this.caseData=T.caseDetail.data,this.partialCaseDetail=T.caseDetail.data,this.commonService.isViewOnly=this.currentOrgId!=(null==P?void 0:P.organizationId),this.vehicelType=h,this.vehicleId=M,this.domainId=l,this.commonService.caseStatus.next(C),this.caseStatus=C,"uploaddocuments"===(null==C?void 0:C.toLowerCase())||(this.footer=Object.assign(Object.assign({},this.footer),{status:"",caseId:r})),this.footer.currentStatus=C,(null==c?void 0:c.length)>0&&(this.inspectionId=c[0].inspectionId,this.commonService.inspectionId.next(this.inspectionId)),this.photosHeader.caseNumber=k,this.caseData.repairGuid&&(this.footer.repairId=this.caseData.repairGuid,this.footer.from=p.j.quote),this.objectId=r}if(T.bookingDetail){const{id:k,vehicle:r,repairServiceTypes:C,repairGuid:i,domainId:l,status:c,quoteId:h,repairType:M,repairNumber:P,booking:H,isRepairCreatedFromCase:ce}=T.bookingDetail.data;this.repairDetail=T.bookingDetail.data;const{vehicleModel:re,vehicleId:pe}=r;this.objectId=k,this.domainId=l,this.repairId=i,this.currentRepairStatus=c,this.repairTypes=C,this.repairType=M,this.inspectionId=r.inspectionId,this.vehicelType=re,this.vehicleId=pe,this.footer=Object.assign(Object.assign({},this.footer),{currentStatus:c,isRepairModule:!0,caseId:h,from:p.j.repair,repairTypes:C,isRepairCreatedFromCase:ce,bookingId:null==H?void 0:H.bookingGuid}),this.commonService.repairDetails.next(T.bookingDetail.data),this.commonService.bookingId.next(P),this.commonService.repairStatus.next(c)}this.inspectionId?this.inspectionService.getInspection(this.inspectionId).subscribe({next:k=>{k&&(this.mapInspection(k),this.noImagesData=!1,this.getInspectionTemplateByObject(),setTimeout(()=>{this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.uploadType&&this.imageUploaders.goToReview()}))},error:()=>{this.noImagesData=!0},complete:()=>{this.commonService.hideLoading()}}):(this.noImagesData=!0,this.hideContent=!1,this.commonService.hideLoading())}else this.noImagesData=!0,this.commonService.hideLoading()}})},error:()=>{this.noImagesData=!0,this.commonService.hideLoading()}}))}ngOnInit(){var s;const m=null===(s=this.route.parent)||void 0===s?void 0:s.snapshot.paramMap.get("id");this.addPhotosHeader=Object.assign(Object.assign({},this.photosHeader),{isHeaderOnly:!1}),this.monitorService.logEvent("ngOnInit",["ChqNewPhotosComponent","addenda-quote",{caseId:m,repairId:m}]),this.footer=Object.assign(Object.assign({},this.footer),{caseId:this.photosHeader.isRepairModule?"":m,repairId:this.photosHeader.isRepairModule?m:"",handleBack:this.handleBack.bind(this),finalRedirection:this.redirectToGtEstimate.bind(this)}),this.commonService.accessRight.subscribe({next:_=>{_||(this.showNoAccess=!0)}}),this.loadApiData(m);const o=document.querySelector(".addenda-container");o&&(o.scrollTop=0),this.currentObservable=this.uploadFile.bind(this)}reloadInspection(){this.commonService.showLoading(),this.inspectionTemplates=JSON.parse(this.inspectionTemplatesJSONString),this.inspectionId&&this.inspectionService.getInspection(this.inspectionId).subscribe({next:s=>{s&&(this.mapInspection(s),this.getInspectionTemplateByObject(),this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,setTimeout(()=>{this.hideContent=!1,this.showUploading=!0}))},complete:()=>{this.commonService.hideLoading()}})}setInitialMode(){this.showUploading=!1,this.imageStatusSteps=[],this.triggerMassUpload=!1,this.isBulkUploaded=!1,this.imageUploaders.isReviewSection=!1,this.isMultipleUpload=!1,this.currentAdditionalModeMultiple=!1}handleMode(s){var m;this.monitorService.logEvent("handleMode",["ChqNewPhotosComponent","addenda-quote",{$event:s}]),this.inspectionId?(this.currentUploadMode.emit(s),"single"===s.mode?(0===(null===(m=this.imageStatusSteps)||void 0===m?void 0:m.length)?(this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,this.minimumPhotosRequired=this.inspectionItemTemplates.filter(o=>!0!==o.isSkipEnabled).length,this.reloadInspection()):(this.isMultipleUpload=!1,this.showUploading=!0,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.minimumPhotosRequired=this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!1),this.currentObservable=this.uploadFile.bind(this)):(this.imageStatusSteps=[],this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.triggerMassUpload=!0,this.showUploading=!0)):this.currentUploadMode.emit({mode:"error",id:this.bookingId})}}return Z.\u0275fac=function(s){return new(s||Z)(n.Y36(n.sBO),n.Y36(V.v),n.Y36(Y.gz),n.Y36(Y.F0),n.Y36(te.n),n.Y36(A.M),n.Y36(v.a),n.Y36(w.q),n.Y36(B.H))},Z.\u0275cmp=n.Xpm({type:Z,selectors:[["new-photos"]],viewQuery:function(s,m){if(1&s&&n.Gf($,5),2&s){let o;n.iGM(o=n.CRH())&&(m.imageUploaders=o.first)}},inputs:{photosHeader:"photosHeader"},outputs:{currentUploadMode:"currentUploadMode"},decls:2,vars:2,consts:[[3,"ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass"],[4,"chqPermission"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload","stepSkipped",4,"ngIf"],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairModule","backEvent",4,"ngIf"],[3,"caseData","caseNumber","showSPI","photosHeader","hidden","showEstimate","repairData","mode",4,"ngIf"],[3,"caseData","caseNumber","showSPI","photosHeader","hidden","showEstimate","repairData","mode"],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[3,"hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload","stepSkipped"],["imageUploaders",""],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairModule","backEvent"]],template:function(s,m){1&s&&(n.YNc(0,E,6,8,"div",0),n.YNc(1,y,1,0,"no-access-error",1)),2&s&&(n.Q6J("ngIf",!m.showNoAccess),n.xp6(1),n.Q6J("ngIf",m.showNoAccess))},directives:[ee.O5,ee.mk,ie.A,oe.b,J.q,se.wm,le.U],pipes:[U.X$],styles:[".photo-container[_ngcontent-%COMP%]{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),Z})()},72076:(ae,K,d)=>{d.d(K,{r:()=>m});var e=d(37716),n=d(95016),D=d(38583),F=d(36978),j=d(76627),b=d(29790),N=d(93077);function p(o,_){if(1&o){const a=e.EpF();e.TgZ(0,"chq-button",5),e.NdJ("click",function(){return e.CHM(a),e.oxw().handledownloadPdf()}),e.qZA()}if(2&o){const a=e.oxw();e.Q6J("buttonModel",a.repairEstimateReportModel)}}function Q(o,_){1&o&&e._UZ(0,"td")}function V(o,_){1&o&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"actions")))}function Y(o,_){if(1&o&&(e.TgZ(0,"td",29),e._UZ(1,"span",30),e.qZA()),2&o){const a=e.oxw().$implicit,t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",t.displayNotes(a),e.oJD)}}function te(o,_){if(1&o){const a=e.EpF();e.TgZ(0,"td"),e.TgZ(1,"div",31),e.TgZ(2,"mat-icon",32),e.NdJ("click",function(){e.CHM(a);const S=e.oxw().$implicit;return e.oxw(2).handleIconClick("edit",S.operationId)}),e.qZA(),e.TgZ(3,"mat-icon",33),e.NdJ("click",function(){e.CHM(a);const S=e.oxw().$implicit;return e.oxw(2).handleIconClick("delete",S.operationId)}),e.qZA(),e.qZA(),e.qZA()}2&o&&(e.xp6(2),e.Q6J("svgIcon","edit"),e.xp6(1),e.Q6J("svgIcon","delete"))}const A=function(o){return{"child-data":o}},v=function(o,_,a,t,S){return[o,_,a,t,S]};function w(o,_){if(1&o&&(e.TgZ(0,"tr",26),e.YNc(1,Y,2,1,"td",27),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",28),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"xaCurrency"),e.qZA(),e.TgZ(11,"td",11),e._uU(12),e.ALo(13,"xaCurrency"),e.qZA(),e.YNc(14,te,4,2,"td",10),e.qZA()),2&o){const a=_.$implicit,t=e.oxw(2);e.Q6J("ngClass",e.VKq(21,A,!0===a.isChildItem&&t.isGTEstimate())),e.xp6(1),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.Oqu(a.description),e.xp6(2),e.Oqu(a.code),e.xp6(2),e.Oqu(a.quantity),e.xp6(2),e.Oqu(e.G7q(10,9,e.qbA(23,v,a.cost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.Oqu(e.G7q(13,15,e.qbA(29,v,a.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.editEstimate)}}function B(o,_){1&o&&e._UZ(0,"td")}function ee(o,_){1&o&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"actions")))}function ie(o,_){if(1&o&&(e.TgZ(0,"td",29),e._UZ(1,"span",30),e.qZA()),2&o){const a=e.oxw().$implicit,t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",t.displayNotes(a),e.oJD)}}function oe(o,_){if(1&o){const a=e.EpF();e.TgZ(0,"td"),e.TgZ(1,"div",31),e.TgZ(2,"mat-icon",32),e.NdJ("click",function(){e.CHM(a);const S=e.oxw().$implicit;return e.oxw(2).handleIconClick("edit",S.operationId)}),e.qZA(),e.TgZ(3,"mat-icon",33),e.NdJ("click",function(){e.CHM(a);const S=e.oxw().$implicit;return e.oxw(2).handleIconClick("delete",S.operationId)}),e.qZA(),e.qZA(),e.qZA()}2&o&&(e.xp6(2),e.Q6J("svgIcon","edit"),e.xp6(1),e.Q6J("svgIcon","delete"))}function J(o,_){if(1&o&&(e.TgZ(0,"tr",26),e.YNc(1,ie,2,1,"td",27),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",28),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"xaCurrency"),e.qZA(),e.TgZ(12,"td",11),e._uU(13),e.ALo(14,"xaCurrency"),e.qZA(),e.YNc(15,oe,4,2,"td",10),e.qZA()),2&o){const a=_.$implicit,t=e.oxw(2);e.Q6J("ngClass",e.VKq(24,A,!0===a.isChildItem&&t.isGTEstimate())),e.xp6(1),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.hij(" ",a.description,""),e.xp6(2),e.Oqu(a.code),e.xp6(2),e.AsE("",a.quantity," ",e.lcZ(8,10,"hours"),""),e.xp6(3),e.Oqu(e.G7q(11,12,e.qbA(26,v,a.cost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.s9C("align",t.editEstimate?"center":"right"),e.xp6(1),e.Oqu(e.G7q(14,18,e.qbA(32,v,a.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.editEstimate)}}function se(o,_){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const a=e.oxw(3);e.xp6(1),e.AsE(" ",e.lcZ(2,2,"paint_type"),": ",null==a.estimateResponse||null==a.estimateResponse.estimateSummary?null:a.estimateResponse.estimateSummary.paintType," ")}}function le(o,_){if(1&o&&(e.TgZ(0,"div",34),e.TgZ(1,"div"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,se,3,4,"div",10),e.qZA()),2&o){const a=e.oxw(2);e.xp6(2),e.AsE(" ",e.lcZ(3,3,"paint_system"),": ",null==a.estimateResponse||null==a.estimateResponse.estimateSummary?null:a.estimateResponse.estimateSummary.paintSystem," "),e.xp6(2),e.Q6J("ngIf","azt"===(null==a.estimateResponse||null==a.estimateResponse.estimateSummary||null==a.estimateResponse.estimateSummary.paintSystem?null:a.estimateResponse.estimateSummary.paintSystem.toLowerCase()))}}function U(o,_){1&o&&e._UZ(0,"td")}function $(o,_){1&o&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"actions")))}function O(o,_){if(1&o&&(e.TgZ(0,"td",29),e._UZ(1,"span",30),e.qZA()),2&o){const a=e.oxw().$implicit,t=e.oxw(3);e.xp6(1),e.Q6J("innerHTML",t.displayNotes(a),e.oJD)}}function f(o,_){if(1&o){const a=e.EpF();e.TgZ(0,"td"),e.TgZ(1,"div",31),e.TgZ(2,"mat-icon",32),e.NdJ("click",function(){e.CHM(a);const S=e.oxw().$implicit;return e.oxw(3).handleIconClick("edit",S.operationId)}),e.qZA(),e.TgZ(3,"mat-icon",33),e.NdJ("click",function(){e.CHM(a);const S=e.oxw().$implicit;return e.oxw(3).handleIconClick("delete",S.operationId)}),e.qZA(),e.qZA(),e.qZA()}2&o&&(e.xp6(2),e.Q6J("svgIcon","edit"),e.xp6(1),e.Q6J("svgIcon","delete"))}function L(o,_){if(1&o&&(e.TgZ(0,"tr",26),e.YNc(1,O,2,1,"td",27),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",28),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"xaCurrency"),e.qZA(),e.TgZ(11,"td",11),e._uU(12),e.ALo(13,"xaCurrency"),e.qZA(),e.YNc(14,f,4,2,"td",10),e.qZA()),2&o){const a=_.$implicit,t=e.oxw(3);e.Q6J("ngClass",e.VKq(21,A,!0===a.isChildItem&&t.isGTEstimate())),e.xp6(1),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.hij(" ",a.description,""),e.xp6(2),e.Oqu(a.code),e.xp6(2),e.hij("",a.quantity," h"),e.xp6(2),e.Oqu(e.G7q(10,9,e.qbA(23,v,a.cost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.Oqu(e.G7q(13,15,e.qbA(29,v,a.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.editEstimate)}}function u(o,_){if(1&o&&(e.ynx(0),e.TgZ(1,"tr"),e.TgZ(2,"td",35),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.YNc(5,L,15,35,"tr",13),e.BQk()),2&o){const a=e.oxw(2);e.xp6(2),e.uIk("colspan",a.editEstimate?"6":"5"),e.xp6(1),e.Oqu(e.lcZ(4,3,"paint_labour")),e.xp6(2),e.Q6J("ngForOf",a.paintLabour)}}function g(o,_){if(1&o&&(e.TgZ(0,"td",29),e._UZ(1,"span",30),e.qZA()),2&o){const a=e.oxw().$implicit,t=e.oxw(3);e.xp6(1),e.Q6J("innerHTML",t.displayNotes(a),e.oJD)}}function x(o,_){if(1&o){const a=e.EpF();e.TgZ(0,"td"),e.TgZ(1,"div",31),e.TgZ(2,"mat-icon",32),e.NdJ("click",function(){e.CHM(a);const S=e.oxw().$implicit;return e.oxw(3).handleIconClick("edit",S.operationId)}),e.qZA(),e.TgZ(3,"mat-icon",33),e.NdJ("click",function(){e.CHM(a);const S=e.oxw().$implicit;return e.oxw(3).handleIconClick("delete",S.operationId)}),e.qZA(),e.qZA(),e.qZA()}2&o&&(e.xp6(2),e.Q6J("svgIcon","edit"),e.xp6(1),e.Q6J("svgIcon","delete"))}function q(o,_){if(1&o&&(e.TgZ(0,"tr",26),e.YNc(1,g,2,1,"td",27),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",28),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"xaCurrency"),e.qZA(),e.TgZ(11,"td",11),e._uU(12),e.ALo(13,"xaCurrency"),e.qZA(),e.YNc(14,x,4,2,"td",10),e.qZA()),2&o){const a=_.$implicit,t=e.oxw(3);e.Q6J("ngClass",e.VKq(21,A,!0===a.isChildItem&&t.isGTEstimate())),e.xp6(1),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.hij(" ",a.description,""),e.xp6(2),e.Oqu(a.code),e.xp6(2),e.Oqu(a.quantity),e.xp6(2),e.Oqu(e.G7q(10,9,e.qbA(23,v,a.cost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.Oqu(e.G7q(13,15,e.qbA(29,v,a.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.editEstimate)}}function E(o,_){if(1&o&&(e.ynx(0),e.TgZ(1,"tr"),e.TgZ(2,"td",35),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.YNc(5,q,15,35,"tr",13),e.BQk()),2&o){const a=e.oxw(2);e.xp6(2),e.uIk("colspan",a.editEstimate?"6":"5"),e.xp6(1),e.Oqu(e.lcZ(4,3,"paint_material")),e.xp6(2),e.Q6J("ngForOf",a.paintMaterial)}}function y(o,_){1&o&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.BQk()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"total_cost_with_gst")))}function I(o,_){1&o&&(e.TgZ(0,"td"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"total_cost")))}function W(o,_){1&o&&(e.TgZ(0,"div",36),e.TgZ(1,"div",37),e.TgZ(2,"div",38),e._UZ(3,"img",39),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA(),e.TgZ(7,"div"),e._UZ(8,"mat-icon",40),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",37),e.TgZ(13,"div",38),e._UZ(14,"img",41),e.TgZ(15,"span"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.qZA(),e.TgZ(18,"div",42),e.TgZ(19,"div"),e.TgZ(20,"b"),e._uU(21," I "),e.qZA(),e.TgZ(22,"span"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.qZA(),e.TgZ(25,"div"),e.TgZ(26,"b"),e._uU(27,"NI"),e.qZA(),e.TgZ(28,"span"),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(31,"div",37),e.TgZ(32,"div",38),e._UZ(33,"img",43),e.TgZ(34,"span"),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.qZA(),e.TgZ(37,"div"),e.TgZ(38,"b"),e._uU(39,"C "),e.qZA(),e.TgZ(40,"span"),e._uU(41),e.ALo(42,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(43,"div",37),e.TgZ(44,"div",38),e.TgZ(45,"b"),e._uU(46,"+"),e.qZA(),e.TgZ(47,"span"),e._uU(48),e.ALo(49,"translate"),e.qZA(),e.qZA(),e.TgZ(50,"div"),e.TgZ(51,"b"),e._uU(52,"-"),e.qZA(),e.TgZ(53,"span"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(5),e.Oqu(e.lcZ(6,10,"manual")),e.xp6(3),e.Q6J("svgIcon","approximate"),e.xp6(2),e.Oqu(e.lcZ(11,12,"approximate")),e.xp6(6),e.Oqu(e.lcZ(17,14,"documented_by_gt_motive")),e.xp6(7),e.Oqu(e.lcZ(24,16,"included")),e.xp6(6),e.Oqu(e.lcZ(30,18,"not_included")),e.xp6(6),e.Oqu(e.lcZ(36,20,"prepainted_part")),e.xp6(6),e.Oqu(e.lcZ(42,22,"conditioned_by")),e.xp6(7),e.Oqu(e.lcZ(49,24,"thrown_by")),e.xp6(6),e.Oqu(e.lcZ(55,26,"overlapped_by")))}const Z=function(o){return{"mb-0":o}};function G(o,_){if(1&o&&(e.TgZ(0,"div",6),e.TgZ(1,"div",7),e.TgZ(2,"h6",8),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"table",9),e.TgZ(6,"thead"),e.TgZ(7,"tr"),e.YNc(8,Q,1,0,"td",10),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"td"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"td",11),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.YNc(24,V,3,3,"td",12),e.qZA(),e.qZA(),e.TgZ(25,"tbody"),e.YNc(26,w,15,35,"tr",13),e.qZA(),e.qZA(),e.TgZ(27,"table",9),e.TgZ(28,"tfoot"),e.TgZ(29,"tr"),e.TgZ(30,"td"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"td",14),e._uU(34),e.ALo(35,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(36,"div",15),e.TgZ(37,"h6",8),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"table",9),e.TgZ(41,"thead"),e.TgZ(42,"tr"),e.YNc(43,B,1,0,"td",10),e.TgZ(44,"td"),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"td"),e._uU(48),e.ALo(49,"translate"),e.qZA(),e.TgZ(50,"td"),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"td"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"td",11),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.YNc(59,ee,3,3,"td",12),e.qZA(),e.qZA(),e.TgZ(60,"tbody"),e.YNc(61,J,16,38,"tr",13),e.qZA(),e.qZA(),e.TgZ(62,"table",9),e.TgZ(63,"tfoot"),e.TgZ(64,"tr"),e.TgZ(65,"td"),e._uU(66),e.ALo(67,"translate"),e.qZA(),e.TgZ(68,"td",14),e._uU(69),e.ALo(70,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(71,"div",15),e.TgZ(72,"h6",8),e._uU(73),e.ALo(74,"translate"),e.qZA(),e.YNc(75,le,5,5,"div",16),e.TgZ(76,"table",9),e.TgZ(77,"thead"),e.TgZ(78,"tr"),e.YNc(79,U,1,0,"td",10),e.TgZ(80,"td"),e._uU(81),e.ALo(82,"translate"),e.qZA(),e.TgZ(83,"td"),e._uU(84),e.ALo(85,"translate"),e.qZA(),e.TgZ(86,"td"),e._uU(87),e.ALo(88,"translate"),e.qZA(),e.TgZ(89,"td"),e._uU(90),e.ALo(91,"translate"),e.qZA(),e.TgZ(92,"td",11),e._uU(93),e.ALo(94,"translate"),e.qZA(),e.YNc(95,$,3,3,"td",12),e.qZA(),e.qZA(),e.TgZ(96,"tbody"),e.YNc(97,u,6,5,"ng-container",10),e.YNc(98,E,6,5,"ng-container",10),e.qZA(),e.qZA(),e.TgZ(99,"table",9),e.TgZ(100,"tfoot"),e.TgZ(101,"tr"),e.TgZ(102,"td"),e._uU(103),e.ALo(104,"translate"),e.qZA(),e.TgZ(105,"td",14),e._uU(106),e.ALo(107,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(108,"div",17),e.TgZ(109,"div",15),e.TgZ(110,"h4",18),e._uU(111),e.ALo(112,"translate"),e.qZA(),e.TgZ(113,"h6",8),e._uU(114),e.ALo(115,"translate"),e.qZA(),e.TgZ(116,"table",9),e.TgZ(117,"tbody"),e.TgZ(118,"tr"),e.TgZ(119,"td"),e._uU(120),e.ALo(121,"translate"),e.qZA(),e.TgZ(122,"td",14),e._uU(123),e.ALo(124,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(125,"tr"),e.TgZ(126,"td"),e._uU(127),e.ALo(128,"translate"),e.qZA(),e.TgZ(129,"td",14),e._uU(130),e.ALo(131,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(132,"tr"),e.TgZ(133,"td"),e._uU(134),e.ALo(135,"translate"),e.qZA(),e.TgZ(136,"td",14),e._uU(137),e.ALo(138,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(139,"tr"),e.TgZ(140,"td"),e._uU(141),e.ALo(142,"translate"),e.qZA(),e.TgZ(143,"td",14),e._uU(144),e.ALo(145,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(146,"tfoot"),e.TgZ(147,"tr"),e.TgZ(148,"td"),e._uU(149),e.ALo(150,"translate"),e.qZA(),e.TgZ(151,"td",14),e._uU(152),e.ALo(153,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(154,"div",15),e.TgZ(155,"h6",8),e._uU(156),e.ALo(157,"translate"),e.qZA(),e.TgZ(158,"table",9),e.TgZ(159,"tbody"),e.TgZ(160,"tr"),e.TgZ(161,"td"),e._uU(162),e.ALo(163,"translate"),e.qZA(),e.TgZ(164,"td",14),e._uU(165),e.ALo(166,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(167,"tr"),e.TgZ(168,"td"),e._uU(169),e.ALo(170,"translate"),e.qZA(),e.TgZ(171,"td",14),e._uU(172),e.qZA(),e.qZA(),e.TgZ(173,"tr"),e.TgZ(174,"td"),e._uU(175),e.ALo(176,"translate"),e.qZA(),e.TgZ(177,"td",14),e._uU(178),e.ALo(179,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(180,"tfoot"),e.TgZ(181,"tr"),e.TgZ(182,"td"),e._uU(183),e.ALo(184,"translate"),e.qZA(),e.TgZ(185,"td",14),e._uU(186),e.ALo(187,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(188,"div",15),e.TgZ(189,"h6",8),e._uU(190),e.ALo(191,"translate"),e.qZA(),e.TgZ(192,"table",9),e.TgZ(193,"tbody"),e.TgZ(194,"tr"),e.TgZ(195,"td"),e._uU(196),e.ALo(197,"translate"),e.qZA(),e.TgZ(198,"td",14),e._uU(199),e.qZA(),e.qZA(),e.TgZ(200,"tr"),e.TgZ(201,"td"),e._uU(202),e.ALo(203,"translate"),e.qZA(),e.TgZ(204,"td",14),e._uU(205),e.ALo(206,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(207,"tr"),e.TgZ(208,"td"),e._uU(209),e.ALo(210,"translate"),e.qZA(),e.TgZ(211,"td",14),e._uU(212),e.ALo(213,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(214,"tr"),e.TgZ(215,"td",19),e._uU(216),e.ALo(217,"translate"),e.qZA(),e.TgZ(218,"td",14),e._uU(219),e.ALo(220,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(221,"tr"),e.TgZ(222,"td"),e._uU(223),e.ALo(224,"translate"),e.qZA(),e.TgZ(225,"td",14),e._uU(226),e.ALo(227,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(228,"tr"),e.TgZ(229,"td"),e._uU(230),e.ALo(231,"translate"),e.qZA(),e.TgZ(232,"td",14),e._uU(233),e.ALo(234,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(235,"tr"),e.TgZ(236,"td"),e._uU(237),e.ALo(238,"translate"),e.qZA(),e.TgZ(239,"td",14),e._uU(240),e.ALo(241,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(242,"tfoot"),e.TgZ(243,"tr"),e.TgZ(244,"td"),e._uU(245),e.ALo(246,"translate"),e.qZA(),e.TgZ(247,"td",14),e._uU(248),e.ALo(249,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(250,"div",20),e.TgZ(251,"table",21),e.TgZ(252,"thead"),e.TgZ(253,"tr"),e.YNc(254,y,4,3,"ng-container",22),e.YNc(255,I,3,3,"ng-template",null,23,e.W1O),e.TgZ(257,"td",14),e._uU(258),e.ALo(259,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(260,W,56,28,"div",24),e.qZA()),2&o){const a=e.MAs(256),t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,91,"parts")),e.xp6(5),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.Oqu(e.lcZ(11,93,"estimate_details_description")),e.xp6(3),e.Oqu(e.lcZ(14,95,"code")),e.xp6(3),e.Oqu(e.lcZ(17,97,"units")),e.xp6(3),e.AsE("",e.lcZ(20,99,"price_unit"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.AsE("",e.lcZ(23,101,"total_price"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("ngIf",t.editEstimate),e.xp6(2),e.Q6J("ngForOf",t.partsCost),e.xp6(5),e.Oqu(e.lcZ(32,103,"total_parts_cost")),e.xp6(3),e.Oqu(e.G7q(35,105,e.qbA(289,v,t.totalPartsCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(39,111,"labour")),e.xp6(5),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.Oqu(e.lcZ(46,113,"estimate_details_description")),e.xp6(3),e.Oqu(e.lcZ(49,115,"code")),e.xp6(3),e.Oqu(e.lcZ(52,117,"hours")),e.xp6(3),e.AsE("",e.lcZ(55,119,"price_unit"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.AsE("",e.lcZ(58,121,"total_price"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("ngIf",t.editEstimate),e.xp6(2),e.Q6J("ngForOf",t.labourCost),e.xp6(5),e.Oqu(e.lcZ(67,123,"total_labour_cost")),e.xp6(3),e.Oqu(e.G7q(70,125,e.qbA(295,v,t.totalLabourCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(74,131,"paint")),e.xp6(2),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(4),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.Oqu(e.lcZ(82,133,"estimate_details_description")),e.xp6(3),e.Oqu(e.lcZ(85,135,"code")),e.xp6(3),e.Oqu(e.lcZ(88,137,"unit_hours")),e.xp6(3),e.AsE(" ",e.lcZ(91,139,"price_unit"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.AsE("",e.lcZ(94,141,"total_price"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("ngIf",t.editEstimate),e.xp6(2),e.Q6J("ngIf",t.paintLabour.length>0),e.xp6(1),e.Q6J("ngIf",t.paintMaterial.length>0),e.xp6(5),e.Oqu(e.lcZ(104,143,"total_paint_cost")),e.xp6(3),e.Oqu(e.G7q(107,145,e.qbA(301,v,t.totalPaintCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(5),e.Oqu(e.lcZ(112,151,"summary")),e.xp6(3),e.hij(" ",e.lcZ(115,153,"parts"),""),e.xp6(6),e.Oqu(e.lcZ(121,155,"subtotal")),e.xp6(3),e.Oqu(e.G7q(124,157,e.qbA(307,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(128,163,"estimate_details_sundry_parts")),e.xp6(3),e.Oqu(e.G7q(131,165,e.qbA(313,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.sundryParts,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(135,171,"total_before_discount")),e.xp6(3),e.Oqu(e.G7q(138,173,e.qbA(319,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalBeforeDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.AsE("",e.lcZ(142,179,"discount_on_parts"),"(",null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalDiscountPercentage,"%)"),e.xp6(3),e.Oqu(e.G7q(145,181,e.qbA(325,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(5),e.Oqu(e.lcZ(150,187,"total_parts")),e.xp6(3),e.Oqu(e.G7q(153,189,e.qbA(331,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(157,195,"labour")),e.xp6(6),e.Oqu(e.lcZ(163,197,"labour_amount_subtotal")),e.xp6(3),e.Oqu(e.G7q(166,199,e.qbA(337,v,t.totalLabourCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(170,205,"labour_hours")),e.xp6(3),e.hij("",null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTimeHours," Hrs"),e.xp6(3),e.AsE("",e.lcZ(176,207,"estimate_details_labour_discount"),"(",null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotalDiscountPercentage,"%)"),e.xp6(3),e.Oqu(e.G7q(179,209,e.qbA(343,v,null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotalDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(5),e.Oqu(e.lcZ(184,215,"total_labour_cost")),e.xp6(3),e.Oqu(e.G7q(187,217,e.qbA(349,v,null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.hij(" ",e.lcZ(191,223,"paint"),""),e.xp6(6),e.Oqu(e.lcZ(197,225,"paint_labour_time")),e.xp6(3),e.hij("",null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourTimeHour," Hrs"),e.xp6(3),e.Oqu(e.lcZ(203,227,"paint_labour_subtotal")),e.xp6(3),e.Oqu(e.G7q(206,229,e.qbA(355,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.AsE("",e.lcZ(210,235,"estimate_details_paint_labour_discount"),"(",null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourDiscountPercentage,"%)"),e.xp6(3),e.Oqu(e.G7q(213,237,e.qbA(361,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(217,243,"labour_total")),e.xp6(3),e.Oqu(e.G7q(220,245,e.qbA(367,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(224,251,"material_subtotal")),e.xp6(3),e.Oqu(e.G7q(227,253,e.qbA(373,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.AsE("",e.lcZ(231,259,"estimate_details_material_discount"),"(",null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMateriaDiscountPercentage,"%)"),e.xp6(3),e.Oqu(e.G7q(234,261,e.qbA(379,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(238,267,"material_total")),e.xp6(3),e.Oqu(e.G7q(241,269,e.qbA(385,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(5),e.Oqu(e.lcZ(246,275,"total_paint")),e.xp6(3),e.Oqu(e.G7q(249,277,e.qbA(391,v,null==t.summary||null==t.summary.paint?null:t.summary.paint.paintTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(3),e.Q6J("ngClass",e.VKq(397,Z,!t.isGTEstimate())),e.xp6(3),e.Q6J("ngIf","Rs."===t.i18n.currencySymbol)("ngIfElse",a),e.xp6(4),e.Oqu(e.G7q(259,283,e.qbA(399,v,t.total.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.isGTEstimate())}}function s(o,_){1&o&&(e.TgZ(0,"div",44),e._UZ(1,"mat-icon",45),e.TgZ(2,"p",46),e._uU(3),e.ALo(4,"translate"),e._UZ(5,"br"),e._uU(6),e.ALo(7,"translate"),e._UZ(8,"br"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.qZA()),2&o&&(e.xp6(1),e.Q6J("svgIcon","estimate-no-data"),e.xp6(2),e.hij(" ",e.lcZ(4,4,"no_result"),". "),e.xp6(3),e.hij(" ",e.lcZ(7,6,"no_estimate")," "),e.xp6(3),e.hij(" ",e.lcZ(10,8,"add_try_again")," "))}let m=(()=>{class o{constructor(a){this.monitorService=a,this.iconClicked=new e.vpe,this.downloadPdf=new e.vpe,this.repairEstimateReportModel={label:"estimate_report",type:"outline",icon:"report-check"},this.paintCost=[],this.partsCost=[],this.totalPartsCost=0,this.labourCost=[],this.totalLabourCost=0,this.paintLabour=[],this.paintMaterial=[],this.totalPaintCost=0,this.noDataFound=!1,this.summary={parts:{partsSubTotal:0,sundryParts:0,sundryPartsPercentage:0,partsTotalBeforeDiscount:0,partsTotalDiscountPercentage:0,partsTotal:0},labour:{labourTimeHours:0,labourTotalDiscountPercentage:0,labourTotalDiscount:0,labourTotal:0},paint:{labour:{paintLabourTimeHour:0,paintLabourSubTotal:0,paintLabourDiscountPercentage:0,paintLabourDiscount:0,paintLabourTotal:0},material:{paintMaterialSubTotal:0,paintMateriaDiscountPercentage:0,paintMaterialDiscount:0,paintMaterialTotal:0},paintTotal:0}},this.total={total:0,vatPercent:0,vat:0,totalWithVat:0}}ngOnInit(){this.monitorService.logEvent("ngOnInit",["ChqEstimateDetailsComponent","addenda-repair"]),this.setData()}ngOnChanges(a){this.monitorService.logEvent("ngOnChanges",["ChqEstimateDetailsComponent","addenda-repair"]),a&&a.estimateResponse&&a.estimateResponse.currentValue&&(this.estimateResponse=Object.assign({},a.estimateResponse.currentValue),this.setData())}setData(){var a,t,S,T,R,k,r,C,i,l,c,h,M,P,H,ce,re,pe,ue,me,_e,he,ge,ve,fe,xe,Ce,Se,Te,be,Oe,Me,qe,Ze,Ae,Ie,Pe,Ue,ye,we,De,Ee,Le,Re,ke,Ne,Be,Je,Fe,Ge,je,Qe;const ne=(null===(a=this.estimateResponse)||void 0===a?void 0:a.estimateCharges)||[];if(0===ne.length)this.noDataFound=!0;else{this.noDataFound=!1,this.labourCost=null==ne?void 0:ne.filter(de=>{var z;return"labour"==(null===(z=de.serviceType)||void 0===z?void 0:z.toLowerCase())}),this.paintCost=null==ne?void 0:ne.filter(de=>{var z;return"paint"==(null===(z=de.serviceType)||void 0===z?void 0:z.toLowerCase())}),this.partsCost=null==ne?void 0:ne.filter(de=>{var z;return"part"==(null===(z=de.serviceType)||void 0===z?void 0:z.toLowerCase())}),this.paintLabour=null===(t=this.paintCost)||void 0===t?void 0:t.filter(de=>{var z;return"paintlabour"==(null===(z=de.serviceSubType)||void 0===z?void 0:z.toLowerCase())}),this.paintMaterial=null===(S=this.paintCost)||void 0===S?void 0:S.filter(de=>{var z;return"paintmaterial"==(null===(z=de.serviceSubType)||void 0===z?void 0:z.toLowerCase())});const X=null===(T=this.estimateResponse)||void 0===T?void 0:T.estimateSummary;this.totalPartsCost=(null==X?void 0:X.partsSubTotal)?parseFloat(null==X?void 0:X.partsSubTotal):0,this.totalLabourCost=(null==X?void 0:X.labourTotalBeforeDiscount)?parseFloat(null==X?void 0:X.labourTotalBeforeDiscount):0,this.totalPaintCost=(null==X?void 0:X.paintSubTotal)?parseFloat(null==X?void 0:X.paintSubTotal):0,this.total.total=(null===(R=this.estimateResponse)||void 0===R?void 0:R.subTotal)||0,this.total.vatPercent=(null===(k=this.estimateResponse)||void 0===k?void 0:k.taxPercentage)||0,this.total.vat=(null===(r=this.estimateResponse)||void 0===r?void 0:r.taxTotal)||0,this.total.totalWithVat=(null===(C=this.estimateResponse)||void 0===C?void 0:C.total)||0,(null===(i=this.estimateResponse)||void 0===i?void 0:i.currencyCode)&&(this.i18n.currencySymbol=null===(l=this.estimateResponse)||void 0===l?void 0:l.currencyCode),this.summary.parts.partsSubTotal=(null===(h=null===(c=this.estimateResponse)||void 0===c?void 0:c.estimateSummary)||void 0===h?void 0:h.partsSubTotal)||0,this.summary.parts.sundryParts=(null===(P=null===(M=this.estimateResponse)||void 0===M?void 0:M.estimateSummary)||void 0===P?void 0:P.sundryParts)||0,this.summary.parts.sundryPartsPercentage=(null===(ce=null===(H=this.estimateResponse)||void 0===H?void 0:H.estimateSummary)||void 0===ce?void 0:ce.sundryPartsPercentage)||0,this.summary.parts.partsTotalBeforeDiscount=(null===(pe=null===(re=this.estimateResponse)||void 0===re?void 0:re.estimateSummary)||void 0===pe?void 0:pe.partsTotalBeforeDiscount)||0,this.summary.parts.partsTotalDiscountPercentage=(null===(me=null===(ue=this.estimateResponse)||void 0===ue?void 0:ue.estimateSummary)||void 0===me?void 0:me.partsTotalDiscountPercentage)||0,this.summary.parts.partsTotal=(null===(he=null===(_e=this.estimateResponse)||void 0===_e?void 0:_e.estimateSummary)||void 0===he?void 0:he.partsTotal)||0,this.summary.parts.partsTotalDiscount=(null===(ve=null===(ge=this.estimateResponse)||void 0===ge?void 0:ge.estimateSummary)||void 0===ve?void 0:ve.partsTotalDiscount)||0,this.summary.labour.labourTimeHours=(null===(xe=null===(fe=this.estimateResponse)||void 0===fe?void 0:fe.estimateSummary)||void 0===xe?void 0:xe.labourTimeHours)||0,this.summary.labour.labourTotalDiscountPercentage=(null===(Se=null===(Ce=this.estimateResponse)||void 0===Ce?void 0:Ce.estimateSummary)||void 0===Se?void 0:Se.labourTotalDiscountPercentage)||0,this.summary.labour.labourTotalDiscount=(null===(be=null===(Te=this.estimateResponse)||void 0===Te?void 0:Te.estimateSummary)||void 0===be?void 0:be.labourTotalDiscount)||0,this.summary.labour.labourTotal=(null===(Me=null===(Oe=this.estimateResponse)||void 0===Oe?void 0:Oe.estimateSummary)||void 0===Me?void 0:Me.labourTotal)||0,this.summary.paint.labour.paintLabourTimeHour=(null===(Ze=null===(qe=this.estimateResponse)||void 0===qe?void 0:qe.estimateSummary)||void 0===Ze?void 0:Ze.paintLabourTimeHour)||0,this.summary.paint.labour.paintLabourSubTotal=(null===(Ie=null===(Ae=this.estimateResponse)||void 0===Ae?void 0:Ae.estimateSummary)||void 0===Ie?void 0:Ie.paintLabourSubTotal)||0,this.summary.paint.labour.paintLabourDiscountPercentage=(null===(Ue=null===(Pe=this.estimateResponse)||void 0===Pe?void 0:Pe.estimateSummary)||void 0===Ue?void 0:Ue.paintLabourDiscountPercentage)||0,this.summary.paint.labour.paintLabourDiscount=(null===(we=null===(ye=this.estimateResponse)||void 0===ye?void 0:ye.estimateSummary)||void 0===we?void 0:we.paintLabourDiscount)||0,this.summary.paint.labour.paintLabourTotal=(null===(Ee=null===(De=this.estimateResponse)||void 0===De?void 0:De.estimateSummary)||void 0===Ee?void 0:Ee.paintLabourTotal)||0,this.summary.paint.material.paintMaterialSubTotal=(null===(Re=null===(Le=this.estimateResponse)||void 0===Le?void 0:Le.estimateSummary)||void 0===Re?void 0:Re.paintMaterialSubTotal)||0,this.summary.paint.material.paintMateriaDiscountPercentage=(null===(Ne=null===(ke=this.estimateResponse)||void 0===ke?void 0:ke.estimateSummary)||void 0===Ne?void 0:Ne.paintMateriaDiscountPercentage)||0,this.summary.paint.material.paintMaterialDiscount=(null===(Je=null===(Be=this.estimateResponse)||void 0===Be?void 0:Be.estimateSummary)||void 0===Je?void 0:Je.paintMaterialDiscount)||0,this.summary.paint.material.paintMaterialTotal=(null===(Ge=null===(Fe=this.estimateResponse)||void 0===Fe?void 0:Fe.estimateSummary)||void 0===Ge?void 0:Ge.paintMaterialTotal)||0,this.summary.paint.paintTotal=(null===(Qe=null===(je=this.estimateResponse)||void 0===je?void 0:je.estimateSummary)||void 0===Qe?void 0:Qe.paintTotal)||0}}handleIconClick(a,t){this.iconClicked.emit({action:a,id:t})}displayNotes(a){return a.isAztPartDocumentedByGT?'<img src="assets/img/gt.png" />':a.isConditionedBy?"<b>C </b>":a.isIncluded?"<b> I </b>":a.isNotIncluded?"<b>NI</b>":a.isOverlappedBy?"<b>-</b>":a.isPrepainted?'<img src="assets/img/prepainted_part.png" />':a.isThrownBy?"<b>+</b>":a.isApproximate?'<img src="assets/img/approximate.png" />':a.isManual?'<img src="assets/img/white_flag.png" />':""}isGTEstimate(){return"GTMotive"===this.estimateSource}handledownloadPdf(){this.downloadPdf.emit()}}return o.\u0275fac=function(a){return new(a||o)(e.Y36(n.M))},o.\u0275cmp=e.Xpm({type:o,selectors:[["chq-estimate-details"]],inputs:{estimateResponse:"estimateResponse",editEstimate:"editEstimate",estimateSource:"estimateSource",serviceType:"serviceType",i18n:"i18n"},outputs:{iconClicked:"iconClicked",downloadPdf:"downloadPdf"},features:[e.TTD],decls:9,vars:6,consts:[[1,"d-flex","justify-space-between","align-center","estimate-label"],[3,"buttonModel","click",4,"ngIf"],[1,"estimate-main-container"],["class","estimate-details-block",4,"ngIf"],["class","estimate-details-no-data-found",4,"ngIf"],[3,"buttonModel","click"],[1,"estimate-details-block"],[1,"table-parent","mt-0"],[1,"small-heading"],["width","100%"],[4,"ngIf"],[3,"align"],["align","center","width","80px",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],["align","right"],[1,"table-parent"],["class","paint-type small-heading",4,"ngIf"],[1,"summary"],[1,"sub-heading"],[1,"sub-total"],[1,"table-parent","mb-0"],["width","100%",1,"total-table",3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["class","notes",4,"ngIf"],["align","center","width","80px"],[3,"ngClass"],["width","20px",4,"ngIf"],[1,"text-light"],["width","20px"],[3,"innerHTML"],[1,"icon-wrapper"],[1,"edit-icon",3,"svgIcon","click"],[1,"delete-icon",3,"svgIcon","click"],[1,"paint-type","small-heading"],[1,"fw-bold"],[1,"notes"],[1,"span-1"],[1,"p-10"],["src","assets/img/white_flag.png"],["aria-hidden","false",3,"svgIcon"],["src","assets/img/gt.png"],[1,"include"],["src","assets/img/prepainted_part.png"],[1,"estimate-details-no-data-found"],[1,"no-data-svg",3,"svgIcon"],[1,"no-data-text"]],template:function(a,t){1&a&&(e.TgZ(0,"div",0),e.TgZ(1,"h3"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.ynx(4),e.YNc(5,p,1,1,"chq-button",1),e.BQk(),e.qZA(),e.TgZ(6,"div",2),e.YNc(7,G,261,405,"div",3),e.YNc(8,s,11,10,"div",4),e.qZA()),2&a&&(e.xp6(2),e.Oqu(e.lcZ(3,4,"estimate")),e.xp6(3),e.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0),e.xp6(2),e.Q6J("ngIf",!t.noDataFound),e.xp6(1),e.Q6J("ngIf",t.noDataFound))},directives:[D.O5,F.E,D.sg,D.mk,j.Hw],pipes:[b.X$,N.j],styles:['.estimate-details-block[_ngcontent-%COMP%]   .sub-heading[_ngcontent-%COMP%]{font-weight:500;font-size:14px;margin:0 0 15px;padding-left:10px}.estimate-details-block[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-weight:500;font-size:14px;margin:0 0 5px;padding-left:10px}.estimate-details-block[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]{margin:32px 0}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:14px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:14px;font-weight:500;padding-bottom:25px}.estimate-details-block[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray);font-size:12px;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]{margin-bottom:22px}.estimate-details-block[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{flex-wrap:wrap;display:flex;flex-direction:row;justify-content:space-between;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]{font-size:14px;display:flex;flex-direction:column;justify-content:flex-start;box-sizing:border-box;padding:0 10px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .p-10[_ngcontent-%COMP%]{padding:10px 0}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .include[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;grid-gap:10px;gap:10px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:12px!important;width:10px!important}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   b[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{align-self:center}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:5px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .mb-20[_ngcontent-%COMP%]{margin-bottom:20px}.estimate-details-block[_ngcontent-%COMP%]   tr.child-data[_ngcontent-%COMP%]{background:rgba(26,34,55,.2)}.estimate-details-block[_ngcontent-%COMP%]   tr.child-data[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{padding-left:20px}.estimate-details-block[_ngcontent-%COMP%]   .paint-type[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;width:50%;font-size:12px;color:var(--xa-dark-gray)}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 385px - (5px + 1.5vw + 48px + 1.6vw))}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:"Inter";font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}']}),o})()},39912:(ae,K,d)=>{d.d(K,{q:()=>k});var e=d(37716),n=d(75983),D=d(48873),j=d(4893),b=d(13975),N=d(95016),p=d(55278),Q=d(56785),V=d(38583),Y=d(8571),te=d(35782),A=d(48262),v=d(76627),w=d(36072),B=d(22406),ee=d(36978),ie=d(2913),oe=d(29790);const J=["chqUpload"];function se(r,C){if(1&r){const i=e.EpF();e.TgZ(0,"chq-step-header",9),e.NdJ("uploadBackHandler",function(){return e.CHM(i),e.oxw().goBackToSelection()})("back",function(){return e.CHM(i),e.oxw().showReview()}),e.qZA()}if(2&r){const i=e.oxw();e.Q6J("chqModel",i.header)("hideHeader",i.hideHeader)("hideBack",i.hideback)("hideDelete",!0)}}function le(r,C){1&r&&e._UZ(0,"mat-icon",22),2&r&&e.Q6J("svgIcon","checked")}function U(r,C){1&r&&e._UZ(0,"mat-icon",23),2&r&&e.Q6J("svgIcon","unchecked")}function $(r,C){if(1&r){const i=e.EpF();e.TgZ(0,"div",24),e.TgZ(1,"img",25),e.NdJ("load",function(){e.CHM(i);const c=e.oxw(2);return c.imageLoading[null==c.currentStep?null:c.currentStep.stepName]=!0}),e.qZA(),e.qZA()}if(2&r){const i=e.oxw(2);e.xp6(1),e.Q6J("src",null==i.currentStep?null:i.currentStep.image,e.LSH)}}function O(r,C){if(1&r){const i=e.EpF();e.TgZ(0,"div",24),e.TgZ(1,"img",25),e.NdJ("load",function(){e.CHM(i);const c=e.oxw(3);return c.imageLoading[null==c.currentStep?null:c.currentStep.stepName]=!0}),e.qZA(),e.qZA()}if(2&r){const i=e.oxw(3);e.xp6(1),e.Q6J("src",null==i.currentStep?null:i.currentStep.url,e.LSH)}}function f(r,C){if(1&r&&e.YNc(0,O,2,1,"div",18),2&r){e.oxw();const i=e.MAs(18),l=e.oxw();e.Q6J("ngIf",null==l.currentStep?null:l.currentStep.url)("ngIfElse",i)}}function L(r,C){if(1&r){const i=e.EpF();e.TgZ(0,"div",26),e.TgZ(1,"img",25),e.NdJ("load",function(){e.CHM(i);const c=e.oxw(2);return c.imageLoading[null==c.currentStep?null:c.currentStep.stepName]=!0}),e.qZA(),e.qZA()}if(2&r){const i=e.oxw(2);e.xp6(1),e.Q6J("src",null==i.currentStep?null:i.currentStep.placeHolderUrl,e.LSH)}}function u(r,C){if(1&r&&(e.TgZ(0,"div",10),e.TgZ(1,"div",11),e.TgZ(2,"h3",12),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,le,1,1,"mat-icon",13),e.YNc(6,U,1,1,"ng-template",null,14,e.W1O),e.qZA(),e.TgZ(8,"div",15),e.TgZ(9,"span",16),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.qZA(),e.TgZ(12,"div",17),e.ynx(13),e.YNc(14,$,2,1,"div",18),e.YNc(15,f,1,2,"ng-template",null,19,e.W1O),e.YNc(17,L,2,1,"ng-template",null,20,e.W1O),e._UZ(19,"chq-customloader",21),e.BQk(),e.qZA(),e.qZA()),2&r){const i=e.MAs(7),l=e.MAs(16),c=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,7,null!=c.currentStep&&c.currentStep.isAdditionalDocumentFromReviewPageOnly?"photos"===c.inspection?"add_additional_image":"add_additional_documents":null==c.currentStep?null:c.currentStep.stepName)," "),e.xp6(2),e.Q6J("ngIf","success"===(null==c.currentStep?null:c.currentStep.uploadStatus)||(null==c.currentStep?null:c.currentStep.url))("ngIfElse",i),e.xp6(5),e.Oqu(null!=c.currentStep&&c.currentStep.isUploadSuccess?"Uploaded":e.lcZ(11,9,null!=c.currentStep&&c.currentStep.uploadInProgress?"upload_inprogress":"not_uploaded")),e.xp6(4),e.Q6J("ngIf",null==c.currentStep?null:c.currentStep.image)("ngIfElse",l),e.xp6(5),e.Q6J("showLoading",!c.imageLoading[null==c.currentStep?null:c.currentStep.stepName]&&!(null==c.currentStep||!c.currentStep.url))}}function g(r,C){if(1&r){const i=e.EpF();e.TgZ(0,"div",27),e.TgZ(1,"chq-vertical-image-preview",28),e.NdJ("selection",function(c){return e.CHM(i),e.oxw().setCurrentStep(c)}),e.qZA(),e.qZA()}if(2&r){const i=e.oxw();e.xp6(1),e.Q6J("maximumImages",i.maximumImages)("page",i.inspection)("steps",i.imageStatusSteps)("isMultipleUpload",i.isMassUpload)}}function x(r,C){1&r&&(e.TgZ(0,"div",29),e._UZ(1,"img",30),e.TgZ(2,"label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA()),2&r&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"drag_drop")))}function q(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.cancelButtonModel)}}function E(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.backButtonModel)}}function y(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.skipButtonModel)}}function I(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.uploadButtonModel)}}function W(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.deleteButton)}}function Z(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.retakeButton)}}function G(r,C){if(1&r&&(e.TgZ(0,"div",37),e.YNc(1,q,1,1,"chq-button",38),e.YNc(2,E,1,1,"chq-button",38),e.YNc(3,y,1,1,"chq-button",38),e.YNc(4,I,1,1,"chq-button",38),e.YNc(5,W,1,1,"chq-button",38),e.YNc(6,Z,1,1,"chq-button",38),e.qZA()),2&r){const i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.showDelete&&(null==i.header?null:i.header.isRepairModule)&&!i.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",!0===(null==i.footerOptions?null:i.footerOptions.showUploadOption)&&!(null!=i.header&&i.header.isRepairModule)),e.xp6(1),e.Q6J("ngIf",!(null!=i.currentStep&&i.currentStep.mandatory||i.showReTakeDelete&&-1===(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))&&(null!=i.currentStep&&i.currentStep.image||null!=i.currentStep&&i.currentStep.url))),e.xp6(1),e.Q6J("ngIf",(!i.showReTakeDelete||-1!==(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))||!(null!=i.currentStep&&i.currentStep.image)&&!(null!=i.currentStep&&i.currentStep.url))&&!i.commonService.isViewOnly&&i.currentStatus),e.xp6(1),e.Q6J("ngIf",i.showReTakeDelete&&!i.commonService.isViewOnly&&i.currentStatus&&-1===(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))&&((null==i.currentStep?null:i.currentStep.image)||(null==i.currentStep?null:i.currentStep.url))),e.xp6(1),e.Q6J("ngIf",i.showReTakeDelete&&!i.commonService.isViewOnly&&i.currentStatus&&-1===(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))&&((null==i.currentStep?null:i.currentStep.image)||(null==i.currentStep?null:i.currentStep.url)))}}function s(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.cancelButtonModel)}}function m(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.backButtonModel)}}function o(r,C){if(1&r&&e._UZ(0,"chq-button",39),2&r){const i=e.oxw(4);e.Q6J("buttonModel",i.uploadButtonModel)}}function _(r,C){if(1&r&&(e.TgZ(0,"div",37),e.YNc(1,s,1,1,"chq-button",38),e.YNc(2,m,1,1,"chq-button",38),e.YNc(3,o,1,1,"chq-button",38),e.qZA()),2&r){const i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.showDelete&&(null==i.header?null:i.header.isRepairModule)&&!i.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",!0===(null==i.footerOptions?null:i.footerOptions.showUploadOption)&&!(null!=i.header&&i.header.isRepairModule)),e.xp6(1),e.Q6J("ngIf",(!i.showReTakeDelete||i.hideback||-1!==(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))||!(null!=i.currentStep&&i.currentStep.image)&&!(null!=i.currentStep&&i.currentStep.url))&&i.currentStatus&&!i.commonService.isViewOnly)}}function a(r,C){if(1&r&&(e.ynx(0),e.YNc(1,G,7,6,"div",36),e.YNc(2,_,4,3,"div",36),e.BQk()),2&r){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!i.isMassUpload),e.xp6(1),e.Q6J("ngIf",i.isMassUpload)}}function t(r,C){if(1&r&&(e.TgZ(0,"div",31),e.TgZ(1,"div",32),e.TgZ(2,"div",33),e._UZ(3,"img",34),e.qZA(),e.qZA(),e.YNc(4,a,3,2,"ng-container",35),e.qZA()),2&r){const i=e.oxw();e.xp6(3),e.MGl("src","assets/img/",+(null==i.header?null:i.header.isRepairModule)?"addenda-repair.png":"addenda-quote.png","",e.LSH),e.xp6(1),e.Q6J("chqPermission",null!=i.footerOptions&&i.footerOptions.section?"repairStages":"newBooking")}}function S(r,C){if(1&r){const i=e.EpF();e.TgZ(0,"chq-review-section",40),e.NdJ("backToUpload",function(){return e.CHM(i),e.oxw().goBackToSelection()})("handleDeleteAllEvent",function(){return e.CHM(i),e.oxw().handleAllImagesDelete()})("selection",function(c){return e.CHM(i),e.oxw().handleReviewAction(c)}),e.qZA()}if(2&r){const i=e.oxw();e.Q6J("maximumImages",i.maximumImages)("hideAI",i.hideAI)("isRepairStage",i.isRepairStage)("minimumPhotosRequired",i.minumumImagesRequired)("footerOptions",i.footerOptions)("currentAdditionalModeMultiple",i.currentAdditionalModeMultiple)("isMultipleUpload",i.isMassUpload)("inspectionId",i.inspectionId)("header",i.header)("steps",i.imageStatusSteps)}}const T=function(r,C){return{"no-border":r,"document-container":C}},R=function(r){return{disabled:r}};let k=(()=>{class r{constructor(i,l,c,h,M,P,H){this.cd=i,this.commonService=l,this.inspectionService=c,this.monitorService=h,this.route=M,this.router=P,this.calendarService=H,this.minumumImagesRequired=0,this.updateMassUpload=new e.vpe,this.cardSelection=new e.vpe,this.backToUpload=new e.vpe,this.handleDeleteAllEvent=new e.vpe,this.stepSkipped=new e.vpe,this.totalAdditionalSteps=0,this.hideHeader=!1,this.skipButtonModel={label:"skip",type:"primary"},this.uploadButtonModel={label:"upload",type:"primary"},this.retakeButton={label:"retake",type:"primary"},this.backButtonModel={label:"back_to_photo",type:"outline"},this.deleteButton={label:"delete",type:"red"},this.bookButton={label:"book_in",type:"primary"},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.imageLoading={},this.fromReviewPage=!1,this.isReviewSection=!1,this.hideback=!1,this.currentStepIndex=0,this.currentNonReviewSteps=0,this.imageStatusSteps=[]}get showDelete(){var i,l,c,h,M,P,H;return!(!(null===(i=this.footerOptions)||void 0===i?void 0:i.repairId)||"draft"!==(null===(c=null===(l=this.footerOptions)||void 0===l?void 0:l.currentStatus)||void 0===c?void 0:c.toLowerCase()))||!(!(null===(h=this.footerOptions)||void 0===h?void 0:h.repairId)||1!=(null===(M=this.footerOptions)||void 0===M?void 0:M.isRepairCreatedFromCase)||"repairestimation"!=(null===(H=null===(P=this.footerOptions)||void 0===P?void 0:P.currentStatus)||void 0===H?void 0:H.toLowerCase()))}handleImageOutput(i){var l;if(this.monitorService.logEvent("handleImageOutput",["ChqImagesUploaderComponent","addenda-quote",{$event:i}]),this.isMassUpload||this.currentAdditionalModeMultiple){this.currentAdditionalModeMultiple=!0;const c=i;let h=0;for(const M in c){const P=c[M],H={stepName:P.fileName,uploadStatus:"notUploaded",url:"",image:P.image,imageFile:P.file,index:h,sizeLimit:5242880,isMassUpload:!0,allowExtension:["jpg","jpeg","png"],mandatory:!0,placeHolderUrl:"",isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,templateGuid:"",partTemplateGuid:""};h++,this.imageStatusSteps.push(H)}this.updateMassUpload.emit(this.isMassUpload?{steps:this.imageStatusSteps.filter(M=>1!=M.isUploadSuccess&&!0!==M.uploadInProgress)}:{steps:[this.imageStatusSteps[this.imageStatusSteps.length-1]]}),this.nonAdditional<(this.maximumImages||20)?0===this.imageStatusSteps.filter(P=>-1===P.index&&!0===P.isAdditionalDocumentFromReviewPageOnly).length&&this.imageStatusSteps.push({stepName:"photos"===this.inspection?"Additional Image":"Additional Documents",uploadStatus:"notUploaded",url:"",image:"",index:-1,isAdditionalDocumentFromReviewPageOnly:!0,sizeLimit:5242880,allowExtension:["jpg","jpeg","png"],mandatory:!1,isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,templateGuid:"",partTemplateGuid:"",placeHolderUrl:"/assets/icons/additional-image.svg"}):(this.imageStatusSteps=null===(l=null==this?void 0:this.imageStatusSteps)||void 0===l?void 0:l.filter(M=>1!=M.isAdditionalDocumentFromReviewPageOnly||M.image||M.url),this.imageStatusSteps[this.imageStatusSteps.length-1].isAdditionalDocumentFromReviewPageOnly=!1),this.imageStatusSteps=[...this.imageStatusSteps],this.isReviewSection=!0,this.fromReviewPage=!1}else{const c=i;if(this.currentStep.isAdditionalDocumentFromReviewPageOnly){const h=this.imageStatusSteps.filter(M=>!0===M.isAdditionalDocumentFromReviewPageOnly&&1!=M.uploadInProgress);this.currentStep=h[0]}if(this.currentStep.image=c.image,this.currentStep.imageFile=c.file,this.imageStatusSteps=[...this.imageStatusSteps],"photos"==this.inspection){const h=new Image;h.src=c.image,h.onload=()=>{var M;this.currentStep.imageHeight=h.height,this.currentStep.imageWidth=h.width,this.executeUploader(),0==(null===(M=this.imageStatusSteps.filter(P=>H=>!0!==H.isUploadSuccess&&H.mandatory))||void 0===M?void 0:M.length)||this.fromReviewPage||this.currentStep.isAdditionalDocumentFromReviewPageOnly?(this.isReviewSection=!0,this.fromReviewPage=!1):(this.isReviewSection=!1,this.currentStepIndex++,this.currentStepIndex>this.imageStatusSteps.length-1&&this.currentStepIndex--,this.currentStep=this.imageStatusSteps[this.currentStepIndex])}}else this.executeUploader(),this.currentStepIndex===this.imageStatusSteps.length||0===this.totalAdditionalSteps&&this.currentStepIndex===this.imageStatusSteps.length-1||this.currentStep.isAdditionalDocumentFromReviewPageOnly||this.fromReviewPage?(this.isReviewSection=!0,this.fromReviewPage=!1,this.checkRouteParams()):(this.isReviewSection=!1,this.currentStepIndex++,this.currentStep=this.imageStatusSteps[this.currentStepIndex],this.cardSelection.emit(this.currentStep))}}checkRouteParams(){var i;null===(i=this.route.queryParams)||void 0===i||i.subscribe(l=>{const c=l.fromPersonal;"true"===c||!0===c?this.router.navigate(["/repair/booking/0"]):(this.isReviewSection=!0,this.fromReviewPage=!1)})}onScroll(){window.clearTimeout(this.isScrolling);const i=document.getElementsByClassName("footer-full-wrapper");i&&i.length>0&&(i[0].style.position="absolute"),this.isScrolling=setTimeout(()=>{const l=document.getElementsByClassName("footer-full-wrapper");l&&l.length>0&&(l[0].style.position="fixed")},66)}get nonAdditional(){var i;return null===(i=null==this?void 0:this.imageStatusSteps)||void 0===i?void 0:i.filter(l=>1!=l.isAdditionalDocumentFromReviewPageOnly||l.image||l.url).length}goToReview(){this.isReviewSection=!0,this.fromReviewPage=!1,this.monitorService.logEvent("goToReview",["ChqImagesUploaderComponent","addenda-quote"])}handleAllImagesDelete(){this.imageStatusSteps=[],this.handleDeleteAllEvent.emit()}executeUploader(){this.fileUploaderService&&(this.commonService.showNotification("Your photo is currently uploading won\u2019t be long and we\u2019ll \n    notify you when its uploaded, you can continue to take your photos."),this.fileUploaderService(this.currentStep),this.monitorService.logEvent("executeUploader",["ChqImagesUploaderComponent","addenda-quote"]),setTimeout(()=>{const l=this.imageStatusSteps.filter(c=>!0===c.uploadInProgress);l.length>0&&(this.hideback=!0),this.commonService.inProgressSteps.next(l.length)}))}handleReviewAction(i){var l,c,h,M;this.monitorService.logEvent("handleReviewAction",["ChqImagesUploaderComponent","addenda-quote",{$event:i}]),(null===(l=this.footerOptions)||void 0===l?void 0:l.repairId)&&["edit","upload"].includes(i.mode)&&(null===(c=this.footerOptions)||void 0===c?void 0:c.from)==n.j.quote&&this.commonService.repairPermission||(null===(h=this.footerOptions)||void 0===h?void 0:h.caseId)&&["edit","upload"].includes(i.mode)&&(null===(M=this.footerOptions)||void 0===M?void 0:M.from)==n.j.repair&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.handleReviewActionCall.bind(this,i),"Quote"==this.footerOptions.from?"Repair":"Quote"):this.handleReviewActionCall(i)}handleReviewActionCall(i){if("edit"===i.mode)this.setCurrentStep(i.step),this.isReviewSection=!1,this.fromReviewPage=!0;else if("upload"===i.mode)this.setCurrentStep(i.step),this.fromReviewPage=!0,this.uploadFile();else if(i.step.inspectionItem){const l=this.imageStatusSteps.findIndex(c=>{var h,M;return(null===(h=c.inspectionItem)||void 0===h?void 0:h.id)===(null===(M=i.step.inspectionItem)||void 0===M?void 0:M.id)});this.deleteSelectedImage(i.step,l)}else{const l=i.step.index;this.deleteSelectedImage(this.imageStatusSteps[l],l)}}deleteSelectedImage(i,l){i.url="",i.uploadedGuid="",i.updatedDate="",i.uploadedDate="",i.uploadInProgress=!1,i.isSkipped=!1,i.isUploadSuccess=!1,i.uploadedPartGuid="",i.isUploadFailed=!1,i.imageFile=null,i.image=null,i.uploadStatus="notUploaded",-1!=i.stepName.indexOf("Additional")&&(i.isAdditionalDocumentFromReviewPageOnly=!0),i.isMassUpload||"Bulk Upload Image"===i.procedureSteps?this.imageStatusSteps=this.imageStatusSteps.filter(h=>{var M,P;return(null===(M=null==h?void 0:h.inspectionItem)||void 0===M?void 0:M.id)!=(null===(P=null==i?void 0:i.inspectionItem)||void 0===P?void 0:P.id)}):(this.imageStatusSteps[l]=Object.assign({},i),this.imageStatusSteps=[...this.imageStatusSteps],0===this.imageStatusSteps.filter(M=>M.image||M.url).length&&"photos"===this.inspection?(this.footerOptions.showUploadOption=!0,this.hideback=!1,this.header=Object.assign(Object.assign({},this.header),{showTitle:!0})):this.header=Object.assign(Object.assign({},this.header),{showTitle:!1})),0===this.imageStatusSteps.filter(h=>h.url).length&&(this.hideback=!1,this.setCurrentStep(this.imageStatusSteps[0]))}get currentStatus(){var i,l,c;return!(null===(i=this.footerOptions)||void 0===i?void 0:i.currentStatus)||-1===["closed","complete"].indexOf(null===(c=null===(l=this.footerOptions)||void 0===l?void 0:l.currentStatus)||void 0===c?void 0:c.toLowerCase())}delete(){this.monitorService.logEvent("delete",["ChqImagesUploaderComponent","addenda-quote"]),this.currentStep.url&&"photos"===this.inspection&&this.inspectionService.deleteInspection(this.currentStep.inspectionItem.id).subscribe(l=>{this.commonService.hideLoading(),0===this.imageStatusSteps.filter(h=>h.image||h.url).length&&(this.footerOptions.showUploadOption=!0)},()=>{this.commonService.hideLoading()}),this.currentStep.image=null,this.currentStep.uploadedGuid="",this.currentStep.uploadInProgress=!1,this.currentStep.isSkipped=!1,this.currentStep.isUploadSuccess=!1,this.currentStep.isUploadFailed=!1,this.currentStep.imageFile=null,this.currentStep.url="",this.currentStep.updatedDate="",this.currentStep.uploadedDate="",this.currentStep.uploadStatus="notUploaded",-1!=this.currentStep.stepName.indexOf("Additional")&&(this.currentStep.isAdditionalDocumentFromReviewPageOnly=!0),0===this.imageStatusSteps.filter(l=>l.url).length&&(this.hideback=!1,this.setCurrentStep(this.imageStatusSteps[0]))}updateUploadStatus(i,l,c,h,M){var P,H;if(this.monitorService.logEvent("updateUploadStatus",["ChqImagesUploaderComponent","addenda-quote",{status:i,currentStep:l,responseData:h,isBulk:M}]),this.chqUpload.resetValue(),"failed"==i){l.uploadInProgress=!1,l.isSkipped=!1,l.isUploadSuccess=!1,l.isUploadFailed=!1,M?l.isUploadFailed=!0:(l.imageFile=null,l.image=null);const re=c&&(null===(P=c.error)||void 0===P?void 0:P.msg)?null===(H=c.error)||void 0===H?void 0:H.msg:`Your photo \u2018${l.stepName}\u2019 failed to upload. Please try to upload again.`;this.commonService.showToast(c?c.status:0,re),this.currentStep.isAdditionalDocumentFromReviewPageOnly&&(this.currentStep={stepName:"photos"===this.inspection?"Additional Image":"Additional Documents",uploadStatus:"notUploaded",url:"",image:"",index:-1,isAdditionalDocumentFromReviewPageOnly:!0,sizeLimit:this.currentStep.sizeLimit,allowExtension:this.currentStep.allowExtension,mandatory:!1,isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,isMassUpload:l.isMassUpload,templateGuid:this.currentStep.templateGuid,partTemplateGuid:this.currentStep.partTemplateGuid,placeHolderUrl:"/assets/icons/additional-image.svg"})}else"success"==i&&(l.uploadInProgress=!1,l.isSkipped=!1,l.isUploadFailed=!1,l.isUploadSuccess=!0,l.uploadStatus="success",l.updatedDate=D().toISOString(),l.uploadedDate=D().toISOString(),l.isAdditionalDocumentFromReviewPageOnly=!1,"photos"===this.inspection&&(l.inspectionItem=h),h&&(l.originalName&&(l.stepName=l.originalName),l.uploadedGuid=h.mediaGuid,l.uploadedPartGuid=h.mediaPartGuid));this.imageStatusSteps=[...this.imageStatusSteps];const ce=this.imageStatusSteps.filter(re=>!0===re.uploadInProgress);this.hideback=!0,this.commonService.inProgressSteps.next(ce.length)}deleteImage(){this.monitorService.logEvent("deleteImage",["ChqImagesUploaderComponent","addenda-quote"]),this.commonService.openDeleteDialog("image").afterClosed().subscribe(i=>{i&&this.delete()})}uploadFile(){this.monitorService.logEvent("uploadFile",["ChqImagesUploaderComponent","addenda-quote"]),this.chqUpload.triggerUpload()}setCurrentStep(i){this.currentStepIndex=null==i?void 0:i.index,this.currentStep=i,-1!==(null==i?void 0:i.stepName.indexOf("Additional"))&&(this.skipButtonModel=Object.assign(Object.assign({},this.skipButtonModel),{label:"Skip and Review"})),this.cardSelection.emit(this.currentStep)}skipUpload(){var i,l;if(this.monitorService.logEvent("skipUpload",["ChqImagesUploaderComponent","addenda-quote"]),this.stepSkipped.emit(),this.currentStepIndex===this.imageStatusSteps.length||0===this.totalAdditionalSteps&&this.currentStepIndex===this.imageStatusSteps.length-1||this.currentStep.isAdditionalDocumentFromReviewPageOnly||this.fromReviewPage){if("photos"===this.inspection&&0!==(null===(i=this.imageStatusSteps.filter(c=>!0!==c.isUploadSuccess&&c.mandatory))||void 0===i?void 0:i.length))return(null===(l=this.imageStatusSteps.filter(h=>!0===h.uploadInProgress&&h.mandatory))||void 0===l?void 0:l.length)?void this.commonService.showToast(0,"Please wait until all images are uploaded."):void this.commonService.showToast(0,"All 8 sides images are mandatory and cannot skip to next section.");this.isReviewSection=!0,this.fromReviewPage=!1}else this.currentStep.isUploadSuccess||(this.currentStep.uploadStatus="skipped"),this.currentStepIndex++,this.currentStep=this.imageStatusSteps[this.currentStepIndex],this.cardSelection.emit(this.currentStep)}goBackToSelection(){const i=this.imageStatusSteps.filter(l=>l.url||l.image).length;if(this.isReviewSection&&i>0)return this.isReviewSection=!1,void(this.isMassUpload&&(this.hideHeader=!0));this.hideHeader=!1,this.backToUpload.emit()}showReview(){this.isReviewSection=!0,this.hideHeader=!1}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(i=>{i&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.footerOptions.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}dragOver(i){i.preventDefault(),i.stopPropagation()}dragLeave(i){i.preventDefault(),i.stopPropagation()}drop(i){i.preventDefault(),i.stopPropagation(),this.chqUpload.handleUpload(i)}ngOnInit(){var i;this.monitorService.logEvent("ngOnInit",["ChqImagesUploaderComponent","addenda-quote"]),this.currentStep=this.imageStatusSteps[this.currentStepIndex];const l=this.imageStatusSteps.find(h=>h.stepName.includes("Additional Document")&&!h.uploadedPartGuid);l&&(l.originalName=l.stepName,l.stepName=l.parentName,l.placeHolderUrl="/assets/icons/additional-image.svg"),this.backButtonModel=Object.assign(Object.assign({},this.backButtonModel),{onclick:this.goBackToSelection.bind(this)});for(let h=0;h<this.imageStatusSteps.length;h++)this.imageLoading[this.imageStatusSteps[h].stepName]=!1;this.currentNonReviewSteps=this.imageStatusSteps.filter(h=>!0!==h.isAdditionalDocumentFromReviewPageOnly).length,this.totalAdditionalSteps=this.imageStatusSteps.length-this.currentNonReviewSteps,this.cardSelection.emit(this.currentStep),this.commonService.updatePage("/quote/case/0",this.inspection?this.inspection:"document"),this.imageStatusSteps.filter(h=>h.url).length>0&&(this.isReviewSection=!0,this.hideback=!0),this.skipButtonModel={label:"Skip",type:"outline",onclick:this.skipUpload.bind(this)},this.uploadButtonModel={label:"Upload",type:"primary",icon:"upload",onclick:this.uploadFile.bind(this)},(null===(i=this.header)||void 0===i?void 0:i.isRepairModule)&&(this.uploadButtonModel=Object.assign(Object.assign({},this.uploadButtonModel),{icon:"",type:"outline"})),this.retakeButton={label:"Retake",type:"primary",icon:"renew",onclick:this.uploadFile.bind(this)},this.deleteButton={label:"Delete",type:"red",icon:"delete",onclick:this.deleteImage.bind(this)}}}return r.\u0275fac=function(i){return new(i||r)(e.Y36(e.sBO),e.Y36(j.v),e.Y36(b.a),e.Y36(N.M),e.Y36(p.gz),e.Y36(p.F0),e.Y36(Q.o))},r.\u0275cmp=e.Xpm({type:r,selectors:[["chq-images-uploader"]],viewQuery:function(i,l){if(1&i&&e.Gf(J,5),2&i){let c;e.iGM(c=e.CRH())&&(l.chqUpload=c.first)}},hostBindings:function(i,l){1&i&&e.NdJ("dragover",function(h){return l.dragOver(h)})("dragleave",function(h){return l.dragLeave(h)})("drop",function(h){return l.drop(h)})},inputs:{header:"header",footerOptions:"footerOptions",showReTakeDelete:"showReTakeDelete",isMassUpload:"isMassUpload",inspection:"inspection",inspectionId:"inspectionId",isRepairStage:"isRepairStage",hideAI:"hideAI",minumumImagesRequired:"minumumImagesRequired",maximumImages:"maximumImages",currentAdditionalModeMultiple:"currentAdditionalModeMultiple",fileUploaderService:"fileUploaderService",imageStatusSteps:"imageStatusSteps"},outputs:{updateMassUpload:"updateMassUpload",cardSelection:"cardSelection",backToUpload:"backToUpload",handleDeleteAllEvent:"handleDeleteAllEvent",stepSkipped:"stepSkipped"},decls:9,vars:19,consts:[[3,"chqModel","hideHeader","hideBack","hideDelete","uploadBackHandler","back",4,"ngIf"],[1,"main-container",3,"ngClass","scroll"],[3,"currentStep","currentPageName","currentFileNumber","isCurrentAdditionalModeMultiple","maxFileAllowed","ngClass","isMultiple","imageOutput"],["chqUpload",""],["class","info-container",4,"ngIf"],["class","vehicle-status-container",4,"ngIf"],["class","mass-upload",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"maximumImages","hideAI","isRepairStage","minimumPhotosRequired","footerOptions","currentAdditionalModeMultiple","isMultipleUpload","inspectionId","header","steps","backToUpload","handleDeleteAllEvent","selection",4,"ngIf"],[3,"chqModel","hideHeader","hideBack","hideDelete","uploadBackHandler","back"],[1,"info-container"],[1,"header-div"],[1,"header-label","text-black"],["aria-hidden","false","aria-label","checked icon",3,"svgIcon",4,"ngIf","ngIfElse"],["unchecked",""],[1,"span-container"],[1,"text-dark-gray"],[1,"block-image"],["class","car-image-container",4,"ngIf","ngIfElse"],["serverImage",""],["defaultImage",""],[3,"showLoading"],["aria-hidden","false","aria-label","checked icon",3,"svgIcon"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon"],[1,"car-image-container"],[3,"src","load"],[1,"car-image-container","default-image"],[1,"vehicle-status-container"],[3,"maximumImages","page","steps","isMultipleUpload","selection"],[1,"mass-upload"],["src","assets/icons/no-document.svg"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[4,"chqPermission"],["class","footer-button-wrapper",4,"ngIf"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel"],[3,"maximumImages","hideAI","isRepairStage","minimumPhotosRequired","footerOptions","currentAdditionalModeMultiple","isMultipleUpload","inspectionId","header","steps","backToUpload","handleDeleteAllEvent","selection"]],template:function(i,l){1&i&&(e.YNc(0,se,1,4,"chq-step-header",0),e.TgZ(1,"div",1),e.NdJ("scroll",function(){return l.onScroll()}),e.TgZ(2,"chq-upload",2,3),e.NdJ("imageOutput",function(h){return l.handleImageOutput(h)}),e.qZA(),e.YNc(4,u,20,11,"div",4),e.YNc(5,g,2,4,"div",5),e.YNc(6,x,5,3,"div",6),e.YNc(7,t,5,2,"div",7),e.YNc(8,S,1,10,"chq-review-section",8),e.qZA()),2&i&&(e.Q6J("ngIf",!l.isReviewSection),e.xp6(1),e.Q6J("ngClass",e.WLB(14,T,l.isReviewSection,"photos"!==l.inspection&&(null==l.header?null:l.header.isRepairModule))),e.xp6(1),e.Q6J("currentStep",l.currentStep)("currentPageName",l.inspection)("currentFileNumber",l.nonAdditional)("isCurrentAdditionalModeMultiple",l.currentAdditionalModeMultiple)("maxFileAllowed",l.maximumImages||20)("ngClass",e.VKq(17,R,null==l.currentStep?null:l.currentStep.uploadInProgress))("isMultiple",l.isMassUpload),e.xp6(2),e.Q6J("ngIf",!l.isReviewSection&&!l.isMassUpload),e.xp6(1),e.Q6J("ngIf",!l.isReviewSection&&!l.isMassUpload),e.xp6(1),e.Q6J("ngIf",!l.isReviewSection&&l.isMassUpload),e.xp6(1),e.Q6J("ngIf",!l.isReviewSection),e.xp6(1),e.Q6J("ngIf",l.isReviewSection))},directives:[V.O5,V.mk,Y.q,te._,A.h,v.Hw,w.Z,B.A,ee.E,ie.F],pipes:[oe.X$],styles:[".main-container[_ngcontent-%COMP%]{display:flex;border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-white)}.main-container.document-container[_ngcontent-%COMP%]{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;position:relative;border-right:1px solid var(--xa-light-gray);padding:54px 34px}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .header-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .header-div[_ngcontent-%COMP%]   .header-label[_ngcontent-%COMP%]{margin-right:16px}.main-container[_ngcontent-%COMP%]   .span-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;line-height:14px}.main-container[_ngcontent-%COMP%]   .block-image[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;grid-gap:10px;gap:10px;flex:1;justify-content:center;position:relative}.main-container[_ngcontent-%COMP%]   .block-image[_ngcontent-%COMP%]   .car-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:auto;width:auto;max-height:calc(100vh - 168px - 188px - 126px);max-width:100%}.main-container[_ngcontent-%COMP%]   .vehicle-status-container[_ngcontent-%COMP%]{overflow:auto;z-index:2;border-top-right-radius:8px;border-bottom-right-radius:8px}.main-container[_ngcontent-%COMP%]   chq-review-section[_ngcontent-%COMP%]{flex:1}.no-border[_ngcontent-%COMP%]{border:none;background:transparent}.disabled[_ngcontent-%COMP%]{pointer-events:none}.mass-upload[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex:1;flex-direction:column;width:154px;height:calc(100vh - 295px)}.mass-upload[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:154px}.mass-upload[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:12px;line-height:16px;color:var(--xa-text-ligher-gray)}.no-border.main-container[_ngcontent-%COMP%]{padding-bottom:1.5vw}.main-container[_ngcontent-%COMP%]:not(.no-border){height:calc(100vh - 170px - (calc(1.5vw)) - (calc(5px + 1.5vw + 48px + 1.6vw)))}"]}),r})()},8571:(ae,K,d)=>{d.d(K,{q:()=>V});var e=d(37716),n=d(67980),D=d(84967),F=d(33568),j=d(84945),b=d(83853),N=d(4893),p=d(95016);const Q=["upload"];let V=(()=>{class Y{constructor(A,v,w){this.el=A,this.commonService=v,this.monitorService=w,this.imageOutput=new e.vpe,this.maxFileAllowed=20}getFileExtension(A){return A.split(".").pop()}checkFileSize(A){return!(A.size>(this.currentStep?this.currentStep.sizeLimit:b.rs)||A.size<b.fi&&"photos"===this.currentPageName)||(this.monitorService.logEvent("checkFileSize",["ChqUploadComponent","addenda-quote",{message:"invalid file size."}]),!1)}isValidImageFile(A){if(new RegExp("^.*\\.[a-zA-Z]+$","gm").test(A)){const w=A.split(".").pop();return(this.currentStep?this.currentStep.allowExtension:b.m2).includes(null==w?void 0:w.toLowerCase())}return!1}triggerUpload(){setTimeout(()=>{this.upload.nativeElement.click()})}resetValue(){setTimeout(()=>{this.upload.nativeElement.value=null})}fileReaderObservable(A){return new n.y(w=>{const B=new FileReader;B.readAsDataURL(A),B.onload=ee=>{w.next({image:B.result,fileName:A.name,file:A}),w.complete()}})}handleUpload(A){this.monitorService.logEvent("handleUpload",["ChqUploadComponent","addenda-quote",{event:A}]);const v=A.target.files||A.srcElement.files||A.dataTransfer.files;if(null!==v&&""!==v&&v.length>0)if(this.commonService.showLoading(),this.isMultiple||this.isCurrentAdditionalModeMultiple){if(v.length>this.maxFileAllowed)return this.commonService.showToast(0,`Maximum ${this.maxFileAllowed} files are allowed.`),this.commonService.hideLoading(),void this.resetValue();if(v.length+this.currentFileNumber>this.maxFileAllowed)return this.commonService.showToast(0,`Maximum ${this.maxFileAllowed} files are allowed.`),this.commonService.hideLoading(),void this.resetValue();const w={};let B=0,ee=0;for(let J=0;J<v.length;J++)this.isValidImageFile(v[J].name)?this.checkFileSize(v[J])||this.skipFileSizeValidation?w[J]=this.fileReaderObservable(v[J]):ee++:B++;if(ee>0&&this.commonService.showToast(0,"For an accurate A.I. analysis please upload images which are not smaller than 0.5 MB and do not exceed 5 MB"),B>0&&this.commonService.showToast(0,"Failed to upload file; the format is not supported."),0===Object.keys(w).length)return this.commonService.hideLoading(),void this.resetValue();(0,D.D)(w).pipe((0,F.K)(J=>(0,j.of)(J))).subscribe(J=>{this.commonService.hideLoading(),J&&this.imageOutput.emit(J),this.resetValue()},()=>{this.resetValue(),this.commonService.hideLoading()})}else{if(!this.isValidImageFile(v[0].name))return this.commonService.showToast(0,"Failed to upload file; the format is not supported."),this.commonService.hideLoading(),void this.resetValue();if(!this.checkFileSize(v[0])){let B="For an accurate A.I. analysis please upload image which are not smaller than 0.5 MB and do not exceed 5 MB";return"photos"!==this.currentPageName&&(B="Image is not of the correct size.  Please provide valid file size  (Max : 5 MB)"),this.commonService.showToast(0,B),this.commonService.hideLoading(),void this.resetValue()}const w=new FileReader;w.readAsDataURL(v[0]),w.onload=B=>{this.commonService.hideLoading(),this.resetValue(),this.imageOutput.emit({image:w.result,fileName:v[0].name,file:v[0]})},w.onerror=B=>{this.resetValue(),this.commonService.hideLoading()}}}}return Y.\u0275fac=function(A){return new(A||Y)(e.Y36(e.SBq),e.Y36(N.v),e.Y36(p.M))},Y.\u0275cmp=e.Xpm({type:Y,selectors:[["chq-upload"]],viewQuery:function(A,v){if(1&A&&e.Gf(Q,5),2&A){let w;e.iGM(w=e.CRH())&&(v.upload=w.first)}},inputs:{currentStep:"currentStep",isMultiple:"isMultiple",isCurrentAdditionalModeMultiple:"isCurrentAdditionalModeMultiple",currentFileNumber:"currentFileNumber",skipFileSizeValidation:"skipFileSizeValidation",currentPageName:"currentPageName",maxFileAllowed:"maxFileAllowed"},outputs:{imageOutput:"imageOutput"},decls:2,vars:1,consts:[["hidden","","type","file","accept","image/png, image/jpg, image/jpeg",3,"multiple","change"],["upload",""]],template:function(A,v){1&A&&(e.TgZ(0,"input",0,1),e.NdJ("change",function(B){return v.handleUpload(B)}),e.qZA()),2&A&&e.Q6J("multiple",v.isMultiple)},encapsulation:2}),Y})()}}]);