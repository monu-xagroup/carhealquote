"use strict";(self.webpackChunkcar_heal_quote=self.webpackChunkcar_heal_quote||[]).push([[299],{14368:(te,F,r)=>{r.d(F,{I:()=>G});var e=r(7274),a=r(94650),R=r(12484),N=r(89383);let G=(()=>{class v{constructor(u,k,Q){this.dialogRef=u,this.monitorService=k,this.data=Q}continue(){this.dialogRef.close(!0),this.monitorService.logEvent("close",["GtMotiveEstimationDialogComponent","addenda-quote"])}}return v.\u0275fac=function(u){return new(u||v)(a.Y36(e.so),a.Y36(R.M),a.Y36(e.WI))},v.\u0275cmp=a.Xpm({type:v,selectors:[["app-gt-motive-estimation-dialog"]],decls:11,vars:3,consts:[[1,"message-container"],[1,"header"],[1,"content"],[1,"footer","form-data-footer"],["mat-dialog-close","",1,"btn-confirm",3,"click"]],template:function(u,k){1&u&&(a.TgZ(0,"div",0)(1,"div",1)(2,"h3"),a._uU(3,"Notification!"),a.qZA()(),a.TgZ(4,"div",2)(5,"label"),a._uU(6),a.ALo(7,"translate"),a.qZA()(),a.TgZ(8,"div",3)(9,"button",4),a.NdJ("click",function(){return k.continue()}),a._uU(10,"Continue"),a.qZA()()()),2&u&&(a.xp6(6),a.Oqu(a.lcZ(7,1,k.data.message)))},dependencies:[e.ZT,N.X$],styles:[".message-container[_ngcontent-%COMP%]{padding:20px 20px 40px 62px;width:480px;background-color:var(--xa-white)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:38px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:32px;margin-right:38px}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;margin-top:52px;margin-right:38px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;display:block;background-color:var(--xa-black);color:#fff}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{margin-right:4px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:4px}"]}),v})()},60562:(te,F,r)=>{r.d(F,{Gp:()=>G,br:()=>a,mo:()=>R,nG:()=>N});var e=r(24006);const a=()=>({vin:{placeHolder:"search_vin",name:"vin",label:"vin_number",type:"text",value:0,icon:"search",maxLength:17,validation:{name:"vin",validationFunction:()=>e.kI.compose([e.kI.minLength(17),e.kI.pattern("^[a-hA-Hj-nJ-NpPr-zR-Z0-9]+$")]),validationMessage:v=>v.pattern?"pattern_vin":v.minlength?"min_length_vin":""}},make:{placeHolder:"make",name:"make",label:"make",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:0,validation:{name:"make",validationFunction:()=>e.kI.compose([e.kI.required]),validationMessage:v=>v.required?"required_make":""}},model:{placeHolder:"model",name:"model",label:"model",options:[{}],displayValue:"modelDescription",fieldValue:"modelDescription",type:"select",value:0,validation:{name:"model",validationFunction:()=>e.kI.compose([e.kI.required]),validationMessage:v=>v.required?"required_model":""}},year:{placeHolder:"import_interval",label:"import_interval",name:"year",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:0,validation:{name:"year",validationFunction:()=>e.kI.compose([e.kI.required]),validationMessage:v=>v.required?"required_year":""}},licensePlate:{placeHolder:"license_plate",label:"license_plate",name:"licensePlate",value:0,type:"text",maxLength:12,validation:{name:"licensePlate",validationFunction:()=>e.kI.compose([e.kI.required,e.kI.maxLength(12),e.kI.pattern("^[a-zA-Z0-9]*$"),G()]),validationMessage:v=>v.required?"required_license_plate":v.maxlength?"max_length_license_plate":v.pattern?"pattern_digit_alphabets":v.invalidLicensePlate?"invalid_license_plate":""}},carMilege:{placeHolder:"car_mileage",label:"mileage",name:"carMilege",value:0,type:"text",maxLength:7,validation:{name:"carMilege",validationFunction:()=>e.kI.compose([e.kI.required,e.kI.maxLength(7),e.kI.pattern("^[0-9]+$"),N()]),validationMessage:v=>v.required?"required_car_mileage":v.maxlength?"max_length_car_mileage":v.pattern?"pattern_numeric":v.invalidCarMileage?"invalid_car_mileage":""}},registrationDate:{placeHolder:"first_reg_mfg_date",label:"reg_mfg_date",name:"registrationDate",value:"",type:"date",maxDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-1),minDate:new Date("1980-01-01"),disabled:!0,validation:{name:"registrationDate",validationFunction:()=>e.kI.compose([e.kI.required]),validationMessage:v=>v.required?"required_date":""}}}),R={title:"add_vehicle",step:2,description:"add_vehicle_msg",stepName:"step_two"};function N(){const v={invalidCarMileage:!1};return w=>w.value<1&&""!=w.value?(v.invalidCarMileage=!0,v):null}function G(){const v={invalidLicensePlate:!1};return w=>"0"===w.value?(v.invalidLicensePlate=!0,v):null}},74743:(te,F,r)=>{r.d(F,{n:()=>v});var e=r(54004),a=r(39646),R=r(70262),N=r(94650),G=r(81364);let v=(()=>{class w{constructor(k){this.commonService=k}resolve(){return this.commonService.showLoading(),this.commonService.checkVersion().pipe((0,e.U)(k=>{this.commonService.hideLoading();const Q=localStorage.getItem("appVersion"),B=k.buildRevision;return Q&&Q!=B?(localStorage.setItem("appVersion",B),setTimeout(()=>{location.reload()},10),(0,a.of)("new version available")):(localStorage.setItem("appVersion",B),(0,a.of)("new version is not available"))}),(0,R.K)(()=>(this.commonService.hideLoading(),(0,a.of)("data not available at this time"))))}}return w.\u0275fac=function(k){return new(k||w)(N.LFG(G.v))},w.\u0275prov=N.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})()},62119:(te,F,r)=>{r.d(F,{b:()=>$});var e=r(94650),a=r(12484),R=r(81364),N=r(81390),G=r(7274),v=r(38709),w=r(13975),u=r(87855),k=r(56785),Q=r(36895),B=r(42736),K=r(36978),P=r(89383);function h(I,q){if(1&I&&e._UZ(0,"chq-step-header",11),2&I){const f=e.oxw();e.Q6J("chqModel",f.photosHeader)}}function A(I,q){if(1&I&&(e.TgZ(0,"div",15)(1,"label",16),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"p",17),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"p",18),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"chq-button",19),e.qZA()),2&I){const f=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,4,"smart_photo_inspection")),e.xp6(3),e.Oqu(e.lcZ(6,6,"open_your_camera")),e.xp6(3),e.hij(" ",e.lcZ(9,8,"add_photo_msg")," "),e.xp6(2),e.Q6J("buttonModel",f.cameraButtonModel)}}function D(I,q){if(1&I&&(e.TgZ(0,"div",15)(1,"label",16),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"p",17),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"p",18),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"chq-button",19),e.qZA()),2&I){const f=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,4,"bulk_upload")),e.xp6(3),e.Oqu(e.lcZ(6,6,"upload_device")),e.xp6(3),e.hij(" ",e.lcZ(9,8,"bulk_msg")," "),e.xp6(2),e.Q6J("buttonModel",f.bulkUploadButtonModel)}}function H(I,q){if(1&I&&(e.TgZ(0,"div",12)(1,"div",13),e.YNc(2,A,11,10,"div",14),e.YNc(3,D,11,10,"div",14),e.qZA()()),2&I){const f=e.oxw();e.xp6(2),e.Q6J("ngIf",f.showSPI),e.xp6(1),e.Q6J("ngIf",!f.hideBulk)}}function W(I,q){if(1&I&&(e.TgZ(0,"div",20)(1,"div",21),e._UZ(2,"img",22),e.TgZ(3,"label",23),e._uU(4),e.ALo(5,"translate"),e.qZA()()()),2&I){const f=e.oxw();e.xp6(4),e.hij(" ",e.lcZ(5,1,f.repairUnapproved?"start_job":"bulk_spi_disabled")," ")}}function j(I,q){if(1&I&&e._UZ(0,"chq-button",19),2&I){const f=e.oxw();e.Q6J("buttonModel",f.cancelButtonModel)}}function E(I,q){if(1&I&&e._UZ(0,"chq-button",24),2&I){const f=e.oxw();e.Q6J("buttonModel",f.nextButton)}}function V(I,q){if(1&I&&e._UZ(0,"chq-button",19),2&I){const f=e.oxw();e.Q6J("buttonModel",f.notifyButtonModel)}}function z(I,q){if(1&I&&e._UZ(0,"chq-button",24),2&I){const f=e.oxw();e.Q6J("buttonModel",f.addPartButtonModel)}}const X={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let $=(()=>{class I{constructor(f,d,_,S,U,y,x,Z,Y){this.monitorService=f,this.commonService=d,this.route=_,this.dialog=S,this.caseService=U,this.router=y,this.inspectionService=x,this.estimateService=Z,this.calendarService=Y,this.mode=new e.vpe,this.showEstimate=!1,this.notify=new e.vpe,this.completeRepair=new e.vpe,this.nextButton={label:"Next create estimate",type:"primary",color:"primary",icon:"boardview"},this.photosHeader=X,this.notifyButtonModel={label:"notify",type:"outline",icon:"send",onclick:()=>{this.notify.emit()}},this.addPartButtonModel={label:"Complete Repair",type:"disabled",onclick:()=>{this.completeRepair.emit()}},this.cameraButtonModel={label:"camera_upload",type:"primary",icon:"camera",color:"primary",onclick:this.allowSingleUpload.bind(this)},this.bulkUploadButtonModel={label:"btn_bulk_upload",type:"primary",icon:"upload",color:"primary",onclick:this.allowMultipleUpload.bind(this)},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)}}allowSingleUpload(){this.mode.emit({mode:"single"})}get showDelete(){return!(!this.repairData?.repairGuid||"draft"!==this.repairData?.status?.toLowerCase())||!(!this.repairData?.repairGuid||1!=this.repairData?.repairGuidisRepairCreatedFromCase||"repairestimation"!=this.repairData?.status?.toLowerCase())}ngOnChanges(f){this.monitorService.logEvent("allowMultipleUpload",["ChqAddPhotosComponent","addenda-quote",{changes:f}]),f&&(f.caseNumber&&f.caseNumber.currentValue&&(this.photosHeader={...this.photosHeader,caseNumber:this.caseNumber}),f.activateRepairButton&&f.activateRepairButton.currentValue&&(this.addPartButtonModel={...this.addPartButtonModel,type:"primary"}),f.isRepairComplete&&f.isRepairComplete.currentValue&&(this.addPartButtonModel={...this.addPartButtonModel,label:"go_invoice"}))}allowMultipleUpload(){this.monitorService.logEvent("allowMultipleUpload",["ChqAddPhotosComponent","addenda-quote"]),this.mode.emit({mode:"multiple"})}redirectToGtEstimate(){this.commonService.showLoading();const{status:f,caseGuid:d,inspections:_,vehicleId:S,domainID:U}=this.caseData;let y=0;_?.length>0&&(y=_[0].inspectionId),"uploaddocuments"===f?.toLowerCase()?(this.monitorService.logEvent("redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:d}]),this.caseService.updateCaseStatus(d,"UploadPhotos").subscribe({next:x=>{this.estimateService.createEstimate(d,y,S,U).subscribe({next:Z=>{Z&&Z?.data?.url&&(location.href=Z?.data?.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}})},error:()=>{this.commonService.hideLoading()}})):"uploadphotos"===f?.toLowerCase()?(this.monitorService.logEvent("redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:d}]),this.estimateService.createEstimate(d,y,S,U).subscribe({next:x=>{x&&x?.data&&(location.href=x.data.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}})):(this.monitorService.logEvent("skipped_redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:d}]),this.router.navigate([`/case/${d}/estimate`]))}ngOnInit(){this.nextButton.onclick=this.redirectToGtEstimate.bind(this)}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(f=>{f&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.repairData?.booking?.bookingGuid).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}}return I.\u0275fac=function(f){return new(f||I)(e.Y36(a.M),e.Y36(R.v),e.Y36(N.gz),e.Y36(G.uw),e.Y36(v.n),e.Y36(N.F0),e.Y36(w.a),e.Y36(u.H),e.Y36(k.o))},I.\u0275cmp=e.Xpm({type:I,selectors:[["add-photos"]],inputs:{caseNumber:"caseNumber",caseData:"caseData",showNotify:"showNotify",showComplete:"showComplete",showEstimate:"showEstimate",repairUnapproved:"repairUnapproved",repairData:"repairData",photosHeader:"photosHeader",activateRepairButton:"activateRepairButton",showSPI:"showSPI",hideBulk:"hideBulk",isRepairComplete:"isRepairComplete"},outputs:{mode:"mode",notify:"notify",completeRepair:"completeRepair"},features:[e.TTD],decls:13,vars:8,consts:[[1,"add-photo-container"],[3,"chqModel",4,"ngIf"],["class","photo-container",4,"ngIf"],["class","wrapper",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper","wrapper-flex"],[1,"image-wrapper"],[3,"src"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"],["class","margin-right",3,"buttonModel",4,"ngIf"],[3,"chqModel"],[1,"photo-container"],[1,"card-container"],["class","card",4,"ngIf"],[1,"card"],[1,"card-title"],[1,"card-action"],[1,"card-description"],[3,"buttonModel"],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"margin-right",3,"buttonModel"]],template:function(f,d){1&f&&(e.TgZ(0,"div",0),e.YNc(1,h,1,1,"chq-step-header",1),e.YNc(2,H,4,2,"div",2),e.YNc(3,W,6,3,"div",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6),e._UZ(7,"img",7),e.qZA(),e.TgZ(8,"div",8),e.YNc(9,j,1,1,"chq-button",9),e.YNc(10,E,1,1,"chq-button",10),e.YNc(11,V,1,1,"chq-button",9),e.YNc(12,z,1,1,"chq-button",10),e.qZA()()()()),2&f&&(e.xp6(1),e.Q6J("ngIf",!0!==d.photosHeader.isRepairModule||!0===d.photosHeader.isHeaderOnly),e.xp6(1),e.Q6J("ngIf",(d.showSPI||!d.hideBulk)&&!d.repairUnapproved&&!d.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",!d.showSPI&&d.hideBulk||d.repairUnapproved||d.commonService.isViewOnly),e.xp6(4),e.MGl("src","assets/img/",+d.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",e.LSH),e.xp6(2),e.Q6J("ngIf",d.showDelete&&(null==d.photosHeader?null:d.photosHeader.isRepairModule)),e.xp6(1),e.Q6J("ngIf",d.showEstimate&&!d.photosHeader.isRepairModule),e.xp6(1),e.Q6J("ngIf",d.showNotify),e.xp6(1),e.Q6J("ngIf",d.showComplete))},dependencies:[Q.O5,B._,K.E,P.X$],styles:[".photo-container[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:calc(100vh - 170px - 1.5vw - (53px + 3.1vw));justify-content:space-evenly;border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-card-dark);margin-top:calc(18px + 1.5vh);margin-bottom:calc(12px + 1.5vh)}.card-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:27px}.wrapper-flex[_ngcontent-%COMP%]{flex:1;justify-content:space-between;align-items:center}.margin-right[_ngcontent-%COMP%]{margin-right:20px}.card[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray);padding:16px;width:202px;background-color:var(--xa-white);border-radius:8px}.card-title[_ngcontent-%COMP%]{font-weight:600;font-size:16px;line-height:20px}.card-action[_ngcontent-%COMP%]{font-weight:600;font-size:12px;line-height:21px;margin:0;color:var(--xa-black-medium)}.card-description[_ngcontent-%COMP%]{font-size:12px;line-height:18px;margin-bottom:30px;color:var(--xa-dark-gray)}.image-car[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:654px}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:50px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),I})()},64307:(te,F,r)=>{r.d(F,{O:()=>I});var e=r(15861),a=r(56969),R=r(61135),N=r(4128),G=r(70262),v=r(39646),w=r(83853),u=r(94650),k=r(81364),Q=r(81390),B=r(38709),K=r(12484),P=r(8985),h=r(74178),A=r(36895),D=r(39912),H=r(54135);const W=["imageUploaders"];function j(q,f){if(1&q){const d=u.EpF();u.TgZ(0,"chq-images-uploader",4,5),u.NdJ("cardSelection",function(S){u.CHM(d);const U=u.oxw(2);return u.KtG(U.setObservable(S))})("stepSkipped",function(){u.CHM(d);const S=u.oxw(2);return u.KtG(S.stepSkipped())}),u.qZA()}if(2&q){const d=u.oxw(2);u.Q6J("fileUploaderService",d.currentObservable)("footerOptions",d.footer)("imageStatusSteps",d.imageStatusSteps)("header",d.documentHeader)}}function E(q,f){1&q&&(u.TgZ(0,"div",6)(1,"div",7),u._UZ(2,"img",8),u.TgZ(3,"label",9),u._uU(4," No Content Available "),u.qZA()(),u.TgZ(5,"div",10),u._UZ(6,"div",11)(7,"div",11)(8,"div",11)(9,"div",11),u.qZA()())}function V(q,f){if(1&q&&(u.TgZ(0,"div",12)(1,"div",13)(2,"div",14),u._UZ(3,"img",15),u.qZA()()()),2&q){const d=u.oxw(2);u.xp6(3),u.MGl("src","assets/img/",+d.documentHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",u.LSH)}}function z(q,f){if(1&q&&(u.TgZ(0,"div"),u.YNc(1,j,2,4,"chq-images-uploader",1),u.YNc(2,E,10,0,"div",2),u.YNc(3,V,4,1,"div",3),u.qZA()),2&q){const d=u.oxw();u.xp6(1),u.Q6J("ngIf",d.imageStatusSteps&&d.imageStatusSteps.length>0),u.xp6(1),u.Q6J("ngIf",d.noDocumentData),u.xp6(1),u.Q6J("ngIf",d.noDocumentData)}}function X(q,f){1&q&&u._UZ(0,"no-access-error")}const $={title:"add_documents",step:3,description:"add_documents_msg",stepName:"step_three"};let I=(()=>{class q{constructor(d,_,S,U,y,x,Z){this.cd=d,this.commonService=_,this.route=S,this.caseService=U,this.monitorService=y,this.bookingService=x,this.mediaCollectionService=Z,this.documentHeader=$,this.imageStatusSteps=[],this.allowExtension=["jpg","jpeg","png"],this.skipButtonModel={label:"Skip",type:"primary"},this.footer={text:"Next add photos",icon:"review",route:"quote/case/photos",currentStatus:"",status:"UploadDocuments",caseId:""},this.documentSizeLimit=5242880,this.noDocumentData=!1,this.repairId="",this.currentRepairStatus="",this.showNoAccess=!1,this.statusUpdated=!1,_.pageName.closed&&(_.pageName=new R.X(null)),_.pageName.next("document"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new R.X(!0))}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","document"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["ChqNewDocumentsComponent","addenda-quote"])}checkRouteParams(){this.route.queryParams?.subscribe(d=>{const _=d.fromPersonal;("true"===_||!0===_)&&(this.imageStatusSteps=this.imageStatusSteps.filter(S=>-1!=S.stepName.indexOf("Vehicle Registration")))})}setObservable(d){this.currentObservable=d.uploadedGuid&&d.uploadedPartGuid?this.updateFile.bind(this):this.uploadFile.bind(this)}getMediaTemplateByObject(){this.mediaPartTemplates=this.commonService.getAllChild(this.mediaTemplate?.mediaTemplates,"mediaPartTemplates","mediaTemplateGuid",{parentProp:"name",childProp:"parentName"});for(let d=0;d<this.mediaPartTemplates.length;d++){const _=this.mediaPartTemplates[d],S=(0,w.sH)(_,d),y=-1!=S.stepName.toLowerCase().indexOf("additional document")&&!S.url;this.imageStatusSteps.push({...S,mandatory:_.mandatory,index:d,isAdditionalDocumentFromReviewPageOnly:y,parentName:_.parentName,isFront:_.frontSide,updatedDate:"00000000-0000-0000-0000-000000000000"!=_.mediaPartGuid?_.updatedDate:"",uploadedDate:"00000000-0000-0000-0000-000000000000"!=_.mediaPartGuid?_.createdDate:"",domainId:this.domainId,objectId:this.objectId,sizeLimit:_.sizeLimit,allowExtension:_.allowExtension,uploadedPartGuid:"00000000-0000-0000-0000-000000000000"!=_.mediaPartGuid?_.mediaPartGuid:"",uploadedGuid:"00000000-0000-0000-0000-000000000000"!=_.mediaGuid?_.mediaGuid:"",partTemplateGuid:_.mediaPartTemplateGuid,templateGuid:_.mediaTemplateGuid}),this.checkRouteParams()}}updateRepairStatus(d){var _=this;this.statusUpdated||(this.statusUpdated=!0,this.bookingService.updateRepairStatus("UploadDocuments",d,"").subscribe({next:()=>{var S;this.currentRepairStatus="UploadDocuments",this.footer.currentStatus=this.currentRepairStatus,this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairId).subscribe({next:(S=(0,e.Z)(function*(U){U?.data&&(_.commonService.repairDetails.next(U.data),_.commonService.bookingId.next(U.data.repairNumber),_.commonService.hideLoading())}),function(y){return S.apply(this,arguments)}),error:S=>{this.monitorService.logException(S,a._.Error),this.commonService.hideLoading()}})}}))}uploadFile(d){const _={mediaCollectionId:this.mediaTemplate.collectionGuid,domainId:this.domainId,objectId:this.objectId,mediaTemplateId:d.templateGuid,mediaPartTemplateId:d.partTemplateGuid};this.monitorService.logEvent("uploadFile",["ChqNewDocumentsComponent","addenda-quote",{obj:_}]),d.uploadInProgress=!0,d.isSkipped=!1,d.isUploadFailed=!1,d.isUploadSuccess=!1,this.commonService.showNotification("Your photo is currently uploading won\u2019t be long and we\u2019ll \n    notify you when its uploaded, you can continue to take your photos."),this.mediaCollectionService.uploadDocument(d.imageFile,_).subscribe({next:U=>{const y=U?.data,x=this.mediaPartTemplates?.find(Z=>Z.mediaPartTemplateGuid==y?.mediaPartTemplateId);x&&(x.mediaGuid=y.mediaGuid,x.mediaPartGuid=y.mediaPartGuid,location.href.includes("repair")&&"draft"===this.currentRepairStatus?.toLowerCase()&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"vehicledetails"===this.footer.currentStatus?.toLowerCase()&&this.updateStatus(),this.imageUploaders.updateUploadStatus("success",d,null,y))},error:U=>{if(401!=U.status)try{this.imageUploaders.updateUploadStatus("failed",d,U)}catch{this.imageUploaders.updateUploadStatus("failed",d)}this.monitorService.logException(U,a._.Error)},complete:()=>this.commonService.hideLoading()})}updateFile(d){const _={objectId:this.objectId,mediaGuid:d.uploadedGuid,mediaPartGuid:d.uploadedPartGuid};this.monitorService.logEvent("updateFile",["ChqNewDocumentsComponent","addenda-quote",{obj:_}]),d.uploadInProgress=!0,d.isSkipped=!1,d.isUploadFailed=!1,d.isUploadSuccess=!1,this.mediaCollectionService.updateDocument(d.imageFile,_).subscribe({next:S=>{this.imageUploaders.updateUploadStatus("success",d)},error:S=>{if(401!=S.status)try{this.imageUploaders.updateUploadStatus("failed",d,S)}catch{this.imageUploaders.updateUploadStatus("failed",d)}this.monitorService.logException(S,a._.Error)},complete:()=>this.commonService.hideLoading()})}updateStatus(){this.statusUpdated||(this.statusUpdated=!0,this.monitorService.logEvent("updateStatus",["ChqNewDocumentsComponent","addenda-quote",{caseId:this.footer.caseId}]),this.caseService.updateCaseStatus(this.footer.caseId,"UploadDocuments").subscribe({next:()=>{this.footer={...this.footer,status:""}}}))}mapMediaTemplate(d){if(this.mediaTemplate)try{for(let _=0;_<this.mediaTemplate.mediaTemplates.length;_++){const S=this.mediaTemplate.mediaTemplates[_],U=d.find(y=>y.mediaTemplateGuid==S.mediaTemplateGuid);if(U)for(let y=0;y<S.mediaPartTemplates.length;y++){const x=S.mediaPartTemplates[y],Z=U.mediaParts.find(Y=>Y.mediaPartTemplateGuid==x.mediaPartTemplateGuid);x.mediaGuid=U.mediaGuid,x.mediaPartGuid=Z.mediaPartGuid,x.createdDate=Z.createdDate,x.updatedDate=Z.updatedDate,x.image=Z.getURL,x.isUploadSuccess=!1,x.mediaPartGuid&&"00000000-0000-0000-0000-000000000000"!=x.mediaPartGuid&&(x.isUploadSuccess=!0)}}this.mediaTemplate={...this.mediaTemplate}}catch(_){console.log(_)}}ngOnInit(){this.commonService.showLoading();const d=this.route.parent?.snapshot.paramMap.get("id");this.monitorService.logEvent("ngOnInit",["ChqNewDocumentsComponent","addenda-quote",{caseId:d}]),this.footer={...this.footer,route:`quote/case/${d}/photos`,caseId:d},this.commonService.accessRight.subscribe({next:x=>{x||(this.showNoAccess=!0)}});const _={mediaTemplate:this.mediaCollectionService.getMediaTemplate()};let S=!1;location.href.includes("repair")?(_.bookingDetail=this.bookingService.getRepairDetailByGuid(d),S=!0):(this.commonService.userProfileData.subscribe(x=>{if(x&&x.data){const{organizationDetail:Z}=x.data;this.currentOrgId=Z.id}}),_.caseDetail=this.caseService.getCaseDetail(d)),(0,N.D)(_).pipe((0,G.K)(x=>(0,v.of)(x))).subscribe(x=>{if(x){const Z=x.mediaTemplate;if(Z){const Y=Z.data;if(x.caseDetail){const{caseNumber:b,id:L,status:s,inspections:g,repairGuid:o,organizationDetail:m}=x.caseDetail.data;this.commonService.isViewOnly=this.currentOrgId!=m?.organizationId,g.length>0&&this.commonService.inspectionId.next(g[0].inspectionId),this.commonService.caseStatus.next(s),"vehicledetails"===s.toLowerCase()||(this.footer={...this.footer,status:""}),this.footer.currentStatus=s,this.documentHeader.caseNumber=b,this.objectId=L,o&&(this.footer.repairId=o,this.footer.from="Quote")}if(x.bookingDetail){const{id:b,status:L,repairGuid:s,quoteId:g,repairNumber:o,isRepairCreatedFromCase:m,booking:n}=x.bookingDetail.data;this.objectId=b,this.repairId=s,g&&(this.footer.caseId=g,this.footer.from="Repair"),this.footer.isRepairCreatedFromCase=m,this.footer.repairId=s,this.footer.bookingId=n?.bookingGuid,this.footer.currentStatus=L,this.commonService.repairStatus.next(L),this.currentRepairStatus=L,this.commonService.repairDetails.next(x.bookingDetail.data),this.commonService.bookingId.next(o)}if(Y.length>0){const{id:b,collectionGuid:L}=Y[0];this.mediaTemplateId=b,this.domainId=2100,S&&(this.domainId=3100),this.collectionGuid=L,(0,N.D)({mediaTemplateDetail:this.mediaCollectionService.getMediaTemplateById(L),mediaDetail:this.mediaCollectionService.getMediaDocumentData(b,this.objectId,this.domainId)}).pipe((0,G.K)(g=>(0,v.of)(g))).subscribe(g=>{if(g){const{mediaTemplateDetail:o,mediaDetail:m}=g;this.mediaTemplate=o.data,this.mediaTemplate.mediaTemplates=o.data.mediaTemplates.sort((n,t)=>n.orderNumber-t.orderNumber),m.data&&this.mapMediaTemplate(m.data.medias),this.getMediaTemplateByObject()}this.commonService.hideLoading()},g=>{this.commonService.hideLoading(),this.monitorService.logException(g,a._.Error)})}else this.commonService.hideLoading()}else this.noDocumentData=!0,this.commonService.hideLoading()}else this.noDocumentData=!0,this.commonService.hideLoading()});const y=document.querySelector(".addenda-container");y&&(y.scrollTop=0)}stepSkipped(){location.href.includes("repair")&&"draft"===this.currentRepairStatus?.toLowerCase()&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"vehicledetails"===this.footer.currentStatus?.toLowerCase()&&this.updateStatus()}ngOnDestroy(){this.monitorService.logEvent("ngOnDestroy",["ChqNewDocumentComponent","addenda-quote"]),this.commonService.accessRight.unsubscribe(),location.href.includes("quote")&&(this.commonService.isViewOnly=!1)}}return q.\u0275fac=function(d){return new(d||q)(u.Y36(u.sBO),u.Y36(k.v),u.Y36(Q.gz),u.Y36(B.n),u.Y36(K.M),u.Y36(P.q),u.Y36(h.m))},q.\u0275cmp=u.Xpm({type:q,selectors:[["new-documents"]],viewQuery:function(d,_){if(1&d&&u.Gf(W,5),2&d){let S;u.iGM(S=u.CRH())&&(_.imageUploaders=S.first)}},inputs:{documentHeader:"documentHeader"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"fileUploaderService","footerOptions","imageStatusSteps","header","cardSelection","stepSkipped",4,"ngIf"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"fileUploaderService","footerOptions","imageStatusSteps","header","cardSelection","stepSkipped"],["imageUploaders",""],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"]],template:function(d,_){1&d&&(u.YNc(0,z,4,3,"div",0),u.YNc(1,X,1,0,"no-access-error",0)),2&d&&(u.Q6J("ngIf",!_.showNoAccess),u.xp6(1),u.Q6J("ngIf",_.showNoAccess))},dependencies:[A.O5,D.q,H.U],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),q})()},4704:(te,F,r)=>{r.d(F,{X:()=>Y});var e=r(15861),a=r(94650),R=r(56969),N=r(61135),G=r(4128),v=r(70262),w=r(39646),u=r(75983),k=r(83853),Q=r(81364),B=r(81390),K=r(38709),P=r(12484),h=r(13975),A=r(8985),D=r(87855),H=r(36895),W=r(39912),j=r(54135),E=r(22406),V=r(62119),z=r(9988),X=r(89383);const $=["imageUploaders"];function I(b,L){if(1&b){const s=a.EpF();a.TgZ(0,"add-photos",9),a.NdJ("mode",function(o){a.CHM(s);const m=a.oxw(3);return a.KtG(m.handleMode(o))}),a.qZA()}if(2&b){const s=a.oxw(3);a.Q6J("caseData",s.caseData)("caseNumber",s.photosHeader.caseNumber)("showSPI",s.checkRepairTypes)("photosHeader",s.addPhotosHeader)("hidden",s.hideContent)("showEstimate",s.showEstimateButton)("repairData",s.repairDetail)}}function q(b,L){if(1&b&&(a.ynx(0),a.YNc(1,I,1,7,"add-photos",8),a.BQk()),2&b){const s=a.oxw(2);a.xp6(1),a.Q6J("ngIf",!1===s.showUploading)}}function f(b,L){1&b&&(a.TgZ(0,"div",10)(1,"div",11),a._UZ(2,"img",12),a.TgZ(3,"label",13),a._uU(4),a.ALo(5,"translate"),a.qZA()(),a.TgZ(6,"div",14),a._UZ(7,"div",15)(8,"div",15)(9,"div",15)(10,"div",15),a.qZA()()),2&b&&(a.xp6(4),a.hij(" ",a.lcZ(5,1,"no_photos_configured")," "))}function d(b,L){if(1&b&&(a.TgZ(0,"div",16)(1,"div",17)(2,"div",18),a._UZ(3,"img",19),a.qZA()()()),2&b){const s=a.oxw(2);a.xp6(3),a.MGl("src","assets/img/",+s.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",a.LSH)}}function _(b,L){if(1&b){const s=a.EpF();a.TgZ(0,"chq-images-uploader",20,21),a.NdJ("handleDeleteAllEvent",function(){a.CHM(s);const o=a.oxw(2);return a.KtG(o.handleDeleteAll())})("backToUpload",function(){a.CHM(s);const o=a.oxw(2);return a.KtG(o.setInitialMode())})("updateMassUpload",function(o){a.CHM(s);const m=a.oxw(2);return a.KtG(m.updateCurrentStatus(o))})("stepSkipped",function(){a.CHM(s);const o=a.oxw(2);return a.KtG(o.stepSkipped())}),a.qZA()}if(2&b){const s=a.oxw(2);a.Q6J("hidden",s.showDamageAnalysis||!s.showUploading)("currentAdditionalModeMultiple",s.currentAdditionalModeMultiple)("fileUploaderService",s.currentObservable)("footerOptions",s.footer)("isMassUpload",s.isMultipleUpload)("showReTakeDelete",!0)("imageStatusSteps",s.imageStatusSteps)("header",s.photosHeader)("inspectionId",s.inspectionId)("inspection","photos")}}function S(b,L){if(1&b){const s=a.EpF();a.TgZ(0,"damage-analysis",22),a.NdJ("backEvent",function(o){a.CHM(s);const m=a.oxw(2);return a.KtG(m.handleBack(o))}),a.qZA()}if(2&b){const s=a.oxw(2);a.Q6J("isBulkUpload",s.isMultipleUpload)("minPhotoRequired",s.minimumPhotosRequired)("caseDetail",s.partialCaseDetail||s.repairDetail)("steps",s.imageStatusSteps)("isRepairModule",s.photosHeader.isRepairModule)}}const U=function(b){return{"photo-container":b}};function y(b,L){if(1&b&&(a.TgZ(0,"div",2),a.YNc(1,q,2,1,"ng-container",3),a.YNc(2,f,11,3,"div",4),a.YNc(3,d,4,1,"div",5),a.YNc(4,_,2,10,"chq-images-uploader",6),a.YNc(5,S,1,5,"damage-analysis",7),a.qZA()),2&b){const s=a.oxw();a.Q6J("ngClass",a.VKq(6,U,s.photosHeader.isRepairModule)),a.xp6(1),a.Q6J("chqPermission","newBooking"),a.xp6(1),a.Q6J("ngIf",s.noImagesData),a.xp6(1),a.Q6J("ngIf",s.noImagesData),a.xp6(1),a.Q6J("ngIf",!0===s.showUploading||s.isMultipleUpload||s.imageStatusSteps&&s.imageStatusSteps.length>0),a.xp6(1),a.Q6J("ngIf",s.showDamageAnalysis)}}function x(b,L){1&b&&a._UZ(0,"no-access-error")}const Z={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let Y=(()=>{class b{constructor(s,g,o,m,n,t,M,O,oe){this.cd=s,this.commonService=g,this.route=o,this.router=m,this.caseService=n,this.monitorService=t,this.inspectionService=M,this.bookingService=O,this.estimateService=oe,this.photosHeader=Z,this.currentUploadMode=new a.vpe,this.imageStatusSteps=[],this.showUploading=!1,this.isMultipleUpload=!1,this.triggerMassUpload=!1,this.caseStatus="",this.caseId="0",this.bookingId="",this.minimumPhotosRequired=0,this.hideContent=!0,this.currentAdditionalModeMultiple=!1,this.hideUploaders=!1,this.repairTypes=[],this.repairType="",this.noImagesData=!1,this.repairId="",this.inspectionTemplatesJSONString="",this.currentRepairStatus="",this.originalSteps=[],this.showNoAccess=!1,this.footer={text:"Next create estimate",icon:"boardview",route:"case/gt",status:"UploadPhotos",caseId:"",currentStatus:"",showButton:!0,showUploadOption:!0},this.statusUpdated=!1,g.pageName.closed&&(g.pageName=new N.X(null)),g.pageName.next("photos"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new N.X(!0))}handleBack(s){this.showDamageAnalysis=!s.back}get checkRepairTypes(){return-1===location.href.indexOf("repair")||"repair"!==this.repairType||this.repairTypes.filter(s=>"Body"===s.repairServiceType||"Paint"===s.repairServiceType).length>0}redirectToGtEstimate(){this.commonService.showLoading(),"uploaddocuments"===this.caseStatus?.toLowerCase()||"uploadphotos"===this.caseStatus?.toLowerCase()?this.estimateService.createEstimate(this.caseId,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:s=>{s&&s?.data?.url&&(location.href=s.data.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}}):this.router.navigate([`/quote/case/${this.caseId}/estimate`])}updateCurrentStatus(s){this.monitorService.logEvent("updateCurrentStatus",["ChqNewPhotosComponent","addenda-quote",{caseId:s}]),s.initial?this.setInitialMode():(this.showUploading=!0,this.uploadBulkUploadFile(s.steps))}handleDeleteAll(){this.setInitialMode()}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","photos"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["ChqNewPhotosComponent","addenda-quote"])}uploadBulkUploadFile(s){for(let g=0;g<s?.length;g++){const o=new Image;o.src=s[g].image,o.onload=()=>{const m={height:o.height,width:o.width,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,type:this.vehicelType||"",isBulk:!0},n=s[g];n.uploadInProgress=!0,n.isSkipped=!1,n.isUploadFailed=!1,n.isUploadSuccess=!1,this.monitorService.logEvent("uploadBulkUploadFile",["ChqNewPhotosComponent","addenda-quote",{uploadObject:m}]),this.inspectionService.uploadImageBulk(m,n.imageFile).subscribe({next:t=>{n.url=t.rawImage?.rawAzureBlobUrl,n.inspectionItem=t,n.procedureSteps="Bulk Upload Image",this.imageUploaders.updateUploadStatus("success",n,null,t),this.footer={...this.footer,showUploadOption:!1},location.href.includes("repair")&&("draft"===this.currentRepairStatus?.toLowerCase()||"uploaddocuments"===this.currentRepairStatus?.toLowerCase())&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===this.footer.currentStatus?.toLowerCase()&&this.updateStatus()},error:t=>{401!=t.status&&(this.imageUploaders.imageStatusSteps=this.imageUploaders.imageStatusSteps.filter(M=>M.index!==n.index||M.stepName!==n.stepName||!0!==M.uploadInProgress),this.imageUploaders.updateUploadStatus("failed",n,t,null,!0)),this.monitorService.logException(t,R._.Error)}})}}}updateRepairStatus(s){var g=this;this.statusUpdated||(this.statusUpdated=!0,this.bookingService.updateRepairStatus("UploadPhotos",s,"").subscribe({next:()=>{var o;this.currentRepairStatus="UploadPhotos",this.footer.currentStatus=this.currentRepairStatus,this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairId).subscribe({next:(o=(0,e.Z)(function*(m){m?.data&&(g.commonService.repairDetails.next(m.data),g.commonService.bookingId.next(m.data.repairNumber),g.commonService.hideLoading())}),function(n){return o.apply(this,arguments)}),error:o=>{this.monitorService.logException(o,R._.Error),this.commonService.hideLoading()}})}}))}uploadFile(s){const g={height:s.imageHeight,width:s.imageWidth,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,inspectionitemId:s.inspectionItem.id,type:this.vehicelType||"",isBulk:!1};this.monitorService.logEvent("uploadFile",["ChqNewPhotosComponent","addenda-quote",{uploadObject:g}]),s.uploadInProgress=!0,s.isSkipped=!1,s.isUploadFailed=!1,s.isUploadSuccess=!1,this.commonService.inProgressSteps.next(1),this.footer={...this.footer,showUploadOption:!1},this.commonService.showNotification(`Your photo \u2018${s.stepName}\u2019 is currently uploading won\u2019t be long and we\u2019ll notify \n       you when its uploaded, you can continue to take your photos.`),this.inspectionService.uploadImageBulk(g,s.imageFile).subscribe({next:o=>{this.commonService.showNotification(`Your photo \u2018${s.stepName}\u2019 is uploaded successfully.`);const n=this.inspectionItemTemplates?.find(t=>t.inspectionItem.id==o?.id);n.inspectionItem.rawAzureBlobUrl=o.rawImage?.rawAzureBlobUrl,n&&(s.url=o.rawImage?.rawAzureBlobUrl,this.imageUploaders.updateUploadStatus("success",s,null,o)),location.href.includes("repair")&&("Draft"==this.currentRepairStatus||"UploadDocuments"===this.currentRepairStatus)&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===this.footer.currentStatus?.toLowerCase()&&this.updateStatus()},error:o=>{401!=o.status&&(this.commonService.showNotification(`Your photo \u2018${s.stepName}\u2019 failed to upload. Please try to upload again.`),this.imageUploaders.updateUploadStatus("failed",s,o),this.monitorService.logException(o,R._.Error))}})}ngOnDestroy(){this.commonService.pageName.unsubscribe(),this.commonService.accessRight.unsubscribe(),location.href.includes("quote")&&(this.commonService.isViewOnly=!1),this.monitorService.logEvent("ngOnDestroy",["ChqNewPhotosComponent","addenda-quote"])}get showEstimateButton(){return 0===this.currentInspectionTemplate?.minImageLimit&&0===this.inspectionItemTemplates?.filter(s=>!0!==s.isSkipEnabled).length}mapInspection(s){if(s)try{this.inspection=s,this.uploadType=this.inspection.uploadType;let g="SPI";this.uploadType&&(this.footer={...this.footer,showUploadOption:!1}),"Bulk"===this.uploadType&&(g="BULK");const o=this.inspectionTemplates?.filter(n=>"Bulk Upload Image"===n.name),m=this.inspection.inspectionItems?.filter(n=>("Bulk Upload Image"===n.name||n.inspectionItemTemplateID===o[0].id)&&n.rawAzureBlobUrl);if(m?.length>0||"Bulk"===this.uploadType){const n=[];this.currentUploadMode.emit({mode:"multiple"});for(const t in m){const M={...o[0],name:m[t].name||o[0].name,inspectionItem:m[t]};n.push(M)}this.inspectionItemTemplates=n}else this.currentUploadMode.emit({mode:"single"}),this.inspectionTemplates?.map(n=>{const t=this.inspection.inspectionItems?.find(M=>M.inspectionItemTemplateID==n.id);t&&(n.inspectionItem=t)}),this.inspectionItemTemplates=this.inspectionTemplates?.filter(n=>"Bulk Upload Image"!=n.name);o?.length>0&&(this.inspectionTemplateId=o[0].id),this.inspectionItemTemplates?.map(n=>{n.inspectionItem?.rawAzureBlobUrl?(n.isUploadSuccess=!0,n.image=n.inspectionItem?.rawAzureBlobUrl):(n.inspectionItem||(n.inspectionItem={rawAzureBlobUrl:""}),n.inspectionItem.rawAzureBlobUrl="",n.isUploadFailed=!1,n.isUploadSuccess=!1,n.uploadInProgress=!1)}),this.uploadType&&("SPI"===g?(this.isMultipleUpload=!1,this.showUploading=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader={...this.photosHeader,title:"back_smart_photo"}),this.minimumPhotosRequired=this.inspectionItemTemplates?.filter(n=>!0!==n.isSkipEnabled).length,this.currentObservable=this.uploadFile.bind(this)):(this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.minimumPhotosRequired=this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!0,this.isBulkUploaded=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader={...this.photosHeader,title:"bulk_upload"})))}catch(g){console.log(g)}}getInspectionTemplateByObject(){for(let s=0;s<this.inspectionItemTemplates?.length;s++){const g=this.inspectionItemTemplates[s],o=(0,k.A1)(g,s),m=-1!=o.stepName?.toLowerCase().indexOf("additional photo"),n=-1!=o.stepName?.toLowerCase().indexOf("bulk upload image"),t=m&&!o.url;this.imageStatusSteps.push({...o,mandatory:!g.isSkipEnabled,index:s,isAdditionalDocumentFromReviewPageOnly:t,isMassUpload:n,updatedDate:o.url?g?.inspectionItem?.updatedDate:"",uploadedDate:o.url?g?.inspectionItem?.created:"",domainId:this.domainId,objectId:this.objectId,uploadedPartGuid:"",uploadedGuid:""})}}updateStatus(){this.statusUpdated||(this.statusUpdated=!0,this.monitorService.logEvent("updateStatus",["ChqNewPhotosComponent","addenda-quote"]),this.caseService.updateCaseStatus(this.caseId,"UploadPhotos").subscribe({next:()=>{this.footer={...this.footer,status:""},this.partialCaseDetail.status="UploadPhotos"}}))}stepSkipped(){location.href.includes("repair")&&("draft"===this.currentRepairStatus?.toLowerCase()||"uploaddocuments"===this.currentRepairStatus?.toLowerCase())&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===this.footer.currentStatus?.toLowerCase()&&this.updateStatus()}loadApiData(s){s&&"0"!=s&&(this.caseId=s,this.bookingId=s,this.commonService.showLoading(),this.inspectionService.getInspectionTemplateList().subscribe({next:g=>{let o=!1,m=0;location.href.includes("repair")&&(o=!0);const n=g?.data;n?.length>0&&(this.commonService.repairInspectionTemplate=n[0],m=n[0].id);const t={};t.inspectionTemplate=this.inspectionService.getInspectionTemplate(m),o?t.bookingDetail=this.bookingService.getRepairDetailByGuid(s):(this.commonService.userProfileData.subscribe(O=>{if(O&&O.data){const{organizationDetail:oe}=O.data;this.currentOrgId=oe.id}}),t.caseDetail=this.caseService.getCaseDetail(s)),(0,G.D)(t).pipe((0,v.K)(O=>(0,w.of)(O))).subscribe({next:O=>{if(O.inspectionTemplate){const oe=O.inspectionTemplate.inspectionItemTemplates;if(this.currentInspectionTemplate=O.inspectionTemplate,O.inspectionDetail&&(this.inspectionDetail=O.inspectionDetail),this.inspectionTemplates=oe,this.inspectionTemplatesJSONString=JSON.stringify(this.inspectionTemplates),O.caseDetail){const{caseNumber:ie,id:ae,status:ee,domainID:se,inspections:ne,vehicleModel:re,vehicleId:c,organizationDetail:T}=O.caseDetail.data;this.caseData=O.caseDetail.data,this.partialCaseDetail=O.caseDetail.data,this.commonService.isViewOnly=this.currentOrgId!=T?.organizationId,this.vehicelType=re,this.vehicleId=c,this.domainId=se,this.commonService.caseStatus.next(ee),this.caseStatus=ee,"uploaddocuments"===ee?.toLowerCase()||(this.footer={...this.footer,status:"",caseId:ae}),this.footer.currentStatus=ee,ne?.length>0&&(this.inspectionId=ne[0].inspectionId,this.commonService.inspectionId.next(this.inspectionId)),this.photosHeader.caseNumber=ie,this.caseData.repairGuid&&(this.footer.repairId=this.caseData.repairGuid,this.footer.from=u.j.quote),this.objectId=ae}if(O.bookingDetail){const{id:ie,vehicle:ae,repairServiceTypes:ee,repairGuid:de,domainId:se,status:ne,quoteId:re,repairType:c,repairNumber:T,booking:i,isRepairCreatedFromCase:l}=O.bookingDetail.data;this.repairDetail=O.bookingDetail.data;const{vehicleModel:p,vehicleId:C}=ae;this.objectId=ie,this.domainId=se,this.repairId=de,this.currentRepairStatus=ne,this.repairTypes=ee,this.repairType=c,this.inspectionId=ae.inspectionId,this.vehicelType=p,this.vehicleId=C,this.footer={...this.footer,currentStatus:ne,isRepairModule:!0,caseId:re,from:u.j.repair,repairTypes:ee,isRepairCreatedFromCase:l,bookingId:i?.bookingGuid},this.commonService.repairDetails.next(O.bookingDetail.data),this.commonService.bookingId.next(T),this.commonService.repairStatus.next(ne)}this.inspectionId?this.inspectionService.getInspection(this.inspectionId).subscribe({next:ie=>{ie&&(this.mapInspection(ie),this.noImagesData=!1,this.getInspectionTemplateByObject(),setTimeout(()=>{this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.uploadType&&this.imageUploaders.goToReview()}))},error:()=>{this.noImagesData=!0},complete:()=>{this.commonService.hideLoading()}}):(this.noImagesData=!0,this.hideContent=!1,this.commonService.hideLoading())}else this.noImagesData=!0,this.commonService.hideLoading()}})},error:()=>{this.noImagesData=!0,this.commonService.hideLoading()}}))}ngOnInit(){const s=this.route.parent?.snapshot.paramMap.get("id");this.addPhotosHeader={...this.photosHeader,isHeaderOnly:!1},this.monitorService.logEvent("ngOnInit",["ChqNewPhotosComponent","addenda-quote",{caseId:s,repairId:s}]),this.footer={...this.footer,caseId:this.photosHeader.isRepairModule?"":s,repairId:this.photosHeader.isRepairModule?s:"",handleBack:this.handleBack.bind(this),finalRedirection:this.redirectToGtEstimate.bind(this)},this.commonService.accessRight.subscribe({next:o=>{o||(this.showNoAccess=!0)}}),this.loadApiData(s);const g=document.querySelector(".addenda-container");g&&(g.scrollTop=0),this.currentObservable=this.uploadFile.bind(this)}reloadInspection(){this.commonService.showLoading(),this.inspectionTemplates=JSON.parse(this.inspectionTemplatesJSONString),this.inspectionId&&this.inspectionService.getInspection(this.inspectionId).subscribe({next:s=>{s&&(this.mapInspection(s),this.getInspectionTemplateByObject(),this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,setTimeout(()=>{this.hideContent=!1,this.showUploading=!0}))},complete:()=>{this.commonService.hideLoading()}})}setInitialMode(){this.showUploading=!1,this.imageStatusSteps=[],this.triggerMassUpload=!1,this.isBulkUploaded=!1,this.imageUploaders.isReviewSection=!1,this.isMultipleUpload=!1,this.currentAdditionalModeMultiple=!1}handleMode(s){this.monitorService.logEvent("handleMode",["ChqNewPhotosComponent","addenda-quote",{$event:s}]),this.inspectionId?(this.currentUploadMode.emit(s),"single"===s.mode?(0===this.imageStatusSteps?.length?(this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,this.minimumPhotosRequired=this.inspectionItemTemplates.filter(g=>!0!==g.isSkipEnabled).length,this.reloadInspection()):(this.isMultipleUpload=!1,this.showUploading=!0,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.minimumPhotosRequired=this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!1),this.currentObservable=this.uploadFile.bind(this)):(this.imageStatusSteps=[],this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.triggerMassUpload=!0,this.showUploading=!0)):this.currentUploadMode.emit({mode:"error",id:this.bookingId})}}return b.\u0275fac=function(s){return new(s||b)(a.Y36(a.sBO),a.Y36(Q.v),a.Y36(B.gz),a.Y36(B.F0),a.Y36(K.n),a.Y36(P.M),a.Y36(h.a),a.Y36(A.q),a.Y36(D.H))},b.\u0275cmp=a.Xpm({type:b,selectors:[["new-photos"]],viewQuery:function(s,g){if(1&s&&a.Gf($,5),2&s){let o;a.iGM(o=a.CRH())&&(g.imageUploaders=o.first)}},inputs:{photosHeader:"photosHeader"},outputs:{currentUploadMode:"currentUploadMode"},decls:2,vars:2,consts:[[3,"ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass"],[4,"chqPermission"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload","stepSkipped",4,"ngIf"],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairModule","backEvent",4,"ngIf"],[3,"caseData","caseNumber","showSPI","photosHeader","hidden","showEstimate","repairData","mode",4,"ngIf"],[3,"caseData","caseNumber","showSPI","photosHeader","hidden","showEstimate","repairData","mode"],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[3,"hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload","stepSkipped"],["imageUploaders",""],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairModule","backEvent"]],template:function(s,g){1&s&&(a.YNc(0,y,6,8,"div",0),a.YNc(1,x,1,0,"no-access-error",1)),2&s&&(a.Q6J("ngIf",!g.showNoAccess),a.xp6(1),a.Q6J("ngIf",g.showNoAccess))},dependencies:[H.mk,H.O5,W.q,j.U,E.A,V.b,z.wm,X.X$],styles:[".photo-container[_ngcontent-%COMP%]{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),b})()},72076:(te,F,r)=>{r.d(F,{r:()=>g});var e=r(94650),a=r(12484),R=r(36895),N=r(97392),G=r(36978),v=r(89383),w=r(93077);function u(o,m){if(1&o){const n=e.EpF();e.TgZ(0,"chq-button",5),e.NdJ("click",function(){e.CHM(n);const M=e.oxw();return e.KtG(M.handledownloadPdf())}),e.qZA()}if(2&o){const n=e.oxw();e.Q6J("buttonModel",n.repairEstimateReportModel)}}function k(o,m){1&o&&e._UZ(0,"td")}function Q(o,m){1&o&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"actions")))}function B(o,m){if(1&o&&(e.TgZ(0,"td",29),e._UZ(1,"span",30),e.qZA()),2&o){const n=e.oxw().$implicit,t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",t.displayNotes(n),e.oJD)}}function K(o,m){if(1&o){const n=e.EpF();e.TgZ(0,"td")(1,"div",31)(2,"mat-icon",32),e.NdJ("click",function(){e.CHM(n);const M=e.oxw().$implicit,O=e.oxw(2);return e.KtG(O.handleIconClick("edit",M.operationId))}),e.qZA(),e.TgZ(3,"mat-icon",33),e.NdJ("click",function(){e.CHM(n);const M=e.oxw().$implicit,O=e.oxw(2);return e.KtG(O.handleIconClick("delete",M.operationId))}),e.qZA()()()}2&o&&(e.xp6(2),e.Q6J("svgIcon","edit"),e.xp6(1),e.Q6J("svgIcon","delete"))}const P=function(o){return{"child-data":o}},h=function(o,m,n,t,M){return[o,m,n,t,M]};function A(o,m){if(1&o&&(e.TgZ(0,"tr",26),e.YNc(1,B,2,1,"td",27),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",28),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"xaCurrency"),e.qZA(),e.TgZ(11,"td",11),e._uU(12),e.ALo(13,"xaCurrency"),e.qZA(),e.YNc(14,K,4,2,"td",10),e.qZA()),2&o){const n=m.$implicit,t=e.oxw(2);e.Q6J("ngClass",e.VKq(21,P,!0===n.isChildItem&&t.isGTEstimate())),e.xp6(1),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.Oqu(n.description),e.xp6(2),e.Oqu(n.code),e.xp6(2),e.Oqu(n.quantity),e.xp6(2),e.Oqu(e.G7q(10,9,e.qbA(23,h,n.cost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.Oqu(e.G7q(13,15,e.qbA(29,h,n.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.editEstimate)}}function D(o,m){1&o&&e._UZ(0,"td")}function H(o,m){1&o&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"actions")))}function W(o,m){if(1&o&&(e.TgZ(0,"td",29),e._UZ(1,"span",30),e.qZA()),2&o){const n=e.oxw().$implicit,t=e.oxw(2);e.xp6(1),e.Q6J("innerHTML",t.displayNotes(n),e.oJD)}}function j(o,m){if(1&o){const n=e.EpF();e.TgZ(0,"td")(1,"div",31)(2,"mat-icon",32),e.NdJ("click",function(){e.CHM(n);const M=e.oxw().$implicit,O=e.oxw(2);return e.KtG(O.handleIconClick("edit",M.operationId))}),e.qZA(),e.TgZ(3,"mat-icon",33),e.NdJ("click",function(){e.CHM(n);const M=e.oxw().$implicit,O=e.oxw(2);return e.KtG(O.handleIconClick("delete",M.operationId))}),e.qZA()()()}2&o&&(e.xp6(2),e.Q6J("svgIcon","edit"),e.xp6(1),e.Q6J("svgIcon","delete"))}function E(o,m){if(1&o&&(e.TgZ(0,"tr",26),e.YNc(1,W,2,1,"td",27),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",28),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"xaCurrency"),e.qZA(),e.TgZ(12,"td",11),e._uU(13),e.ALo(14,"xaCurrency"),e.qZA(),e.YNc(15,j,4,2,"td",10),e.qZA()),2&o){const n=m.$implicit,t=e.oxw(2);e.Q6J("ngClass",e.VKq(24,P,!0===n.isChildItem&&t.isGTEstimate())),e.xp6(1),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.hij(" ",n.description,""),e.xp6(2),e.Oqu(n.code),e.xp6(2),e.AsE("",n.quantity," ",e.lcZ(8,10,"hours"),""),e.xp6(3),e.Oqu(e.G7q(11,12,e.qbA(26,h,n.cost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.s9C("align",t.editEstimate?"center":"right"),e.xp6(1),e.Oqu(e.G7q(14,18,e.qbA(32,h,n.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.editEstimate)}}function V(o,m){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const n=e.oxw(3);e.xp6(1),e.AsE(" ",e.lcZ(2,2,"paint_type"),": ",null==n.estimateResponse||null==n.estimateResponse.estimateSummary?null:n.estimateResponse.estimateSummary.paintType," ")}}function z(o,m){if(1&o&&(e.TgZ(0,"div",34)(1,"div"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,V,3,4,"div",10),e.qZA()),2&o){const n=e.oxw(2);e.xp6(2),e.AsE(" ",e.lcZ(3,3,"paint_system"),": ",null==n.estimateResponse||null==n.estimateResponse.estimateSummary?null:n.estimateResponse.estimateSummary.paintSystem," "),e.xp6(2),e.Q6J("ngIf","azt"===(null==n.estimateResponse||null==n.estimateResponse.estimateSummary||null==n.estimateResponse.estimateSummary.paintSystem?null:n.estimateResponse.estimateSummary.paintSystem.toLowerCase()))}}function X(o,m){1&o&&e._UZ(0,"td")}function $(o,m){1&o&&(e.TgZ(0,"td",25),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"actions")))}function I(o,m){if(1&o&&(e.TgZ(0,"td",29),e._UZ(1,"span",30),e.qZA()),2&o){const n=e.oxw().$implicit,t=e.oxw(3);e.xp6(1),e.Q6J("innerHTML",t.displayNotes(n),e.oJD)}}function q(o,m){if(1&o){const n=e.EpF();e.TgZ(0,"td")(1,"div",31)(2,"mat-icon",32),e.NdJ("click",function(){e.CHM(n);const M=e.oxw().$implicit,O=e.oxw(3);return e.KtG(O.handleIconClick("edit",M.operationId))}),e.qZA(),e.TgZ(3,"mat-icon",33),e.NdJ("click",function(){e.CHM(n);const M=e.oxw().$implicit,O=e.oxw(3);return e.KtG(O.handleIconClick("delete",M.operationId))}),e.qZA()()()}2&o&&(e.xp6(2),e.Q6J("svgIcon","edit"),e.xp6(1),e.Q6J("svgIcon","delete"))}function f(o,m){if(1&o&&(e.TgZ(0,"tr",26),e.YNc(1,I,2,1,"td",27),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",28),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"xaCurrency"),e.qZA(),e.TgZ(11,"td",11),e._uU(12),e.ALo(13,"xaCurrency"),e.qZA(),e.YNc(14,q,4,2,"td",10),e.qZA()),2&o){const n=m.$implicit,t=e.oxw(3);e.Q6J("ngClass",e.VKq(21,P,!0===n.isChildItem&&t.isGTEstimate())),e.xp6(1),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.hij(" ",n.description,""),e.xp6(2),e.Oqu(n.code),e.xp6(2),e.hij("",n.quantity," h"),e.xp6(2),e.Oqu(e.G7q(10,9,e.qbA(23,h,n.cost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.Oqu(e.G7q(13,15,e.qbA(29,h,n.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.editEstimate)}}function d(o,m){if(1&o&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",35),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.YNc(5,f,15,35,"tr",13),e.BQk()),2&o){const n=e.oxw(2);e.xp6(2),e.uIk("colspan",n.editEstimate?"6":"5"),e.xp6(1),e.Oqu(e.lcZ(4,3,"paint_labour")),e.xp6(2),e.Q6J("ngForOf",n.paintLabour)}}function _(o,m){if(1&o&&(e.TgZ(0,"td",29),e._UZ(1,"span",30),e.qZA()),2&o){const n=e.oxw().$implicit,t=e.oxw(3);e.xp6(1),e.Q6J("innerHTML",t.displayNotes(n),e.oJD)}}function S(o,m){if(1&o){const n=e.EpF();e.TgZ(0,"td")(1,"div",31)(2,"mat-icon",32),e.NdJ("click",function(){e.CHM(n);const M=e.oxw().$implicit,O=e.oxw(3);return e.KtG(O.handleIconClick("edit",M.operationId))}),e.qZA(),e.TgZ(3,"mat-icon",33),e.NdJ("click",function(){e.CHM(n);const M=e.oxw().$implicit,O=e.oxw(3);return e.KtG(O.handleIconClick("delete",M.operationId))}),e.qZA()()()}2&o&&(e.xp6(2),e.Q6J("svgIcon","edit"),e.xp6(1),e.Q6J("svgIcon","delete"))}function U(o,m){if(1&o&&(e.TgZ(0,"tr",26),e.YNc(1,_,2,1,"td",27),e.TgZ(2,"td"),e._uU(3),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td",28),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.ALo(10,"xaCurrency"),e.qZA(),e.TgZ(11,"td",11),e._uU(12),e.ALo(13,"xaCurrency"),e.qZA(),e.YNc(14,S,4,2,"td",10),e.qZA()),2&o){const n=m.$implicit,t=e.oxw(3);e.Q6J("ngClass",e.VKq(21,P,!0===n.isChildItem&&t.isGTEstimate())),e.xp6(1),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.hij(" ",n.description,""),e.xp6(2),e.Oqu(n.code),e.xp6(2),e.Oqu(n.quantity),e.xp6(2),e.Oqu(e.G7q(10,9,e.qbA(23,h,n.cost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.Oqu(e.G7q(13,15,e.qbA(29,h,n.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.editEstimate)}}function y(o,m){if(1&o&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",35),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.YNc(5,U,15,35,"tr",13),e.BQk()),2&o){const n=e.oxw(2);e.xp6(2),e.uIk("colspan",n.editEstimate?"6":"5"),e.xp6(1),e.Oqu(e.lcZ(4,3,"paint_material")),e.xp6(2),e.Q6J("ngForOf",n.paintMaterial)}}function x(o,m){1&o&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.BQk()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"total_cost_with_gst")))}function Z(o,m){1&o&&(e.TgZ(0,"td"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"total_cost")))}function Y(o,m){1&o&&(e.TgZ(0,"div",36)(1,"div",37)(2,"div",38),e._UZ(3,"img",39),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e.TgZ(7,"div"),e._UZ(8,"mat-icon",40),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA()()(),e.TgZ(12,"div",37)(13,"div",38),e._UZ(14,"img",41),e.TgZ(15,"span"),e._uU(16),e.ALo(17,"translate"),e.qZA()(),e.TgZ(18,"div",42)(19,"div")(20,"b"),e._uU(21," I "),e.qZA(),e.TgZ(22,"span"),e._uU(23),e.ALo(24,"translate"),e.qZA()(),e.TgZ(25,"div")(26,"b"),e._uU(27,"NI"),e.qZA(),e.TgZ(28,"span"),e._uU(29),e.ALo(30,"translate"),e.qZA()()()(),e.TgZ(31,"div",37)(32,"div",38),e._UZ(33,"img",43),e.TgZ(34,"span"),e._uU(35),e.ALo(36,"translate"),e.qZA()(),e.TgZ(37,"div")(38,"b"),e._uU(39,"C "),e.qZA(),e.TgZ(40,"span"),e._uU(41),e.ALo(42,"translate"),e.qZA()()(),e.TgZ(43,"div",37)(44,"div",38)(45,"b"),e._uU(46,"+"),e.qZA(),e.TgZ(47,"span"),e._uU(48),e.ALo(49,"translate"),e.qZA()(),e.TgZ(50,"div")(51,"b"),e._uU(52,"-"),e.qZA(),e.TgZ(53,"span"),e._uU(54),e.ALo(55,"translate"),e.qZA()()()()),2&o&&(e.xp6(5),e.Oqu(e.lcZ(6,10,"manual")),e.xp6(3),e.Q6J("svgIcon","approximate"),e.xp6(2),e.Oqu(e.lcZ(11,12,"approximate")),e.xp6(6),e.Oqu(e.lcZ(17,14,"documented_by_gt_motive")),e.xp6(7),e.Oqu(e.lcZ(24,16,"included")),e.xp6(6),e.Oqu(e.lcZ(30,18,"not_included")),e.xp6(6),e.Oqu(e.lcZ(36,20,"prepainted_part")),e.xp6(6),e.Oqu(e.lcZ(42,22,"conditioned_by")),e.xp6(7),e.Oqu(e.lcZ(49,24,"thrown_by")),e.xp6(6),e.Oqu(e.lcZ(55,26,"overlapped_by")))}const b=function(o){return{"mb-0":o}};function L(o,m){if(1&o&&(e.TgZ(0,"div",6)(1,"div",7)(2,"h6",8),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"table",9)(6,"thead")(7,"tr"),e.YNc(8,k,1,0,"td",10),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"td"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"td",11),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.YNc(24,Q,3,3,"td",12),e.qZA()(),e.TgZ(25,"tbody"),e.YNc(26,A,15,35,"tr",13),e.qZA()(),e.TgZ(27,"table",9)(28,"tfoot")(29,"tr")(30,"td"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"td",14),e._uU(34),e.ALo(35,"xaCurrency"),e.qZA()()()()(),e.TgZ(36,"div",15)(37,"h6",8),e._uU(38),e.ALo(39,"translate"),e.qZA(),e.TgZ(40,"table",9)(41,"thead")(42,"tr"),e.YNc(43,D,1,0,"td",10),e.TgZ(44,"td"),e._uU(45),e.ALo(46,"translate"),e.qZA(),e.TgZ(47,"td"),e._uU(48),e.ALo(49,"translate"),e.qZA(),e.TgZ(50,"td"),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"td"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"td",11),e._uU(57),e.ALo(58,"translate"),e.qZA(),e.YNc(59,H,3,3,"td",12),e.qZA()(),e.TgZ(60,"tbody"),e.YNc(61,E,16,38,"tr",13),e.qZA()(),e.TgZ(62,"table",9)(63,"tfoot")(64,"tr")(65,"td"),e._uU(66),e.ALo(67,"translate"),e.qZA(),e.TgZ(68,"td",14),e._uU(69),e.ALo(70,"xaCurrency"),e.qZA()()()()(),e.TgZ(71,"div",15)(72,"h6",8),e._uU(73),e.ALo(74,"translate"),e.qZA(),e.YNc(75,z,5,5,"div",16),e.TgZ(76,"table",9)(77,"thead")(78,"tr"),e.YNc(79,X,1,0,"td",10),e.TgZ(80,"td"),e._uU(81),e.ALo(82,"translate"),e.qZA(),e.TgZ(83,"td"),e._uU(84),e.ALo(85,"translate"),e.qZA(),e.TgZ(86,"td"),e._uU(87),e.ALo(88,"translate"),e.qZA(),e.TgZ(89,"td"),e._uU(90),e.ALo(91,"translate"),e.qZA(),e.TgZ(92,"td",11),e._uU(93),e.ALo(94,"translate"),e.qZA(),e.YNc(95,$,3,3,"td",12),e.qZA()(),e.TgZ(96,"tbody"),e.YNc(97,d,6,5,"ng-container",10),e.YNc(98,y,6,5,"ng-container",10),e.qZA()(),e.TgZ(99,"table",9)(100,"tfoot")(101,"tr")(102,"td"),e._uU(103),e.ALo(104,"translate"),e.qZA(),e.TgZ(105,"td",14),e._uU(106),e.ALo(107,"xaCurrency"),e.qZA()()()()(),e.TgZ(108,"div",17)(109,"div",15)(110,"h4",18),e._uU(111),e.ALo(112,"translate"),e.qZA(),e.TgZ(113,"h6",8),e._uU(114),e.ALo(115,"translate"),e.qZA(),e.TgZ(116,"table",9)(117,"tbody")(118,"tr")(119,"td"),e._uU(120),e.ALo(121,"translate"),e.qZA(),e.TgZ(122,"td",14),e._uU(123),e.ALo(124,"xaCurrency"),e.qZA()(),e.TgZ(125,"tr")(126,"td"),e._uU(127),e.ALo(128,"translate"),e.qZA(),e.TgZ(129,"td",14),e._uU(130),e.ALo(131,"xaCurrency"),e.qZA()(),e.TgZ(132,"tr")(133,"td"),e._uU(134),e.ALo(135,"translate"),e.qZA(),e.TgZ(136,"td",14),e._uU(137),e.ALo(138,"xaCurrency"),e.qZA()(),e.TgZ(139,"tr")(140,"td"),e._uU(141),e.ALo(142,"translate"),e.qZA(),e.TgZ(143,"td",14),e._uU(144),e.ALo(145,"xaCurrency"),e.qZA()()(),e.TgZ(146,"tfoot")(147,"tr")(148,"td"),e._uU(149),e.ALo(150,"translate"),e.qZA(),e.TgZ(151,"td",14),e._uU(152),e.ALo(153,"xaCurrency"),e.qZA()()()()(),e.TgZ(154,"div",15)(155,"h6",8),e._uU(156),e.ALo(157,"translate"),e.qZA(),e.TgZ(158,"table",9)(159,"tbody")(160,"tr")(161,"td"),e._uU(162),e.ALo(163,"translate"),e.qZA(),e.TgZ(164,"td",14),e._uU(165),e.ALo(166,"xaCurrency"),e.qZA()(),e.TgZ(167,"tr")(168,"td"),e._uU(169),e.ALo(170,"translate"),e.qZA(),e.TgZ(171,"td",14),e._uU(172),e.qZA()(),e.TgZ(173,"tr")(174,"td"),e._uU(175),e.ALo(176,"translate"),e.qZA(),e.TgZ(177,"td",14),e._uU(178),e.ALo(179,"xaCurrency"),e.qZA()()(),e.TgZ(180,"tfoot")(181,"tr")(182,"td"),e._uU(183),e.ALo(184,"translate"),e.qZA(),e.TgZ(185,"td",14),e._uU(186),e.ALo(187,"xaCurrency"),e.qZA()()()()(),e.TgZ(188,"div",15)(189,"h6",8),e._uU(190),e.ALo(191,"translate"),e.qZA(),e.TgZ(192,"table",9)(193,"tbody")(194,"tr")(195,"td"),e._uU(196),e.ALo(197,"translate"),e.qZA(),e.TgZ(198,"td",14),e._uU(199),e.qZA()(),e.TgZ(200,"tr")(201,"td"),e._uU(202),e.ALo(203,"translate"),e.qZA(),e.TgZ(204,"td",14),e._uU(205),e.ALo(206,"xaCurrency"),e.qZA()(),e.TgZ(207,"tr")(208,"td"),e._uU(209),e.ALo(210,"translate"),e.qZA(),e.TgZ(211,"td",14),e._uU(212),e.ALo(213,"xaCurrency"),e.qZA()(),e.TgZ(214,"tr")(215,"td",19),e._uU(216),e.ALo(217,"translate"),e.qZA(),e.TgZ(218,"td",14),e._uU(219),e.ALo(220,"xaCurrency"),e.qZA()(),e.TgZ(221,"tr")(222,"td"),e._uU(223),e.ALo(224,"translate"),e.qZA(),e.TgZ(225,"td",14),e._uU(226),e.ALo(227,"xaCurrency"),e.qZA()(),e.TgZ(228,"tr")(229,"td"),e._uU(230),e.ALo(231,"translate"),e.qZA(),e.TgZ(232,"td",14),e._uU(233),e.ALo(234,"xaCurrency"),e.qZA()(),e.TgZ(235,"tr")(236,"td"),e._uU(237),e.ALo(238,"translate"),e.qZA(),e.TgZ(239,"td",14),e._uU(240),e.ALo(241,"xaCurrency"),e.qZA()()(),e.TgZ(242,"tfoot")(243,"tr")(244,"td"),e._uU(245),e.ALo(246,"translate"),e.qZA(),e.TgZ(247,"td",14),e._uU(248),e.ALo(249,"xaCurrency"),e.qZA()()()()()(),e.TgZ(250,"div",20)(251,"table",21)(252,"thead")(253,"tr"),e.YNc(254,x,4,3,"ng-container",22),e.YNc(255,Z,3,3,"ng-template",null,23,e.W1O),e.TgZ(257,"td",14),e._uU(258),e.ALo(259,"xaCurrency"),e.qZA()()()()(),e.YNc(260,Y,56,28,"div",24),e.qZA()),2&o){const n=e.MAs(256),t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,91,"parts")),e.xp6(5),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.Oqu(e.lcZ(11,93,"estimate_details_description")),e.xp6(3),e.Oqu(e.lcZ(14,95,"code")),e.xp6(3),e.Oqu(e.lcZ(17,97,"units")),e.xp6(3),e.AsE("",e.lcZ(20,99,"price_unit"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.AsE("",e.lcZ(23,101,"total_price"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("ngIf",t.editEstimate),e.xp6(2),e.Q6J("ngForOf",t.partsCost),e.xp6(5),e.Oqu(e.lcZ(32,103,"total_parts_cost")),e.xp6(3),e.Oqu(e.G7q(35,105,e.qbA(289,h,t.totalPartsCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(39,111,"labour")),e.xp6(5),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.Oqu(e.lcZ(46,113,"estimate_details_description")),e.xp6(3),e.Oqu(e.lcZ(49,115,"code")),e.xp6(3),e.Oqu(e.lcZ(52,117,"hours")),e.xp6(3),e.AsE("",e.lcZ(55,119,"price_unit"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.AsE("",e.lcZ(58,121,"total_price"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("ngIf",t.editEstimate),e.xp6(2),e.Q6J("ngForOf",t.labourCost),e.xp6(5),e.Oqu(e.lcZ(67,123,"total_labour_cost")),e.xp6(3),e.Oqu(e.G7q(70,125,e.qbA(295,h,t.totalLabourCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(74,131,"paint")),e.xp6(2),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(4),e.Q6J("ngIf",t.isGTEstimate()),e.xp6(2),e.Oqu(e.lcZ(82,133,"estimate_details_description")),e.xp6(3),e.Oqu(e.lcZ(85,135,"code")),e.xp6(3),e.Oqu(e.lcZ(88,137,"unit_hours")),e.xp6(3),e.AsE(" ",e.lcZ(91,139,"price_unit"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("align",t.editEstimate?"center":"right"),e.xp6(1),e.AsE("",e.lcZ(94,141,"total_price"),"(",t.i18n.currencySymbol,")"),e.xp6(2),e.Q6J("ngIf",t.editEstimate),e.xp6(2),e.Q6J("ngIf",t.paintLabour.length>0),e.xp6(1),e.Q6J("ngIf",t.paintMaterial.length>0),e.xp6(5),e.Oqu(e.lcZ(104,143,"total_paint_cost")),e.xp6(3),e.Oqu(e.G7q(107,145,e.qbA(301,h,t.totalPaintCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(5),e.Oqu(e.lcZ(112,151,"summary")),e.xp6(3),e.hij(" ",e.lcZ(115,153,"parts"),""),e.xp6(6),e.Oqu(e.lcZ(121,155,"subtotal")),e.xp6(3),e.Oqu(e.G7q(124,157,e.qbA(307,h,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(128,163,"estimate_details_sundry_parts")),e.xp6(3),e.Oqu(e.G7q(131,165,e.qbA(313,h,null==t.summary||null==t.summary.parts?null:t.summary.parts.sundryParts,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(135,171,"total_before_discount")),e.xp6(3),e.Oqu(e.G7q(138,173,e.qbA(319,h,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalBeforeDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.AsE("",e.lcZ(142,179,"discount_on_parts"),"(",null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalDiscountPercentage,"%)"),e.xp6(3),e.Oqu(e.G7q(145,181,e.qbA(325,h,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(5),e.Oqu(e.lcZ(150,187,"total_parts")),e.xp6(3),e.Oqu(e.G7q(153,189,e.qbA(331,h,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(157,195,"labour")),e.xp6(6),e.Oqu(e.lcZ(163,197,"labour_amount_subtotal")),e.xp6(3),e.Oqu(e.G7q(166,199,e.qbA(337,h,t.totalLabourCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(170,205,"labour_hours")),e.xp6(3),e.hij("",null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTimeHours," Hrs"),e.xp6(3),e.AsE("",e.lcZ(176,207,"estimate_details_labour_discount"),"(",null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotalDiscountPercentage,"%)"),e.xp6(3),e.Oqu(e.G7q(179,209,e.qbA(343,h,null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotalDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(5),e.Oqu(e.lcZ(184,215,"total_labour_cost")),e.xp6(3),e.Oqu(e.G7q(187,217,e.qbA(349,h,null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.hij(" ",e.lcZ(191,223,"paint"),""),e.xp6(6),e.Oqu(e.lcZ(197,225,"paint_labour_time")),e.xp6(3),e.hij("",null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourTimeHour," Hrs"),e.xp6(3),e.Oqu(e.lcZ(203,227,"paint_labour_subtotal")),e.xp6(3),e.Oqu(e.G7q(206,229,e.qbA(355,h,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.AsE("",e.lcZ(210,235,"estimate_details_paint_labour_discount"),"(",null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourDiscountPercentage,"%)"),e.xp6(3),e.Oqu(e.G7q(213,237,e.qbA(361,h,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(217,243,"labour_total")),e.xp6(3),e.Oqu(e.G7q(220,245,e.qbA(367,h,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(224,251,"material_subtotal")),e.xp6(3),e.Oqu(e.G7q(227,253,e.qbA(373,h,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.AsE("",e.lcZ(231,259,"estimate_details_material_discount"),"(",null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMateriaDiscountPercentage,"%)"),e.xp6(3),e.Oqu(e.G7q(234,261,e.qbA(379,h,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(238,267,"material_total")),e.xp6(3),e.Oqu(e.G7q(241,269,e.qbA(385,h,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(5),e.Oqu(e.lcZ(246,275,"total_paint")),e.xp6(3),e.Oqu(e.G7q(249,277,e.qbA(391,h,null==t.summary||null==t.summary.paint?null:t.summary.paint.paintTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(3),e.Q6J("ngClass",e.VKq(397,b,!t.isGTEstimate())),e.xp6(3),e.Q6J("ngIf","Rs."===t.i18n.currencySymbol)("ngIfElse",n),e.xp6(4),e.Oqu(e.G7q(259,283,e.qbA(399,h,t.total.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",t.isGTEstimate())}}function s(o,m){1&o&&(e.TgZ(0,"div",44),e._UZ(1,"mat-icon",45),e.TgZ(2,"p",46),e._uU(3),e.ALo(4,"translate"),e._UZ(5,"br"),e._uU(6),e.ALo(7,"translate"),e._UZ(8,"br"),e._uU(9),e.ALo(10,"translate"),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("svgIcon","estimate-no-data"),e.xp6(2),e.hij(" ",e.lcZ(4,4,"no_result"),". "),e.xp6(3),e.hij(" ",e.lcZ(7,6,"no_estimate")," "),e.xp6(3),e.hij(" ",e.lcZ(10,8,"add_try_again")," "))}let g=(()=>{class o{constructor(n){this.monitorService=n,this.iconClicked=new e.vpe,this.downloadPdf=new e.vpe,this.repairEstimateReportModel={label:"estimate_report",type:"outline",icon:"report-check"},this.paintCost=[],this.partsCost=[],this.totalPartsCost=0,this.labourCost=[],this.totalLabourCost=0,this.paintLabour=[],this.paintMaterial=[],this.totalPaintCost=0,this.noDataFound=!1,this.summary={parts:{partsSubTotal:0,sundryParts:0,sundryPartsPercentage:0,partsTotalBeforeDiscount:0,partsTotalDiscountPercentage:0,partsTotal:0},labour:{labourTimeHours:0,labourTotalDiscountPercentage:0,labourTotalDiscount:0,labourTotal:0},paint:{labour:{paintLabourTimeHour:0,paintLabourSubTotal:0,paintLabourDiscountPercentage:0,paintLabourDiscount:0,paintLabourTotal:0},material:{paintMaterialSubTotal:0,paintMateriaDiscountPercentage:0,paintMaterialDiscount:0,paintMaterialTotal:0},paintTotal:0}},this.total={total:0,vatPercent:0,vat:0,totalWithVat:0}}ngOnInit(){this.monitorService.logEvent("ngOnInit",["ChqEstimateDetailsComponent","addenda-repair"]),this.setData()}ngOnChanges(n){this.monitorService.logEvent("ngOnChanges",["ChqEstimateDetailsComponent","addenda-repair"]),n&&n.estimateResponse&&n.estimateResponse.currentValue&&(this.estimateResponse={...n.estimateResponse.currentValue},this.setData())}setData(){const n=this.estimateResponse?.estimateCharges||[];if(0===n.length)this.noDataFound=!0;else{this.noDataFound=!1,this.labourCost=n?.filter(M=>"labour"==M.serviceType?.toLowerCase()),this.paintCost=n?.filter(M=>"paint"==M.serviceType?.toLowerCase()),this.partsCost=n?.filter(M=>"part"==M.serviceType?.toLowerCase()),this.paintLabour=this.paintCost?.filter(M=>"paintlabour"==M.serviceSubType?.toLowerCase()),this.paintMaterial=this.paintCost?.filter(M=>"paintmaterial"==M.serviceSubType?.toLowerCase());const t=this.estimateResponse?.estimateSummary;this.totalPartsCost=t?.partsSubTotal?parseFloat(t?.partsSubTotal):0,this.totalLabourCost=t?.labourTotalBeforeDiscount?parseFloat(t?.labourTotalBeforeDiscount):0,this.totalPaintCost=t?.paintSubTotal?parseFloat(t?.paintSubTotal):0,this.total.total=this.estimateResponse?.subTotal||0,this.total.vatPercent=this.estimateResponse?.taxPercentage||0,this.total.vat=this.estimateResponse?.taxTotal||0,this.total.totalWithVat=this.estimateResponse?.total||0,this.estimateResponse?.currencyCode&&(this.i18n.currencySymbol=this.estimateResponse?.currencyCode),this.summary.parts.partsSubTotal=this.estimateResponse?.estimateSummary?.partsSubTotal||0,this.summary.parts.sundryParts=this.estimateResponse?.estimateSummary?.sundryParts||0,this.summary.parts.sundryPartsPercentage=this.estimateResponse?.estimateSummary?.sundryPartsPercentage||0,this.summary.parts.partsTotalBeforeDiscount=this.estimateResponse?.estimateSummary?.partsTotalBeforeDiscount||0,this.summary.parts.partsTotalDiscountPercentage=this.estimateResponse?.estimateSummary?.partsTotalDiscountPercentage||0,this.summary.parts.partsTotal=this.estimateResponse?.estimateSummary?.partsTotal||0,this.summary.parts.partsTotalDiscount=this.estimateResponse?.estimateSummary?.partsTotalDiscount||0,this.summary.labour.labourTimeHours=this.estimateResponse?.estimateSummary?.labourTimeHours||0,this.summary.labour.labourTotalDiscountPercentage=this.estimateResponse?.estimateSummary?.labourTotalDiscountPercentage||0,this.summary.labour.labourTotalDiscount=this.estimateResponse?.estimateSummary?.labourTotalDiscount||0,this.summary.labour.labourTotal=this.estimateResponse?.estimateSummary?.labourTotal||0,this.summary.paint.labour.paintLabourTimeHour=this.estimateResponse?.estimateSummary?.paintLabourTimeHour||0,this.summary.paint.labour.paintLabourSubTotal=this.estimateResponse?.estimateSummary?.paintLabourSubTotal||0,this.summary.paint.labour.paintLabourDiscountPercentage=this.estimateResponse?.estimateSummary?.paintLabourDiscountPercentage||0,this.summary.paint.labour.paintLabourDiscount=this.estimateResponse?.estimateSummary?.paintLabourDiscount||0,this.summary.paint.labour.paintLabourTotal=this.estimateResponse?.estimateSummary?.paintLabourTotal||0,this.summary.paint.material.paintMaterialSubTotal=this.estimateResponse?.estimateSummary?.paintMaterialSubTotal||0,this.summary.paint.material.paintMateriaDiscountPercentage=this.estimateResponse?.estimateSummary?.paintMateriaDiscountPercentage||0,this.summary.paint.material.paintMaterialDiscount=this.estimateResponse?.estimateSummary?.paintMaterialDiscount||0,this.summary.paint.material.paintMaterialTotal=this.estimateResponse?.estimateSummary?.paintMaterialTotal||0,this.summary.paint.paintTotal=this.estimateResponse?.estimateSummary?.paintTotal||0}}handleIconClick(n,t){this.iconClicked.emit({action:n,id:t})}displayNotes(n){return n.isAztPartDocumentedByGT?'<img src="assets/img/gt.png" />':n.isConditionedBy?"<b>C </b>":n.isIncluded?"<b> I </b>":n.isNotIncluded?"<b>NI</b>":n.isOverlappedBy?"<b>-</b>":n.isPrepainted?'<img src="assets/img/prepainted_part.png" />':n.isThrownBy?"<b>+</b>":n.isApproximate?'<img src="assets/img/approximate.png" />':n.isManual?'<img src="assets/img/white_flag.png" />':""}isGTEstimate(){return"GTMotive"===this.estimateSource}handledownloadPdf(){this.downloadPdf.emit()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(a.M))},o.\u0275cmp=e.Xpm({type:o,selectors:[["chq-estimate-details"]],inputs:{estimateResponse:"estimateResponse",editEstimate:"editEstimate",estimateSource:"estimateSource",serviceType:"serviceType",i18n:"i18n"},outputs:{iconClicked:"iconClicked",downloadPdf:"downloadPdf"},features:[e.TTD],decls:9,vars:6,consts:[[1,"d-flex","justify-space-between","align-center","estimate-label"],[3,"buttonModel","click",4,"ngIf"],[1,"estimate-main-container"],["class","estimate-details-block",4,"ngIf"],["class","estimate-details-no-data-found",4,"ngIf"],[3,"buttonModel","click"],[1,"estimate-details-block"],[1,"table-parent","mt-0"],[1,"small-heading"],["width","100%"],[4,"ngIf"],[3,"align"],["align","center","width","80px",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],["align","right"],[1,"table-parent"],["class","paint-type small-heading",4,"ngIf"],[1,"summary"],[1,"sub-heading"],[1,"sub-total"],[1,"table-parent","mb-0"],["width","100%",1,"total-table",3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["class","notes",4,"ngIf"],["align","center","width","80px"],[3,"ngClass"],["width","20px",4,"ngIf"],[1,"text-light"],["width","20px"],[3,"innerHTML"],[1,"icon-wrapper"],[1,"edit-icon",3,"svgIcon","click"],[1,"delete-icon",3,"svgIcon","click"],[1,"paint-type","small-heading"],[1,"fw-bold"],[1,"notes"],[1,"span-1"],[1,"p-10"],["src","assets/img/white_flag.png"],["aria-hidden","false",3,"svgIcon"],["src","assets/img/gt.png"],[1,"include"],["src","assets/img/prepainted_part.png"],[1,"estimate-details-no-data-found"],[1,"no-data-svg",3,"svgIcon"],[1,"no-data-text"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"h3"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.ynx(4),e.YNc(5,u,1,1,"chq-button",1),e.BQk(),e.qZA(),e.TgZ(6,"div",2),e.YNc(7,L,261,405,"div",3),e.YNc(8,s,11,10,"div",4),e.qZA()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,4,"estimate")),e.xp6(3),e.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0),e.xp6(2),e.Q6J("ngIf",!t.noDataFound),e.xp6(1),e.Q6J("ngIf",t.noDataFound))},dependencies:[R.mk,R.sg,R.O5,N.Hw,G.E,v.X$,w.j],styles:[".estimate-details-block[_ngcontent-%COMP%]   .sub-heading[_ngcontent-%COMP%]{font-weight:500;font-size:14px;margin:0 0 15px;padding-left:10px}.estimate-details-block[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-weight:500;font-size:14px;margin:0 0 5px;padding-left:10px}.estimate-details-block[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]{margin:32px 0}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:14px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:14px;font-weight:500;padding-bottom:25px}.estimate-details-block[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray);font-size:12px;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]{margin-bottom:22px}.estimate-details-block[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{flex-wrap:wrap;display:flex;flex-direction:row;justify-content:space-between;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]{font-size:14px;display:flex;flex-direction:column;justify-content:flex-start;box-sizing:border-box;padding:0 10px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .p-10[_ngcontent-%COMP%]{padding:10px 0}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .include[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;gap:10px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:12px!important;width:10px!important}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   b[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{align-self:center}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:5px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .mb-20[_ngcontent-%COMP%]{margin-bottom:20px}.estimate-details-block[_ngcontent-%COMP%]   tr.child-data[_ngcontent-%COMP%]{background:rgba(26,34,55,.2)}.estimate-details-block[_ngcontent-%COMP%]   tr.child-data[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{padding-left:20px}.estimate-details-block[_ngcontent-%COMP%]   .paint-type[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;width:50%;font-size:12px;color:var(--xa-dark-gray)}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 385px - (53px + 3.1vw))}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:Inter;font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}"]}),o})()},39912:(te,F,r)=>{r.d(F,{q:()=>re});var e=r(94650),a=r(75983),R=r(71764),G=r(81364),v=r(13975),w=r(12484),u=r(81390),k=r(56785),Q=r(36895),B=r(97392),K=r(22406),P=r(42736),h=r(36978),A=r(36072),D=r(8571),H=r(2913),W=r(48262),j=r(89383);const E=["chqUpload"];function V(c,T){if(1&c){const i=e.EpF();e.TgZ(0,"chq-step-header",9),e.NdJ("uploadBackHandler",function(){e.CHM(i);const p=e.oxw();return e.KtG(p.goBackToSelection())})("back",function(){e.CHM(i);const p=e.oxw();return e.KtG(p.showReview())}),e.qZA()}if(2&c){const i=e.oxw();e.Q6J("chqModel",i.header)("hideHeader",i.hideHeader)("hideBack",i.hideback)("hideDelete",!0)}}function z(c,T){1&c&&e._UZ(0,"mat-icon",22),2&c&&e.Q6J("svgIcon","checked")}function X(c,T){1&c&&e._UZ(0,"mat-icon",23),2&c&&e.Q6J("svgIcon","unchecked")}function $(c,T){if(1&c){const i=e.EpF();e.TgZ(0,"div",24)(1,"img",25),e.NdJ("load",function(){e.CHM(i);const p=e.oxw(2);return e.KtG(p.imageLoading[null==p.currentStep?null:p.currentStep.stepName]=!0)}),e.qZA()()}if(2&c){const i=e.oxw(2);e.xp6(1),e.Q6J("src",null==i.currentStep?null:i.currentStep.image,e.LSH)}}function I(c,T){if(1&c){const i=e.EpF();e.TgZ(0,"div",24)(1,"img",25),e.NdJ("load",function(){e.CHM(i);const p=e.oxw(3);return e.KtG(p.imageLoading[null==p.currentStep?null:p.currentStep.stepName]=!0)}),e.qZA()()}if(2&c){const i=e.oxw(3);e.xp6(1),e.Q6J("src",null==i.currentStep?null:i.currentStep.url,e.LSH)}}function q(c,T){if(1&c&&e.YNc(0,I,2,1,"div",18),2&c){e.oxw();const i=e.MAs(18),l=e.oxw();e.Q6J("ngIf",null==l.currentStep?null:l.currentStep.url)("ngIfElse",i)}}function f(c,T){if(1&c){const i=e.EpF();e.TgZ(0,"div",26)(1,"img",25),e.NdJ("load",function(){e.CHM(i);const p=e.oxw(2);return e.KtG(p.imageLoading[null==p.currentStep?null:p.currentStep.stepName]=!0)}),e.qZA()()}if(2&c){const i=e.oxw(2);e.xp6(1),e.Q6J("src",null==i.currentStep?null:i.currentStep.placeHolderUrl,e.LSH)}}function d(c,T){if(1&c&&(e.TgZ(0,"div",10)(1,"div",11)(2,"h3",12),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,z,1,1,"mat-icon",13),e.YNc(6,X,1,1,"ng-template",null,14,e.W1O),e.qZA(),e.TgZ(8,"div",15)(9,"span",16),e._uU(10),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"div",17),e.ynx(13),e.YNc(14,$,2,1,"div",18),e.YNc(15,q,1,2,"ng-template",null,19,e.W1O),e.YNc(17,f,2,1,"ng-template",null,20,e.W1O),e._UZ(19,"chq-customloader",21),e.BQk(),e.qZA()()),2&c){const i=e.MAs(7),l=e.MAs(16),p=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,7,null!=p.currentStep&&p.currentStep.isAdditionalDocumentFromReviewPageOnly?"photos"===p.inspection?"add_additional_image":"add_additional_documents":null==p.currentStep?null:p.currentStep.stepName)," "),e.xp6(2),e.Q6J("ngIf","success"===(null==p.currentStep?null:p.currentStep.uploadStatus)||(null==p.currentStep?null:p.currentStep.url))("ngIfElse",i),e.xp6(5),e.Oqu(null!=p.currentStep&&p.currentStep.isUploadSuccess?"Uploaded":e.lcZ(11,9,null!=p.currentStep&&p.currentStep.uploadInProgress?"upload_inprogress":"not_uploaded")),e.xp6(4),e.Q6J("ngIf",null==p.currentStep?null:p.currentStep.image)("ngIfElse",l),e.xp6(5),e.Q6J("showLoading",!p.imageLoading[null==p.currentStep?null:p.currentStep.stepName]&&!(null==p.currentStep||!p.currentStep.url))}}function _(c,T){if(1&c){const i=e.EpF();e.TgZ(0,"div",27)(1,"chq-vertical-image-preview",28),e.NdJ("selection",function(p){e.CHM(i);const C=e.oxw();return e.KtG(C.setCurrentStep(p))}),e.qZA()()}if(2&c){const i=e.oxw();e.xp6(1),e.Q6J("maximumImages",i.maximumImages)("page",i.inspection)("steps",i.imageStatusSteps)("isMultipleUpload",i.isMassUpload)}}function S(c,T){1&c&&(e.TgZ(0,"div",29),e._UZ(1,"img",30),e.TgZ(2,"label"),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&c&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"drag_drop")))}function U(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.cancelButtonModel)}}function y(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.backButtonModel)}}function x(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.skipButtonModel)}}function Z(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.uploadButtonModel)}}function Y(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.deleteButton)}}function b(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.retakeButton)}}function L(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(5);e.Q6J("buttonModel",i.notifyButtonModel)}}function s(c,T){if(1&c&&e._UZ(0,"chq-button",41),2&c){const i=e.oxw(5);e.Q6J("buttonModel",i.addPartButtonModel)}}function g(c,T){if(1&c&&(e.ynx(0),e.YNc(1,L,1,1,"chq-button",38),e.YNc(2,s,1,1,"chq-button",40),e.BQk()),2&c){const i=e.oxw(4);e.xp6(1),e.Q6J("ngIf",i.showNotify),e.xp6(1),e.Q6J("ngIf",i.showComplete)}}function o(c,T){if(1&c&&(e.TgZ(0,"div",37),e.YNc(1,U,1,1,"chq-button",38),e.YNc(2,y,1,1,"chq-button",38),e.YNc(3,x,1,1,"chq-button",38),e.YNc(4,Z,1,1,"chq-button",38),e.YNc(5,Y,1,1,"chq-button",38),e.YNc(6,b,1,1,"chq-button",38),e.YNc(7,g,3,2,"ng-container",35),e.qZA()),2&c){const i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.showDelete&&(null==i.header?null:i.header.isRepairModule)&&!i.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",!0===(null==i.footerOptions?null:i.footerOptions.showUploadOption)&&!(null!=i.header&&i.header.isRepairModule)),e.xp6(1),e.Q6J("ngIf",!(null!=i.currentStep&&i.currentStep.mandatory||i.showReTakeDelete&&-1===(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))&&(null!=i.currentStep&&i.currentStep.image||null!=i.currentStep&&i.currentStep.url))),e.xp6(1),e.Q6J("ngIf",(!i.showReTakeDelete||-1!==(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))||!(null!=i.currentStep&&i.currentStep.image)&&!(null!=i.currentStep&&i.currentStep.url))&&!i.commonService.isViewOnly&&i.currentStatus),e.xp6(1),e.Q6J("ngIf",i.showReTakeDelete&&!i.commonService.isViewOnly&&i.currentStatus&&-1===(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))&&((null==i.currentStep?null:i.currentStep.image)||(null==i.currentStep?null:i.currentStep.url))),e.xp6(1),e.Q6J("ngIf",i.showReTakeDelete&&!i.commonService.isViewOnly&&i.currentStatus&&-1===(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))&&((null==i.currentStep?null:i.currentStep.image)||(null==i.currentStep?null:i.currentStep.url))),e.xp6(1),e.Q6J("chqPermission","newBooking")}}function m(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.cancelButtonModel)}}function n(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.backButtonModel)}}function t(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(4);e.Q6J("buttonModel",i.uploadButtonModel)}}function M(c,T){if(1&c&&e._UZ(0,"chq-button",39),2&c){const i=e.oxw(5);e.Q6J("buttonModel",i.notifyButtonModel)}}function O(c,T){if(1&c&&e._UZ(0,"chq-button",41),2&c){const i=e.oxw(5);e.Q6J("buttonModel",i.addPartButtonModel)}}function oe(c,T){if(1&c&&(e.ynx(0),e.YNc(1,M,1,1,"chq-button",38),e.YNc(2,O,1,1,"chq-button",40),e.BQk()),2&c){const i=e.oxw(4);e.xp6(1),e.Q6J("ngIf",i.showNotify),e.xp6(1),e.Q6J("ngIf",i.showComplete)}}function ie(c,T){if(1&c&&(e.TgZ(0,"div",37),e.YNc(1,m,1,1,"chq-button",38),e.YNc(2,n,1,1,"chq-button",38),e.YNc(3,t,1,1,"chq-button",38),e.YNc(4,oe,3,2,"ng-container",35),e.qZA()),2&c){const i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.showDelete&&(null==i.header?null:i.header.isRepairModule)&&!i.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",!0===(null==i.footerOptions?null:i.footerOptions.showUploadOption)&&!(null!=i.header&&i.header.isRepairModule)),e.xp6(1),e.Q6J("ngIf",(!i.showReTakeDelete||i.hideback||-1!==(null==i.currentStep?null:i.currentStep.stepName.indexOf("Additional"))||!(null!=i.currentStep&&i.currentStep.image)&&!(null!=i.currentStep&&i.currentStep.url))&&i.currentStatus&&!i.commonService.isViewOnly),e.xp6(1),e.Q6J("chqPermission","newBooking")}}function ae(c,T){if(1&c&&(e.ynx(0),e.YNc(1,o,8,7,"div",36),e.YNc(2,ie,5,4,"div",36),e.BQk()),2&c){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!i.isMassUpload),e.xp6(1),e.Q6J("ngIf",i.isMassUpload)}}function ee(c,T){if(1&c&&(e.TgZ(0,"div",31)(1,"div",32)(2,"div",33),e._UZ(3,"img",34),e.qZA()(),e.YNc(4,ae,3,2,"ng-container",35),e.qZA()),2&c){const i=e.oxw();e.xp6(3),e.MGl("src","assets/img/",+(null==i.header?null:i.header.isRepairModule)?"addenda-repair.png":"addenda-quote.png","",e.LSH),e.xp6(1),e.Q6J("chqPermission",null!=i.footerOptions&&i.footerOptions.section?"repairStages":"newBooking")}}function de(c,T){if(1&c){const i=e.EpF();e.TgZ(0,"chq-review-section",42),e.NdJ("backToUpload",function(){e.CHM(i);const p=e.oxw();return e.KtG(p.goBackToSelection())})("handleDeleteAllEvent",function(){e.CHM(i);const p=e.oxw();return e.KtG(p.handleAllImagesDelete())})("completeRepair",function(){e.CHM(i);const p=e.oxw();return e.KtG(p.completeRepair.emit())})("notify",function(){e.CHM(i);const p=e.oxw();return e.KtG(p.notify.emit())})("selection",function(p){e.CHM(i);const C=e.oxw();return e.KtG(C.handleReviewAction(p))}),e.qZA()}if(2&c){const i=e.oxw();e.Q6J("maximumImages",i.maximumImages)("hideAI",i.hideAI)("isRepairStage",i.isRepairStage)("minimumPhotosRequired",i.minumumImagesRequired)("footerOptions",i.footerOptions)("currentAdditionalModeMultiple",i.currentAdditionalModeMultiple)("isMultipleUpload",i.isMassUpload)("inspectionId",i.inspectionId)("header",i.header)("showComplete",i.showComplete)("showNotify",i.showNotify)("isRepairComplete",i.isRepairComplete)("activateRepairButton",i.activateRepairButton)("steps",i.imageStatusSteps)}}const se=function(c,T){return{"no-border":c,"document-container":T}},ne=function(c){return{disabled:c}};let re=(()=>{class c{constructor(i,l,p,C,J,le,ce){this.cd=i,this.commonService=l,this.inspectionService=p,this.monitorService=C,this.route=J,this.router=le,this.calendarService=ce,this.minumumImagesRequired=0,this.updateMassUpload=new e.vpe,this.cardSelection=new e.vpe,this.backToUpload=new e.vpe,this.handleDeleteAllEvent=new e.vpe,this.stepSkipped=new e.vpe,this.notify=new e.vpe,this.completeRepair=new e.vpe,this.totalAdditionalSteps=0,this.hideHeader=!1,this.skipButtonModel={label:"skip",type:"primary"},this.uploadButtonModel={label:"upload",type:"primary"},this.retakeButton={label:"retake",type:"primary"},this.notifyButtonModel={label:"notify",type:"outline",icon:"send",onclick:()=>{this.notify.emit()}},this.addPartButtonModel={label:"Complete Repair",type:"disabled",onclick:()=>{this.completeRepair.emit()}},this.backButtonModel={label:"back_to_photo",type:"outline"},this.deleteButton={label:"delete",type:"red"},this.bookButton={label:"book_in",type:"primary"},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.imageLoading={},this.fromReviewPage=!1,this.isReviewSection=!1,this.hideback=!1,this.currentStepIndex=0,this.currentNonReviewSteps=0,this.imageStatusSteps=[]}get showDelete(){return!(!this.footerOptions?.repairId||"draft"!==this.footerOptions?.currentStatus?.toLowerCase())||!(!this.footerOptions?.repairId||1!=this.footerOptions?.isRepairCreatedFromCase||"repairestimation"!=this.footerOptions?.currentStatus?.toLowerCase())}handleImageOutput(i){if(this.monitorService.logEvent("handleImageOutput",["ChqImagesUploaderComponent","addenda-quote",{$event:i}]),this.isMassUpload||this.currentAdditionalModeMultiple){this.currentAdditionalModeMultiple=!0;const l=i;let p=0;for(const C in l){const J=l[C],le={stepName:J.fileName,uploadStatus:"notUploaded",url:"",image:J.image,imageFile:J.file,index:p,sizeLimit:5242880,isMassUpload:!0,allowExtension:["jpg","jpeg","png"],mandatory:!0,placeHolderUrl:"",isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,templateGuid:"",partTemplateGuid:""};p++,this.imageStatusSteps.push(le)}this.updateMassUpload.emit(this.isMassUpload?{steps:this.imageStatusSteps.filter(C=>1!=C.isUploadSuccess&&!0!==C.uploadInProgress)}:{steps:[this.imageStatusSteps[this.imageStatusSteps.length-1]]}),this.nonAdditional<(this.maximumImages||20)?0===this.imageStatusSteps.filter(J=>-1===J.index&&!0===J.isAdditionalDocumentFromReviewPageOnly).length&&this.imageStatusSteps.push({stepName:"photos"===this.inspection?"Additional Image":"Additional Documents",uploadStatus:"notUploaded",url:"",image:"",index:-1,isAdditionalDocumentFromReviewPageOnly:!0,sizeLimit:5242880,allowExtension:["jpg","jpeg","png"],mandatory:!1,isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,templateGuid:"",partTemplateGuid:"",placeHolderUrl:"/assets/icons/additional-image.svg"}):(this.imageStatusSteps=this?.imageStatusSteps?.filter(C=>1!=C.isAdditionalDocumentFromReviewPageOnly||C.image||C.url),this.imageStatusSteps[this.imageStatusSteps.length-1].isAdditionalDocumentFromReviewPageOnly=!1),this.imageStatusSteps=[...this.imageStatusSteps],this.isReviewSection=!0,this.fromReviewPage=!1}else{const l=i;if(this.currentStep.isAdditionalDocumentFromReviewPageOnly){const p=this.imageStatusSteps.filter(C=>!0===C.isAdditionalDocumentFromReviewPageOnly&&1!=C.uploadInProgress);this.currentStep=p[0]}if(this.currentStep.image=l.image,this.currentStep.imageFile=l.file,this.imageStatusSteps=[...this.imageStatusSteps],"photos"==this.inspection){const p=new Image;p.src=l.image,p.onload=()=>{this.currentStep.imageHeight=p.height,this.currentStep.imageWidth=p.width,this.executeUploader(),0==this.imageStatusSteps.filter(C=>J=>!0!==J.isUploadSuccess&&J.mandatory)?.length||this.fromReviewPage||this.currentStep.isAdditionalDocumentFromReviewPageOnly?(this.isReviewSection=!0,this.fromReviewPage=!1):(this.isReviewSection=!1,this.currentStepIndex++,this.currentStepIndex>this.imageStatusSteps.length-1&&this.currentStepIndex--,this.currentStep=this.imageStatusSteps[this.currentStepIndex])}}else this.executeUploader(),this.currentStepIndex===this.imageStatusSteps.length||0===this.totalAdditionalSteps&&this.currentStepIndex===this.imageStatusSteps.length-1||this.currentStep.isAdditionalDocumentFromReviewPageOnly||this.fromReviewPage?(this.isReviewSection=!0,this.fromReviewPage=!1,this.checkRouteParams()):(this.isReviewSection=!1,this.currentStepIndex++,this.currentStep=this.imageStatusSteps[this.currentStepIndex],this.cardSelection.emit(this.currentStep))}}checkRouteParams(){this.route.queryParams?.subscribe(i=>{const l=i.fromPersonal;"true"===l||!0===l?this.router.navigate(["/repair/booking/0"]):(this.isReviewSection=!0,this.fromReviewPage=!1)})}onScroll(){window.clearTimeout(this.isScrolling);const i=document.getElementsByClassName("footer-full-wrapper");i&&i.length>0&&(i[0].style.position="absolute"),this.isScrolling=setTimeout(()=>{const l=document.getElementsByClassName("footer-full-wrapper");l&&l.length>0&&(l[0].style.position="fixed")},66)}get nonAdditional(){return this?.imageStatusSteps?.filter(i=>1!=i.isAdditionalDocumentFromReviewPageOnly||i.image||i.url).length}goToReview(){this.isReviewSection=!0,this.fromReviewPage=!1,this.monitorService.logEvent("goToReview",["ChqImagesUploaderComponent","addenda-quote"])}handleAllImagesDelete(){this.imageStatusSteps=[],this.handleDeleteAllEvent.emit()}executeUploader(){this.fileUploaderService&&(this.commonService.showNotification("Your photo is currently uploading won\u2019t be long and we\u2019ll \n    notify you when its uploaded, you can continue to take your photos."),this.fileUploaderService(this.currentStep),this.monitorService.logEvent("executeUploader",["ChqImagesUploaderComponent","addenda-quote"]),setTimeout(()=>{const l=this.imageStatusSteps.filter(p=>!0===p.uploadInProgress);l.length>0&&(this.hideback=!0),this.commonService.inProgressSteps.next(l.length)}))}handleReviewAction(i){this.monitorService.logEvent("handleReviewAction",["ChqImagesUploaderComponent","addenda-quote",{$event:i}]),this.footerOptions?.repairId&&["edit","upload"].includes(i.mode)&&this.footerOptions?.from==a.j.quote&&this.commonService.repairPermission||this.footerOptions?.caseId&&["edit","upload"].includes(i.mode)&&this.footerOptions?.from==a.j.repair&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.handleReviewActionCall.bind(this,i),"Quote"==this.footerOptions.from?"Repair":"Quote"):this.handleReviewActionCall(i)}handleReviewActionCall(i){if("edit"===i.mode)this.setCurrentStep(i.step),this.isReviewSection=!1,this.fromReviewPage=!0;else if("upload"===i.mode)this.setCurrentStep(i.step),this.fromReviewPage=!0,this.uploadFile();else if(i.step.inspectionItem){const l=this.imageStatusSteps.findIndex(p=>p.inspectionItem?.id===i.step.inspectionItem?.id);this.deleteSelectedImage(i.step,l)}else{const l=i.step.index;this.deleteSelectedImage(this.imageStatusSteps[l],l)}}deleteSelectedImage(i,l){i.url="",i.uploadedGuid="",i.updatedDate="",i.uploadedDate="",i.uploadInProgress=!1,i.isSkipped=!1,i.isUploadSuccess=!1,i.uploadedPartGuid="",i.isUploadFailed=!1,i.imageFile=null,i.image=null,i.uploadStatus="notUploaded",-1!=i.stepName.indexOf("Additional")&&(i.isAdditionalDocumentFromReviewPageOnly=!0),i.isMassUpload||"Bulk Upload Image"===i.procedureSteps?this.imageStatusSteps=this.imageStatusSteps.filter(C=>C?.inspectionItem?.id!=i?.inspectionItem?.id):(this.imageStatusSteps[l]={...i},this.imageStatusSteps=[...this.imageStatusSteps],0===this.imageStatusSteps.filter(J=>J.image||J.url).length&&"photos"===this.inspection?(this.footerOptions.showUploadOption=!0,this.hideback=!1,this.header={...this.header,showTitle:!0}):this.header={...this.header,showTitle:!1}),0===this.imageStatusSteps.filter(C=>C.url).length&&(this.hideback=!1,this.setCurrentStep(this.imageStatusSteps[0]))}get currentStatus(){return!this.footerOptions?.currentStatus||-1===["closed","complete"].indexOf(this.footerOptions?.currentStatus?.toLowerCase())}delete(){this.monitorService.logEvent("delete",["ChqImagesUploaderComponent","addenda-quote"]),this.currentStep.url&&"photos"===this.inspection&&this.inspectionService.deleteInspection(this.currentStep.inspectionItem.id).subscribe(l=>{this.commonService.hideLoading(),0===this.imageStatusSteps.filter(C=>C.image||C.url).length&&(this.footerOptions.showUploadOption=!0)},()=>{this.commonService.hideLoading()}),this.currentStep.image=null,this.currentStep.uploadedGuid="",this.currentStep.uploadInProgress=!1,this.currentStep.isSkipped=!1,this.currentStep.isUploadSuccess=!1,this.currentStep.isUploadFailed=!1,this.currentStep.imageFile=null,this.currentStep.url="",this.currentStep.updatedDate="",this.currentStep.uploadedDate="",this.currentStep.uploadStatus="notUploaded",-1!=this.currentStep.stepName.indexOf("Additional")&&(this.currentStep.isAdditionalDocumentFromReviewPageOnly=!0),0===this.imageStatusSteps.filter(l=>l.url).length&&(this.hideback=!1,this.setCurrentStep(this.imageStatusSteps[0]))}ngOnChanges(i){i&&(i.activateRepairButton&&i.activateRepairButton.currentValue&&(this.addPartButtonModel={...this.addPartButtonModel,type:"primary"}),i.isRepairComplete&&i.isRepairComplete.currentValue&&(this.addPartButtonModel={...this.addPartButtonModel,label:"go_invoice"}))}updateUploadStatus(i,l,p,C,J){this.monitorService.logEvent("updateUploadStatus",["ChqImagesUploaderComponent","addenda-quote",{status:i,currentStep:l,responseData:C,isBulk:J}]),this.chqUpload.resetValue(),"failed"==i?(l.uploadInProgress=!1,l.isSkipped=!1,l.isUploadSuccess=!1,l.isUploadFailed=!1,J?l.isUploadFailed=!0:(l.imageFile=null,l.image=null),this.commonService.showToast(p?p.status:0,p&&p.error?.msg?p.error?.msg:`Your photo \u2018${l.stepName}\u2019 failed to upload. Please try to upload again.`),this.currentStep.isAdditionalDocumentFromReviewPageOnly&&(this.currentStep={stepName:"photos"===this.inspection?"Additional Image":"Additional Documents",uploadStatus:"notUploaded",url:"",image:"",index:-1,isAdditionalDocumentFromReviewPageOnly:!0,sizeLimit:this.currentStep.sizeLimit,allowExtension:this.currentStep.allowExtension,mandatory:!1,isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,isMassUpload:l.isMassUpload,templateGuid:this.currentStep.templateGuid,partTemplateGuid:this.currentStep.partTemplateGuid,placeHolderUrl:"/assets/icons/additional-image.svg"})):"success"==i&&(l.uploadInProgress=!1,l.isSkipped=!1,l.isUploadFailed=!1,l.isUploadSuccess=!0,l.uploadStatus="success",l.updatedDate=R().toISOString(),l.uploadedDate=R().toISOString(),l.isAdditionalDocumentFromReviewPageOnly=!1,"photos"===this.inspection&&(l.inspectionItem=C),C&&(l.originalName&&(l.stepName=l.originalName),l.uploadedGuid=C.mediaGuid,l.uploadedPartGuid=C.mediaPartGuid)),this.imageStatusSteps=[...this.imageStatusSteps];const le=this.imageStatusSteps.filter(ce=>!0===ce.uploadInProgress);this.hideback=!0,this.commonService.inProgressSteps.next(le.length)}deleteImage(){this.monitorService.logEvent("deleteImage",["ChqImagesUploaderComponent","addenda-quote"]),this.commonService.openDeleteDialog("image").afterClosed().subscribe(i=>{i&&this.delete()})}uploadFile(){this.monitorService.logEvent("uploadFile",["ChqImagesUploaderComponent","addenda-quote"]),this.chqUpload.triggerUpload()}setCurrentStep(i){this.currentStepIndex=i?.index,this.currentStep=i,-1!==i?.stepName.indexOf("Additional")&&(this.skipButtonModel={...this.skipButtonModel,label:"Skip and Review"}),this.cardSelection.emit(this.currentStep)}skipUpload(){if(this.monitorService.logEvent("skipUpload",["ChqImagesUploaderComponent","addenda-quote"]),this.stepSkipped.emit(),this.currentStepIndex===this.imageStatusSteps.length||0===this.totalAdditionalSteps&&this.currentStepIndex===this.imageStatusSteps.length-1||this.currentStep.isAdditionalDocumentFromReviewPageOnly||this.fromReviewPage){if("photos"===this.inspection&&0!==this.imageStatusSteps.filter(i=>!0!==i.isUploadSuccess&&!i.image&&i.mandatory)?.length)return void this.commonService.showToast(0,`${8===this.imageStatusSteps.filter(i=>i.mandatory)?.length?"All 8":8===this.imageStatusSteps.filter(i=>i.mandatory)?.length} sides images are mandatory and cannot skip to next section.`);this.isReviewSection=!0,this.fromReviewPage=!1}else this.currentStep.isUploadSuccess||(this.currentStep.uploadStatus="skipped"),this.currentStepIndex++,this.currentStep=this.imageStatusSteps[this.currentStepIndex],this.cardSelection.emit(this.currentStep)}goBackToSelection(){const i=this.imageStatusSteps.filter(l=>l.url||l.image).length;if(this.isReviewSection&&i>0)return this.isReviewSection=!1,void(this.isMassUpload&&(this.hideHeader=!0));this.hideHeader=!1,this.backToUpload.emit()}showReview(){this.isReviewSection=!0,this.hideHeader=!1}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(i=>{i&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.footerOptions.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}dragOver(i){i.preventDefault(),i.stopPropagation()}dragLeave(i){i.preventDefault(),i.stopPropagation()}drop(i){i.preventDefault(),i.stopPropagation(),this.chqUpload.handleUpload(i)}ngOnInit(){this.monitorService.logEvent("ngOnInit",["ChqImagesUploaderComponent","addenda-quote"]),this.currentStep=this.imageStatusSteps[this.currentStepIndex];const i=this.imageStatusSteps.find(p=>p.stepName.includes("Additional Document")&&!p.uploadedPartGuid);i&&(i.originalName=i.stepName,i.stepName=i.parentName,i.placeHolderUrl="/assets/icons/additional-image.svg"),this.backButtonModel={...this.backButtonModel,onclick:this.goBackToSelection.bind(this)};for(let p=0;p<this.imageStatusSteps.length;p++)this.imageLoading[this.imageStatusSteps[p].stepName]=!1;this.currentNonReviewSteps=this.imageStatusSteps.filter(p=>!0!==p.isAdditionalDocumentFromReviewPageOnly).length,this.totalAdditionalSteps=this.imageStatusSteps.length-this.currentNonReviewSteps,this.cardSelection.emit(this.currentStep),this.commonService.updatePage("/quote/case/0",this.inspection?this.inspection:"document"),this.imageStatusSteps.filter(p=>p.url).length>0&&(this.isReviewSection=!0,this.hideback=!0),this.skipButtonModel={label:"Skip",type:"outline",onclick:this.skipUpload.bind(this)},this.uploadButtonModel={label:"Upload",type:"primary",icon:"upload",onclick:this.uploadFile.bind(this)},this.header?.isRepairModule&&(this.uploadButtonModel={...this.uploadButtonModel,icon:"",type:"outline"}),this.retakeButton={label:"Retake",type:"primary",icon:"renew",onclick:this.uploadFile.bind(this)},this.deleteButton={label:"Delete",type:"red",icon:"delete",onclick:this.deleteImage.bind(this)}}}return c.\u0275fac=function(i){return new(i||c)(e.Y36(e.sBO),e.Y36(G.v),e.Y36(v.a),e.Y36(w.M),e.Y36(u.gz),e.Y36(u.F0),e.Y36(k.o))},c.\u0275cmp=e.Xpm({type:c,selectors:[["chq-images-uploader"]],viewQuery:function(i,l){if(1&i&&e.Gf(E,5),2&i){let p;e.iGM(p=e.CRH())&&(l.chqUpload=p.first)}},hostBindings:function(i,l){1&i&&e.NdJ("dragover",function(C){return l.dragOver(C)})("dragleave",function(C){return l.dragLeave(C)})("drop",function(C){return l.drop(C)})},inputs:{header:"header",footerOptions:"footerOptions",showReTakeDelete:"showReTakeDelete",isMassUpload:"isMassUpload",inspection:"inspection",inspectionId:"inspectionId",isRepairStage:"isRepairStage",hideAI:"hideAI",minumumImagesRequired:"minumumImagesRequired",maximumImages:"maximumImages",currentAdditionalModeMultiple:"currentAdditionalModeMultiple",fileUploaderService:"fileUploaderService",showNotify:"showNotify",showComplete:"showComplete",activateRepairButton:"activateRepairButton",isRepairComplete:"isRepairComplete",imageStatusSteps:"imageStatusSteps"},outputs:{updateMassUpload:"updateMassUpload",cardSelection:"cardSelection",backToUpload:"backToUpload",handleDeleteAllEvent:"handleDeleteAllEvent",stepSkipped:"stepSkipped",notify:"notify",completeRepair:"completeRepair"},features:[e.TTD],decls:9,vars:19,consts:[[3,"chqModel","hideHeader","hideBack","hideDelete","uploadBackHandler","back",4,"ngIf"],[1,"main-container",3,"ngClass","scroll"],[3,"currentStep","currentPageName","currentFileNumber","isCurrentAdditionalModeMultiple","maxFileAllowed","ngClass","isMultiple","imageOutput"],["chqUpload",""],["class","info-container",4,"ngIf"],["class","vehicle-status-container",4,"ngIf"],["class","mass-upload",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"maximumImages","hideAI","isRepairStage","minimumPhotosRequired","footerOptions","currentAdditionalModeMultiple","isMultipleUpload","inspectionId","header","showComplete","showNotify","isRepairComplete","activateRepairButton","steps","backToUpload","handleDeleteAllEvent","completeRepair","notify","selection",4,"ngIf"],[3,"chqModel","hideHeader","hideBack","hideDelete","uploadBackHandler","back"],[1,"info-container"],[1,"header-div"],[1,"header-label","text-black"],["aria-hidden","false","aria-label","checked icon",3,"svgIcon",4,"ngIf","ngIfElse"],["unchecked",""],[1,"span-container"],[1,"text-dark-gray"],[1,"block-image"],["class","car-image-container",4,"ngIf","ngIfElse"],["serverImage",""],["defaultImage",""],[3,"showLoading"],["aria-hidden","false","aria-label","checked icon",3,"svgIcon"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon"],[1,"car-image-container"],[3,"src","load"],[1,"car-image-container","default-image"],[1,"vehicle-status-container"],[3,"maximumImages","page","steps","isMultipleUpload","selection"],[1,"mass-upload"],["src","assets/icons/no-document.svg"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[4,"chqPermission"],["class","footer-button-wrapper",4,"ngIf"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel"],["class","margin-right",3,"buttonModel",4,"ngIf"],[1,"margin-right",3,"buttonModel"],[3,"maximumImages","hideAI","isRepairStage","minimumPhotosRequired","footerOptions","currentAdditionalModeMultiple","isMultipleUpload","inspectionId","header","showComplete","showNotify","isRepairComplete","activateRepairButton","steps","backToUpload","handleDeleteAllEvent","completeRepair","notify","selection"]],template:function(i,l){1&i&&(e.YNc(0,V,1,4,"chq-step-header",0),e.TgZ(1,"div",1),e.NdJ("scroll",function(){return l.onScroll()}),e.TgZ(2,"chq-upload",2,3),e.NdJ("imageOutput",function(C){return l.handleImageOutput(C)}),e.qZA(),e.YNc(4,d,20,11,"div",4),e.YNc(5,_,2,4,"div",5),e.YNc(6,S,5,3,"div",6),e.YNc(7,ee,5,2,"div",7),e.YNc(8,de,1,14,"chq-review-section",8),e.qZA()),2&i&&(e.Q6J("ngIf",!l.isReviewSection),e.xp6(1),e.Q6J("ngClass",e.WLB(14,se,l.isReviewSection,"photos"!==l.inspection&&(null==l.header?null:l.header.isRepairModule))),e.xp6(1),e.Q6J("currentStep",l.currentStep)("currentPageName",l.inspection)("currentFileNumber",l.nonAdditional)("isCurrentAdditionalModeMultiple",l.currentAdditionalModeMultiple)("maxFileAllowed",l.maximumImages||20)("ngClass",e.VKq(17,ne,null==l.currentStep?null:l.currentStep.uploadInProgress))("isMultiple",l.isMassUpload),e.xp6(2),e.Q6J("ngIf",!l.isReviewSection&&!l.isMassUpload),e.xp6(1),e.Q6J("ngIf",!l.isReviewSection&&!l.isMassUpload),e.xp6(1),e.Q6J("ngIf",!l.isReviewSection&&l.isMassUpload),e.xp6(1),e.Q6J("ngIf",!l.isReviewSection),e.xp6(1),e.Q6J("ngIf",l.isReviewSection))},dependencies:[Q.mk,Q.O5,B.Hw,K.A,P._,h.E,A.Z,D.q,H.F,W.h,j.X$],styles:[".main-container[_ngcontent-%COMP%]{display:flex;border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-white)}.main-container.document-container[_ngcontent-%COMP%]{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;position:relative;border-right:1px solid var(--xa-light-gray);padding:54px 34px}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .header-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .header-div[_ngcontent-%COMP%]   .header-label[_ngcontent-%COMP%]{margin-right:16px}.main-container[_ngcontent-%COMP%]   .span-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;line-height:14px}.main-container[_ngcontent-%COMP%]   .block-image[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:10px;flex:1;justify-content:flex-start;position:relative}.main-container[_ngcontent-%COMP%]   .block-image[_ngcontent-%COMP%]   .car-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:auto;width:auto;max-height:calc(100vh - 482px);max-width:100%}.main-container[_ngcontent-%COMP%]   .vehicle-status-container[_ngcontent-%COMP%]{overflow:auto;z-index:2;border-top-right-radius:8px;border-bottom-right-radius:8px}.main-container[_ngcontent-%COMP%]   chq-review-section[_ngcontent-%COMP%]{flex:1}.no-border[_ngcontent-%COMP%]{border:none;background:transparent}.disabled[_ngcontent-%COMP%]{pointer-events:none}.mass-upload[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex:1;flex-direction:column;width:154px;height:calc(100vh - 295px)}.mass-upload[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:154px}.mass-upload[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:12px;line-height:16px;color:var(--xa-text-ligher-gray)}.no-border.main-container[_ngcontent-%COMP%]{padding-bottom:1.5vw}"]}),c})()},8571:(te,F,r)=>{r.d(F,{q:()=>Q});var e=r(94650),a=r(69751),R=r(4128),N=r(70262),G=r(39646),v=r(83853),w=r(81364),u=r(12484);const k=["upload"];let Q=(()=>{class B{constructor(P,h,A){this.el=P,this.commonService=h,this.monitorService=A,this.imageOutput=new e.vpe,this.maxFileAllowed=20}getFileExtension(P){return P.split(".").pop()}checkFileSize(P){return!(P.size>(this.currentStep?this.currentStep.sizeLimit:v.rs)||P.size<v.fi&&"photos"===this.currentPageName)||(this.monitorService.logEvent("checkFileSize",["ChqUploadComponent","addenda-quote",{message:"invalid file size."}]),!1)}isValidImageFile(P){if(new RegExp("^.*\\.[a-zA-Z]+$","gm").test(P)){const A=P.split(".").pop();return(this.currentStep?this.currentStep.allowExtension:v.m2).includes(A?.toLowerCase())}return!1}triggerUpload(){setTimeout(()=>{this.upload.nativeElement.click()})}resetValue(){setTimeout(()=>{this.upload.nativeElement.value=null})}fileReaderObservable(P){return new a.y(A=>{const D=new FileReader;D.readAsDataURL(P),D.onload=H=>{A.next({image:D.result,fileName:P.name,file:P}),A.complete()}})}handleUpload(P){this.monitorService.logEvent("handleUpload",["ChqUploadComponent","addenda-quote",{event:P}]);const h=P.target.files||P.srcElement.files||P.dataTransfer.files;if(null!==h&&""!==h&&h.length>0)if(this.commonService.showLoading(),this.isMultiple||this.isCurrentAdditionalModeMultiple){if(h.length>this.maxFileAllowed)return this.commonService.showToast(0,`Maximum ${this.maxFileAllowed} files are allowed.`),this.commonService.hideLoading(),void this.resetValue();if(h.length+this.currentFileNumber>this.maxFileAllowed)return this.commonService.showToast(0,`Maximum ${this.maxFileAllowed} files are allowed.`),this.commonService.hideLoading(),void this.resetValue();const A={};let D=0,H=0;for(let E=0;E<h.length;E++)this.isValidImageFile(h[E].name)?this.checkFileSize(h[E])||this.skipFileSizeValidation?A[E]=this.fileReaderObservable(h[E]):H++:D++;if(H>0&&this.commonService.showToast(0,"For an accurate A.I. analysis please upload images which are not smaller than 0.5 MB and do not exceed 5 MB"),D>0&&this.commonService.showToast(0,"Failed to upload file; the format is not supported."),0===Object.keys(A).length)return this.commonService.hideLoading(),void this.resetValue();(0,R.D)(A).pipe((0,N.K)(E=>(0,G.of)(E))).subscribe(E=>{this.commonService.hideLoading(),E&&this.imageOutput.emit(E),this.resetValue()},()=>{this.resetValue(),this.commonService.hideLoading()})}else{if(!this.isValidImageFile(h[0].name))return this.commonService.showToast(0,"Failed to upload file; the format is not supported."),this.commonService.hideLoading(),void this.resetValue();if(!this.checkFileSize(h[0])){let D="For an accurate A.I. analysis please upload image which are not smaller than 0.5 MB and do not exceed 5 MB";return"photos"!==this.currentPageName&&(D="Image is not of the correct size.  Please provide valid file size  (Max : 5 MB)"),this.commonService.showToast(0,D),this.commonService.hideLoading(),void this.resetValue()}const A=new FileReader;A.readAsDataURL(h[0]),A.onload=D=>{this.commonService.hideLoading(),this.resetValue(),this.imageOutput.emit({image:A.result,fileName:h[0].name,file:h[0]})},A.onerror=D=>{this.resetValue(),this.commonService.hideLoading()}}}}return B.\u0275fac=function(P){return new(P||B)(e.Y36(e.SBq),e.Y36(w.v),e.Y36(u.M))},B.\u0275cmp=e.Xpm({type:B,selectors:[["chq-upload"]],viewQuery:function(P,h){if(1&P&&e.Gf(k,5),2&P){let A;e.iGM(A=e.CRH())&&(h.upload=A.first)}},inputs:{currentStep:"currentStep",isMultiple:"isMultiple",isCurrentAdditionalModeMultiple:"isCurrentAdditionalModeMultiple",currentFileNumber:"currentFileNumber",skipFileSizeValidation:"skipFileSizeValidation",currentPageName:"currentPageName",maxFileAllowed:"maxFileAllowed"},outputs:{imageOutput:"imageOutput"},decls:2,vars:1,consts:[["hidden","","type","file","accept","image/png, image/jpg, image/jpeg",3,"multiple","change"],["upload",""]],template:function(P,h){1&P&&(e.TgZ(0,"input",0,1),e.NdJ("change",function(D){return h.handleUpload(D)}),e.qZA()),2&P&&e.Q6J("multiple",h.isMultiple)},encapsulation:2}),B})()}}]);