(self.webpackChunkcar_heal_quote=self.webpackChunkcar_heal_quote||[]).push([[194],{22241:function(t){var e="function"==typeof Float32Array;function n(t,e){return 1-3*e+3*t}function i(t,e){return 3*e-6*t}function o(t){return 3*t}function r(t,e,r){return((n(e,r)*t+i(e,r))*t+o(e))*t}function a(t,e,r){return 3*n(e,r)*t*t+2*i(e,r)*t+o(e)}function s(t){return t}t.exports=function(t,n,i,o){if(!(0<=t&&t<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===n&&i===o)return s;for(var l=e?new Float32Array(11):new Array(11),c=0;c<11;++c)l[c]=r(.1*c,t,i);return function(e){return 0===e?0:1===e?1:r(function(e){for(var n=0,o=1;10!==o&&l[o]<=e;++o)n+=.1;--o;var s=n+(e-l[o])/(l[o+1]-l[o])*.1,c=a(s,t,i);return c>=.001?function(t,e,n,i){for(var o=0;o<4;++o){var s=a(e,n,i);if(0===s)return e;e-=(r(e,n,i)-t)/s}return e}(e,s,t,i):0===c?s:function(t,e,n,i,o){var a,s,l=0;do{(a=r(s=e+(n-e)/2,i,o)-t)>0?n=s:e=s}while(Math.abs(a)>1e-7&&++l<10);return s}(e,n,n+.1,t,i)}(e),n,o)}}},49457:function(t,e){var n;void 0!==(n=(function(){"use strict";function e(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){a(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function n(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(n){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,r=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(t,r,a){var s=o.URL||o.webkitURL,l=document.createElement("a");l.download=r=r||t.name||"download",l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?i(l):n(l.href)?e(t,r,a):i(l,l.target="_blank")):(l.href=s.createObjectURL(t),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(t,o,r){if(o=o||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,r),o);else if(n(t))e(t,o,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){i(a)})}}:function(t,n,i,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,i);var s="application/octet-stream"===t.type,l=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||r)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var t=d.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=t:location=t,a=null},d.readAsDataURL(t)}else{var p=o.URL||o.webkitURL,u=p.createObjectURL(t);a?a.location=u:location.href=u,a=null,setTimeout(function(){p.revokeObjectURL(u)},4e4)}});o.saveAs=a.saveAs=a,t.exports=a}).apply(e,[]))&&(t.exports=n)},23815:function(t,e,n){var i;t=n.nmd(t),(function(){var o,r="Expected a function",a="__lodash_hash_undefined__",s="__lodash_placeholder__",l=1/0,c=9007199254740991,d=4294967295,p=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],u="[object Arguments]",h="[object Array]",g="[object Boolean]",m="[object Date]",v="[object Error]",f="[object Function]",b="[object GeneratorFunction]",_="[object Map]",M="[object Number]",O="[object Object]",y="[object Promise]",C="[object RegExp]",x="[object Set]",P="[object String]",w="[object Symbol]",T="[object WeakMap]",D="[object ArrayBuffer]",S="[object DataView]",I="[object Float32Array]",k="[object Float64Array]",Z="[object Int8Array]",A="[object Int16Array]",q="[object Int32Array]",L="[object Uint8Array]",E="[object Uint8ClampedArray]",R="[object Uint16Array]",j="[object Uint32Array]",F=/\b__p \+= '';/g,N=/\b(__p \+=) '' \+/g,U=/(__e\(.*?\)|\b__t\)) \+\n'';/g,J=/&(?:amp|lt|gt|quot|#39);/g,Y=/[&<>"']/g,B=RegExp(J.source),z=RegExp(Y.source),H=/<%-([\s\S]+?)%>/g,G=/<%([\s\S]+?)%>/g,Q=/<%=([\s\S]+?)%>/g,V=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$=/^\w*$/,W=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,K=/[\\^$.*+?()[\]{}|]/g,X=RegExp(K.source),tt=/^\s+/,et=/\s/,nt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,it=/\{\n\/\* \[wrapped with (.+)\] \*/,ot=/,? & /,rt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,at=/[()=,{}\[\]\/\s]/,st=/\\(\\)?/g,lt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ct=/\w*$/,dt=/^[-+]0x[0-9a-f]+$/i,pt=/^0b[01]+$/i,ut=/^\[object .+?Constructor\]$/,ht=/^0o[0-7]+$/i,gt=/^(?:0|[1-9]\d*)$/,mt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vt=/($^)/,ft=/['\n\r\u2028\u2029\\]/g,bt="\\ud800-\\udfff",_t="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Mt="\\u2700-\\u27bf",Ot="a-z\\xdf-\\xf6\\xf8-\\xff",yt="A-Z\\xc0-\\xd6\\xd8-\\xde",Ct="\\ufe0e\\ufe0f",xt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Pt="["+bt+"]",wt="["+xt+"]",Tt="["+_t+"]",Dt="\\d+",St="["+Mt+"]",It="["+Ot+"]",kt="[^"+bt+xt+Dt+Mt+Ot+yt+"]",Zt="\\ud83c[\\udffb-\\udfff]",At="[^"+bt+"]",qt="(?:\\ud83c[\\udde6-\\uddff]){2}",Lt="[\\ud800-\\udbff][\\udc00-\\udfff]",Et="["+yt+"]",Rt="(?:"+It+"|"+kt+")",jt="(?:"+Et+"|"+kt+")",Ft="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Nt="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Ut="(?:"+Tt+"|"+Zt+")?",Jt="["+Ct+"]?",Yt=Jt+Ut+"(?:\\u200d(?:"+[At,qt,Lt].join("|")+")"+Jt+Ut+")*",Bt="(?:"+[St,qt,Lt].join("|")+")"+Yt,zt="(?:"+[At+Tt+"?",Tt,qt,Lt,Pt].join("|")+")",Ht=RegExp("['\u2019]","g"),Gt=RegExp(Tt,"g"),Qt=RegExp(Zt+"(?="+Zt+")|"+zt+Yt,"g"),Vt=RegExp([Et+"?"+It+"+"+Ft+"(?="+[wt,Et,"$"].join("|")+")",jt+"+"+Nt+"(?="+[wt,Et+Rt,"$"].join("|")+")",Et+"?"+Rt+"+"+Ft,Et+"+"+Nt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Dt,Bt].join("|"),"g"),$t=RegExp("[\\u200d"+bt+_t+Ct+"]"),Wt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Kt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Xt=-1,te={};te[I]=te[k]=te[Z]=te[A]=te[q]=te[L]=te[E]=te[R]=te[j]=!0,te[u]=te[h]=te[D]=te[g]=te[S]=te[m]=te[v]=te[f]=te[_]=te[M]=te[O]=te[C]=te[x]=te[P]=te[T]=!1;var ee={};ee[u]=ee[h]=ee[D]=ee[S]=ee[g]=ee[m]=ee[I]=ee[k]=ee[Z]=ee[A]=ee[q]=ee[_]=ee[M]=ee[O]=ee[C]=ee[x]=ee[P]=ee[w]=ee[L]=ee[E]=ee[R]=ee[j]=!0,ee[v]=ee[f]=ee[T]=!1;var ne={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ie=parseFloat,oe=parseInt,re="object"==typeof global&&global&&global.Object===Object&&global,ae="object"==typeof self&&self&&self.Object===Object&&self,se=re||ae||Function("return this")(),le=e&&!e.nodeType&&e,ce=le&&t&&!t.nodeType&&t,de=ce&&ce.exports===le,pe=de&&re.process,ue=function(){try{return ce&&ce.require&&ce.require("util").types||pe&&pe.binding&&pe.binding("util")}catch(t){}}(),he=ue&&ue.isArrayBuffer,ge=ue&&ue.isDate,me=ue&&ue.isMap,ve=ue&&ue.isRegExp,fe=ue&&ue.isSet,be=ue&&ue.isTypedArray;function _e(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Me(t,e,n,i){for(var o=-1,r=null==t?0:t.length;++o<r;){var a=t[o];e(i,a,n(a),t)}return i}function Oe(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function ye(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Ce(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function xe(t,e){for(var n=-1,i=null==t?0:t.length,o=0,r=[];++n<i;){var a=t[n];e(a,n,t)&&(r[o++]=a)}return r}function Pe(t,e){return!(null==t||!t.length)&&Le(t,e,0)>-1}function we(t,e,n){for(var i=-1,o=null==t?0:t.length;++i<o;)if(n(e,t[i]))return!0;return!1}function Te(t,e){for(var n=-1,i=null==t?0:t.length,o=Array(i);++n<i;)o[n]=e(t[n],n,t);return o}function De(t,e){for(var n=-1,i=e.length,o=t.length;++n<i;)t[o+n]=e[n];return t}function Se(t,e,n,i){var o=-1,r=null==t?0:t.length;for(i&&r&&(n=t[++o]);++o<r;)n=e(n,t[o],o,t);return n}function Ie(t,e,n,i){var o=null==t?0:t.length;for(i&&o&&(n=t[--o]);o--;)n=e(n,t[o],o,t);return n}function ke(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var Ze=Fe("length");function Ae(t,e,n){var i;return n(t,function(t,n,o){if(e(t,n,o))return i=n,!1}),i}function qe(t,e,n,i){for(var o=t.length,r=n+(i?1:-1);i?r--:++r<o;)if(e(t[r],r,t))return r;return-1}function Le(t,e,n){return e==e?function(t,e,n){for(var i=n-1,o=t.length;++i<o;)if(t[i]===e)return i;return-1}(t,e,n):qe(t,Re,n)}function Ee(t,e,n,i){for(var o=n-1,r=t.length;++o<r;)if(i(t[o],e))return o;return-1}function Re(t){return t!=t}function je(t,e){var n=null==t?0:t.length;return n?Je(t,e)/n:NaN}function Fe(t){return function(e){return null==e?o:e[t]}}function Ne(t){return function(e){return null==t?o:t[e]}}function Ue(t,e,n,i,o){return o(t,function(t,o,r){n=i?(i=!1,t):e(n,t,o,r)}),n}function Je(t,e){for(var n,i=-1,r=t.length;++i<r;){var a=e(t[i]);a!==o&&(n=n===o?a:n+a)}return n}function Ye(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function Be(t){return t&&t.slice(0,ln(t)+1).replace(tt,"")}function ze(t){return function(e){return t(e)}}function He(t,e){return Te(e,function(e){return t[e]})}function Ge(t,e){return t.has(e)}function Qe(t,e){for(var n=-1,i=t.length;++n<i&&Le(e,t[n],0)>-1;);return n}function Ve(t,e){for(var n=t.length;n--&&Le(e,t[n],0)>-1;);return n}function $e(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}var We=Ne({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),Ke=Ne({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Xe(t){return"\\"+ne[t]}function tn(t){return $t.test(t)}function en(t){var e=-1,n=Array(t.size);return t.forEach(function(t,i){n[++e]=[i,t]}),n}function nn(t,e){return function(n){return t(e(n))}}function on(t,e){for(var n=-1,i=t.length,o=0,r=[];++n<i;){var a=t[n];(a===e||a===s)&&(t[n]=s,r[o++]=n)}return r}function rn(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function an(t){return tn(t)?function(t){for(var e=Qt.lastIndex=0;Qt.test(t);)++e;return e}(t):Ze(t)}function sn(t){return tn(t)?function(t){return t.match(Qt)||[]}(t):function(t){return t.split("")}(t)}function ln(t){for(var e=t.length;e--&&et.test(t.charAt(e)););return e}var cn=Ne({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),dn=function t(e){var n,i=(e=null==e?se:dn.defaults(se.Object(),e,dn.pick(se,Kt))).Array,et=e.Date,bt=e.Error,_t=e.Function,Mt=e.Math,Ot=e.Object,yt=e.RegExp,Ct=e.String,xt=e.TypeError,Pt=i.prototype,wt=Ot.prototype,Tt=e["__core-js_shared__"],Dt=_t.prototype.toString,St=wt.hasOwnProperty,It=0,kt=(n=/[^.]+$/.exec(Tt&&Tt.keys&&Tt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Zt=wt.toString,At=Dt.call(Ot),qt=se._,Lt=yt("^"+Dt.call(St).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Et=de?e.Buffer:o,Rt=e.Symbol,jt=e.Uint8Array,Ft=Et?Et.allocUnsafe:o,Nt=nn(Ot.getPrototypeOf,Ot),Ut=Ot.create,Jt=wt.propertyIsEnumerable,Yt=Pt.splice,Bt=Rt?Rt.isConcatSpreadable:o,zt=Rt?Rt.iterator:o,Qt=Rt?Rt.toStringTag:o,$t=function(){try{var t=rr(Ot,"defineProperty");return t({},"",{}),t}catch(Ir){}}(),ne=e.clearTimeout!==se.clearTimeout&&e.clearTimeout,re=et&&et.now!==se.Date.now&&et.now,ae=e.setTimeout!==se.setTimeout&&e.setTimeout,le=Mt.ceil,ce=Mt.floor,pe=Ot.getOwnPropertySymbols,ue=Et?Et.isBuffer:o,Ze=e.isFinite,Ne=Pt.join,pn=nn(Ot.keys,Ot),un=Mt.max,hn=Mt.min,gn=et.now,mn=e.parseInt,vn=Mt.random,fn=Pt.reverse,bn=rr(e,"DataView"),_n=rr(e,"Map"),Mn=rr(e,"Promise"),On=rr(e,"Set"),yn=rr(e,"WeakMap"),Cn=rr(Ot,"create"),xn=yn&&new yn,Pn={},wn=qr(bn),Tn=qr(_n),Dn=qr(Mn),Sn=qr(On),In=qr(yn),kn=Rt?Rt.prototype:o,Zn=kn?kn.valueOf:o,An=kn?kn.toString:o;function qn(t){if(Wa(t)&&!Na(t)&&!(t instanceof jn)){if(t instanceof Rn)return t;if(St.call(t,"__wrapped__"))return Lr(t)}return new Rn(t)}var Ln=function(){function t(){}return function(e){if(!$a(e))return{};if(Ut)return Ut(e);t.prototype=e;var n=new t;return t.prototype=o,n}}();function En(){}function Rn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function jn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function Fn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Nn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Un(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Jn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Un;++e<n;)this.add(t[e])}function Yn(t){var e=this.__data__=new Nn(t);this.size=e.size}function Bn(t,e){var n=Na(t),i=!n&&Fa(t),o=!n&&!i&&Ba(t),r=!n&&!i&&!o&&rs(t),a=n||i||o||r,s=a?Ye(t.length,Ct):[],l=s.length;for(var c in t)(e||St.call(t,c))&&(!a||!("length"==c||o&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ur(c,l)))&&s.push(c);return s}function zn(t){var e=t.length;return e?t[Ui(0,e-1)]:o}function Hn(t,e){return Sr(Co(t),ei(e,0,t.length))}function Gn(t){return Sr(Co(t))}function Qn(t,e,n){(n!==o&&!Ea(t[e],n)||n===o&&!(e in t))&&Xn(t,e,n)}function Vn(t,e,n){var i=t[e];(!St.call(t,e)||!Ea(i,n)||n===o&&!(e in t))&&Xn(t,e,n)}function $n(t,e){for(var n=t.length;n--;)if(Ea(t[n][0],e))return n;return-1}function Wn(t,e,n,i){return ai(t,function(t,o,r){e(i,t,n(t),r)}),i}function Kn(t,e){return t&&xo(e,Ts(e),t)}function Xn(t,e,n){"__proto__"==e&&$t?$t(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ti(t,e){for(var n=-1,r=e.length,a=i(r),s=null==t;++n<r;)a[n]=s?o:ys(t,e[n]);return a}function ei(t,e,n){return t==t&&(n!==o&&(t=t<=n?t:n),e!==o&&(t=t>=e?t:e)),t}function ni(t,e,n,i,r,a){var s,l=1&e,c=2&e,d=4&e;if(n&&(s=r?n(t,i,r,a):n(t)),s!==o)return s;if(!$a(t))return t;var p=Na(t);if(p){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&St.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!l)return Co(t,s)}else{var h=lr(t),v=h==f||h==b;if(Ba(t))return fo(t,l);if(h==O||h==u||v&&!r){if(s=c||v?{}:dr(t),!l)return c?function(t,e){return xo(t,sr(t),e)}(t,function(t,e){return t&&xo(e,Ds(e),t)}(s,t)):function(t,e){return xo(t,ar(t),e)}(t,Kn(s,t))}else{if(!ee[h])return r?t:{};s=function(t,e,n){var i=t.constructor;switch(e){case D:return bo(t);case g:case m:return new i(+t);case S:return function(t,e){var n=e?bo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case I:case k:case Z:case A:case q:case L:case E:case R:case j:return _o(t,n);case _:return new i;case M:case P:return new i(t);case C:return function(t){var e=new t.constructor(t.source,ct.exec(t));return e.lastIndex=t.lastIndex,e}(t);case x:return new i;case w:return function(t){return Zn?Ot(Zn.call(t)):{}}(t)}}(t,h,l)}}a||(a=new Yn);var y=a.get(t);if(y)return y;a.set(t,s),ns(t)?t.forEach(function(i){s.add(ni(i,e,n,i,t,a))}):Ka(t)&&t.forEach(function(i,o){s.set(o,ni(i,e,n,o,t,a))});var T=p?o:(d?c?Ko:Wo:c?Ds:Ts)(t);return Oe(T||t,function(i,o){T&&(i=t[o=i]),Vn(s,o,ni(i,e,n,o,t,a))}),s}function ii(t,e,n){var i=n.length;if(null==t)return!i;for(t=Ot(t);i--;){var r=n[i],a=t[r];if(a===o&&!(r in t)||!(0,e[r])(a))return!1}return!0}function oi(t,e,n){if("function"!=typeof t)throw new xt(r);return Pr(function(){t.apply(o,n)},e)}function ri(t,e,n,i){var o=-1,r=Pe,a=!0,s=t.length,l=[],c=e.length;if(!s)return l;n&&(e=Te(e,ze(n))),i?(r=we,a=!1):e.length>=200&&(r=Ge,a=!1,e=new Jn(e));t:for(;++o<s;){var d=t[o],p=null==n?d:n(d);if(d=i||0!==d?d:0,a&&p==p){for(var u=c;u--;)if(e[u]===p)continue t;l.push(d)}else r(e,p,i)||l.push(d)}return l}qn.templateSettings={escape:H,evaluate:G,interpolate:Q,variable:"",imports:{_:qn}},(qn.prototype=En.prototype).constructor=qn,(Rn.prototype=Ln(En.prototype)).constructor=Rn,(jn.prototype=Ln(En.prototype)).constructor=jn,Fn.prototype.clear=function(){this.__data__=Cn?Cn(null):{},this.size=0},Fn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Fn.prototype.get=function(t){var e=this.__data__;if(Cn){var n=e[t];return n===a?o:n}return St.call(e,t)?e[t]:o},Fn.prototype.has=function(t){var e=this.__data__;return Cn?e[t]!==o:St.call(e,t)},Fn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Cn&&e===o?a:e,this},Nn.prototype.clear=function(){this.__data__=[],this.size=0},Nn.prototype.delete=function(t){var e=this.__data__,n=$n(e,t);return!(n<0||(n==e.length-1?e.pop():Yt.call(e,n,1),--this.size,0))},Nn.prototype.get=function(t){var e=this.__data__,n=$n(e,t);return n<0?o:e[n][1]},Nn.prototype.has=function(t){return $n(this.__data__,t)>-1},Nn.prototype.set=function(t,e){var n=this.__data__,i=$n(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},Un.prototype.clear=function(){this.size=0,this.__data__={hash:new Fn,map:new(_n||Nn),string:new Fn}},Un.prototype.delete=function(t){var e=ir(this,t).delete(t);return this.size-=e?1:0,e},Un.prototype.get=function(t){return ir(this,t).get(t)},Un.prototype.has=function(t){return ir(this,t).has(t)},Un.prototype.set=function(t,e){var n=ir(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},Jn.prototype.add=Jn.prototype.push=function(t){return this.__data__.set(t,a),this},Jn.prototype.has=function(t){return this.__data__.has(t)},Yn.prototype.clear=function(){this.__data__=new Nn,this.size=0},Yn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Yn.prototype.get=function(t){return this.__data__.get(t)},Yn.prototype.has=function(t){return this.__data__.has(t)},Yn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Nn){var i=n.__data__;if(!_n||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Un(i)}return n.set(t,e),this.size=n.size,this};var ai=To(gi),si=To(mi,!0);function li(t,e){var n=!0;return ai(t,function(t,i,o){return n=!!e(t,i,o)}),n}function ci(t,e,n){for(var i=-1,r=t.length;++i<r;){var a=t[i],s=e(a);if(null!=s&&(l===o?s==s&&!os(s):n(s,l)))var l=s,c=a}return c}function di(t,e){var n=[];return ai(t,function(t,i,o){e(t,i,o)&&n.push(t)}),n}function pi(t,e,n,i,o){var r=-1,a=t.length;for(n||(n=pr),o||(o=[]);++r<a;){var s=t[r];e>0&&n(s)?e>1?pi(s,e-1,n,i,o):De(o,s):i||(o[o.length]=s)}return o}var ui=Do(),hi=Do(!0);function gi(t,e){return t&&ui(t,e,Ts)}function mi(t,e){return t&&hi(t,e,Ts)}function vi(t,e){return xe(e,function(e){return Ga(t[e])})}function fi(t,e){for(var n=0,i=(e=ho(e,t)).length;null!=t&&n<i;)t=t[Ar(e[n++])];return n&&n==i?t:o}function bi(t,e,n){var i=e(t);return Na(t)?i:De(i,n(t))}function _i(t){return null==t?t===o?"[object Undefined]":"[object Null]":Qt&&Qt in Ot(t)?function(t){var e=St.call(t,Qt),n=t[Qt];try{t[Qt]=o;var i=!0}catch(a){}var r=Zt.call(t);return i&&(e?t[Qt]=n:delete t[Qt]),r}(t):function(t){return Zt.call(t)}(t)}function Mi(t,e){return t>e}function Oi(t,e){return null!=t&&St.call(t,e)}function yi(t,e){return null!=t&&e in Ot(t)}function Ci(t,e,n){for(var r=n?we:Pe,a=t[0].length,s=t.length,l=s,c=i(s),d=1/0,p=[];l--;){var u=t[l];l&&e&&(u=Te(u,ze(e))),d=hn(u.length,d),c[l]=!n&&(e||a>=120&&u.length>=120)?new Jn(l&&u):o}u=t[0];var h=-1,g=c[0];t:for(;++h<a&&p.length<d;){var m=u[h],v=e?e(m):m;if(m=n||0!==m?m:0,!(g?Ge(g,v):r(p,v,n))){for(l=s;--l;){var f=c[l];if(!(f?Ge(f,v):r(t[l],v,n)))continue t}g&&g.push(v),p.push(m)}}return p}function xi(t,e,n){var i=null==(t=Or(t,e=ho(e,t)))?t:t[Ar(Hr(e))];return null==i?o:_e(i,t,n)}function Pi(t){return Wa(t)&&_i(t)==u}function wi(t,e,n,i,r){return t===e||(null==t||null==e||!Wa(t)&&!Wa(e)?t!=t&&e!=e:function(t,e,n,i,r,a){var s=Na(t),l=Na(e),c=s?h:lr(t),d=l?h:lr(e),p=(c=c==u?O:c)==O,f=(d=d==u?O:d)==O,b=c==d;if(b&&Ba(t)){if(!Ba(e))return!1;s=!0,p=!1}if(b&&!p)return a||(a=new Yn),s||rs(t)?Vo(t,e,n,i,r,a):function(t,e,n,i,o,r,a){switch(n){case S:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case D:return!(t.byteLength!=e.byteLength||!r(new jt(t),new jt(e)));case g:case m:case M:return Ea(+t,+e);case v:return t.name==e.name&&t.message==e.message;case C:case P:return t==e+"";case _:var s=en;case x:if(s||(s=rn),t.size!=e.size&&!(1&i))return!1;var l=a.get(t);if(l)return l==e;i|=2,a.set(t,e);var c=Vo(s(t),s(e),i,o,r,a);return a.delete(t),c;case w:if(Zn)return Zn.call(t)==Zn.call(e)}return!1}(t,e,c,n,i,r,a);if(!(1&n)){var y=p&&St.call(t,"__wrapped__"),T=f&&St.call(e,"__wrapped__");if(y||T){var I=y?t.value():t,k=T?e.value():e;return a||(a=new Yn),r(I,k,n,i,a)}}return!!b&&(a||(a=new Yn),function(t,e,n,i,r,a){var s=1&n,l=Wo(t),c=l.length;if(c!=Wo(e).length&&!s)return!1;for(var d=c;d--;){var p=l[d];if(!(s?p in e:St.call(e,p)))return!1}var u=a.get(t),h=a.get(e);if(u&&h)return u==e&&h==t;var g=!0;a.set(t,e),a.set(e,t);for(var m=s;++d<c;){var v=t[p=l[d]],f=e[p];if(i)var b=s?i(f,v,p,e,t,a):i(v,f,p,t,e,a);if(!(b===o?v===f||r(v,f,n,i,a):b)){g=!1;break}m||(m="constructor"==p)}if(g&&!m){var _=t.constructor,M=e.constructor;_!=M&&"constructor"in t&&"constructor"in e&&!("function"==typeof _&&_ instanceof _&&"function"==typeof M&&M instanceof M)&&(g=!1)}return a.delete(t),a.delete(e),g}(t,e,n,i,r,a))}(t,e,n,i,wi,r))}function Ti(t,e,n,i){var r=n.length,a=r,s=!i;if(null==t)return!a;for(t=Ot(t);r--;){var l=n[r];if(s&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++r<a;){var c=(l=n[r])[0],d=t[c],p=l[1];if(s&&l[2]){if(d===o&&!(c in t))return!1}else{var u=new Yn;if(i)var h=i(d,p,c,t,e,u);if(!(h===o?wi(p,d,3,i,u):h))return!1}}return!0}function Di(t){return!(!$a(t)||function(t){return!!kt&&kt in t}(t))&&(Ga(t)?Lt:ut).test(qr(t))}function Si(t){return"function"==typeof t?t:null==t?Xs:"object"==typeof t?Na(t)?qi(t[0],t[1]):Ai(t):ll(t)}function Ii(t){if(!fr(t))return pn(t);var e=[];for(var n in Ot(t))St.call(t,n)&&"constructor"!=n&&e.push(n);return e}function ki(t,e){return t<e}function Zi(t,e){var n=-1,o=Ja(t)?i(t.length):[];return ai(t,function(t,i,r){o[++n]=e(t,i,r)}),o}function Ai(t){var e=or(t);return 1==e.length&&e[0][2]?_r(e[0][0],e[0][1]):function(n){return n===t||Ti(n,t,e)}}function qi(t,e){return gr(t)&&br(e)?_r(Ar(t),e):function(n){var i=ys(n,t);return i===o&&i===e?Cs(n,t):wi(e,i,3)}}function Li(t,e,n,i,r){t!==e&&ui(e,function(a,s){if(r||(r=new Yn),$a(a))!function(t,e,n,i,r,a,s){var l=Cr(t,n),c=Cr(e,n),d=s.get(c);if(d)Qn(t,n,d);else{var p=a?a(l,c,n+"",t,e,s):o,u=p===o;if(u){var h=Na(c),g=!h&&Ba(c),m=!h&&!g&&rs(c);p=c,h||g||m?Na(l)?p=l:Ya(l)?p=Co(l):g?(u=!1,p=fo(c,!0)):m?(u=!1,p=_o(c,!0)):p=[]:ts(c)||Fa(c)?(p=l,Fa(l)?p=hs(l):(!$a(l)||Ga(l))&&(p=dr(c))):u=!1}u&&(s.set(c,p),r(p,c,i,a,s),s.delete(c)),Qn(t,n,p)}}(t,e,s,n,Li,i,r);else{var l=i?i(Cr(t,s),a,s+"",t,e,r):o;l===o&&(l=a),Qn(t,s,l)}},Ds)}function Ei(t,e){var n=t.length;if(n)return ur(e+=e<0?n:0,n)?t[e]:o}function Ri(t,e,n){e=e.length?Te(e,function(t){return Na(t)?function(e){return fi(e,1===t.length?t[0]:t)}:t}):[Xs];var i=-1;return e=Te(e,ze(nr())),function(t,e){var i=t.length;for(t.sort(function(t,e){return function(t,e,n){for(var i=-1,o=t.criteria,r=e.criteria,a=o.length,s=n.length;++i<a;){var l=Mo(o[i],r[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return t.index-e.index}(t,e,n)});i--;)t[i]=t[i].value;return t}(Zi(t,function(t,n,o){return{criteria:Te(e,function(e){return e(t)}),index:++i,value:t}}))}function ji(t,e,n){for(var i=-1,o=e.length,r={};++i<o;){var a=e[i],s=fi(t,a);n(s,a)&&Hi(r,ho(a,t),s)}return r}function Fi(t,e,n,i){var o=i?Ee:Le,r=-1,a=e.length,s=t;for(t===e&&(e=Co(e)),n&&(s=Te(t,ze(n)));++r<a;)for(var l=0,c=e[r],d=n?n(c):c;(l=o(s,d,l,i))>-1;)s!==t&&Yt.call(s,l,1),Yt.call(t,l,1);return t}function Ni(t,e){for(var n=t?e.length:0,i=n-1;n--;){var o=e[n];if(n==i||o!==r){var r=o;ur(o)?Yt.call(t,o,1):oo(t,o)}}return t}function Ui(t,e){return t+ce(vn()*(e-t+1))}function Ji(t,e){var n="";if(!t||e<1||e>c)return n;do{e%2&&(n+=t),(e=ce(e/2))&&(t+=t)}while(e);return n}function Yi(t,e){return wr(Mr(t,e,Xs),t+"")}function Bi(t){return zn(Es(t))}function zi(t,e){var n=Es(t);return Sr(n,ei(e,0,n.length))}function Hi(t,e,n,i){if(!$a(t))return t;for(var r=-1,a=(e=ho(e,t)).length,s=a-1,l=t;null!=l&&++r<a;){var c=Ar(e[r]),d=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(r!=s){var p=l[c];(d=i?i(p,c,l):o)===o&&(d=$a(p)?p:ur(e[r+1])?[]:{})}Vn(l,c,d),l=l[c]}return t}var Gi=xn?function(t,e){return xn.set(t,e),t}:Xs,Qi=$t?function(t,e){return $t(t,"toString",{configurable:!0,enumerable:!1,value:$s(e),writable:!0})}:Xs;function Vi(t){return Sr(Es(t))}function $i(t,e,n){var o=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(n=n>r?r:n)<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var a=i(r);++o<r;)a[o]=t[o+e];return a}function Wi(t,e){var n;return ai(t,function(t,i,o){return!(n=e(t,i,o))}),!!n}function Ki(t,e,n){var i=0,o=null==t?i:t.length;if("number"==typeof e&&e==e&&o<=2147483647){for(;i<o;){var r=i+o>>>1,a=t[r];null!==a&&!os(a)&&(n?a<=e:a<e)?i=r+1:o=r}return o}return Xi(t,e,Xs,n)}function Xi(t,e,n,i){var r=0,a=null==t?0:t.length;if(0===a)return 0;for(var s=(e=n(e))!=e,l=null===e,c=os(e),d=e===o;r<a;){var p=ce((r+a)/2),u=n(t[p]),h=u!==o,g=null===u,m=u==u,v=os(u);if(s)var f=i||m;else f=d?m&&(i||h):l?m&&h&&(i||!g):c?m&&h&&!g&&(i||!v):!g&&!v&&(i?u<=e:u<e);f?r=p+1:a=p}return hn(a,4294967294)}function to(t,e){for(var n=-1,i=t.length,o=0,r=[];++n<i;){var a=t[n],s=e?e(a):a;if(!n||!Ea(s,l)){var l=s;r[o++]=0===a?0:a}}return r}function eo(t){return"number"==typeof t?t:os(t)?NaN:+t}function no(t){if("string"==typeof t)return t;if(Na(t))return Te(t,no)+"";if(os(t))return An?An.call(t):"";var e=t+"";return"0"==e&&1/t==-l?"-0":e}function io(t,e,n){var i=-1,o=Pe,r=t.length,a=!0,s=[],l=s;if(n)a=!1,o=we;else if(r>=200){var c=e?null:Yo(t);if(c)return rn(c);a=!1,o=Ge,l=new Jn}else l=e?[]:s;t:for(;++i<r;){var d=t[i],p=e?e(d):d;if(d=n||0!==d?d:0,a&&p==p){for(var u=l.length;u--;)if(l[u]===p)continue t;e&&l.push(p),s.push(d)}else o(l,p,n)||(l!==s&&l.push(p),s.push(d))}return s}function oo(t,e){return null==(t=Or(t,e=ho(e,t)))||delete t[Ar(Hr(e))]}function ro(t,e,n,i){return Hi(t,e,n(fi(t,e)),i)}function ao(t,e,n,i){for(var o=t.length,r=i?o:-1;(i?r--:++r<o)&&e(t[r],r,t););return n?$i(t,i?0:r,i?r+1:o):$i(t,i?r+1:0,i?o:r)}function so(t,e){var n=t;return n instanceof jn&&(n=n.value()),Se(e,function(t,e){return e.func.apply(e.thisArg,De([t],e.args))},n)}function lo(t,e,n){var o=t.length;if(o<2)return o?io(t[0]):[];for(var r=-1,a=i(o);++r<o;)for(var s=t[r],l=-1;++l<o;)l!=r&&(a[r]=ri(a[r]||s,t[l],e,n));return io(pi(a,1),e,n)}function co(t,e,n){for(var i=-1,r=t.length,a=e.length,s={};++i<r;)n(s,t[i],i<a?e[i]:o);return s}function po(t){return Ya(t)?t:[]}function uo(t){return"function"==typeof t?t:Xs}function ho(t,e){return Na(t)?t:gr(t,e)?[t]:Zr(gs(t))}var go=Yi;function mo(t,e,n){var i=t.length;return n=n===o?i:n,!e&&n>=i?t:$i(t,e,n)}var vo=ne||function(t){return se.clearTimeout(t)};function fo(t,e){if(e)return t.slice();var n=t.length,i=Ft?Ft(n):new t.constructor(n);return t.copy(i),i}function bo(t){var e=new t.constructor(t.byteLength);return new jt(e).set(new jt(t)),e}function _o(t,e){var n=e?bo(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Mo(t,e){if(t!==e){var n=t!==o,i=null===t,r=t==t,a=os(t),s=e!==o,l=null===e,c=e==e,d=os(e);if(!l&&!d&&!a&&t>e||a&&s&&c&&!l&&!d||i&&s&&c||!n&&c||!r)return 1;if(!i&&!a&&!d&&t<e||d&&n&&r&&!i&&!a||l&&n&&r||!s&&r||!c)return-1}return 0}function Oo(t,e,n,o){for(var r=-1,a=t.length,s=n.length,l=-1,c=e.length,d=un(a-s,0),p=i(c+d),u=!o;++l<c;)p[l]=e[l];for(;++r<s;)(u||r<a)&&(p[n[r]]=t[r]);for(;d--;)p[l++]=t[r++];return p}function yo(t,e,n,o){for(var r=-1,a=t.length,s=-1,l=n.length,c=-1,d=e.length,p=un(a-l,0),u=i(p+d),h=!o;++r<p;)u[r]=t[r];for(var g=r;++c<d;)u[g+c]=e[c];for(;++s<l;)(h||r<a)&&(u[g+n[s]]=t[r++]);return u}function Co(t,e){var n=-1,o=t.length;for(e||(e=i(o));++n<o;)e[n]=t[n];return e}function xo(t,e,n,i){var r=!n;n||(n={});for(var a=-1,s=e.length;++a<s;){var l=e[a],c=i?i(n[l],t[l],l,n,t):o;c===o&&(c=t[l]),r?Xn(n,l,c):Vn(n,l,c)}return n}function Po(t,e){return function(n,i){var o=Na(n)?Me:Wn,r=e?e():{};return o(n,t,nr(i,2),r)}}function wo(t){return Yi(function(e,n){var i=-1,r=n.length,a=r>1?n[r-1]:o,s=r>2?n[2]:o;for(a=t.length>3&&"function"==typeof a?(r--,a):o,s&&hr(n[0],n[1],s)&&(a=r<3?o:a,r=1),e=Ot(e);++i<r;){var l=n[i];l&&t(e,l,i,a)}return e})}function To(t,e){return function(n,i){if(null==n)return n;if(!Ja(n))return t(n,i);for(var o=n.length,r=e?o:-1,a=Ot(n);(e?r--:++r<o)&&!1!==i(a[r],r,a););return n}}function Do(t){return function(e,n,i){for(var o=-1,r=Ot(e),a=i(e),s=a.length;s--;){var l=a[t?s:++o];if(!1===n(r[l],l,r))break}return e}}function So(t){return function(e){var n=tn(e=gs(e))?sn(e):o,i=n?n[0]:e.charAt(0),r=n?mo(n,1).join(""):e.slice(1);return i[t]()+r}}function Io(t){return function(e){return Se(Gs(Fs(e).replace(Ht,"")),t,"")}}function ko(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Ln(t.prototype),i=t.apply(n,e);return $a(i)?i:n}}function Zo(t){return function(e,n,i){var r=Ot(e);if(!Ja(e)){var a=nr(n,3);e=Ts(e),n=function(t){return a(r[t],t,r)}}var s=t(e,n,i);return s>-1?r[a?e[s]:s]:o}}function Ao(t){return $o(function(e){var n=e.length,i=n,a=Rn.prototype.thru;for(t&&e.reverse();i--;){var s=e[i];if("function"!=typeof s)throw new xt(r);if(a&&!l&&"wrapper"==tr(s))var l=new Rn([],!0)}for(i=l?i:n;++i<n;){var c=tr(s=e[i]),d="wrapper"==c?Xo(s):o;l=d&&mr(d[0])&&424==d[1]&&!d[4].length&&1==d[9]?l[tr(d[0])].apply(l,d[3]):1==s.length&&mr(s)?l[c]():l.thru(s)}return function(){var t=arguments,i=t[0];if(l&&1==t.length&&Na(i))return l.plant(i).value();for(var o=0,r=n?e[o].apply(this,t):i;++o<n;)r=e[o].call(this,r);return r}})}function qo(t,e,n,r,a,s,l,c,d,p){var u=128&e,h=1&e,g=2&e,m=24&e,v=512&e,f=g?o:ko(t);return function o(){for(var b=arguments.length,_=i(b),M=b;M--;)_[M]=arguments[M];if(m)var O=er(o),y=$e(_,O);if(r&&(_=Oo(_,r,a,m)),s&&(_=yo(_,s,l,m)),b-=y,m&&b<p){var C=on(_,O);return Uo(t,e,qo,o.placeholder,n,_,C,c,d,p-b)}var x=h?n:this,P=g?x[t]:t;return b=_.length,c?_=yr(_,c):v&&b>1&&_.reverse(),u&&d<b&&(_.length=d),this&&this!==se&&this instanceof o&&(P=f||ko(P)),P.apply(x,_)}}function Lo(t,e){return function(n,i){return function(t,e,n,i){return gi(t,function(t,o,r){e(i,n(t),o,r)}),i}(n,t,e(i),{})}}function Eo(t,e){return function(n,i){var r;if(n===o&&i===o)return e;if(n!==o&&(r=n),i!==o){if(r===o)return i;"string"==typeof n||"string"==typeof i?(n=no(n),i=no(i)):(n=eo(n),i=eo(i)),r=t(n,i)}return r}}function Ro(t){return $o(function(e){return e=Te(e,ze(nr())),Yi(function(n){var i=this;return t(e,function(t){return _e(t,i,n)})})})}function jo(t,e){var n=(e=e===o?" ":no(e)).length;if(n<2)return n?Ji(e,t):e;var i=Ji(e,le(t/an(e)));return tn(e)?mo(sn(i),0,t).join(""):i.slice(0,t)}function Fo(t){return function(e,n,r){return r&&"number"!=typeof r&&hr(e,n,r)&&(n=r=o),e=cs(e),n===o?(n=e,e=0):n=cs(n),function(t,e,n,o){for(var r=-1,a=un(le((e-t)/(n||1)),0),s=i(a);a--;)s[o?a:++r]=t,t+=n;return s}(e,n,r=r===o?e<n?1:-1:cs(r),t)}}function No(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=us(e),n=us(n)),t(e,n)}}function Uo(t,e,n,i,r,a,s,l,c,d){var p=8&e;e|=p?32:64,4&(e&=~(p?64:32))||(e&=-4);var u=[t,e,r,p?a:o,p?s:o,p?o:a,p?o:s,l,c,d],h=n.apply(o,u);return mr(t)&&xr(h,u),h.placeholder=i,Tr(h,t,e)}function Jo(t){var e=Mt[t];return function(t,n){if(t=us(t),(n=null==n?0:hn(ds(n),292))&&Ze(t)){var i=(gs(t)+"e").split("e");return+((i=(gs(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return e(t)}}var Yo=On&&1/rn(new On([,-0]))[1]==l?function(t){return new On(t)}:ol;function Bo(t){return function(e){var n=lr(e);return n==_?en(e):n==x?function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}(e):function(t,e){return Te(e,function(e){return[e,t[e]]})}(e,t(e))}}function zo(t,e,n,a,l,c,d,p){var u=2&e;if(!u&&"function"!=typeof t)throw new xt(r);var h=a?a.length:0;if(h||(e&=-97,a=l=o),d=d===o?d:un(ds(d),0),p=p===o?p:ds(p),h-=l?l.length:0,64&e){var g=a,m=l;a=l=o}var v=u?o:Xo(t),f=[t,e,n,a,l,g,m,c,d,p];if(v&&function(t,e){var n=t[1],i=e[1],o=n|i;if(!(o<131||(128==i&&8==n||128==i&&256==n&&t[7].length<=e[8]||384==i&&e[7].length<=e[8]&&8==n)))return t;1&i&&(t[2]=e[2],o|=1&n?0:4);var r=e[3];if(r){var a=t[3];t[3]=a?Oo(a,r,e[4]):r,t[4]=a?on(t[3],s):e[4]}(r=e[5])&&(t[5]=(a=t[5])?yo(a,r,e[6]):r,t[6]=a?on(t[5],s):e[6]),(r=e[7])&&(t[7]=r),128&i&&(t[8]=null==t[8]?e[8]:hn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=o}(f,v),t=f[0],e=f[1],n=f[2],a=f[3],l=f[4],!(p=f[9]=f[9]===o?u?0:t.length:un(f[9]-h,0))&&24&e&&(e&=-25),e&&1!=e)b=8==e||16==e?function(t,e,n){var r=ko(t);return function a(){for(var s=arguments.length,l=i(s),c=s,d=er(a);c--;)l[c]=arguments[c];var p=s<3&&l[0]!==d&&l[s-1]!==d?[]:on(l,d);return(s-=p.length)<n?Uo(t,e,qo,a.placeholder,o,l,p,o,o,n-s):_e(this&&this!==se&&this instanceof a?r:t,this,l)}}(t,e,p):32!=e&&33!=e||l.length?qo.apply(o,f):function(t,e,n,o){var r=1&e,a=ko(t);return function e(){for(var s=-1,l=arguments.length,c=-1,d=o.length,p=i(d+l),u=this&&this!==se&&this instanceof e?a:t;++c<d;)p[c]=o[c];for(;l--;)p[c++]=arguments[++s];return _e(u,r?n:this,p)}}(t,e,n,a);else var b=function(t,e,n){var i=1&e,o=ko(t);return function e(){return(this&&this!==se&&this instanceof e?o:t).apply(i?n:this,arguments)}}(t,e,n);return Tr((v?Gi:xr)(b,f),t,e)}function Ho(t,e,n,i){return t===o||Ea(t,wt[n])&&!St.call(i,n)?e:t}function Go(t,e,n,i,r,a){return $a(t)&&$a(e)&&(a.set(e,t),Li(t,e,o,Go,a),a.delete(e)),t}function Qo(t){return ts(t)?o:t}function Vo(t,e,n,i,r,a){var s=1&n,l=t.length,c=e.length;if(l!=c&&!(s&&c>l))return!1;var d=a.get(t),p=a.get(e);if(d&&p)return d==e&&p==t;var u=-1,h=!0,g=2&n?new Jn:o;for(a.set(t,e),a.set(e,t);++u<l;){var m=t[u],v=e[u];if(i)var f=s?i(v,m,u,e,t,a):i(m,v,u,t,e,a);if(f!==o){if(f)continue;h=!1;break}if(g){if(!ke(e,function(t,e){if(!Ge(g,e)&&(m===t||r(m,t,n,i,a)))return g.push(e)})){h=!1;break}}else if(m!==v&&!r(m,v,n,i,a)){h=!1;break}}return a.delete(t),a.delete(e),h}function $o(t){return wr(Mr(t,o,Ur),t+"")}function Wo(t){return bi(t,Ts,ar)}function Ko(t){return bi(t,Ds,sr)}var Xo=xn?function(t){return xn.get(t)}:ol;function tr(t){for(var e=t.name+"",n=Pn[e],i=St.call(Pn,e)?n.length:0;i--;){var o=n[i],r=o.func;if(null==r||r==t)return o.name}return e}function er(t){return(St.call(qn,"placeholder")?qn:t).placeholder}function nr(){var t=qn.iteratee||tl;return t=t===tl?Si:t,arguments.length?t(arguments[0],arguments[1]):t}function ir(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map}function or(t){for(var e=Ts(t),n=e.length;n--;){var i=e[n],o=t[i];e[n]=[i,o,br(o)]}return e}function rr(t,e){var n=function(t,e){return null==t?o:t[e]}(t,e);return Di(n)?n:o}var ar=pe?function(t){return null==t?[]:(t=Ot(t),xe(pe(t),function(e){return Jt.call(t,e)}))}:pl,sr=pe?function(t){for(var e=[];t;)De(e,ar(t)),t=Nt(t);return e}:pl,lr=_i;function cr(t,e,n){for(var i=-1,o=(e=ho(e,t)).length,r=!1;++i<o;){var a=Ar(e[i]);if(!(r=null!=t&&n(t,a)))break;t=t[a]}return r||++i!=o?r:!!(o=null==t?0:t.length)&&Va(o)&&ur(a,o)&&(Na(t)||Fa(t))}function dr(t){return"function"!=typeof t.constructor||fr(t)?{}:Ln(Nt(t))}function pr(t){return Na(t)||Fa(t)||!!(Bt&&t&&t[Bt])}function ur(t,e){var n=typeof t;return!!(e=null==e?c:e)&&("number"==n||"symbol"!=n&&gt.test(t))&&t>-1&&t%1==0&&t<e}function hr(t,e,n){if(!$a(n))return!1;var i=typeof e;return!!("number"==i?Ja(n)&&ur(e,n.length):"string"==i&&e in n)&&Ea(n[e],t)}function gr(t,e){if(Na(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!os(t))||$.test(t)||!V.test(t)||null!=e&&t in Ot(e)}function mr(t){var e=tr(t),n=qn[e];if("function"!=typeof n||!(e in jn.prototype))return!1;if(t===n)return!0;var i=Xo(n);return!!i&&t===i[0]}(bn&&lr(new bn(new ArrayBuffer(1)))!=S||_n&&lr(new _n)!=_||Mn&&lr(Mn.resolve())!=y||On&&lr(new On)!=x||yn&&lr(new yn)!=T)&&(lr=function(t){var e=_i(t),n=e==O?t.constructor:o,i=n?qr(n):"";if(i)switch(i){case wn:return S;case Tn:return _;case Dn:return y;case Sn:return x;case In:return T}return e});var vr=Tt?Ga:ul;function fr(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||wt)}function br(t){return t==t&&!$a(t)}function _r(t,e){return function(n){return null!=n&&n[t]===e&&(e!==o||t in Ot(n))}}function Mr(t,e,n){return e=un(e===o?t.length-1:e,0),function(){for(var o=arguments,r=-1,a=un(o.length-e,0),s=i(a);++r<a;)s[r]=o[e+r];r=-1;for(var l=i(e+1);++r<e;)l[r]=o[r];return l[e]=n(s),_e(t,this,l)}}function Or(t,e){return e.length<2?t:fi(t,$i(e,0,-1))}function yr(t,e){for(var n=t.length,i=hn(e.length,n),r=Co(t);i--;){var a=e[i];t[i]=ur(a,n)?r[a]:o}return t}function Cr(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var xr=Dr(Gi),Pr=ae||function(t,e){return se.setTimeout(t,e)},wr=Dr(Qi);function Tr(t,e,n){var i=e+"";return wr(t,function(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(nt,"{\n/* [wrapped with "+e+"] */\n")}(i,function(t,e){return Oe(p,function(n){var i="_."+n[0];e&n[1]&&!Pe(t,i)&&t.push(i)}),t.sort()}(function(t){var e=t.match(it);return e?e[1].split(ot):[]}(i),n)))}function Dr(t){var e=0,n=0;return function(){var i=gn(),r=16-(i-n);if(n=i,r>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(o,arguments)}}function Sr(t,e){var n=-1,i=t.length,r=i-1;for(e=e===o?i:e;++n<e;){var a=Ui(n,r),s=t[a];t[a]=t[n],t[n]=s}return t.length=e,t}var Ir,kr,Zr=(Ir=Ia(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(W,function(t,n,i,o){e.push(i?o.replace(st,"$1"):n||t)}),e},function(t){return 500===kr.size&&kr.clear(),t}),kr=Ir.cache,Ir);function Ar(t){if("string"==typeof t||os(t))return t;var e=t+"";return"0"==e&&1/t==-l?"-0":e}function qr(t){if(null!=t){try{return Dt.call(t)}catch(Ir){}try{return t+""}catch(Ir){}}return""}function Lr(t){if(t instanceof jn)return t.clone();var e=new Rn(t.__wrapped__,t.__chain__);return e.__actions__=Co(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Er=Yi(function(t,e){return Ya(t)?ri(t,pi(e,1,Ya,!0)):[]}),Rr=Yi(function(t,e){var n=Hr(e);return Ya(n)&&(n=o),Ya(t)?ri(t,pi(e,1,Ya,!0),nr(n,2)):[]}),jr=Yi(function(t,e){var n=Hr(e);return Ya(n)&&(n=o),Ya(t)?ri(t,pi(e,1,Ya,!0),o,n):[]});function Fr(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var o=null==n?0:ds(n);return o<0&&(o=un(i+o,0)),qe(t,nr(e,3),o)}function Nr(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i-1;return n!==o&&(r=ds(n),r=n<0?un(i+r,0):hn(r,i-1)),qe(t,nr(e,3),r,!0)}function Ur(t){return null!=t&&t.length?pi(t,1):[]}function Jr(t){return t&&t.length?t[0]:o}var Yr=Yi(function(t){var e=Te(t,po);return e.length&&e[0]===t[0]?Ci(e):[]}),Br=Yi(function(t){var e=Hr(t),n=Te(t,po);return e===Hr(n)?e=o:n.pop(),n.length&&n[0]===t[0]?Ci(n,nr(e,2)):[]}),zr=Yi(function(t){var e=Hr(t),n=Te(t,po);return(e="function"==typeof e?e:o)&&n.pop(),n.length&&n[0]===t[0]?Ci(n,o,e):[]});function Hr(t){var e=null==t?0:t.length;return e?t[e-1]:o}var Gr=Yi(Qr);function Qr(t,e){return t&&t.length&&e&&e.length?Fi(t,e):t}var Vr=$o(function(t,e){var n=null==t?0:t.length,i=ti(t,e);return Ni(t,Te(e,function(t){return ur(t,n)?+t:t}).sort(Mo)),i});function $r(t){return null==t?t:fn.call(t)}var Wr=Yi(function(t){return io(pi(t,1,Ya,!0))}),Kr=Yi(function(t){var e=Hr(t);return Ya(e)&&(e=o),io(pi(t,1,Ya,!0),nr(e,2))}),Xr=Yi(function(t){var e=Hr(t);return e="function"==typeof e?e:o,io(pi(t,1,Ya,!0),o,e)});function ta(t){if(!t||!t.length)return[];var e=0;return t=xe(t,function(t){if(Ya(t))return e=un(t.length,e),!0}),Ye(e,function(e){return Te(t,Fe(e))})}function ea(t,e){if(!t||!t.length)return[];var n=ta(t);return null==e?n:Te(n,function(t){return _e(e,o,t)})}var na=Yi(function(t,e){return Ya(t)?ri(t,e):[]}),ia=Yi(function(t){return lo(xe(t,Ya))}),oa=Yi(function(t){var e=Hr(t);return Ya(e)&&(e=o),lo(xe(t,Ya),nr(e,2))}),ra=Yi(function(t){var e=Hr(t);return e="function"==typeof e?e:o,lo(xe(t,Ya),o,e)}),aa=Yi(ta),sa=Yi(function(t){var e=t.length,n=e>1?t[e-1]:o;return n="function"==typeof n?(t.pop(),n):o,ea(t,n)});function la(t){var e=qn(t);return e.__chain__=!0,e}function ca(t,e){return e(t)}var da=$o(function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,r=function(e){return ti(e,t)};return!(e>1||this.__actions__.length)&&i instanceof jn&&ur(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:ca,args:[r],thisArg:o}),new Rn(i,this.__chain__).thru(function(t){return e&&!t.length&&t.push(o),t})):this.thru(r)}),pa=Po(function(t,e,n){St.call(t,n)?++t[n]:Xn(t,n,1)}),ua=Zo(Fr),ha=Zo(Nr);function ga(t,e){return(Na(t)?Oe:ai)(t,nr(e,3))}function ma(t,e){return(Na(t)?ye:si)(t,nr(e,3))}var va=Po(function(t,e,n){St.call(t,n)?t[n].push(e):Xn(t,n,[e])}),fa=Yi(function(t,e,n){var o=-1,r="function"==typeof e,a=Ja(t)?i(t.length):[];return ai(t,function(t){a[++o]=r?_e(e,t,n):xi(t,e,n)}),a}),ba=Po(function(t,e,n){Xn(t,n,e)});function _a(t,e){return(Na(t)?Te:Zi)(t,nr(e,3))}var Ma=Po(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),Oa=Yi(function(t,e){if(null==t)return[];var n=e.length;return n>1&&hr(t,e[0],e[1])?e=[]:n>2&&hr(e[0],e[1],e[2])&&(e=[e[0]]),Ri(t,pi(e,1),[])}),ya=re||function(){return se.Date.now()};function Ca(t,e,n){return e=n?o:e,zo(t,128,o,o,o,o,e=t&&null==e?t.length:e)}function xa(t,e){var n;if("function"!=typeof e)throw new xt(r);return t=ds(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=o),n}}var Pa=Yi(function(t,e,n){var i=1;if(n.length){var o=on(n,er(Pa));i|=32}return zo(t,i,e,n,o)}),wa=Yi(function(t,e,n){var i=3;if(n.length){var o=on(n,er(wa));i|=32}return zo(e,i,t,n,o)});function Ta(t,e,n){var i,a,s,l,c,d,p=0,u=!1,h=!1,g=!0;if("function"!=typeof t)throw new xt(r);function m(e){var n=i,r=a;return i=a=o,p=e,l=t.apply(r,n)}function v(t){return p=t,c=Pr(b,e),u?m(t):l}function f(t){var n=t-d;return d===o||n>=e||n<0||h&&t-p>=s}function b(){var t=ya();if(f(t))return _(t);c=Pr(b,function(t){var n=e-(t-d);return h?hn(n,s-(t-p)):n}(t))}function _(t){return c=o,g&&i?m(t):(i=a=o,l)}function M(){var t=ya(),n=f(t);if(i=arguments,a=this,d=t,n){if(c===o)return v(d);if(h)return vo(c),c=Pr(b,e),m(d)}return c===o&&(c=Pr(b,e)),l}return e=us(e)||0,$a(n)&&(u=!!n.leading,s=(h="maxWait"in n)?un(us(n.maxWait)||0,e):s,g="trailing"in n?!!n.trailing:g),M.cancel=function(){c!==o&&vo(c),p=0,i=d=a=c=o},M.flush=function(){return c===o?l:_(ya())},M}var Da=Yi(function(t,e){return oi(t,1,e)}),Sa=Yi(function(t,e,n){return oi(t,us(e)||0,n)});function Ia(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new xt(r);var n=function(){var i=arguments,o=e?e.apply(this,i):i[0],r=n.cache;if(r.has(o))return r.get(o);var a=t.apply(this,i);return n.cache=r.set(o,a)||r,a};return n.cache=new(Ia.Cache||Un),n}function ka(t){if("function"!=typeof t)throw new xt(r);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Ia.Cache=Un;var Za=go(function(t,e){var n=(e=1==e.length&&Na(e[0])?Te(e[0],ze(nr())):Te(pi(e,1),ze(nr()))).length;return Yi(function(i){for(var o=-1,r=hn(i.length,n);++o<r;)i[o]=e[o].call(this,i[o]);return _e(t,this,i)})}),Aa=Yi(function(t,e){var n=on(e,er(Aa));return zo(t,32,o,e,n)}),qa=Yi(function(t,e){var n=on(e,er(qa));return zo(t,64,o,e,n)}),La=$o(function(t,e){return zo(t,256,o,o,o,e)});function Ea(t,e){return t===e||t!=t&&e!=e}var Ra=No(Mi),ja=No(function(t,e){return t>=e}),Fa=Pi(function(){return arguments}())?Pi:function(t){return Wa(t)&&St.call(t,"callee")&&!Jt.call(t,"callee")},Na=i.isArray,Ua=he?ze(he):function(t){return Wa(t)&&_i(t)==D};function Ja(t){return null!=t&&Va(t.length)&&!Ga(t)}function Ya(t){return Wa(t)&&Ja(t)}var Ba=ue||ul,za=ge?ze(ge):function(t){return Wa(t)&&_i(t)==m};function Ha(t){if(!Wa(t))return!1;var e=_i(t);return e==v||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ts(t)}function Ga(t){if(!$a(t))return!1;var e=_i(t);return e==f||e==b||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Qa(t){return"number"==typeof t&&t==ds(t)}function Va(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function $a(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Wa(t){return null!=t&&"object"==typeof t}var Ka=me?ze(me):function(t){return Wa(t)&&lr(t)==_};function Xa(t){return"number"==typeof t||Wa(t)&&_i(t)==M}function ts(t){if(!Wa(t)||_i(t)!=O)return!1;var e=Nt(t);if(null===e)return!0;var n=St.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Dt.call(n)==At}var es=ve?ze(ve):function(t){return Wa(t)&&_i(t)==C},ns=fe?ze(fe):function(t){return Wa(t)&&lr(t)==x};function is(t){return"string"==typeof t||!Na(t)&&Wa(t)&&_i(t)==P}function os(t){return"symbol"==typeof t||Wa(t)&&_i(t)==w}var rs=be?ze(be):function(t){return Wa(t)&&Va(t.length)&&!!te[_i(t)]},as=No(ki),ss=No(function(t,e){return t<=e});function ls(t){if(!t)return[];if(Ja(t))return is(t)?sn(t):Co(t);if(zt&&t[zt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[zt]());var e=lr(t);return(e==_?en:e==x?rn:Es)(t)}function cs(t){return t?(t=us(t))===l||t===-l?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ds(t){var e=cs(t),n=e%1;return e==e?n?e-n:e:0}function ps(t){return t?ei(ds(t),0,d):0}function us(t){if("number"==typeof t)return t;if(os(t))return NaN;if($a(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=$a(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Be(t);var n=pt.test(t);return n||ht.test(t)?oe(t.slice(2),n?2:8):dt.test(t)?NaN:+t}function hs(t){return xo(t,Ds(t))}function gs(t){return null==t?"":no(t)}var ms=wo(function(t,e){if(fr(e)||Ja(e))xo(e,Ts(e),t);else for(var n in e)St.call(e,n)&&Vn(t,n,e[n])}),vs=wo(function(t,e){xo(e,Ds(e),t)}),fs=wo(function(t,e,n,i){xo(e,Ds(e),t,i)}),bs=wo(function(t,e,n,i){xo(e,Ts(e),t,i)}),_s=$o(ti),Ms=Yi(function(t,e){t=Ot(t);var n=-1,i=e.length,r=i>2?e[2]:o;for(r&&hr(e[0],e[1],r)&&(i=1);++n<i;)for(var a=e[n],s=Ds(a),l=-1,c=s.length;++l<c;){var d=s[l],p=t[d];(p===o||Ea(p,wt[d])&&!St.call(t,d))&&(t[d]=a[d])}return t}),Os=Yi(function(t){return t.push(o,Go),_e(Is,o,t)});function ys(t,e,n){var i=null==t?o:fi(t,e);return i===o?n:i}function Cs(t,e){return null!=t&&cr(t,e,yi)}var xs=Lo(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Zt.call(e)),t[e]=n},$s(Xs)),Ps=Lo(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Zt.call(e)),St.call(t,e)?t[e].push(n):t[e]=[n]},nr),ws=Yi(xi);function Ts(t){return Ja(t)?Bn(t):Ii(t)}function Ds(t){return Ja(t)?Bn(t,!0):function(t){if(!$a(t))return function(t){var e=[];if(null!=t)for(var n in Ot(t))e.push(n);return e}(t);var e=fr(t),n=[];for(var i in t)"constructor"==i&&(e||!St.call(t,i))||n.push(i);return n}(t)}var Ss=wo(function(t,e,n){Li(t,e,n)}),Is=wo(function(t,e,n,i){Li(t,e,n,i)}),ks=$o(function(t,e){var n={};if(null==t)return n;var i=!1;e=Te(e,function(e){return e=ho(e,t),i||(i=e.length>1),e}),xo(t,Ko(t),n),i&&(n=ni(n,7,Qo));for(var o=e.length;o--;)oo(n,e[o]);return n}),Zs=$o(function(t,e){return null==t?{}:function(t,e){return ji(t,e,function(e,n){return Cs(t,n)})}(t,e)});function As(t,e){if(null==t)return{};var n=Te(Ko(t),function(t){return[t]});return e=nr(e),ji(t,n,function(t,n){return e(t,n[0])})}var qs=Bo(Ts),Ls=Bo(Ds);function Es(t){return null==t?[]:He(t,Ts(t))}var Rs=Io(function(t,e,n){return e=e.toLowerCase(),t+(n?js(e):e)});function js(t){return Hs(gs(t).toLowerCase())}function Fs(t){return(t=gs(t))&&t.replace(mt,We).replace(Gt,"")}var Ns=Io(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Us=Io(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),Js=So("toLowerCase"),Ys=Io(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Bs=Io(function(t,e,n){return t+(n?" ":"")+Hs(e)}),zs=Io(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Hs=So("toUpperCase");function Gs(t,e,n){return t=gs(t),(e=n?o:e)===o?function(t){return Wt.test(t)}(t)?function(t){return t.match(Vt)||[]}(t):function(t){return t.match(rt)||[]}(t):t.match(e)||[]}var Qs=Yi(function(t,e){try{return _e(t,o,e)}catch(kr){return Ha(kr)?kr:new bt(kr)}}),Vs=$o(function(t,e){return Oe(e,function(e){e=Ar(e),Xn(t,e,Pa(t[e],t))}),t});function $s(t){return function(){return t}}var Ws=Ao(),Ks=Ao(!0);function Xs(t){return t}function tl(t){return Si("function"==typeof t?t:ni(t,1))}var el=Yi(function(t,e){return function(n){return xi(n,t,e)}}),nl=Yi(function(t,e){return function(n){return xi(t,n,e)}});function il(t,e,n){var i=Ts(e),o=vi(e,i);null==n&&(!$a(e)||!o.length&&i.length)&&(n=e,e=t,t=this,o=vi(e,Ts(e)));var r=!($a(n)&&"chain"in n&&!n.chain),a=Ga(t);return Oe(o,function(n){var i=e[n];t[n]=i,a&&(t.prototype[n]=function(){var e=this.__chain__;if(r||e){var n=t(this.__wrapped__),o=n.__actions__=Co(this.__actions__);return o.push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,De([this.value()],arguments))})}),t}function ol(){}var rl=Ro(Te),al=Ro(Ce),sl=Ro(ke);function ll(t){return gr(t)?Fe(Ar(t)):function(t){return function(e){return fi(e,t)}}(t)}var cl=Fo(),dl=Fo(!0);function pl(){return[]}function ul(){return!1}var hl=Eo(function(t,e){return t+e},0),gl=Jo("ceil"),ml=Eo(function(t,e){return t/e},1),vl=Jo("floor"),fl=Eo(function(t,e){return t*e},1),bl=Jo("round"),_l=Eo(function(t,e){return t-e},0);return qn.after=function(t,e){if("function"!=typeof e)throw new xt(r);return t=ds(t),function(){if(--t<1)return e.apply(this,arguments)}},qn.ary=Ca,qn.assign=ms,qn.assignIn=vs,qn.assignInWith=fs,qn.assignWith=bs,qn.at=_s,qn.before=xa,qn.bind=Pa,qn.bindAll=Vs,qn.bindKey=wa,qn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Na(t)?t:[t]},qn.chain=la,qn.chunk=function(t,e,n){e=(n?hr(t,e,n):e===o)?1:un(ds(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var a=0,s=0,l=i(le(r/e));a<r;)l[s++]=$i(t,a,a+=e);return l},qn.compact=function(t){for(var e=-1,n=null==t?0:t.length,i=0,o=[];++e<n;){var r=t[e];r&&(o[i++]=r)}return o},qn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=i(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return De(Na(n)?Co(n):[n],pi(e,1))},qn.cond=function(t){var e=null==t?0:t.length,n=nr();return t=e?Te(t,function(t){if("function"!=typeof t[1])throw new xt(r);return[n(t[0]),t[1]]}):[],Yi(function(n){for(var i=-1;++i<e;){var o=t[i];if(_e(o[0],this,n))return _e(o[1],this,n)}})},qn.conforms=function(t){return function(t){var e=Ts(t);return function(n){return ii(n,t,e)}}(ni(t,1))},qn.constant=$s,qn.countBy=pa,qn.create=function(t,e){var n=Ln(t);return null==e?n:Kn(n,e)},qn.curry=function t(e,n,i){var r=zo(e,8,o,o,o,o,o,n=i?o:n);return r.placeholder=t.placeholder,r},qn.curryRight=function t(e,n,i){var r=zo(e,16,o,o,o,o,o,n=i?o:n);return r.placeholder=t.placeholder,r},qn.debounce=Ta,qn.defaults=Ms,qn.defaultsDeep=Os,qn.defer=Da,qn.delay=Sa,qn.difference=Er,qn.differenceBy=Rr,qn.differenceWith=jr,qn.drop=function(t,e,n){var i=null==t?0:t.length;return i?$i(t,(e=n||e===o?1:ds(e))<0?0:e,i):[]},qn.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?$i(t,0,(e=i-(e=n||e===o?1:ds(e)))<0?0:e):[]},qn.dropRightWhile=function(t,e){return t&&t.length?ao(t,nr(e,3),!0,!0):[]},qn.dropWhile=function(t,e){return t&&t.length?ao(t,nr(e,3),!0):[]},qn.fill=function(t,e,n,i){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&hr(t,e,n)&&(n=0,i=r),function(t,e,n,i){var r=t.length;for((n=ds(n))<0&&(n=-n>r?0:r+n),(i=i===o||i>r?r:ds(i))<0&&(i+=r),i=n>i?0:ps(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},qn.filter=function(t,e){return(Na(t)?xe:di)(t,nr(e,3))},qn.flatMap=function(t,e){return pi(_a(t,e),1)},qn.flatMapDeep=function(t,e){return pi(_a(t,e),l)},qn.flatMapDepth=function(t,e,n){return n=n===o?1:ds(n),pi(_a(t,e),n)},qn.flatten=Ur,qn.flattenDeep=function(t){return null!=t&&t.length?pi(t,l):[]},qn.flattenDepth=function(t,e){return null!=t&&t.length?pi(t,e=e===o?1:ds(e)):[]},qn.flip=function(t){return zo(t,512)},qn.flow=Ws,qn.flowRight=Ks,qn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var o=t[e];i[o[0]]=o[1]}return i},qn.functions=function(t){return null==t?[]:vi(t,Ts(t))},qn.functionsIn=function(t){return null==t?[]:vi(t,Ds(t))},qn.groupBy=va,qn.initial=function(t){return null!=t&&t.length?$i(t,0,-1):[]},qn.intersection=Yr,qn.intersectionBy=Br,qn.intersectionWith=zr,qn.invert=xs,qn.invertBy=Ps,qn.invokeMap=fa,qn.iteratee=tl,qn.keyBy=ba,qn.keys=Ts,qn.keysIn=Ds,qn.map=_a,qn.mapKeys=function(t,e){var n={};return e=nr(e,3),gi(t,function(t,i,o){Xn(n,e(t,i,o),t)}),n},qn.mapValues=function(t,e){var n={};return e=nr(e,3),gi(t,function(t,i,o){Xn(n,i,e(t,i,o))}),n},qn.matches=function(t){return Ai(ni(t,1))},qn.matchesProperty=function(t,e){return qi(t,ni(e,1))},qn.memoize=Ia,qn.merge=Ss,qn.mergeWith=Is,qn.method=el,qn.methodOf=nl,qn.mixin=il,qn.negate=ka,qn.nthArg=function(t){return t=ds(t),Yi(function(e){return Ei(e,t)})},qn.omit=ks,qn.omitBy=function(t,e){return As(t,ka(nr(e)))},qn.once=function(t){return xa(2,t)},qn.orderBy=function(t,e,n,i){return null==t?[]:(Na(e)||(e=null==e?[]:[e]),Na(n=i?o:n)||(n=null==n?[]:[n]),Ri(t,e,n))},qn.over=rl,qn.overArgs=Za,qn.overEvery=al,qn.overSome=sl,qn.partial=Aa,qn.partialRight=qa,qn.partition=Ma,qn.pick=Zs,qn.pickBy=As,qn.property=ll,qn.propertyOf=function(t){return function(e){return null==t?o:fi(t,e)}},qn.pull=Gr,qn.pullAll=Qr,qn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Fi(t,e,nr(n,2)):t},qn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Fi(t,e,o,n):t},qn.pullAt=Vr,qn.range=cl,qn.rangeRight=dl,qn.rearg=La,qn.reject=function(t,e){return(Na(t)?xe:di)(t,ka(nr(e,3)))},qn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var i=-1,o=[],r=t.length;for(e=nr(e,3);++i<r;){var a=t[i];e(a,i,t)&&(n.push(a),o.push(i))}return Ni(t,o),n},qn.rest=function(t,e){if("function"!=typeof t)throw new xt(r);return Yi(t,e=e===o?e:ds(e))},qn.reverse=$r,qn.sampleSize=function(t,e,n){return e=(n?hr(t,e,n):e===o)?1:ds(e),(Na(t)?Hn:zi)(t,e)},qn.set=function(t,e,n){return null==t?t:Hi(t,e,n)},qn.setWith=function(t,e,n,i){return i="function"==typeof i?i:o,null==t?t:Hi(t,e,n,i)},qn.shuffle=function(t){return(Na(t)?Gn:Vi)(t)},qn.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&hr(t,e,n)?(e=0,n=i):(e=null==e?0:ds(e),n=n===o?i:ds(n)),$i(t,e,n)):[]},qn.sortBy=Oa,qn.sortedUniq=function(t){return t&&t.length?to(t):[]},qn.sortedUniqBy=function(t,e){return t&&t.length?to(t,nr(e,2)):[]},qn.split=function(t,e,n){return n&&"number"!=typeof n&&hr(t,e,n)&&(e=n=o),(n=n===o?d:n>>>0)?(t=gs(t))&&("string"==typeof e||null!=e&&!es(e))&&!(e=no(e))&&tn(t)?mo(sn(t),0,n):t.split(e,n):[]},qn.spread=function(t,e){if("function"!=typeof t)throw new xt(r);return e=null==e?0:un(ds(e),0),Yi(function(n){var i=n[e],o=mo(n,0,e);return i&&De(o,i),_e(t,this,o)})},qn.tail=function(t){var e=null==t?0:t.length;return e?$i(t,1,e):[]},qn.take=function(t,e,n){return t&&t.length?$i(t,0,(e=n||e===o?1:ds(e))<0?0:e):[]},qn.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?$i(t,(e=i-(e=n||e===o?1:ds(e)))<0?0:e,i):[]},qn.takeRightWhile=function(t,e){return t&&t.length?ao(t,nr(e,3),!1,!0):[]},qn.takeWhile=function(t,e){return t&&t.length?ao(t,nr(e,3)):[]},qn.tap=function(t,e){return e(t),t},qn.throttle=function(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new xt(r);return $a(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),Ta(t,e,{leading:i,maxWait:e,trailing:o})},qn.thru=ca,qn.toArray=ls,qn.toPairs=qs,qn.toPairsIn=Ls,qn.toPath=function(t){return Na(t)?Te(t,Ar):os(t)?[t]:Co(Zr(gs(t)))},qn.toPlainObject=hs,qn.transform=function(t,e,n){var i=Na(t),o=i||Ba(t)||rs(t);if(e=nr(e,4),null==n){var r=t&&t.constructor;n=o?i?new r:[]:$a(t)&&Ga(r)?Ln(Nt(t)):{}}return(o?Oe:gi)(t,function(t,i,o){return e(n,t,i,o)}),n},qn.unary=function(t){return Ca(t,1)},qn.union=Wr,qn.unionBy=Kr,qn.unionWith=Xr,qn.uniq=function(t){return t&&t.length?io(t):[]},qn.uniqBy=function(t,e){return t&&t.length?io(t,nr(e,2)):[]},qn.uniqWith=function(t,e){return e="function"==typeof e?e:o,t&&t.length?io(t,o,e):[]},qn.unset=function(t,e){return null==t||oo(t,e)},qn.unzip=ta,qn.unzipWith=ea,qn.update=function(t,e,n){return null==t?t:ro(t,e,uo(n))},qn.updateWith=function(t,e,n,i){return i="function"==typeof i?i:o,null==t?t:ro(t,e,uo(n),i)},qn.values=Es,qn.valuesIn=function(t){return null==t?[]:He(t,Ds(t))},qn.without=na,qn.words=Gs,qn.wrap=function(t,e){return Aa(uo(e),t)},qn.xor=ia,qn.xorBy=oa,qn.xorWith=ra,qn.zip=aa,qn.zipObject=function(t,e){return co(t||[],e||[],Vn)},qn.zipObjectDeep=function(t,e){return co(t||[],e||[],Hi)},qn.zipWith=sa,qn.entries=qs,qn.entriesIn=Ls,qn.extend=vs,qn.extendWith=fs,il(qn,qn),qn.add=hl,qn.attempt=Qs,qn.camelCase=Rs,qn.capitalize=js,qn.ceil=gl,qn.clamp=function(t,e,n){return n===o&&(n=e,e=o),n!==o&&(n=(n=us(n))==n?n:0),e!==o&&(e=(e=us(e))==e?e:0),ei(us(t),e,n)},qn.clone=function(t){return ni(t,4)},qn.cloneDeep=function(t){return ni(t,5)},qn.cloneDeepWith=function(t,e){return ni(t,5,e="function"==typeof e?e:o)},qn.cloneWith=function(t,e){return ni(t,4,e="function"==typeof e?e:o)},qn.conformsTo=function(t,e){return null==e||ii(t,e,Ts(e))},qn.deburr=Fs,qn.defaultTo=function(t,e){return null==t||t!=t?e:t},qn.divide=ml,qn.endsWith=function(t,e,n){t=gs(t),e=no(e);var i=t.length,r=n=n===o?i:ei(ds(n),0,i);return(n-=e.length)>=0&&t.slice(n,r)==e},qn.eq=Ea,qn.escape=function(t){return(t=gs(t))&&z.test(t)?t.replace(Y,Ke):t},qn.escapeRegExp=function(t){return(t=gs(t))&&X.test(t)?t.replace(K,"\\$&"):t},qn.every=function(t,e,n){var i=Na(t)?Ce:li;return n&&hr(t,e,n)&&(e=o),i(t,nr(e,3))},qn.find=ua,qn.findIndex=Fr,qn.findKey=function(t,e){return Ae(t,nr(e,3),gi)},qn.findLast=ha,qn.findLastIndex=Nr,qn.findLastKey=function(t,e){return Ae(t,nr(e,3),mi)},qn.floor=vl,qn.forEach=ga,qn.forEachRight=ma,qn.forIn=function(t,e){return null==t?t:ui(t,nr(e,3),Ds)},qn.forInRight=function(t,e){return null==t?t:hi(t,nr(e,3),Ds)},qn.forOwn=function(t,e){return t&&gi(t,nr(e,3))},qn.forOwnRight=function(t,e){return t&&mi(t,nr(e,3))},qn.get=ys,qn.gt=Ra,qn.gte=ja,qn.has=function(t,e){return null!=t&&cr(t,e,Oi)},qn.hasIn=Cs,qn.head=Jr,qn.identity=Xs,qn.includes=function(t,e,n,i){t=Ja(t)?t:Es(t),n=n&&!i?ds(n):0;var o=t.length;return n<0&&(n=un(o+n,0)),is(t)?n<=o&&t.indexOf(e,n)>-1:!!o&&Le(t,e,n)>-1},qn.indexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var o=null==n?0:ds(n);return o<0&&(o=un(i+o,0)),Le(t,e,o)},qn.inRange=function(t,e,n){return e=cs(e),n===o?(n=e,e=0):n=cs(n),function(t,e,n){return t>=hn(e,n)&&t<un(e,n)}(t=us(t),e,n)},qn.invoke=ws,qn.isArguments=Fa,qn.isArray=Na,qn.isArrayBuffer=Ua,qn.isArrayLike=Ja,qn.isArrayLikeObject=Ya,qn.isBoolean=function(t){return!0===t||!1===t||Wa(t)&&_i(t)==g},qn.isBuffer=Ba,qn.isDate=za,qn.isElement=function(t){return Wa(t)&&1===t.nodeType&&!ts(t)},qn.isEmpty=function(t){if(null==t)return!0;if(Ja(t)&&(Na(t)||"string"==typeof t||"function"==typeof t.splice||Ba(t)||rs(t)||Fa(t)))return!t.length;var e=lr(t);if(e==_||e==x)return!t.size;if(fr(t))return!Ii(t).length;for(var n in t)if(St.call(t,n))return!1;return!0},qn.isEqual=function(t,e){return wi(t,e)},qn.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:o)?n(t,e):o;return i===o?wi(t,e,o,n):!!i},qn.isError=Ha,qn.isFinite=function(t){return"number"==typeof t&&Ze(t)},qn.isFunction=Ga,qn.isInteger=Qa,qn.isLength=Va,qn.isMap=Ka,qn.isMatch=function(t,e){return t===e||Ti(t,e,or(e))},qn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:o,Ti(t,e,or(e),n)},qn.isNaN=function(t){return Xa(t)&&t!=+t},qn.isNative=function(t){if(vr(t))throw new bt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Di(t)},qn.isNil=function(t){return null==t},qn.isNull=function(t){return null===t},qn.isNumber=Xa,qn.isObject=$a,qn.isObjectLike=Wa,qn.isPlainObject=ts,qn.isRegExp=es,qn.isSafeInteger=function(t){return Qa(t)&&t>=-c&&t<=c},qn.isSet=ns,qn.isString=is,qn.isSymbol=os,qn.isTypedArray=rs,qn.isUndefined=function(t){return t===o},qn.isWeakMap=function(t){return Wa(t)&&lr(t)==T},qn.isWeakSet=function(t){return Wa(t)&&"[object WeakSet]"==_i(t)},qn.join=function(t,e){return null==t?"":Ne.call(t,e)},qn.kebabCase=Ns,qn.last=Hr,qn.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i;return n!==o&&(r=(r=ds(n))<0?un(i+r,0):hn(r,i-1)),e==e?function(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}(t,e,r):qe(t,Re,r,!0)},qn.lowerCase=Us,qn.lowerFirst=Js,qn.lt=as,qn.lte=ss,qn.max=function(t){return t&&t.length?ci(t,Xs,Mi):o},qn.maxBy=function(t,e){return t&&t.length?ci(t,nr(e,2),Mi):o},qn.mean=function(t){return je(t,Xs)},qn.meanBy=function(t,e){return je(t,nr(e,2))},qn.min=function(t){return t&&t.length?ci(t,Xs,ki):o},qn.minBy=function(t,e){return t&&t.length?ci(t,nr(e,2),ki):o},qn.stubArray=pl,qn.stubFalse=ul,qn.stubObject=function(){return{}},qn.stubString=function(){return""},qn.stubTrue=function(){return!0},qn.multiply=fl,qn.nth=function(t,e){return t&&t.length?Ei(t,ds(e)):o},qn.noConflict=function(){return se._===this&&(se._=qt),this},qn.noop=ol,qn.now=ya,qn.pad=function(t,e,n){t=gs(t);var i=(e=ds(e))?an(t):0;if(!e||i>=e)return t;var o=(e-i)/2;return jo(ce(o),n)+t+jo(le(o),n)},qn.padEnd=function(t,e,n){t=gs(t);var i=(e=ds(e))?an(t):0;return e&&i<e?t+jo(e-i,n):t},qn.padStart=function(t,e,n){t=gs(t);var i=(e=ds(e))?an(t):0;return e&&i<e?jo(e-i,n)+t:t},qn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),mn(gs(t).replace(tt,""),e||0)},qn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&hr(t,e,n)&&(e=n=o),n===o&&("boolean"==typeof e?(n=e,e=o):"boolean"==typeof t&&(n=t,t=o)),t===o&&e===o?(t=0,e=1):(t=cs(t),e===o?(e=t,t=0):e=cs(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var r=vn();return hn(t+r*(e-t+ie("1e-"+((r+"").length-1))),e)}return Ui(t,e)},qn.reduce=function(t,e,n){var i=Na(t)?Se:Ue,o=arguments.length<3;return i(t,nr(e,4),n,o,ai)},qn.reduceRight=function(t,e,n){var i=Na(t)?Ie:Ue,o=arguments.length<3;return i(t,nr(e,4),n,o,si)},qn.repeat=function(t,e,n){return e=(n?hr(t,e,n):e===o)?1:ds(e),Ji(gs(t),e)},qn.replace=function(){var t=arguments,e=gs(t[0]);return t.length<3?e:e.replace(t[1],t[2])},qn.result=function(t,e,n){var i=-1,r=(e=ho(e,t)).length;for(r||(r=1,t=o);++i<r;){var a=null==t?o:t[Ar(e[i])];a===o&&(i=r,a=n),t=Ga(a)?a.call(t):a}return t},qn.round=bl,qn.runInContext=t,qn.sample=function(t){return(Na(t)?zn:Bi)(t)},qn.size=function(t){if(null==t)return 0;if(Ja(t))return is(t)?an(t):t.length;var e=lr(t);return e==_||e==x?t.size:Ii(t).length},qn.snakeCase=Ys,qn.some=function(t,e,n){var i=Na(t)?ke:Wi;return n&&hr(t,e,n)&&(e=o),i(t,nr(e,3))},qn.sortedIndex=function(t,e){return Ki(t,e)},qn.sortedIndexBy=function(t,e,n){return Xi(t,e,nr(n,2))},qn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var i=Ki(t,e);if(i<n&&Ea(t[i],e))return i}return-1},qn.sortedLastIndex=function(t,e){return Ki(t,e,!0)},qn.sortedLastIndexBy=function(t,e,n){return Xi(t,e,nr(n,2),!0)},qn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=Ki(t,e,!0)-1;if(Ea(t[n],e))return n}return-1},qn.startCase=Bs,qn.startsWith=function(t,e,n){return t=gs(t),n=null==n?0:ei(ds(n),0,t.length),e=no(e),t.slice(n,n+e.length)==e},qn.subtract=_l,qn.sum=function(t){return t&&t.length?Je(t,Xs):0},qn.sumBy=function(t,e){return t&&t.length?Je(t,nr(e,2)):0},qn.template=function(t,e,n){var i=qn.templateSettings;n&&hr(t,e,n)&&(e=o),t=gs(t),e=fs({},e,i,Ho);var r,a,s=fs({},e.imports,i.imports,Ho),l=Ts(s),c=He(s,l),d=0,p=e.interpolate||vt,u="__p += '",h=yt((e.escape||vt).source+"|"+p.source+"|"+(p===Q?lt:vt).source+"|"+(e.evaluate||vt).source+"|$","g"),g="//# sourceURL="+(St.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Xt+"]")+"\n";t.replace(h,function(e,n,i,o,s,l){return i||(i=o),u+=t.slice(d,l).replace(ft,Xe),n&&(r=!0,u+="' +\n__e("+n+") +\n'"),s&&(a=!0,u+="';\n"+s+";\n__p += '"),i&&(u+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),d=l+e.length,e}),u+="';\n";var m=St.call(e,"variable")&&e.variable;if(m){if(at.test(m))throw new bt("Invalid `variable` option passed into `_.template`")}else u="with (obj) {\n"+u+"\n}\n";u=(a?u.replace(F,""):u).replace(N,"$1").replace(U,"$1;"),u="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+u+"return __p\n}";var v=Qs(function(){return _t(l,g+"return "+u).apply(o,c)});if(v.source=u,Ha(v))throw v;return v},qn.times=function(t,e){if((t=ds(t))<1||t>c)return[];var n=d,i=hn(t,d);e=nr(e),t-=d;for(var o=Ye(i,e);++n<t;)e(n);return o},qn.toFinite=cs,qn.toInteger=ds,qn.toLength=ps,qn.toLower=function(t){return gs(t).toLowerCase()},qn.toNumber=us,qn.toSafeInteger=function(t){return t?ei(ds(t),-c,c):0===t?t:0},qn.toString=gs,qn.toUpper=function(t){return gs(t).toUpperCase()},qn.trim=function(t,e,n){if((t=gs(t))&&(n||e===o))return Be(t);if(!t||!(e=no(e)))return t;var i=sn(t),r=sn(e);return mo(i,Qe(i,r),Ve(i,r)+1).join("")},qn.trimEnd=function(t,e,n){if((t=gs(t))&&(n||e===o))return t.slice(0,ln(t)+1);if(!t||!(e=no(e)))return t;var i=sn(t);return mo(i,0,Ve(i,sn(e))+1).join("")},qn.trimStart=function(t,e,n){if((t=gs(t))&&(n||e===o))return t.replace(tt,"");if(!t||!(e=no(e)))return t;var i=sn(t);return mo(i,Qe(i,sn(e))).join("")},qn.truncate=function(t,e){var n=30,i="...";if($a(e)){var r="separator"in e?e.separator:r;n="length"in e?ds(e.length):n,i="omission"in e?no(e.omission):i}var a=(t=gs(t)).length;if(tn(t)){var s=sn(t);a=s.length}if(n>=a)return t;var l=n-an(i);if(l<1)return i;var c=s?mo(s,0,l).join(""):t.slice(0,l);if(r===o)return c+i;if(s&&(l+=c.length-l),es(r)){if(t.slice(l).search(r)){var d,p=c;for(r.global||(r=yt(r.source,gs(ct.exec(r))+"g")),r.lastIndex=0;d=r.exec(p);)var u=d.index;c=c.slice(0,u===o?l:u)}}else if(t.indexOf(no(r),l)!=l){var h=c.lastIndexOf(r);h>-1&&(c=c.slice(0,h))}return c+i},qn.unescape=function(t){return(t=gs(t))&&B.test(t)?t.replace(J,cn):t},qn.uniqueId=function(t){var e=++It;return gs(t)+e},qn.upperCase=zs,qn.upperFirst=Hs,qn.each=ga,qn.eachRight=ma,qn.first=Jr,il(qn,function(){var t={};return gi(qn,function(e,n){St.call(qn.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),qn.VERSION="4.17.21",Oe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){qn[t].placeholder=qn}),Oe(["drop","take"],function(t,e){jn.prototype[t]=function(n){n=n===o?1:un(ds(n),0);var i=this.__filtered__&&!e?new jn(this):this.clone();return i.__filtered__?i.__takeCount__=hn(n,i.__takeCount__):i.__views__.push({size:hn(n,d),type:t+(i.__dir__<0?"Right":"")}),i},jn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),Oe(["filter","map","takeWhile"],function(t,e){var n=e+1,i=1==n||3==n;jn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:nr(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}}),Oe(["head","last"],function(t,e){var n="take"+(e?"Right":"");jn.prototype[t]=function(){return this[n](1).value()[0]}}),Oe(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");jn.prototype[t]=function(){return this.__filtered__?new jn(this):this[n](1)}}),jn.prototype.compact=function(){return this.filter(Xs)},jn.prototype.find=function(t){return this.filter(t).head()},jn.prototype.findLast=function(t){return this.reverse().find(t)},jn.prototype.invokeMap=Yi(function(t,e){return"function"==typeof t?new jn(this):this.map(function(n){return xi(n,t,e)})}),jn.prototype.reject=function(t){return this.filter(ka(nr(t)))},jn.prototype.slice=function(t,e){t=ds(t);var n=this;return n.__filtered__&&(t>0||e<0)?new jn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==o&&(n=(e=ds(e))<0?n.dropRight(-e):n.take(e-t)),n)},jn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},jn.prototype.toArray=function(){return this.take(d)},gi(jn.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),r=qn[i?"take"+("last"==e?"Right":""):e],a=i||/^find/.test(e);!r||(qn.prototype[e]=function(){var e=this.__wrapped__,s=i?[1]:arguments,l=e instanceof jn,c=s[0],d=l||Na(e),p=function(t){var e=r.apply(qn,De([t],s));return i&&u?e[0]:e};d&&n&&"function"==typeof c&&1!=c.length&&(l=d=!1);var u=this.__chain__,h=!!this.__actions__.length,g=a&&!u,m=l&&!h;if(!a&&d){e=m?e:new jn(this);var v=t.apply(e,s);return v.__actions__.push({func:ca,args:[p],thisArg:o}),new Rn(v,u)}return g&&m?t.apply(this,s):(v=this.thru(p),g?i?v.value()[0]:v.value():v)})}),Oe(["pop","push","shift","sort","splice","unshift"],function(t){var e=Pt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);qn.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var o=this.value();return e.apply(Na(o)?o:[],t)}return this[n](function(n){return e.apply(Na(n)?n:[],t)})}}),gi(jn.prototype,function(t,e){var n=qn[e];if(n){var i=n.name+"";St.call(Pn,i)||(Pn[i]=[]),Pn[i].push({name:e,func:n})}}),Pn[qo(o,2).name]=[{name:"wrapper",func:o}],jn.prototype.clone=function(){var t=new jn(this.__wrapped__);return t.__actions__=Co(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Co(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Co(this.__views__),t},jn.prototype.reverse=function(){if(this.__filtered__){var t=new jn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},jn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Na(t),i=e<0,o=n?t.length:0,r=function(t,e,n){for(var i=-1,o=n.length;++i<o;){var r=n[i],a=r.size;switch(r.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=hn(e,t+a);break;case"takeRight":t=un(t,e-a)}}return{start:t,end:e}}(0,o,this.__views__),a=r.start,s=r.end,l=s-a,c=i?s:a-1,d=this.__iteratees__,p=d.length,u=0,h=hn(l,this.__takeCount__);if(!n||!i&&o==l&&h==l)return so(t,this.__actions__);var g=[];t:for(;l--&&u<h;){for(var m=-1,v=t[c+=e];++m<p;){var f=d[m],b=f.type,_=(0,f.iteratee)(v);if(2==b)v=_;else if(!_){if(1==b)continue t;break t}}g[u++]=v}return g},qn.prototype.at=da,qn.prototype.chain=function(){return la(this)},qn.prototype.commit=function(){return new Rn(this.value(),this.__chain__)},qn.prototype.next=function(){this.__values__===o&&(this.__values__=ls(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?o:this.__values__[this.__index__++]}},qn.prototype.plant=function(t){for(var e,n=this;n instanceof En;){var i=Lr(n);i.__index__=0,i.__values__=o,e?r.__wrapped__=i:e=i;var r=i;n=n.__wrapped__}return r.__wrapped__=t,e},qn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof jn){var e=t;return this.__actions__.length&&(e=new jn(this)),(e=e.reverse()).__actions__.push({func:ca,args:[$r],thisArg:o}),new Rn(e,this.__chain__)}return this.thru($r)},qn.prototype.toJSON=qn.prototype.valueOf=qn.prototype.value=function(){return so(this.__wrapped__,this.__actions__)},qn.prototype.first=qn.prototype.head,zt&&(qn.prototype[zt]=function(){return this}),qn}();se._=dn,(i=(function(){return dn}).call(e,n,e,t))!==o&&(t.exports=i)}).call(this)},39194:function(t,e,n){"use strict";n.r(e),n.d(e,{AddRepairCustomersModule:function(){return Gs}});var i=n(37716),o=n(38583),r=n(71386),a=n(80521),s=n(39490),l=n(19238),c=n(9359),d=n(79593),p=n(46523),u=n(91786),h=n(14054),g=n(67980),m=n(21860),v=n(13528),f=n(51927),b=n(27969),_=n(65598),M=n(98168),O=n(61528),y=n(70946);function C(t,e,n){for(let i in e)if(e.hasOwnProperty(i)){const o=e[i];o?t.setProperty(i,o,(null==n?void 0:n.has(i))?"important":""):t.removeProperty(i)}return t}function x(t,e){const n=e?"":"none";C(t.style,{"touch-action":e?"":"none","-webkit-user-drag":e?"":"none","-webkit-tap-highlight-color":e?"":"transparent","user-select":n,"-ms-user-select":n,"-webkit-user-select":n,"-moz-user-select":n})}function P(t,e,n){C(t.style,{position:e?"":"fixed",top:e?"":"0",opacity:e?"":"0",left:e?"":"-999em"},n)}function w(t,e){return e&&"none"!=e?t+" "+e:t}function T(t){const e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function D(t,e){return t.getPropertyValue(e).split(",").map(t=>t.trim())}function S(t){const e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function I(t,e,n){const{top:i,bottom:o,left:r,right:a}=t;return n>=i&&n<=o&&e>=r&&e<=a}function k(t,e,n){t.top+=e,t.bottom=t.top+t.height,t.left+=n,t.right=t.left+t.width}function Z(t,e,n,i){const{top:o,right:r,bottom:a,left:s,width:l,height:c}=t,d=l*e,p=c*e;return i>o-p&&i<a+p&&n>s-d&&n<r+d}class A{constructor(t,e){this._document=t,this._viewportRuler=e,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),t.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:S(t)})})}handleScroll(t){const e=(0,a.sA)(t),n=this.positions.get(e);if(!n)return null;const i=e===this._document?e.documentElement:e,o=n.scrollPosition;let r,s;if(e===this._document){const t=this._viewportRuler.getViewportScrollPosition();r=t.top,s=t.left}else r=e.scrollTop,s=e.scrollLeft;const l=o.top-r,c=o.left-s;return this.positions.forEach((t,n)=>{t.clientRect&&e!==n&&i.contains(n)&&k(t.clientRect,l,c)}),o.top=r,o.left=s,{top:l,left:c}}}function q(t){const e=t.cloneNode(!0),n=e.querySelectorAll("[id]"),i=t.nodeName.toLowerCase();e.removeAttribute("id");for(let o=0;o<n.length;o++)n[o].removeAttribute("id");return"canvas"===i?j(t,e):("input"===i||"select"===i||"textarea"===i)&&R(t,e),L("canvas",t,e,j),L("input, textarea, select",t,e,R),e}function L(t,e,n,i){const o=e.querySelectorAll(t);if(o.length){const e=n.querySelectorAll(t);for(let t=0;t<o.length;t++)i(o[t],e[t])}}let E=0;function R(t,e){"file"!==e.type&&(e.value=t.value),"radio"===e.type&&e.name&&(e.name=`mat-clone-${e.name}-${E++}`)}function j(t,e){const n=e.getContext("2d");if(n)try{n.drawImage(t,0,0)}catch(i){}}const F=(0,a.i$)({passive:!0}),N=(0,a.i$)({passive:!1}),U=new Set(["position"]);class J{constructor(t,e,n,i,o,r){this._config=e,this._document=n,this._ngZone=i,this._viewportRuler=o,this._dragDropRegistry=r,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new c.x,this._pointerMoveSubscription=d.w0.EMPTY,this._pointerUpSubscription=d.w0.EMPTY,this._scrollSubscription=d.w0.EMPTY,this._resizeSubscription=d.w0.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new c.x,this.started=new c.x,this.released=new c.x,this.ended=new c.x,this.entered=new c.x,this.exited=new c.x,this.dropped=new c.x,this.moved=this._moveEvents,this._pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){const e=this._handles.find(e=>{const n=(0,a.sA)(t);return!!n&&(n===e||e.contains(n))});e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)},this._pointerMove=t=>{const e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging){if(Math.abs(e.x-this._pickupPositionOnPage.x)+Math.abs(e.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const e=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),n=this._dropContainer;if(!e)return void this._endDragSequence(t);(!n||!n.isDragging()&&!n.isReceiving())&&(t.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(t)))}return}this._boundaryElement&&(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()),t.preventDefault();const n=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(n),this._dropContainer)this._updateActiveDropContainer(n,e);else{const t=this._activeTransform;t.x=n.x-this._pickupPositionOnPage.x+this._passiveTransform.x,t.y=n.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(t.x,t.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${t.x} ${t.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:n,event:t,distance:this._getDragDistance(n),delta:this._pointerDirectionDelta})})},this._pointerUp=t=>{this._endDragSequence(t)},this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new A(n,o),r.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(t){const e=(0,s.Ig)(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions(),this._handles.forEach(t=>x(t,e)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(t=>(0,s.fI)(t)),this._handles.forEach(t=>x(t,this.disabled)),this._toggleNativeDragInteractions();const e=new Set;return this._disabledHandles.forEach(t=>{this._handles.indexOf(t)>-1&&e.add(t)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){const e=(0,s.fI)(t);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,N),e.addEventListener("touchstart",this._pointerDown,F)}),this._initialTransform=void 0,this._rootElement=e),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?(0,s.fI)(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&z(this._rootElement),z(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),x(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),x(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){const t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){const t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&z(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&z(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){H(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._dropContainer;if(e){const t=this._rootElement,n=t.parentNode,i=this._placeholder=this._createPlaceholderElement(),o=this._anchor=this._anchor||this._document.createComment(""),r=this._getShadowRoot();n.insertBefore(o,t),this._initialTransform=t.style.transform||"",this._preview=this._createPreviewElement(),P(t,!1,U),this._document.body.appendChild(n.replaceChild(i,t)),this._getPreviewInsertionPoint(n,r).appendChild(this._preview),this.started.next({source:this}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();const n=this.isDragging(),i=H(e),o=!i&&0!==e.button,r=this._rootElement,s=(0,a.sA)(e),c=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),d=i?(0,l.yG)(e):(0,l.X6)(e);if(s&&s.draggable&&"mousedown"===e.type&&e.preventDefault(),n||o||c||d)return;this._handles.length&&(this._rootElementTapHighlight=r.style.webkitTapHighlightColor||"",r.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>this._updateOnScroll(t)),this._boundaryElement&&(this._boundaryRect=S(this._boundaryElement));const p=this._previewTemplate;this._pickupPositionInElement=p&&p.template&&!p.matchSize?{x:0,y:0}:this._getPointerPositionInElement(t,e);const u=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){P(this._rootElement,!0,U),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const e=this._dropContainer,n=e.getItemIndex(this),i=this._getPointerPositionOnPage(t),o=this._getDragDistance(i),r=e._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:o,dropPoint:i}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:r,distance:o,dropPoint:i}),e.drop(this,n,this._initialIndex,this._initialContainer,r,o,i),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:n,y:i}){let o=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!o&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(o=this._initialContainer),o&&o!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=o,this._dropContainer.enter(this,t,e,o===this._initialContainer&&o.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:o,currentIndex:o.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,i),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_createPreviewElement(){const t=this._previewTemplate,e=this.previewClass,n=t?t.template:null;let i;if(n&&t){const e=t.matchSize?this._rootElement.getBoundingClientRect():null,o=t.viewContainer.createEmbeddedView(n,t.context);o.detectChanges(),i=G(o,this._document),this._previewRef=o,t.matchSize?Q(i,e):i.style.transform=Y(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const t=this._rootElement;i=q(t),Q(i,t.getBoundingClientRect()),this._initialTransform&&(i.style.transform=this._initialTransform)}return C(i.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},U),x(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(t=>i.classList.add(t)):i.classList.add(e)),i}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);const e=function(t){const e=getComputedStyle(t),n=D(e,"transition-property"),i=n.find(t=>"transform"===t||"all"===t);if(!i)return 0;const o=n.indexOf(i),r=D(e,"transition-duration"),a=D(e,"transition-delay");return T(r[o])+T(a[o])}(this._preview);return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{const n=e=>{var o;(!e||(0,a.sA)(e)===this._preview&&"transform"===e.propertyName)&&(null===(o=this._preview)||void 0===o||o.removeEventListener("transitionend",n),t(),clearTimeout(i))},i=setTimeout(n,1.5*e);this._preview.addEventListener("transitionend",n)}))}_createPlaceholderElement(){const t=this._placeholderTemplate,e=t?t.template:null;let n;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),n=G(this._placeholderRef,this._document)):n=q(this._rootElement),n.classList.add("cdk-drag-placeholder"),n}_getPointerPositionInElement(t,e){const n=this._rootElement.getBoundingClientRect(),i=t===this._rootElement?null:t,o=i?i.getBoundingClientRect():n,r=H(e)?e.targetTouches[0]:e,a=this._getViewportScrollPosition();return{x:o.left-n.left+(r.pageX-o.left-a.left),y:o.top-n.top+(r.pageY-o.top-a.top)}}_getPointerPositionOnPage(t){const e=this._getViewportScrollPosition(),n=H(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,i=n.pageX-e.left,o=n.pageY-e.top;if(this._ownerSVGElement){const t=this._ownerSVGElement.getScreenCTM();if(t){const e=this._ownerSVGElement.createSVGPoint();return e.x=i,e.y=o,e.matrixTransform(t.inverse())}}return{x:i,y:o}}_getConstrainedPointerPosition(t){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:n,y:i}=this.constrainPosition?this.constrainPosition(t,this):t;if("x"===this.lockAxis||"x"===e?i=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===e)&&(n=this._pickupPositionOnPage.x),this._boundaryRect){const{x:t,y:e}=this._pickupPositionInElement,o=this._boundaryRect,r=this._previewRect,a=o.top+e,s=o.bottom-(r.height-e);n=B(n,o.left+t,o.right-(r.width-t)),i=B(i,a,s)}return{x:n,y:i}}_updatePointerDirectionDelta(t){const{x:e,y:n}=t,i=this._pointerDirectionDelta,o=this._pointerPositionAtLastDirectionChange,r=Math.abs(e-o.x),a=Math.abs(n-o.y);return r>this._config.pointerDirectionChangeThreshold&&(i.x=e>o.x?1:-1,o.x=e),a>this._config.pointerDirectionChangeThreshold&&(i.y=n>o.y?1:-1,o.y=n),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,x(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,N),t.removeEventListener("touchstart",this._pointerDown,F)}_applyRootElementTransform(t,e){const n=Y(t,e);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform&&"none"!=this._rootElement.style.transform?this._rootElement.style.transform:""),this._rootElement.style.transform=w(n,this._initialTransform)}_applyPreviewTransform(t,e){var n;const i=(null===(n=this._previewTemplate)||void 0===n?void 0:n.template)?void 0:this._initialTransform,o=Y(t,e);this._preview.style.transform=w(o,i)}_getDragDistance(t){const e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(0===t&&0===e||this.isDragging()||!this._boundaryElement)return;const n=this._boundaryElement.getBoundingClientRect(),i=this._rootElement.getBoundingClientRect();if(0===n.width&&0===n.height||0===i.width&&0===i.height)return;const o=n.left-i.left,r=i.right-n.right,a=n.top-i.top,s=i.bottom-n.bottom;n.width>i.width?(o>0&&(t+=o),r>0&&(t-=r)):t=0,n.height>i.height?(a>0&&(e+=a),s>0&&(e-=s)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){const e=this.dragStartDelay;return"number"==typeof e?e:H(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){const e=this._parentPositions.handleScroll(t);if(e){const n=(0,a.sA)(t);this._boundaryRect&&(n===this._document||n!==this._boundaryElement&&n.contains(this._boundaryElement))&&k(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const t=this._parentPositions.positions.get(this._document);return t?t.scrollPosition:this._viewportRuler.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,a.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){const n=this._previewContainer||"global";if("parent"===n)return t;if("global"===n){const t=this._document;return e||t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement||t.body}return(0,s.fI)(n)}}function Y(t,e){return`translate3d(${Math.round(t)}px, ${Math.round(e)}px, 0)`}function B(t,e,n){return Math.max(e,Math.min(n,t))}function z(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function H(t){return"t"===t.type[0]}function G(t,e){const n=t.rootNodes;if(1===n.length&&n[0].nodeType===e.ELEMENT_NODE)return n[0];const i=e.createElement("div");return n.forEach(t=>i.appendChild(t)),i}function Q(t,e){t.style.width=`${e.width}px`,t.style.height=`${e.height}px`,t.style.transform=Y(e.left,e.top)}function V(t,e,n){const i=$(e,t.length-1),o=$(n,t.length-1);if(i===o)return;const r=t[i],a=o<i?-1:1;for(let s=i;s!==o;s+=a)t[s]=t[s+a];t[o]=r}function $(t,e){return Math.max(0,Math.min(e,t))}class W{constructor(t,e,n,i,o){this._dragDropRegistry=e,this._ngZone=i,this._viewportRuler=o,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new c.x,this.entered=new c.x,this.exited=new c.x,this.dropped=new c.x,this.sorted=new c.x,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=d.w0.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new c.x,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(t=0,e=p.z){return t<0&&(t=0),(0,u.H)(t,t,e)}(0,h.Z).pipe((0,v.R)(this._stopScrollTimers)).subscribe(()=>{const t=this._scrollNode,e=this.autoScrollStep;1===this._verticalScrollDirection?X(t,-e):2===this._verticalScrollDirection&&X(t,e),1===this._horizontalScrollDirection?tt(t,-e):2===this._horizontalScrollDirection&&tt(t,e)})},this.element=(0,s.fI)(t),this._document=n,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new A(n,o)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,n,i){let o;this._draggingStarted(),null==i?(o=this.sortingDisabled?this._draggables.indexOf(t):-1,-1===o&&(o=this._getItemIndexFromPointerPosition(t,e,n))):o=i;const r=this._activeDraggables,a=r.indexOf(t),l=t.getPlaceholderElement();let c=r[o];if(c===t&&(c=r[o+1]),a>-1&&r.splice(a,1),c&&!this._dragDropRegistry.isDragging(c)){const e=c.getRootElement();e.parentElement.insertBefore(l,e),r.splice(o,0,t)}else if(this._shouldEnterAsFirstChild(e,n)){const e=r[0].getRootElement();e.parentNode.insertBefore(l,e),r.unshift(t)}else(0,s.fI)(this.element).appendChild(l),r.push(t);l.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,n,i,o,r,a){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:n,container:this,previousContainer:i,isPointerOverContainer:o,distance:r,dropPoint:a})}withItems(t){const e=this._draggables;return this._draggables=t,t.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(e.filter(t=>t.isDragging()).every(e=>-1===t.indexOf(e))?this._reset():this._cacheItems()),this}withDirection(t){return this._direction=t,this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){return this._orientation=t,this}withScrollableParents(t){const e=(0,s.fI)(this.element);return this._scrollableElements=-1===t.indexOf(e)?[e,...t]:t.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?K("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,e=>e.drag===t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,n,i){if(this.sortingDisabled||!this._clientRect||!Z(this._clientRect,.05,e,n))return;const o=this._itemPositions,r=this._getItemIndexFromPointerPosition(t,e,n,i);if(-1===r&&o.length>0)return;const a="horizontal"===this._orientation,s=K(o,e=>e.drag===t),l=o[r],c=l.clientRect,d=s>r?1:-1,p=this._getItemOffsetPx(o[s].clientRect,c,d),u=this._getSiblingOffsetPx(s,o,d),h=o.slice();V(o,s,r),this.sorted.next({previousIndex:s,currentIndex:r,container:this,item:t}),o.forEach((e,n)=>{if(h[n]===e)return;const i=e.drag===t,o=i?p:u,r=i?t.getPlaceholderElement():e.drag.getRootElement();e.offset+=o,a?(r.style.transform=w(`translate3d(${Math.round(e.offset)}px, 0, 0)`,e.initialTransform),k(e.clientRect,0,o)):(r.style.transform=w(`translate3d(0, ${Math.round(e.offset)}px, 0)`,e.initialTransform),k(e.clientRect,o,0))}),this._previousSwap.overlaps=I(c,e,n),this._previousSwap.drag=l.drag,this._previousSwap.delta=a?i.x:i.y}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let n,i=0,o=0;if(this._parentPositions.positions.forEach((r,a)=>{a===this._document||!r.clientRect||n||Z(r.clientRect,.05,t,e)&&([i,o]=function(t,e,n,i){const o=et(e,i),r=nt(e,n);let a=0,s=0;if(o){const e=t.scrollTop;1===o?e>0&&(a=1):t.scrollHeight-e>t.clientHeight&&(a=2)}if(r){const e=t.scrollLeft;1===r?e>0&&(s=1):t.scrollWidth-e>t.clientWidth&&(s=2)}return[a,s]}(a,r.clientRect,t,e),(i||o)&&(n=a))}),!i&&!o){const{width:r,height:a}=this._viewportRuler.getViewportSize(),s={width:r,height:a,top:0,right:r,bottom:a,left:0};i=et(s,e),o=nt(s,t),n=window}n&&(i!==this._verticalScrollDirection||o!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=o,this._scrollNode=n,(i||o)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const t=(0,s.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const t=(0,s.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(t).clientRect}_cacheItemPositions(){const t="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const e=t.getVisibleElement();return{drag:t,offset:0,initialTransform:e.style.transform||"",clientRect:S(e)}}).sort((e,n)=>t?e.clientRect.left-n.clientRect.left:e.clientRect.top-n.clientRect.top)}_reset(){this._isDragging=!1;const t=(0,s.fI)(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{var e;const n=t.getRootElement();if(n){const i=null===(e=this._itemPositions.find(e=>e.drag===t))||void 0===e?void 0:e.initialTransform;n.style.transform=i||""}}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(t,e,n){const i="horizontal"===this._orientation,o=e[t].clientRect,r=e[t+-1*n];let a=o[i?"width":"height"]*n;if(r){const t=i?"left":"top",e=i?"right":"bottom";-1===n?a-=r.clientRect[t]-o[e]:a+=o[t]-r.clientRect[e]}return a}_getItemOffsetPx(t,e,n){const i="horizontal"===this._orientation;let o=i?e.left-t.left:e.top-t.top;return-1===n&&(o+=i?e.width-t.width:e.height-t.height),o}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;const n=this._itemPositions,i="horizontal"===this._orientation;if(n[0].drag!==this._activeDraggables[0]){const o=n[n.length-1].clientRect;return i?t>=o.right:e>=o.bottom}{const o=n[0].clientRect;return i?t<=o.left:e<=o.top}}_getItemIndexFromPointerPosition(t,e,n,i){const o="horizontal"===this._orientation,r=K(this._itemPositions,({drag:r,clientRect:a},s,l)=>{if(r===t)return l.length<2;if(i){const t=o?i.x:i.y;if(r===this._previousSwap.drag&&this._previousSwap.overlaps&&t===this._previousSwap.delta)return!1}return o?e>=Math.floor(a.left)&&e<Math.floor(a.right):n>=Math.floor(a.top)&&n<Math.floor(a.bottom)});return-1!==r&&this.sortPredicate(r,t,this)?r:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(t,e){return null!=this._clientRect&&I(this._clientRect,t,e)}_getSiblingContainerFromPosition(t,e,n){return this._siblings.find(i=>i._canReceive(t,e,n))}_canReceive(t,e,n){if(!this._clientRect||!I(this._clientRect,e,n)||!this.enterPredicate(t,this))return!1;const i=this._getShadowRoot().elementFromPoint(e,n);if(!i)return!1;const o=(0,s.fI)(this.element);return i===o||o.contains(i)}_startReceiving(t,e){const n=this._activeSiblings;!n.has(t)&&e.every(t=>this.enterPredicate(t,this)||this._draggables.indexOf(t)>-1)&&(n.add(t),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(t);e&&(this._itemPositions.forEach(({clientRect:t})=>{k(t,e.top,e.left)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const t=(0,a.kV)((0,s.fI)(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const t=this._activeDraggables.filter(t=>t.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}}function K(t,e){for(let n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1}function X(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function tt(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function et(t,e){const{top:n,bottom:i,height:o}=t,r=.05*o;return e>=n-r&&e<=n+r?1:e>=i-r&&e<=i+r?2:0}function nt(t,e){const{left:n,right:i,width:o}=t,r=.05*o;return e>=n-r&&e<=n+r?1:e>=i-r&&e<=i+r?2:0}const it=(0,a.i$)({passive:!1,capture:!0});let ot=(()=>{class t{constructor(t,e){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=t=>t.isDragging(),this.pointerMove=new c.x,this.pointerUp=new c.x,this.scroll=new c.x,this._preventDefaultWhileDragging=t=>{this._activeDragInstances.length>0&&t.preventDefault()},this._persistentTouchmoveListener=t=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&t.preventDefault(),this.pointerMove.next(t))},this._document=e}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,it)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,it)}startDragging(t,e){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const t=e.type.startsWith("touch");this._globalListeners.set(t?"touchend":"mouseup",{handler:t=>this.pointerUp.next(t),options:!0}).set("scroll",{handler:t=>this.scroll.next(t),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:it}),t||this._globalListeners.set("mousemove",{handler:t=>this.pointerMove.next(t),options:it}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((t,e)=>{this._document.addEventListener(e,t.handler,t.options)})})}}stopDragging(t){const e=this._activeDragInstances.indexOf(t);e>-1&&(this._activeDragInstances.splice(e,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const e=[this.scroll];return t&&t!==this._document&&e.push(new g.y(e=>this._ngZone.runOutsideAngular(()=>{const n=t=>{this._activeDragInstances.length&&e.next(t)};return t.addEventListener("scroll",n,!0),()=>{t.removeEventListener("scroll",n,!0)}}))),(0,m.T)(...e)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,e)=>{this._document.removeEventListener(e,t.handler,t.options)}),this._globalListeners.clear()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.R0b),i.LFG(o.K0))},t.\u0275prov=i.Yz7({factory:function(){return new t(i.LFG(i.R0b),i.LFG(o.K0))},token:t,providedIn:"root"}),t})();const rt={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let at=(()=>{class t{constructor(t,e,n,i){this._document=t,this._ngZone=e,this._viewportRuler=n,this._dragDropRegistry=i}createDrag(t,e=rt){return new J(t,e,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new W(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o.K0),i.LFG(i.R0b),i.LFG(r.rL),i.LFG(ot))},t.\u0275prov=i.Yz7({factory:function(){return new t(i.LFG(o.K0),i.LFG(i.R0b),i.LFG(r.rL),i.LFG(ot))},token:t,providedIn:"root"}),t})();const st=new i.OlP("CDK_DRAG_PARENT"),lt=new i.OlP("CdkDropListGroup"),ct=new i.OlP("CDK_DRAG_CONFIG");let dt=0;const pt=new i.OlP("CdkDropList");let ut=(()=>{class t{constructor(e,n,o,r,a,s,l){this.element=e,this._changeDetectorRef=o,this._scrollDispatcher=r,this._dir=a,this._group=s,this._destroyed=new c.x,this.connectedTo=[],this.id="cdk-drop-list-"+dt++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new i.vpe,this.entered=new i.vpe,this.exited=new i.vpe,this.sorted=new i.vpe,this._unsortedItems=new Set,this._dropListRef=n.createDropList(e),this._dropListRef.data=this,l&&this._assignDefaults(l),this._dropListRef.enterPredicate=(t,e)=>this.enterPredicate(t.data,e.data),this._dropListRef.sortPredicate=(t,e,n)=>this.sortPredicate(t,e.data,n.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),t._dropLists.push(this),s&&s._items.add(this)}get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=(0,s.Ig)(t)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,e)=>t._dragRef.getVisibleElement().compareDocumentPosition(e._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const e=t._dropLists.indexOf(this);e>-1&&t._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe((0,f.O)(this._dir.value),(0,v.R)(this._destroyed)).subscribe(t=>e.withDirection(t)),e.beforeStarted.subscribe(()=>{const n=(0,s.Eq)(this.connectedTo).map(e=>"string"==typeof e?t._dropLists.find(t=>t.id===e):e);if(this._group&&this._group._items.forEach(t=>{-1===n.indexOf(t)&&n.push(t)}),!this._scrollableParentsResolved){const t=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(t=>t.getElementRef().nativeElement);this._dropListRef.withScrollableParents(t),this._scrollableParentsResolved=!0}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=(0,s.Ig)(this.sortingDisabled),e.autoScrollDisabled=(0,s.Ig)(this.autoScrollDisabled),e.autoScrollStep=(0,s.su)(this.autoScrollStep,2),e.connectedTo(n.filter(t=>t&&t!==this).map(t=>t._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(t=>{this.entered.emit({container:this,item:t.item.data,currentIndex:t.currentIndex})}),t.exited.subscribe(t=>{this.exited.emit({container:this,item:t.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(t=>{this.sorted.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,container:this,item:t.item.data})}),t.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,item:t.item.data,isPointerOverContainer:t.isPointerOverContainer,distance:t.distance,dropPoint:t.dropPoint}),this._changeDetectorRef.markForCheck()})}_assignDefaults(t){const{lockAxis:e,draggingDisabled:n,sortingDisabled:i,listAutoScrollDisabled:o,listOrientation:r}=t;this.disabled=null!=n&&n,this.sortingDisabled=null!=i&&i,this.autoScrollDisabled=null!=o&&o,this.orientation=r||"vertical",e&&(this.lockAxis=e)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(at),i.Y36(i.sBO),i.Y36(r.mF),i.Y36(y.Is,8),i.Y36(lt,12),i.Y36(ct,8))},t.\u0275dir=i.lG2({type:t,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,e){2&t&&(i.uIk("id",e.id),i.ekj("cdk-drop-list-disabled",e.disabled)("cdk-drop-list-dragging",e._dropListRef.isDragging())("cdk-drop-list-receiving",e._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],id:"id",enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],orientation:["cdkDropListOrientation","orientation"],lockAxis:["cdkDropListLockAxis","lockAxis"],data:["cdkDropListData","data"],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[i._Bn([{provide:lt,useValue:void 0},{provide:pt,useExisting:t}])]}),t._dropLists=[],t})();const ht=new i.OlP("CdkDragHandle"),gt=new i.OlP("CdkDragPlaceholder"),mt=new i.OlP("CdkDragPreview");let vt=(()=>{class t{constructor(e,n,o,r,a,s,l,d,p,u,h){this.element=e,this.dropContainer=n,this._ngZone=r,this._viewContainerRef=a,this._dir=l,this._changeDetectorRef=p,this._selfHandle=u,this._parentDrag=h,this._destroyed=new c.x,this.started=new i.vpe,this.released=new i.vpe,this.ended=new i.vpe,this.entered=new i.vpe,this.exited=new i.vpe,this.dropped=new i.vpe,this.moved=new g.y(t=>{const e=this._dragRef.moved.pipe((0,b.U)(t=>({source:this,pointerPosition:t.pointerPosition,event:t.event,delta:t.delta,distance:t.distance}))).subscribe(t);return()=>{e.unsubscribe()}}),this._dragRef=d.createDrag(e,{dragStartThreshold:s&&null!=s.dragStartThreshold?s.dragStartThreshold:5,pointerDirectionChangeThreshold:s&&null!=s.pointerDirectionChangeThreshold?s.pointerDirectionChangeThreshold:5,zIndex:null==s?void 0:s.zIndex}),this._dragRef.data=this,t._dragInstances.push(this),s&&this._assignDefaults(s),n&&(this._dragRef._withDropContainer(n._dropListRef),n.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=(0,s.Ig)(t),this._dragRef.disabled=this._disabled}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,_.q)(1),(0,v.R)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const e=t.rootElementSelector,n=t.freeDragPosition;e&&!e.firstChange&&this._updateRootElement(),n&&!n.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const e=t._dragInstances.indexOf(this);e>-1&&t._dragInstances.splice(e,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const t=this.element.nativeElement,e=this.rootElementSelector?ft(t,this.rootElementSelector):t;this._dragRef.withRootElement(e||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?ft(this.element.nativeElement,t):(0,s.fI)(t):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){const t=this._dir,n=this.dragStartDelay,i=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,o=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.dragStartDelay="object"==typeof n&&n?n:(0,s.su)(n),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(i).withPreviewTemplate(o).withPreviewContainer(this.previewContainer||"global"),t&&e.withDirection(t.value)}}),e.beforeStarted.pipe((0,_.q)(1)).subscribe(()=>{var n,i;if(this._parentDrag)return void e.withParent(this._parentDrag._dragRef);let o=this.element.nativeElement.parentElement;for(;o;){if(null===(n=o.classList)||void 0===n?void 0:n.contains("cdk-drag")){e.withParent((null===(i=t._dragInstances.find(t=>t.element.nativeElement===o))||void 0===i?void 0:i._dragRef)||null);break}o=o.parentElement}})}_handleEvents(t){t.started.subscribe(()=>{this.started.emit({source:this}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(()=>{this.released.emit({source:this})}),t.ended.subscribe(t=>{this.ended.emit({source:this,distance:t.distance,dropPoint:t.dropPoint}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(t=>{this.entered.emit({container:t.container.data,item:this,currentIndex:t.currentIndex})}),t.exited.subscribe(t=>{this.exited.emit({container:t.container.data,item:this})}),t.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,isPointerOverContainer:t.isPointerOverContainer,item:this,distance:t.distance,dropPoint:t.dropPoint})})}_assignDefaults(t){const{lockAxis:e,dragStartDelay:n,constrainPosition:i,previewClass:o,boundaryElement:r,draggingDisabled:a,rootElementSelector:s,previewContainer:l}=t;this.disabled=null!=a&&a,this.dragStartDelay=n||0,e&&(this.lockAxis=e),i&&(this.constrainPosition=i),o&&(this.previewClass=o),r&&(this.boundaryElement=r),s&&(this.rootElementSelector=s),l&&(this.previewContainer=l)}_setupHandlesListener(){this._handles.changes.pipe((0,f.O)(this._handles),(0,M.b)(t=>{const e=t.filter(t=>t._parentDrag===this).map(t=>t.element);this._selfHandle&&this.rootElementSelector&&e.push(this.element),this._dragRef.withHandles(e)}),(0,O.w)(t=>(0,m.T)(...t.map(t=>t._stateChanges.pipe((0,f.O)(t))))),(0,v.R)(this._destroyed)).subscribe(t=>{const e=this._dragRef,n=t.element.nativeElement;t.disabled?e.disableHandle(n):e.enableHandle(n)})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(pt,12),i.Y36(o.K0),i.Y36(i.R0b),i.Y36(i.s_b),i.Y36(ct,8),i.Y36(y.Is,8),i.Y36(at),i.Y36(i.sBO),i.Y36(ht,10),i.Y36(st,12))},t.\u0275dir=i.lG2({type:t,selectors:[["","cdkDrag",""]],contentQueries:function(t,e,n){if(1&t&&(i.Suo(n,mt,5),i.Suo(n,gt,5),i.Suo(n,ht,5)),2&t){let t;i.iGM(t=i.CRH())&&(e._previewTemplate=t.first),i.iGM(t=i.CRH())&&(e._placeholderTemplate=t.first),i.iGM(t=i.CRH())&&(e._handles=t)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,e){2&t&&i.ekj("cdk-drag-disabled",e.disabled)("cdk-drag-dragging",e._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],previewContainer:["cdkDragPreviewContainer","previewContainer"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[i._Bn([{provide:st,useExisting:t}]),i.TTD]}),t._dragInstances=[],t})();function ft(t,e){let n=t.parentElement;for(;n;){if(n.matches?n.matches(e):n.msMatchesSelector(e))return n;n=n.parentElement}return null}let bt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[at],imports:[r.ZD]}),t})();var _t=n(43220),Mt=n(76627),Ot=n(55278),yt=n(29790);const Ct=["*"];let xt=(()=>{class t{constructor(t,e){this.elt=t,this.renderer=e,this.onStart=new i.vpe,this.onStop=new i.vpe,this.onTick=new i.vpe,this.onComplete=new i.vpe,this.autoStart=!0,this.startTime=0,this.endTime=0,this.timeoutId=null,this.countdown=!1,this.format="default"}ngAfterViewInit(){const t=this.elt.nativeElement.lastChild;this.ngContentSchema=t?t.nodeValue:"",(void 0===this.autoStart||!0===this.autoStart)&&this.start()}ngOnDestroy(){this.resetTimeout()}start(){this.initVar(),this.resetTimeout(),this.computeTimeUnits(),this.startTickCount(),this.onStart.emit(this)}resume(){this.resetTimeout(),this.startTickCount()}stop(){this.clear(),this.onStop.emit(this)}reset(){this.initVar(),this.resetTimeout(),this.clear(),this.computeTimeUnits(),this.renderText()}get(){return{seconds:this.seconds,minutes:this.minutes,hours:this.hours,days:this.days,timer:this.timeoutId,tick_count:this.tickCounter}}initVar(){this.startTime=this.startTime||0,this.endTime=this.endTime||0,this.countdown=this.countdown||!1,this.tickCounter=this.startTime,this.countdown&&0===this.startTime&&(this.countdown=!1),this.format||(this.format=this.ngContentSchema.length>5?"user":"default")}resetTimeout(){this.timeoutId&&clearInterval(this.timeoutId)}renderText(){let t;if("user"===this.format){const e={seconds:this.seconds,minutes:this.minutes,hours:this.hours,days:this.days};t=this.ngContentSchema;for(const n of Object.keys(e))t=t.replace("["+n+"]",e[n].toString())}else"intelli"===this.format?(t="",this.days>0&&(t+=this.days.toString()+"day"+(this.days>1?"s":"")+" "),(this.hours>0||this.days>0)&&(t+=this.hours.toString()+"h "),(this.minutes>0||this.hours>0)&&0===this.days&&(t+=this.minutes.toString().padStart(2,"0")+"min "),0===this.hours&&0===this.days&&(t+=this.seconds.toString().padStart(2,"0")+"s")):"hms"===this.format?(t=this.hours.toString().padStart(2,"0")+":",t+=this.minutes.toString().padStart(2,"0")+":",t+=this.seconds.toString().padStart(2,"0")):"ms"===this.format?(t="",this.hours>0&&(t=this.hours.toString().padStart(2,"0")+":"),t+=this.minutes.toString().padStart(2,"0")+":",t+=this.seconds.toString().padStart(2,"0")):(t=this.days.toString()+"d ",t+=this.hours.toString()+"h ",t+=this.minutes.toString()+"m ",t+=this.seconds.toString()+"s");this.renderer.setProperty(this.elt.nativeElement,"innerHTML",t)}clear(){this.resetTimeout(),this.timeoutId=null}computeTimeUnits(){this.maxTimeUnit&&"day"!==this.maxTimeUnit?"second"===this.maxTimeUnit?(this.seconds=this.tickCounter,this.minutes=0,this.hours=0,this.days=0):"minute"===this.maxTimeUnit?(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60),this.hours=0,this.days=0):"hour"===this.maxTimeUnit&&(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60%60),this.hours=Math.floor(this.tickCounter/3600),this.days=0):(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60%60),this.hours=Math.floor(this.tickCounter/3600%24),this.days=Math.floor(this.tickCounter/3600/24)),this.renderText()}startTickCount(){const t=this;t.timeoutId=setInterval(function(){let e;if(t.countdown?(e=t.tickCounter,t.startTime>t.endTime&&(e=t.tickCounter-t.endTime-1)):(e=t.tickCounter-t.startTime,t.endTime>t.startTime&&(e=t.endTime-t.tickCounter-1)),t.computeTimeUnits(),t.onTick.emit({seconds:t.seconds,minutes:t.minutes,hours:t.hours,days:t.days,timer:t.timeoutId,tick_count:t.tickCounter}),e<0)return t.stop(),void t.onComplete.emit(t);t.countdown?t.tickCounter--:t.tickCounter++},1e3)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(i.Qsj))},t.\u0275cmp=i.Xpm({type:t,selectors:[["cd-timer"]],inputs:{startTime:"startTime",endTime:"endTime",countdown:"countdown",autoStart:"autoStart",maxTimeUnit:"maxTimeUnit",format:"format"},outputs:{onStart:"onStart",onStop:"onStop",onTick:"onTick",onComplete:"onComplete"},ngContentSelectors:Ct,decls:1,vars:0,template:function(t,e){1&t&&(i.F$t(),i.Hsn(0))},encapsulation:2}),t})(),Pt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[]]}),t})();var wt=n(30132),Tt=n(74743),Dt=n(88784),St=n(44466),It=n(89993),kt=n(97582),Zt=n(54121),At=n(57445),qt=n(22238),Lt=n(38588),Et=n(95016),Rt=n(77782),jt=n(3679);const Ft=[{name:"Front",displayName:"Front",image:"assets/img/part-front.png",title:"",subTitle:"",active:!0},{name:"Right Side",displayName:"Right Side",image:"assets/img/part-right.png",title:"",subTitle:""},{name:"Left Side",displayName:"Left Side",image:"assets/img/part-left.png",title:"",subTitle:""},{name:"Above",displayName:"Above",image:"assets/img/part-above.png",title:"",subTitle:""},{name:"Rear",displayName:"Rear",image:"assets/img/part-rear.png",title:"",subTitle:""},{name:"Interior",displayName:"Interior",image:"assets/img/part-interior.png",title:"",subTitle:""},{name:"Mechanical",displayName:"Mechanical",image:"assets/img/part-mechanical.png",title:"",subTitle:""}];var Nt=n(67017),Ut=n(36978);const Jt=["operationType"];let Yt=(()=>{class t{constructor(){this.formData={operationType:"",operation:"",code:"",repairType:"",quantity:0,price:0,labourTime:0,labourAmount:0},this.addButtonModel={label:"Add",type:"disabled",icon:"",onclick:this.submitForm.bind(this)},this.resetButtonModel={label:"Reset",type:"outline",icon:"",onclick:this.resetForm.bind(this)},this.menuItems=Ft}ngOnInit(){this.formModel={operationType:{placeHolder:"Select Operation Type",name:"operationType",label:"Operation Type",options:[{id:1,name:"Check"}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"operationType",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"Please select operation type":""}},operation:{placeHolder:"Part/Operation",label:"part/operation",name:"operation",options:[{id:1,name:"Top-Section M"}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"operation",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"Please enter part/operation":""}},code:{placeHolder:"Code",label:"Code",name:"code",value:"",type:"text",maxLength:50,validation:{name:"code",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(50),jt.kI.pattern(/^[a-z\d\s]+$/i)]),validationMessage:t=>t.maxlength?"Code should have not more than 50 characters":t.pattern?"Only alphanumberic characters are allowed":""}},repairType:{placeHolder:"Select Repair type",name:"repairType",label:"REPAIR TYPE",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:""},quantity:{placeHolder:"Quantity",label:"Quantity",name:"quantity",value:"",type:"number",validation:{name:"quantity",validationFunction:()=>jt.kI.compose([]),validationMessage:t=>""}},price:{placeHolder:"Price",label:"Price",name:"price",value:"",type:"number",validation:{name:"price",validationFunction:()=>jt.kI.compose([]),validationMessage:t=>""}},labourTime:{placeHolder:"Labour Time",name:"labourTime",label:"Labour time(HOURs)",value:0,type:"number",validation:{name:"time",validationFunction:()=>jt.kI.compose([]),validationMessage:t=>""}}}}submitForm(){}resetForm(t=!0){}hideDropdown(t){var e;t===this.formModel.operationType.name&&(null===(e=this.operationType)||void 0===e||e.closeDropdown())}onFormUpdate(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-part-add"]],viewQuery:function(t,e){if(1&t&&i.Gf(Jt,5),2&t){let t;i.iGM(t=i.CRH())&&(e.operationType=t.first)}},decls:32,vars:11,consts:[[1,"estimate-add-part","fx-col","h-100"],[1,"toolbar"],[3,"mode","menuItems"],["tabs",""],[1,"fx-1"],[1,"row"],[1,"col-6"],[3,"inputModel","clicked","controlOutput"],["operationType",""],["operationControl",""],["codeControl",""],[1,"col-6",3,"inputModel","clicked","controlOutput"],[1,"col-6","repair-type"],[1,"footer-button","fx-row","justify-end"],[1,"reset-button",3,"buttonModel"],[3,"buttonModel"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i._UZ(2,"chq-tabs",2,3),i.qZA(),i.TgZ(4,"form",4),i.TgZ(5,"div",5),i.TgZ(6,"div",6),i.TgZ(7,"chq-input",7,8),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.TgZ(9,"div",6),i.TgZ(10,"chq-input",7,9),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(12,"div",5),i.TgZ(13,"div",6),i.TgZ(14,"chq-input",7,10),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.TgZ(16,"div",6),i.TgZ(17,"div",5),i.TgZ(18,"chq-input",11),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.TgZ(19,"chq-input",11),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(20,"div",5),i.TgZ(21,"div",12),i.TgZ(22,"chq-input",7),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.TgZ(23,"div",6),i.TgZ(24,"div",5),i.TgZ(25,"chq-input",11),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(26,"div",5),i._UZ(27,"div",6),i.TgZ(28,"div",6),i.TgZ(29,"div",13),i._UZ(30,"chq-button",14),i._UZ(31,"chq-button",15),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.Q6J("mode","default")("menuItems",e.menuItems),i.xp6(5),i.Q6J("inputModel",e.formModel.operationType),i.xp6(3),i.Q6J("inputModel",e.formModel.operation),i.xp6(4),i.Q6J("inputModel",e.formModel.code),i.xp6(4),i.Q6J("inputModel",e.formModel.quantity),i.xp6(1),i.Q6J("inputModel",e.formModel.price),i.xp6(3),i.Q6J("inputModel",e.formModel.repairType),i.xp6(3),i.Q6J("inputModel",e.formModel.labourTime),i.xp6(5),i.Q6J("buttonModel",e.resetButtonModel),i.xp6(1),i.Q6J("buttonModel",e.addButtonModel))},directives:[Rt.K,jt._Y,jt.JL,jt.F,Nt.D,Ut.E],styles:[".estimate-add-part[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{margin-bottom:20px}.estimate-add-part[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   chq-tabs[_ngcontent-%COMP%]     button{flex-direction:column;height:45px;grid-gap:0px;gap:0px;font-size:12px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{grid-gap:15px;gap:15px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:195px}"]}),t})();const Bt=()=>({placeHolder:"labour_time",name:"labourTime",label:"labour_time_hours",value:0,type:"number",maxLength:4,validation:{name:"labourTime",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(4)]),validationMessage:t=>t.maxlength?"labour_time_not_be_more_than_4_characters":""}}),zt=(t,e)=>{var n;return{placeHolder:"labour_amount",name:"labourAmount",label:(null===(n=t.instant("labour_amount_currency"))||void 0===n?void 0:n.replace("{{currency}}",e))||"",value:0,type:"number",maxLength:7,validation:{name:"labourTime",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(7)]),validationMessage:t=>t.maxlength?"labour_amount_not_be_more_than_7_characters":""}}};function Ht(){const t={invalidPrice:!1};return e=>e.value>9999999.99?(t.invalidPrice=!0,t):null}const Gt={replace:"Replace",repair:"Repair",removeAndRefit:"Remove & Refit",painting:"Painting",polish:"Polish",checkFields:"Check",performFields:"Perform"};var Qt=n(7408),Vt=n(75983),$t=n(8985),Wt=n(92340),Kt=n(91841);let Xt=(()=>{class t{constructor(t){this.http=t,this.apiUrl="operation",this.repairOperationType=[]}getOperations(t,e=null){const n=(t.currentPage-1)*t.pageSize;return this.http.get(`${Wt.N.caseMgmtUrl}/odata/${this.apiUrl}?${e=e?`$top=${t.pageSize}&$skip=${n}&${e}`:`$top=${t.pageSize}&$skip=${n}`}&$orderby=${t.orderBy} ${t.sortDirection}&count=true`)}getRepairOperationType(){return this.http.get(`${Wt.N.caseMgmtUrl}/api/lookup?type=RepairOperationType`)}addRepairOperation(t,e){return this.http.post(`${Wt.N.caseMgmtUrl}/api/operation/${t}`,e)}editRepairOperation(t){return this.http.put(`${Wt.N.caseMgmtUrl}/api/operation`,t)}deleteOperation(t){return this.http.delete(`${Wt.N.caseMgmtUrl}/api/operation/${t}`)}editRepairEstimateOperation(t,e){return this.http.put(`${Wt.N.caseMgmtUrl}/api/operation/repairoperation/${t}`,e)}getRepairEstimateOperationDetails(t){return this.http.get(`${Wt.N.caseMgmtUrl}/api/operation/repairoperation/${t}`)}deleteRepairEstimateOperation(t,e){return this.http.delete(`${Wt.N.caseMgmtUrl}/api/operation/repairoperation/${t}/${e}`)}addOperationsToReapir(t,e){return this.http.post(`${Wt.N.caseMgmtUrl}/api/operation/repairoperation/${t}`,e)}getParts(t){return this.http.get(`${Wt.N.caseMgmtUrl}/api/repair/${t}/parts`)}getPartStatuses(){return this.http.get(`${Wt.N.caseMgmtUrl}/api/lookup?type=PartStatus`)}editPartStatuses(t,e){return this.http.put(`${Wt.N.caseMgmtUrl}/api/repair/${e}/partStatus`,t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Kt.eN))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var te=n(4893);const ee=["operationTypeControl"],ne=["repairTypeControl"],ie=["operationControl"],oe=["codeControl"],re=["informationControl"],ae=["labourAmountControl"],se=["labourTimeControl"],le=["quantityControl"],ce=["priceControl"];function de(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",2),i.TgZ(1,"chq-input",19,20),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.TgZ(3,"chq-input",19,21),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("inputModel",t.formModel.quantity),i.xp6(2),i.Q6J("inputModel",t.formModel.price)}}function pe(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",2),i.TgZ(1,"chq-input",19,22),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.TgZ(3,"chq-input",19,23),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("inputModel",t.formModel.labourAmount),i.xp6(2),i.Q6J("inputModel",t.formModel.labourTime)}}function ue(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-input",19,22),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw(2).hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw(2).onFormUpdate(e)}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("inputModel",t.formModel.labourAmount)}}function he(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",2),i.YNc(1,ue,2,1,"chq-input",24),i.TgZ(2,"chq-input",19,23),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngIf",t.formData.operationType===t.OPERATION_TYPE.replace),i.xp6(1),i.Q6J("inputModel",t.formModel.labourTime)}}function ge(t,e){1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"div",26),i._UZ(2,"mat-icon",27),i.qZA(),i.TgZ(3,"span"),i._uU(4),i.ALo(5,"translate"),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.Q6J("svgIcon","information-operation"),i.xp6(2),i.Oqu(i.lcZ(5,2,"operation_replace_information_popup")))}function me(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-input",28),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("inputModel",t.formModel.saveOperation)}}let ve=(()=>{class t{constructor(t,e,n,o,r,a){this.bookingService=t,this.repairEstimateOperationService=e,this.commonService=n,this.monitorService=o,this.changeDetectorRef=r,this.translateService=a,this.switchToOperationLIst=new i.vpe,this.cancelDialog=new i.vpe,this.OPERATION_TYPE=Gt,this.formData={operationType:"",operation:"",code:"",repairType:"",information:"",quantity:0,price:0,labourTime:0,labourAmount:0,saveOperation:!1},this.currencySymbol="",this.addButtonModel={label:"add",type:"disabled",icon:"",onclick:this.beforeSubmit.bind(this)},this.resetButtonModel={label:"reset",type:"outline",icon:"",onclick:this.resetForm.bind(this)},this.i18n=this.commonService.geti18nInfo(),this.currencySymbol=this.i18n.currencySymbol}ngOnInit(){var t,e;this.monitorService.logEvent("ngOnInit",["OperationAddComponent","addenda-repair"]),this.formModel={operationType:{placeHolder:"select_operation_type",name:"operationType",label:"operation_type",options:[{}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,showSelectedOption:!1,validation:{name:"operationType",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"please_select_operation_type":""}},operation:{placeHolder:"part_operation",label:"part_operation",name:"operation",value:0,type:"text",maxLength:50,required:!0,validation:{name:"operation",validationFunction:()=>jt.kI.compose([jt.kI.required,jt.kI.maxLength(50),jt.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:t=>t.required?"please_enter_part_operation":t.maxlength?"part_operation_should_have_not_more_than_50_characters":t.pattern?"part_operation_only_alphanumberic_characters":""}},code:{placeHolder:"code",label:"code",name:"code",value:"",type:"text",maxLength:50,validation:{name:"code",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(50),jt.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:t=>t.maxlength?"code_should_have_not_more_than_50_characters":t.pattern?"part_operation_only_alphanumberic_characters":""}},repairType:{placeHolder:"select_repair_type",name:"repairType",label:"repair_type",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:"",required:!0,validation:{name:"repairType",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"please_select_repair_type":""}},information:{placeHolder:"information",label:"information",name:"information",value:"",type:"textarea",maxLength:150,validation:{name:"information",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(150),jt.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:t=>t.maxlength?"information_should_have_not_more_than_150_characters":t.pattern?"part_operation_only_alphanumberic_characters":""}},saveOperation:{placeHolder:"",label:"",name:"saveOperation",idField:"saveOperation",value:1,type:"checkbox",options:[{label:"save_operation",id:1,value:1,checked:!1}]}},!this.formModel.operationType.observable&&!(null===(t=this.repairEstimateOperationService.repairOperationType)||void 0===t?void 0:t.length)&&(this.formModel.operationType.observable=this.repairEstimateOperationService.getRepairOperationType(),this.formModel.operationType.onObservableLoad=this.onObservableLoadOperationType.bind(this)),!this.formModel.repairType.observable&&!(null===(e=this.bookingService.repairTypes)||void 0===e?void 0:e.length)&&(this.formModel.repairType.observable=this.bookingService.getRepairTypes(),this.formModel.repairType.onObservableLoad=this.onObservableLoadRepairTypes.bind(this))}ngAfterViewInit(){var t,e;this.monitorService.logEvent("ngAfterViewInit",["OperationAddComponent","addenda-repair"]),this.populateFormData(),(null===(t=this.repairEstimateOperationService.repairOperationType)||void 0===t?void 0:t.length)&&this.onObservableLoadOperationType(this.repairEstimateOperationService.repairOperationType),(null===(e=this.bookingService.repairTypes)||void 0===e?void 0:e.length)&&this.onObservableLoadRepairTypes(this.bookingService.repairTypes),this.checkForFormValidation()}populateFormData(){this.operationToEdit&&(Object.keys(this.operationToEdit).length>0&&(this.addButtonModel.label="save"),this.operationToEdit.Code&&(this.formModel.code=Object.assign(Object.assign({},this.formModel.code),{value:this.operationToEdit.Code}),this.formData.code=this.operationToEdit.Code),this.operationToEdit.Information&&(this.formModel.information.value=this.operationToEdit.Information,this.formData.information=this.operationToEdit.Information),this.operationToEdit.OperationName&&(this.formModel.operation=Object.assign(Object.assign({},this.formModel.operation),{value:this.operationToEdit.OperationName}),this.formData.operation=this.operationToEdit.OperationName))}populateConditionalFieldsData(){var t,e;this.operationToEdit&&(this.operationToEdit.Price&&this.formModel.price&&(this.formModel.price.value=this.operationToEdit.Price,this.formData.price=this.operationToEdit.Price),this.operationToEdit.LabourTime&&this.formModel.labourTime&&(this.formModel.labourTime.value=this.operationToEdit.LabourTime,this.formData.labourTime=this.operationToEdit.LabourTime),this.operationToEdit.LabourAmount&&this.formModel.labourAmount&&(this.formModel.labourAmount.value=this.operationToEdit.LabourAmount,this.formData.labourAmount=this.operationToEdit.LabourAmount),this.operationToEdit.Quantity&&this.formModel.quantity&&(this.formModel.quantity.value=this.operationToEdit.Quantity,this.formData.quantity=this.operationToEdit.Quantity),(this.operationToEdit.LabourAmount||this.operationToEdit.LabourTime)&&this.formData.operationType!==Gt.replace&&this.formData.operationType!==Gt.painting&&(this.operationToEdit.LabourAmount?(null===(t=this.formModel)||void 0===t?void 0:t.labourTime)&&(this.formModel.labourTime.disabled=!0):(null===(e=this.formModel)||void 0===e?void 0:e.labourAmount)&&(this.formModel.labourAmount.disabled=!0)),this.checkForFormValidation(),this.triggerValidation())}triggerValidation(){Object.keys(this.formModel).forEach(t=>{var e,n;"saveOperation"!==t&&(null===(n=null===(e=this.formModel[t])||void 0===e?void 0:e.formControl)||void 0===n?void 0:n.markAsTouched)&&this.formModel[t].formControl.markAsTouched()})}setInitialStateOfForm(){var t;if(null===(t=this.operationToEdit)||void 0===t?void 0:t.RepairOperationTypeId){const t=this.formModel.operationType.options.find(t=>t.id===this.operationToEdit.RepairOperationTypeId);t&&(this.formModel.operationType=Object.assign(Object.assign({},this.formModel.operationType),{selectedOption:t}),this.showHideFieldsBasedOnOperationType({name:this.formModel.operationType.name,type:this.formModel.operationType.type,value:t}),this.populateConditionalFieldsData())}else{const t=this.formModel.operationType.options.find(t=>t.name===Gt.replace);t&&(this.formModel.operationType=Object.assign(Object.assign({},this.formModel.operationType),{selectedOption:t}),this.showHideFieldsBasedOnOperationType({name:this.formModel.operationType.name,type:this.formModel.operationType.type,value:t}))}}hideDropdown(t){t===this.formModel.operationType.name?this.repairTypeControl.closeDropdown():t===this.formModel.repairType.name&&this.operationTypeControl.closeDropdown()}onFormUpdate(t){var e,n,i,o;if("select"===t.type)if(this.formModel[t.name]=Object.assign(Object.assign({},this.formModel[t.name]),{selectedOption:t.value}),"operationType"===t.name)if(this.formData[t.name]=(null===(e=null==t?void 0:t.value)||void 0===e?void 0:e.name)||"",this.showHideFieldsBasedOnOperationType(t),(null===(n=null==t?void 0:t.value)||void 0===n?void 0:n.name)===Gt.painting||(null===(i=null==t?void 0:t.value)||void 0===i?void 0:i.name)===Gt.polish){const t=null===(o=this.formModel.repairType.options)||void 0===o?void 0:o.find(t=>"paint"===t.name.toLowerCase());t&&(this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:t}),this.formData.repairType=t.name,this.repairTypeControl.getDropdownOutput({name:this.formModel.repairType.name,type:this.formModel.repairType.type,value:t}))}else this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:{}}),this.formData.repairType="";else this.formData[t.name]="repairType"===t.name?t.value.name:t.value;else this.formModel[t.name].value=t.value,this.formData[t.name]=t.value,this.formData.operationType!==Gt.painting&&("labourAmount"===t.name?this.formModel.labourTime.disabled=!!t.value:"labourTime"===t.name&&(this.formModel.labourAmount.disabled=!!t.value));this.checkForFormValidation()}showHideFieldsBasedOnOperationType(t){var e,n,i,o,r,a,s,l,c;this.formData[t.name]=(null===(e=null==t?void 0:t.value)||void 0===e?void 0:e.name)||"",(null===(n=null==t?void 0:t.value)||void 0===n?void 0:n.name)===Gt.replace||(null===(i=null==t?void 0:t.value)||void 0===i?void 0:i.name)===Gt.painting?(delete this.formModel.labourTime,delete this.formModel.labourAmount,this.formModel.quantity={placeHolder:"quantity",name:"quantity",label:"quantity",value:0,type:"number",maxLength:3,validation:{name:"quantity",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(3)]),validationMessage:t=>t.maxlength?"quantity_should_not_be_more_than_3_characters":""}},this.formModel.price=((t,e)=>{var n;return{placeHolder:"price",name:"price",label:(null===(n=this.translateService.instant("price_currency"))||void 0===n?void 0:n.replace("{{currency}}",e))||"",value:0,type:"number",maxLength:10,validation:{name:"price",validationFunction:()=>jt.kI.compose([Ht()]),validationMessage:t=>t.invalidPrice?"price_max_length_validation":""}}})(0,this.currencySymbol),this.formModel.labourTime=Bt(),(null===(o=null==t?void 0:t.value)||void 0===o?void 0:o.name)===Gt.replace&&(this.formModel.labourAmount=zt(this.translateService,this.currencySymbol)),this.resetFormData()):(null===(r=null==t?void 0:t.value)||void 0===r?void 0:r.name)===Gt.repair||(null===(a=null==t?void 0:t.value)||void 0===a?void 0:a.name)===Gt.removeAndRefit||(null===(s=null==t?void 0:t.value)||void 0===s?void 0:s.name)===Gt.polish||(null===(l=null==t?void 0:t.value)||void 0===l?void 0:l.name)===Gt.checkFields||(null===(c=null==t?void 0:t.value)||void 0===c?void 0:c.name)===Gt.performFields?(delete this.formModel.quantity,delete this.formModel.price,delete this.formModel.labourTime,this.formModel.labourAmount=zt(this.translateService,this.currencySymbol),this.formModel.labourTime=Bt(),this.resetFormData()):(delete this.formModel.quantity,delete this.formModel.price,delete this.formModel.labourTime,delete this.formModel.labourAmount,delete this.formModel.labourTime,this.resetFormData())}resetFormData(){var t;this.formData.labourTime=0,this.formData.labourAmount=0,this.formData.price=0,this.formData.quantity=0,(null===(t=this.operationToEdit)||void 0===t?void 0:t.Quantity)||this.formModel.quantity&&(this.formModel.quantity.value=1,this.formData.quantity=1)}checkForFormValidation(){this.addButtonModel.type=this.isOperationFormValid()?"primary":"disabled"}isOperationFormValid(){this.changeDetectorRef.detectChanges();let t=!0;return this.formData.operationType&&this.formData.repairType&&this.formData.operation&&this.operationControl.formControl.valid&&this.codeControl.formControl.valid&&this.informationControl.formControl.valid||(t=!1),this.formData.operationType===Gt.replace||this.formData.operationType===Gt.painting?(this.quantityControl.formControl.valid&&this.priceControl.formControl.valid&&this.labourTimeControl.formControl.valid||(t=!1),this.formData.operationType===Gt.replace&&!this.labourAmountControl.formControl.valid&&(t=!1),this.formData.operationType===Gt.replace&&!this.formData.labourTime&&!this.formData.labourAmount&&(t=!1)):this.formData.operationType!==Gt.repair&&this.formData.operationType!==Gt.removeAndRefit&&this.formData.operationType!==Gt.polish&&this.formData.operationType!==Gt.checkFields&&this.formData.operationType!==Gt.performFields||this.labourAmountControl.formControl.valid&&this.labourTimeControl.formControl.valid||(t=!1),t}onObservableLoadRepairTypes(t){var e,n,i,o;if(t&&t.length>0&&t.forEach((e,n)=>{t[n]=Object.assign(Object.assign({},t[n]),{dropdownItemIcon:this.getIcon(e.name)})}),this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{options:t}),(null===(e=this.bookingService.repairTypes)||void 0===e?void 0:e.length)||(this.bookingService.repairTypes=t),null===(n=this.operationToEdit)||void 0===n?void 0:n.RepairServiceTypeId){const t=null===(i=this.formModel.repairType.options)||void 0===i?void 0:i.find(t=>t.id===this.operationToEdit.RepairServiceTypeId);t&&(this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:t}),this.formData.repairType=t.name,this.checkForFormValidation())}else if(this.formData.operationType===Gt.painting||this.formData.operationType===Gt.polish){const t=null===(o=this.formModel.repairType.options)||void 0===o?void 0:o.find(t=>"Paint"===t.name);t&&(this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:t}),this.formData.repairType=t.name)}}getIcon(t){switch(t){case"Body":return"car";case"Maintenance":return"house";case"Tires":return"tire";case"Paint":return"paintbrush";case"Others":return"gears";case"Electrical":return"bolt-car";case"Diagnosis":return"diagnosis";case"Mechanical":return"mechanical";default:return""}}beforeSubmit(){var t,e;((null===(t=this.operationToEdit)||void 0===t?void 0:t.RepairOperationGuid)||(null===(e=this.operationToEdit)||void 0===e?void 0:e.OperationGuid))&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.submitForm.bind(this),Vt.j.quote):this.submitForm()}submitForm(){var t,e;if(!this.isOperationFormValid())return;this.monitorService.logEvent("submitForm",["OperationAddComponent","addenda-repair"]);const n=this.formModel.operationType.options.find(t=>t.name===this.formData.operationType);if(!n)return;let i;this.formData.repairType&&(i=this.formModel.repairType.options.find(t=>t.name===this.formData.repairType));const o={operationName:this.formData.operation,repairOperationTypeId:null==n?void 0:n.id};this.formData.code&&(o.code=this.formData.code),this.formData.information&&(o.information=this.formData.information),i&&(o.repairServiceTypeId=i.id),this.formData.operationType===Gt.replace||this.formData.operationType===Gt.painting?(this.formData.quantity&&(o.quantity=this.formData.quantity),this.formData.price&&(o.price=this.formData.price),this.formData.labourTime&&(o.labourTime=this.formData.labourTime),this.formData.operationType===Gt.replace&&this.formData.labourAmount&&(o.labourAmount=this.formData.labourAmount)):(this.formData.labourTime&&(o.labourTime=this.formData.labourTime),this.formData.labourAmount&&(o.labourAmount=this.formData.labourAmount)),o.labourTime&&"string"==typeof o.labourTime&&(o.labourTime=parseFloat(o.labourTime)),o.labourAmount&&"string"==typeof o.labourAmount&&(o.labourAmount=parseFloat(o.labourAmount)),o.quantity&&"string"==typeof o.quantity&&(o.quantity=parseFloat(o.quantity)),o.price&&"string"==typeof o.price&&(o.price=parseFloat(o.price)),this.commonService.showLoading(),(null===(t=this.operationToEdit)||void 0===t?void 0:t.RepairOperationGuid)?(o.repairOperationGuid=this.operationToEdit.RepairOperationGuid,this.monitorService.logEvent("editRepairEstimateOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:o}),this.repairEstimateOperationService.editRepairEstimateOperation(this.repairId,o).subscribe({next:t=>{t&&(this.commonService.hideLoading(),this.cancelDialog.emit(!0))},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}})):(null===(e=this.operationToEdit)||void 0===e?void 0:e.OperationGuid)?(o.operationGuid=this.operationToEdit.OperationGuid,this.monitorService.logEvent("editRepairOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:o}),this.repairEstimateOperationService.editRepairOperation(o).subscribe({next:t=>{t&&(this.commonService.hideLoading(),this.switchToOperationLIst.emit())},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}})):(o.saveOperation=this.formData.saveOperation,this.monitorService.logEvent("addRepairOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:o}),this.repairEstimateOperationService.addRepairOperation(this.repairId,o).subscribe({next:t=>{t&&(this.commonService.hideLoading(),this.cancelDialog.emit(!0))},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}}))}resetForm(t=!0){var e;if(null===(e=this.operationToEdit)||void 0===e?void 0:e.Id)this.populateFormData(),this.setInitialStateOfForm(),this.onObservableLoadRepairTypes(this.formModel.repairType.options);else if(t&&this.setInitialStateOfForm(),this.formModel.code=Object.assign(Object.assign({},this.formModel.code),{value:""}),this.formData.code="",this.formModel.operation=Object.assign(Object.assign({},this.formModel.operation),{value:""}),this.formData.operation="",this.formModel.operation.formControl.reset(),this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:[]}),this.formData.repairType="",this.formModel.information=Object.assign(Object.assign({},this.formModel.information),{value:""}),this.formData.information="",this.formModel.quantity&&(this.formModel.quantity=Object.assign(Object.assign({},this.formModel.quantity),{value:0}),this.formData.quantity=0),this.formModel.price&&(this.formModel.price=Object.assign(Object.assign({},this.formModel.price),{value:0}),this.formData.price=0),this.formModel.labourTime&&(this.formModel.labourTime=Object.assign(Object.assign({},this.formModel.labourTime),{value:0}),this.formData.labourTime=0),this.formModel.labourAmount&&(this.formModel.labourAmount=Object.assign(Object.assign({},this.formModel.labourAmount),{value:0}),this.formData.labourAmount=0),this.formModel.saveOperation){const t=this.formModel.saveOperation.options;t[0].checked=!1,this.formModel.saveOperation=Object.assign(Object.assign({},this.formModel.saveOperation),{options:[...t]}),this.formData.saveOperation=!1}}onObservableLoadOperationType(t){this.formModel.operationType=Object.assign(Object.assign({},this.formModel.operationType),{options:t}),this.repairEstimateOperationService.repairOperationType=t,this.setInitialStateOfForm()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36($t.q),i.Y36(Xt),i.Y36(te.v),i.Y36(Et.M),i.Y36(i.sBO),i.Y36(yt.sK))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-operation-add"]],viewQuery:function(t,e){if(1&t&&(i.Gf(ee,5),i.Gf(ne,5),i.Gf(ie,5),i.Gf(oe,5),i.Gf(re,5),i.Gf(ae,5),i.Gf(se,5),i.Gf(le,5),i.Gf(ce,5)),2&t){let t;i.iGM(t=i.CRH())&&(e.operationTypeControl=t.first),i.iGM(t=i.CRH())&&(e.repairTypeControl=t.first),i.iGM(t=i.CRH())&&(e.operationControl=t.first),i.iGM(t=i.CRH())&&(e.codeControl=t.first),i.iGM(t=i.CRH())&&(e.informationControl=t.first),i.iGM(t=i.CRH())&&(e.labourAmountControl=t.first),i.iGM(t=i.CRH())&&(e.labourTimeControl=t.first),i.iGM(t=i.CRH())&&(e.quantityControl=t.first),i.iGM(t=i.CRH())&&(e.priceControl=t.first)}},inputs:{operationToEdit:"operationToEdit",repairId:"repairId"},outputs:{switchToOperationLIst:"switchToOperationLIst",cancelDialog:"cancelDialog"},decls:35,vars:12,consts:[[1,"estimate-add-operation","fx-col","h-100"],[1,"fx-1"],[1,"row"],[1,"col-6"],[3,"inputModel","clicked","controlOutput"],["operationTypeControl",""],["operationControl",""],["codeControl",""],["class","row",4,"ngIf"],[1,"col-6","repair-type"],["repairTypeControl",""],["informationControl",""],["class","information",4,"ngIf"],[1,"fx-0","justify-space-between","d-flex"],[1,"col-6","save-operation"],[3,"inputModel","controlOutput",4,"ngIf"],[1,"footer-button"],[1,"reset-button",3,"buttonModel"],[3,"buttonModel"],[1,"col-6",3,"inputModel","clicked","controlOutput"],["quantityControl",""],["priceControl",""],["labourAmountControl",""],["labourTimeControl",""],["class","col-6",3,"inputModel","clicked","controlOutput",4,"ngIf"],[1,"information"],[1,"icon-wrapper"],[1,"cross",3,"svgIcon"],[3,"inputModel","controlOutput"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"form",1),i.TgZ(2,"div",2),i.TgZ(3,"div",3),i.TgZ(4,"chq-input",4,5),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.TgZ(6,"div",3),i.TgZ(7,"chq-input",4,6),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(9,"div",2),i.TgZ(10,"div",3),i.TgZ(11,"chq-input",4,7),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.TgZ(13,"div",3),i.YNc(14,de,5,2,"div",8),i.YNc(15,pe,5,2,"div",8),i.qZA(),i.qZA(),i.TgZ(16,"div",2),i.TgZ(17,"div",9),i.TgZ(18,"chq-input",4,10),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.TgZ(20,"div",3),i.YNc(21,he,4,2,"div",8),i.qZA(),i.qZA(),i.TgZ(22,"div",2),i.TgZ(23,"div",3),i.TgZ(24,"chq-input",4,11),i.NdJ("clicked",function(t){return e.hideDropdown(t)})("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.TgZ(26,"div",3),i.YNc(27,ge,6,4,"div",12),i.qZA(),i.qZA(),i.qZA(),i.TgZ(28,"div",13),i.TgZ(29,"div",14),i.YNc(30,me,1,1,"chq-input",15),i.qZA(),i.TgZ(31,"div",3),i.TgZ(32,"div",16),i._UZ(33,"chq-button",17),i._UZ(34,"chq-button",18),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(4),i.Q6J("inputModel",e.formModel.operationType),i.xp6(3),i.Q6J("inputModel",e.formModel.operation),i.xp6(4),i.Q6J("inputModel",e.formModel.code),i.xp6(3),i.Q6J("ngIf",e.formData.operationType===e.OPERATION_TYPE.replace||e.formData.operationType===e.OPERATION_TYPE.painting),i.xp6(1),i.Q6J("ngIf",e.formData.operationType===e.OPERATION_TYPE.repair||e.formData.operationType===e.OPERATION_TYPE.removeAndRefit||e.formData.operationType===e.OPERATION_TYPE.polish||e.formData.operationType===e.OPERATION_TYPE.checkFields||e.formData.operationType===e.OPERATION_TYPE.performFields),i.xp6(3),i.Q6J("inputModel",e.formModel.repairType),i.xp6(3),i.Q6J("ngIf",e.formData.operationType===e.OPERATION_TYPE.replace||e.formData.operationType===e.OPERATION_TYPE.painting),i.xp6(3),i.Q6J("inputModel",e.formModel.information),i.xp6(3),i.Q6J("ngIf",e.formData.operationType===e.OPERATION_TYPE.replace),i.xp6(3),i.Q6J("ngIf",!(null!=e.operationToEdit&&e.operationToEdit.Id)),i.xp6(3),i.Q6J("buttonModel",e.resetButtonModel),i.xp6(1),i.Q6J("buttonModel",e.addButtonModel))},directives:[jt._Y,jt.JL,jt.F,Nt.D,o.O5,Ut.E,Mt.Hw],pipes:[yt.X$],styles:['.estimate-add-operation[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{display:flex;justify-content:end}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]     button{width:195px}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{margin-right:15px}.estimate-add-operation[_ngcontent-%COMP%]   .save-operation[_ngcontent-%COMP%]{display:flex;align-items:center}.estimate-add-operation[_ngcontent-%COMP%]   .repair-type[_ngcontent-%COMP%]     .dropdown-wrapper   mat-icon{height:15px;width:15px}.estimate-add-operation[_ngcontent-%COMP%]     textarea{font-family:"Inter",sans-serif;font-size:14px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .checkmark{height:20px;width:20px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .span-label{font-size:12px;color:#0b0e15;padding-left:10px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .checkmark:after{left:7px;top:2px;width:5px;height:9px}.estimate-add-operation[_ngcontent-%COMP%]   .information[_ngcontent-%COMP%]{border-radius:8px;border:1px solid var(--xa-blue);background:rgba(59,130,246,.35);box-shadow:0 2px 4px rgba(0,0,0,.05);padding:7px 20px;display:flex;align-items:center}.estimate-add-operation[_ngcontent-%COMP%]   .information[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--xa-secondary);font-family:Inter;font-size:14px;font-style:normal;font-weight:400;line-height:18px;margin-left:20px}@media (orientation: portrait){.estimate-add-operation[_ngcontent-%COMP%]     .input-wrapper   label{max-width:100%}}.operation-content.edit-estimate[_ngcontent-%COMP%]{flex:1}.operation-content[_ngcontent-%COMP%]:not(.edit-estimate){height:calc(80vh - 186px);overflow:hidden;overflow-y:auto}']}),t})();var fe=n(7772);const be={columns:[{id:"Selection",width:"60px",header:{text:"",tooltip:"",style:"visibility: hidden"},selector:{field:"OperationGuid"},cellStyle:"justify-content:center;padding:0",widget:{type:"checkbox"}},{id:"Part",sortable:!1,header:{text:"part_operation",tooltip:""},selector:{field:"OperationName"},widget:{type:"text"}},{id:"Code",sortable:!1,selector:{field:"Code"},header:{text:"code",tooltip:""},widget:{type:"text"}},{id:"Information",sortable:!1,selector:{field:"Information"},header:{text:"information",tooltip:""},widget:{type:"text"}},{id:"RepairType",sortable:!1,selector:{field:"RepairServiceType"},header:{text:"repair_type",tooltip:""},widget:{type:"text"}},{id:"Price",sortable:!1,selector:{field:"Price"},header:{text:"Price",tooltip:""},widget:{type:"number"}},{id:"LabourTime",sortable:!1,selector:{field:"LabourTime"},header:{text:"labour_time",tooltip:"",style:""},cellStyle:"",widget:{type:"text"}},{id:"EditAction",width:"30px",sortable:!1,style:"border-right: 0",selector:{field:"OperationGuid"},header:{text:"",tooltip:"",style:"visibility: hidden"},cellStyle:"justify-content: center; border-right: 0",widget:{type:"icon",config:{svgIcon:"edit",style:"width: 18px; height: 18px;"}}},{id:"DeleteAction",width:"30px",sortable:!1,selector:{field:"OperationGuid"},header:{text:"",tooltip:"",style:"visibility: hidden"},cellStyle:"justify-content: center",widget:{type:"icon",config:{svgIcon:"delete",style:"fill: var(--xa-dark-red2) !important; width: 15px; height: 15px;"}}}]};var _e=n(63298);const Me=["operationTable"];function Oe(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",10),i.TgZ(1,"chq-paginator",11,12),i.NdJ("paginationChange",function(e){return i.CHM(t),i.oxw(2).handlePaginationChange(e)}),i.qZA(),i.qZA()}if(2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("pagination",t.pagination)}}function ye(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",1),i.TgZ(1,"div",2),i.TgZ(2,"div"),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.qZA(),i.TgZ(5,"div",3),i.ynx(6),i.TgZ(7,"div",4),i._UZ(8,"chq-mat-table",5,6),i.qZA(),i.YNc(10,Oe,3,1,"div",7),i.BQk(),i.qZA(),i.TgZ(11,"div",8),i.TgZ(12,"chq-button",9),i.NdJ("click",function(e){return i.CHM(t),i.oxw().handleRefreshOperationList(e)}),i.qZA(),i.TgZ(13,"chq-button",9),i.NdJ("click",function(e){return i.CHM(t),i.oxw().handleAddClick(e)}),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(3),i.AsE("",i.lcZ(4,11,"selected_operations"),": ",t.selectedRows.length,""),i.xp6(4),i.Q6J("ngClass",(null==t.tableData?null:t.tableData.length)>0&&t.pagination.count>t.pagination.pageSize?"height-with-pagination":"height-without-pagination"),i.xp6(1),i.Q6J("config",t.tableConfig)("tableData",t.tableData)("cellClicked",t.handleCellClick)("pageChanged",t.pageChanged)("i18n",t.i18n),i.xp6(2),i.Q6J("ngIf",(null==t.tableData?null:t.tableData.length)>0&&t.pagination.count>t.pagination.pageSize),i.xp6(2),i.Q6J("buttonModel",t.refreshButtonModel),i.xp6(1),i.Q6J("buttonModel",t.addButtonModel)}}let Ce=(()=>{class t{constructor(t,e,n){this.repairEstimateOperationService=t,this.monitorService=e,this.commonService=n,this.tableData=[],this.pageChanged=!1,this.selectedRows=[],this.pagination=fe.G,this.showData=!1,this.configData=be,this.handleEditRow=new i.vpe,this.cancelDialog=new i.vpe,this.refreshButtonModel={label:"refresh",type:"outline",icon:""},this.addButtonModel={label:"add",type:"disabled",icon:""},this.handleCellClick=(t,e)=>{var n,i,o,r,a,s,l,c,d,p;"Selection"===e.id?(-1!==this.selectedRows.indexOf(null===(i=null===(n=t[0])||void 0===n?void 0:n.result)||void 0===i?void 0:i.value)?this.selectedRows.splice(this.selectedRows.indexOf(null===(r=null===(o=t[0])||void 0===o?void 0:o.result)||void 0===r?void 0:r.value),1):this.selectedRows.push(null===(s=null===(a=t[0])||void 0===a?void 0:a.result)||void 0===s?void 0:s.value),this.monitorService.logEvent("handleCellClick",["OperationListComponent","addenda-repair"],{selectedRows:this.selectedRows}),this.changeAddButtonState()):"DeleteAction"===e.id?this.deleteRow(null===(c=null===(l=t[0])||void 0===l?void 0:l.result)||void 0===c?void 0:c.value):"EditAction"===e.id&&this.editRow(null===(p=null===(d=t[0])||void 0===d?void 0:d.result)||void 0===p?void 0:p.value)},this.changeAddButtonState=()=>{this.addButtonModel.type=this.selectedRows.length>0?"primary":"disabled"},this.handleRefreshOperationList=t=>{var e,n;this.selectedRows=[],null===(n=null===(e=this.operationTable)||void 0===e?void 0:e.selection)||void 0===n||n.clear(),this.getOperations()},this.handleAddClick=t=>{0!==this.selectedRows.length&&(this.monitorService.logEvent("handleAddClick",["OperationListComponent","addenda-repair"],{repairId:this.repairId,operationds:this.selectedRows}),this.commonService.showLoading(),this.repairEstimateOperationService.addOperationsToReapir(this.repairId,this.selectedRows).subscribe({next:t=>{t&&this.cancelDialog.emit(!0),this.commonService.hideLoading()},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}}))},this.i18n=this.commonService.geti18nInfo()}ngOnInit(){this.monitorService.logEvent("ngOnInit",["OperationListComponent","addenda-repair"]),this.tableConfig=this.configData,this.showData=!1,this.pagination=Object.assign(Object.assign({},this.pagination),{pageSize:10,count:0,currentPage:t.currentPage,orderBy:"Id",sortDirection:"desc"}),this.getOperations()}getOperations(){return(0,kt.mG)(this,void 0,void 0,function*(){return this.commonService.showLoading(),this.monitorService.logEvent("getOperations",["OperationListComponent","addenda-repair"]),(0,At.z)(this.repairEstimateOperationService.getOperations(this.pagination)).then(t=>{t.value&&(this.tableData=t.value,this.showData=!0,this.pagination=Object.assign(Object.assign({},this.pagination),{count:t["@odata.count"]}),this.changeAddButtonState(),setTimeout(()=>{const e=[];this.selectedRows.forEach(n=>{t.value.find(t=>t.OperationGuid==n)&&e.push({id:"Selection",result:{value:n}})}),e.length>0&&this.operationTable.selectMultiple(e)})),this.commonService.hideLoading()}).catch(t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)})})}handlePaginationChange(t){const e={pageSize:t.pageSize,offset:t.offset,currentPage:t.currentPage};this.pagination.currentPage=t.currentPage,this.pagination=Object.assign(Object.assign({},this.pagination),e),this.pageChanged=!0,this.getOperations()}deleteRow(t){this.commonService.openDeleteDialog().afterClosed().subscribe(e=>{e&&(this.commonService.showLoading(),this.monitorService.logEvent("deleteRow",["OperationListComponent","addenda-repair"],{selectedRows:this.selectedRows}),(0,At.z)(this.repairEstimateOperationService.deleteOperation(t)).then(e=>{(null==e?void 0:e.message)&&this.commonService.showInfoToast(5e3,e.message),-1!==this.selectedRows.indexOf(t)&&this.selectedRows.splice(this.selectedRows.indexOf(t),1),this.getOperations()}).catch(t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}))})}editRow(t){if(t){const e=this.tableData.find(e=>e.OperationGuid==t);e&&this.handleEditRow.emit(e)}}}return t.currentPage=1,t.\u0275fac=function(e){return new(e||t)(i.Y36(Xt),i.Y36(Et.M),i.Y36(te.v))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-operation-list"]],viewQuery:function(t,e){if(1&t&&i.Gf(Me,5),2&t){let t;i.iGM(t=i.CRH())&&(e.operationTable=t.first)}},inputs:{repairId:"repairId"},outputs:{handleEditRow:"handleEditRow",cancelDialog:"cancelDialog"},decls:1,vars:1,consts:[["class","h-100 fx-col",4,"ngIf"],[1,"h-100","fx-col"],[1,"selected-operations"],[1,"table-container"],[1,"table-wrapper",3,"ngClass"],[3,"config","tableData","cellClicked","pageChanged","i18n"],["operationTable",""],["class","pagination-wrapper",4,"ngIf"],[1,"footer-button"],[3,"buttonModel","click"],[1,"pagination-wrapper"],[3,"pagination","paginationChange"],["paginator",""]],template:function(t,e){1&t&&i.YNc(0,ye,14,13,"div",0),2&t&&i.Q6J("ngIf",e.showData)},directives:[o.O5,o.mk,_e.B,Ut.E,fe.l],pipes:[yt.X$],styles:[".table-container[_ngcontent-%COMP%]   .height-with-pagination[_ngcontent-%COMP%]{height:calc(90vh - 244px - 39px);overflow:auto}.table-container[_ngcontent-%COMP%]   .height-without-pagination[_ngcontent-%COMP%]{height:calc(90vh - 244px);overflow:auto}.table-container[_ngcontent-%COMP%]     thead{position:sticky;top:0;z-index:1}.table-container[_ngcontent-%COMP%]     mat-cell:first-of-type, .table-container[_ngcontent-%COMP%]     mat-header-cell:first-of-type, .table-container[_ngcontent-%COMP%]     mat-footer-cell:first-of-type{padding-left:0!important}.footer-button[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px}.footer-button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{margin-right:20px}.selected-operations[_ngcontent-%COMP%]{font-size:14px;line-height:20px;color:var(--xa-dark-gray);padding-bottom:11px;text-align:end}"]}),t})();function xe(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",8),i.TgZ(1,"chq-tabs",9),i.NdJ("menuItemClick",function(e){return i.CHM(t),i.oxw().onMenuItemClick(e)}),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("mode","button")("menuItems",t.menuItems)}}function Pe(t,e){1&t&&(i.ynx(0),i._UZ(1,"app-part-add"),i.BQk())}function we(t,e){if(1&t){const t=i.EpF();i.ynx(0),i.TgZ(1,"app-operation-add",10),i.NdJ("cancelDialog",function(e){return i.CHM(t),i.oxw().cancelDialog(e)})("switchToOperationLIst",function(){return i.CHM(t),i.oxw().switchToOperationList()}),i.qZA(),i.BQk()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("operationToEdit",t.operationToEdit)("repairId",t.data.repairId)}}function Te(t,e){if(1&t){const t=i.EpF();i.ynx(0),i.TgZ(1,"app-operation-list",11),i.NdJ("handleEditRow",function(e){return i.CHM(t),i.oxw().switchToEditOperation(e)})("cancelDialog",function(e){return i.CHM(t),i.oxw().cancelDialog(e)}),i.qZA(),i.BQk()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("repairId",t.data.repairId)}}let De=(()=>{class t{constructor(t,e,n){this.data=t,this.dialogRef=e,this.monitorService=n,this.menuItems=[...Lt.HT],this.operationToEdit={},this.editrepairEstimateOperation=!1}cancelDialog(t){this.dialogRef.close(t)}ngOnInit(){var t;this.monitorService.logEvent("ngOnInit",["RepairEstimateOperationComponent","addenda-repair"]),this.menuItems[0].active=!0,this.activeMenu=this.menuItems[0].name,(null===(t=this.data)||void 0===t?void 0:t.operationDetails)&&(this.operationToEdit=this.data.operationDetails,this.editrepairEstimateOperation=!0,this.onMenuItemClick(this.menuItems[0]))}onMenuItemClick(t){this.menuItems.forEach(t=>t.active=!1);const e=this.menuItems.findIndex(e=>e.name==t.name);this.menuItems[e].active=!0,this.activeMenu=this.menuItems[e].name,"create-parts-operations"!==this.activeMenu&&(this.operationToEdit={})}switchToEditOperation(t){this.operationToEdit=t,this.onMenuItemClick(this.menuItems[0])}switchToOperationList(){this.onMenuItemClick(this.menuItems[1])}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(qt.WI),i.Y36(qt.so),i.Y36(Et.M))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-repair-estimate-operation"]],decls:13,vars:8,consts:[[1,"operation-container","fx-col"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content","fx-col","fx-1"],["class","content-header",4,"ngIf"],[1,"content-body","fx-1"],[4,"ngIf"],[1,"content-header"],[3,"mode","menuItems","menuItemClick"],[3,"operationToEdit","repairId","cancelDialog","switchToOperationLIst"],[3,"repairId","handleEditRow","cancelDialog"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"h3"),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",2),i.TgZ(6,"mat-icon",3),i.NdJ("click",function(){return e.cancelDialog(!1)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"div",4),i.YNc(8,xe,2,2,"div",5),i.TgZ(9,"div",6),i.YNc(10,Pe,2,0,"ng-container",7),i.YNc(11,we,2,2,"ng-container",7),i.YNc(12,Te,2,1,"ng-container",7),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Oqu(i.lcZ(4,6,"operation")),i.xp6(3),i.Q6J("svgIcon","cross"),i.xp6(2),i.Q6J("ngIf",!e.editrepairEstimateOperation),i.xp6(2),i.Q6J("ngIf","add-parts"===e.activeMenu),i.xp6(1),i.Q6J("ngIf","create-parts-operations"===e.activeMenu),i.xp6(1),i.Q6J("ngIf","operation-list"===e.activeMenu))},directives:[Mt.Hw,o.O5,Rt.K,Yt,ve,Ce],pipes:[yt.X$],styles:['.operation-container[_ngcontent-%COMP%]{height:calc(90vh - 40px);overflow:auto;padding:20px}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:flex-end;display:flex;cursor:pointer}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:36px!important;width:36px!important;background:var(--xa-black);border-radius:50%;text-align:center}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg   path{fill:var(--xa-white)}.operation-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:15px}.operation-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]{margin-bottom:15px}.operation-container[_ngcontent-%COMP%]     button{font-family:"Inter",sans-serif}']}),t})();var Se=n(14368),Ie=n(83853),ke=n(85567);const Ze=["code"],Ae=["phone"];function qe(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",14),i.TgZ(1,"div",15),i.TgZ(2,"chq-input",16),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(2),i.Q6J("inputModel",t.emailForm.email)}}function Le(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",14),i.TgZ(1,"div",17),i.TgZ(2,"chq-input",18,19),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.TgZ(4,"chq-input",16,20),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(2),i.Q6J("inputModel",t.emailForm.code),i.xp6(2),i.Q6J("inputModel",t.emailForm.phone)}}function Ee(t,e){if(1&t&&(i.TgZ(0,"div",8),i.TgZ(1,"label",9),i._uU(2),i.ALo(3,"translate"),i.qZA(),i._UZ(4,"label",21),i.qZA()),2&t){const t=i.oxw();i.xp6(2),i.hij("",i.lcZ(3,2,"subject")," "),i.xp6(2),i.Q6J("innerHTML",t.data.emailSubject,i.oJD)}}function Re(t,e){1&t&&(i.TgZ(0,"div",22),i.TgZ(1,"label",23),i._uU(2),i.ALo(3,"uppercase"),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",24),i.TgZ(6,"label"),i._uU(7,"Repair Estimate"),i.qZA(),i.TgZ(8,"div",25),i._UZ(9,"mat-icon",3),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.hij(" ",i.lcZ(3,2,i.lcZ(4,4,"attachments"))," "),i.xp6(7),i.Q6J("svgIcon","pdf-file"))}let je=(()=>{class t{constructor(t,e,n,i,o){this.dialogRef=t,this.monitorService=e,this.coreService=n,this.commonService=i,this.data=o,this.emailRequest={subject:"",email:[],message:"",phone:"",code:""},this.step={},this.emailForm={subject:{placeHolder:"subject",label:"subject",name:"subject",value:0,type:"text",validation:{name:"subject",validationFunction:()=>jt.kI.compose([jt.kI.required,jt.kI.maxLength(100)]),validationMessage:t=>t.required?"send_message":t.maxlength?"subject_length":""}},email:{label:"email_address",name:"email",placeHolder:"email_address",value:"",type:"text",required:!0,validation:{name:"email",validationFunction:()=>jt.kI.compose([jt.kI.required,(0,Ie.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:t=>t.required?"email_required":t.invalidEmailNumber?"email_invalid_number":t.invalidEmail?"email_valid":""}},code:{placeHolder:"select_dot",label:"code",name:"code",value:91,showImageFlag:!0,type:"select",selectedOption:{phoneCountryCode:"+91"},displayValue:"phoneCountryCode",fieldValue:"phoneCountryCode",options:[{label:"+90"},{label:"+971"},{label:"+977"}],required:!0,validation:{name:"driverCode",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"required_code":""}},phone:{placeHolder:"mobile_number",label:"mobile_number",name:"phone",value:0,type:"number",required:!0,validation:{name:"driverPhone",validationFunction:()=>jt.kI.compose([jt.kI.required,jt.kI.pattern("^[0-9]+[0-9 ,.'-]+$")]),validationMessage:t=>t.required?"required_mobile_number":t.pattern?"valid_mobile_number":""}}},this.selectedCode=""}onFormUpdate(t){var e,n;if(this.emailRequest[t.name]=!!t.isValid&&("email"===t.name?(null===(e=t.value)||void 0===e?void 0:e.split(","))||[]:t.value),"code"===t.name&&this.selectedCode!==t.value.phoneCountryCode){const e=t.value.regExpression;null===(n=this.phone)||void 0===n||n.updateCurrentValidation(e),this.selectedCode=t.value.phoneCountryCode,this.emailForm.code=Object.assign(Object.assign({},this.emailForm.code),{selectedOption:t.value}),this.emailForm.phone.value=""}this.sendButton=Object.assign(Object.assign({},this.sendButton),"email"===this.data.channel?this.emailRequest.email?{type:"primary"}:{type:"disabled"}:this.emailRequest.phone&&this.emailForm.code.selectedOption?{type:"primary"}:{type:"disabled"})}cancel(){this.monitorService.logEvent("send",["EmailDialogComponent","addenda"]),this.dialogRef.close()}send(){let t;this.monitorService.logEvent("send",["EmailDialogComponent","addenda"]),t="email"===this.data.channel?{toEmails:this.emailRequest.email,communicationTypeIds:[2],templateKey:"EstimateApprovalRequest"}:"whatsapp"===this.data.channel?{messageContent:btoa(this.data.body),PhoneNumber:`${this.emailForm.code.selectedOption.phoneCountryCode}${this.emailRequest.phone}`,communicationTypeIds:[1],templateKey:"EstimateApprovalRequest"}:{messageContent:btoa(this.data.body),PhoneNumber:`${this.emailForm.code.selectedOption.phoneCountryCode}${this.emailRequest.phone}`,communicationTypeIds:[3],templateKey:"EstimateApprovalRequest"},this.dialogRef.close(t)}setMessageHTML(t){this.emailRequest.message=btoa(t)}ngOnInit(){var t;this.monitorService.logEvent("ngOnInit",["EmailDialogComponent","addenda"]),(null===(t=this.emailForm.code)||void 0===t?void 0:t.observable)||(this.emailForm.code.observable=this.coreService.getPhoneNumber(),this.emailForm.code.onObservableLoad=this.onObservableLoad.bind(this)),this.data.email&&(this.emailForm.email=Object.assign(Object.assign({},this.emailForm.email),{value:this.data.email}),this.emailRequest=Object.assign(Object.assign({},this.emailRequest),{email:[this.data.email]})),this.sendButton={label:"send",type:"disabled",icon:"send",onclick:this.send.bind(this)},this.emailForm.code.selectedOption[this.emailForm.code.displayValue]=this.data.code,this.emailForm.phone=Object.assign(Object.assign({},this.emailForm.phone),{value:this.data.phone}),this.sendButton=Object.assign(Object.assign({},this.sendButton),"email"===this.data.channel?this.emailRequest.email?{type:"primary"}:{type:"disabled"}:this.emailRequest.phone&&this.emailForm.code.selectedOption?{type:"primary"}:{type:"disabled"})}onObservableLoad(t){if(this.commonService.hideLoading(),t&&t&&t.length>0){const e=t.filter(t=>{var e;return t.phoneCountryCode===(null===(e=this.emailForm.code.selectedOption)||void 0===e?void 0:e.phoneCountryCode)});if(e.length>0){const t=e[0],n=t.regExpression;this.emailForm.code=Object.assign(Object.assign({},this.emailForm.code),{selectedOption:t}),this.phone&&this.phone.updateCurrentValidation(n,!0)}}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(qt.so),i.Y36(Et.M),i.Y36(ke.p),i.Y36(te.v),i.Y36(qt.WI))},t.\u0275cmp=i.Xpm({type:t,selectors:[["request-approval-dialog"]],viewQuery:function(t,e){if(1&t&&(i.Gf(Ze,5),i.Gf(Ae,5)),2&t){let t;i.iGM(t=i.CRH())&&(e.code=t.first),i.iGM(t=i.CRH())&&(e.phone=t.first)}},decls:20,vars:13,consts:[[1,"dialog-container"],[1,"header"],[1,"close-icon",3,"click"],[3,"svgIcon"],["mat-dialog-content","",1,"email-dialog-body"],[1,"form-container"],["class","input-wrapper",4,"ngIf"],["class","input-wrapper label-wrapper",4,"ngIf"],[1,"input-wrapper","label-wrapper"],[1,"title"],[1,"message-content",3,"innerHTML"],["class","attachment-list",4,"ngIf"],[1,"btn-container"],[1,"right",3,"buttonModel"],[1,"input-wrapper"],[1,"div-wrapper"],[3,"inputModel","controlOutput"],[1,"div-wrapper","fx-row",2,"gap","10px"],[2,"width","115px",3,"inputModel","controlOutput"],["code",""],["phone",""],[3,"innerHTML"],[1,"attachment-list"],[1,"attachment-header"],[1,"files"],[1,"attachment-icon"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"h3"),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",2),i.NdJ("click",function(){return e.cancel()}),i._UZ(6,"mat-icon",3),i.qZA(),i.qZA(),i.TgZ(7,"div",4),i.TgZ(8,"div",5),i.YNc(9,qe,3,1,"div",6),i.YNc(10,Le,6,2,"div",6),i.YNc(11,Ee,5,4,"div",7),i.TgZ(12,"div",8),i.TgZ(13,"label",9),i._uU(14),i.ALo(15,"translate"),i.qZA(),i._UZ(16,"label",10),i.qZA(),i.qZA(),i.YNc(17,Re,10,6,"div",11),i.qZA(),i.TgZ(18,"div",12),i._UZ(19,"chq-button",13),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Oqu(i.lcZ(4,9,e.data.title)),i.xp6(3),i.Q6J("svgIcon","cross"),i.xp6(3),i.Q6J("ngIf","email"===(null==e.data?null:e.data.channel)),i.xp6(1),i.Q6J("ngIf","email"!==(null==e.data?null:e.data.channel)),i.xp6(1),i.Q6J("ngIf","email"===(null==e.data?null:e.data.channel)&&e.data.emailSubject),i.xp6(3),i.hij("",i.lcZ(15,11,"message")," "),i.xp6(2),i.Q6J("innerHTML",e.data.body,i.oJD),i.xp6(1),i.Q6J("ngIf","email"===(null==e.data?null:e.data.channel)),i.xp6(2),i.Q6J("buttonModel",e.sendButton))},directives:[Mt.Hw,qt.xY,o.O5,Ut.E,Nt.D],pipes:[yt.X$,o.gd],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--xa-popup-light-gray)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:30px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-bottom:24px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:first-child{text-transform:uppercase;font-size:12px;line-height:14px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{display:flex;grid-gap:8px;gap:8px;flex-direction:column}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;line-height:14px;font-weight:400}.dialog-container[_ngcontent-%COMP%]   .email-dialog-body[_ngcontent-%COMP%]{max-height:calc(90vh - 174px)!important;padding:0 30px!important}.dialog-container[_ngcontent-%COMP%]   .attachment-list[_ngcontent-%COMP%]{margin-bottom:24px}.toggle-wrapper[_ngcontent-%COMP%]{margin-top:22px;font-weight:400;font-size:12px;color:var(--xa-neutral-black);display:flex;grid-gap:10px;gap:10px;align-items:center;line-height:14px}.files[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:5px 0;align-items:center}.files[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-black);font-size:14px;font-weight:500;line-height:14px}.files[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-red)!important}.attachment-icon[_ngcontent-%COMP%]{grid-gap:26px;gap:26px;display:flex}.attachment-header[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:12px}.cc-span[_ngcontent-%COMP%]{position:absolute;right:10px;font-size:16px;line-height:14px;top:44px;color:var(--xa-black-medium);cursor:pointer}.message[_ngcontent-%COMP%]{font-weight:500;color:var(--xa-black-dark);font-size:14px;line-height:14px;margin-bottom:18px;display:flex}.div-wrapper[_ngcontent-%COMP%]{position:relative}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;grid-gap:10px;gap:10px;padding:0 30px 30px;background:var(--xa-popup-light-gray)}.cc-email[_ngcontent-%COMP%]     input{padding-right:36px!important}.message-content[_ngcontent-%COMP%]{font-size:16px!important;font-weight:400;line-height:20px!important;color:var(--xa-black)}  .message-content td{border-radius:5px!important;padding:5px!important}  .message-content a{color:#fff!important;text-decoration:none!important;pointer-events:none!important}"]}),t})();function Fe(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",10),i.TgZ(1,"chq-input",11),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("inputModel",t.notesModel)}}const Ne=function(t){return{selected:t}};let Ue=(()=>{class t{constructor(t,e,n,i,o){this.commonService=t,this.bookingService=e,this.route=n,this.data=i,this.dialogRef=o,this.approveRadio={placeHolder:"approve",label:"approve",name:"approve",idField:"",value:"1",type:"radio",hideLabel:!0,options:[{label:"approve",id:1}]},this.notesModel={placeHolder:"let_us_know_issue",label:"notes",name:"notes",value:"",type:"textarea",maxLength:300,rows:4},this.repairId="",this.urlToken="",this.checkedStatus="",this.reason="",this.declineRadio={placeHolder:"decline",label:"decline",name:"decline",idField:"",value:"2",type:"radio",hideLabel:!0,options:[{label:"decline",id:2}]},this.cancelButtonModel={label:"cancel",type:"outline"},this.nextButtonModel={label:"confirm",type:"disabled"}}cancel(){this.dialogRef.close(!1)}updateRepairStatus(){const t="Approved"===this.checkedStatus?"Approved":"Rejected";this.commonService.showLoading(),this.bookingService.updateRepairStatus(t,this.repairId,this.reason.trim()).subscribe({next:()=>{this.dialogRef.close(!0),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}ngOnInit(){this.repairId=this.data,console.log(this.repairId),this.nextButtonModel=Object.assign(Object.assign({},this.nextButtonModel),{onclick:this.updateRepairStatus.bind(this)}),this.cancelButtonModel=Object.assign(Object.assign({},this.cancelButtonModel),{onclick:this.cancel.bind(this)})}onFormUpdate(t){const{name:e,value:n}=t;"approve"===e?2!==this.declineRadio.value&&n&&(this.checkedStatus="Approved",this.nextButtonModel=Object.assign(Object.assign({},this.nextButtonModel),{type:"primary"}),this.declineRadio=Object.assign(Object.assign({},this.declineRadio),{value:""})):"decline"===e?1!==this.approveRadio.value&&n&&(this.checkedStatus="declined",this.reason.trim()&&(this.nextButtonModel=Object.assign(Object.assign({},this.nextButtonModel),{type:"primary"})),this.approveRadio=Object.assign(Object.assign({},this.approveRadio),{value:""})):"notes"===e&&(this.reason=n,this.nextButtonModel=this.checkedStatus&&"declined"===this.checkedStatus&&this.reason.trim()?Object.assign(Object.assign({},this.nextButtonModel),{type:"primary"}):Object.assign(Object.assign({},this.nextButtonModel),{type:"disabled"}))}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(te.v),i.Y36($t.q),i.Y36(Ot.gz),i.Y36(qt.WI),i.Y36(qt.so))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-estimate-approval"]],decls:26,vars:25,consts:[[1,"approval-form"],[1,"wrapper"],[1,"wrapper-header"],[1,"radio-container"],[1,"radio-wrapper",3,"ngClass"],["aria-hidden","false","aria-label","edit icon",3,"svgIcon"],[1,"company-input","col-3",3,"inputModel","controlOutput"],["class","content",4,"ngIf"],[1,"button-container"],[3,"buttonModel"],[1,"content"],["tabindex","-1",3,"inputModel","controlOutput"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"h3"),i._uU(4),i.ALo(5,"translate"),i.qZA(),i.TgZ(6,"span"),i._uU(7),i.ALo(8,"translate"),i.qZA(),i.qZA(),i.TgZ(9,"div",3),i.TgZ(10,"div",4),i._UZ(11,"mat-icon",5),i.TgZ(12,"label"),i._uU(13),i.ALo(14,"translate"),i.qZA(),i.TgZ(15,"chq-input",6),i.NdJ("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.TgZ(16,"div",4),i._UZ(17,"mat-icon",5),i.TgZ(18,"label"),i._uU(19),i.ALo(20,"translate"),i.qZA(),i.TgZ(21,"chq-input",6),i.NdJ("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.qZA(),i.YNc(22,Fe,2,1,"div",7),i.TgZ(23,"div",8),i._UZ(24,"chq-button",9),i._UZ(25,"chq-button",9),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(4),i.Oqu(i.lcZ(5,13,"approve_or_decline_the_request")),i.xp6(3),i.Oqu(i.lcZ(8,15,"select_approve/reject_option")),i.xp6(3),i.Q6J("ngClass",i.VKq(21,Ne,"Approved"===e.checkedStatus)),i.xp6(1),i.Q6J("svgIcon","check"),i.xp6(2),i.Oqu(i.lcZ(14,17,"approve")),i.xp6(2),i.Q6J("inputModel",e.approveRadio),i.xp6(1),i.Q6J("ngClass",i.VKq(23,Ne,"declined"===e.checkedStatus)),i.xp6(1),i.Q6J("svgIcon","cross"),i.xp6(2),i.Oqu(i.lcZ(20,19,"decline")),i.xp6(2),i.Q6J("inputModel",e.declineRadio),i.xp6(1),i.Q6J("ngIf","declined"===e.checkedStatus),i.xp6(2),i.Q6J("buttonModel",e.cancelButtonModel),i.xp6(1),i.Q6J("buttonModel",e.nextButtonModel))},directives:[o.mk,Mt.Hw,Nt.D,o.O5,Ut.E],pipes:[yt.X$],styles:[".approval-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;background:var(--xa-popup-light-gray)}.approval-form[_ngcontent-%COMP%]   .approval-header[_ngcontent-%COMP%]{display:flex;grid-gap:40px;gap:40px;justify-content:flex-start;position:fixed;top:0px;align-items:center}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{align-self:center;display:flex;grid-gap:28px;gap:28px;flex-direction:column;align-items:center;padding:30px;border-radius:10px;width:calc(100% - 60px)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:28px;gap:28px;width:100%}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;font-weight:400;line-height:18px}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]{display:flex;grid-gap:20px;gap:20px;width:100%;justify-content:center}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]{display:flex;padding:17px 33px;flex-direction:column;justify-content:center;align-items:center;grid-gap:4px;gap:4px;border-radius:8px;border:1px solid var(--xa-light-gray)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{padding:10px 12px}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:18px;font-size:13px;color:var(--xa-black-dark)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background:var(--xa-white);border:none}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;grid-gap:10px;gap:10px;width:100%}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{flex:1}.approval-form[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.approval-form[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}"]}),t})();var Je=n(48873),Ye=n(87855),Be=n(35493),ze=n(56785),He=n(21937),Ge=n(72076),Qe=n(22406),Ve=n(8851);function $e(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",7),i.TgZ(1,"chq-estimate-details",8),i.NdJ("iconClicked",function(e){return i.CHM(t),i.oxw().handleIconClicked(e)})("downloadPdf",function(){return i.CHM(t),i.oxw().downloadPdf()}),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(1),i.Q6J("estimateResponse",t.estimateResponse)("editEstimate",t.editEstimate)("estimateSource",t.estimateSource)("i18n",t.i18n)}}function We(t,e){if(1&t){const t=i.EpF();i.ynx(0),i.TgZ(1,"chq-button",12),i.NdJ("click",function(){return i.CHM(t),i.oxw(2).handleSaveEditedEstimate()}),i.qZA(),i.BQk()}if(2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("buttonModel",t.saveEditedModel)}}function Ke(t,e){if(1&t&&i._UZ(0,"chq-button",17),2&t){const t=i.oxw(4);i.Q6J("buttonModel",t.cancelButtonModel)}}function Xe(t,e){if(1&t&&(i.ynx(0),i.YNc(1,Ke,1,1,"chq-button",16),i.BQk()),2&t){const t=i.oxw(3);i.xp6(1),i.Q6J("ngIf",t.showDelete)}}function tn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-button",12),i.NdJ("click",function(){return i.CHM(t),i.oxw(3).handleEditEstimate()}),i.qZA()}if(2&t){const t=i.oxw(3);i.Q6J("buttonModel",t.editEstimateModel)}}function en(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-button",12),i.NdJ("click",function(){return i.CHM(t),i.oxw(4).handleRequestStatus()}),i.qZA()}if(2&t){const t=i.oxw(4);i.Q6J("buttonModel",t.requestStatusModel)}}function nn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-dropdown",19),i.NdJ("selected",function(e){return i.CHM(t),i.oxw(4).handleSelectedOption(e)}),i.qZA()}if(2&t){const t=i.oxw(4);i.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function on(t,e){if(1&t&&(i.ynx(0),i.YNc(1,en,1,1,"chq-button",15),i.YNc(2,nn,1,1,"chq-dropdown",18),i.BQk()),2&t){const t=i.oxw(3);i.xp6(1),i.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&t.repairNotInvoiced()),i.xp6(1),i.Q6J("ngIf",(null==t.communications?null:t.communications.length)>0&&t.repairNotInvoiced()&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0)}}function rn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-button",12),i.NdJ("click",function(){return i.CHM(t),i.oxw(3).openOperationPopup()}),i.qZA()}if(2&t){const t=i.oxw(3);i.Q6J("buttonModel",t.addOperationModel)}}function an(t,e){if(1&t&&(i.ynx(0,13),i.YNc(1,Xe,2,1,"ng-container",14),i.YNc(2,tn,1,1,"chq-button",15),i.YNc(3,on,3,2,"ng-container",14),i.YNc(4,rn,1,1,"chq-button",15),i.BQk()),2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("chqPermission","newBooking"),i.xp6(1),i.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&(null==t.repairStatus?null:t.repairStatus.toLowerCase())!=="PendingApproval".toLowerCase()&&t.repairNotInvoiced()),i.xp6(1),i.Q6J("chqPermission","newBooking"),i.xp6(1),i.Q6J("ngIf","GTMotive"!==t.estimateSource&&(null==t.repairStatus?null:t.repairStatus.toLowerCase())!=="PendingApproval".toLowerCase()&&t.repairNotInvoiced())}}function sn(t,e){if(1&t&&(i.TgZ(0,"div",9),i.YNc(1,We,2,1,"ng-container",10),i.YNc(2,an,5,4,"ng-container",11),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngIf",t.editEstimate),i.xp6(1),i.Q6J("ngIf",!t.editEstimate)}}function ln(t,e){if(1&t){const t=i.EpF();i.ynx(0),i.TgZ(1,"chq-button",12),i.NdJ("click",function(){return i.CHM(t),i.oxw(2).handleSaveEditedEstimate()}),i.qZA(),i.BQk()}if(2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("buttonModel",t.saveEditedModel)}}function cn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-dropdown",19),i.NdJ("selected",function(e){return i.CHM(t),i.oxw(4).handleSelectedOption(e)}),i.qZA()}if(2&t){const t=i.oxw(4);i.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function dn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-button",12),i.NdJ("click",function(){return i.CHM(t),i.oxw(5).handleRequestStatus()}),i.qZA()}if(2&t){const t=i.oxw(5);i.Q6J("buttonModel",t.requestStatusModel)}}function pn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-dropdown",19),i.NdJ("selected",function(e){return i.CHM(t),i.oxw(5).changeCaseStatusDialog(e)}),i.qZA()}if(2&t){const t=i.oxw(5);i.Q6J("dropdownModel",t.dropdownModelFilter)}}function un(t,e){if(1&t&&(i.ynx(0),i.YNc(1,dn,1,1,"chq-button",15),i.YNc(2,pn,1,1,"chq-dropdown",18),i.BQk()),2&t){const t=i.oxw(4);i.xp6(1),i.Q6J("ngIf","pendingapproval"===(null==t.repairStatus?null:t.repairStatus.toLowerCase())&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&t.repairNotInvoiced()),i.xp6(1),i.Q6J("ngIf","pendingapproval"!==(null==t.repairStatus?null:t.repairStatus.toLowerCase())&&"complete"!==(null==t.repairStatus?null:t.repairStatus.toLowerCase()))}}function hn(t,e){if(1&t&&(i.ynx(0),i.YNc(1,cn,1,1,"chq-dropdown",18),i.YNc(2,un,3,2,"ng-container",14),i.BQk()),2&t){const t=i.oxw(3);i.xp6(1),i.Q6J("ngIf",t.repairNotInvoiced()&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0),i.xp6(1),i.Q6J("chqPermission","newBooking")}}function gn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-button",12),i.NdJ("click",function(){return i.CHM(t),i.oxw(4).openOperationPopup()}),i.qZA()}if(2&t){const t=i.oxw(4);i.Q6J("buttonModel",t.addOperationModel)}}function mn(t,e){if(1&t&&i.YNc(0,gn,1,1,"chq-button",15),2&t){const t=i.oxw(3);i.Q6J("ngIf","GTMotive"!==t.estimateSource)}}function vn(t,e){if(1&t&&(i.ynx(0),i.YNc(1,hn,3,2,"ng-container",21),i.YNc(2,mn,1,1,"ng-template",null,22,i.W1O),i.BQk()),2&t){const t=i.MAs(3),e=i.oxw(2);i.xp6(1),i.Q6J("ngIf",(null==e.estimateResponse||null==e.estimateResponse.estimateCharges?null:e.estimateResponse.estimateCharges.length)>0)("ngIfElse",t)}}function fn(t,e){if(1&t&&(i.TgZ(0,"div",20),i.YNc(1,ln,2,1,"ng-container",10),i.YNc(2,vn,4,2,"ng-container",10),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngIf",t.editEstimate),i.xp6(1),i.Q6J("ngIf",!t.editEstimate)}}let bn=(()=>{class t{constructor(t,e,n,i,o,r,a,s,l,c,d,p){var u,h;this.commonService=t,this.repairEstimateService=e,this.route=n,this.dialog=i,this.bookingService=o,this.translationService=r,this.repairEstimateOperationService=a,this.monitorService=s,this.messageService=l,this.calendarService=c,this.router=d,this.notifyService=p,this.editEstimateModel={label:"edit_estimate",type:"outline",icon:"edit"},this.requestStatusModel={label:"self_approval",type:"outline",icon:"clock-new"},this.addOperationModel={label:"add_operation",type:"outline",icon:"plus"},this.bookInModel={label:"book_in",type:"primary",icon:""},this.saveEditedModel={label:"done",type:"primary",icon:""},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.showData=!1,this.editEstimate=!1,this.caseGuid="",this.repairStatus="",this.communications=[],this.email="",this.repairGuid="",this.repairId="",this.estimateSource="",this.repairNumber="",this.claimNumber="",this.organizationEmail="",this.organizationPhone="",this.organizationCountryCode="",this.organizationName="",this.dropdownModelFilter={options:[],placeHolder:this.translationService.instant("options"),label:"",appearance:"button",placeHolderIcon:"settings",name:"option",displayValue:"label",selectedOption:{}},this.communicationChannels=[{},{dropdownItemIcon:"whatsapp",color:"var(xa-white) !important;",label:this.translationService.instant("whatsapp")},{dropdownItemIcon:"email",color:"var(xa-white) !important;",label:this.translationService.instant("email")},{dropdownItemIcon:"sms",color:"var(xa-white) !important;",label:this.translationService.instant("sms")}],this.dropdownApprovalModelFilter={options:[{dropdownItemIcon:"whatsapp",color:"var(xa-white) !important;",label:this.translationService.instant("whatsapp")},{dropdownItemIcon:"email",color:"var(xa-white) !important;",label:this.translationService.instant("email")},{dropdownItemIcon:"sms",color:"var(xa-white) !important;",label:this.translationService.instant("sms")}],placeHolder:"request_approval",label:"",hideDropdownIcon:!0,appearance:"button",placeHolderIcon:"send",name:"option",displayValue:"label",selectedOption:{}},this.userPermission={},this.repairTypesArray=[],this.afterOperation=!1,this.isRepairCreatedFromCase=!1,this.bookingId="",this.invoiceStatus="",this.commonService.accessRight.closed&&(this.commonService.accessRight=new Zt.X(!0)),this.commonService.activeItem.closed?this.commonService.activeItem=new Zt.X("Booking"):this.commonService.activeItem.next("Booking"),this.commonService.userProfileData.subscribe(t=>{if(t&&t.data){const{userPermission:e,email:n}=t.data;this.email=n,this.userPermission=e||{}}}),this.i18n=this.commonService.geti18nInfo(),null===(h=null===(u=this.route.parent)||void 0===u?void 0:u.params)||void 0===h||h.subscribe(t=>{var e;""!=this.repairGuid&&this.repairGuid!==t.id&&(this.monitorService.logEvent("ngOnInit",["EstimateComponent","addenda-repair"]),this.commonService.updatePage("/repair/customers/0","add-customer"),this.repairGuid=null===(e=this.route.parent)||void 0===e?void 0:e.snapshot.paramMap.get("id"),this.getBookingRepairDetails()),setTimeout(()=>{-1!==this.router.url.indexOf("parts")&&document.querySelector("chq-tabs .active").click()},300)})}get showDelete(){var t,e;return!(!this.repairId||"draft"!==(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase()))||!(!this.repairId||!this.caseGuid||1!=this.isRepairCreatedFromCase||"repairestimation"!=(null===(e=this.repairStatus)||void 0===e?void 0:e.toLowerCase()))}handleSelectedOption(t){var e;this.showRequestApprovalDialog(null===(e=null==t?void 0:t.value)||void 0===e?void 0:e.label)}redirectToGtEstimate(){this.commonService.showLoading(),this.monitorService.logEvent("redirectToGtEstimate",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid,status}]),this.route.snapshot.queryParams.send&&"true"==this.route.snapshot.queryParams.send&&this.router.navigate([],{relativeTo:this.route,queryParams:{send:"false"},queryParamsHandling:"merge"}),this.repairEstimateService.createEstimateFromRepair(this.repairGuid).subscribe({next:t=>{t&&(location.href=t.data.url,sessionStorage.setItem("update","1"),sessionStorage.setItem("current-url",this.router.url.toString()),sessionStorage.setItem("initial-repair-types",JSON.stringify(this.repairTypesArray)))},complete:()=>{this.commonService.hideLoading()}})}showRequestApprovalDialog(t){var e,n,i,o,r,a,s,l,c,d,p,u,h,g,m,v,f,b,_,M;return(0,kt.mG)(this,void 0,void 0,function*(){this.commonService.showLoading();const O=yield(0,At.z)(this.notifyService.getNotifyTemplate(this.repairGuid,this.domainId,4));this.commonService.hideLoading();const y=`<strong class='text-black-medium'>Request approval: </strong> <strong class='text-black-medium'>${this.repairNumber} / </strong> <strong class='text-black-medium'>${this.vehicleObj.vehicleMake} / </strong>\n    <strong class='text-black-medium'>${this.vehicleObj.vehicleModel} / </strong> <strong class='text-black-medium'>${this.vehicleObj.licensePlateNumber}</strong> ${this.claimNumber?`<strong class='text-black-medium'> / ${this.claimNumber} </strong>`:""}`;let C="send_message",x="",P="";"email"===(null==t?void 0:t.toLowerCase())?(C="send_email",x=y,P=O[1].data.body.replace("{{firstname}} {{lastname}}",this.organizationName).replace("{{make}}",null===(e=O[0].data.vehicle)||void 0===e?void 0:e.vehicleMake).replace("{{model}}",null===(n=O[0].data.vehicle)||void 0===n?void 0:n.vehicleModel).replace("{{licensenumber}}",null===(i=O[0].data.vehicle)||void 0===i?void 0:i.licensePlateNumber).replace("{{pickupdate}}",Je((null===(o=O[0].data)||void 0===o?void 0:o.pickUpDate)?null===(r=O[0].data)||void 0===r?void 0:r.pickUpDate:null===(s=null===(a=O[0].data)||void 0===a?void 0:a.booking)||void 0===s?void 0:s.endDate).format("DD/MM/YYYY HH:MM a")).replace("{{message}}","").replace("{{orgname}}",null===(l=O[0].data.organizationDetail)||void 0===l?void 0:l.nameOfOrganization).replace("{{orgcontactnumber}}",null===(c=O[0].data.organizationDetail)||void 0===c?void 0:c.phoneNumber).replace("{{claimnumber}}",null===(d=O[0].data.customer)||void 0===d?void 0:d.claimNumber)):"whatsapp"===(null==t?void 0:t.toLowerCase())?(P=O[1].data.whatsAppBody.replace("{{firstname}} {{lastname}}",this.organizationName).replace("{{make}}",null===(p=O[0].data.vehicle)||void 0===p?void 0:p.vehicleMake).replace("{{model}}",null===(u=O[0].data.vehicle)||void 0===u?void 0:u.vehicleModel).replace("{{licensenumber}}",null===(h=O[0].data.vehicle)||void 0===h?void 0:h.licensePlateNumber).replace("{{pickupdate}}",Je((null===(g=O[0].data)||void 0===g?void 0:g.pickUpDate)?null===(m=O[0].data)||void 0===m?void 0:m.pickUpDate:null===(v=O[0].data)||void 0===v?void 0:v.booking.endDate).format("DD/MM/YYYY HH:MM a")).replace("{{message}}","").replace("{{orgname}}",null===(f=O[0].data.organizationDetail)||void 0===f?void 0:f.nameOfOrganization).replace("{{orgcontactnumber}}",null===(b=O[0].data.organizationDetail)||void 0===b?void 0:b.phoneNumber).replace("{{approvalurl}}","Approve/Reject"),P=(null===(_=O[0].data.customer)||void 0===_?void 0:_.claimNumber)?P.replace("{{claimnumber}}",null===(M=O[0].data.customer)||void 0===M?void 0:M.claimNumber):P.replace("/{{claimnumber}}","")):"sms"===(null==t?void 0:t.toLowerCase())&&(P=O[1].data.smsBody.replace("{{estimateurl}}","").replace("{{approvalurl}}","")),this.dialog.open(je,{data:{title:C,email:this.organizationEmail,emailSubject:x,channel:null==t?void 0:t.toLowerCase(),body:P,code:this.organizationCountryCode,phone:this.organizationPhone},backdropClass:"confirmation-popup-backdrop",maxHeight:"90vh",minWidth:"629px",width:"629px",autoFocus:!1}).afterClosed().subscribe({next:t=>{t&&(this.commonService.showLoading(),this.messageService.sendApprovalMessage(t,this.repairGuid).subscribe({next:()=>{const t=this.translationService.instant("request_approval_msg");this.commonService.showInfoToast(1e3,t),this.commonService.hideLoading(),this.getBookingRepairDetails()},error:()=>{this.commonService.hideLoading()}}))}})})}get isValidCurrentStatus(){return["readytoinvoice"].includes(this.repairStatus.toLowerCase())}showConfirmationPopup(){this.dialog.open(Se.I,{disableClose:!0,data:{message:"msg_estimate_zero"},backdropClass:"confirmation-popup-backdrop",autoFocus:!1}).afterClosed().subscribe({next:t=>{console.log(t),t&&this.redirectToGtEstimate()}})}getManualEstimationDetail(t){this.vehicleId&&this.inspectionId?(this.monitorService.logEvent("getManualEstimationDetail",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId}),this.repairEstimateService.getRepairEstimate(this.repairGuid,this.inspectionId,this.vehicleId).subscribe({next:e=>{this.showData=!0,this.estimateResponse=e||{},this.i18n=this.commonService.geti18nInfo(),this.commonService.isRefreshRepairEstimateDetails.next(null),this.editEstimate=!1,this.commonService.hideLoading(),this.toggleOptions(),t&&this.commonService.showInfoToast(5e3,t)},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}})):(this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid))}getEstimationDetail(t){"GTMotive"===this.estimateSource?this.getGTEstimationDetail():this.getManualEstimationDetail()}getGTEstimationDetail(){this.vehicleId&&this.inspectionId?(this.monitorService.logEvent("getGTEstimationDetail",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,caseGuid:this.caseGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId}),this.repairEstimateService.getEstimate(this.caseGuid,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:t=>{var e,n,i;if(this.estimateResponse=(null==t?void 0:t.data)||{},0==(null===(n=null===(e=this.estimateResponse)||void 0===e?void 0:e.estimateCharges)||void 0===n?void 0:n.length))return this.showConfirmationPopup(),void this.commonService.hideLoading();this.showData=!0,this.i18n=this.commonService.getDefaulti18nInfo(),this.estimateResponse.currencyCode=null===(i=this.estimateResponse)||void 0===i?void 0:i.currencyCode,this.editEstimate=!1,this.toggleOptions(),this.commonService.hideLoading()},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}})):(this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid))}getEstimateFromCaseAndRepair(t,e){if(this.vehicleId&&this.inspectionId){this.monitorService.logEvent("getEstimateFromCaseAndRepair",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId});const e=sessionStorage.getItem("update")||"0";this.route.snapshot.queryParams.send&&-1!=(sessionStorage.getItem("current-url")||"").indexOf("mode=edit")&&this.router.navigate([],{relativeTo:this.route,queryParams:{mode:"edit"},queryParamsHandling:"merge"}),"0"===e?this.getEstimationDetail(t):"1"===e&&this.route.snapshot.queryParams.send&&"true"==this.route.snapshot.queryParams.send?this.repairEstimateService.readUpdateEstimate(this.caseGuid,this.inspectionId,this.vehicleId,"put",this.domainId).subscribe({next:()=>{sessionStorage.setItem("update","0"),this.getEstimationDetail(t),this.router.navigate([],{relativeTo:this.route,queryParams:{send:"false"},queryParamsHandling:"merge"}),""!=sessionStorage["initial-repair-types"]&&(this.afterOperation=!0,this.getBookingRepairDetails()),this.commonService.hideLoading()}}):this.getEstimationDetail(t)}else this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid)}showRepairTypeUpdateMessage(t,e){const n=[];if(null==t||t.forEach(t=>{n.push("object"==typeof t?t.repairServiceType:t)}),n.length>0){const t=n.filter(t=>!e.includes(t));t.length>0&&(this.commonService.showNotification(`Repair Type was updated: Added ${t.join(",")}`),this.repairTypesArray=[...this.repairTypesArray,...t])}}displayMissingInspectionMessage(t){this.commonService.openAlertDialog("Notification","Please add your vehicle in order to add estimate.").afterClosed().subscribe({next:e=>{e&&this.router.navigate([`repair/booking/${t}`])},error:()=>{this.commonService.hideLoading()}})}getBookingRepairDetails(){this.commonService.showLoading(),this.monitorService.logEvent("getBookingRepairDetails",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid}),this.bookingService.getRepairDetailByGuid(this.repairGuid).subscribe({next:t=>(0,kt.mG)(this,void 0,void 0,function*(){var e,n,i,o,r,a,s,l,c,d,p,u,h,g,m,v,f,b,_,M,O,y,C,x,P,w,T,D,S,I,k,Z,A,q,L,E,R,j,F,N,U,J,Y,B,z,H,G;if(null==t?void 0:t.data){if(this.commonService.repairDetails.next(t.data),this.commonService.bookingId.next(t.data.repairNumber),this.repairNumber=t.data.repairNumber,this.repairId=t.data.id,this.repairStatus=t.data.status,this.invoiceStatus=t.data.invoiceStatus,this.inspectionId=null===(e=t.data.vehicle)||void 0===e?void 0:e.inspectionId,this.vehicleId=null===(n=t.data.vehicle)||void 0===n?void 0:n.vehicleId,this.caseGuid=t.data.quoteId,this.domainId=t.data.domainId,this.vehicleObj=t.data.vehicle,this.claimNumber=null===(o=null===(i=t.data)||void 0===i?void 0:i.customer)||void 0===o?void 0:o.claimNumber,this.estimateSource=t.data.estimateSource||"",this.organizationEmail=(null===(a=null===(r=t.data)||void 0===r?void 0:r.organizationDetail)||void 0===a?void 0:a.partnerships)?null===(c=null===(l=null===(s=t.data)||void 0===s?void 0:s.organizationDetail)||void 0===l?void 0:l.partnerships[0])||void 0===c?void 0:c.email:"",this.organizationPhone=(null===(p=null===(d=t.data)||void 0===d?void 0:d.organizationDetail)||void 0===p?void 0:p.partnerships)?null===(m=null===(g=null===(h=null===(u=t.data)||void 0===u?void 0:u.organizationDetail)||void 0===h?void 0:h.partnerships[0])||void 0===g?void 0:g.phoneNumber)||void 0===m?void 0:m.replace(null===(b=null===(f=null===(v=t.data)||void 0===v?void 0:v.organizationDetail)||void 0===f?void 0:f.partnerships[0])||void 0===b?void 0:b.countryCode,""):"",this.organizationCountryCode=(null===(M=null===(_=t.data)||void 0===_?void 0:_.organizationDetail)||void 0===M?void 0:M.partnerships)?null===(C=null===(y=null===(O=t.data)||void 0===O?void 0:O.organizationDetail)||void 0===y?void 0:y.partnerships[0])||void 0===C?void 0:C.countryCode:"",this.organizationName=(null===(P=null===(x=t.data)||void 0===x?void 0:x.organizationDetail)||void 0===P?void 0:P.partnerships)?null===(D=null===(T=null===(w=t.data)||void 0===w?void 0:w.organizationDetail)||void 0===T?void 0:T.partnerships[0])||void 0===D?void 0:D.companyName:"",this.isRepairCreatedFromCase=t.data.isRepairCreatedFromCase,this.bookingId=null===(S=t.data.booking)||void 0===S?void 0:S.bookingGuid,!this.vehicleId)return this.commonService.hideLoading(),void this.displayMissingInspectionMessage(this.repairGuid);"repair"==(null===(I=t.data.repairType)||void 0===I?void 0:I.toLowerCase())&&(this.afterOperation?"GTMotive"!=this.estimateSource?this.showRepairTypeUpdateMessage(t.data.repairServiceTypes,this.repairTypesArray):(this.repairTypesArray=[],this.getInitialRepairTypes(t.data.repairServiceTypes),""!=sessionStorage["initial-repair-types"]&&this.showRepairTypeUpdateMessage(this.repairTypesArray,JSON.parse(sessionStorage["initial-repair-types"])),sessionStorage.setItem("initial-repair-types","")):this.getInitialRepairTypes(t.data.repairServiceTypes));const Q=[];(null===(Z=null===(k=t.data)||void 0===k?void 0:k.booking)||void 0===Z?void 0:Z.communicationTypeId)&&(null===(q=null===(A=t.data)||void 0===A?void 0:A.booking)||void 0===q?void 0:q.communicationTypeId.length)>0&&(null===(E=null===(L=t.data)||void 0===L?void 0:L.booking)||void 0===E||E.communicationTypeId.forEach(t=>{this.communicationChannels[t]&&Q.push(this.communicationChannels[t])})),Q.sort((t,e)=>t.label.localeCompare(e.label)),this.communications=null===(j=null===(R=t.data)||void 0===R?void 0:R.booking)||void 0===j?void 0:j.communicationTypeId,this.dropdownApprovalModelFilter=Object.assign(Object.assign({},this.dropdownApprovalModelFilter),{options:Q}),t.data.customer&&"Retail"===(null===(F=t.data.customer)||void 0===F?void 0:F.companyOrgType)&&((null===(N=t.data.customer)||void 0===N?void 0:N.isCompany)||(this.organizationEmail=null===(U=t.data.customer)||void 0===U?void 0:U.email,this.organizationPhone=null===(J=t.data.customer)||void 0===J?void 0:J.mobileNumber,this.organizationCountryCode=null===(Y=t.data.customer)||void 0===Y?void 0:Y.countryCode,this.organizationName=`${null===(B=t.data.customer)||void 0===B?void 0:B.firstName} ${null===(z=t.data.customer)||void 0===z?void 0:z.lastName}`)),!this.estimateSource&&this.checkGTEstimatePermission()?this.redirectToGtEstimate():this.getEstimateFromCaseAndRepair((null===(G=null===(H=t.data)||void 0===H?void 0:H.organizationDetail)||void 0===G?void 0:G.nameOfOrganization)||"",""),this.toggleOptions()}else this.commonService.hideLoading()}),error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,e=t.filter(t=>"Repair Estimate"===t.automotiveServiceName);if(e&&e.length>0){const{permissions:t}=e[0],n=t.filter(t=>"gt.estimate"===t.permissionName||"gt.estimate.vinquery"===t.permissionName);if(n&&n.length>0)return!0}return!1}ngOnInit(){var t;this.monitorService.logEvent("ngOnInit",["EstimateComponent","addenda-repair"]),this.commonService.updatePage("/repair/customers/0","add-customer"),this.repairGuid=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id"),this.getBookingRepairDetails(),this.subscription=this.commonService.isRefreshRepairEstimateDetails.subscribe({next:t=>{t&&"GTMotive"!==this.estimateSource&&this.vehicleId&&this.inspectionId&&this.getManualEstimationDetail()}})}toggleOptions(){var t,e,n,i,o,r,a,s,l,c,d,p,u,h,g;if(this.dropdownModelFilter.options){if("GTMotive"!==this.estimateSource&&(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())!=="PendingApproval".toLowerCase()&&"readytoinvoice"!==(null===(e=this.repairStatus)||void 0===e?void 0:e.toLowerCase()))(null===(n=this.dropdownModelFilter.options)||void 0===n?void 0:n.find(t=>"addOperation"==t.value))||(this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("add_operation"),dropdownItemIcon:"plus",value:"addOperation"}]}));else{const t=null===(i=this.dropdownModelFilter.options)||void 0===i?void 0:i.findIndex(t=>"addOperation"==t.value),e=[...this.dropdownModelFilter.options];-1!==t&&e.splice(t,1),this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...e]})}if((null===(r=null===(o=this.estimateResponse)||void 0===o?void 0:o.estimateCharges)||void 0===r?void 0:r.length)>0&&(null===(a=this.repairStatus)||void 0===a?void 0:a.toLowerCase())!=="PendingApproval".toLowerCase()&&"readytoinvoice"!==(null===(s=this.repairStatus)||void 0===s?void 0:s.toLowerCase()))(null===(l=this.dropdownModelFilter.options)||void 0===l?void 0:l.find(t=>"editOperation"==t.value))||(this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("edit_estimate"),dropdownItemIcon:"edit",value:"editOperation"}]}));else{const t=null===(c=this.dropdownModelFilter.options)||void 0===c?void 0:c.findIndex(t=>"editOperation"==t.value),e=[...this.dropdownModelFilter.options];-1!==t&&e.splice(t,1),this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...e]})}if((null===(p=null===(d=this.estimateResponse)||void 0===d?void 0:d.estimateCharges)||void 0===p?void 0:p.length)>0&&"readytoinvoice"!==(null===(u=this.repairStatus)||void 0===u?void 0:u.toLowerCase()))(null===(h=this.dropdownModelFilter.options)||void 0===h?void 0:h.find(t=>"requestStatus"==t.value))||(this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("self_approval"),dropdownItemIcon:"clock-new",value:"requestStatus"}]}));else{const t=null===(g=this.dropdownModelFilter.options)||void 0===g?void 0:g.findIndex(t=>"requestStatus"==t.value),e=[...this.dropdownModelFilter.options];-1!==t&&e.splice(t,1),this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...e]})}}}changeCaseStatusDialog(t){"addOperation"===t.value.value?this.openOperationPopup():"editOperation"===t.value.value?this.handleEditEstimate():"requestStatus"===t.value.value&&this.handleRequestStatus()}openOperationPopup(){this.checkGTEstimatePermission()?this.commonService.showToast(0,"msg_gt_permission"):this.dialog.open(De,{data:{repairId:this.repairGuid},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:t=>{var e;t&&(["draft","uploaddocuments","uploadphotos"].includes(null===(e=this.repairStatus)||void 0===e?void 0:e.toLowerCase())&&(this.repairStatus="RepairEstimation"),this.afterOperation=!0,this.getBookingRepairDetails())}})}handleEditEstimate(){"GTMotive"!==this.estimateSource?this.checkGTEstimatePermission()?this.commonService.showToast(0,"msg_gt_permission"):this.editEstimate=!0:this.caseGuid&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.redirectToGtEstimate.bind(this),Vt.j.quote):this.redirectToGtEstimate()}handleSaveEditedEstimate(){this.editEstimate=!1}handleEditRepairOperation(t){return(0,kt.mG)(this,void 0,void 0,function*(){try{this.commonService.showLoading(),this.monitorService.logEvent("getRepairEstimateOperationDetails",["EstimateComponent","addenda-repair"]);const e=yield this.getRepairEstimateOperationDetails(t);if(this.commonService.hideLoading(),null==e?void 0:e.data){const t=Object.entries(e.data).map(t=>[t[0][0].toUpperCase()+t[0].slice(1),t[1]]),n=Object.fromEntries(t);this.dialog.open(De,{data:{repairId:this.repairGuid,operationDetails:n},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:t=>{t&&this.getEstimateFromCaseAndRepair("","")}})}}catch(e){this.commonService.hideLoading(),this.monitorService.logException(e,Qt._.Error)}})}getRepairEstimateOperationDetails(t){return(0,kt.mG)(this,void 0,void 0,function*(){return(0,At.z)(this.repairEstimateOperationService.getRepairEstimateOperationDetails(t))})}handleIconClicked(t){const{id:e,action:n}=t;"edit"===n&&this.handleEditRepairOperation(e),"delete"===n&&(this.caseGuid?this.commonService.showChangeWarningMessage(this.handleDeleteRepairOperation.bind(this,e),Vt.j.quote):this.handleDeleteRepairOperation(e))}handleDeleteRepairOperation(t){this.commonService.openDeleteDialog().afterClosed().subscribe(e=>{e&&(this.monitorService.logEvent("getBookingRepairDetails",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,id:t}),this.commonService.showLoading(),(0,At.z)(this.repairEstimateOperationService.deleteRepairEstimateOperation(this.repairGuid,t)).then(t=>{let e="";(null==t?void 0:t.message)&&(e=t.message),this.getManualEstimationDetail(e)}).catch(()=>{this.commonService.hideLoading()}))})}downloadPdf(){this.commonService.showLoading(),this.monitorService.logEvent("downloadPdf",["RepairEstimateComponent","addenda-repair",{caseId:this.caseGuid}]),this.repairEstimateService.getXADownloadUrl(this.caseGuid).subscribe({next:t=>{window.open(t.data.url,"_top"),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}getInitialRepairTypes(t){t.forEach(t=>{this.repairTypesArray.push(t.repairServiceType)})}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(t=>{t&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}handleRequestStatus(){this.dialog.open(Ue,{width:"629px",maxWidth:"629px",autoFocus:!1,data:this.repairGuid}).afterClosed().subscribe({next:t=>{t&&this.getBookingRepairDetails()}})}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.subscription.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["EstimateComponent","addenda-repair"])}repairNotInvoiced(){var t,e,n,i,o,r,a;return!("invoiced"===(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())||"paid"===(null===(e=this.repairStatus)||void 0===e?void 0:e.toLowerCase())||"closed"===(null===(n=this.repairStatus)||void 0===n?void 0:n.toLowerCase())||"complete"===(null===(i=this.repairStatus)||void 0===i?void 0:i.toLowerCase())||"readytoinvoice"===(null===(o=this.repairStatus)||void 0===o?void 0:o.toLowerCase())||"readytoinvoice"===(null===(r=this.invoiceStatus)||void 0===r?void 0:r.toLowerCase())||"invoiced"===(null===(a=this.invoiceStatus)||void 0===a?void 0:a.toLowerCase()))}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(te.v),i.Y36(Ye.H),i.Y36(Ot.gz),i.Y36(qt.uw),i.Y36($t.q),i.Y36(yt.sK),i.Y36(Xt),i.Y36(Et.M),i.Y36(Be.K),i.Y36(ze.o),i.Y36(Ot.F0),i.Y36(He.c))},t.\u0275cmp=i.Xpm({type:t,selectors:[["estimate"]],decls:8,vars:3,consts:[["class","repair-estimate-step",4,"ngIf"],[1,"footer-full-wrapper","estimate-details-footer"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],["class","footer-button-wrapper show-md",4,"ngIf"],["class","footer-button-wrapper show-sm",4,"ngIf"],[1,"repair-estimate-step"],["serviceType","repair",3,"estimateResponse","editEstimate","estimateSource","i18n","iconClicked","downloadPdf"],[1,"footer-button-wrapper","show-md"],[4,"ngIf"],["class","show-md",4,"ngIf"],[3,"buttonModel","click"],[1,"show-md"],[4,"chqPermission"],[3,"buttonModel","click",4,"ngIf"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel"],[3,"dropdownModel","selected",4,"ngIf"],[3,"dropdownModel","selected"],[1,"footer-button-wrapper","show-sm"],[4,"ngIf","ngIfElse"],["elseTemplate",""]],template:function(t,e){1&t&&(i.YNc(0,$e,2,4,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"div",3),i._UZ(4,"img",4),i.qZA(),i.qZA(),i.ynx(5),i.YNc(6,sn,3,2,"div",5),i.YNc(7,fn,3,2,"div",6),i.BQk(),i.qZA()),2&t&&(i.Q6J("ngIf",e.showData),i.xp6(6),i.Q6J("ngIf",e.showData&&!e.commonService.isViewOnly),i.xp6(1),i.Q6J("ngIf",e.showData&&!e.commonService.isViewOnly))},directives:[o.O5,Ge.r,Ut.E,Qe.A,Ve.I],styles:[".repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container{border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-white);margin-top:25px;margin-bottom:25px;padding:0 32px 32px}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container chq-customloader{margin:auto}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-label{margin-top:25px}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-label, .repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.estimate-details-footer[_ngcontent-%COMP%]   .show-sm[_ngcontent-%COMP%]{display:none!important}@media (max-width: 985px){.estimate-details-footer[_ngcontent-%COMP%]   .show-md[_ngcontent-%COMP%]{display:none!important}.estimate-details-footer[_ngcontent-%COMP%]   .show-sm[_ngcontent-%COMP%]{display:flex!important}.estimate-details-footer[_ngcontent-%COMP%]     .dropdown-container.dropdown-edit-mode{top:0px}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label .placeHolder{font-size:14px!important}.estimate-details-footer[_ngcontent-%COMP%]     a.dropdown{width:180px!important}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label mat-icon{height:17px;width:17px}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label .content mat-icon{height:15px;width:15px}.estimate-details-footer[_ngcontent-%COMP%]     .dropdown-container .dropdown .dropdown-wrapper{border-color:var(--xa-light-gray)!important}}"]}),t})();var _n=n(84967),Mn=n(33568),On=n(84945),yn=n(49517);function Cn(t){let e,n;return i=>(e||(e=i,n=t.formControl,n.valueChanges.subscribe(()=>{e.updateValueAndValidity({onlySelf:!0})})),new Date(n.value)>new Date(e.value)?{invalid:!0}:null)}var xn=n(60562),Pn=n(96472),wn=n(38709),Tn=n(4093),Dn=n(13975),Sn=n(74178),In=n(11145),kn=n(50356),Zn=n(8571);const An=["companyOrg"],qn=["licenseId"],Ln=["driverPhone"],En=["driverCode"],Rn=["orgType"],jn=["make"],Fn=["model"],Nn=["year"],Un=["mileage"],Jn=["license"],Yn=["regDate"],Bn=["repairType"],zn=["bookingout"],Hn=["serviceType"],Gn=["communicationChannel"],Qn=["chqUpload"];function Vn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-input",40),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).onFormUpdateCustomer(e)}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("inputModel",t.formModel.customerData.claimNumber)}}const $n=function(t){return{hide:t}};function Wn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",81),i.TgZ(1,"div",14),i.TgZ(2,"div",82),i.TgZ(3,"chq-input",83),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).onFormUpdateCustomer(e)}),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("ngClass",i.VKq(2,$n,t.isFormConfirmed)),i.xp6(3),i.Q6J("inputModel",t.formModel.customerData.carOwnerSelector)}}const Kn=function(t){return{"disable-input disable-controls":t}};function Xn(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",13),i.TgZ(1,"div",14),i.TgZ(2,"div",82),i.TgZ(3,"chq-input",84,85),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw(2).hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw(2).onFormUpdateCustomer(e)}),i.qZA(),i.TgZ(5,"chq-input",86,87),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).onFormUpdateCustomer(e)}),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.oxw(2);i.xp6(3),i.Q6J("inputModel",t.formModel.customerData.companyName),i.xp6(2),i.Q6J("ngClass",i.VKq(3,Kn,"select"===t.formModel.customerData.companyName.type))("inputModel",t.formModel.customerData.licenseId)}}function ti(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-input",88),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).onFormUpdateCustomer(e)}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("inputModel",t.formModel.customerData.email)}}function ei(t,e){if(1&t&&(i.TgZ(0,"div",89),i.TgZ(1,"div",90),i.TgZ(2,"div",91),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",92),i.TgZ(6,"span"),i._uU(7),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(3),i.hij("",i.lcZ(4,2,t.formModel.customerData.email.label)," "),i.xp6(4),i.Oqu(t.formModel.customerData.email.value)}}function ni(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-input",93,94),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).onFormUpdateCustomer(e)}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("inputModel",t.formModel.customerData.driverPhone)}}function ii(t,e){if(1&t&&(i.TgZ(0,"div",90),i.TgZ(1,"div",91),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"div",92),i.TgZ(5,"span"),i._uU(6),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(2),i.hij("",i.lcZ(3,2,t.formModel.customerData.driverPhone.label)," "),i.xp6(4),i.Oqu(t.formModel.customerData.driverPhone.value)}}function oi(t,e){if(1&t&&(i.TgZ(0,"div",95),i.TgZ(1,"label"),i._uU(2),i.ALo(3,"uppercase"),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"label"),i._uU(6),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(2),i.Oqu(i.lcZ(3,2,i.lcZ(4,4,"type_of_service"))),i.xp6(4),i.Oqu(t.serviceTypeString)}}function ri(t,e){if(1&t&&(i.TgZ(0,"div",95),i.TgZ(1,"label"),i._uU(2),i.ALo(3,"uppercase"),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"label"),i._uU(6),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(2),i.Oqu(i.lcZ(3,2,i.lcZ(4,4,"types_of_repair"))),i.xp6(4),i.Oqu(t.repairTypesString)}}function ai(t,e){if(1&t&&(i.TgZ(0,"div",95),i.TgZ(1,"label"),i._uU(2),i.ALo(3,"uppercase"),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"label"),i._uU(6),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(2),i.hij("",i.lcZ(3,2,i.lcZ(4,4,"assign_to"))," "),i.xp6(4),i.Oqu(t.assigneeString)}}function si(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",108),i.NdJ("click",function(){i.CHM(t);const e=i.oxw().$implicit;return i.oxw(3).expandCollapseAssignedTo(e)}),i.TgZ(1,"div"),i._uU(2),i.qZA(),i.TgZ(3,"div"),i._UZ(4,"mat-icon",109),i.qZA(),i.qZA()}if(2&t){const t=i.oxw().$implicit;i.xp6(2),i.hij(" ",t.repair," "),i.xp6(2),i.Q6J("svgIcon",t.active?"dropdown-up":"dropdown")}}function li(t,e){1&t&&i._UZ(0,"img",113)}function ci(t,e){1&t&&i._UZ(0,"img",114)}function di(t,e){if(1&t&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.AsE(" ",t.firstName," ",t.lastName,"")}}function pi(t,e){if(1&t&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.Oqu(t.assigneeName)}}function ui(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",110),i.NdJ("dblclick",function(){const e=i.CHM(t).$implicit,n=i.oxw().$implicit;return i.oxw(3).onDoubleClick(e,n)}),i.YNc(1,li,1,0,"img",111),i.YNc(2,ci,1,0,"img",112),i.YNc(3,di,2,2,"span",69),i.YNc(4,pi,2,1,"span",69),i.qZA()}if(2&t){const t=e.$implicit;i.Q6J("cdkDragDisabled",!t.isAvailable),i.xp6(1),i.Q6J("ngIf",t.isAvailable),i.xp6(1),i.Q6J("ngIf",!t.isAvailable),i.xp6(1),i.Q6J("ngIf",!t.assigneeName),i.xp6(1),i.Q6J("ngIf",t.assigneeName)}}function hi(t,e){if(1&t&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.AsE(" ",t.firstName," ",t.lastName,"")}}function gi(t,e){if(1&t&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.Oqu(t.assigneeName)}}function mi(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",115),i._UZ(1,"img",113),i.YNc(2,hi,2,2,"span",69),i.YNc(3,gi,2,1,"span",69),i.TgZ(4,"mat-icon",116),i.NdJ("click",function(){const e=i.CHM(t).$implicit,n=i.oxw().$implicit;return i.oxw(3).unAssignEmployee(e,n)}),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit;i.xp6(2),i.Q6J("ngIf",!t.assigneeName),i.xp6(1),i.Q6J("ngIf",t.assigneeName),i.xp6(1),i.Q6J("svgIcon","cross")}}const vi=function(t){return[t]};function fi(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",97),i.YNc(1,si,5,2,"div",98),i.TgZ(2,"div",81),i.TgZ(3,"div",99),i.TgZ(4,"div",100),i._uU(5),i.ALo(6,"uppercase"),i.ALo(7,"uppercase"),i.ALo(8,"translate"),i.qZA(),i.TgZ(9,"div",101),i.TgZ(10,"div",102),i.YNc(11,ui,5,5,"div",103),i.qZA(),i.qZA(),i.qZA(),i.TgZ(12,"div",99),i.TgZ(13,"div",100),i._uU(14),i.ALo(15,"uppercase"),i.ALo(16,"translate"),i.qZA(),i.TgZ(17,"div",104),i.TgZ(18,"div",105,106),i.NdJ("cdkDropListDropped",function(e){const n=i.CHM(t).$implicit;return i.oxw(3).drop(e,n.repairId)}),i.YNc(20,mi,5,3,"div",107),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit,n=i.MAs(19),o=i.oxw(3);i.Q6J("ngClass",o.isTechnician||"complete"===(null==o.status?null:o.status.toLowerCase())?"disable-container":""),i.xp6(1),i.Q6J("ngIf","Repair"===o.personalInfoData.serviceType),i.xp6(1),i.Q6J("ngClass",i.VKq(21,$n,!t.active&&"Repair"===o.personalInfoData.serviceType)),i.xp6(3),i.AsE(" ",i.lcZ(6,11,null==t.repair?null:t.repair.toString())," ",i.lcZ(7,13,i.lcZ(8,15,"specialists"))," "),i.xp6(5),i.Q6J("cdkDropListConnectedTo",i.VKq(23,vi,n))("cdkDropListData",t.employees),i.xp6(1),i.Q6J("ngForOf",t.employees),i.xp6(3),i.hij(" ",i.lcZ(15,17,i.lcZ(16,19,"specialists_assigned"))," "),i.xp6(4),i.Q6J("cdkDropListData",t.employeesAssigned),i.xp6(2),i.Q6J("ngForOf",t.employeesAssigned)}}function bi(t,e){if(1&t&&(i.ynx(0),i.YNc(1,fi,21,25,"div",96),i.BQk()),2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("ngForOf",t.repairEmployees)}}function _i(t,e){if(1&t&&(i.TgZ(0,"div",117),i.TgZ(1,"label"),i._uU(2),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(2),i.Oqu(t.formModel.towedIn.value)}}const Mi=function(){return{"pointer-events":"none"}},Oi=function(){return{}};function yi(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",56),i.TgZ(1,"div",57),i._uU(2),i.ALo(3,"translate"),i.TgZ(4,"span",7),i._uU(5,"*"),i.qZA(),i.qZA(),i.TgZ(6,"div",118),i.TgZ(7,"div",13),i.TgZ(8,"div",14),i.TgZ(9,"chq-input",119,120),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.oxw(2);i.xp6(2),i.hij(" ",i.lcZ(3,3,"preferred_comm")," "),i.xp6(7),i.Q6J("inputModel",t.formModel.communicationChannel)("ngStyle",t.formModel.communicationChannel.disabled?i.DdM(5,Mi):i.DdM(6,Oi))}}function Ci(t,e){if(1&t&&i._UZ(0,"chq-button",22),2&t){const t=i.oxw(4);i.Q6J("buttonModel",t.cancelButtonModel)}}function xi(t,e){if(1&t&&i._UZ(0,"chq-button",22),2&t){const t=i.oxw(4);i.Q6J("buttonModel",t.bookingButtonModel)}}function Pi(t,e){if(1&t&&i._UZ(0,"chq-button",22),2&t){const t=i.oxw(4);i.Q6J("buttonModel",t.closeButtonModel)}}function wi(t,e){if(1&t&&(i.TgZ(0,"div",122),i.YNc(1,Ci,1,1,"chq-button",123),i.YNc(2,xi,1,1,"chq-button",123),i.YNc(3,Pi,1,1,"chq-button",123),i.qZA()),2&t){const t=i.oxw(3);i.xp6(1),i.Q6J("ngIf",t.showDelete),i.xp6(1),i.Q6J("ngIf",!t.repairId||"complete"!==(null==t.status?null:t.status.toLowerCase())),i.xp6(1),i.Q6J("ngIf",t.repairId&&t.isFormConfirmed)}}function Ti(t,e){1&t&&(i.ynx(0),i.YNc(1,wi,4,3,"div",121),i.BQk()),2&t&&(i.xp6(1),i.Q6J("chqPermission","newBooking"))}const Di=function(t,e){return{"text-mode bg-tab-default-content":t,"page-wrapper":e}},Si=function(t){return{"text-mode":t}},Ii=function(t){return{"partial-disable-info":t}},ki=function(t){return{"partial-disable-info disable-controls":t}},Zi=function(t,e){return{"disable-controls disable-input":t,hide:e}};function Ai(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",4),i.TgZ(1,"div",5),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"div",6),i.TgZ(5,"span",7),i._uU(6,"*"),i.qZA(),i._uU(7),i.ALo(8,"translate"),i.qZA(),i.TgZ(9,"div",8),i.TgZ(10,"div",9),i.TgZ(11,"form",10),i.TgZ(12,"div",11),i.TgZ(13,"div",12),i.TgZ(14,"div",13),i.TgZ(15,"div",14),i.TgZ(16,"div",13),i.TgZ(17,"chq-input",15,16),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateCustomer(e)}),i.qZA(),i.YNc(19,Vn,1,1,"chq-input",17),i.qZA(),i.qZA(),i.qZA(),i.YNc(20,Wn,4,4,"div",18),i.YNc(21,Xn,7,5,"div",19),i.qZA(),i.TgZ(22,"div",20),i.TgZ(23,"div",21),i._UZ(24,"chq-button",22),i.qZA(),i.qZA(),i.TgZ(25,"div",23),i.TgZ(26,"div",13),i.TgZ(27,"div",24),i.TgZ(28,"div",25),i.TgZ(29,"div",26),i.TgZ(30,"chq-input",27),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateCustomer(e)}),i.qZA(),i.TgZ(31,"chq-input",27),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateCustomer(e)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(32,"div",28),i.TgZ(33,"div",26),i.YNc(34,ti,1,1,"chq-input",29),i.YNc(35,ei,8,4,"div",30),i.TgZ(36,"div",31),i.TgZ(37,"div",26),i.TgZ(38,"chq-input",32,33),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateCustomer(e)}),i.qZA(),i.YNc(40,ni,2,1,"chq-input",34),i.YNc(41,ii,7,4,"div",35),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(42,"div",36),i.TgZ(43,"div",37),i._uU(44),i.ALo(45,"translate"),i.qZA(),i.TgZ(46,"div",38),i.TgZ(47,"div",39),i.TgZ(48,"chq-input",40),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateVehicle(e)}),i.qZA(),i.TgZ(49,"div",41),i._UZ(50,"chq-button",22),i.qZA(),i.qZA(),i.TgZ(51,"div",42),i.TgZ(52,"chq-input",43,44),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateVehicle(e)}),i.qZA(),i.TgZ(54,"chq-input",45,46),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateVehicle(e)}),i.qZA(),i.qZA(),i.TgZ(56,"div",47),i.TgZ(57,"chq-input",48,49),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateVehicle(e)}),i.qZA(),i.TgZ(59,"chq-input",40,50),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateVehicle(e)}),i.qZA(),i.qZA(),i.TgZ(61,"div",51),i.TgZ(62,"chq-input",52,53),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateVehicle(e)}),i.qZA(),i.TgZ(64,"chq-input",54,55),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateVehicle(e)}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(66,"div",56),i.TgZ(67,"div",57),i._uU(68),i.ALo(69,"translate"),i.qZA(),i.TgZ(70,"div",58),i.TgZ(71,"div",13),i.TgZ(72,"chq-input",59,60),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.YNc(74,oi,7,6,"div",61),i.TgZ(75,"chq-input",62,63),i.NdJ("clicked",function(e){return i.CHM(t),i.oxw().hideDropdown(e)})("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.YNc(77,ri,7,6,"div",61),i.YNc(78,ai,7,6,"div",61),i.qZA(),i.TgZ(79,"div",13),i.TgZ(80,"chq-input",64),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.TgZ(81,"chq-input",40,65),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(83,"div",66),i.TgZ(84,"div",57),i._uU(85),i.ALo(86,"translate"),i.qZA(),i.TgZ(87,"div",67),i.TgZ(88,"div",13),i.TgZ(89,"div",14),i.TgZ(90,"chq-input",68),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.YNc(91,bi,2,1,"ng-container",69),i.qZA(),i.TgZ(92,"div",70),i.TgZ(93,"div",57),i._uU(94),i.ALo(95,"translate"),i.qZA(),i.TgZ(96,"div",71),i.TgZ(97,"div",13),i.TgZ(98,"div",14),i.TgZ(99,"div",72),i.TgZ(100,"chq-input",73),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.YNc(101,_i,3,1,"div",74),i.qZA(),i.qZA(),i.qZA(),i.TgZ(102,"div",75),i.TgZ(103,"div",13),i.TgZ(104,"div",14),i.TgZ(105,"chq-input",73),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.YNc(106,yi,11,7,"div",76),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(107,"div",77),i.TgZ(108,"div",78),i.TgZ(109,"div",79),i._UZ(110,"img",80),i.qZA(),i.qZA(),i.YNc(111,Ti,2,1,"ng-container",69),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("ngClass",i.WLB(71,Di,t.isFormConfirmed,!t.isFormConfirmed)),i.xp6(1),i.Q6J("ngClass",i.VKq(74,Si,t.isFormConfirmed)),i.xp6(1),i.hij(" ",i.lcZ(3,59,"customer_details")," "),i.xp6(2),i.Q6J("ngClass",i.VKq(76,$n,t.isFormConfirmed)),i.xp6(3),i.hij("",i.lcZ(8,61,"mandatory_fields")," "),i.xp6(10),i.Q6J("inputModel",t.formModel.customerData.companyOrgType),i.xp6(2),i.Q6J("ngIf","Insurance Company"===t.customerFormData.companyOrgType),i.xp6(1),i.Q6J("ngIf",t.isRetailProvider),i.xp6(1),i.Q6J("ngIf",!t.isRetailProvider||t.customerFormData[t.formModel.customerData.carOwnerSelector.name]&&"Person"!==t.customerFormData[t.formModel.customerData.carOwnerSelector.name]),i.xp6(1),i.Q6J("ngClass",i.VKq(78,$n,t.isFormConfirmed||!t.currentStatus||t.isTechnician)),i.xp6(2),i.Q6J("buttonModel",t.chqUploadDrivingLicense),i.xp6(6),i.Q6J("inputModel",t.formModel.customerData.firstName),i.xp6(1),i.Q6J("inputModel",t.formModel.customerData.lastName),i.xp6(3),i.Q6J("ngIf",!t.isFormConfirmed),i.xp6(1),i.Q6J("ngIf",t.isFormConfirmed),i.xp6(3),i.Q6J("inputModel",t.formModel.customerData.driverCode),i.xp6(2),i.Q6J("ngIf",!t.isFormConfirmed),i.xp6(1),i.Q6J("ngIf",t.isFormConfirmed),i.xp6(2),i.Q6J("ngClass",i.VKq(80,Si,t.isFormConfirmed)),i.xp6(1),i.hij(" ",i.lcZ(45,63,"vehicle_detail")," "),i.xp6(3),i.Q6J("ngClass",i.VKq(82,Ii,t.searchDisabled)),i.xp6(1),i.Q6J("inputModel",t.formModel.vehicleData.vin),i.xp6(1),i.Q6J("ngClass",i.VKq(84,$n,t.isFormConfirmed||!t.currentStatus||t.isTechnician)),i.xp6(1),i.Q6J("buttonModel",t.chqUploadRegistrationCard),i.xp6(1),i.Q6J("ngClass",i.VKq(86,Kn,t.inputDisabled)),i.xp6(1),i.Q6J("inputModel",t.formModel.vehicleData.make)("ngClass",i.VKq(88,Kn,t.makeDisabled)),i.xp6(2),i.Q6J("inputModel",t.formModel.vehicleData.model)("ngClass",i.VKq(90,Kn,t.modelDisabled)),i.xp6(2),i.Q6J("ngClass",i.VKq(92,Kn,t.inputDisabled)),i.xp6(1),i.Q6J("inputModel",t.formModel.vehicleData.year)("ngClass",i.VKq(94,Kn,t.yearDisabled)),i.xp6(2),i.Q6J("inputModel",t.formModel.vehicleData.licensePlate),i.xp6(2),i.Q6J("ngClass",i.VKq(96,ki,t.infoDisabled)),i.xp6(1),i.Q6J("inputModel",t.formModel.vehicleData.carMilege),i.xp6(2),i.Q6J("inputModel",t.formModel.vehicleData.registrationDate),i.xp6(4),i.hij(" ",i.lcZ(69,65,"booking_details")," "),i.xp6(4),i.Q6J("ngClass",i.VKq(98,$n,t.isFormConfirmed))("inputModel",t.formModel.serviceType),i.xp6(2),i.Q6J("ngIf",t.isFormConfirmed),i.xp6(1),i.Q6J("inputModel",t.formModel.repairTypes)("ngClass",i.WLB(100,Zi,t.repairTypeDisabled,t.isFormConfirmed)),i.xp6(2),i.Q6J("ngIf",t.isFormConfirmed),i.xp6(1),i.Q6J("ngIf",t.isFormConfirmed),i.xp6(2),i.Q6J("inputModel",t.formModel.bookingInDate)("ngClass",t.isFormConfirmed?"col-4":"col-6"),i.xp6(1),i.Q6J("inputModel",t.formModel.bookingOutDate),i.xp6(2),i.Q6J("ngClass",i.VKq(103,$n,t.isFormConfirmed)),i.xp6(2),i.hij(" ",i.lcZ(86,67,"job_allocation")," "),i.xp6(5),i.Q6J("inputModel",t.formModel.jobAllocation)("ngStyle",t.formModel.communicationChannel.disabled?i.DdM(105,Mi):i.DdM(106,Oi)),i.xp6(1),i.Q6J("ngIf",t.personalInfoData.jobAllocation&&"Repair"!==t.personalInfoData.serviceType||t.personalInfoData.jobAllocation&&"Repair"===t.personalInfoData.serviceType&&(null==t.formModel.repairTypes||null==t.formModel.repairTypes.selectedOption?null:t.formModel.repairTypes.selectedOption.length)),i.xp6(3),i.hij(" ",i.lcZ(95,69,"other_details")," "),i.xp6(5),i.Q6J("ngClass",i.VKq(107,$n,t.isFormConfirmed)),i.xp6(1),i.Q6J("inputModel",t.formModel.towedIn),i.xp6(1),i.Q6J("ngIf",t.isFormConfirmed),i.xp6(4),i.Q6J("inputModel",t.formModel.notes),i.xp6(1),i.Q6J("ngIf",(null==t.formModel.communicationChannel.options?null:t.formModel.communicationChannel.options.length)>0),i.xp6(5),i.Q6J("ngIf",!t.commonService.isViewOnly)}}const qi=function(t){return{disabled:t}};Je.extend(Pn);let Li=(()=>{class t{constructor(t,e,n,i,o,r,a,s,l,c,d,p,u,h,g){this.router=t,this.commonService=e,this.monitorService=n,this.caseService=i,this.coreService=o,this.vehicleService=r,this.route=a,this.bookingService=s,this.formBuilder=l,this.inspectionService=c,this.mediaCollectionService=d,this.settingService=p,this.labourService=u,this.translateService=h,this.calendarService=g,this.isFormConfirmed=!1,this.inputDisabled=!0,this.infoDisabled=!0,this.searchDisabled=!1,this.inspectionTemplateId=0,this.makeDisabled=!1,this.preventVinCall=!1,this.modelDisabled=!1,this.yearDisabled=!1,this.caseId="",this.umc="",this.validVehicleFields=[],this.employeeList=[],this.towingDisabled=!0,this.repairTypeDisabled=!0,this.labourData=null,this.inspections=null,this.nextUrl="",this.originalVin="",this.isApiLoading=!0,this.documentSteps=[],this.countryId=6,this.canNavigate=!1,this.repairTypes=[],this.originalTariffObject={},this.vinFromOCR="",this.serviceTypeString="",this.repairTypesString="--",this.assigneeString="--",this.mode="",this.employeeRepairServiceType=[],this.previousCompetencies=[],this.isRepairCreatedFromCase=!1,this.isTechnician=!1,this.subscriptions=[],this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.closeButtonModel={label:"Close",type:"primary",onclick:this.closeForm.bind(this)},this.bookingButtonModel={label:"book_in",type:"primary",onclick:this.submitForm.bind(this)},this.chqUploadDrivingLicense={label:"upload_license",type:"outline",icon:"camera",iconColor:"black"},this.chqUploadRegistrationCard={label:"upload_registration",type:"outline",icon:"camera",iconColor:"black"},this.vehicleFormData={vin:"",make:"",model:"",year:"",carMilege:"",licensePlate:"",registrationDate:"",inspectionID:"",inspectionGuid:"",isVinSpecifiedManualZ:!1},this.customerFormData={jobNumber:"",companyOrgType:"",claimNumber:"",companyName:"",tariffId:0,isTariffEditable:!0,licenseId:"",firstName:"",lastName:"",companyId:0,partnershipId:0,customerTypeID:1,driverCode:"",driverPhone:0,carOwnerSelector:"",email:""},this.personalInfoData={customerData:this.customerFormData,vehicleData:this.vehicleFormData,serviceType:"",serviceTypeId:0,repairTypes:null,bookingInDate:"",bookingOutDate:"",towedIn:"Not towed in",notes:"",communicationChannel:[],assignedTo:"",jobAllocation:!1},this.repairEmployees=[],this.repairAssignedEmployees=[],this.selectedOptionRepairs=[],this.userPermission={},this.communicationForm=this.formBuilder.group({communicationChannel:[[],jt.kI.required]}),this.commonService.repairGuid.closed&&(this.commonService.repairGuid=new Zt.X(null)),this.commonService.actionTriggered.closed&&(this.commonService.actionTriggered=new Zt.X(null)),this.commonService.labourData.closed&&(this.commonService.labourData=new Zt.X(null)),this.commonService.actionTriggered.subscribe({next:t=>{t&&(this.checkForFormValidation()?(this.nextUrl=t,this.submitForm(t)):this.isFormConfirmed||this.commonService.showToast(0,"msg_booking_validation"))}}),this.commonService.viewActionTriggeredBooking.closed&&(this.commonService.viewActionTriggeredBooking=new Zt.X(null)),this.commonService.viewActionTriggeredBooking.subscribe({next:t=>{t&&t&&"string"==typeof t&&(-1!=t.indexOf("?mode=edit")?(t=t.replace("?mode=edit",""),this.router.navigate([t.replace("{bookingId}",this.repairId)],{queryParams:{mode:"edit"}})):this.router.navigate([t.replace("{bookingId}",this.repairId)]))}});const m=this.commonService.eventfromToastComponent$.subscribe(t=>{t&&(this.monitorService.logEvent("eventfromToastComponent",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.router.navigate(this.nextUrl&&"string"==typeof this.nextUrl?[this.nextUrl.replace("{bookingId}",this.repairId)]:["/repair/booking-journal"]))});this.subscriptions.push(m),this.commonService.userProfileData.subscribe(t=>{if(t&&t.data){const{userPermission:e,organizationDetail:n,vehicleSourceType:i}=t.data;this.userPermission=e||{},this.currentOrgId=n.id,this.estimateId=i}}),this.commonService.labourData.subscribe(t=>{t&&(this.labourData=t)})}get isRetailProvider(){return!!this.customerFormData.companyOrgType&&"Retail"===this.customerFormData.companyOrgType}get showDelete(){var t,e;return!(this.repairId&&(!this.repairId||"draft"!==(null===(t=this.status)||void 0===t?void 0:t.toLowerCase()))&&(!this.repairId||!this.caseId||1!=this.isRepairCreatedFromCase||"repairestimation"!=(null===(e=this.status)||void 0===e?void 0:e.toLowerCase())))}get isRetailAndCompanyProvider(){return!!this.customerFormData.companyOrgType&&("Retail"!==this.customerFormData.companyOrgType||"Retail"===this.customerFormData.companyOrgType&&this.customerFormData.carOwnerSelector&&"Person"!==this.customerFormData.carOwnerSelector)}get retail(){return this.customerFormData.companyOrgType?this.formModel.customerData.companyOrgType.selectedOption[this.formModel.customerData.companyOrgType.displayValue]:""}get currentStatus(){var t;return!this.status&&!this.isFormConfirmed||-1!==["draft","uploaddocuments","uploadphotos"].indexOf(null===(t=this.status)||void 0===t?void 0:t.toLowerCase())&&!this.isFormConfirmed}setCommunicationMethods(){var t;null===(t=this.commonService.userProfileData)||void 0===t||t.subscribe(t=>{var e,n;const i=null===(n=null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.userPermission.orgPackages.find(t=>"Communication Channel"===t.automotiveServiceName))||void 0===n?void 0:n.permissions;let o="~";null==i||i.forEach(t=>{o+=t.permissionName.toLowerCase()}),this.formModel.communicationChannel.options=this.formModel.communicationChannel.options.filter(t=>o.includes(t.label.toLowerCase()))})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,e=t.filter(t=>"Repair Estimate"===t.automotiveServiceName);if(e&&e.length>0){const{permissions:t}=e[0],n=t.filter(t=>"gt.estimate"===t.permissionName||"gt.estimate.vinquery"===t.permissionName);if(n&&n.length>0)return!0}return!1}checkRouteParams(t){this.route.queryParams.subscribe(e=>{e.caseId&&(this.caseId=e.caseId),e.mode&&(this.mode=e.mode),e.startDate&&e.endDate&&(this.startDate=e.startDate,this.endDate=e.endDate),t()})}handleImageOutput(t){const{file:e}=t;this.commonService.showLoading();const n={mediaCollectionId:this.mediaTemplate.collectionGuid,domainId:this.domainId,objectId:this.objectId,mediaTemplateId:this.currentStep.templateGuid,mediaPartTemplateId:this.currentStep.partTemplateGuid};this.monitorService.logEvent("handleImageOutput",["PersonalInfoComponent","addenda-repair",{obj:n}]),this.currentStep.uploadInProgress=!0,this.currentStep.isSkipped=!1,this.currentStep.isUploadFailed=!1,this.currentStep.isUploadSuccess=!1,this.mediaCollectionService.uploadDocumentOCR(e,n).subscribe({next:t=>{this.prefillDriverDetailsFromOcr(null==t?void 0:t.ocrTags),this.handleRegistrationPrefillOCR(null==t?void 0:t.ocrTags),this.currentStep.stepName.includes("Driving")?this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{label:"Retake",icon:"retake"}):this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{label:"Retake",icon:"retake"})},error:t=>{this.monitorService.logException(t,Qt._.Error),this.commonService.hideLoading()},complete:()=>this.commonService.hideLoading()})}getMediaTemplateByObject(){var t;this.mediaPartTemplates=this.commonService.getAllChild(null===(t=this.mediaTemplate)||void 0===t?void 0:t.mediaTemplates,"mediaPartTemplates","mediaTemplateGuid",{parentProp:"name",childProp:"parentName"});for(let e=0;e<this.mediaPartTemplates.length;e++){const t=this.mediaPartTemplates[e];if(t.name.includes("Vehicle Registration")&&t.name.includes("Driving License"))continue;const n=(0,Ie.sH)(t,e);this.documentSteps.push(Object.assign(Object.assign({},n),{mandatory:t.mandatory,index:e,parentName:t.parentName,isFront:t.frontSide,updatedDate:"00000000-0000-0000-0000-000000000000"!=t.mediaPartGuid?t.updatedDate:"",uploadedDate:"00000000-0000-0000-0000-000000000000"!=t.mediaPartGuid?t.createdDate:"",domainId:this.domainId,objectId:this.objectId,sizeLimit:t.sizeLimit,allowExtension:t.allowExtension,uploadedPartGuid:"00000000-0000-0000-0000-000000000000"!=t.mediaPartGuid?t.mediaPartGuid:"",uploadedGuid:"00000000-0000-0000-0000-000000000000"!=t.mediaGuid?t.mediaGuid:"",partTemplateGuid:t.mediaPartTemplateGuid,templateGuid:t.mediaTemplateGuid}))}}prefillDriverDetailsFromOcr(t){if(t&&t.length>0)for(let e=0;e<t.length;e++){const n=t[e];if(n[n.key]=n.value,n.Name){const t=n.Name.split(" ");this.customerFormData.firstName=t[0],this.formModel.customerData.firstName=Object.assign(Object.assign({},this.formModel.customerData.firstName),{value:t[0],selectedOption:{}}),t.splice(0,1),this.customerFormData.lastName=t.join(" "),this.formModel.customerData.lastName=Object.assign(Object.assign({},this.formModel.customerData.lastName),{value:t.join(" "),selectedOption:{}})}}}handleRegistrationPrefillOCR(t){if(this.resetVehicleDropdown(!0),this.vehicleFormData.vin="",this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:""}),t&&t.length>0)for(let e=0;e<t.length;e++){const n=t[e],i=n.value;if(this.infoDisabled=!1,n.key.includes("Chassis"))this.vehicleFormData.vin=i,this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:i}),this.searchDisabled=!1,this.preventVinCall=!1,this.vinFromOCR=i;else if(n.key.includes("Plate"))this.vehicleFormData.licensePlate=i,this.inputDisabled=!1,this.formModel.vehicleData.licensePlate=Object.assign(Object.assign({},this.formModel.vehicleData.licensePlate),{value:i});else if(n.key.includes("Make")||n.key.includes("Veh."))this.vehicleFormData.make=i,this.inputDisabled=!1,this.makeDisabled=!1,this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:i}});else if(n.key.includes("Manufacturer")){const t=i.split("/"),e=`${t[2]}-${t[1]}-${t[0]}T00:00:00`;this.vehicleFormData.registrationDate=e,this.formModel.vehicleData.registrationDate=Object.assign(Object.assign({},this.formModel.vehicleData.registrationDate),{value:e})}else n.key.includes("Model")&&(this.vehicleFormData.model=i,this.modelDisabled=!1,this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:i}}))}}checkMakeModelExistFromOCR(){var t,e,n,i,o;const r=null===(t=this.formModel.vehicleData.make.selectedOption)||void 0===t?void 0:t.name;if(this.commonService.openAlertDialog("warning_header_ocr","warning_message_ocr"),r)if(this.vehicleFormData.isVinSpecifiedManualZ=!0,null===(e=this.formModel.vehicleData.make.options)||void 0===e?void 0:e.some(t=>t.name==r)){if(!(null===(i=this.formModel.vehicleData.model.selectedOption)||void 0===i?void 0:i.modelDescription)){const t=null===(o=this.formModel.vehicleData.make.options)||void 0===o?void 0:o.find(t=>t.name==r);this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{observable:this.vehicleService.getVehicleModel(t.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)}),setTimeout(()=>{var t;null===(t=this.model)||void 0===t||t.triggerObservable()})}}else(null===(n=this.formModel.vehicleData.model.selectedOption)||void 0===n?void 0:n.modelDescription)&&(this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{id:"",name:"00- "}}),this.vehicleFormData.year="00- ")}handleDrivingLicenseVehicleUpload(t){let e="Driving License";t&&(e="Vehicle Registration"),1===this.countryId&&t&&(e+=" Back");const n=this.documentSteps.filter(t=>t.stepName.includes(e));this.currentStep=n[0],this.repairId||this.objectId?(this.currentStep.objectId=this.objectId,this.vinFromOCR="",this.chqUpload.triggerUpload()):(this.commonService.hideLoading(),this.submitForm("",!0,()=>{this.currentStep.objectId=this.objectId,this.chqUpload.triggerUpload(),this.commonService.hideLoading()}))}handleDrivingLicenseClick(){this.handleDrivingLicenseVehicleUpload()}handleRegistrationCardClick(){this.handleDrivingLicenseVehicleUpload(!0)}ngOnInit(){this.formModel={search:{placeHolder:"Search",name:"search",label:"",type:"search",value:0,icon:"cross",preIcon:"search"},serviceType:{placeHolder:"select_dot",name:"serviceType",label:"type_of_service",value:0,type:"select",displayValue:"name",idField:"serviceType",fieldValue:"id",options:[],errorWhenEmpty:!0,validation:{name:"serviceType",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"warning_service_type":""}},repairTypes:{placeHolder:"select_dot",name:"repairTypes",label:"types_of_repair",value:0,type:"select",displayValue:"name",idField:"repairName",fieldValue:"id",errorWhenEmpty:!0,isMultiSelect:!0,validation:{name:"repairTypes",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"required_repair_type":""},options:[]},bookingInDate:{placeHolder:"booking_in",label:"booking_in",name:"bookingInDate",value:new Date,type:"datetime",maxDate:Je().add(10,"year").toDate(),minDate:new Date,validation:{name:"bookingInDate",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"required_date":""}},bookingOutDate:{placeHolder:"booking_out",label:"booking_out",name:"bookingOutDate",value:Je().add(30,"minutes").toDate(),type:"datetime",maxDate:Je().add(10,"year").toDate(),validation:{name:"bookingOutDate",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"required_date":""}},towedIn:{placeHolder:"",label:"",name:"towedIn",idField:"towedIn",value:"Not Towed In",type:"radio",options:[{label:"Not Towed In",id:1},{label:"Towed In/Non-Drivable",id:2}]},notes:{placeHolder:"notes",label:"notes",name:"notes",value:"",type:"textarea",maxLength:500},communicationChannel:{placeHolder:"",label:"",name:"communicationChannel",idField:"communicationChannel",value:"Whatsapp",type:"checkbox",options:[{label:"Whatsapp",id:1,value:1,checked:!1},{label:"Email",id:2,value:2,checked:!1},{label:"SMS",id:3,value:3,checked:!1}],validation:{name:"communicationChannel",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"required_comm_chan":""}},jobAllocation:{placeHolder:"",label:"",name:"jobAllocation",idField:"jobAllocation",value:"",type:"checkbox",options:[{label:"job_assignation",id:1,value:1,checked:!1}]},assignedTo:{placeHolder:"select_dot",name:"assignedTo",label:"assigned_to",value:0,type:"select",displayValue:"name",idField:"assignedTo",fieldValue:"id",errorWhenEmpty:!0,validation:{name:"assignedTo",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:t=>t.required?"required_assign_to":""},options:[]},estimatedEffortHour:{placeHolder:"total_estimated_effort_hour",label:"total_estimated_effort_hour",name:"estimatedEffortHour",value:0,type:"text",maxLength:4,icon:"clock-new",validation:{name:"estimatedEffortHour",validationFunction:()=>jt.kI.compose([t=>{const e=t.value;return!e||/^([01][0-9]|2[0-3])$/.test(e)?null:{invalidTimeFormat:!0}}]),validationMessage:t=>t.required?"Please enter estimated effort hour(s)":t.invalidTimeFormat?"Hours should be between 00 - 23":""}},estimatedEffortMinutes:{placeHolder:"total_estimated_effort_min",label:"total_estimated_effort_min",name:"estimatedEffortMinutes",value:0,type:"text",maxLength:4,icon:"clock-new",validation:{name:"estimatedEffortMinutes",validationFunction:()=>jt.kI.compose([t=>{const e=t.value;return!e||/^([0-5][0-9])$/.test(e)?null:{invalidTimeFormat:!0}}]),validationMessage:t=>t.required?"Please enter estimated effort minutes(s)":t.invalidTimeFormat?"Minutes should be between 00 - 59":""}}},this.formModel=Object.assign(Object.assign({},this.formModel),{customerData:(0,Ie.U6)(),vehicleData:(0,xn.br)()}),this.formModel.vehicleData.vin.icon="",this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{validation:{name:"bookingOutDate",validationFunction:()=>jt.kI.compose([jt.kI.required,Cn(this.formModel.bookingInDate)]),validationMessage:t=>t.required?"required_date":"bookingout_greater_msg"}}),this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{validation:{name:"make",validationFunction:()=>jt.kI.compose([])}}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{validation:{name:"model",validationFunction:()=>jt.kI.compose([])}}),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{validation:{name:"year",validationFunction:()=>jt.kI.compose([])}}),this.formModel.communicationChannel=Object.assign(Object.assign({},this.formModel.communicationChannel),{validation:{name:"communicationChannel",validationFunction:()=>jt.kI.compose([])}}),this.inspectionService.getInspectionTemplateList().subscribe({next:t=>{const e=null==t?void 0:t.data;e.length>0&&(this.commonService.repairInspectionTemplate=e[0],this.inspectionTemplateId=e[0].id)}}),this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{onclick:this.handleDrivingLicenseClick.bind(this),type:"disabled-outline"}),this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{onclick:this.handleRegistrationCardClick.bind(this),type:"disabled-outline"}),this.formModel.customerData.driverCode.observable||(this.formModel.customerData.driverCode.observable=this.coreService.getPhoneNumber(),this.formModel.customerData.driverCode.onObservableLoad=this.onObservableLoad.bind(this)),this.mediaCollectionService.getMediaTemplate().subscribe({next:t=>{if(t.data&&t.data.length>0){const{id:e,collectionGuid:n}=t.data[0];this.domainId=3100,this.mediaTemplateId=e,(0,_n.D)({mediaTemplateDetail:this.mediaCollectionService.getMediaTemplateById(n)}).pipe((0,Mn.K)(t=>(0,On.of)(t))).subscribe({next:t=>{t.mediaTemplateDetail&&(this.mediaTemplate=t.mediaTemplateDetail.data,this.countryId=this.mediaTemplate.countryID,this.mediaTemplate.mediaTemplates=this.mediaTemplate.mediaTemplates.sort((t,e)=>t.orderNumber-e.orderNumber),this.getMediaTemplateByObject())}})}}}),this.checkRouteParams(()=>{var t;const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.setRequiredLabel(),this.getBookingRepairDetails(e),this.repairId||(this.caseId?this.caseService.getCaseDetail(this.caseId).subscribe({next:t=>{this.prefillCaseData(t)},error:()=>{this.prefillVehicleData()}}):this.prefillVehicleData())}),this.setCommunicationMethods()}ngAfterViewInit(){this.repairId||this.setValidatorForVehicle()}setValidatorForVehicle(){var t,e,n;null===(t=this.mileage)||void 0===t||t.setValidatorForVehicle([jt.kI.maxLength(7),jt.kI.pattern("^[0-9]+$"),(0,xn.nG)()]),null===(e=this.license)||void 0===e||e.setValidatorForVehicle([jt.kI.maxLength(12),jt.kI.pattern("^[a-zA-Z0-9]*$"),(0,xn.Gp)()]),null===(n=this.regDate)||void 0===n||n.setValidatorForVehicle([])}getBookingRepairDetails(t){var e;const n=Object.keys(this.formModel.customerData);if(t&&"0"!=t)this.isApiLoading=!0,this.repairId=t,this.loadRepair();else{this.isApiLoading=!1,this.caseId||this.getProvider();for(const t in n){const e=n[t];"driverCode"!==e?this.formModel.customerData[e]=Object.assign(Object.assign({},this.formModel.customerData[e]),{value:"",selectedOption:{}}):(this.formModel.customerData[e]=Object.assign(Object.assign({},this.formModel.customerData[e]),{value:"",selectedOption:{phoneCountryCode:"+91"}}),this.customerFormData.driverCode="+91")}this.getEmployees(),this.populateDropdowns(),(null===(e=this.formModel.communicationChannel.options)||void 0===e?void 0:e.length)>0&&setTimeout(()=>{var t;null===(t=this.communicationChannelControl)||void 0===t||t.setValidatorForCommunicationChannel([jt.kI.required])})}}getEmployees(){this.caseService.getCaseUsers("").subscribe({next:t=>{this.employeeList=t.data}})}loadRepair(){var t,e,n,i,o,r;return(0,kt.mG)(this,void 0,void 0,function*(){const a=Object.keys(this.formModel.customerData);this.commonService.showLoading(),this.bookingButtonModel.label="save",yield this.populateReadonlyFields().then(t=>{var e,n,i,o,r,s,l,c,d,p,u,h;console.log(t),this.repairResponse=t.data,this.objectId=this.repairResponse.id,this.status=this.repairResponse.status,this.statusId=this.repairResponse.statusId,this.vehicleId=(null===(e=this.repairResponse.vehicle)||void 0===e?void 0:e.vehicleId)||"0",this.isRepairCreatedFromCase=this.repairResponse.isRepairCreatedFromCase,"technician"==(null===(n=this.commonService.roleName)||void 0===n?void 0:n.toLowerCase())&&(this.isTechnician=!0),this.inspections={inspectionGuid:null===(i=this.repairResponse.vehicle)||void 0===i?void 0:i.inspectionGuid,inspectionId:null===(o=this.repairResponse.vehicle)||void 0===o?void 0:o.inspectionId},this.caseId=this.repairResponse.quoteId,(null===(r=this.repairResponse.tariffs)||void 0===r?void 0:r.length)>0&&(this.labourData=this.repairResponse.tariffs[0]),this.originalTariffObject={make:null===(s=this.repairResponse.vehicle)||void 0===s?void 0:s.vehicleMake,partnershipId:null===(l=this.repairResponse.customer)||void 0===l?void 0:l.partnershipId,registrationDate:Je(null===(c=this.repairResponse.vehicle)||void 0===c?void 0:c.registrationDate).format("YYYY-MM-DDT00:00:00")};const g=this.repairResponse.inspections;(null==g?void 0:g.length)>0&&this.commonService.inspectionId.next(this.repairResponse.inspections[0].inspectionId),this.commonService.bookingId.next(this.repairResponse.repairNumber),this.commonService.repairGuid.next(this.repairResponse.repairGuid),this.commonService.repairDetails.next(this.repairResponse),this.customerFormData=(0,Ie.Qb)(this.repairResponse.customer);for(const m in a){const t=this.formModel.customerData[a[m]],{type:e,displayValue:n,fieldValue:i}=t;if(this.customerFormData[a[m]])if("select"===e){const t={};t[n]="",t[i]=this.customerFormData[a[m]],"companyOrgType"===a[m]&&(t[n]=this.customerFormData[a[m]]),this.formModel.customerData[a[m]]=Object.assign(Object.assign({},this.formModel.customerData[a[m]]),{value:"",selectedOption:t,disabled:!(!this.caseId&&!this.isTechnician&&this.currentOrgId==(null===(p=null===(d=this.repairResponse)||void 0===d?void 0:d.organizationDetail)||void 0===p?void 0:p.organizationId))})}else{let t={};"companyName"===a[m]&&(t={companyName:this.customerFormData[a[m]]}),this.formModel.customerData[a[m]]=Object.assign(Object.assign({},this.formModel.customerData[a[m]]),{value:this.customerFormData[a[m]],selectedOption:t,disabled:!(!this.caseId&&!this.isTechnician&&this.currentOrgId==(null===(h=null===(u=this.repairResponse)||void 0===u?void 0:u.organizationDetail)||void 0===h?void 0:h.organizationId))})}}this.populateVehicleData(),this.populateBookingData()}).catch(()=>{this.commonService.hideLoading()}),this.isApiLoading=!1,(null===(t=this.formModel.communicationChannel.options)||void 0===t?void 0:t.length)>0&&setTimeout(()=>{var t;null===(t=this.communicationChannelControl)||void 0===t||t.setValidatorForCommunicationChannel([jt.kI.required])}),this.currentStatus&&this.currentOrgId===(null===(n=null===(e=this.repairResponse)||void 0===e?void 0:e.organizationDetail)||void 0===n?void 0:n.organizationId)&&this.getProvider(),yield this.populateDropdowns(),this.checkForFormValidation(),this.checkWorkProvider(),this.currentOrgId!=(null===(o=null===(i=this.repairResponse)||void 0===i?void 0:i.organizationDetail)||void 0===o?void 0:o.organizationId)&&this.disableAll(),"complete"==(null===(r=this.status)||void 0===r?void 0:r.toLowerCase())&&(this.bookingButtonModel.type="disabled")})}populateReadonlyFields(){return(0,kt.mG)(this,void 0,void 0,function*(){if(this.repairId&&"0"!=this.repairId)return this.commonService.showLoading(),(0,At.z)(this.bookingService.getRepairDetailByGuid(this.repairId))})}populateBookingData(){var t,e,n,i,o,r,a,s,l,c,d,p,u,h;const{startDate:g,endDate:m,bookingGuid:v,notes:f,communicationTypeId:b,assignees:_}=this.repairResponse.booking;this.bookingId=v,this.formModel.bookingInDate=Object.assign(Object.assign({},this.formModel.bookingInDate),{value:g,disabled:!("complete"!==(null===(t=this.status)||void 0===t?void 0:t.toLowerCase())&&!this.isTechnician&&"readytoinvoice"!==(null===(e=this.status)||void 0===e?void 0:e.toLowerCase())&&"invoiced"!==(null===(n=this.status)||void 0===n?void 0:n.toLowerCase()))}),this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{value:m,disabled:!("complete"!==(null===(i=this.status)||void 0===i?void 0:i.toLowerCase())&&!this.isTechnician)}),this.formModel.serviceType=Object.assign(Object.assign({},this.formModel.serviceType),{selectedOption:{id:this.repairResponse.repairTypeId,name:this.repairResponse.repairType},disabled:!("complete"!==(null===(o=this.status)||void 0===o?void 0:o.toLowerCase())&&!this.isTechnician)}),this.serviceTypeString=this.repairResponse.repairType,this.assigneeString=null==_?void 0:_.map(t=>t.assigneeName).join(", "),this.formModel.notes=Object.assign(Object.assign({},this.formModel.notes),{value:f,disabled:!("complete"!==(null===(r=this.status)||void 0===r?void 0:r.toLowerCase())&&!this.isTechnician)}),this.formModel.towedIn=Object.assign(Object.assign({},this.formModel.towedIn),{value:this.repairResponse.isTowingNeeded?"Towed In/Non-Drivable":"Not Towed In",disabled:!("complete"!==(null===(a=this.status)||void 0===a?void 0:a.toLowerCase())&&!this.isTechnician)}),this.formModel.communicationChannel=Object.assign(Object.assign({},this.formModel.communicationChannel),{value:b,disabled:!("complete"!==(null===(s=this.status)||void 0===s?void 0:s.toLowerCase())&&!this.isTechnician)}),this.formModel.communicationChannel.options.forEach(t=>{t.checked=!!this.formModel.communicationChannel.value.some(e=>e==t.value)}),this.communicationForm.get("communicationChannel").setValue(this.formModel.communicationChannel.value);const M=[];if(this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:this.repairResponse.isJobAssignationRequired,disabled:!("complete"!==(null===(l=this.status)||void 0===l?void 0:l.toLowerCase())&&!this.isTechnician)}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=this.repairResponse.isJobAssignationRequired),"repair"==(null===(c=this.repairResponse.repairType)||void 0===c?void 0:c.toLowerCase())){const t=[];this.repairResponse.repairServiceTypes.forEach(e=>{M.push({id:e.repairServiceTypeId,name:e.repairServiceType}),this.repairTypes.push({id:e.repairServiceTypeId,name:e.repairServiceType}),t.push(e.repairServiceType)}),this.repairTypesString=t.join(","),this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{selectedOption:M,disabled:!("complete"!==(null===(d=this.status)||void 0===d?void 0:d.toLowerCase())&&!this.isTechnician)}),this.repairTypeDisabled=!1}else"repair"!=(null===(p=this.repairResponse.repairType)||void 0===p?void 0:p.toLowerCase())&&(null===(u=this.repairResponse.repairServiceTypes)||void 0===u?void 0:u.length)>0&&(this.selectedOptionRepairs=[],this.repairResponse.repairServiceTypes.forEach(t=>{t.repairServiceTypeId&&this.selectedOptionRepairs.push({id:t.repairServiceTypeId,name:t.repairServiceType,dropdownItemIcon:this.getIcon(t.repairServiceType),disabled:!0})}));this.personalInfoData=Object.assign(Object.assign({},this.personalInfoData),{bookingInDate:g,bookingOutDate:m,notes:f,communicationChannel:b,serviceType:this.repairResponse.repairType,jobAllocation:this.repairResponse.isJobAssignationRequired,serviceTypeId:this.repairResponse.repairTypeId,repairTypes:(null===(h=this.repairTypes)||void 0===h?void 0:h.length)>0?this.repairTypes:null})}populateVehicleData(){const{vinNumber:t,licensePlateNumber:e,vehicleMileage:n,registrationDate:i,vehicleMake:o,vehicleModel:r,modelYear:a,inspectionId:s,inspectionGuid:l,umc:c,id:d,modelYearRange:p,isVinSpecifiedManualZ:u}=this.repairResponse.vehicle;0!=d&&(this.infoDisabled=!1,this.searchDisabled=!1,this.inputDisabled=!1,this.originalVin=t),(!this.currentStatus||this.isTechnician)&&(this.infoDisabled=!0),this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:t,disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.licensePlate=Object.assign(Object.assign({},this.formModel.vehicleData.licensePlate),{value:e,disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.carMilege=Object.assign(Object.assign({},this.formModel.vehicleData.carMilege),{value:n,disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.registrationDate=Object.assign(Object.assign({},this.formModel.vehicleData.registrationDate),{value:i,disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:o},disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{name:"0"==p?null:p},disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:r},disabled:!(!this.caseId&&!this.isTechnician)}),this.umc=c,s&&this.commonService.inspectionId.next(s),this.vehicleFormData=Object.assign(Object.assign({},this.vehicleFormData),{vin:t,make:o,model:r,year:a||p,carMilege:n,licensePlate:e,registrationDate:i,inspectionGuid:l,inspectionID:s,isVinSpecifiedManualZ:u})}prefillCaseData(t){if(t){const e=(0,Ie.Wk)(t.data);this.customerFormData=(0,Ie.Qb)(e);const n=Object.keys(this.formModel.customerData);this.customerFormData.tariffId=t.data.tariffs[0].tariffId,this.customerFormData.partnershipId=t.data.tariffs[0].partnershipId,this.labourData=t.data.tariffs[0],this.status=t.data.status;for(const t in n){const e=this.formModel.customerData[n[t]],{type:i,displayValue:o,fieldValue:r}=e;if(this.customerFormData[n[t]])if("select"===i){const e={};e[o]="",e[r]=this.customerFormData[n[t]],"companyOrgType"===n[t]&&(e[o]=this.customerFormData[n[t]]),this.formModel.customerData[n[t]]=Object.assign(Object.assign({},this.formModel.customerData[n[t]]),{value:"",selectedOption:e,disabled:!0})}else{let e={};"companyName"===n[t]&&(e={companyName:this.customerFormData[n[t]]}),this.formModel.customerData[n[t]]=Object.assign(Object.assign({},this.formModel.customerData[n[t]]),{value:this.customerFormData[n[t]],selectedOption:e,disabled:!0})}}this.checkWorkProvider(),this.processVehicleData(t)}}processVehicleData(t){return(0,kt.mG)(this,void 0,void 0,function*(){if(null==t.data)return void this.commonService.hideLoading();const e=t.data.vehicleId||0,n=t.data.inspections,{inspectionId:i,inspectionGuid:o}=(null==n?void 0:n.length)>0?n[0]:[];this.vehicleId=e;const{vinNumber:r,licensePlateNumber:a,vehicleMileage:s,registrationDate:l,vehicleMake:c,vehicleModel:d,modelYear:p,umc:u}=t.data;0!=e&&(this.infoDisabled=!1,this.searchDisabled=!1,this.inputDisabled=!1,this.preventVinCall=!0),this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:r,disabled:!0}),this.formModel.vehicleData.licensePlate=Object.assign(Object.assign({},this.formModel.vehicleData.licensePlate),{value:a,disabled:!0}),this.formModel.vehicleData.carMilege=Object.assign(Object.assign({},this.formModel.vehicleData.carMilege),{value:s,disabled:!0}),this.formModel.vehicleData.registrationDate=Object.assign(Object.assign({},this.formModel.vehicleData.registrationDate),{value:l,disabled:!0}),this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:c},disabled:!0}),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{disabled:!0,selectedOption:{name:p||t.data.modelYearRange}}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:d},disabled:!0}),this.umc=u,this.vehicleFormData=Object.assign(Object.assign({},this.vehicleFormData),{vin:r,make:c,model:d,year:p||t.data.modelYearRange,carMilege:s,licensePlate:a,registrationDate:l,vehicleId:e,inspectionGuid:o,inspectionID:i}),this.commonService.hideLoading(),yield this.populateDropdowns()})}updateButton(){return(0,kt.mG)(this,void 0,void 0,function*(){this.monitorService.logEvent("updateButton",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.isFormConfirmed=!this.isFormConfirmed,this.setMode(this.isFormConfirmed?"text":"value"),"edit booking"==this.bookingButtonModel.label.toLowerCase()&&(this.preventVinCall=!0,this.vehicleFormData.vin&&this.vehicleService.getVinDecoder(this.vehicleFormData.vin).subscribe({next:t=>{this.makeDisabled=!!(null==t?void 0:t.success)}}),yield this.populateDropdowns()),this.bookingButtonModel=Object.assign(Object.assign({},this.bookingButtonModel),{label:this.isFormConfirmed?"Edit Booking":"Save",type:this.isFormConfirmed?"outline":"primary",icon:this.isFormConfirmed?"edit":""})})}openDocument(){this.caseService.getCases({offset:0,pageSize:1,maxPageButtons:6,currentPage:1,orderBy:"CreatedDate",sortDirection:"asc"}).subscribe(t=>{if(t&&t.value){const{CaseGuid:e}=t.value[0];this.router.navigate([`repair/booking/${e}/document`],{queryParams:{fromPersonal:!0}})}})}addVehicle(){return(0,kt.mG)(this,void 0,void 0,function*(){const t={vin:this.vehicleFormData.vin,vehicleCountryId:1,umc:this.umc,make:this.vehicleFormData.make,model:this.vehicleFormData.model,mileage:Number(this.vehicleFormData.carMilege),firstRegistrationDate:Je(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"),registrationNumber:this.vehicleFormData.licensePlate,condition:1,ModelYearRange:this.vehicleFormData.year,InspectionTemplateId:this.inspectionTemplateId,CustomerName:this.customerFormData.firstName,CustomerEmail:this.customerFormData.email};return(0,At.z)(this.vehicleService.addVehicle(t,3100,0)).then(t=>{t&&(this.vehicleId=t.id,this.vehicleFormData.inspectionID=t.inspectionId,this.vehicleFormData.inspectionGuid=t.inspectionGuid)}).catch(t=>{throw this.commonService.hideLoading(),t})})}setPrefillData(t){var e,n,i,o,r,a,s;const l=this.commonService.getSessionStorage("selectedSearchItem");if(!this.caseId&&l){const c=JSON.parse(l);if(this.formModel.customerData.email=Object.assign(Object.assign({},this.formModel.customerData.email),{value:c.email,selectedOption:{}}),this.customerFormData.email=c.email,c.firstName&&(this.customerFormData.firstName=c.firstName,this.formModel.customerData.firstName=Object.assign(Object.assign({},this.formModel.customerData.firstName),{value:this.customerFormData.firstName,selectedOption:{}})),c.lastName&&(this.customerFormData.lastName=c.lastName,this.formModel.customerData.lastName=Object.assign(Object.assign({},this.formModel.customerData.lastName),{value:this.customerFormData.lastName,selectedOption:{}})),c.phoneNumber){const l=null===(e=c.phoneNumber)||void 0===e?void 0:e.substring(0,3),d=null===(n=c.phoneNumber)||void 0===n?void 0:n.substring(0,4);let p="",u=t.filter(t=>t.phoneCountryCode===l);if(0===u.length?(p=null===(i=c.phoneNumber)||void 0===i?void 0:i.substring(4,null===(o=c.phoneNumber)||void 0===o?void 0:o.length),u=t.filter(t=>t.phoneCountryCode===d)):p=null===(r=c.phoneNumber)||void 0===r?void 0:r.substring(3,null===(a=c.phoneNumber)||void 0===a?void 0:a.length),u.length>0){const t=u[0],e=t.regExpression;this.customerFormData.driverCode=null==t?void 0:t.phoneCountryCode,this.formModel.customerData.driverCode=Object.assign(Object.assign({},this.formModel.customerData.driverCode),{selectedOption:t}),null===(s=this.driverPhone)||void 0===s||s.updateCurrentValidation(e,!0)}this.formModel.customerData.driverPhone=Object.assign(Object.assign({},this.formModel.customerData.driverPhone),{value:p,selectedOption:{}}),this.customerFormData.driverPhone=parseInt(p)}(c.email||c.phoneNumber||c.firstName)&&this.commonService.setSessionStorage("selectedSearchItem","")}}setRequiredLabel(){const t=["notes","repairtypes"];Object.keys(this.formModel).forEach(e=>{"customerdata"==e.toLowerCase()||"vehicledata"==e.toLowerCase()?Object.keys(this.formModel[e]).forEach(n=>{"vehicledata"==e.toLowerCase()?this.formModel[e][n].required=!1:t.includes(n.toLowerCase())||(this.formModel[e][n].required=!0)}):t.includes(e.toLowerCase())||(this.formModel[e].required=!0)}),this.startDate&&this.endDate?(this.personalInfoData.bookingInDate=Je(this.startDate).local().utc().format(),this.formModel.bookingInDate=Object.assign(Object.assign({},this.formModel.bookingInDate),{value:this.personalInfoData.bookingInDate}),this.personalInfoData.bookingOutDate=Je(this.endDate).local().utc().format(),this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{value:this.personalInfoData.bookingOutDate})):(this.personalInfoData.bookingInDate=Je.utc(this.formModel.bookingInDate.value.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z",this.personalInfoData.bookingOutDate=Je.utc(this.formModel.bookingOutDate.value.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z")}disableAll(){Object.keys(this.formModel).forEach(t=>{"customerdata"==t.toLowerCase()||"vehicledata"==t.toLowerCase()?Object.keys(this.formModel[t]).forEach(e=>{this.formModel[t][e].disabled=!0}):this.formModel[t].disabled=!0})}populateDropdowns(){var t,e,n,i,o,r,a,s,l,c,d,p,u,h,g,m,v,f,b;return(0,kt.mG)(this,void 0,void 0,function*(){this.formModel.customerData.driverCode.observable||(this.formModel.customerData.driverCode=Object.assign(Object.assign({},this.formModel.customerData.driverCode),{observable:this.coreService.getPhoneNumber(),onObservableLoad:this.onObservableLoad.bind(this)}));const _=yield(0,At.z)(this.settingService.getBookingRepairType()),M=null===(t=null==_?void 0:_.data)||void 0===t?void 0:t.BookingTypes;let O=(null===(n=null===(e=null==_?void 0:_.data)||void 0===e?void 0:e.RepairType)||void 0===n?void 0:n.length)?null===(i=_.data)||void 0===i?void 0:i.RepairType[0].RepairTypes:null;if(M&&M.length>0){if(this.formModel.serviceType=Object.assign(Object.assign({},this.formModel.serviceType),{options:M}),this.repairId&&!(null===(o=this.formModel.serviceType.options)||void 0===o?void 0:o.some(t=>{var e;return t.id==(null===(e=this.repairResponse)||void 0===e?void 0:e.repairTypeId)}))){const t=yield(0,At.z)(this.settingService.getAllSettings()),e=(null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.BookingTypes).find(t=>t.id==this.repairResponse.repairTypeId);if(e&&this.formModel.serviceType.options.push(e),"repair"==(null===(a=this.personalInfoData.serviceType)||void 0===a?void 0:a.toLowerCase())){const e=null===(s=this.formModel.repairTypes)||void 0===s?void 0:s.selectedOption;O=(null===(c=null===(l=null==t?void 0:t.data)||void 0===l?void 0:l.RepairType[0].RepairTypes)||void 0===c?void 0:c.length)?null===(p=null===(d=t.data)||void 0===d?void 0:d.RepairType[0].RepairTypes)||void 0===p?void 0:p.filter(t=>!(null==e?void 0:e.map(t=>t.id).includes(t.id))):null,O=[...O,...e],O.sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0)}}else if(this.repairId&&"repair"==(null===(u=this.personalInfoData.serviceType)||void 0===u?void 0:u.toLowerCase())){const t=(null===(h=this.formModel.repairTypes)||void 0===h?void 0:h.selectedOption).filter(t=>!O.map(t=>t.id).includes(t.id));t.length>0&&(O=[...O,...t],O.sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0))}"repair"!=(null===(g=this.personalInfoData.serviceType)||void 0===g?void 0:g.toLowerCase())&&(this.formModel.bookingOutDate.disabled=!0)}O&&O.length>0&&(O.forEach((t,e)=>{O[e]=this.selectedOptionRepairs.some(e=>e.id===t.id)?Object.assign(Object.assign({},O[e]),{dropdownItemIcon:this.getIcon(t.name),disabled:!0}):Object.assign(Object.assign({},O[e]),{dropdownItemIcon:this.getIcon(t.name)})}),this.repairTypes=O,this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{options:O}));const y=null===(m=this.repairResponse)||void 0===m?void 0:m.repairServiceTypes;if(this.personalInfoData.serviceType&&("Repair"==this.personalInfoData.serviceType?(y.some(t=>t.employees.length>0)&&(yield this.getAllAssignedEmployees(null==y?void 0:y.filter(t=>null!=t.repairServiceType))),this.previousCompetencies=null===(v=this.formModel.repairTypes.selectedOption)||void 0===v?void 0:v.map(t=>t.id)):((null===(f=this.selectedOptionRepairs)||void 0===f?void 0:f.length)>0&&(this.previousCompetencies=null===(b=this.selectedOptionRepairs)||void 0===b?void 0:b.map(t=>t.id)),yield this.getAllAssignedEmployeesAssessment(null==y?void 0:y.filter(t=>null==t.repairServiceType)))),this.currentStatus){this.commonService.showLoading();const t=yield(0,At.z)(this.vehicleService.getVehicleMake());this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{options:t.sort((t,e)=>t.name.localeCompare(e.name))});const e=this.formModel.vehicleData.make.options.filter(t=>t.name===this.vehicleFormData.make);e.length>0&&this.vehicleService.getVehicleModel(e[0].id,this.estimateId).subscribe(t=>{var e,n;this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{options:t});const i=null===(e=this.formModel.vehicleData.model.options)||void 0===e?void 0:e.filter(t=>t.umc==this.umc);i.length>0&&(null===(n=this.vehicleService.getVehicleYearByModel(i[0].id,this.estimateId))||void 0===n||n.subscribe(t=>{this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{options:t})}))}),this.commonService.hideLoading()}})}prefillVehicleData(){const t=this.commonService.getSessionStorage("selectedSearchItem");if(t){const e=JSON.parse(t);e.make&&!this.vehicleFormData.make&&(this.vehicleFormData.make=e.make,this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:e.make}})),e.model&&!this.vehicleFormData.model&&(this.vehicleFormData.model=e.model,this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:e.model}})),e.vin&&!this.vehicleFormData.vin&&(this.vehicleFormData.vin=e.vin,this.preventVinCall=!0,this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:e.vin})),e.importInterval&&!this.vehicleFormData.year&&(this.vehicleFormData.year=e.importInterval,this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{value:e.importInterval,selectedOption:{name:e.importInterval}})),e.plate&&!this.vehicleFormData.licensePlate&&(this.vehicleFormData.licensePlate=e.plate,this.formModel.vehicleData.licensePlate=Object.assign(Object.assign({},this.formModel.vehicleData.licensePlate),{value:e.plate})),(e.make||e.model||e.vin||e.plate)&&(this.infoDisabled=!1,this.searchDisabled=!1,this.inputDisabled=!1,(!e.email||!e.name||!e.phoneNumber)&&this.commonService.setSessionStorage("selectedSearchItem",""))}}onObservableLoad(t){if(this.commonService.hideLoading(),t&&t&&t.length>0){const e=t.filter(t=>{var e;return t.phoneCountryCode===(null===(e=this.formModel.customerData.driverCode.selectedOption)||void 0===e?void 0:e.phoneCountryCode)});if(e.length>0){const n=e[0],i=n.regExpression;this.formModel.customerData.driverCode=Object.assign(Object.assign({},this.formModel.customerData.driverCode),{selectedOption:n}),this.driverPhone&&this.driverPhone.updateCurrentValidation(i,!0),this.repairId||this.setPrefillData(t)}}}onObservableLoadRepairTypes(t){this.commonService.hideLoading(),t&&t.length>0&&t.forEach((e,n)=>{t[n]=Object.assign(Object.assign({},t[n]),{dropdownItemIcon:this.getIcon(e.name)})}),this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{options:t})}onObservableLoadServiceAndRepairTypes(t){var e;if(this.commonService.hideLoading(),t){const n=t.BookingTypes,i=(null===(e=t.RepairType)||void 0===e?void 0:e.length)?t.RepairType[0].RepairTypes:null;n&&n.length>0&&(this.formModel.serviceType=Object.assign(Object.assign({},this.formModel.serviceType),{options:n})),i&&i.length>0&&(i.forEach((t,e)=>{i[e]=Object.assign(Object.assign({},i[e]),{dropdownItemIcon:this.getIcon(t.name)})}),this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{options:i}))}}getIcon(t){switch(t){case"Body":return"car";case"Maintenance":return"house";case"Tires":return"tire";case"Paint":return"paintbrush";case"Others":return"gears";case"Electric":case"Electrical":return"bolt-car";case"Diagnosis":return"diagnosis";case"Mechanical":return"mechanical";default:return""}}setMode(t="text"){Object.keys(this.formModel).forEach(e=>{"customerdata"==e.toLowerCase()||"vehicledata"==e.toLowerCase()?Object.keys(this.formModel[e]).forEach(n=>{if("customerdata"==e.toLowerCase())if(this.formModel[e][n].required=!1,"companyOrgType"===n){const i={},{displayValue:o,fieldValue:r}=this.formModel[e][n];i[r]=this.customerFormData[n],i[o]="",i[o]=this.customerFormData[n],this.formModel[e][n]=Object.assign(Object.assign({},this.formModel[e][n]),{mode:t})}else this.formModel[e][n]=Object.assign(Object.assign({},this.formModel[e][n]),{mode:t});else this.formModel[e][n]=Object.assign(Object.assign({},this.formModel[e][n]),{mode:t})}):this.formModel[e]=Object.assign(Object.assign({},this.formModel[e]),{mode:t})}),"text"==t&&(this.bookingButtonModel=Object.assign(Object.assign({},this.bookingButtonModel),{label:"Edit Booking",type:"outline",icon:"edit"}))}onFormUpdate(t){var e,n,i,o,r,a,s,l,c,d,p,u,h,g,m,v,f,b,_,M,O,y,C,x,P,w,T,D,S,I,k,Z,A;return(0,kt.mG)(this,void 0,void 0,function*(){if("select"===t.type){this.formModel[t.name]=Object.assign(Object.assign({},this.formModel[t.name]),{selectedOption:t.value});const h=this.formModel[t.name].fieldValue;if(this.personalInfoData[t.name]="repairTypes"!==t.name?t.value[h]:t.value,"repairTypes"===t.name){if(""==t.value&&(this.formModel[t.name]=Object.assign(Object.assign({},this.formModel[t.name]),{selectedOption:[]})),setTimeout(()=>{var t;null===(t=this.repairType)||void 0===t||t.setUnTouched()}),1==this.personalInfoData.jobAllocation){let s=[];this.previousCompetencies.length<(null===(e=this.formModel.repairTypes.selectedOption)||void 0===e?void 0:e.length)?(s=null===(n=this.personalInfoData[t.name])||void 0===n?void 0:n.filter(t=>!this.previousCompetencies.includes(t.id)),s&&s.length?yield this.getAllAssignedEmployees(null===(i=this.repairResponse)||void 0===i?void 0:i.repairServiceTypes,s[0].id):yield this.getAllAssignedEmployees(null===(o=this.repairResponse)||void 0===o?void 0:o.repairServiceTypes)):(s=null===(r=this.previousCompetencies)||void 0===r?void 0:r.filter(t=>{var e;return!(null===(e=this.formModel.repairTypes.selectedOption)||void 0===e?void 0:e.map(t=>t.id).includes(t))}),s.length&&(this.repairEmployees=this.repairEmployees.filter(t=>t.repairId!=s[0]),this.employeeRepairServiceType=null===(a=this.employeeRepairServiceType)||void 0===a?void 0:a.filter(t=>t.repairServiceTypeId!=s[0])))}0==(null===(s=this.repairEmployees)||void 0===s?void 0:s.length)&&this.personalInfoData.jobAllocation&&(this.commonService.showInfoToast(1e3,"msg_no_competency"),this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:!1}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=!1),this.personalInfoData.jobAllocation=!1),this.previousCompetencies=null===(l=this.formModel[t.name].selectedOption)||void 0===l?void 0:l.map(t=>t.id)}else if("serviceType"===t.name)if(this.personalInfoData.serviceType=t.value.name,this.personalInfoData.serviceTypeId=t.value.id,this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:!1}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=!1),this.personalInfoData.jobAllocation=!1,this.employeeRepairServiceType=[],this.repairEmployees=[],this.previousCompetencies=(null===(c=this.selectedOptionRepairs)||void 0===c?void 0:c.length)>0?null===(d=this.selectedOptionRepairs)||void 0===d?void 0:d.map(t=>t.id):[],"Repair"==(null===(p=t.value)||void 0===p?void 0:p.name)){if(this.selectedOptionRepairs.length>0&&"repair"!=this.serviceTypeString.toLowerCase()){const t=null===(u=this.selectedOptionRepairs)||void 0===u?void 0:u.filter(t=>{var e,n;return!(null===(n=null===(e=this.repairTypes)||void 0===e?void 0:e.map(t=>t.id))||void 0===n?void 0:n.includes(t.id))});(null==t?void 0:t.length)>0&&(this.repairTypes=[...this.repairTypes,...t]),this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{selectedOption:this.selectedOptionRepairs}),this.personalInfoData.repairTypes=this.selectedOptionRepairs}this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{options:this.repairTypes}),this.repairTypeDisabled=!1,this.formModel.bookingOutDate.disabled=!1,this.formModel.repairTypes.required=!0}else{this.formModel.repairTypes.required=!1;const e=this.formModel.serviceType.options.find(e=>e.id==t.value.id);if(null==e?void 0:e.duration){const t=Je.utc(this.formModel.bookingInDate.value.toString()).add(null==e?void 0:e.duration,"minutes").toDate();this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{value:t}),this.personalInfoData.bookingOutDate=Je(t).local().utc().format(),this.formModel.bookingOutDate.disabled=!0}this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{selectedOption:[],options:[],placeHolder:"Select..."}),this.personalInfoData.repairTypes=null,setTimeout(()=>{this.repairType&&(this.repairType.dropdownValidationMessage="",this.repairType.dropdownContainer.dropdownConfig.isTouched=!1,this.repairType.dropdownContainer.dropdownConfig.isDirty=!1)},0),this.repairTypeDisabled=!0}}else if("jobAllocation"==t.name)this.repairEmployees=[],"repair"===this.personalInfoData.serviceType.toLowerCase()?(null===(h=this.formModel.repairTypes.selectedOption)||void 0===h?void 0:h.length)&&(1==t.value?(yield this.getAllAssignedEmployees(null===(g=this.repairResponse)||void 0===g?void 0:g.repairServiceTypes),0==(null===(m=this.repairEmployees)||void 0===m?void 0:m.length)&&(this.commonService.showInfoToast(1e3,"msg_no_competency"),t.value=!1,this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:!1}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=!1))):((null===(f=null===(v=this.repairResponse)||void 0===v?void 0:v.repairServiceTypes)||void 0===f?void 0:f.length)&&(this.repairResponse.repairServiceTypes[0].employees=null===(b=this.repairResponse)||void 0===b?void 0:b.repairServiceTypes[0].employees.filter(t=>null!=t.assigneeId)),this.employeeRepairServiceType=[])):this.personalInfoData.serviceType&&(1==t.value?(yield this.getAllAssignedEmployeesAssessment(0==(null===(_=this.selectedOptionRepairs)||void 0===_?void 0:_.length)?null===(M=this.repairResponse)||void 0===M?void 0:M.repairServiceTypes:[]),0==(null===(O=this.repairEmployees)||void 0===O?void 0:O.length)&&(this.commonService.showInfoToast(1e3,"msg_no_competency"),t.value=!1,this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:!1}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=!1))):((null===(C=null===(y=this.repairResponse)||void 0===y?void 0:y.repairServiceTypes)||void 0===C?void 0:C.length)&&(this.repairResponse.repairServiceTypes[0].employees=null===(x=this.repairResponse)||void 0===x?void 0:x.repairServiceTypes[0].employees.filter(t=>null!=t.assigneeId)),this.employeeRepairServiceType=[])),this.formModel[t.name].value=t.value,this.personalInfoData[t.name]=t.value;else if("checkbox"==t.type){if(t.value)this.personalInfoData.communicationChannel.push(t.keyFieldValue);else if(this.personalInfoData.communicationChannel.includes(t.keyFieldValue)){const e=this.personalInfoData.communicationChannel.indexOf(t.keyFieldValue);e>-1&&this.personalInfoData.communicationChannel.splice(e,1)}this.communicationForm.get("communicationChannel").setValue(this.personalInfoData.communicationChannel)}else{if("towedin"==t.name.toLowerCase())this.towingDisabled="towed in/non-drivable"!=t.value.toLowerCase();else if("bookingInDate"==t.name&&"repair"!=(null===(P=this.personalInfoData.serviceType)||void 0===P?void 0:P.toLowerCase())){const e=this.formModel.serviceType.options.find(t=>t.id==this.personalInfoData.serviceTypeId);if(null==e?void 0:e.duration){const n=Je.utc(t.value).add(null==e?void 0:e.duration,"minutes").toDate();this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{value:n}),this.personalInfoData.bookingOutDate=Je(n).local().utc().format()}}t.isValid?(this.formModel[t.name].value=t.value,this.personalInfoData[t.name]=t.value):(this.formModel[t.name].value="",this.personalInfoData[t.name]=""),"bookingInDate"==t.name?t.isValid&&new Date(this.personalInfoData.bookingOutDate)>new Date(t.value)&&this.personalInfoData.jobAllocation&&(this.repairEmployees=[],this.employeeRepairServiceType=[],"repair"==(null===(w=this.personalInfoData.serviceType)||void 0===w?void 0:w.toLowerCase())?yield this.getAllAssignedEmployees(null===(T=this.repairResponse)||void 0===T?void 0:T.repairServiceTypes):yield this.getAllAssignedEmployeesAssessment(0==(null===(D=this.selectedOptionRepairs)||void 0===D?void 0:D.length)?null===(S=this.repairResponse)||void 0===S?void 0:S.repairServiceTypes:[])):"bookingOutDate"==t.name&&t.isValid&&new Date(t.value)>new Date(this.personalInfoData.bookingInDate)&&this.personalInfoData.jobAllocation&&(this.repairEmployees=[],this.employeeRepairServiceType=[],"repair"==(null===(I=this.personalInfoData.serviceType)||void 0===I?void 0:I.toLowerCase())?yield this.getAllAssignedEmployees(null===(k=this.repairResponse)||void 0===k?void 0:k.repairServiceTypes):yield this.getAllAssignedEmployeesAssessment(0==(null===(Z=this.selectedOptionRepairs)||void 0===Z?void 0:Z.length)?null===(A=this.repairResponse)||void 0===A?void 0:A.repairServiceTypes:[]))}this.personalInfoData=Object.assign({},this.personalInfoData),this.checkForFormValidation()})}getAllAssignedEmployees(t=[],e=0){var n,i;return(0,kt.mG)(this,void 0,void 0,function*(){const o=[];0==e?null===(i=null===(n=this.formModel.repairTypes)||void 0===n?void 0:n.selectedOption)||void 0===i||i.forEach(t=>{o.push(t.id)}):o.push(e),o.length>0&&(this.commonService.showLoading(),yield(0,At.z)(this.bookingService.getEmployeesByCompetencies(o,this.personalInfoData.bookingInDate,this.personalInfoData.bookingOutDate)).then(e=>{(null==e?void 0:e.data)&&e.data.forEach(e=>{var n,i;let o=[],r=[],a=[];(null==t?void 0:t.length)&&(o=t.filter(t=>t.repairServiceTypeId==e.competencyId),o.length&&(r=o[0].employees.map(t=>t.assigneeId||t.employeeId),(null===(n=this.employeeRepairServiceType)||void 0===n?void 0:n.some(t=>t.repairServiceTypeId==e.competencyId))||this.employeeRepairServiceType.push({employees:r,repairServiceTypeId:e.competencyId}),a=e.employees.filter(t=>!r.includes(t.employeeId)))),this.repairEmployees.push({repair:null===(i=this.formModel.repairTypes.selectedOption)||void 0===i?void 0:i.filter(t=>t.id==e.competencyId).map(t=>t.name),repairId:e.competencyId,employees:o.length>0?a:e.employees,employeesAssigned:o.length>0?o[0].employees:[],active:!0})}),this.commonService.hideLoading()}).catch(()=>{this.commonService.hideLoading()}))})}getAllAssignedEmployeesAssessment(t=[]){return(0,kt.mG)(this,void 0,void 0,function*(){this.commonService.showLoading(),yield(0,At.z)(this.bookingService.getEmployeesByCompetencies(null,this.personalInfoData.bookingInDate,this.personalInfoData.bookingOutDate)).then(e=>{if(null==e?void 0:e.data){this.repairEmployees=[];let n=[],i=[],o=[];(null==t?void 0:t.length)?(n=t,i=n[0].employees.map(t=>t.assigneeId||t.employeeId),this.employeeRepairServiceType.push({employees:i,repairServiceTypeId:null}),o=null==e?void 0:e.data.filter(t=>!i.includes(t.employeeId)),this.repairEmployees.push({repair:"",repairId:null,employees:o,employeesAssigned:n[0].employees})):this.repairEmployees.push({repair:"",repairId:null,employees:e.data,employeesAssigned:[]})}this.commonService.hideLoading()}).catch(()=>{this.commonService.hideLoading()})})}setMinutesAndHours(t,e){const n=t,i=new Date(e).getTime()-new Date(n).getTime(),o=Math.round(i/6e4),r=Math.floor(o/60),a=o%60;this.formModel.estimatedEffortMinutes=Object.assign(Object.assign({},this.formModel.estimatedEffortMinutes),{value:a}),this.formModel.estimatedEffortHour=Object.assign(Object.assign({},this.formModel.estimatedEffortHour),{value:r})}onFormUpdateCustomer(t){var e,n,i,o,r;if("driverCode"===t.name){const n=t.value.regExpression;null===(e=this.driverPhone)||void 0===e||e.updateCurrentValidation(n)}if("select"===t.type){const e=this.customerFormData[t.name],a=this.formModel.customerData[t.name].fieldValue||this.formModel.customerData[t.name].displayValue;if((null===(n=this.formModel[t.name])||void 0===n?void 0:n.selectedOption)&&(null===(i=this.formModel[t.name])||void 0===i?void 0:i.selectedOption[a])===(null==t?void 0:t.value[a]))return;this.formModel.customerData[t.name]=Object.assign(Object.assign({},this.formModel.customerData[t.name]),{selectedOption:t.value}),this.customerFormData[t.name]=t.value[a],"companyOrgType"===t.name&&(e!==this.customerFormData[t.name]&&setTimeout(()=>{var t,e;null===(t=this.companyOrg)||void 0===t||t.setUnTouched(),null===(e=this.licenseId)||void 0===e||e.setUnTouched()}),t.value[a]&&"Insurance Company"!==t.value[this.formModel.customerData[t.name].displayValue]&&(this.formModel.customerData.claimNumber=Object.assign(Object.assign({},this.formModel.customerData.claimNumber),{value:""})),t.value[a]&&"Retail"!==t.value[this.formModel.customerData[t.name].displayValue]?(this.formModel.customerData.companyName=Object.assign(Object.assign({},this.formModel.customerData.companyName),{displayValue:"companyName",fieldValue:"companyName",onObservableLoad:this.updateCaseData.bind(this),placeHolder:"Select...",value:"",type:"select",observable:this.caseService.getCompanyData(t.value[a],"")}),this.formModel.customerData.companyName.selectedOption&&(null===(o=this.formModel.customerData.companyName.selectedOption)||void 0===o?void 0:o.tariffId)&&(this.customerFormData.companyId=null,this.customerFormData.companyName=null,this.formModel.customerData.companyName.selectedOption={}),this.customerFormData.licenseId="",this.formModel.customerData.licenseId=Object.assign(Object.assign({},this.formModel.customerData.licenseId),{value:""}),setTimeout(()=>{var t;e&&"Retail"!==e&&this.currentStatus&&(null===(t=this.companyOrg)||void 0===t||t.triggerObservable())})):(t.value[a]&&"Retail"===t.value[this.formModel.customerData[t.name].displayValue]&&(this.formModel.customerData.claimNumber=Object.assign(Object.assign({},this.formModel.customerData.claimNumber),{value:""}),this.formModel.customerData.companyName=Object.assign(Object.assign({},this.formModel.customerData.companyName),{placeHolder:"Company Name"}),this.customerFormData.claimNumber="",this.caseService.getCompanyData(t.value[a],"").subscribe({next:t=>{var e,n,i;if(t&&(null===(e=t.data)||void 0===e?void 0:e.length)>0){const e=t.data[0];this.customerFormData.companyId=e.companyId,this.customerFormData.tariffId=e.tariffId,this.formModel.customerData.companyName.selectedOption&&(null===(n=this.formModel.customerData.companyName.selectedOption)||void 0===n?void 0:n.tariffId)&&(this.customerFormData.licenseId="",this.formModel.customerData.licenseId=Object.assign(Object.assign({},null===(i=this.formModel)||void 0===i?void 0:i.customerData.licenseId),{value:""})),"Person"===this.customerFormData[this.formModel.customerData.carOwnerSelector.name]&&(this.customerFormData.companyName=null,this.formModel.customerData.companyName.value=""),this.customerFormData.isTariffEditable=e.isEditable,this.customerFormData.partnershipId=e.partnershipId,this.formModel.customerData.companyName.selectedOption=e[0],this.checkForFormValidation()}},error:()=>{this.customerFormData.tariffId=0,this.customerFormData.isTariffEditable=!1}})),this.formModel.customerData.companyName=Object.assign(Object.assign({},this.formModel.customerData.companyName),{type:"text"}))),"companyName"===t.name&&t.value&&(this.customerFormData.companyId=t.value.companyId,this.customerFormData.tariffId=t.value.tariffId,this.customerFormData.isTariffEditable=t.value.isEditable,this.customerFormData.licenseId=t.value.licenseId.toString(),this.formModel.customerData.licenseId=Object.assign(Object.assign({},null===(r=this.formModel)||void 0===r?void 0:r.customerData.licenseId),{value:t.value.licenseId.toString()}),this.customerFormData.partnershipId=t.value.partnershipId),this.customerFormData[this.formModel.customerData[t.name].idField]=t.value[this.formModel.customerData[t.name].displayValue]}else"carOwnerSelector"===t.name&&t.keyFieldValue&&this.formModel.customerData[t.name].idField&&(this.customerFormData[this.formModel.customerData[t.name].idField]=t.keyFieldValue),t.isValid?(this.formModel.customerData[t.name].value=t.value,this.customerFormData[t.name]=t.value):(this.formModel.customerData[t.name].value="",this.customerFormData[t.name]="driverPhone"!==t.name?"":0);this.customerFormData=Object.assign({},this.customerFormData),this.checkForFormValidation(),this.checkWorkProvider()}checkWorkProvider(){if(this.customerFormData.companyOrgType)if("Insurance Company"===this.customerFormData.companyOrgType){if(this.customerFormData.companyId&&this.customerFormData.claimNumber)return this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"outline"}),void(this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"outline"}))}else if("Retail"!=this.customerFormData.companyOrgType){if(this.customerFormData.companyId)return this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"outline"}),void(this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"outline"}))}else if(this.customerFormData.carOwnerSelector){if("Person"===this.customerFormData.carOwnerSelector)return this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"outline"}),void(this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"outline"}));if(this.customerFormData.companyName&&this.customerFormData.licenseId)return this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"outline"}),void(this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"outline"}))}this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"disabled-outline"}),this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"disabled-outline"})}checkForFormValidationCustomer(){const t=Object.keys(this.customerFormData);let e=[];"Retail"===this.retail?e="Person"===this.customerFormData.carOwnerSelector?["companyName","claimNumber","licenseId","companyId"]:["claimNumber","companyId"]:"Insurance Company"!=this.customerFormData.companyOrgType&&(e=["claimNumber"]);let n=!0;for(const i in t){const o=t[i];if("isTariffEditable"!==o&&-1===e.indexOf(o)&&"carOwnerSelector"!=o&&"jobNumber"!=o&&"caseTypeID"!=o&&"tariffid"!=o.toLowerCase()&&"customerid"!=o.toLowerCase()&&"contactid"!=o.toLowerCase()&&!this.customerFormData[o]){n=!1;break}}return n}checkForFormValidationBooking(t=!1){var e,n,i,o;this.monitorService.logEvent("checkForFormValidationBooking",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]);const r=["notes","repairtypes"],a=Object.keys(this.personalInfoData);let s=!0;for(const l in a){const t=a[l];if(!("customerdata"==t.toLowerCase()||"vehicledata"==t.toLowerCase()||"assignedto"==t.toLowerCase()||"joballocation"==t.toLowerCase()&&!this.personalInfoData[t]||"communicationchannel"==t.toLowerCase()&&0===(null===(e=this.formModel.communicationChannel.options)||void 0===e?void 0:e.length))){if("joballocation"==t.toLowerCase()&&!(null===(n=this.employeeRepairServiceType)||void 0===n?void 0:n.some(t=>{var e;return(null===(e=t.employees)||void 0===e?void 0:e.length)>0}))){s=!1;break}if(Array.isArray(this.personalInfoData[t])&&0==this.personalInfoData[t].length){s=!1;break}if("repairtypes"==t.toLowerCase()&&"repair"==(null===(o=null===(i=this.formModel.serviceType.selectedOption)||void 0===i?void 0:i.name)||void 0===o?void 0:o.toLowerCase())&&(!this.personalInfoData[t]||0==this.personalInfoData[t].length)){s=!1;break}if(!this.personalInfoData[t]&&!r.includes(t.toLowerCase())){s=!1;break}}}return s}checkForFormValidationVehicle(){this.monitorService.logEvent("checkForFormValidationVehicle",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]);let t=!0;return this.validVehicleFields.some(t=>0==t.valid)&&(t=!1),t}checkForFormValidation(){return this.isFormConfirmed?(this.bookingButtonModel.type="outline",!1):this.checkForFormValidationCustomer()&&this.checkForFormValidationBooking()&&this.checkForFormValidationVehicle()?(this.canNavigate=!0,this.bookingButtonModel.type="primary",!0):(this.bookingButtonModel.type="disabled",!1)}validateVehicle(){const t=Object.keys(this.vehicleFormData);let e=!0;for(const n in t){const i=t[n];if("inspectionid"!=i.toLowerCase()&&"inspectionguid"!=i.toLowerCase()&&"isvinspecifiedmanualz"!=i.toLowerCase()&&!this.vehicleFormData[i]){e=!1;break}}return e}validateBookingTime(){if(Je(this.personalInfoData.bookingInDate).diff(new Date)>1||this.repairId&&"0"!=this.repairId)return!0;if(Je.utc(new Date).diff(new Date(this.personalInfoData.bookingInDate),"minute")<=30){const t=Je(new Date(this.personalInfoData.bookingOutDate)).diff(new Date(new Date(this.personalInfoData.bookingInDate)),"minute");return this.personalInfoData.bookingInDate=Je(new Date).add(1,"minute").local().utc().format(),this.personalInfoData.bookingOutDate=Je(new Date).add(t,"minute").local().utc().format(),!0}return this.commonService.showToast(0,"bookingin_greater_msg"),!1}submitForm(t,e,n){var i,o,r,a,s,l,c,d;return(0,kt.mG)(this,void 0,void 0,function*(){if(this.monitorService.logEvent("submitForm",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.isFormConfirmed)return this.formModel.customerData.companyOrgType.observable||(this.formModel.customerData.companyOrgType.selectedOption.name="",this.formModel.customerData.companyOrgType.observable=this.caseService.getProviders(),setTimeout(()=>{var t;null===(t=this.orgType)||void 0===t||t.triggerObservable()})),void this.updateButton();if(this.commonService.showLoading(),!this.validateBookingTime())return;const p={vin:this.vehicleFormData.vin,umc:this.umc,vehicleMake:this.vehicleFormData.make,vehicleModel:this.vehicleFormData.model,modelYearRange:(null===(i=this.vinGTMotive)||void 0===i?void 0:i.modelYearRange)||this.vehicleFormData.year,vehicleID:parseInt(this.vehicleId)||0,licensePlateNumber:this.vehicleFormData.licensePlate,vehicleMileage:Number(this.vehicleFormData.carMilege),registrationDate:this.vehicleFormData.registrationDate?Je(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"):null,inspectionID:this.vehicleFormData.inspectionID,inspectionGuid:this.vehicleFormData.inspectionGuid,isVinSpecifiedManualZ:this.vehicleFormData.isVinSpecifiedManualZ},u={companyOrgType:this.customerFormData.companyOrgType,customerTypeID:"Retail"===this.customerFormData.companyOrgType?this.customerFormData.customerTypeID:null,firstName:this.customerFormData.firstName,lastName:this.customerFormData.lastName,countryCode:this.customerFormData.driverCode,mobileNumber:this.customerFormData.driverPhone.toString(),email:this.customerFormData.email,companyId:this.customerFormData.companyId,workProviderId:this.customerFormData.partnershipId,claimNumber:"Insurance Company"===this.customerFormData.companyOrgType?this.customerFormData.claimNumber:"",companyName:this.isRetailAndCompanyProvider?this.customerFormData.companyName:"",companyLicenseNumber:this.isRetailAndCompanyProvider?this.customerFormData.licenseId:"",customerId:(null===(r=null===(o=this.repairResponse)||void 0===o?void 0:o.customer)||void 0===r?void 0:r.customerId)||"",contactId:null===(s=null===(a=this.repairResponse)||void 0===a?void 0:a.customer)||void 0===s?void 0:s.contactId,tariffId:this.customerFormData.tariffId,isTariffEditable:this.customerFormData.isTariffEditable,partnershipId:this.customerFormData.partnershipId};let h=[];if("Repair"===(null===(l=this.formModel.serviceType.selectedOption)||void 0===l?void 0:l.name))if(this.personalInfoData.jobAllocation){h=this.employeeRepairServiceType;const t=null===(d=this.personalInfoData.repairTypes)||void 0===d?void 0:d.filter(t=>!this.employeeRepairServiceType.map(t=>t.repairServiceTypeId).includes(t.id));null==t||t.forEach(t=>{this.employeeRepairServiceType.push({repairServiceTypeId:t.id})})}else null===(c=this.personalInfoData.repairTypes)||void 0===c||c.forEach(t=>{h.push({repairServiceTypeId:t.id,repairServiceTypeMappingId:0,repairServiceTypeEmployeeMappings:[]})});else h=this.personalInfoData.jobAllocation?this.employeeRepairServiceType:null,this.personalInfoData.repairTypes=null;const g={domainId:3100,isTowingNeeded:"Towed In/Non-Drivable"==this.personalInfoData.towedIn,customer:u,vehicle:p,booking:{typeId:this.personalInfoData.serviceTypeId||null,typeName:this.personalInfoData.serviceType||null,bookingIn:this.personalInfoData.bookingInDate,bookingOut:this.personalInfoData.bookingOutDate,slotTypeID:null,notes:this.personalInfoData.notes,communicationTypeId:this.personalInfoData.communicationChannel},repairServiceTypes:h,statusId:this.statusId||"",isJobAssignationRequired:this.personalInfoData.jobAllocation||!1};if(this.caseId&&(g.quoteGuid=this.caseId,this.vehicleId&&(p.vehicleID=parseInt(this.vehicleId))),!this.caseId&&(this.validateVehicle()&&(!this.vehicleId||"0"==this.vehicleId)||this.validateVehicle()&&this.vehicleFormData.vin!==this.originalVin&&this.vehicleId))try{yield this.addVehicle(),g.vehicle.inspectionID=this.vehicleFormData.inspectionID,g.vehicle.inspectionGuid=this.vehicleFormData.inspectionGuid,g.vehicle.vehicleID=this.vehicleId}catch(m){return}this.repairId?this.updateBooking(g,t):this.bookingService.addRepairBookings(g).subscribe({next:i=>(0,kt.mG)(this,void 0,void 0,function*(){var o,r,a,s,l,c,d,p,u;if(i){if(console.log(i),this.repairId=null===(o=i.data)||void 0===o?void 0:o.repairGuid,this.status=null===(r=i.data)||void 0===r?void 0:r.status,this.statusId=null===(a=i.data)||void 0===a?void 0:a.statusId,g.repairDateCreated=null===(s=i.data)||void 0===s?void 0:s.createdDate,this.objectId=null===(l=i.data)||void 0===l?void 0:l.id,this.repairId=null===(c=i.data)||void 0===c?void 0:c.repairGuid,this.commonService.repairGuid.next(null===(d=i.data)||void 0===d?void 0:d.repairGuid),this.vehicleId&&"0"!=this.vehicleId&&!this.caseId){let t=!1;if(yield this.updateVehicle(g).then(e=>{e&&this.showLabourUpdateMessage()&&(t=!0)}),t)return}if(this.commonService.hideLoading(),e)n&&n();else if(t&&"string"==typeof t){if((t.includes("/photos")||t.includes("/estimate"))&&(!this.vehicleId||"0"==this.vehicleId))return void this.commonService.openAlertDialog("Notification","msg_add_vehicle").afterClosed().subscribe({next:t=>{}});-1!=t.indexOf("?mode=edit")?(t=t.replace("?mode=edit",""),this.router.navigate([t.replace("{bookingId}",null===(p=i.data)||void 0===p?void 0:p.repairGuid)],{queryParams:{mode:"edit"}})):this.router.navigate([t.replace("{bookingId}",null===(u=i.data)||void 0===u?void 0:u.repairGuid)])}else this.router.navigate(["/repair/booking-journal"],{queryParams:{bookInDate:this.personalInfoData.bookingInDate}})}}),error:t=>{this.commonService.hideLoading()}})})}expandCollapseAssignedTo(t){t.active=!t.active}unAssignEmployee(t,e){const n=this.translateService.instant("unassign"),i=this.translateService.instant("unassign_employee_msg");this.commonService.openDeleteDialog(n,i).afterClosed().subscribe(n=>{var i,o,r,a;if(n){const n=this.employeeRepairServiceType.filter(t=>t.repairServiceTypeId==e.repairId);if(n.length){const s=t.assigneeId||t.employeeId;n[0].employees=null===(i=n[0].employees)||void 0===i?void 0:i.filter(t=>t!=s);let l=null===(o=e.employeesAssigned)||void 0===o?void 0:o.filter(t=>(t.assigneeId||t.employeeId)==s)[0];l=Object.assign(Object.assign({},l),{isAvailable:!0}),null===(r=e.employees)||void 0===r||r.push(l),e.employeesAssigned=null===(a=e.employeesAssigned)||void 0===a?void 0:a.filter(t=>(t.assigneeId||t.employeeId)!=s)}this.checkForFormValidation()}})}showLabourUpdateMessage(){var t;if(this.monitorService.logEvent("showLabourUpdateMessage",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),null===(t=this.labourData)||void 0===t?void 0:t.isEditable){let t=!0;if(this.labourData.tariffLabourRates.forEach(e=>{e.amount>0&&(t=!1)}),t){const t={objectId:this.repairId,link:"here",labourData:this.labourData,from:Vt.j.repair};return this.commonService.hideLoading(),this.commonService.showInfoToast(5e5,this.translateService.instant("labour_value_update"),t),!0}return!1}return!1}updateVehicle(t){var e,n,i,o,r,a,s,l;return(0,kt.mG)(this,void 0,void 0,function*(){this.monitorService.logEvent("updateVehicle",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.commonService.showLoading();const c={vin:this.vehicleFormData.vin,umc:this.umc,vehicleMake:this.vehicleFormData.make,vehicleModel:this.vehicleFormData.model,modelYearRange:(null===(e=this.vinGTMotive)||void 0===e?void 0:e.modelYearRange)||this.vehicleFormData.year,vehicleID:null===(n=t.vehicle)||void 0===n?void 0:n.vehicleID,licensePlateNumber:this.vehicleFormData.licensePlate,vehicleMileage:Number(this.vehicleFormData.carMilege),registrationDate:Je(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00")},d={inspectionID:(null===(i=t.vehicle)||void 0===i?void 0:i.inspectionID)||(null===(o=this.inspections)||void 0===o?void 0:o.inspectionId),inspectionGuid:(null===(r=t.vehicle)||void 0===r?void 0:r.inspectionGuid)||(null===(a=this.inspections)||void 0===a?void 0:a.inspectionGuid)};return this.caseId||(this.originalTariffObject.make!=this.vehicleFormData.make||this.customerFormData.partnershipId!=this.originalTariffObject.partnershipId||Je(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00")!=this.originalTariffObject.registrationDate||!(null===(l=null===(s=this.labourData)||void 0===s?void 0:s.tariffLabourRates)||void 0===l?void 0:l.length))&&(yield this.getLabourData(this.customerFormData.tariffId,this.customerFormData.isTariffEditable,this.customerFormData.partnershipId,this.vehicleFormData.make,t.repairDateCreated)),(0,At.z)(this.vehicleService.updateVehicleRepair({vehicle:c,inspection:d,tariff:this.labourData},this.repairId))})}getLabourData(t,e,n,i,o){return(0,kt.mG)(this,void 0,void 0,function*(){return this.monitorService.logEvent("getLabourData",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),(0,At.z)(this.labourService.getLabourData(t,i,Je(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"),o)).then(t=>{t.data&&(this.labourData={tariffId:t.data.id,tariffDiscountRates:t.data.tariffDiscountRates,tariffLabourRates:t.data.tariffLaborRates,isEditable:e,partnershipId:n})})})}updateBooking(t,e){this.monitorService.logEvent("updateBooking",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),t.repairGuid=this.repairId,this.bookingService.updateRepairBooking(t,this.repairId).subscribe({next:n=>(0,kt.mG)(this,void 0,void 0,function*(){var i,o,r,a;if(n){if(this.repairId=null===(i=n.data)||void 0===i?void 0:i.repairGuid,t.repairDateCreated=null===(o=n.data)||void 0===o?void 0:o.createdDate,this.vehicleId&&"0"!=this.vehicleId&&!this.caseId){let e=!1;if(yield this.updateVehicle(t).then(t=>{t&&this.showLabourUpdateMessage()&&(e=!0)}),e)return}if(this.commonService.hideLoading(),e&&"string"==typeof e){if((e.includes("/photos")||e.includes("/estimate"))&&(!this.vehicleId||"0"==this.vehicleId))return void this.commonService.openAlertDialog("Notification","msg_add_vehicle").afterClosed().subscribe({next:t=>{}});-1!=e.indexOf("?mode=edit")?(e=e.replace("?mode=edit",""),this.router.navigate([e.replace("{bookingId}",null===(r=n.data)||void 0===r?void 0:r.repairGuid)],{queryParams:{mode:"edit"}})):this.router.navigate([e.replace("{bookingId}",null===(a=n.data)||void 0===a?void 0:a.repairGuid)])}else this.router.navigate(["/repair/booking-journal"],{queryParams:{bookInDate:this.personalInfoData.bookingInDate}})}}),error:t=>{this.commonService.hideLoading()}})}onFormUpdateVehicle(t){if(this.monitorService.logEvent("onFormUpdateVehicle",["PersonalInfoComponent","addenda-quote",{repairId:this.repairId,output:t}]),"select"===t.type)this.formModel.vehicleData[t.name]=Object.assign(Object.assign({},this.formModel.vehicleData[t.name]),{selectedOption:t.value}),this.vehicleFormData[t.name]=t.value[this.formModel.vehicleData[t.name].fieldValue],"make"==t.name?(this.vehicleFormData.model=null,this.vehicleFormData.year=null,this.modelDisabled=!0,this.yearDisabled=!0,this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{},options:[],observable:null}),this.formModel.vehicleData.year.options=[],this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{},options:[],observable:null}),t.value&&(this.vehicleFormData.isVinSpecifiedManualZ=!1,this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{observable:this.vehicleService.getVehicleModel(t.value.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)}),setTimeout(()=>{var t;null===(t=this.model)||void 0===t||t.triggerObservable()}))):"model"==t.name&&(this.yearDisabled=!0,this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{},observable:null,options:[]}),this.vehicleFormData.year=null,t.value&&(this.umc=t.value.umc,this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{observable:this.vehicleService.getVehicleYearByModel(t.value.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)}),setTimeout(()=>{var t;null===(t=this.year)||void 0===t||t.triggerObservable()})));else{t.isValid?(this.formModel.vehicleData[t.name].value=t.value,this.vehicleFormData[t.name]=t.value):(this.formModel.vehicleData[t.name].value="",this.vehicleFormData[t.name]="");const e=this.validVehicleFields.find(e=>e.field==t.name);null!=e?e.valid=t.isValid:this.validVehicleFields.push({valid:t.isValid,field:t.name})}this.vehicleFormData=Object.assign({},this.vehicleFormData),"vin"==t.name&&t.isValid&&this.populateForm(),this.checkForFormValidation()}hideDropdown(t){var e,n,i,o,r,a,s,l,c,d,p,u,h,g,m,v,f,b,_,M,O,y,C,x,P,w,T,D,S,I,k,Z,A,q,L,E,R,j,F,N,U,J,Y,B,z,H,G,Q,V,$,W,K,X,tt,et,nt;t===this.formModel.customerData.companyOrgType.name?(null===(e=this.driverCode)||void 0===e||e.closeDropdown(),null===(n=this.companyOrg)||void 0===n||n.closeDropdown(),null===(i=this.model)||void 0===i||i.closeDropdown(),null===(o=this.year)||void 0===o||o.closeDropdown(),null===(r=this.make)||void 0===r||r.closeDropdown(),null===(a=this.repairType)||void 0===a||a.closeDropdown(),null===(s=this.serviceType)||void 0===s||s.closeDropdown()):t===this.formModel.customerData.companyName.name?(null===(l=this.driverCode)||void 0===l||l.closeDropdown(),null===(c=this.orgType)||void 0===c||c.closeDropdown(),null===(d=this.model)||void 0===d||d.closeDropdown(),null===(p=this.year)||void 0===p||p.closeDropdown(),null===(u=this.make)||void 0===u||u.closeDropdown(),null===(h=this.repairType)||void 0===h||h.closeDropdown(),null===(g=this.serviceType)||void 0===g||g.closeDropdown()):t===this.formModel.customerData.driverCode.name?(null===(m=this.orgType)||void 0===m||m.closeDropdown(),null===(v=this.companyOrg)||void 0===v||v.closeDropdown(),null===(f=this.model)||void 0===f||f.closeDropdown(),null===(b=this.year)||void 0===b||b.closeDropdown(),null===(_=this.make)||void 0===_||_.closeDropdown(),null===(M=this.repairType)||void 0===M||M.closeDropdown(),null===(O=this.serviceType)||void 0===O||O.closeDropdown()):t===this.formModel.vehicleData.make.name?(null===(y=this.model)||void 0===y||y.closeDropdown(),null===(C=this.year)||void 0===C||C.closeDropdown(),null===(x=this.driverCode)||void 0===x||x.closeDropdown(),null===(P=this.orgType)||void 0===P||P.closeDropdown(),null===(w=this.companyOrg)||void 0===w||w.closeDropdown(),null===(T=this.repairType)||void 0===T||T.closeDropdown(),null===(D=this.serviceType)||void 0===D||D.closeDropdown()):t===this.formModel.vehicleData.model.name?(null===(S=this.make)||void 0===S||S.closeDropdown(),null===(I=this.year)||void 0===I||I.closeDropdown(),null===(k=this.driverCode)||void 0===k||k.closeDropdown(),null===(Z=this.orgType)||void 0===Z||Z.closeDropdown(),null===(A=this.companyOrg)||void 0===A||A.closeDropdown(),null===(q=this.repairType)||void 0===q||q.closeDropdown(),null===(L=this.serviceType)||void 0===L||L.closeDropdown()):t===this.formModel.vehicleData.year.name?(null===(E=this.model)||void 0===E||E.closeDropdown(),null===(R=this.make)||void 0===R||R.closeDropdown(),null===(j=this.driverCode)||void 0===j||j.closeDropdown(),null===(F=this.orgType)||void 0===F||F.closeDropdown(),null===(N=this.companyOrg)||void 0===N||N.closeDropdown(),null===(U=this.repairType)||void 0===U||U.closeDropdown(),null===(J=this.serviceType)||void 0===J||J.closeDropdown()):t===this.formModel.repairTypes.name?(null===(Y=this.model)||void 0===Y||Y.closeDropdown(),null===(B=this.make)||void 0===B||B.closeDropdown(),null===(z=this.driverCode)||void 0===z||z.closeDropdown(),null===(H=this.orgType)||void 0===H||H.closeDropdown(),null===(G=this.companyOrg)||void 0===G||G.closeDropdown(),null===(Q=this.year)||void 0===Q||Q.closeDropdown(),null===(V=this.serviceType)||void 0===V||V.closeDropdown()):t===this.formModel.serviceType.name&&(null===($=this.model)||void 0===$||$.closeDropdown(),null===(W=this.make)||void 0===W||W.closeDropdown(),null===(K=this.driverCode)||void 0===K||K.closeDropdown(),null===(X=this.orgType)||void 0===X||X.closeDropdown(),null===(tt=this.companyOrg)||void 0===tt||tt.closeDropdown(),null===(et=this.year)||void 0===et||et.closeDropdown(),null===(nt=this.repairType)||void 0===nt||nt.closeDropdown())}updateCaseData(t){var e;if(t&&this.customerFormData.companyId&&!this.customerFormData.tariffId){const n=t.filter(t=>t.companyId===this.customerFormData.companyId);n.length>0&&(this.customerFormData.tariffId=n[0].tariffId,this.customerFormData.isTariffEditable=n[0].isEditable,this.formModel.customerData.licenseId=Object.assign(Object.assign({},null===(e=this.formModel)||void 0===e?void 0:e.customerData.licenseId),{value:n[0].licenseId.toString()}),this.customerFormData.partnershipId=n[0].partnershipId,this.formModel.customerData.companyName.selectedOption=n[0])}}getProvider(){this.formModel.customerData.companyOrgType.observable||(this.repairId&&"0"!=this.repairId&&(this.formModel.customerData.companyOrgType.selectedOption.name=""),this.formModel.customerData.companyOrgType.observable=this.caseService.getProviders())}drop(t,e){if(t.previousContainer===t.container)V(t.container.data,t.previousIndex,t.currentIndex);else{10===t.container.data.length&&this.commonService.showToast(0,"max_employee_assigned");const n=t.previousContainer.data[t.previousIndex];if(!n.isAvailable)return;!function(t,e,n,i){const o=$(n,t.length-1),r=$(i,e.length);t.length&&e.splice(r,0,t.splice(o,1)[0])}(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex);const i=this.employeeRepairServiceType.filter(t=>t.repairServiceTypeId==e||null==t.repairServiceTypeId);i.length?i[0].employees.push(n.employeeId||n.assigneeId):this.employeeRepairServiceType.push({employees:[n.employeeId],repairServiceTypeId:e}),this.checkForFormValidation()}}onDoubleClick(t,e){var n,i,o;if(!t.isAvailable)return;10===e.employeesAssigned&&this.commonService.showToast(0,"max_employee_assigned");const r=t.assigneeId||t.employeeId,a=this.employeeRepairServiceType.find(t=>t.repairServiceTypeId==e.repairId);a&&(a.employees=null===(n=a.employees)||void 0===n?void 0:n.filter(t=>t!=r));const s=null===(i=e.employees)||void 0===i?void 0:i.find(t=>(t.assigneeId||t.employeeId)==r);s&&(e.employeesAssigned.push(s),e.employees=null===(o=e.employees)||void 0===o?void 0:o.filter(t=>(t.assigneeId||t.employeeId)!=r),a?a.employees.push(s.employeeId||s.assigneeId):this.employeeRepairServiceType.push({employees:[s.employeeId],repairServiceTypeId:e.repairId})),this.checkForFormValidation()}populateForm(){var t;this.monitorService.logEvent("populateForm",["PersonalInfoComponent","addenda-quote",{repairId:this.repairId}]);const e=null===(t=this.formModel.vehicleData.vin.value)||void 0===t?void 0:t.toLocaleString();(0,yn.D)(e).pipe().subscribe({complete:()=>{17==e.length&&!this.isFormConfirmed&&!this.preventVinCall&&(this.commonService.showLoading(),this.vehicleService.getVinDecoder(e).subscribe({error:()=>{this.commonService.hideLoading(),this.vinGTMotive=null,this.resetVehicleDropdown()},next:t=>{var e;if(null==t?void 0:t.success){this.vinGTMotive=t.data,this.umc=null===(e=this.vinGTMotive)||void 0===e?void 0:e.umc,this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:t.data.vehicleMake}}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:t.data.vehicleModel}});const n=this.formModel.vehicleData.make.options.filter(e=>e.name===t.data.vehicleMake);n.length>0&&(this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{observable:this.vehicleService.getVehicleModel(n[0].id,this.estimateId)}),setTimeout(()=>{this.model.triggerObservable()})),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{name:t.data.modelYearRange}}),this.vehicleFormData.make=t.data.vehicleMake,this.vehicleFormData.model=t.data.vehicleModel,this.vehicleFormData.year=t.data.modelYearRange,this.inputDisabled=!1,this.infoDisabled=!1,this.makeDisabled=!0,this.enableDropdowns()}else this.vinGTMotive=null,this.vinFromOCR==this.vehicleFormData.vin?this.checkMakeModelExistFromOCR():(this.commonService.showInfoToast(5e3,"show-info | "+(null==t?void 0:t.message)),this.resetVehicleDropdown());this.make&&(this.make.dropdownValidationMessage="",this.make.dropdownContainer.dropdownConfig.isTouched=!1,this.make.dropdownContainer.dropdownConfig.isDirty=!1),this.model&&(this.model.dropdownValidationMessage="",this.model.dropdownContainer.dropdownConfig.isTouched=!1,this.model.dropdownContainer.dropdownConfig.isDirty=!1),this.year&&(this.year.dropdownValidationMessage="",this.year.dropdownContainer.dropdownConfig.isTouched=!1,this.year.dropdownContainer.dropdownConfig.isDirty=!1)},complete:()=>{this.commonService.hideLoading()}})),this.preventVinCall&&17==e.length&&(this.preventVinCall=!1)}})}resetVehicleDropdown(t=!0){t&&(this.inputDisabled=!1,this.infoDisabled=!1,this.makeDisabled=!1),this.vehicleFormData.make="",this.vehicleFormData.model="",this.vehicleFormData.year=null,this.formModel.vehicleData.model.options=[],this.formModel.vehicleData.year.options=[],this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{}}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{}}),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{}})}enableDropdowns(){this.modelDisabled=!1,this.yearDisabled=!1}closeForm(){this.router.navigate(["/repair/booking-journal"])}cancelBooking(){this.repairId?this.commonService.openDeleteDialog().afterClosed().subscribe(t=>{t&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.closeForm()}}))}):this.closeForm()}ngOnDestroy(){this.commonService.actionTriggered.unsubscribe(),this.commonService.accessRight.unsubscribe(),this.commonService.viewActionTriggeredBooking.unsubscribe(),this.commonService.labourData.unsubscribe(),this.subscriptions&&this.subscriptions.forEach(t=>t.unsubscribe()),this.monitorService.logEvent("ngOnDestroy",["PersonalInfoComponent","addenda-repair"])}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Ot.F0),i.Y36(te.v),i.Y36(Et.M),i.Y36(wn.n),i.Y36(ke.p),i.Y36(Tn.f),i.Y36(Ot.gz),i.Y36($t.q),i.Y36(jt.qu),i.Y36(Dn.a),i.Y36(Sn.m),i.Y36(In.g),i.Y36(kn.T),i.Y36(yt.sK),i.Y36(ze.o))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-personal-info"]],viewQuery:function(t,e){if(1&t&&(i.Gf(An,5),i.Gf(qn,5),i.Gf(Ln,5),i.Gf(En,5),i.Gf(Rn,5),i.Gf(jn,5),i.Gf(Fn,5),i.Gf(Nn,5),i.Gf(Un,5),i.Gf(Jn,5),i.Gf(Yn,5),i.Gf(Bn,5),i.Gf(zn,5),i.Gf(Hn,5),i.Gf(Gn,5),i.Gf(Qn,5)),2&t){let t;i.iGM(t=i.CRH())&&(e.companyOrg=t.first),i.iGM(t=i.CRH())&&(e.licenseId=t.first),i.iGM(t=i.CRH())&&(e.driverPhone=t.first),i.iGM(t=i.CRH())&&(e.driverCode=t.first),i.iGM(t=i.CRH())&&(e.orgType=t.first),i.iGM(t=i.CRH())&&(e.make=t.first),i.iGM(t=i.CRH())&&(e.model=t.first),i.iGM(t=i.CRH())&&(e.year=t.first),i.iGM(t=i.CRH())&&(e.mileage=t.first),i.iGM(t=i.CRH())&&(e.license=t.first),i.iGM(t=i.CRH())&&(e.regDate=t.first),i.iGM(t=i.CRH())&&(e.repairType=t.first),i.iGM(t=i.CRH())&&(e.bookingOut=t.first),i.iGM(t=i.CRH())&&(e.serviceType=t.first),i.iGM(t=i.CRH())&&(e.communicationChannelControl=t.first),i.iGM(t=i.CRH())&&(e.chqUpload=t.first)}},decls:4,vars:7,consts:[[1,"main-wrapper"],["class","page-container-personal-info",3,"ngClass",4,"ngIf"],[3,"currentStep","currentPageName","isCurrentAdditionalModeMultiple","ngClass","imageOutput"],["chqUpload",""],[1,"page-container-personal-info",3,"ngClass"],[1,"title",3,"ngClass"],[1,"sub-title",3,"ngClass"],[1,"required"],[1,"info-wrapper"],[1,"info"],[1,"form-container","gap-32"],[1,"control-container","fx-col","gap-15"],[1,"work-provider-container","fx-col","gap-32"],[1,"row"],[1,"col-12"],[1,"col-6",3,"inputModel","clicked","controlOutput"],["orgType",""],["class","col-6",3,"inputModel","controlOutput",4,"ngIf"],["class","row",3,"ngClass",4,"ngIf"],["class","row",4,"ngIf"],[1,"button-container","wrapper",3,"ngClass"],[1,"pdf-button"],[3,"buttonModel"],[1,"driver-container"],[1,"driver-details","col-12","gap-32"],[1,"driver-input-wrapper","row"],[1,"driver-fields-wrapper"],[1,"driver-field",3,"inputModel","controlOutput"],[1,"driver-address-wrapper","row"],["class","driver-field basis-272 email",3,"inputModel","controlOutput",4,"ngIf"],["class","driver-field basis-272 email",4,"ngIf"],[1,"driver-field","basis-272"],[1,"driver-field","driver-code-field","no-padding",3,"inputModel","clicked","controlOutput"],["driverCode",""],["class","driver-field no-padding",3,"inputModel","controlOutput",4,"ngIf"],["class","driver-field-content",4,"ngIf"],[1,"fx-col","gap-32"],[1,"info-title",3,"ngClass"],[1,"vehicle-container","fx-col","gap-32"],[1,"row","vin-wrapper",3,"ngClass"],[1,"col-6",3,"inputModel","controlOutput"],[1,"col-6","button-registration",3,"ngClass"],[1,"vehicle-brand-wrapper","row",3,"ngClass"],["id","input-make",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["make",""],["id","input-model",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["model",""],[1,"vehicle-info1-wrapper","row",3,"ngClass"],["id","input-year",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["year",""],["license",""],[1,"vehicle-info-wrapper","row",3,"ngClass"],[1,"col-6","extra-position",3,"inputModel","controlOutput"],["mileage",""],[1,"col-6","registration-date",3,"inputModel","controlOutput"],["regDate",""],[1,"wrapper","fx-col","gap-32"],[1,"info-title"],[1,"booking-container","fx-col","gap-32"],[1,"col-6",3,"ngClass","inputModel","clicked","controlOutput"],["serviceType",""],["class","col-4 col-text-mode",4,"ngIf"],[1,"col-6","repair-type",3,"inputModel","ngClass","clicked","controlOutput"],["repairType",""],[3,"inputModel","ngClass","controlOutput"],["bookingout",""],[1,"wrapper","assigned-to-container","fx-col",3,"ngClass"],[1,"job-allocation-container"],[1,"job-allocation",3,"inputModel","ngStyle","controlOutput"],[4,"ngIf"],[1,"other-container","wrapper","fx-col","gap-32"],[1,"towing-container"],[1,"towing-layout",3,"ngClass"],[3,"inputModel","controlOutput"],["class","towing-layout",4,"ngIf"],[1,"notes-container"],["class","wrapper fx-col gap-32",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[1,"row",3,"ngClass"],[1,"insurance-input-wrapper","row"],[1,"company-input","col-3",3,"inputModel","controlOutput"],[1,"company-input","col-6",3,"inputModel","clicked","controlOutput"],["companyOrg",""],[1,"col-6",3,"ngClass","inputModel","controlOutput"],["licenseId",""],[1,"driver-field","basis-272","email",3,"inputModel","controlOutput"],[1,"driver-field","basis-272","email"],[1,"driver-field-content"],[1,"label-text"],[1,"driver-content-value"],[1,"driver-field","no-padding",3,"inputModel","controlOutput"],["driverPhone",""],[1,"col-4","col-text-mode"],["class","repair-type-container-wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"repair-type-container-wrapper",3,"ngClass"],["class","repair-type-container",3,"click",4,"ngIf"],[1,"col-6"],[1,"text-secondary"],[1,"employee-list-wrapper"],["cdkDropList","","cdkDropListSortingDisabled","",1,"employee-list",3,"cdkDropListConnectedTo","cdkDropListData"],["class","employee","cdkDrag","",3,"cdkDragDisabled","dblclick",4,"ngFor","ngForOf"],[1,"employee-list-wrapper","dropped"],["cdkDropList","",1,"employee-list",3,"cdkDropListData","cdkDropListDropped"],["doneList","cdkDropList"],["class","employee assigned",4,"ngFor","ngForOf"],[1,"repair-type-container",3,"click"],[3,"svgIcon"],["cdkDrag","",1,"employee",3,"cdkDragDisabled","dblclick"],["src","assets/img/tick_icon.png",4,"ngIf"],["src","assets/img/cross_icon.png",4,"ngIf"],["src","assets/img/tick_icon.png"],["src","assets/img/cross_icon.png"],[1,"employee","assigned"],["color","red",3,"svgIcon","click"],[1,"towing-layout"],[1,"communication-container"],[1,"",3,"inputModel","ngStyle","controlOutput"],["communicationChannel",""],["class","footer-button-wrapper",4,"chqPermission"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.YNc(1,Ai,112,109,"div",1),i.qZA(),i.TgZ(2,"chq-upload",2,3),i.NdJ("imageOutput",function(t){return e.handleImageOutput(t)}),i.qZA()),2&t&&(i.xp6(1),i.Q6J("ngIf",!e.isApiLoading),i.xp6(1),i.Q6J("currentStep",e.currentStep)("currentPageName","personal-info")("isCurrentAdditionalModeMultiple",!1)("ngClass",i.VKq(5,qi,null==e.currentStep?null:e.currentStep.uploadInProgress)))},directives:[o.O5,Zn.q,o.mk,Nt.D,Ut.E,o.PC,o.sg,ut,Mt.Hw,vt,Qe.A],pipes:[yt.X$,o.gd],styles:[".page-container-personal-info[_ngcontent-%COMP%]{box-sizing:border-box;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px}.page-container-personal-info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{line-height:25px;font-weight:700}.page-container-personal-info[_ngcontent-%COMP%]   .title.text-mode[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray)}.page-container-personal-info[_ngcontent-%COMP%]   .sub-title[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-weight:700;margin-top:20px;color:var(--xa-red)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]{margin-top:calc(5px + 1.5vw)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{font-weight:700;font-size:16px;line-height:20px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .info-title.text-mode[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;flex:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;grid-gap:5px;gap:5px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:10px;line-height:14px;align-self:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{align-self:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:30px;padding-right:34px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;font-size:12px;grid-gap:10px;gap:10px;color:var(--xa-primary)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{display:flex;align-items:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child   mat-icon[_ngcontent-%COMP%]{width:12px;height:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]{flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .car-owner-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]{flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .insurance-input-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]{flex:4;display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-input-wrapper[_ngcontent-%COMP%], .page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-address-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{flex:1 1 120px;padding:0 10px;width:120px}@media (max-width: 850px){.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{padding:0 6px}}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.no-padding[_ngcontent-%COMP%]{padding:0}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.driver-code-field[_ngcontent-%COMP%]{min-width:120px;max-width:120px;padding:0 20px 0 0}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.basis-272[_ngcontent-%COMP%]{flex-basis:272px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .extra-position[_ngcontent-%COMP%]{position:relative;top:1px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .button-registration[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;position:relative;top:18px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .registration-date[_ngcontent-%COMP%]     .input-wrapper input{pointer-events:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .registration-date[_ngcontent-%COMP%]     .input-wrapper input[readonly]{opacity:.6}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]{margin-right:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{opacity:.3}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-button.no-opacity[_ngcontent-%COMP%]{opacity:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   .towing-button-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:5px;gap:5px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   .towing-button-layout[_ngcontent-%COMP%]   .button-top-text[_ngcontent-%COMP%]{font-size:10px;text-align:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:16px;gap:16px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-overflow:ellipsis!important;white-space:nowrap;overflow:hidden!important}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(1){font-size:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(2){color:#000}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .job-allocation-container[_ngcontent-%COMP%]{margin-top:32px;margin-bottom:32px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .job-allocation-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .job-allocation[_ngcontent-%COMP%]     .input-wrapper .checkbox-wrapper .checkbox .span-label{font-size:12px;line-height:14px;color:var(--xa-black)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]{padding:14px 10px;grid-gap:32px;gap:32px;border-width:.4px 0px;border-style:solid;border-color:#000}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper.no-border-top[_ngcontent-%COMP%]{border-top:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper.disable-container[_ngcontent-%COMP%]{pointer-events:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .repair-type-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;font-size:14px;line-height:18px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .repair-type-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:14px;width:14px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row.collapse[_ngcontent-%COMP%]{display:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .text-secondary[_ngcontent-%COMP%]{font-size:8px;color:var(--xa-dark-gray);line-height:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]{margin-top:10px;border:1px solid gray;padding:22px 12px;height:100px;overflow-y:scroll;background:rgba(236,236,236,.6);border:1px solid rgba(26,34,51,.2);border-radius:8px;cursor:-webkit-grab;cursor:grab}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper.no-outline[_ngcontent-%COMP%]{border:none;background:transparent}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper.dropped[_ngcontent-%COMP%]{cursor:auto}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;grid-gap:3px;gap:3px;padding:0;flex-wrap:wrap;height:inherit}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]{flex-basis:calc(33.33% - 10px);box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:10px 8px;width:auto;height:38px;background:var(--xa-white);border:1px solid rgba(26,34,51,.1);border-radius:14px;grid-gap:10px;gap:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee.assigned[_ngcontent-%COMP%]{justify-content:space-between}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee.transparent[_ngcontent-%COMP%]{background:transparent;justify-content:space-between;padding:10px 8px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:14px;width:14px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;line-height:14px;display:flex;align-items:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;min-width:75px;max-width:150px;display:inline-block}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]:nth-of-type(3n){flex-grow:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .communication-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]{display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .communication-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .communication-text[_ngcontent-%COMP%]{font-size:12px;line-height:14px;padding:5px}  .disable-controls input{opacity:.6}.disable-input[_ngcontent-%COMP%], .partial-disable-info[_ngcontent-%COMP%]{pointer-events:none}.hide[_ngcontent-%COMP%]{display:none!important}.cdk-drag-preview[_ngcontent-%COMP%]{padding:10px 8px;grid-gap:10px!important;gap:10px!important;width:auto;height:38px;font-size:12px;background:var(--xa-white);border:1px solid rgba(26,34,51,.1);border-radius:14px;cursor:-webkit-grab;cursor:grab;display:flex;flex-direction:row;align-items:center}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0;grid-gap:10px!important;gap:10px!important}.cdk-drag-disabled[_ngcontent-%COMP%]{cursor:not-allowed}.main-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-tab-background);margin:calc(5px + 1.5vw)}.page-wrapper[_ngcontent-%COMP%]{background:rgba(255,255,255,.7)}.text-mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .text-mode[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray);padding-left:0!important}.text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{order:2}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;grid-gap:10px;gap:10px;height:34px}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}.text-mode[_ngcontent-%COMP%]     chq-dropdown, .text-mode[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]{opacity:1!important}.gap-15[_ngcontent-%COMP%]{grid-gap:15px;gap:15px}.gap-32[_ngcontent-%COMP%]{grid-gap:32px;gap:32px}"]}),t})();var Ei=n(4704);let Ri=(()=>{class t{constructor(t,e,n){this.commonService=t,this.router=e,this.monitorService=n,this.header={title:"Upload Images",step:0,description:"",stepName:"Back / Bulk Upload",rightActionText:"Delete all and Start Over",rightActionIcon:"delete",isRepairModule:!0,showTitle:!0}}handleUpdateMode(t){"error"===t.mode?this.displayMissingInspectionMessage(t.id):this.header=Object.assign(Object.assign({},this.header),"single"===t.mode?{title:"back_smart_photo"}:{title:"back_bulk_upload"})}displayMissingInspectionMessage(t){this.commonService.openConfirmationOkDialog("Notification","Please add your vehicle in order to add car images.").afterClosed().subscribe({next:e=>{e&&this.router.navigate([`repair/booking/${t}`])},error:()=>{this.commonService.hideLoading()}})}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["Photos component","addenda-repair"])}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(te.v),i.Y36(Ot.F0),i.Y36(Et.M))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-add-photos"]],decls:1,vars:1,consts:[[3,"photosHeader","currentUploadMode"]],template:function(t,e){1&t&&(i.TgZ(0,"new-photos",0),i.NdJ("currentUploadMode",function(t){return e.handleUpdateMode(t)}),i.qZA()),2&t&&i.Q6J("photosHeader",e.header)},directives:[Ei.X],styles:[""]}),t})();var ji=n(64307);let Fi=(()=>{class t{constructor(t,e){this.commonService=t,this.monitorService=e,this.header={title:"Upload Document",step:0,description:"",stepName:"",isRepairModule:!0,isHeaderOnly:!0}}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["Document Component","addenda-repair"])}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(te.v),i.Y36(Et.M))},t.\u0275cmp=i.Xpm({type:t,selectors:[["repair-new-documents"]],decls:1,vars:1,consts:[[3,"documentHeader"]],template:function(t,e){1&t&&i._UZ(0,"new-documents",0),2&t&&i.Q6J("documentHeader",e.header)},directives:[ji.O],styles:[""]}),t})();const Ni={value:[{Id:656,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Gargash Enterprise",VehicleMake:"BMW",VehicleModel:"3 series",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:657,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Honda",VehicleModel:"Accord",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:658,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:659,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:660,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:661,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:662,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:663,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:664,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:665,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:666,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Gargash Enterprise",VehicleMake:"BMW",VehicleModel:"3 series",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:667,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Honda",VehicleModel:"Accord",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:668,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:669,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:670,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:671,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:672,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:673,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:674,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:675,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null}]},Ui={value:[{title:"TOTAL JOBS",percentage:0,amount:150},{title:"TOTAL LABOUR (36%)",percentage:0,amount:350526},{title:"PANEL LABOUR(23%)",percentage:0,amount:350526},{title:"PAINT LABOUR (14%)",percentage:0,amount:350526},{title:"PARTS",percentage:0,amount:350526},{title:"MISC",percentage:0,amount:350526},{title:"SUBLET",percentage:0,amount:350526},{title:"TOTAL",percentage:0,amount:350526}]};let Ji=(()=>{class t{constructor(t){this.http=t}getInvoices(t,e=null){return(0,On.of)(Ni)}invoicePerDetail(t){return this.http.get(`${Wt.N.caseMgmtUrl}/api/invoice/${t}`)}saveInvoicePerDetail(t){return this.http.post(`${Wt.N.caseMgmtUrl}/api/invoice/detail`,t)}invoicePDF(t,e,n){return this.http.post(`${Wt.N.caseMgmtUrl}/api/invoice/${t}/${e}/report`,n)}invoicePerDetailProvider(t,e){return this.http.get(`${Wt.N.caseMgmtUrl}/api/invoice/${t}/detail/${e}`)}assignInvoice(t){return this.http.post(`${Wt.N.caseMgmtUrl}/api/invoice`,t)}getInvoiceSummary(){return(0,On.of)(Ui)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Kt.eN))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Yi={columns:[{id:"Id",width:"0px",style:"display: none",header:{text:"Id",tooltip:"",style:"display: none; max-width: 0"},cellStyle:"display: none; max-width: 0",selector:{field:"paymentId"},widget:{type:"text"}},{id:"Payment",sortable:!1,header:{text:"payment",tooltip:""},selector:{field:"paymentId"},widget:{type:"text"}},{id:"Amount",sortable:!1,selector:{field:"amount"},header:{text:"amount",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center;",widget:{type:"currency"}},{id:"PaymentDate",sortable:!1,selector:{field:"paymentDate"},header:{text:"payment_date",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center;",widget:{type:"dateTime",dateFormat:"dd/MM/YYYY hh:mm a"}},{id:"PaymentMethod",sortable:!1,selector:{field:"paymentType"},header:{text:"payment_method",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center; text-transform: capitalize;",widget:{type:"text"}},{id:"Attachment",sortable:!1,selector:{field:"attachment"},header:{text:"attachment",tooltip:"attachment",style:"text-align: center;"},childColumns:[{id:"AttachmentRefference",selector:{field:"attachment"},widget:{type:"icon",config:{svgIcon:"attachment-refference"}}},{id:"Download",disableColumns:!0,selector:{field:"attachment"},widget:{type:"icon",config:{svgIcon:"download-arrow"}}},{id:"Preview",selector:{field:"attachment"},disableColumns:!0,widget:{type:"icon",config:{svgIcon:"eye"}}}],cellStyle:"justify-content: center;"},{id:"DeleteAction",width:"100px",sortable:!1,selector:{field:"Id"},header:{text:"action",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center",widget:{type:"icon",config:{svgIcon:"delete",style:"fill: var(--xa-dark-red2) !important; width: 15px; height: 15px;"}}},{id:"paymentGuid",width:"0px",style:"display: none",header:{text:"paymentGuid",tooltip:"",style:"display: none; max-width: 0"},cellStyle:"display: none; max-width: 0",selector:{field:"paymentGuid"},widget:{type:"text"}}]};var Bi=n(49457),zi=n(25001);let Hi=(()=>{class t{constructor(t,e){this.http=t,this.fileService=e}getPayments(t){return this.http.get(`${Wt.N.caseMgmtUrl}/api/payment/${t}`)}getPaymentTypes(){return this.http.get(`${Wt.N.caseMgmtUrl}/api/lookup?type=paymentType`)}deletePayment(t,e){return this.http.delete(`${Wt.N.caseMgmtUrl}/api/payment/${e}/delete/${t}`)}addPayment(t){const e=`${Wt.N.caseMgmtUrl}/api/payment`,n=new FormData;return n.append("InvoiceNumber",t.invoiceNumber),n.append("Amount",t.amount),n.append("PaymentDate",t.paymentDate),n.append("PaymentTypeId",t.paymentTypeId),n.append("Description",t.description),t.files&&t.files.length>0&&t.files.forEach(t=>{n.append("attachment",t)}),this.fileService.uploadFile(e,n,!1)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Kt.eN),i.LFG(zi.I))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Gi=["paymentTableWrapper"],Qi=function(t){return{"fully-paid":t}};let Vi=(()=>{class t{constructor(t,e,n,o){this.monitorService=t,this.paymentService=e,this.commonService=n,this.translateService=o,this.handlePaymentDelete=new i.vpe,this.tableConfig=Yi,this.tableData=[],this.pageChanged=!1,this.showData=!1,this.currencySymbol="",this.locale="",this.numberFormat="",this.handleCellClick=(t,e,n)=>{var i,o,r,a,s,l,c,d;if("DeleteAction"===e.id)this.deletePayment(null===(o=null===(i=t[7])||void 0===i?void 0:i.result)||void 0===o?void 0:o.value);else if("Download"===e.id){const e=null===(r=t[5])||void 0===r?void 0:r.result.value.split("/"),n=null===(a=e[(null==e?void 0:e.length)-1])||void 0===a?void 0:a.split("?")[0];this.commonService.showLoading(),this.commonService.getFileBlob(null===(l=null===(s=t[5])||void 0===s?void 0:s.result)||void 0===l?void 0:l.value).subscribe({next:t=>{this.commonService.hideLoading();const e=new Blob([t.res],{type:"application/octet-stream"});(0,Bi.saveAs)(e,n)},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t)}})}else"Preview"===e.id&&window.open(null===(d=null===(c=t[5])||void 0===c?void 0:c.result)||void 0===d?void 0:d.value,"_top")},this.i18n=this.commonService.geti18nInfo(),this.currencySymbol=this.i18n.currencySymbol+" ",this.locale=this.i18n.locale,this.numberFormat=this.i18n.digitsInfo}ngOnInit(){this.monitorService.logEvent("ngOnInit",["PaymentListComponent","addenda-repair"]),this.getPayments(this.invoiceGuid)}get isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}getPayments(t){return(0,kt.mG)(this,void 0,void 0,function*(){return this.commonService.showLoading(),this.commonService.isViewOnly&&(this.tableConfig.columns=this.tableConfig.columns.filter(t=>"DeleteAction"!==t.id)),this.monitorService.logEvent("getPayments",["PaymentListComponent","addenda-repair"]),(0,At.z)(this.paymentService.getPayments(t)).then(t=>{t.data&&(this.formatTableData(t.data),this.showData=!0),this.commonService.hideLoading()}).catch(t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)})})}formatTableData(t){this.tableData=t}deletePayment(t){return(0,kt.mG)(this,void 0,void 0,function*(){this.commonService.openDeleteDialog("",this.translateService.instant("payment_delete_confirmation"),this.translateService.instant("delete"),this.translateService.instant("cancel")).afterClosed().subscribe(e=>{e&&(this.commonService.showLoading(),this.monitorService.logEvent("deleteRow",["PaymentListComponent","addenda-repair"],{paymentId:t}),(0,At.z)(this.paymentService.deletePayment(t,this.invoiceGuid)).then(e=>{var n;this.commonService.hideLoading(),(null==e?void 0:e.message)&&this.commonService.showInfoToast(5e3,e.message);const i=this.tableData.filter(e=>e.paymentGuid===t);this.handlePaymentDelete.emit({Amount:null===(n=i[0])||void 0===n?void 0:n.amount}),this.getPayments(this.invoiceGuid)}).catch(t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}))})})}addPayment(t){const e=[...this.tableData];e.unshift(t),this.formatTableData(e),this.paymentTableWrapper.nativeElement.scrollIntoView({behavior:"smooth"})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Et.M),i.Y36(Hi),i.Y36(te.v),i.Y36(yt.sK))},t.\u0275cmp=i.Xpm({type:t,selectors:[["payment-list"]],viewQuery:function(t,e){if(1&t&&i.Gf(Gi,5),2&t){let t;i.iGM(t=i.CRH())&&(e.paymentTableWrapper=t.first)}},inputs:{invoiceGuid:"invoiceGuid",dueAmount:"dueAmount"},outputs:{handlePaymentDelete:"handlePaymentDelete"},decls:6,vars:8,consts:[[1,"table-container","payment-list",3,"ngClass"],[1,"table-wrapper"],["paymentTableWrapper",""],[3,"config","tableData","cellClicked","pageChanged","i18n"],["paymentTable",""]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.ynx(1),i.TgZ(2,"div",1,2),i._UZ(4,"chq-mat-table",3,4),i.qZA(),i.BQk(),i.qZA()),2&t&&(i.Q6J("ngClass",i.VKq(6,Qi,e.dueAmount<=0)),i.xp6(4),i.Q6J("config",e.tableConfig)("tableData",e.tableData)("cellClicked",e.handleCellClick)("pageChanged",e.pageChanged)("i18n",e.i18n))},directives:[o.mk,_e.B],styles:[".payment-list[_ngcontent-%COMP%]{margin-top:30px}.payment-list.table-container[_ngcontent-%COMP%]:not(.fully-paid){height:calc(80vh - 614px);overflow:scroll;min-height:200px}.payment-list.table-container.fully-paid[_ngcontent-%COMP%]{height:calc(80vh - 237px);overflow:scroll}.payment-list[_ngcontent-%COMP%]     thead{position:sticky;top:0;z-index:1}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div{display:flex}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div mat-icon{margin:0 10px;text-align:center;align-items:center;display:flex;width:auto}@media (max-width: 1200px){.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div mat-icon{margin:0 6px}}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div   [data-mat-icon-name=download-arrow] svg{height:18px}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div   [data-mat-icon-name=eye] path{fill:var(--xa-black)}"]}),t})();function $i(t,e){return n=>{const i={invalidPaymentAmount:""};return n.value<=0?(i.min=t.instant("invalid_amount"),i):n.value>e?(i.invalidPaymentAmount=t.instant("payment_amount_max_length_error").replace("{{maxAmount}}",e.toFixed(2)),i):null}}const Wi=["uploader"];function Ki(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",19),i.TgZ(1,"span"),i._uU(2),i.qZA(),i.TgZ(3,"div"),i.TgZ(4,"span"),i._UZ(5,"mat-icon",20),i.qZA(),i.TgZ(6,"span"),i.TgZ(7,"mat-icon",21),i.NdJ("click",function(){const e=i.CHM(t).index;return i.oxw(2).handleFileRemove(e)}),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit;i.xp6(2),i.Oqu(null==t?null:t.name),i.xp6(3),i.Q6J("svgIcon","attachment-refference"),i.xp6(2),i.Q6J("svgIcon","cross")}}function Xi(t,e){1&t&&(i.TgZ(0,"div",22),i.TgZ(1,"span"),i._uU(2,"-"),i.qZA(),i.qZA())}function to(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-button",23),i.NdJ("click",function(e){return i.CHM(t),i.oxw(2).handleAddFileClick(e)}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("buttonModel",t.attachmentButton)}}function eo(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"form",2),i.TgZ(1,"div",3),i.TgZ(2,"div",4),i.TgZ(3,"chq-input",5),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.TgZ(4,"div",4),i.TgZ(5,"chq-input",5),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(6,"div",3),i.TgZ(7,"div",4),i.TgZ(8,"chq-input",5),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.TgZ(9,"div",6),i.TgZ(10,"chq-input",5),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(11,"div",7),i.TgZ(12,"div",4),i.TgZ(13,"div",8),i.TgZ(14,"label",9),i._uU(15),i.ALo(16,"translate"),i.qZA(),i.YNc(17,Ki,8,3,"div",10),i.YNc(18,Xi,3,0,"div",11),i.qZA(),i.qZA(),i.TgZ(19,"div",4),i.YNc(20,to,1,1,"chq-button",12),i.TgZ(21,"input",13,14),i.NdJ("change",function(e){return i.CHM(t),i.oxw().handleUpload(e)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(23,"div",15),i.TgZ(24,"div",16),i.TgZ(25,"chq-input",5),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdate(e)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(26,"div",3),i.TgZ(27,"div",16),i.TgZ(28,"div",17),i.TgZ(29,"chq-button",18),i.NdJ("click",function(){return i.CHM(t),i.oxw().handleFormSubmit()}),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.xp6(3),i.Q6J("inputModel",t.formModel.amount),i.xp6(2),i.Q6J("inputModel",t.formModel.paymentMethod),i.xp6(3),i.Q6J("inputModel",t.formModel.paymentDate),i.xp6(2),i.Q6J("inputModel",t.formModel.paymentStatus),i.xp6(5),i.Oqu(i.lcZ(16,10,"attachments")),i.xp6(2),i.Q6J("ngForOf",t.file),i.xp6(1),i.Q6J("ngIf",!t.file),i.xp6(2),i.Q6J("ngIf",t.file.length<1),i.xp6(5),i.Q6J("inputModel",t.formModel.description),i.xp6(4),i.Q6J("buttonModel",t.savePaymentButtonModel)}}function no(t,e){if(1&t&&(i.TgZ(0,"div",24),i.TgZ(1,"div",8),i.TgZ(2,"label",25),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div"),i.TgZ(6,"span"),i._uU(7),i.ALo(8,"translate"),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw();i.xp6(3),i.Oqu(i.lcZ(4,2,"payment_status")),i.xp6(4),i.Oqu(i.lcZ(8,4,t.repairPaymentStatus))}}let io=(()=>{class t{constructor(t,e,n,o){this.monitorService=t,this.paymentService=e,this.commonService=n,this.translateService=o,this.handleAddPayment=new i.vpe,this.savePaymentButtonModel={label:"save_payment",type:"outline",icon:"save"},this.attachmentButton={label:"add_attachment",type:"outline",icon:"attachment"},this.formData={paymentTypeId:0,paymentDate:"",amount:0,description:"",paymentStatus:""},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.file=[]}set content(t){t&&(this.uploader=t)}ngOnInit(){var t,e;this.monitorService.logEvent("ngOnInit",["PaymentListComponent","addenda-repair"]),this.formModel=(t=>({amount:{placeHolder:"payment_amount",label:"payment_amount",name:"amount",value:0,type:"number",required:!0,validation:{name:"paymentAmount",validationFunction:()=>jt.kI.compose([jt.kI.min(1)]),validationMessage:e=>e.required?t.instant("payment_amount_required"):e.pattern?t.instant("invalid_number"):e.min?t.instant("greater_than_0"):e.invalidPaymentAmount?e.invalidPaymentAmount:""}},paymentDate:{placeHolder:"payment_date",label:"payment_date",name:"paymentDate",value:new Date,type:"datetime",minDate:new Date,maxDate:new Date},paymentMethod:{placeHolder:"select_payment_method",name:"paymentMethod",label:"payment_method",options:[{}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"paymentMethod",validationFunction:()=>jt.kI.compose([jt.kI.required]),validationMessage:e=>e.required?t.instant("select_payment_method"):""}},paymentStatus:{placeHolder:"payment_status",label:"payment_status",name:"paymentStatus",value:"",type:"text",disabled:!0},description:{placeHolder:"add_description",label:"add_description",name:"description",value:"",type:"textarea",maxLength:100,validation:{name:"addDescription",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(100)]),validationMessage:e=>e.maxlength?t.instant("payment_description_max_length_error"):""}}}))(this.translateService),this.formModel.paymentMethod.observable||(this.formModel.paymentMethod.observable=this.paymentService.getPaymentTypes(),this.formModel.paymentMethod.onObservableLoad=this.onObservableLoadPaymentMethods.bind(this)),this.formModel.paymentStatus=Object.assign(Object.assign({},this.formModel.paymentStatus),{value:this.paymentStatusMapper[null===(t=this.repairPaymentStatus)||void 0===t?void 0:t.toLowerCase()]}),this.formData.paymentStatus=this.repairPaymentStatus,this.formModel.amount=Object.assign(Object.assign({},this.formModel.amount),{value:null===(e=this.dueAmount)||void 0===e?void 0:e.toFixed(2)}),this.formData.amount=this.dueAmount,this.formData.paymentDate=new Date,this.formModel.paymentDate=Object.assign(Object.assign({},this.formModel.paymentDate),{minDate:Je(this.invoiceDate).toDate()})}ngAfterViewInit(){this.dueAmount&&this.formModel.amount.formControl.setValidators(jt.kI.compose([jt.kI.required,jt.kI.pattern(/^\d*\.?\d+$/),$i(this.translateService,this.dueAmount)]))}ngOnChanges(t){var e,n,i,o,r,a;t.dueAmount&&(null===(n=null===(e=this.formModel)||void 0===e?void 0:e.amount)||void 0===n?void 0:n.formControl)&&(this.formModel.amount.formControl.setValidators(jt.kI.compose([jt.kI.required,$i(this.translateService,null===(i=t.dueAmount)||void 0===i?void 0:i.currentValue)])),this.formModel.amount=Object.assign(Object.assign({},this.formModel.amount),{value:null===(o=this.dueAmount)||void 0===o?void 0:o.toFixed(2)}),this.formData.amount=this.dueAmount),t.repairPaymentStatus&&this.formModel&&(this.formModel.paymentStatus=Object.assign(Object.assign({},null===(r=this.formModel)||void 0===r?void 0:r.paymentStatus),{value:this.paymentStatusMapper[null===(a=t.repairPaymentStatus)||void 0===a?void 0:a.currentValue]}))}updateValidation(t,e){var n;this.formModel.amount.formControl.setValidators(jt.kI.compose([jt.kI.required,$i(this.translateService,t)])),this.formModel.amount=Object.assign(Object.assign({},this.formModel.amount),{value:null==t?void 0:t.toFixed(2)}),this.formData.amount=t,this.formModel.paymentStatus=Object.assign(Object.assign({},null===(n=this.formModel)||void 0===n?void 0:n.paymentStatus),{value:this.paymentStatusMapper[null==e?void 0:e.toLowerCase()]})}onFormUpdate(t){"select"===t.type?(this.formModel[t.name]=Object.assign(Object.assign({},this.formModel[t.name]),{selectedOption:t.value}),"paymentMethod"===t.name?this.formData.paymentTypeId=t.value.id:this.formData[t.name]=t.value):(this.formModel[t.name].value=t.value,this.formData[t.name]=t.value),this.checkForFormValidation()}onObservableLoadPaymentMethods(t){this.formModel.paymentMethod=Object.assign(Object.assign({},this.formModel.paymentMethod),{options:t})}checkForFormValidation(){this.savePaymentButtonModel.type=this.isPaymentFormValid()?"primary":"outline"}isPaymentFormValid(){let t=!0;return this.formData.amount&&this.formData.paymentDate&&this.formData.paymentTypeId&&this.formModel.amount.formControl.valid&&this.formModel.paymentDate.formControl.valid||(t=!1),t}checkFileSize(t){return this.monitorService.logEvent("checkFileSize",["PaymentAddComponent","addenda-repair",{fileSize:t.size}]),!(t.size>this.commonService.maxileSize)}isValidImageFile(t){const e=new RegExp("^.*\\.[a-zA-Z]+$","gm");if(this.monitorService.logEvent("isValidImageFile",["PaymentAddComponent","addenda-repair",{fileName:t}]),e.test(t)){const e=t.split(".").pop();return this.commonService.allowFilesExtension.includes(null==e?void 0:e.toLowerCase())}return!1}handleUpload(t){const e=t.target.files||t.srcElement.files;if(this.monitorService.logEvent("handleUpload",["PaymentAddComponent","addenda-quote",{event:t}]),null!==e&&""!==e&&e.length>0){if(!this.checkFileSize(e[0])){const t=this.translateService.instant("file_size_5mb_error_message");return this.commonService.showToast(0,t),void(this.uploader.nativeElement.value=null)}if(!this.isValidImageFile(e[0].name)){const t=this.translateService.instant("upload_type_not_supported");return this.commonService.showToast(0,t),void(this.uploader.nativeElement.value=null)}const t=new FileReader;t.readAsDataURL(e[0]),t.onload=t=>{this.file.push(e[0]),this.checkForFormValidation()}}else this.checkForFormValidation()}handleFileRemove(t){this.commonService.openDeleteDialog("",this.translateService.instant("attachment_delete_confirmation"),this.translateService.instant("delete"),this.translateService.instant("cancel")).afterClosed().subscribe(e=>{e&&(this.monitorService.logEvent("handleFileRemove",["PaymentAddComponent","addenda-repair"]),this.file.splice(t,1))})}handleAddFileClick(t){this.uploader.nativeElement.click()}handleFormSubmit(){if(!this.isPaymentFormValid())return;this.monitorService.logEvent("submitForm",["PaymentAddComponent","addenda-repair"]);const t={amount:this.formData.amount/1,paymentTypeId:this.formData.paymentTypeId,paymentDate:Je.utc(this.formData.paymentDate).format("YYYY-MM-DDTHH:mm:ss.000")+"Z",description:this.formData.description,invoiceNumber:this.invoiceNumber};this.file&&this.file.length>0&&(t.files=this.file),this.commonService.showLoading(),this.paymentService.addPayment(t).subscribe({next:t=>{console.log("result",t),t&&(this.commonService.hideLoading(),this.handleAddPayment.emit({Amount:this.formData.amount}),this.resetForm())},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,Qt._.Error)}})}resetForm(){this.formModel.amount=Object.assign(Object.assign({},this.formModel.amount),{value:null}),this.formData.amount=null,this.formModel.amount.formControl.reset(),this.formModel.paymentMethod=Object.assign(Object.assign({},this.formModel.paymentMethod),{selectedOption:{}}),this.formData.paymentTypeId=null,this.formModel.paymentDate=Object.assign(Object.assign({},this.formModel.paymentDate),{value:new Date}),this.formData.paymentDate=new Date,this.formModel.description=Object.assign(Object.assign({},this.formModel.description),{value:null}),this.formData.description=null,this.formModel.description.formControl.reset(),this.file=[]}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Et.M),i.Y36(Hi),i.Y36(te.v),i.Y36(yt.sK))},t.\u0275cmp=i.Xpm({type:t,selectors:[["payment-add"]],viewQuery:function(t,e){if(1&t&&i.Gf(Wi,5),2&t){let t;i.iGM(t=i.CRH())&&(e.content=t.first)}},inputs:{repairId:"repairId",repairPaymentStatus:"repairPaymentStatus",invoiceNumber:"invoiceNumber",invoiceDate:"invoiceDate",dueAmount:"dueAmount"},outputs:{handleAddPayment:"handleAddPayment"},features:[i.TTD],decls:3,vars:2,consts:[["class","fx-1 payment-add",4,"ngIf","ngIfElse"],["fullypaid",""],[1,"fx-1","payment-add"],[1,"row"],[1,"col-6"],[3,"inputModel","controlOutput"],[1,"col-6","payment-status"],[1,"row","mt-30","align-items-end"],[1,"input-wrapper"],[1,"input-label"],["class","file-proof",4,"ngFor","ngForOf"],["class","",4,"ngIf"],["class","add-file",3,"buttonModel","click",4,"ngIf"],["hidden","","type","file","accept","image/png, image/jpg, image/jpeg, application/pdf",3,"change"],["uploader",""],[1,"row","mt-30"],[1,"col-12"],[1,"footer-button"],[1,"save-payment",3,"buttonModel","click"],[1,"file-proof"],[1,"mr-20",3,"svgIcon"],[3,"svgIcon","click"],[1,""],[1,"add-file",3,"buttonModel","click"],[1,"payment-add"],[1,"input-label","uppercase"]],template:function(t,e){if(1&t&&(i.YNc(0,eo,30,12,"form",0),i.YNc(1,no,9,6,"ng-template",null,1,i.W1O)),2&t){const t=i.MAs(2);i.Q6J("ngIf",e.dueAmount>0)("ngIfElse",t)}},directives:[o.O5,jt._Y,jt.JL,jt.F,Nt.D,o.sg,Ut.E,Mt.Hw],pipes:[yt.X$],styles:['.payment-add[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.payment-add[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{display:flex;margin-top:30px}.payment-add[_ngcontent-%COMP%]   .mt-30[_ngcontent-%COMP%]{margin-top:30px}.payment-add[_ngcontent-%COMP%]   .align-items-end[_ngcontent-%COMP%]{align-items:end}.payment-add[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{display:block;font-size:10px;padding-bottom:4px;text-transform:uppercase;color:var(--xa-dark-gray)}.payment-add[_ngcontent-%COMP%]   .add-file[_ngcontent-%COMP%]     button{width:auto;padding:6px 12px!important;height:auto}.payment-add[_ngcontent-%COMP%]   .add-file[_ngcontent-%COMP%]     .btn-disabled-outline{border:1px solid var(--xa-light-gray)!important}.payment-add[_ngcontent-%COMP%]   .mr-20[_ngcontent-%COMP%]{margin-right:20px}.payment-add[_ngcontent-%COMP%]   .file-proof[_ngcontent-%COMP%]{font-size:14px;padding:5px 0;border-bottom:1px solid var(--xa-light-gray);border-top:1px solid var(--xa-light-gray);display:flex;align-items:center;justify-content:space-between}.payment-add[_ngcontent-%COMP%]   .file-proof[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-red)!important}.payment-add[_ngcontent-%COMP%]     textarea{font-family:"Inter",sans-serif;height:65px}.payment-add[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]     input{background:transparent;padding:0;opacity:1}.payment-add[_ngcontent-%COMP%]     dx-date-box.dx-invalid, .payment-add[_ngcontent-%COMP%]     dx-date-box.ng-invalid{border:none!important}']}),t})();const oo=["paymentList"],ro=["paymentadd"];function ao(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"payment-add",8,9),i.NdJ("handleAddPayment",function(e){return i.CHM(t),i.oxw().handleAddPayment(e)}),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("repairId",t.data.repairId)("repairPaymentStatus",t.data.paymentStatus)("dueAmount",t.data.dueAmount)("invoiceDate",t.data.invoiceDate)("invoiceNumber",t.data.invoiceNumber)}}let so=(()=>{class t{constructor(t,e,n,i,o){this.data=t,this.dialogRef=e,this.commonService=n,this.invoiceService=i,this.monitorService=o,this.closeButtonModel={label:"close",type:"primary",icon:""}}ngOnInit(){this.data=Object.assign(Object.assign({},this.data),this.data.dueAmount===this.data.invoiceAmount?{paymentStatus:"unpaid"}:0===this.data.dueAmount?{paymentStatus:"paid"}:{paymentStatus:"partialpaid"}),this.monitorService.logEvent("ngOnInit",["PaymentsComponent","addenda-repair"])}getInvoiceDetail(){this.invoiceService.invoicePerDetailProvider(this.data.repairId,this.data.isWorkProvider?1:2).subscribe({next:t=>{const e=null==t?void 0:t.data;this.data=Object.assign(Object.assign({},this.data),e),setTimeout(()=>{this.paymentadd.updateValidation(this.data.dueAmount,this.data.paymentStatus)})}})}cancelDialog(t){this.dialogRef.close(this.data.dueAmount)}handleAddPayment(t){this.paymentList.getPayments(this.data.invoiceGuid),this.data.dueAmount=(1e5*this.data.dueAmount-1e5*t.Amount)/1e5,this.data=Object.assign(Object.assign({},this.data),this.data.dueAmount===this.data.invoiceAmount?{paymentStatus:"unpaid"}:0===this.data.dueAmount?{paymentStatus:"paid"}:{paymentStatus:"partialpaid"}),this.getInvoiceDetail()}handlePaymentDelete(t){(null==t?void 0:t.Amount)&&(this.data.dueAmount=(1e5*this.data.dueAmount+1e5*parseFloat(t.Amount))/1e5),this.data=Object.assign(Object.assign({},this.data),this.data.dueAmount===this.data.invoiceAmount?{paymentStatus:"unpaid"}:0===this.data.dueAmount?{paymentStatus:"paid"}:{paymentStatus:"partialpaid"}),this.getInvoiceDetail()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(qt.WI),i.Y36(qt.so),i.Y36(te.v),i.Y36(Ji),i.Y36(Et.M))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-payments"]],viewQuery:function(t,e){if(1&t&&(i.Gf(oo,7),i.Gf(ro,5)),2&t){let t;i.iGM(t=i.CRH())&&(e.paymentList=t.first),i.iGM(t=i.CRH())&&(e.paymentadd=t.first)}},decls:11,vars:7,consts:[[1,"payment-container","fx-col"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content","fx-col","fx-1"],[3,"repairId","repairPaymentStatus","dueAmount","invoiceDate","invoiceNumber","handleAddPayment",4,"ngIf"],[3,"invoiceGuid","dueAmount","handlePaymentDelete"],["paymentList",""],[3,"repairId","repairPaymentStatus","dueAmount","invoiceDate","invoiceNumber","handleAddPayment"],["paymentadd",""]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"h3"),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",2),i.TgZ(6,"mat-icon",3),i.NdJ("click",function(){return e.cancelDialog(!1)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"div",4),i.YNc(8,ao,2,5,"payment-add",5),i.TgZ(9,"payment-list",6,7),i.NdJ("handlePaymentDelete",function(t){return e.handlePaymentDelete(t)}),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.hij("",i.lcZ(4,5,"payment")," "),i.xp6(3),i.Q6J("svgIcon","cross"),i.xp6(2),i.Q6J("ngIf",!e.commonService.isViewOnly),i.xp6(1),i.Q6J("invoiceGuid",e.data.invoiceGuid)("dueAmount",e.data.dueAmount))},directives:[Mt.Hw,o.O5,Vi,io],pipes:[yt.X$],styles:['.payment-container[_ngcontent-%COMP%]{overflow:auto;padding:20px}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:flex-end;display:flex;cursor:pointer}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:36px!important;width:36px!important;background:var(--xa-black);border-radius:50%;text-align:center}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg   path{fill:var(--xa-white)}.payment-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:15px}.payment-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]{margin-bottom:15px}.payment-container[_ngcontent-%COMP%]   .popup-footer-buttons[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:10px}.payment-container[_ngcontent-%COMP%]     button{font-family:"Inter",sans-serif}']}),t})();function lo(t,e){if(1&t&&(i.TgZ(0,"span",11),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Oqu(i.lcZ(2,1,t.InputModelDateTime.errorMessage))}}let co=(()=>{class t{constructor(t,e,n,i){this.data=t,this.dialogRef=e,this.monitorService=n,this.commonService=i,this.InputModelDateTime={placeHolder:"pickup_date",label:"pick_up_date_time",name:"",type:"datetime",maxDate:Je().add(6,"month").toDate(),minDate:Je().subtract(1,"minute").toDate(),value:null,error:!1,errorMessage:""},this.confirmButton={label:"save",type:"disabled",onclick:this.continue.bind(this)},this.PickUpDate=null}ngOnInit(){this.monitorService.logEvent("ngOnInit",["SchedulePickupDatePopupComponent","addenda-repair"]),null!==this.data.pickupDate&&(this.PickUpDate=this.data.pickupDate,-1===this.data.pickupDate.indexOf("Z")&&(this.PickUpDate=this.PickUpDate+"Z"),"schedule"===this.data.callSource?new Date(this.PickUpDate)>new Date&&(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"})):new Date(this.PickUpDate)<new Date&&(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"}))),"pickedUp"===this.data.callSource&&(this.InputModelDateTime.maxDate=Je().add(1,"minute").toDate(),this.InputModelDateTime.minDate=Je().subtract(6,"month").toDate())}close(){this.dialogRef.close()}continue(){this.monitorService.logEvent("continue",["SchedulePickupDatePopupComponent","addenda-repair"]),this.dialogRef.close({PickUpDate:this.PickUpDate})}updateInput({value:t}){if(this.InputModelDateTime.error=!1,"pickedUp"===this.data.callSource){if(new Date(t)>new Date)return Je(new Date(t)).format("YYYY-MM-DD hh:mm")==Je().format("YYYY-MM-DD hh:mm")?(this.InputModelDateTime.error=!1,this.PickUpDate=new Date(t.toString()),void(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"}))):(this.InputModelDateTime.error=!0,this.InputModelDateTime.errorMessage="pick_up_date_cannot_set_as_future_date",void(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"disabled"})))}else if(new Date(t)<new Date)return Je(new Date(t)).format("YYYY-MM-DD hh:mm")==Je().format("YYYY-MM-DD hh:mm")?(this.InputModelDateTime.error=!1,this.PickUpDate=new Date(t.toString()),void(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"}))):(this.InputModelDateTime.error=!0,this.InputModelDateTime.errorMessage="Pick_up_date_cannot_set_as_past_date",void(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"disabled"})));this.PickUpDate=new Date(t.toString()),this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(qt.WI),i.Y36(qt.so),i.Y36(Et.M),i.Y36(te.v))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-schedule-pickup-date-popup"]],decls:15,vars:16,consts:[[1,"message-container"],[1,"header"],[1,"header-text"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content"],[1,"input-label","uppercase","text-muted"],["type","datetime",3,"value","acceptCustomValue","invalidDateMessage","max","min","validationError","validationMessageMode","onValueChanged"],["class","pickupDate-error input-label text-muted",4,"ngIf"],[1,"footer","form-data-footer"],[1,"right",3,"buttonModel"],[1,"pickupDate-error","input-label","text-muted"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"span",2),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",3),i.TgZ(6,"mat-icon",4),i.NdJ("click",function(){return e.close()}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"div",5),i.TgZ(8,"label",6),i._uU(9),i.ALo(10,"translate"),i.qZA(),i.TgZ(11,"dx-date-box",7),i.NdJ("onValueChanged",function(t){return e.updateInput(t)}),i.qZA(),i.YNc(12,lo,3,3,"span",8),i.qZA(),i.TgZ(13,"div",9),i._UZ(14,"chq-button",10),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Oqu(i.lcZ(4,12,"pickedUp"===e.data.callSource?"picked_up_date_and_time":"schedule_pick_up")),i.xp6(3),i.Q6J("svgIcon","cross"),i.xp6(3),i.Oqu(i.lcZ(10,14,e.InputModelDateTime.label)),i.xp6(2),i.Q6J("value",e.PickUpDate)("acceptCustomValue",!1)("invalidDateMessage","")("max",e.InputModelDateTime.maxDate)("min",e.InputModelDateTime.minDate)("validationError",!1)("validationMessageMode","none"),i.xp6(1),i.Q6J("ngIf",e.InputModelDateTime.error),i.xp6(2),i.Q6J("buttonModel",e.confirmButton))},directives:[Mt.Hw,wt.M,o.O5,Ut.E],pipes:[yt.X$],styles:[".message-container[_ngcontent-%COMP%]{padding:30px;width:483px;height:200px;background-color:var(--xa-popup-light-gray);display:flex;flex-direction:column}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{font-size:20px;font-weight:700;line-height:25px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:36px;height:60px}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label.input-label[_ngcontent-%COMP%]{font-size:12px;font-weight:400;color:var(--xa-dark-gray)}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .pickupDate-error[_ngcontent-%COMP%]{font-size:12px;font-weight:400;color:var(--xa-red);padding-top:10px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:36px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{margin-right:4px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:4px}"]}),t})();var po=n(39075);const uo=function(t){return{"cc-email":t}};let ho=(()=>{class t{constructor(t,e,n,i,o,r,a){this.dialogRef=t,this.monitorService=e,this.messagingService=n,this.commonService=i,this.invoiceService=o,this.sanitizer=r,this.data=a,this.showCC=!1,this.fileName="Invoice",this.templateKey="",this.emailRequest={subject:"",email:[],message:""},this.emailForm={email:{label:"email_address",name:"email",placeHolder:"email_address",value:"",type:"text",validation:{name:"email",validationFunction:()=>jt.kI.compose([jt.kI.required,(0,Ie.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:t=>t.required?"email_required":t.invalidEmailNumber?"email_invalid_number":t.invalidEmail?"email_valid":""}},cc:{label:"CC",name:"cc",placeHolder:"CC",value:"",type:"text",validation:{name:"email",validationFunction:()=>jt.kI.compose([jt.kI.required,(0,Ie.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:t=>t.required?"email_required":t.invalidEmailNumber?"email_invalid_number":t.invalidEmail||t.pattern||t.email?"email_valid":""}}}}downloadPDF(t){const e=this.data.invoiceId;let n;n=this.data.dueDate?{parameters:[{name:"dueDate",value:Je(this.data.dueDate).format("YYYY-MM-DD")}]}:{parameters:[]},this.invoiceService.invoicePDF(t,e,n).subscribe({next:t=>{var e;if(t){this.blobUrl=null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.url;const n=this.blobUrl.substring(this.blobUrl.lastIndexOf("/")+1,this.blobUrl.length),i=null==n?void 0:n.split("?")[0];this.fileName=i}this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}onFormUpdate(t){var e;return t.isValid?(this.emailRequest[t.name]="email"===t.name?(null===(e=t.value)||void 0===e?void 0:e.split(","))||[]:t.value,void(this.sendButton=Object.assign(Object.assign({},this.sendButton),this.emailRequest.email&&this.emailRequest.email.length>0?{type:"primary"}:{type:"disabled"}))):(this.sendButton=Object.assign(Object.assign({},this.sendButton),{type:"disabled"}),void(this.emailRequest[t.name]=!1))}cancel(){this.dialogRef.close()}send(){const t={toEmails:this.emailRequest.email,communicationTypeIds:[2],templateKey:this.templateKey,invoiceType:this.data.isWorkProvider?1:2,subject:btoa(this.templateSubject.changingThisBreaksApplicationSecurity),messageContent:btoa(this.templateBody.changingThisBreaksApplicationSecurity),attachments:[{name:this.fileName,blobUrl:this.blobUrl}]};this.commonService.showLoading(),this.messagingService.setMessage(t,this.data.repairId).subscribe({next:t=>{this.commonService.showInfoToast(1e3,"email_sent"),this.commonService.hideLoading(),this.dialogRef.close()},error:()=>{this.commonService.hideLoading()}})}tagsReplacers(t){var e,n;return t?this.sanitizer.bypassSecurityTrustHtml(t.replace(/{{firstName}}/i,(this.data.isWorkProvider?this.data.workProviderValue:this.data.customerValue)||"").replace(/{{lastName}}/i,"").replace(/{{make}}/i,this.repairDetails.vehicle.vehicleMake).replace(/{{model}}/i,this.repairDetails.vehicle.vehicleModel).replace("{{licensenumber}}",this.repairDetails.vehicle.licensePlateNumber).replace("{{pickupdate}}","").replace("{RepairId}",this.repairDetails.repairNumber).replace("{{License Plate}}",this.repairDetails.vehicle.licensePlateNumber).replace("{{orgname}} Team.",`<div style='margin-top:-12px;'>${(null===(e=this.repairDetails.organizationDetail)||void 0===e?void 0:e.nameOfOrganization)||"--"} Team.</div>`).replace("{{orgcontactnumber}}",(null===(n=this.repairDetails.organizationDetail)||void 0===n?void 0:n.phoneNumber)||"--")):""}ngOnInit(){this.sendButton={label:"send",type:"disabled",icon:"send",onclick:this.send.bind(this)},this.commonService.showLoading(),this.messagingService.getMessageTemplate(this.data.repairId,this.data.domainId,3).subscribe({next:t=>{var e,n,i,o,r,a,s;if(t&&(null===(e=t[0])||void 0===e?void 0:e.data)){this.repairDetails=t[0].data;const e=(null===(n=this.repairDetails.organizationDetail)||void 0===n?void 0:n.partnerships)?null===(o=null===(i=this.repairDetails.organizationDetail)||void 0===i?void 0:i.partnerships[0])||void 0===o?void 0:o.email:"";let l="";if(this.data.isWorkProvider||(l=null===(r=this.repairDetails.customer)||void 0===r?void 0:r.email),this.emailRequest.email=this.data.isWorkProvider?[e]:[l],this.emailForm.email=Object.assign(Object.assign({},this.emailForm.email),{value:this.emailRequest.email[0]}),this.downloadPDF(this.data.repairId),null===(a=t[1])||void 0===a?void 0:a.data){const e=null===(s=t[1])||void 0===s?void 0:s.data;this.templateSubject=e.subject,this.templateBody=e.body,this.templateKey=t[1].data.templateKey,this.templateBody=this.tagsReplacers(this.templateBody),this.templateSubject=this.tagsReplacers(this.templateSubject)}}}}),this.sendButton=Object.assign(Object.assign({},this.sendButton),this.emailRequest.email&&this.emailRequest.email.length>0?{type:"primary"}:{type:"disabled"})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(qt.so),i.Y36(Et.M),i.Y36(Be.K),i.Y36(te.v),i.Y36(Ji),i.Y36(po.H7),i.Y36(qt.WI))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-send-invoice"]],decls:33,vars:21,consts:[[1,"dialog-container"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],["mat-dialog-content","",1,"email-dialog-body"],[1,"form-container"],[1,"input-wrapper"],[1,"div-wrapper"],[3,"ngClass","inputModel","controlOutput"],[1,"subject-wrapper","content-wrapper"],[1,"status",3,"innerHtml"],[1,"message-wrapper","content-wrapper"],[1,"message-container",3,"innerHtml"],[1,"attachment-wrapper","content-wrapper"],[1,"attachment-container"],[1,"attachment-item"],["src","../../../assets/img/pdf.png","alt",""],[1,"btn-container"],[1,"right",3,"buttonModel"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"h3"),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",2),i.TgZ(6,"mat-icon",3),i.NdJ("click",function(){return e.cancel()}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"div",4),i.TgZ(8,"div",5),i.TgZ(9,"div",6),i.TgZ(10,"div",7),i.TgZ(11,"chq-input",8),i.NdJ("controlOutput",function(t){return e.onFormUpdate(t)}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(12,"div",9),i.TgZ(13,"label"),i._uU(14),i.ALo(15,"translate"),i.qZA(),i._UZ(16,"div",10),i.qZA(),i.TgZ(17,"div",11),i.TgZ(18,"label"),i._uU(19),i.ALo(20,"translate"),i.qZA(),i._UZ(21,"div",12),i.qZA(),i.TgZ(22,"div",13),i.TgZ(23,"label"),i._uU(24),i.ALo(25,"translate"),i.qZA(),i.TgZ(26,"div",14),i.TgZ(27,"div",15),i.TgZ(28,"div"),i._uU(29),i.qZA(),i._UZ(30,"img",16),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(31,"div",17),i._UZ(32,"chq-button",18),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Oqu(i.lcZ(4,11,"send_email")),i.xp6(3),i.Q6J("svgIcon","cross"),i.xp6(5),i.Q6J("ngClass",i.VKq(19,uo,!e.showCC))("inputModel",e.emailForm.email),i.xp6(3),i.Oqu(i.lcZ(15,13,"subject")),i.xp6(2),i.Q6J("innerHtml",e.templateSubject,i.oJD),i.xp6(3),i.Oqu(i.lcZ(20,15,"message")),i.xp6(2),i.Q6J("innerHtml",e.templateBody,i.oJD),i.xp6(3),i.Oqu(i.lcZ(25,17,"attachments")),i.xp6(5),i.Oqu(e.fileName),i.xp6(3),i.Q6J("buttonModel",e.sendButton))},directives:[Mt.Hw,Nt.D,o.mk,Ut.E],pipes:[yt.X$],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--xa-popup-light-gray);width:39.3125rem;grid-gap:2.25rem;gap:2.25rem;padding:1.875rem}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:20px;gap:20px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:first-child{text-transform:uppercase;font-size:12px;line-height:14px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:.24963rem;gap:.24963rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:.75rem;font-style:normal;font-weight:400;text-transform:uppercase}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:.44963rem;gap:.44963rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]     p{margin:0;line-height:20px;color:var(--xa-black-medium);font-size:16px;font-family:inherit}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-weight:400;color:var(--xa-dark-gray)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{display:inline-block;color:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.4rem;gap:1.4rem;font-size:1rem;font-weight:400;color:var(--xa-black-medium)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]     p{margin:0;line-height:20px;color:var(--xa-black-medium);font-size:16px;font-family:inherit}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]     br{display:none}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]{grid-gap:.86625rem;gap:.86625rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]   .attachment-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:.86625rem;gap:.86625rem;font-size:1rem;font-weight:400;color:#0b0e15}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]   .attachment-container[_ngcontent-%COMP%]   .attachment-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;border-top:1px solid #c1c1c1;border-bottom:1px solid #c1c1c1;padding:.3125rem 0}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{display:flex;grid-gap:20px;gap:20px;flex-direction:column}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;line-height:14px;font-weight:400}.dialog-container[_ngcontent-%COMP%]   .email-dialog-body[_ngcontent-%COMP%]{max-height:calc(90vh - 174px)!important}.cc-span[_ngcontent-%COMP%]{position:absolute;right:10px;font-size:16px;line-height:14px;top:35px;color:var(--xa-black-medium);cursor:pointer}.div-wrapper[_ngcontent-%COMP%]{position:relative}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;grid-gap:10px;gap:10px;background:var(--xa-popup-light-gray)}"]}),t})();var go=n(33938),mo=n(48262),vo=n(23815);let fo=(()=>{class t{constructor(){this.transform=vo.orderBy}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=i.Yjl({name:"orderBy",type:t,pure:!0}),t})();var bo=n(93077);let _o=(()=>{class t{constructor(){this.maxPoint=1e8}transform(t,e){return t.reduce((t,n)=>t+this.parseFloatingPoint(n[e]),0)/this.maxPoint}parseFloatingPoint(t){return"string"==typeof t&&(t=parseFloat(t)),parseFloat(t)*this.maxPoint}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=i.Yjl({name:"sum",type:t,pure:!0}),t})();const Mo=["print"],Oo=["phone"],yo=function(t,e){return{active:t,"all-border":e}};function Co(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"button",18),i.NdJ("click",function(){return i.CHM(t),i.oxw().updateFormType(1)}),i._uU(1),i.ALo(2,"translate"),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("ngClass",i.WLB(4,yo,t.isWorkProvider,"retail"===(null==t.currentWorkProvider?null:t.currentWorkProvider.toLowerCase())&&"person"!==(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase()))),i.xp6(1),i.hij(" ",i.lcZ(2,2,"work_provider_invoice")," ")}}function xo(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"button",19),i.NdJ("click",function(){return i.CHM(t),i.oxw().updateFormType(2)}),i._uU(1),i.ALo(2,"translate"),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("ngClass",i.WLB(4,yo,!t.isWorkProvider,"retail"===(null==t.currentWorkProvider?null:t.currentWorkProvider.toLowerCase())&&"person"===(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase()))),i.xp6(1),i.hij(" ",i.lcZ(2,2,"driver_owner_invoice")," ")}}function Po(t,e){if(1&t&&(i.TgZ(0,"span"),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&t){const t=i.oxw();i.Gre("status-pill status-",null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase(),""),i.xp6(1),i.Oqu(i.lcZ(2,4,t.paymentStatusMapper[null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase()]))}}function wo(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"img",42),i.NdJ("load",function(){return i.CHM(t),i.oxw(2).orgImageLoading=!1}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("src",t.orgLogoUrl,i.LSH)}}function To(t,e){if(1&t&&(i.TgZ(0,"label",44),i._uU(1),i.qZA()),2&t){const t=i.oxw(3);i.xp6(1),i.Oqu(t.orgName)}}function Do(t,e){if(1&t&&i.YNc(0,To,2,1,"label",43),2&t){const t=i.oxw(2);i.Q6J("ngIf",t.orgName)}}function So(t,e){if(1&t){const t=i.EpF();i.ynx(0),i.TgZ(1,"h4"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"h5"),i._uU(5),i.qZA(),i.TgZ(6,"h5"),i._uU(7),i.ALo(8,"translate"),i.qZA(),i.TgZ(9,"h5"),i._uU(10),i.ALo(11,"translate"),i.qZA(),i.TgZ(12,"h5"),i._uU(13),i.ALo(14,"translate"),i.qZA(),i.TgZ(15,"h5"),i._uU(16),i.ALo(17,"translate"),i.qZA(),i.TgZ(18,"chq-input",45),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).dataResponse.invoiceDate=e.value}),i.qZA(),i._UZ(19,"chq-input",46),i.TgZ(20,"chq-input",45),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).dataResponse.dueDate=e.value}),i.qZA(),i.BQk()}if(2&t){const t=i.oxw(2);i.xp6(2),i.Oqu(i.lcZ(3,13,"work_provider")),i.xp6(3),i.Oqu(t.workProviderValue),i.xp6(2),i.AsE("",i.lcZ(8,15,"contact_phone_number"),": ",t.dataResponse.customerPhoneNumber,""),i.xp6(3),i.AsE("",i.lcZ(11,17,"contact_email"),": ",t.dataResponse.customerEmail,""),i.xp6(3),i.AsE("",i.lcZ(14,19,"vehicle_owner"),": ",t.dataResponse.vehicleOwnerName,""),i.xp6(3),i.AsE("",i.lcZ(17,21,"license_id_cin"),": ",t.dataResponse.licenseNumber,""),i.xp6(2),i.Q6J("inputModel",t.invoiceIssuedDate),i.xp6(1),i.Q6J("inputModel",t.invoiceNumberInput),i.xp6(1),i.Q6J("inputModel",t.dueDate)}}function Io(t,e){if(1&t){const t=i.EpF();i.ynx(0),i.TgZ(1,"h4"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"h5"),i._uU(5),i.qZA(),i.TgZ(6,"h5"),i._uU(7),i.ALo(8,"translate"),i.qZA(),i.TgZ(9,"h5"),i._uU(10),i.ALo(11,"translate"),i.qZA(),i.TgZ(12,"chq-input",45),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw(2);return n.dataResponse.address=e.value||null,n.isInvoiceFormValid()}),i.qZA(),i.TgZ(13,"chq-input",45),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw(2);return n.dataResponse.invoiceDate=e.value,n.isInvoiceFormValid()}),i.qZA(),i._UZ(14,"chq-input",46),i.TgZ(15,"chq-input",45),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(2).dataResponse.dueDate=e.value}),i.qZA(),i.BQk()}if(2&t){const t=i.oxw(2);i.xp6(2),i.Oqu(i.lcZ(3,10,"driver_owner")),i.xp6(3),i.Oqu(t.customerValue),i.xp6(2),i.AsE("",i.lcZ(8,12,"driver_contact_phone_number"),": ",t.dataResponse.customerPhoneNumber,""),i.xp6(3),i.AsE("",i.lcZ(11,14,"driver_contact_email"),": ",t.dataResponse.customerEmail,""),i.xp6(2),i.Q6J("inputModel",t.addressInput),i.xp6(1),i.Q6J("inputModel",t.invoiceIssuedDate),i.xp6(1),i.Q6J("inputModel",t.invoiceNumberInput),i.xp6(1),i.Q6J("inputModel",t.dueDate)}}const ko=function(t){return{"text-mode":t}};function Zo(t,e){if(1&t&&(i.TgZ(0,"div",47),i.TgZ(1,"div",48),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"div",49),i.TgZ(5,"span"),i._uU(6),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.Q6J("ngClass",i.VKq(6,ko,"paid"===(null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase())||"complete"===(null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase()))),i.xp6(2),i.hij(" ",i.lcZ(3,4,"contact_number")," "),i.xp6(4),i.AsE("",t.dataResponse.code," ",t.dataResponse.mobileNumber||"--","")}}function Ao(t,e){if(1&t&&(i.TgZ(0,"tr"),i.TgZ(1,"td",58),i.TgZ(2,"h6",53),i._uU(3),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(3),i.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}const qo=function(t,e,n,i,o){return[t,e,n,i,o]};function Lo(t,e){if(1&t&&(i.TgZ(0,"tbody"),i.YNc(1,Ao,4,1,"tr",28),i.TgZ(2,"tr"),i.TgZ(3,"td"),i._uU(4),i.qZA(),i.TgZ(5,"td"),i._uU(6),i.qZA(),i.TgZ(7,"td",57),i._uU(8),i.qZA(),i.TgZ(9,"td"),i._uU(10),i.ALo(11,"xaCurrency"),i.qZA(),i.TgZ(12,"td"),i._uU(13),i.ALo(14,"xaCurrency"),i.qZA(),i.qZA(),i.qZA()),2&t){const t=e.$implicit,n=e.index,o=i.oxw(2).$implicit,r=i.oxw(2);i.xp6(1),i.Q6J("ngIf","Paint"===o.key&&(0===n||n>0&&t.serviceSubType!==r.invoiceList[o.key][n-1].serviceSubType)),i.xp6(3),i.Oqu(t.description),i.xp6(2),i.Oqu(t.code),i.xp6(2),i.Oqu(t.quantity),i.xp6(2),i.hij(" ",i.G7q(11,6,i.qbA(18,qo,t.cost,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," "),i.xp6(3),i.hij(" ",i.G7q(14,12,i.qbA(24,qo,t.total,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," ")}}function Eo(t,e){if(1&t&&(i.ynx(0),i.TgZ(1,"table",54),i.TgZ(2,"thead"),i.TgZ(3,"tr"),i.TgZ(4,"td"),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"td"),i._uU(8),i.ALo(9,"translate"),i.qZA(),i.TgZ(10,"td"),i._uU(11),i.ALo(12,"translate"),i.qZA(),i.TgZ(13,"td"),i._uU(14),i.ALo(15,"translate"),i.qZA(),i.TgZ(16,"td"),i._uU(17),i.ALo(18,"translate"),i.qZA(),i.qZA(),i.qZA(),i.YNc(19,Lo,15,30,"tbody",55),i.ALo(20,"orderBy"),i.qZA(),i.TgZ(21,"table",54),i.TgZ(22,"tfoot"),i.TgZ(23,"tr"),i.TgZ(24,"td"),i._uU(25),i.ALo(26,"translate"),i.qZA(),i.TgZ(27,"td",56),i._uU(28),i.ALo(29,"xaCurrency"),i.ALo(30,"sum"),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.BQk()),2&t){const t=i.oxw().$implicit,e=i.oxw(2);i.xp6(5),i.Oqu(i.lcZ(6,10,"description")),i.xp6(3),i.Oqu(i.lcZ(9,12,"code")),i.xp6(3),i.Oqu(i.lcZ(12,14,"units")),i.xp6(3),i.AsE("",i.lcZ(15,16,"price_unit"),"(",e.currencySymbol,")"),i.xp6(3),i.AsE("",i.lcZ(18,18,"total_price"),"(",e.currencySymbol,")"),i.xp6(2),i.Q6J("ngForOf",i.Dn7(20,20,e.invoiceList[t.key],"serviceSubtype","asc")),i.xp6(6),i.Oqu(i.lcZ(26,24,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),i.xp6(3),i.hij(" ",i.G7q(29,26,i.qbA(35,qo,i.xi3(30,32,e.invoiceList[t.key],"total"),e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position))," ")}}function Ro(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",50),i.TgZ(1,"span",51),i.NdJ("click",function(){const e=i.CHM(t).$implicit;return i.oxw(2).hideShowSection(e.key)}),i.TgZ(2,"mat-icon",52),i._uU(3),i.qZA(),i.TgZ(4,"h6",53),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.qZA(),i.YNc(7,Eo,31,41,"ng-container",28),i.qZA()}if(2&t){const t=e.$implicit,n=i.oxw(2);i.xp6(3),i.Oqu(n.getSection(t.key)?"keyboard_arrow_up":"keyboard_arrow_down"),i.xp6(2),i.Oqu(i.lcZ(6,3,null==t.key?null:t.key.toLowerCase())),i.xp6(2),i.Q6J("ngIf",n.getSection(t.key))}}function jo(t,e){if(1&t&&(i.TgZ(0,"div",65),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(3);i.xp6(2),i.hij("5% ",i.lcZ(3,2,"vat"),""),i.xp6(3),i.Oqu(i.G7q(6,4,i.qbA(10,qo,.05*(t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.labourTotal+t.estimateSummary.partsTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position)))}}function Fo(t,e){if(1&t&&(i.TgZ(0,"div",65),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(3);i.xp6(2),i.Oqu(i.lcZ(3,2,"total_cost_including_vat")),i.xp6(3),i.Oqu(i.G7q(6,4,i.qbA(10,qo,t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.labourTotal+t.estimateSummary.partsTotal+.05*(t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.partsTotal+t.estimateSummary.labourTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position)))}}function No(t,e){if(1&t&&(i.TgZ(0,"div",59),i.TgZ(1,"div",60),i.TgZ(2,"h5"),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"h6"),i._uU(6),i.ALo(7,"translate"),i.qZA(),i.TgZ(8,"div",61),i.TgZ(9,"span"),i._uU(10),i.ALo(11,"translate"),i.qZA(),i.TgZ(12,"span"),i._uU(13),i.ALo(14,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(15,"div",61),i.TgZ(16,"span"),i._uU(17),i.ALo(18,"translate"),i.qZA(),i.TgZ(19,"span"),i._uU(20),i.ALo(21,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(22,"div",61),i.TgZ(23,"span"),i._uU(24),i.ALo(25,"translate"),i.qZA(),i.TgZ(26,"span"),i._uU(27),i.ALo(28,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(29,"div",62),i.TgZ(30,"span"),i._uU(31),i.ALo(32,"translate"),i.qZA(),i.TgZ(33,"span"),i._uU(34),i.qZA(),i.qZA(),i.TgZ(35,"div",63),i.TgZ(36,"span"),i._uU(37),i.ALo(38,"translate"),i.qZA(),i.TgZ(39,"span"),i._uU(40),i.ALo(41,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(42,"h6"),i._uU(43),i.ALo(44,"translate"),i.qZA(),i.TgZ(45,"div",61),i.TgZ(46,"span"),i._uU(47),i.ALo(48,"translate"),i.qZA(),i.TgZ(49,"span"),i._uU(50),i.ALo(51,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(52,"div",61),i.TgZ(53,"span"),i._uU(54),i.ALo(55,"translate"),i.qZA(),i.TgZ(56,"span"),i._uU(57),i.qZA(),i.qZA(),i.TgZ(58,"div",62),i.TgZ(59,"span"),i._uU(60),i.ALo(61,"translate"),i.qZA(),i.TgZ(62,"span"),i._uU(63),i.qZA(),i.qZA(),i.TgZ(64,"div",63),i.TgZ(65,"span"),i._uU(66),i.ALo(67,"translate"),i.qZA(),i.TgZ(68,"span"),i._uU(69),i.ALo(70,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(71,"h6"),i._uU(72),i.ALo(73,"translate"),i.qZA(),i.TgZ(74,"div",61),i.TgZ(75,"span"),i._uU(76),i.ALo(77,"translate"),i.qZA(),i.TgZ(78,"span"),i._uU(79),i.qZA(),i.qZA(),i.TgZ(80,"div",61),i.TgZ(81,"span"),i._uU(82),i.ALo(83,"translate"),i.qZA(),i.TgZ(84,"span"),i._uU(85),i.ALo(86,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(87,"div",61),i.TgZ(88,"span"),i._uU(89),i.ALo(90,"translate"),i.qZA(),i.TgZ(91,"span"),i._uU(92),i.qZA(),i.qZA(),i.TgZ(93,"div",64),i.TgZ(94,"span"),i._uU(95),i.ALo(96,"translate"),i.qZA(),i.TgZ(97,"span"),i._uU(98),i.ALo(99,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(100,"div",61),i.TgZ(101,"span"),i._uU(102),i.ALo(103,"translate"),i.qZA(),i.TgZ(104,"span"),i._uU(105),i.ALo(106,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(107,"div",61),i.TgZ(108,"span"),i._uU(109),i.ALo(110,"translate"),i.qZA(),i.TgZ(111,"span"),i._uU(112),i.qZA(),i.qZA(),i.TgZ(113,"div",62),i.TgZ(114,"span"),i._uU(115),i.ALo(116,"translate"),i.qZA(),i.TgZ(117,"span"),i._uU(118),i.ALo(119,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(120,"div",63),i.TgZ(121,"span"),i._uU(122),i.ALo(123,"translate"),i.qZA(),i.TgZ(124,"span"),i._uU(125),i.ALo(126,"xaCurrency"),i.qZA(),i.qZA(),i.TgZ(127,"div",65),i.TgZ(128,"span"),i._uU(129),i.ALo(130,"translate"),i.qZA(),i.TgZ(131,"span"),i._uU(132),i.ALo(133,"xaCurrency"),i.qZA(),i.qZA(),i.YNc(134,jo,7,16,"div",66),i.YNc(135,Fo,7,16,"div",66),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(3),i.Oqu(i.lcZ(4,42,"summary")),i.xp6(3),i.Oqu(i.lcZ(7,44,"parts")),i.xp6(4),i.Oqu(i.lcZ(11,46,"subtotal")),i.xp6(3),i.Oqu(i.G7q(14,48,i.qbA(158,qo,t.estimateSummary.partsSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(18,54,"sundry_parts")),i.xp6(3),i.Oqu(i.G7q(21,56,i.qbA(164,qo,t.estimateSummary.sundryParts,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(25,62,"total_before_discount")),i.xp6(3),i.Oqu(i.G7q(28,64,i.qbA(170,qo,t.estimateSummary.partsTotalBeforeDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(32,70,"discount_on_parts")),i.xp6(3),i.hij("",t.estimateSummary.partsTotalDiscountPercentage,"%"),i.xp6(3),i.Oqu(i.lcZ(38,72,"total_parts")),i.xp6(3),i.Oqu(i.G7q(41,74,i.qbA(176,qo,t.estimateSummary.partsTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(3),i.Oqu(i.lcZ(44,80,"labour")),i.xp6(4),i.Oqu(i.lcZ(48,82,"labour_amount_subtotal")),i.xp6(3),i.Oqu(i.G7q(51,84,i.qbA(182,qo,t.estimateSummary.labourAmountSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(55,90,"labour_hours")),i.xp6(3),i.hij("",t.estimateSummary.labourTimeHours," hrs"),i.xp6(3),i.Oqu(i.lcZ(61,92,"labour_discount")),i.xp6(3),i.hij("",t.estimateSummary.labourTotalDiscountPercentage,"%"),i.xp6(3),i.Oqu(i.lcZ(67,94,"total_labour_cost")),i.xp6(3),i.Oqu(i.G7q(70,96,i.qbA(188,qo,t.estimateSummary.labourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(3),i.Oqu(i.lcZ(73,102,"paint")),i.xp6(4),i.Oqu(i.lcZ(77,104,"paint_labour_time")),i.xp6(3),i.hij("",t.estimateSummary.paintLabourTimeHour,"hrs"),i.xp6(3),i.Oqu(i.lcZ(83,106,"paint_labour_subtotal")),i.xp6(3),i.Oqu(i.G7q(86,108,i.qbA(194,qo,t.estimateSummary.paintLabourSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(90,114,"paint_labour_discount")),i.xp6(3),i.hij(" ",t.estimateSummary.paintLabourDiscountPercentage,"%"),i.xp6(3),i.Oqu(i.lcZ(96,116,"labour_total")),i.xp6(3),i.Oqu(i.G7q(99,118,i.qbA(200,qo,t.estimateSummary.paintLabourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(103,124,"material_subtotal")),i.xp6(3),i.Oqu(i.G7q(106,126,i.qbA(206,qo,t.estimateSummary.paintMaterialSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(110,132,"material_discount")),i.xp6(3),i.hij("",t.estimateSummary.paintMateriaDiscountPercentage,"%"),i.xp6(3),i.Oqu(i.lcZ(116,134,"material_total")),i.xp6(3),i.Oqu(i.G7q(119,136,i.qbA(212,qo,t.estimateSummary.paintMaterialTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(123,142,"total_paint")),i.xp6(3),i.Oqu(i.G7q(126,144,i.qbA(218,qo,t.calculateSub(t.estimateSummary.paintLabourTotal,t.estimateSummary.paintMaterialTotal,0,0),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(4),i.Oqu(i.lcZ(130,150,"total_cost")),i.xp6(3),i.Oqu(i.G7q(133,152,i.qbA(224,qo,t.calculateSub(t.estimateSummary.paintLabourTotal,t.estimateSummary.paintMaterialTotal,t.estimateSummary.labourTotal,t.estimateSummary.partsTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),i.xp6(2),i.Q6J("ngIf",!1),i.xp6(1),i.Q6J("ngIf",!1)}}const Uo=function(t){return{"do-not-print":t}},Jo=function(t){return{"text-check":t}};function Yo(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",20),i.TgZ(1,"section",21),i.TgZ(2,"div",22),i.TgZ(3,"div",23),i.YNc(4,wo,1,1,"img",24),i.YNc(5,Do,1,1,"ng-template",null,25,i.W1O),i._UZ(7,"chq-customloader",26),i.qZA(),i.TgZ(8,"div",27),i.YNc(9,So,21,23,"ng-container",28),i.YNc(10,Io,16,16,"ng-container",28),i.qZA(),i.qZA(),i.TgZ(11,"div",29),i.TgZ(12,"chq-input",30),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw();return n.dataResponse.workShopName=e.value||null,n.isInvoiceFormValid()}),i.qZA(),i.TgZ(13,"chq-input",30),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw();return n.dataResponse.bankName=e.value||null,n.isInvoiceFormValid()}),i.qZA(),i.TgZ(14,"chq-input",30),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw();return n.dataResponse.ifscCode=e.value||null,n.isInvoiceFormValid()}),i.qZA(),i.TgZ(15,"chq-input",30),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw();return n.dataResponse.accountNumber=e.value||null,n.isInvoiceFormValid()}),i.qZA(),i.TgZ(16,"chq-input",30),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw();return n.dataResponse.trn=e.value||null,n.isInvoiceFormValid()}),i.qZA(),i.TgZ(17,"div",31),i.TgZ(18,"chq-input",32),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw().onFormUpdateCustomer(e)}),i.qZA(),i.TgZ(19,"chq-input",33,34),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw();return n.dataResponse.mobileNumber=e.value||null,n.isInvoiceFormValid()}),i.qZA(),i.YNc(21,Zo,7,8,"div",35),i.qZA(),i.qZA(),i.qZA(),i.TgZ(22,"section",36),i.TgZ(23,"div",37),i.TgZ(24,"span",38),i.NdJ("click",function(){return i.CHM(t),i.oxw().expandCollapse(!0)}),i._uU(25),i.ALo(26,"translate"),i.qZA(),i.TgZ(27,"span",38),i.NdJ("click",function(){return i.CHM(t),i.oxw().expandCollapse(!1)}),i._uU(28),i.ALo(29,"translate"),i.qZA(),i.qZA(),i.TgZ(30,"div",39),i.YNc(31,Ro,8,5,"div",40),i.ALo(32,"keyvalue"),i.YNc(33,No,136,230,"div",41),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.MAs(6),e=i.oxw();i.xp6(4),i.Q6J("ngIf",e.orgLogoUrl)("ngIfElse",t),i.xp6(3),i.Q6J("showLoading",e.orgImageLoading),i.xp6(2),i.Q6J("ngIf",e.isWorkProvider),i.xp6(1),i.Q6J("ngIf",!e.isWorkProvider),i.xp6(2),i.Q6J("ngClass",i.VKq(36,Uo,!e.dataResponse.workShopName))("inputModel",e.payeeOrgNameInput),i.xp6(1),i.Q6J("ngClass",i.VKq(38,Uo,!e.dataResponse.bankName))("inputModel",e.payeeBankNameInput),i.xp6(1),i.Q6J("ngClass",i.VKq(40,Uo,!e.dataResponse.ifscCode))("inputModel",e.IfscCodeInput),i.xp6(1),i.Q6J("ngClass",i.VKq(42,Uo,!e.dataResponse.accountNumber))("inputModel",e.accountNumberInput),i.xp6(1),i.Q6J("ngClass",i.VKq(44,Uo,!e.dataResponse.trn))("inputModel",e.trnNumberInput),i.xp6(1),i.Q6J("ngClass",i.VKq(46,Jo,"paid"===(null==e.dataResponse||null==e.dataResponse.paymentStatus?null:e.dataResponse.paymentStatus.toLowerCase())||"complete"===(null==e.dataResponse||null==e.dataResponse.paymentStatus?null:e.dataResponse.paymentStatus.toLowerCase()))),i.xp6(1),i.Q6J("ngClass",i.VKq(48,Uo,!e.phoneCode.value))("inputModel",e.phoneCode),i.xp6(1),i.Q6J("ngClass",i.VKq(50,Uo,!e.dataResponse.mobileNumber))("inputModel",e.contactNumberInput),i.xp6(2),i.Q6J("ngIf",e.dataResponse.mobileNumber),i.xp6(3),i.ekj("secondary-color",e.isAllExpanded),i.xp6(1),i.Oqu(i.lcZ(26,29,"expand_all")),i.xp6(2),i.ekj("secondary-color",!e.isAllExpanded),i.xp6(1),i.hij("",i.lcZ(29,31,"collapse_all")," "),i.xp6(3),i.Q6J("ngForOf",i.xi3(32,33,e.invoiceList,e.valueAscOrder)),i.xp6(2),i.Q6J("ngIf",e.estimateSummary)}}const Bo=function(t){return{value:t}};function zo(t,e){if(1&t&&(i.TgZ(0,"div",67),i._UZ(1,"mat-icon",68),i.TgZ(2,"p",69),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("svgIcon","estimate-no-data"),i.xp6(2),i.hij(" ",i.xi3(4,2,"no_invoice_result",i.VKq(5,Bo,t.isWorkProvider?t.workProviderValue:t.customerValue)),". ")}}function Ho(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-dropdown",70),i.NdJ("selected",function(e){return i.CHM(t),i.oxw().handleSelectedOption(e)}),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function Go(t,e){if(1&t&&i._UZ(0,"chq-button",71),2&t){const t=i.oxw();i.Q6J("buttonModel",t.saveButtonModel)}}function Qo(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-button",72),i.NdJ("click",function(){return i.CHM(t),i.oxw().openPaymentPopup()}),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("buttonModel",t.paymentsButtonModel)}}function Vo(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-button",72),i.NdJ("click",function(){return i.CHM(t),i.oxw().closeRepair()}),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("buttonModel",t.closeRepairButtonModel)}}let $o=(()=>{class t{constructor(t,e,n,i,o,r,a,s,l,c,d){var p;this.commonService=t,this.route=e,this.router=n,this.dialog=i,this.coreService=o,this.translateService=r,this.OutboundService=a,this.invoiceService=s,this.bookingService=l,this.translationService=c,this.monitorServie=d,this.digitInfo="",this.locale="",this.currencySymbol="",this.charges=[],this.subs=[],this.isOptionsOpen=!1,this.invoiceList={},this.isWorkProvider=!0,this.orgImageLoading=!0,this.orgLogoUrl="",this.orgName="",this.repairStatus="",this.domainId=3100,this.isAllExpanded=!0,this.isPartsExpanded=!0,this.isLabourExpanded=!0,this.isPaintExpanded=!0,this.isDataLoading=!0,this.dataResponse={},this.pickupDate=null,this.currentDueDate=null,this.bookingOutDate=null,this.trnNumberLimit=15,this.partsCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",units:"2",cost:"500",total:"1500"}],this.totalPartsCost=0,this.labourCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",hours:"5",cost:"500",total:"1500"}],this.totalLabourCost=0,this.maxPoint=1e7,this.estimateSummary={},this.currentWorkProvider="",this.currentWorkProviderType="",this.workProviderValue="",this.customerValue="",this.paintLabour=[{description:"Boot lid Repaired <50%",code:"GtP84000",unitHours:"1.60",cost:"500",total:"1500"}],this.paintMaterial=[{description:"Boot lid Repaired <50%",code:"GtP84000",unitHours:"1",cost:"300",total:"300"}],this.totalPaintCost=0,this.noDataFound=!1,this.paintCost=[],this.dropdownApprovalModelFilter={options:[{dropdownItemIconMaterial:"mail_outline",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"send",label:this.translationService.instant("send")},{dropdownItemIconMaterial:"download-arrow",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"download",label:this.translationService.instant("download")}],placeHolder:"Options",label:"",hideDropdownIcon:!1,appearance:"button",placeHolderIcon:"settings-outline",name:"option",displayValue:"label",selectedOption:{}},this.backButtonModel={label:"Back / Edit Invoice ",type:"outline",icon:"left-arrow",onclick:()=>{var t;const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.router.navigate([`repair/booking/${e}/invoices`],{queryParams:{isBack:!0}})}},this.saveButtonModel={label:"Save",type:"outline",onclick:()=>{this.saveInvoiceComponent()}},this.invoiceGUID="",this.paymentsButtonModel={label:"Payments",icon:"credit-card",type:"outline"},this.closeRepairButtonModel={label:"Close Repair",icon:"cross",type:"primary"},this.invoiceIssuedDate={placeHolder:"Select Date",label:"INVOICE DATE",name:"invoiceDate",value:new Date,maxDate:new Date,type:"date",required:!0,disabled:!1,mode:"text"},this.dueDate={placeHolder:"Select Date",label:"DUE DATE",name:"dueDate",value:"",type:"date",required:!1,disabled:!1,mode:"date"},this.addressInput={placeHolder:"",label:"ADDRESS",name:"address",value:"St 123",type:"text",maxLength:200,validation:{name:"address",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(200)]),validationMessage:t=>t.required?"Please select operation type":t.maxLength?this.translateService.instant("max_length",{value:200}):""}},this.invoiceNumberInput={placeHolder:"",label:"INVOICE NUMBER",name:"invoiceNumber",value:"",type:"text",mode:"text"},this.payeeOrgNameInput={placeHolder:"",label:"workshop",name:"orgName",value:"XA Prestige Automotive",type:"text",validation:{name:"orgName",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(30)]),validationMessage:t=>t.maxlength?this.translateService.instant("max_length",{value:30}):""}},this.payeeBankNameInput={placeHolder:"",label:"Payee BANK  Name",name:"bankname",value:"Emirates NBD",type:"text",validation:{name:"orgName",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(30)]),validationMessage:t=>t.maxlength?this.translateService.instant("max_length",{value:30}):""}},this.IfscCodeInput={placeHolder:"",label:"IFSC/Swift Code",name:"ifscCode",maxLength:11,value:"9076986696",type:"text",validation:{name:"orgName",validationFunction:()=>jt.kI.compose([jt.kI.maxLength(11),jt.kI.minLength(11)]),validationMessage:t=>t.maxlength||t.minlength?this.translateService.instant("max_length",{value:11}):""}},this.accountNumberInput={placeHolder:"",label:"Account Number/IBAN",name:"accountNumber",value:"",type:"text",validation:{name:"accountNumber",validationFunction:()=>jt.kI.compose([jt.kI.minLength(9),jt.kI.maxLength(34),jt.kI.pattern("^[a-zA-Z0-9]{9,34}$")]),validationMessage:t=>t.minlength?"min_account_number":t.maxlength?"max_account_number":t.pattern?"Please enter a valid Account Number/IBAN":""}},this.trnNumberInput={placeHolder:"",label:"TRN",name:"trn",value:"",type:"number",maxLength:this.trnNumberLimit,validation:{name:"accountNumber",validationFunction:()=>jt.kI.compose([jt.kI.pattern(`^[0-9]{${this.trnNumberLimit}}$`)]),validationMessage:t=>t.pattern?"Please enter a valid TRN Number":""}},this.phoneCode={placeHolder:"select_dot",label:"code",name:"code",value:91,showImageFlag:!0,type:"select",selectedOption:{phoneCountryCode:"+91"},displayValue:"phoneCountryCode",fieldValue:"phoneCountryCode",options:[{label:"+90"},{label:"+971"},{label:"+977"}],validation:{name:"code",validationFunction:()=>jt.kI.compose([]),validationMessage:t=>t.required?"required_code":""}},this.contactNumberInput={placeHolder:"",label:"CONTACT NUMBER",name:"contactNumber",value:"",type:"number",validation:{name:"contactNumber",validationFunction:()=>jt.kI.compose([jt.kI.pattern("^[0-9]+[0-9 ,.'-]+$")]),validationMessage:t=>t.required?"Please enter mobile number":t.pattern?"Please enter valid mobile number":""}},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.hashPropTable={},this.IsPickedup=!1,this.isWorkProvider=1==(null===(p=this.route.snapshot)||void 0===p?void 0:p.queryParams.formType),this.navigationEndSubscription=this.router.events.subscribe(t=>{var e;t instanceof Ot.m2&&(this.isWorkProvider=1==(null===(e=this.route.snapshot)||void 0===e?void 0:e.queryParams.formType))}),this.commonService.reloadDetail.closed&&(this.commonService.reloadDetail=new Zt.X(null)),this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}onObservableLoad(t){var e,n,i,o,r,a;if(this.commonService.hideLoading(),t&&t&&t.length>0){if(!this.dataResponse.contactNumber)return this.phoneCode=Object.assign(Object.assign({},this.phoneCode),{selectedOption:{}}),void(this.contactNumberInput=Object.assign(Object.assign({},this.contactNumberInput),{value:null}));const s=null===(e=this.dataResponse.contactNumber)||void 0===e?void 0:e.substring(0,3),l=null===(n=this.dataResponse.contactNumber)||void 0===n?void 0:n.substring(0,4);let c="",d=t.filter(t=>t.phoneCountryCode===s);if(0===d.length?(c=null===(i=this.dataResponse.contactNumber)||void 0===i?void 0:i.substring(4,null===(o=this.dataResponse.contactNumber)||void 0===o?void 0:o.length),d=t.filter(t=>t.phoneCountryCode===l)):c=null===(r=this.dataResponse.contactNumber)||void 0===r?void 0:r.substring(3,null===(a=this.dataResponse.contactNumber)||void 0===a?void 0:a.length),d.length>0){const t=d[0],e=t.regExpression;this.phoneCode=Object.assign(Object.assign({},this.phoneCode),{selectedOption:t,mode:"complete"===this.repairStatus.toLowerCase()||this.commonService.isViewOnly||"paid"===this.repairStatus.toLowerCase()?"text":null}),this.dataResponse.code=t.phoneCountryCode,this.contactNumberInput=Object.assign(Object.assign({},this.contactNumberInput),{value:c}),this.phone&&(this.phone.updateCurrentValidation(e,!0,!0),this.phone.setDirty())}}}sendInvoice(){var t;const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.dialog.open(ho,{data:{repairId:e,domainId:this.domainId,invoiceId:this.invoiceGUID,isWorkProvider:this.isWorkProvider,workProviderValue:this.workProviderValue,customerValue:this.customerValue,dueDate:this.currentDueDate},backdropClass:"confirmation-popup-backdrop",autoFocus:!1})}handleSelectedOption(t){"send"===t.value.value?this.sendInvoice():this.downloadPDF()}updateFormType(t){this.isDataLoading=!0,this.isWorkProvider=1===t,this.invoiceList={},this.noDataFound=!0,this.getBookingRepairDetails()}onFormUpdateCustomer(t){var e;if("code"===t.name){const n=t.value.regExpression;this.dataResponse.code=t.value.phoneCountryCode,this.phoneCode=Object.assign(Object.assign({},this.phoneCode),{selectedOption:t.value}),null===(e=this.phone)||void 0===e||e.updateCurrentValidation(n,!1,!0)}}valueAscOrder(t,e){var n,i;const o={part:"1",labour:"2",paint:"3"};return o[null===(n=t.key)||void 0===n?void 0:n.toLowerCase()].localeCompare(o[null===(i=e.key)||void 0===i?void 0:i.toLowerCase()])}isInvoiceFormValid(){var t,e,n,i,o,r,a;this.saveButtonModel=(null===(t=this.invoiceIssuedDate.formControl)||void 0===t?void 0:t.valid)&&(null===(e=this.IfscCodeInput.formControl)||void 0===e?void 0:e.valid)&&(null===(n=this.payeeBankNameInput.formControl)||void 0===n?void 0:n.valid)&&(null===(i=this.payeeOrgNameInput.formControl)||void 0===i?void 0:i.valid)&&(null===(o=this.accountNumberInput.formControl)||void 0===o?void 0:o.valid)&&(null===(r=this.trnNumberInput.formControl)||void 0===r?void 0:r.valid)&&(null===(a=this.contactNumberInput.formControl)||void 0===a?void 0:a.valid)?Object.assign(Object.assign({},this.saveButtonModel),{type:"outline"}):Object.assign(Object.assign({},this.saveButtonModel),{type:"disabled-outline"})}getBookingRepairDetails(){var t;this.commonService.showLoading();const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.monitorServie.logEvent("getBookingRepairDetails",["InvoicesComponent","addenda-repair"],{repairGuid:e}),this.bookingService.getRepairDetailByGuid(e).subscribe({next:t=>(0,kt.mG)(this,void 0,void 0,function*(){var n,i,o,r,a,s,l,c,d,p;if(null==t?void 0:t.data){this.commonService.repairDetails.next(t.data),this.commonService.bookingId.next(t.data.repairNumber),this.pickupDate=t.data.pickUpDate,this.bookingOutDate=t.data.booking.endDate,this.IsPickedup=t.data.isPickedUp,this.repairStatus=t.data.status,this.domainId=t.data.domainId;const u=t.data.createdDate,h=Je(new Date).diff(Je(u),"minutes");this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{minDate:Je(u).toDate(),disabled:h<0,value:Je(u).toDate(),maxDate:h<0?Je(u).toDate():new Date}),this.dueDate=Object.assign(Object.assign({},this.dueDate),{minDate:Je(u).toDate()}),this.currentWorkProvider=t.data.customer.companyOrgType,this.currentWorkProviderType=t.data.customer.customerTypeName,this.customerValue=`${null===(i=null===(n=t.data)||void 0===n?void 0:n.customer)||void 0===i?void 0:i.firstName} ${null===(r=null===(o=t.data)||void 0===o?void 0:o.customer)||void 0===r?void 0:r.lastName}`,this.workProviderValue=(null===(s=null===(a=t.data)||void 0===a?void 0:a.customer)||void 0===s?void 0:s.companyName)||(null===(c=null===(l=t.data)||void 0===l?void 0:l.customer)||void 0===c?void 0:c.customerTypeName),null!==(null===(d=t.data.organizationDetail)||void 0===d?void 0:d.country)&&"india"===(null===(p=t.data.organizationDetail)||void 0===p?void 0:p.country.toLowerCase())&&(this.trnNumberInput=Object.assign(Object.assign({},this.trnNumberInput),{label:"TIN",validation:{name:"accountNumber",validationFunction:()=>jt.kI.compose([jt.kI.pattern(`^[0-9]{${this.trnNumberLimit}}$`)]),validationMessage:t=>t.pattern?"Please enter a valid TIN Number":""}})),this.invoiceService.invoicePerDetailProvider(e,this.isWorkProvider?1:2).subscribe({next:t=>{var e,n,i,o,r,a;if(!t)return this.commonService.hideLoading(),this.isDataLoading=!1,void(this.noDataFound=!0);const{orgName:s,logoUrl:l}=t.data;this.dataResponse=t.data,this.isDataLoading=!1,this.noDataFound=!1;let c=null;this.invoiceGUID=this.dataResponse.invoiceGuid,("paid"===(null===(n=null===(e=this.dataResponse)||void 0===e?void 0:e.paymentStatus)||void 0===n?void 0:n.toLowerCase())||this.commonService.isViewOnly||"complete"===(null===(o=null===(i=this.dataResponse)||void 0===i?void 0:i.paymentStatus)||void 0===o?void 0:o.toLowerCase())||"complete"===(null===(r=this.repairStatus)||void 0===r?void 0:r.toLowerCase()))&&(c="text"),this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{value:this.dataResponse.invoiceDate}),this.accountNumberInput=Object.assign(Object.assign({},this.accountNumberInput),{value:this.dataResponse.accountNumber,mode:c}),this.IfscCodeInput=Object.assign(Object.assign({},this.IfscCodeInput),{value:this.dataResponse.ifscCode,mode:c}),this.addressInput=Object.assign(Object.assign({},this.addressInput),{value:this.dataResponse.address,mode:c}),this.contactNumberInput=Object.assign(Object.assign({},this.contactNumberInput),{mode:c}),this.trnNumberInput=Object.assign(Object.assign({},this.trnNumberInput),{value:this.dataResponse.trn,mode:c}),this.payeeBankNameInput=Object.assign(Object.assign({},this.payeeBankNameInput),{value:this.dataResponse.bankname,mode:c}),this.payeeOrgNameInput=Object.assign(Object.assign({},this.payeeOrgNameInput),{value:this.dataResponse.workShopName,mode:c}),this.dueDate=Object.assign(Object.assign({},this.dueDate),{value:this.dataResponse.dueDate||"",mode:c}),this.currentDueDate=this.dataResponse.dueDate,this.invoiceNumberInput=Object.assign(Object.assign({},this.invoiceNumberInput),{value:this.dataResponse.invoiceNumber}),this.dataResponse.dueDate||(this.dataResponse.dueDate=new Date),this.phoneCode.observable||(this.phoneCode.observable=this.coreService.getPhoneNumber(),this.phoneCode.onObservableLoad=this.onObservableLoad.bind(this)),this.orgName=s,this.orgLogoUrl=l;const d=this.dataResponse.chargesDTO;this.charges=d,this.estimateSummary=null===(a=this.dataResponse)||void 0===a?void 0:a.chargeSummary,null==d||d.forEach(t=>{this.invoiceList[t.serviceType]||(this.invoiceList[t.serviceType]=[]),this.invoiceList[t.serviceType].push(t)}),this.orgLogoUrl||(this.orgImageLoading=!1),this.commonService.hideLoading()}})}else this.isDataLoading=!1,this.commonService.hideLoading()}),error:t=>{this.isDataLoading=!1,this.commonService.hideLoading(),this.monitorServie.logException(t,Qt._.Error)}})}calculateSub(t,e,n,i){return(t*this.maxPoint+e*this.maxPoint+n*this.maxPoint+i*this.maxPoint)/this.maxPoint}parseFloatingPoint(t,e){return this.hashPropTable[e]?t:(e&&(this.hashPropTable[e]=!0),t*this.maxPoint)}validateLabourTypes(t,e,n,i){return e===Lt.UW.Paint?"PaintLabour"===n.serviceSubType?(t.paintLabourHourSubTotal=this.parseFloatingPoint(t.paintLabourHourSubTotal,`paintLabourHourSubTotal_${i}`)+this.parseFloatingPoint(n.quantity),t.paintLabourAmountSubTotal=this.parseFloatingPoint(t.paintLabourAmountSubTotal,`paintLabourAmountSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.paintLabourSubTotal=this.parseFloatingPoint(t.paintLabourSubTotal,`paintLabourSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.paintLabourTotal=this.parseFloatingPoint(t.paintLabourTotal,`paintLabourSubTotal+${i}`)+this.parseFloatingPoint(n.total)*((100-parseFloat(t.paintLabourDiscountPercentage))/100)):(t.paintMaterialSubTotal=this.parseFloatingPoint(t.paintMaterialSubTotal,`paintMaterialSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.paintMaterialTotal=this.parseFloatingPoint(t.paintMaterialTotal,`paintMaterialTotal_${i}`)+this.parseFloatingPoint(n.total)*((100-parseFloat(t.paintMateriaDiscountPercentage))/100)):e===Lt.UW.Labour?(t.labourTotalBeforeDiscount=this.parseFloatingPoint(t.labourTotalBeforeDiscount,`labourTotalBeforeDiscount_${i}`)+this.parseFloatingPoint(n.total),t.labourAmountSubTotal=this.parseFloatingPoint(t.labourAmountSubTotal,`labourAmountSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.labourTotal=this.parseFloatingPoint(t.labourTotal,`labourTotal_${i}`)+this.parseFloatingPoint(n.total)*((100-parseFloat(t.labourTotalDiscountPercentage))/100),t.labourHourSubTotal=this.parseFloatingPoint(t.labourHourSubTotal,`labourHourSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.labourTimeHours=this.parseFloatingPoint(t.labourTimeHours,`labourTimeHours_${i}`)+this.parseFloatingPoint(n.quantity)):(t.partsTotalBeforeDiscount=this.parseFloatingPoint(t.partsTotalBeforeDiscount,`partsTotalBeforeDiscount_${i}`)+this.parseFloatingPoint(n.total),t.partsTotal=this.parseFloatingPoint(t.partsTotal,`partsTotal_${i}`)+this.parseFloatingPoint(n.total)*((100-parseFloat(t.partsTotalDiscountPercentage))/100),t.partsSubTotal=this.parseFloatingPoint(t.partsSubTotal,`partsSubTotal_${i}`)+this.parseFloatingPoint(n.total)),t}calculateSummary(t){return this.hashPropTable={},t.paintLabourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.paintLabourSubTotal=0,t.labourTotal=0,t.paintLabourTotal=0,t.labourTimeHours=0,t.labourTotalBeforeDiscount=0,t.paintMaterialTotal=0,t.paintMaterialSubTotal=0,t.labourAmountSubTotal=0,t.labourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.partsSubTotal=0,t.partsTotal=0,t.partsTotalBeforeDiscount=0,this.charges.forEach(e=>{const n=e.serviceType;(e.cost||"0"===e.cost)&&(e.cost=parseFloat(e.cost)),(e.quantity||"0"===e.quantity)&&(e.quantity=parseFloat(e.quantity)),(e.total||"0"===e.total)&&(e.total=parseFloat(e.total)),t=this.validateLabourTypes(t,n,e,e.recipient)}),t.paintLabourHourSubTotal=t.paintLabourHourSubTotal/this.maxPoint,t.paintLabourAmountSubTotal=t.paintLabourAmountSubTotal/this.maxPoint,t.paintLabourSubTotal=t.paintLabourSubTotal/this.maxPoint,t.labourTotal=t.labourTotal/this.maxPoint,t.paintLabourTotal=t.paintLabourTotal/this.maxPoint,t.labourTimeHours=t.labourTimeHours/this.maxPoint,t.labourTotalBeforeDiscount=t.labourTotalBeforeDiscount/this.maxPoint,t.paintMaterialTotal=t.paintMaterialTotal/this.maxPoint,t.paintMaterialSubTotal=t.paintMaterialSubTotal/this.maxPoint,t.labourAmountSubTotal=t.labourAmountSubTotal/this.maxPoint,t.labourHourSubTotal=t.labourHourSubTotal/this.maxPoint,t.paintLabourAmountSubTotal=t.paintLabourAmountSubTotal/this.maxPoint,t.partsSubTotal=t.partsSubTotal/this.maxPoint,t.partsTotal=t.partsTotal/this.maxPoint,t.partsTotalBeforeDiscount=t.partsTotalBeforeDiscount/this.maxPoint,t}ngOnInit(){this.noDataFound=!0,this.commonService.isViewOnly&&(this.dropdownApprovalModelFilter=Object.assign(Object.assign({},this.dropdownApprovalModelFilter),{options:[{dropdownItemIconMaterial:"download-arrow",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"download",label:this.translationService.instant("download")}]})),this.getBookingRepairDetails(),this.commonService.reloadDetail.subscribe({next:t=>{t&&this.dataResponse.dueAmount&&t!==this.dataResponse.dueAmount&&this.getBookingRepairDetails()}})}ngAfterViewInit(){setTimeout(()=>{this.isInvoiceFormValid()})}expandCollapse(t){this.isAllExpanded=t,this.isPartsExpanded=t,this.isPaintExpanded=t,this.isLabourExpanded=t}hideShowSection(t){"part"===(null==t?void 0:t.toLowerCase())?this.isPartsExpanded=!this.isPartsExpanded:"labour"===(null==t?void 0:t.toLowerCase())?this.isLabourExpanded=!this.isLabourExpanded:this.isPaintExpanded=!this.isPaintExpanded}getSection(t){return"part"===(null==t?void 0:t.toLowerCase())?this.isPartsExpanded:"labour"===(null==t?void 0:t.toLowerCase())?this.isLabourExpanded:this.isPaintExpanded}downloadPDF(){var t;const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id"),n=this.dataResponse.invoiceGuid;let i;this.invoiceGUID=n,this.commonService.showLoading(),i=this.currentDueDate?{parameters:[{name:"dueDate",value:Je(this.currentDueDate).format("YYYY-MM-DD")}]}:{parameters:[]},this.invoiceService.invoicePDF(e,n,i).subscribe({next:t=>{var e;const n=null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.url;n&&window.open(n,"_top"),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}saveInvoiceComponent(){this.dataResponse.contactNumber=this.dataResponse.code&&this.dataResponse.mobileNumber?this.dataResponse.code+this.dataResponse.mobileNumber:null;const t=Object.assign(Object.assign({},this.dataResponse),{ifscCode:this.dataResponse.ifscCode||null});this.commonService.showLoading(),this.invoiceService.saveInvoicePerDetail(t).subscribe({next:()=>{this.commonService.showInfoToast(1e3,"Invoice detail saved successfully"),this.currentDueDate=this.dataResponse.dueDate,this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}ngOnDestroy(){this.navigationEndSubscription.unsubscribe(),this.subs.forEach(t=>t.unsubscribe()),this.commonService.reloadDetail.unsubscribe()}openPaymentPopup(){var t;const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.dialog.open(so,{data:Object.assign({repairId:e,isWorkProvider:this.isWorkProvider},this.dataResponse),width:"80vw",height:"80vh",panelClass:"payment-panel",autoFocus:!1}).afterClosed().subscribe({next:t=>{t!==this.dataResponse.dueAmount&&this.getBookingRepairDetails()}})}closeRepair(){"repairinprogress"!=this.repairStatus.toLowerCase()&&"approved"!=this.repairStatus.toLowerCase()?"complete"!=this.repairStatus.toLowerCase()?null!==this.pickupDate&&this.IsPickedup?this.setRepairClose():this.commonService.openConfirmYesNoDialog(this.translateService.instant("confirm_to_continue"),this.translateService.instant("is_the_vehicle_picked_up")).afterClosed().subscribe(t=>{this.openSchedulerPopUpForPickUp(t?"pickedUp":"schedule")}):this.commonService.showInfoToast(1e3,this.translateService.instant("repair_is_closed")):this.commonService.showInfoToast(1e3,this.translateService.instant("repair_stages_are_not_completed"))}setRepairClose(){this.commonService.openConfirmYesNoDialog(this.translateService.instant("confirm_closing_repair"),this.translateService.instant("repair_close_confirm_message")).afterClosed().subscribe(t=>{t&&this.setRepairCloseInner()})}setRepairCloseInner(){var t;this.commonService.showLoading(),this.subs.push(this.OutboundService.setRepairStatusComplete(null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id")).subscribe({next:t=>{var e;this.repairStatus="Complete";const n="text";this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{value:this.dataResponse.invoiceDate}),this.accountNumberInput=Object.assign(Object.assign({},this.accountNumberInput),{value:this.dataResponse.accountNumber,mode:n}),this.IfscCodeInput=Object.assign(Object.assign({},this.IfscCodeInput),{value:this.dataResponse.ifscCode,mode:n}),this.addressInput=Object.assign(Object.assign({},this.addressInput),{value:this.dataResponse.address,mode:n}),this.contactNumberInput=Object.assign(Object.assign({},this.contactNumberInput),{mode:n}),this.trnNumberInput=Object.assign(Object.assign({},this.trnNumberInput),{value:this.dataResponse.trn,mode:n}),this.payeeBankNameInput=Object.assign(Object.assign({},this.payeeBankNameInput),{value:this.dataResponse.bankname,mode:n}),this.payeeOrgNameInput=Object.assign(Object.assign({},this.payeeOrgNameInput),{value:this.dataResponse.workShopName,mode:n}),this.dueDate=Object.assign(Object.assign({},this.dueDate),{value:this.dataResponse.dueDate||new Date,mode:n}),this.phoneCode=Object.assign(Object.assign({},this.phoneCode),{mode:n});const i=null===(e=this.route.parent)||void 0===e?void 0:e.snapshot.paramMap.get("id");this.bookingService.getRepairDetailByGuid(i).subscribe({next:t=>{(null==t?void 0:t.data)&&(this.commonService.repairDetails.next(t.data),this.commonService.bookingId.next(t.data.repairNumber))},error:t=>{this.monitorServie.logException(t,Qt._.Error)}}),this.commonService.showInfoToast(1e3,t.message),this.commonService.hideLoading()},error:t=>{this.commonService.hideLoading()}}))}openSchedulerPopUpForPickUp(t){this.dialog.open(co,{data:{repairID:"",pickupDate:null===this.pickupDate?this.bookingOutDate:this.pickupDate,callSource:t},panelClass:"SchedulePickupDate-modalbox",autoFocus:!1}).afterClosed().subscribe({next:e=>{if(!e)return;const n=Je.utc(e.PickUpDate.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z";this.setPickUpDateForRepair(n,t)}})}setPickUpDateForRepair(t,e){var n;this.commonService.showLoading(),this.subs.push(this.OutboundService.setPickupDate(null===(n=this.route.parent)||void 0===n?void 0:n.snapshot.paramMap.get("id"),t,"pickedUp"===e).subscribe({next:n=>{"pickedUp"===e&&(this.setRepairClose(),this.IsPickedup=!0),this.pickupDate=t,this.commonService.showInfoToast(1e3,n.message),this.commonService.hideLoading()},error:t=>{this.commonService.hideLoading()}}))}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(te.v),i.Y36(Ot.gz),i.Y36(Ot.F0),i.Y36(qt.uw),i.Y36(ke.p),i.Y36(yt.sK),i.Y36(go.Q),i.Y36(Ji),i.Y36($t.q),i.Y36(yt.sK),i.Y36(Et.M))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-generate-invoices"]],viewQuery:function(t,e){if(1&t&&(i.Gf(Mo,5),i.Gf(Oo,5)),2&t){let t;i.iGM(t=i.CRH())&&(e.print=t.first),i.iGM(t=i.CRH())&&(e.phone=t.first)}},features:[i._Bn([go.Q])],decls:19,vars:10,consts:[[1,"repair-invoice-wrapper"],[1,"invoice-back-btn"],[1,"no-border",3,"buttonModel"],[1,"status-pill-wrapper"],[1,"invoice-mode"],["class","btn-work",3,"ngClass","click",4,"ngIf"],["class","btn-driver",3,"ngClass","click",4,"ngIf"],[3,"class",4,"ngIf"],["class","generate-invoice-page-container","id","print-section",4,"ngIf"],["class","estimate-details-no-data-found",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["alt","addenda logo","src","assets/img/addenda-repair.png"],[1,"button-container"],["class","option-sender",3,"dropdownModel","selected",4,"ngIf"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel","click",4,"ngIf"],[1,"btn-work",3,"ngClass","click"],[1,"btn-driver",3,"ngClass","click"],["id","print-section",1,"generate-invoice-page-container"],[1,"repair-info"],[1,"repair-info-col-1"],[1,"org-image"],["alt","org logo",3,"src","load",4,"ngIf","ngIfElse"],["name",""],[3,"showLoading"],[1,"repair-detail"],[4,"ngIf"],[1,"repair-info-col-2"],[1,"col-6","invoice-date-input","outline",3,"ngClass","inputModel","controlOutput"],[1,"driver-fields-wrapper","col-6","invoice-date-input",3,"ngClass"],[1,"driver-field","driver-code-field","no-padding","outline",3,"ngClass","inputModel","controlOutput"],[1,"driver-field","no-padding","outline",3,"ngClass","inputModel","controlOutput"],["phone",""],["class","driver-field-content",3,"ngClass",4,"ngIf"],[1,"invoices-table-wrapper"],[1,"expand-collapse-btn","do-not-print"],[3,"click"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],["class","invoice-detail",4,"ngIf"],["alt","org logo",3,"src","load"],["class","org-name",4,"ngIf"],[1,"org-name"],[1,"col-6","invoice-date-input","outline",3,"inputModel","controlOutput"],[1,"col-6","invoice-date-input",3,"inputModel"],[1,"driver-field-content",3,"ngClass"],[1,"label-text"],[1,"driver-content-value"],[1,"table-parent"],[1,"expand-container",3,"click"],[1,"do-not-print"],[1,"small-heading"],["width","100%"],[4,"ngFor","ngForOf"],["align","right"],[1,"text-light"],["colspan","5"],[1,"invoice-detail"],[1,"invoice-col"],[1,"invoice-row","border-b"],[1,"invoice-row"],[1,"total-invoice-row"],[1,"total-invoice-row","no-border"],[1,"total-box"],["class","total-box",4,"ngIf"],[1,"estimate-details-no-data-found"],[1,"no-data-svg",3,"svgIcon"],[1,"no-data-text"],[1,"option-sender",3,"dropdownModel","selected"],[3,"buttonModel"],[3,"buttonModel","click"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i._UZ(2,"chq-button",2),i.qZA(),i.TgZ(3,"div",3),i.TgZ(4,"div",4),i.YNc(5,Co,3,7,"button",5),i.YNc(6,xo,3,7,"button",6),i.qZA(),i.YNc(7,Po,3,6,"span",7),i.qZA(),i.YNc(8,Yo,34,52,"div",8),i.YNc(9,zo,5,7,"div",9),i.TgZ(10,"div",10),i.TgZ(11,"div",11),i.TgZ(12,"div",12),i._UZ(13,"img",13),i.qZA(),i.qZA(),i.TgZ(14,"div",14),i.YNc(15,Ho,1,1,"chq-dropdown",15),i.YNc(16,Go,1,1,"chq-button",16),i.YNc(17,Qo,1,1,"chq-button",17),i.YNc(18,Vo,1,1,"chq-button",17),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.Q6J("buttonModel",e.backButtonModel),i.xp6(3),i.Q6J("ngIf","retail"!==(null==e.currentWorkProvider?null:e.currentWorkProvider.toLowerCase())||"retail"===(null==e.currentWorkProvider?null:e.currentWorkProvider.toLowerCase())&&"person"!==(null==e.currentWorkProviderType?null:e.currentWorkProviderType.toLowerCase())),i.xp6(1),i.Q6J("ngIf","retail"!==(null==e.currentWorkProvider?null:e.currentWorkProvider.toLowerCase())||"retail"===(null==e.currentWorkProvider?null:e.currentWorkProvider.toLowerCase())&&"person"===(null==e.currentWorkProviderType?null:e.currentWorkProviderType.toLowerCase())),i.xp6(1),i.Q6J("ngIf",!e.noDataFound&&(null==e.dataResponse?null:e.dataResponse.invoiceAmount)>0),i.xp6(1),i.Q6J("ngIf",!e.isDataLoading&&!e.noDataFound),i.xp6(1),i.Q6J("ngIf",e.noDataFound&&!e.isDataLoading),i.xp6(6),i.Q6J("ngIf",!e.noDataFound),i.xp6(1),i.Q6J("ngIf",!e.noDataFound&&"paid"!==(null==e.dataResponse||null==e.dataResponse.paymentStatus?null:e.dataResponse.paymentStatus.toLowerCase())&&!e.commonService.isViewOnly&&"complete"!==e.repairStatus.toLowerCase()),i.xp6(1),i.Q6J("ngIf",!e.noDataFound&&(null==e.dataResponse?null:e.dataResponse.invoiceAmount)>0),i.xp6(1),i.Q6J("ngIf",!e.commonService.isViewOnly&&"complete"!==e.repairStatus.toLowerCase()))},directives:[Ut.E,o.O5,o.mk,mo.h,Nt.D,o.sg,Mt.Hw,Ve.I],pipes:[yt.X$,o.Nd,fo,bo.j,_o],styles:['.repair-invoice-wrapper[_ngcontent-%COMP%]{background-color:#dbdde2;height:calc(100% - 315px);padding-top:50px}.repair-invoice-wrapper[_ngcontent-%COMP%]     .invoice-back-btn{display:flex;margin-bottom:.75rem;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]     .invoice-back-btn chq-button button.button-outline{border:none!important}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]{display:flex;font-size:1rem;font-style:normal;font-weight:400}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .btn-work[_ngcontent-%COMP%]{background:transparent;border-radius:.5rem 0 0 .5rem;border:1px solid var(--xa-draft);box-shadow:0 1px 3px rgba(96,108,128,.05)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .btn-driver[_ngcontent-%COMP%]{border:1px solid var(--xa-draft);background:transparent;border-radius:0 .5rem .5rem 0}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background:#4c6bd2;color:#fff}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;font-size:.625rem;font-style:normal;font-weight:700;padding:.5875rem 1rem;border-radius:.625rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:var(--xa-white)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]{margin-top:2.4rem;display:flex;flex-direction:column;grid-gap:1rem;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;padding-left:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(rgba(26, 34, 51, .4));font-size:.75rem;font-style:normal;font-weight:600;line-height:.875rem;cursor:pointer}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{padding-right:calc(5px + 1.5vw);align-items:center;display:flex;grid-gap:1rem;gap:1rem;justify-content:flex-end}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}.repair-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .org-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5.58956rem;height:4.86131rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]{display:flex;grid-gap:.5rem;gap:.5rem;flex-direction:column}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:700}.repair-info[_ngcontent-%COMP%]   .repair-info-col-2[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-2[_ngcontent-%COMP%]   chq-input.invoice-date-input[_ngcontent-%COMP%]{width:20.28494rem}.invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem;margin-bottom:1.5rem}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0 0;border-bottom:1px solid var(rgba(26, 34, 51, .1));background:#f1f2f6}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:12px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;background:#f1f2f6;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f1f2f6;font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}@media screen and (max-width: 864px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:105px;padding-top:5px;padding-bottom:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex-wrap:wrap}}@media screen and (max-width: 672px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:200px;padding-top:5px;padding-bottom:5px}}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-red[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-green[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-yellow[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}  chq-input.outline div.input-wrapper:not(.text-mode) input, [_nghost-%COMP%]     .dropdown{outline:1px solid var(--xa-tab-background)}  chq-input.outline div.input-wrapper.text-mode .dropdown{outline:none}  chq-input.outline div.input-wrapper.text-mode input{border:0px!important}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:white;margin:30px;justify-content:center;min-height:calc(100vh - 385px - (5px + 1.5vw + 48px + 1.6vw));border-radius:12px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:"Inter";font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}.all-border[_ngcontent-%COMP%]{border-radius:.5rem!important}.invoice-detail[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:3.43rem;gap:3.43rem;padding:10px;border-radius:.625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.0625rem;gap:1.0625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-weight:700}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:.8125rem;font-style:normal;font-weight:600}.invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.no-border[_ngcontent-%COMP%]{border:none!important}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-dp-light-gray)!important}.options-btn-container[_ngcontent-%COMP%]{position:relative}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]{position:absolute;bottom:45px;left:-5px;display:flex;align-items:stretch;padding:.625rem;flex-direction:column;grid-gap:.625rem;gap:.625rem;border-radius:.625rem;background:#fff}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;border:none;box-shadow:none!important;justify-content:flex-start;padding:.425rem .75rem;font-size:1rem;font-weight:400;display:flex;grid-gap:.5rem;gap:.5rem;cursor:pointer;-webkit-user-select:none;user-select:none}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.options-btn-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:1px solid var(--xa-light-gray)}.driver-field-content[_ngcontent-%COMP%]{display:none}@media print{.driver-field[_ngcontent-%COMP%]{display:none}  chq-input.outline div.input-wrapper .dropdown{outline:none}.driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;grid-gap:10px;gap:10px;height:34px}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}}.text-check[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{display:none}.text-mode.driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.text-mode.driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;grid-gap:10px;gap:10px;height:34px}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}.options-btn[_ngcontent-%COMP%]   .options-ico[_ngcontent-%COMP%]{font-size:.79638rem;width:.79638rem}.driver-fields-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{flex:1 1 120px;padding:0 10px;width:120px}@media (max-width: 850px){.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{padding:0 6px}}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.no-padding[_ngcontent-%COMP%]{padding:0}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.driver-code-field[_ngcontent-%COMP%]{min-width:120px;max-width:120px;padding:0 10px 0 0}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.basis-272[_ngcontent-%COMP%]{flex-basis:272px}']}),t})();function Wo(t,e){if(1&t&&(i.TgZ(0,"h5"),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.Oqu(i.lcZ(2,1,null==t?null:t.title))}}function Ko(t,e){if(1&t&&(i.TgZ(0,"tr",21),i.TgZ(1,"td",22),i.TgZ(2,"h6",15),i._uU(3),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(3),i.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}const Xo=function(t,e,n,i,o){return[t,e,n,i,o]};function tr(t,e){if(1&t&&(i.TgZ(0,"tbody"),i.YNc(1,Ko,4,1,"tr",20),i.TgZ(2,"tr"),i.TgZ(3,"td"),i._uU(4),i.qZA(),i.TgZ(5,"td"),i._uU(6),i.ALo(7,"xaCurrency"),i.qZA(),i.TgZ(8,"td",17),i._uU(9),i.ALo(10,"xaCurrency"),i.qZA(),i.qZA(),i.qZA()),2&t){const t=e.$implicit,n=e.index,o=i.oxw().$implicit,r=i.oxw(2).$implicit,a=i.oxw();i.xp6(1),i.Q6J("ngIf","Paint"===o.key.toString()&&(0===n||n>0&&t.serviceSubType!==r.invoiceList[o.key.toString()][n-1].serviceSubType)),i.xp6(3),i.Oqu(t.description),i.xp6(2),i.hij(" ",i.G7q(7,4,i.qbA(16,Xo,t.cost,a.i18n.currencySymbol,a.i18n.digitsInfo,a.i18n.locale,a.i18n.position))," "),i.xp6(3),i.hij(" ",i.G7q(10,10,i.qbA(22,Xo,t.total,a.i18n.currencySymbol,a.i18n.digitsInfo,a.i18n.locale,a.i18n.position))," ")}}function er(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"subtotal")),i.xp6(3),i.Oqu(i.G7q(6,4,i.qbA(10,Xo,t.partsSubTotal,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)))}}function nr(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"sundry_parts")),i.xp6(3),i.Oqu(i.G7q(6,4,i.qbA(10,Xo,t.sundryParts,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)))}}function ir(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"total_before_discount")),i.xp6(3),i.Oqu(i.G7q(6,4,i.qbA(10,Xo,t.partsTotalBeforeDiscount,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)))}}function or(t,e){if(1&t&&(i.TgZ(0,"div",26),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit;i.xp6(2),i.Oqu(i.lcZ(3,2,"discount_on_parts")),i.xp6(3),i.hij("",t.partsTotalDiscountPercentage,"%")}}function rr(t,e){if(1&t&&(i.TgZ(0,"div"),i.YNc(1,er,7,16,"div",23),i.YNc(2,nr,7,16,"div",23),i.YNc(3,ir,7,16,"div",23),i.YNc(4,or,6,4,"div",24),i.qZA()),2&t){const t=i.oxw(4);i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showParts),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showParts),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showParts),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showParts)}}function ar(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit;i.xp6(2),i.Oqu(i.lcZ(3,2,"paint_labour_time")),i.xp6(3),i.hij("",t.paintLabourTimeHour,"hrs")}}function sr(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"paint_labour_subtotal")),i.xp6(3),i.hij(" ",i.G7q(6,4,i.qbA(10,Xo,t.paintLabourHourSubTotal,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)),"")}}function lr(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit;i.xp6(2),i.Oqu(i.lcZ(3,2,"paint_labour_discount")),i.xp6(3),i.hij("",t.paintLabourDiscountPercentage,"%")}}function cr(t,e){if(1&t&&(i.TgZ(0,"div",29),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"labour_total")),i.xp6(3),i.hij(" ",i.G7q(6,4,i.qbA(10,Xo,t.paintLabourTotal,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)),"")}}function dr(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"material_subtotal")),i.xp6(3),i.Oqu(i.G7q(6,4,i.qbA(10,Xo,t.paintMaterialSubTotal,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)))}}function pr(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit;i.xp6(2),i.Oqu(i.lcZ(3,2,"material_discount")),i.xp6(3),i.hij("",t.paintMateriaDiscountPercentage,"%")}}function ur(t,e){if(1&t&&(i.TgZ(0,"div",30),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"material_total")),i.xp6(3),i.Oqu(i.G7q(6,4,i.qbA(10,Xo,t.paintMaterialTotal,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)))}}function hr(t,e){if(1&t&&(i.TgZ(0,"div"),i.YNc(1,ar,6,4,"div",23),i.YNc(2,sr,7,16,"div",23),i.YNc(3,lr,6,4,"div",23),i.YNc(4,cr,7,16,"div",27),i.YNc(5,dr,7,16,"div",23),i.YNc(6,pr,6,4,"div",23),i.YNc(7,ur,7,16,"div",28),i.qZA()),2&t){const t=i.oxw(4);i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showPaint),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showPaint),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showPaint),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showPaint),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showPaint),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showPaint),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showPaint)}}function gr(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"xaCurrency"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"labour_amount_subtotal")),i.xp6(3),i.hij(" ",i.G7q(6,4,i.qbA(10,Xo,t.labourHourSubTotal,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)),"")}}function mr(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit;i.xp6(2),i.Oqu(i.lcZ(3,2,"labour_hours")),i.xp6(3),i.hij("",t.labourTimeHours," hrs")}}function vr(t,e){if(1&t&&(i.TgZ(0,"div",25),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"number"),i.qZA(),i.qZA()),2&t){const t=i.oxw(4).$implicit,e=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,"labour_discount")),i.xp6(3),i.hij("",i.Dn7(6,4,t.labourTotalDiscountPercentage,e.digitInfo,e.locale),"%")}}function fr(t,e){if(1&t&&(i.TgZ(0,"div"),i.YNc(1,gr,7,16,"div",23),i.YNc(2,mr,6,4,"div",23),i.YNc(3,vr,7,8,"div",23),i.qZA()),2&t){const t=i.oxw(4);i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showLabour),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showLabour),i.xp6(1),i.Q6J("ngIf",t.summaryDialogData.showLabour)}}function br(t,e){if(1&t&&(i.TgZ(0,"div",13),i.TgZ(1,"span",14),i.TgZ(2,"h6",15),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.qZA(),i.ynx(5),i.TgZ(6,"table",16),i.TgZ(7,"thead"),i.TgZ(8,"tr"),i.TgZ(9,"td"),i._uU(10),i.ALo(11,"translate"),i.qZA(),i.TgZ(12,"td"),i._uU(13),i.ALo(14,"translate"),i.qZA(),i.TgZ(15,"td",17),i._uU(16),i.ALo(17,"translate"),i.qZA(),i.qZA(),i.qZA(),i.YNc(18,tr,11,28,"tbody",18),i.ALo(19,"orderBy"),i.qZA(),i.YNc(20,rr,5,4,"div",8),i.YNc(21,hr,8,7,"div",8),i.YNc(22,fr,4,3,"div",8),i.TgZ(23,"table",16),i.TgZ(24,"tfoot"),i.TgZ(25,"tr"),i.TgZ(26,"td"),i._uU(27),i.ALo(28,"translate"),i.qZA(),i.TgZ(29,"td",19),i._uU(30),i.ALo(31,"xaCurrency"),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.BQk(),i.qZA()),2&t){const t=e.$implicit,n=i.oxw(2).$implicit,o=i.oxw();i.xp6(3),i.Oqu(i.lcZ(4,12,t.key.toString().toLowerCase())),i.xp6(7),i.Oqu(i.lcZ(11,14,"description")),i.xp6(3),i.AsE("",i.lcZ(14,16,"price_unit"),"(",o.currencySymbol,")"),i.xp6(3),i.AsE("",i.lcZ(17,18,"total_price"),"(",o.currencySymbol,")"),i.xp6(2),i.Q6J("ngForOf",i.Dn7(19,20,n.invoiceList[t.key.toString()],"serviceSubtype","asc")),i.xp6(2),i.Q6J("ngIf","Part"===t.key.toString()),i.xp6(1),i.Q6J("ngIf","Paint"===t.key.toString()),i.xp6(1),i.Q6J("ngIf","Labour"===t.key.toString()),i.xp6(5),i.Oqu(i.lcZ(28,24,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),i.xp6(3),i.hij(" ",i.G7q(31,26,i.qbA(32,Xo,"Paint"===t.key.toString()?n.paintLabourTotal+n.paintMaterialTotal:"Labour"===t.key.toString()?n.labourTotal:n.partsTotal,o.i18n.currencySymbol,o.i18n.digitsInfo,o.i18n.locale,o.i18n.position))," ")}}function _r(t,e){if(1&t&&(i.TgZ(0,"div",10),i.YNc(1,br,32,38,"div",11),i.ALo(2,"keyvalue"),i.TgZ(3,"div",12),i.TgZ(4,"span"),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"span"),i._uU(8),i.ALo(9,"xaCurrency"),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw().$implicit,e=i.oxw();i.xp6(1),i.Q6J("ngForOf",i.xi3(2,3,t.invoiceList,e.valueAscOrder)),i.xp6(4),i.Oqu(i.lcZ(6,6,"total_cost")),i.xp6(3),i.Oqu(i.G7q(9,8,i.qbA(14,Xo,t.paintLabourTotal+t.paintMaterialTotal+t.labourTotal+t.partsTotal,e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position)))}}const Mr=function(t){return{"full-flex":t}};function Or(t,e){if(1&t&&(i.TgZ(0,"div",7),i.YNc(1,Wo,3,3,"h5",8),i.YNc(2,_r,10,20,"div",9),i.qZA()),2&t){const t=e.$implicit,n=i.oxw();i.Q6J("ngClass",i.VKq(3,Mr,1===(null==n.summaryDialogData.summaryData?null:n.summaryDialogData.summaryData.length))),i.xp6(1),i.Q6J("ngIf",null==t?null:t.title),i.xp6(1),i.Q6J("ngIf",null==t?null:t.title)}}let yr=(()=>{class t{constructor(t,e,n){this.summaryDialogData=t,this.commonService=e,this.dialogRef=n,this.digitInfo="",this.locale="",this.currencySymbol="",this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}valueAscOrder(t,e){var n,i;const o={part:"1",labour:"2",paint:"3"};return o[null===(n=t.key)||void 0===n?void 0:n.toLowerCase()].localeCompare(o[null===(i=e.key)||void 0===i?void 0:i.toLowerCase()])}onClose(){this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(qt.WI),i.Y36(te.v),i.Y36(qt.so))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-invoice-summary"]],decls:10,vars:5,consts:[[1,"invoice-wrapper"],[1,"summary-container"],[1,"invoice-title"],[1,"close-icon"],[1,"cross",3,"svgIcon","click"],[1,"invoice-detail"],["class","invoice-col",3,"ngClass",4,"ngFor","ngForOf"],[1,"invoice-col",3,"ngClass"],[4,"ngIf"],["class","invoices-table-container",4,"ngIf"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],[1,"total-box"],[1,"table-parent"],[1,"expand-container"],[1,"small-heading"],["width","100%"],[1,"last-td"],[4,"ngFor","ngForOf"],["align","right"],["class","sub-heading",4,"ngIf"],[1,"sub-heading"],["colspan","5"],["class","invoice-row border-b",4,"ngIf"],["class","invoice-row",4,"ngIf"],[1,"invoice-row","border-b"],[1,"invoice-row"],["class","total-invoice-row no-border total-border",4,"ngIf"],["class","total-invoice-row no-border",4,"ngIf"],[1,"total-invoice-row","no-border","total-border"],[1,"total-invoice-row","no-border"]],template:function(t,e){1&t&&(i.TgZ(0,"section",0),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"h3"),i._uU(4),i.ALo(5,"translate"),i.qZA(),i.TgZ(6,"div",3),i.TgZ(7,"mat-icon",4),i.NdJ("click",function(){return e.onClose()}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(8,"div",5),i.YNc(9,Or,3,5,"div",6),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(4),i.Oqu(i.lcZ(5,3,"invoices_summary")),i.xp6(3),i.Q6J("svgIcon","cross"),i.xp6(2),i.Q6J("ngForOf",e.summaryDialogData.summaryData))},directives:[Mt.Hw,o.sg,o.mk,o.O5],pipes:[yt.X$,o.Nd,bo.j,fo,o.JJ],styles:['.invoice-wrapper[_ngcontent-%COMP%]{min-height:100%;padding:1.88rem;background-color:#f1f2f6}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]{display:flex;grid-gap:2.1rem;gap:2.1rem;flex-direction:column;padding:.625rem}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;padding:.625rem;align-items:flex-start;border-radius:14.25rem;background:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f1f2f6;font-size:20px;width:20px;height:20px}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]{display:flex;padding:inherit;grid-gap:10px;gap:10px;border-radius:.625rem;background:var(--xa-white);max-width:100%;overflow-x:auto}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0;flex-basis:50%}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:inherit;padding:10px}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:600}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:14px;line-height:16px;font-weight:500;color:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:14px;line-height:16px;font-weight:400;color:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:500}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:inherit;margin:0;font-size:.875rem;font-style:normal;font-weight:600}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-dp-light-gray)}.close-icon[_ngcontent-%COMP%]{border-radius:50%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:6px;background:var(--xa-black);width:36px;height:36px}.close-icon[_ngcontent-%COMP%]   .cross[_ngcontent-%COMP%]{height:24px!important;width:24px!important;cursor:pointer;fill:var(--xa-white)!important}.full-flex[_ngcontent-%COMP%]{flex-basis:100%!important}.invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem;margin-bottom:1.5rem}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0 0;border-bottom:1px solid var(rgba(26, 34, 51, .1))}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px!important;line-height:14px!important;font-style:normal;font-weight:500!important}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:16px!important;line-height:20px!important;font-weight:400!important;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500!important;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray);font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700!important;font-size:16px!important;border-bottom:4px solid var(--xa-white)}@media screen and (max-width: 864px){  .payer-radio-btn.outline div.input-wrapper .radio{flex-direction:column}}@media screen and (max-width: 864px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:105px;padding-top:5px;padding-bottom:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex-wrap:wrap}}@media screen and (max-width: 672px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:200px;padding-top:5px;padding-bottom:5px}}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-red[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-green[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-yellow[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}  chq-input.outline div.input-wrapper:not(.text-mode) input{outline:1px solid black}  chq-input.outline div.input-wrapper.text-mode input{border:0px!important}.small-heading[_ngcontent-%COMP%]{font-size:14px!important;line-height:16px!important;font-weight:500!important}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:white;margin:30px;justify-content:center;min-height:calc(100vh - 385px - (5px + 1.5vw + 48px + 1.6vw));border-radius:12px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:"Inter";font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}.all-border[_ngcontent-%COMP%]{border-radius:.5rem!important}.invoice-detail[_ngcontent-%COMP%]{display:flex;flex-direction:row;grid-gap:10px;gap:10px;padding:0;border-radius:.625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:500}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:.8125rem;font-style:normal;font-weight:600}.invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.no-border[_ngcontent-%COMP%]{border:none!important}.last-td[_ngcontent-%COMP%]{text-align:end}.sub-heading[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray)}.total-border[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black)!important;border-bottom:1px solid var(--xa-black)!important}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-lighter-gray)}.options-btn-container[_ngcontent-%COMP%]{position:relative}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]{position:absolute;bottom:45px;left:-5px;display:flex;align-items:stretch;padding:.625rem;flex-direction:column;grid-gap:.625rem;gap:.625rem;border-radius:.625rem;background:#fff}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;border:none;box-shadow:none!important;justify-content:flex-start;padding:.425rem .75rem;font-size:1rem;font-weight:400;display:flex;grid-gap:.5rem;gap:.5rem;cursor:pointer;-webkit-user-select:none;user-select:none}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.options-btn-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:1px solid var(--xa-light-gray)}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}']}),t})();var Cr=n(87636),xr=n(14581),Pr=n(32085),wr=n(62728),Tr=n(65857),Dr=n(5490),Sr=n(22241),Ir=n.n(Sr);const kr=new i.OlP("SMOOTH_SCROLL_OPTIONS");let Zr=(()=>{class t{constructor(t,e,n){this._document=t,this._platform=e,this._onGoingScrolls=new Map,this._defaultOptions=Object.assign({duration:468,easing:{x1:.42,y1:0,x2:.58,y2:1}},n)}get _w(){return this._document.defaultView}get _now(){return this._w.performance&&this._w.performance.now?this._w.performance.now.bind(this._w.performance):Date.now}_scrollElement(t,e,n){t.scrollLeft=e,t.scrollTop=n}_getElement(t,e){return"string"==typeof t?(e||this._document).querySelector(t):(0,s.fI)(t)}_initSmoothScroll(t){return this._onGoingScrolls.has(t)&&this._onGoingScrolls.get(t).next(),this._onGoingScrolls.set(t,new c.x).get(t)}_isFinished(t,e,n){return t.currentX!==t.x||t.currentY!==t.y||(e.next(),n(),!1)}_interrupted(t,e){return(0,m.T)((0,xr.R)(t,"wheel",{passive:!0,capture:!0}),(0,xr.R)(t,"touchmove",{passive:!0,capture:!0}),e).pipe((0,_.q)(1))}_destroy(t,e){e.complete(),this._onGoingScrolls.delete(t)}_step(t){return new g.y(e=>{let n=(this._now()-t.startTime)/t.duration;n=n>1?1:n;const i=t.easing(n);t.currentX=t.startX+(t.x-t.startX)*i,t.currentY=t.startY+(t.y-t.startY)*i,this._scrollElement(t.scrollable,t.currentX,t.currentY),h.Z.schedule(()=>e.next(t))})}_applyScrollToOptions(t,e){if(!e.duration)return this._scrollElement(t,e.left,e.top),Promise.resolve();const n=this._initSmoothScroll(t),i={scrollable:t,startTime:this._now(),startX:t.scrollLeft,startY:t.scrollTop,x:null==e.left?t.scrollLeft:~~e.left,y:null==e.top?t.scrollTop:~~e.top,duration:e.duration,easing:Ir()(e.easing.x1,e.easing.y1,e.easing.x2,e.easing.y2)};return new Promise(e=>{(0,On.of)(null).pipe(function(t,e=1/0,n){return e=(e||0)<1?1/0:e,(0,Pr.e)((i,o)=>(0,wr.p)(i,o,t,e,void 0,!0,n))}(()=>this._step(i).pipe((0,Tr.o)(t=>this._isFinished(t,n,e)))),(0,v.R)(this._interrupted(t,n)),(0,Dr.x)(()=>this._destroy(t,n))).subscribe()})}scrollTo(t,e){if((0,o.NF)(this._platform)){const n=this._getElement(t),i="rtl"===getComputedStyle(n).direction,o=(0,a._i)(),r=Object.assign(Object.assign(Object.assign({},this._defaultOptions),e),{left:null==e.left?i?e.end:e.start:e.left,right:null==e.right?i?e.start:e.end:e.right});return null!=r.bottom&&(r.top=n.scrollHeight-n.clientHeight-r.bottom),i&&0!==o?(null!=r.left&&(r.right=n.scrollWidth-n.clientWidth-r.left),2===o?r.left=r.right:1===o&&(r.left=r.right?-r.right:r.right)):null!=r.right&&(r.left=n.scrollWidth-n.clientWidth-r.right),this._applyScrollToOptions(n,r)}return Promise.resolve()}scrollToElement(t,e,n={}){const i=this._getElement(t),o=this._getElement(e,i),r=Object.assign(Object.assign({},n),{left:o.offsetLeft+(n.left||0),top:o.offsetTop+(n.top||0)});return o?this.scrollTo(i,r):Promise.resolve()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o.K0),i.LFG(i.Lbi),i.LFG(kr,8))},t.\u0275prov=i.Yz7({factory:function(){return new t(i.LFG(o.K0),i.LFG(i.Lbi),i.LFG(kr,8))},token:t,providedIn:"root"}),t})(),Ar=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();var qr=n(9018);function Lr(...t){const e=t.length;if(0===e)throw new Error("list of properties cannot be empty.");return(0,b.U)(n=>{let i=n;for(let o=0;o<e;o++){const e=null==i?void 0:i[t[o]];if(void 0===e)return;i=e}return i})}var Er=n(79034),Rr=n(74970),jr=n(68048),Fr=n(83151),Nr=n(42147),Ur=n(65619);const Jr=["scrollbarY"],Yr=["scrollbarX"];function Br(t,e){if(1&t&&i._UZ(0,"scrollbar-x",null,4),2&t){const t=i.oxw(2);i.uIk("scrollable",t.state.isHorizontallyScrollable)("fit",t.state.verticalUsed)}}function zr(t,e){if(1&t&&i._UZ(0,"scrollbar-y",null,5),2&t){const t=i.oxw(2);i.uIk("scrollable",t.state.isVerticallyScrollable)("fit",t.state.horizontalUsed)}}function Hr(t,e){if(1&t&&(i.ynx(0),i.YNc(1,Br,2,2,"scrollbar-x",3),i.YNc(2,zr,2,2,"scrollbar-y",3),i.BQk()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngIf",t.state.horizontalUsed),i.xp6(1),i.Q6J("ngIf",t.state.verticalUsed)}}const Gr=["*"];function Qr(t){return(0,M.b)(()=>{t.onselectstart=()=>!1})}function Vr(t){return(0,M.b)(()=>{t.onselectstart=null})}function $r(){return(0,M.b)(t=>t.stopPropagation())}function Wr(t,e){return t.clientX>=e.left&&t.clientX<=e.left+e.width&&t.clientY>=e.top&&t.clientY<=e.top+e.height}let Kr=(()=>{class t{constructor(t){this.viewPort=t,this.nativeElement=t.nativeElement}get clientHeight(){return this.nativeElement.clientHeight}get clientWidth(){return this.nativeElement.clientWidth}get scrollHeight(){return this.nativeElement.scrollHeight}get scrollWidth(){return this.nativeElement.scrollWidth}get scrollTop(){return this.nativeElement.scrollTop}get scrollLeft(){return this.nativeElement.scrollLeft}get scrollMaxX(){return this.scrollWidth-this.clientWidth}get scrollMaxY(){return this.scrollHeight-this.clientHeight}get contentHeight(){var t;return(null===(t=this.contentWrapperElement)||void 0===t?void 0:t.clientHeight)||0}get contentWidth(){var t;return(null===(t=this.contentWrapperElement)||void 0===t?void 0:t.clientWidth)||0}activatePointerEvents(t,e){this.hovered=new g.y(n=>{const i=(0,xr.R)(this.nativeElement,"mousemove",{passive:!0}),o=t?i:i.pipe($r()),r=(0,xr.R)(this.nativeElement,"mouseleave").pipe((0,b.U)(()=>!1));(0,m.T)(o,r).pipe((0,M.b)(t=>n.next(t)),(0,v.R)(e)).subscribe()}),this.clicked=new g.y(t=>{const n=(0,xr.R)(this.nativeElement,"mousedown",{passive:!0}).pipe((0,M.b)(e=>t.next(e))),i=(0,xr.R)(this.nativeElement,"mouseup",{passive:!0}).pipe((0,M.b)(()=>t.next(!1)));n.pipe((0,O.w)(()=>i),(0,v.R)(e)).subscribe()})}setAsWrapper(){this.nativeElement.className="ng-native-scrollbar-hider ng-scroll-layer",this.nativeElement.firstElementChild&&(this.nativeElement.firstElementChild.className="ng-scroll-layer")}setAsViewport(t){this.nativeElement.className=`ng-native-scrollbar-hider ng-scroll-viewport ${t}`,this.nativeElement.firstElementChild&&(this.contentWrapperElement=this.nativeElement.firstElementChild,this.contentWrapperElement.classList.add("ng-scroll-content"))}scrollYTo(t){this.nativeElement.scrollTop=t}scrollXTo(t){this.nativeElement.scrollLeft=t}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq))},t.\u0275dir=i.lG2({type:t,selectors:[["","scrollViewport",""]]}),t})();const Xr=new i.OlP("NG_SCROLLBAR_OPTIONS"),ta={viewClass:"",trackClass:"",thumbClass:"",track:"vertical",appearance:"compact",visibility:"native",position:"native",pointerEventsMethod:"viewport",trackClickScrollDuration:300,minThumbSize:20,windowResizeDebounce:0,sensorDebounce:0,scrollAuditTime:0,viewportPropagateMouseMove:!0,autoHeightDisabled:!0,autoWidthDisabled:!0,sensorDisabled:!1,pointerEventsDisabled:!1};let ea=(()=>{class t{constructor(t){this.globalOptions=t?Object.assign(Object.assign({},ta),t):ta,this.rtlScrollAxisType=(0,a._i)()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Xr,8))},t.\u0275prov=i.Yz7({factory:function(){return new t(i.LFG(Xr,8))},token:t,providedIn:"root"}),t})(),na=(()=>{class t{constructor(t,e,n,o,r,a){this.el=t,this.zone=e,this.changeDetectorRef=n,this.dir=o,this.smoothScroll=r,this.manager=a,this._disabled=!1,this._sensorDisabled=this.manager.globalOptions.sensorDisabled,this._pointerEventsDisabled=this.manager.globalOptions.pointerEventsDisabled,this._autoHeightDisabled=this.manager.globalOptions.autoHeightDisabled,this._autoWidthDisabled=this.manager.globalOptions.autoWidthDisabled,this._viewportPropagateMouseMove=this.manager.globalOptions.viewportPropagateMouseMove,this.viewClass=this.manager.globalOptions.viewClass,this.trackClass=this.manager.globalOptions.trackClass,this.thumbClass=this.manager.globalOptions.thumbClass,this.minThumbSize=this.manager.globalOptions.minThumbSize,this.trackClickScrollDuration=this.manager.globalOptions.trackClickScrollDuration,this.pointerEventsMethod=this.manager.globalOptions.pointerEventsMethod,this.track=this.manager.globalOptions.track,this.visibility=this.manager.globalOptions.visibility,this.appearance=this.manager.globalOptions.appearance,this.position=this.manager.globalOptions.position,this.sensorDebounce=this.manager.globalOptions.sensorDebounce,this.scrollAuditTime=this.manager.globalOptions.scrollAuditTime,this.updated=new i.vpe,this.state={},this.destroyed=new c.x}get disabled(){return this._disabled}set disabled(t){this._disabled=(0,s.Ig)(t)}get sensorDisabled(){return this._sensorDisabled}set sensorDisabled(t){this._sensorDisabled=(0,s.Ig)(t)}get pointerEventsDisabled(){return this._pointerEventsDisabled}set pointerEventsDisabled(t){this._pointerEventsDisabled=(0,s.Ig)(t)}get viewportPropagateMouseMove(){return this._viewportPropagateMouseMove}set viewportPropagateMouseMove(t){this._viewportPropagateMouseMove=(0,s.Ig)(t)}get autoHeightDisabled(){return this._autoHeightDisabled}set autoHeightDisabled(t){this._autoHeightDisabled=(0,s.Ig)(t)}get autoWidthDisabled(){return this._autoWidthDisabled}set autoWidthDisabled(t){this._autoWidthDisabled=(0,s.Ig)(t)}get nativeElement(){return this.el.nativeElement}updateState(){let t=!1,e=!1,n=!1,i=!1;("all"===this.track||"vertical"===this.track)&&(n=this.viewport.scrollHeight>this.viewport.clientHeight,t="always"===this.visibility||n),("all"===this.track||"horizontal"===this.track)&&(i=this.viewport.scrollWidth>this.viewport.clientWidth,e="always"===this.visibility||i),this.setState({position:this.position,track:this.track,appearance:this.appearance,visibility:this.visibility,deactivated:this.disabled,dir:this.dir.value,pointerEventsMethod:this.pointerEventsMethod,verticalUsed:t,horizontalUsed:e,isVerticallyScrollable:n,isHorizontallyScrollable:i})}setState(t){this.state=Object.assign(Object.assign({},this.state),t),this.changeDetectorRef.detectChanges()}getScrolledByDirection(t){let e;return this.scrolled.pipe((0,M.b)(t=>e=t),Lr("target",t),(0,Er.G)(),(0,Rr.h)(([t,e])=>t!==e),(0,b.U)(()=>e))}setHovered(t){this.zone.run(()=>this.setState(Object.assign({},t)))}setDragging(t){this.zone.run(()=>this.setState(Object.assign({},t)))}setClicked(t){this.zone.run(()=>this.setState({scrollbarClicked:t}))}ngOnInit(){this.zone.runOutsideAngular(()=>{this.customViewPort?(this.viewport=this.customViewPort,this.defaultViewPort.setAsWrapper()):this.viewport=this.defaultViewPort,this.viewport.setAsViewport(this.viewClass);let t=(0,xr.R)(this.viewport.nativeElement,"scroll",{passive:!0});t=this.scrollAuditTime?t.pipe((0,jr.e)(this.scrollAuditTime)):t,this.scrolled=t.pipe((0,v.R)(this.destroyed)),this.verticalScrolled=this.getScrolledByDirection("scrollTop"),this.horizontalScrolled=this.getScrolledByDirection("scrollLeft")})}ngOnChanges(t){this.viewport&&this.update()}ngAfterViewInit(){this.update(),this.dir.change.pipe((0,M.b)(()=>this.update()),(0,v.R)(this.destroyed)).subscribe()}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}update(){this.autoHeightDisabled||this.updateHeight(),this.autoWidthDisabled||this.updateWidth(),this.updateState(),this.updated.next()}scrollTo(t){return this.smoothScroll.scrollTo(this.viewport.nativeElement,t)}scrollToElement(t,e){return this.smoothScroll.scrollToElement(this.viewport.nativeElement,t,e)}updateHeight(){this.nativeElement.style.height="standard"===this.appearance&&this.scrollbarX?`${this.viewport.contentHeight+this.scrollbarX.nativeElement.clientHeight}px`:`${this.viewport.contentHeight}px`}updateWidth(){this.nativeElement.style.width="standard"===this.appearance&&this.scrollbarY?`${this.viewport.contentWidth+this.scrollbarY.nativeElement.clientWidth}px`:`${this.viewport.contentWidth}px`}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(i.R0b),i.Y36(i.sBO),i.Y36(y.Is),i.Y36(Zr),i.Y36(ea))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-scrollbar"]],contentQueries:function(t,e,n){if(1&t&&i.Suo(n,Kr,7),2&t){let t;i.iGM(t=i.CRH())&&(e.customViewPort=t.first)}},viewQuery:function(t,e){if(1&t&&(i.Gf(Jr,5,i.SBq),i.Gf(Yr,5,i.SBq),i.Gf(Kr,7)),2&t){let t;i.iGM(t=i.CRH())&&(e.scrollbarY=t.first),i.iGM(t=i.CRH())&&(e.scrollbarX=t.first),i.iGM(t=i.CRH())&&(e.defaultViewPort=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&i.ekj("ng-scrollbar",!0)},inputs:{viewClass:"viewClass",trackClass:"trackClass",thumbClass:"thumbClass",minThumbSize:"minThumbSize",trackClickScrollDuration:"trackClickScrollDuration",pointerEventsMethod:"pointerEventsMethod",track:"track",visibility:"visibility",appearance:"appearance",position:"position",sensorDebounce:"sensorDebounce",scrollAuditTime:"scrollAuditTime",disabled:"disabled",sensorDisabled:"sensorDisabled",pointerEventsDisabled:"pointerEventsDisabled",viewportPropagateMouseMove:"viewportPropagateMouseMove",autoHeightDisabled:"autoHeightDisabled",autoWidthDisabled:"autoWidthDisabled"},outputs:{updated:"updated"},exportAs:["ngScrollbar"],features:[i.TTD],ngContentSelectors:Gr,decls:6,vars:4,consts:[[1,"ng-scrollbar-wrapper",3,"ngAttr"],[1,"ng-scroll-viewport-wrapper",3,"sensorDebounce","sensorDisabled","resizeSensor"],["scrollViewport","","hideNativeScrollbar",""],[4,"ngIf"],["scrollbarX",""],["scrollbarY",""]],template:function(t,e){1&t&&(i.F$t(),i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.NdJ("resizeSensor",function(){return e.update()}),i.TgZ(2,"div",2),i.TgZ(3,"div"),i.Hsn(4),i.qZA(),i.qZA(),i.qZA(),i.YNc(5,Hr,3,2,"ng-container",3),i.qZA()),2&t&&(i.Q6J("ngAttr",e.state),i.xp6(1),i.Q6J("sensorDebounce",e.sensorDebounce)("sensorDisabled",e.sensorDisabled),i.xp6(4),i.Q6J("ngIf",!e.disabled))},directives:function(){return[ra,aa,Kr,oa,o.O5,ma,ga]},styles:[".ng-scrollbar-measure{scrollbar-width:none;-ms-overflow-style:none}  .ng-scrollbar-measure::-webkit-scrollbar{display:none}[_nghost-%COMP%]{--scrollbar-border-radius:7px;--scrollbar-padding:4px;--scrollbar-track-color:transparent;--scrollbar-thumb-color:rgba(0,0,0,0.2);--scrollbar-thumb-hover-color:var(--scrollbar-thumb-color);--scrollbar-size:5px;--scrollbar-hover-size:var(--scrollbar-size);--scrollbar-overscroll-behavior:initial;--scrollbar-transition-duration:400ms;--scrollbar-transition-delay:800ms;--scrollbar-thumb-transition:height ease-out 150ms,width ease-out 150ms;--scrollbar-track-transition:height ease-out 150ms,width ease-out 150ms;display:block;position:relative;height:100%;max-height:100%;max-width:100%;box-sizing:content-box!important}[_nghost-%COMP%] > .ng-scrollbar-wrapper[_ngcontent-%COMP%]{--scrollbar-total-size:calc(var(--scrollbar-size) + var(--scrollbar-padding) * 2);--vertical-scrollbar-size:var(--scrollbar-size);--horizontal-scrollbar-size:var(--scrollbar-size);--vertical-scrollbar-total-size:calc(var(--vertical-scrollbar-size) + var(--scrollbar-padding) * 2);--horizontal-scrollbar-total-size:calc(var(--horizontal-scrollbar-size) + var(--scrollbar-padding) * 2)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalDragging=true][_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalHovered=true][_ngcontent-%COMP%]{--vertical-scrollbar-size:var(--scrollbar-hover-size);--vertical-scrollbar-total-size:calc(var(--vertical-scrollbar-size) + var(--scrollbar-padding) * 2);cursor:default}[_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalDragging=true][_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalHovered=true][_ngcontent-%COMP%]{--horizontal-scrollbar-size:var(--scrollbar-hover-size);--horizontal-scrollbar-total-size:calc(var(--horizontal-scrollbar-size) + var(--scrollbar-padding) * 2);cursor:default}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:0;right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:var(--scrollbar-total-size);right:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-left:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:var(--scrollbar-total-size);right:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-left:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:0;right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{top:0;bottom:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-bottom:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{top:var(--scrollbar-total-size);bottom:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-top:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport::-webkit-scrollbar, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-native-scrollbar-hider, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%]{bottom:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-native-scrollbar-hider, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%]{left:0;right:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][dir=rtl][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-native-scrollbar-hider, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][dir=rtl][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%]{right:0;left:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%] > .scrollbar-control[_ngcontent-%COMP%]{opacity:0;transition-property:opacity;transition-duration:var(--scrollbar-transition-duration);transition-delay:var(--scrollbar-transition-delay)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:active > .scrollbar-control[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:focus > .scrollbar-control[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:hover > .scrollbar-control[_ngcontent-%COMP%]{opacity:1;transition-duration:var(--scrollbar-transition-duration);transition-delay:0ms}[_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{overflow:auto}.ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{overflow:hidden}.ng-scroll-viewport[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch;contain:strict;will-change:scroll-position;overscroll-behavior:var(--scrollbar-overscroll-behavior)}  .ng-scroll-content{position:relative!important;display:inline-block;min-width:100%}.ng-scroll-layer[_ngcontent-%COMP%], .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], .ng-scrollbar-wrapper[_ngcontent-%COMP%],   .ng-scroll-viewport{position:absolute;left:0;right:0;top:0;bottom:0}",".ng-scrollbar-wrapper[pointerEventsMethod=viewport]>.scrollbar-control{pointer-events:none}  .ng-scrollbar-wrapper[horizontalDragging=true]>.ng-scroll-viewport-wrapper>*>*> .ng-scroll-viewport,   .ng-scrollbar-wrapper[horizontalDragging=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport,   .ng-scrollbar-wrapper[scrollbarClicked=true]>.ng-scroll-viewport-wrapper>*>*> .ng-scroll-viewport,   .ng-scrollbar-wrapper[scrollbarClicked=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport,   .ng-scrollbar-wrapper[verticalDragging=true]>.ng-scroll-viewport-wrapper>*>*> .ng-scroll-viewport,   .ng-scrollbar-wrapper[verticalDragging=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport{-webkit-user-select:none;-moz-user-select:none;user-select:none}  .ng-scrollbar-wrapper>.scrollbar-control{position:absolute;display:flex;justify-content:center;align-items:center;transition:var(--scrollbar-track-transition)}  .ng-scrollbar-wrapper>.scrollbar-control[scrollable=false] .ng-scrollbar-thumb{display:none}  .ng-scrollbar-track{height:100%;width:100%;z-index:1;border-radius:var(--scrollbar-border-radius);background-color:var(--scrollbar-track-color);overflow:hidden;transition:var(--scrollbar-track-transition);cursor:default}  .ng-scrollbar-thumb{box-sizing:border-box;position:relative;border-radius:inherit;background-color:var(--scrollbar-thumb-color);transform:translateZ(0);transition:var(--scrollbar-thumb-transition)}"],changeDetection:0}),t})(),ia=(()=>{class t{constructor(t,e,n){this.document=t,this.manager=e,this.platform=n,this._scrollbarSize=new Zt.X(this.getNativeScrollbarSize()),this.scrollbarSize=this._scrollbarSize.asObservable(),n.isBrowser&&(0,xr.R)(this.document.defaultView,"resize",{passive:!0}).pipe((0,Fr.b)(this.manager.globalOptions.windowResizeDebounce),(0,b.U)(()=>this.getNativeScrollbarSize()),(0,Nr.x)(),(0,M.b)(t=>this._scrollbarSize.next(t))).subscribe()}getNativeScrollbarSize(){if(!this.platform.isBrowser)return 0;if(this.platform.IOS)return 6;const t=this.document.createElement("div");t.className="ng-scrollbar-measure",t.style.left=0,t.style.overflow="scroll",t.style.position="fixed",t.style.top="-9999px",this.document.body.appendChild(t);const e=t.getBoundingClientRect().right;return this.document.body.removeChild(t),e}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o.K0),i.LFG(ea),i.LFG(a.t4))},t.\u0275prov=i.Yz7({factory:function(){return new t(i.LFG(o.K0),i.LFG(ea),i.LFG(a.t4))},token:t,providedIn:"root"}),t})(),oa=(()=>{class t{constructor(t,e,n){this.renderer=e,this.hideNativeScrollbar=n,this._subscriber=d.w0.EMPTY,this._subscriber=n.scrollbarSize.subscribe(e=>{this.renderer.setStyle(t.nativeElement,"--native-scrollbar-size",`-${e}px`,i.JOm.DashCase)})}ngOnDestroy(){this._subscriber.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(i.Qsj),i.Y36(ia))},t.\u0275dir=i.lG2({type:t,selectors:[["","hideNativeScrollbar",""]]}),t})(),ra=(()=>{class t{constructor(t){this.el=t}set ngAttr(t){for(const[e,n]of Object.entries(t))this.el.nativeElement.setAttribute(e,n)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngAttr",""]],inputs:{ngAttr:"ngAttr"}}),t})(),aa=(()=>{class t{constructor(t,e,n){if(this.zone=t,this.platform=e,this.scrollbar=n,this._disabled=!1,this._currentSubscription=null,this.event=new i.vpe,!n)throw new Error("[NgScrollbar Resize Sensor Directive]: Host element must be an NgScrollbar component.")}get debounce(){return this._debounce}set debounce(t){this._debounce=(0,s.su)(t),this._subscribe()}get disabled(){return this._disabled}set disabled(t){this._disabled=(0,s.Ig)(t),this._disabled?this._unsubscribe():this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this._disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){if(this._unsubscribe(),this.platform.isBrowser){const t=new g.y(t=>{this._resizeObserver=new ResizeObserver(e=>t.next(e)),this._resizeObserver.observe(this.scrollbar.viewport.nativeElement),this.scrollbar.viewport.contentWrapperElement&&this._resizeObserver.observe(this.scrollbar.viewport.contentWrapperElement)});this.zone.runOutsideAngular(()=>{this._currentSubscription=(this._debounce?t.pipe((0,Fr.b)(this._debounce)):t).subscribe(this.event)})}}_unsubscribe(){var t,e;null===(t=this._resizeObserver)||void 0===t||t.disconnect(),null===(e=this._currentSubscription)||void 0===e||e.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.R0b),i.Y36(a.t4),i.Y36(na))},t.\u0275dir=i.lG2({type:t,selectors:[["","resizeSensor",""]],inputs:{debounce:["sensorDebounce","debounce"],disabled:["sensorDisabled","disabled"]},outputs:{event:"resizeSensor"}}),t})(),sa=(()=>{class t{constructor(t,e,n){this.cmp=t,this.trackElement=e,this.document=n}get clicked(){const t=(0,xr.R)(this.trackElement,"mousedown",{passive:!0}).pipe($r(),Qr(this.document)),e=(0,xr.R)(this.document,"mouseup",{passive:!0}).pipe($r(),Vr(this.document),(0,O.w)(()=>qr.E));return(0,m.T)(t,e)}get clientRect(){return this.trackElement.getBoundingClientRect()}onTrackClicked(t,e,n){return(0,On.of)(t).pipe(Lr(this.pageProperty),(0,b.U)(t=>(t-this.offset-e/2)/this.size*n),(0,M.b)(t=>{this.cmp.scrollTo(Object.assign(Object.assign({},this.mapToScrollToOption(t)),{duration:(0,s.su)(this.cmp.trackClickScrollDuration)}))}))}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(na),i.Y36(HTMLElement),i.Y36(void 0))},t.\u0275dir=i.lG2({type:t}),t})(),la=(()=>{class t{constructor(t,e,n,i){this.cmp=t,this.track=e,this.thumbElement=n,this.document=i,this._dragging=new c.x,this.dragging=this._dragging.pipe((0,Nr.x)())}get trackMax(){return this.track.size-this.size}get clientRect(){return this.thumbElement.getBoundingClientRect()}get clicked(){return(0,xr.R)(this.thumbElement,"mousedown",{passive:!0}).pipe($r())}update(){const t=function(t,e,n){return Math.max(~~(t/e*t),n)}(this.track.size,this.viewportScrollSize,this.cmp.minThumbSize),e=function(t,e,n){return t*n/e}(this.viewportScrollOffset,this.viewportScrollMax,this.trackMax);h.Z.schedule(()=>this.updateStyles(this.handleDirection(e,this.trackMax),t))}dragged(t){let e,n;const i=(0,On.of)(t).pipe(Qr(this.document),(0,M.b)(()=>{e=this.trackMax,n=this.viewportScrollMax,this.setDragging(!0)})),o=(0,xr.R)(this.document,"mousemove",{capture:!0,passive:!0}).pipe($r()),r=(0,xr.R)(this.document,"mouseup",{capture:!0}).pipe($r(),Vr(this.document),(0,M.b)(()=>this.setDragging(!1)));return i.pipe(Lr(this.pageProperty),(0,b.U)(t=>t-this.dragStartOffset),(0,Ur.z)(t=>o.pipe(Lr(this.clientProperty),(0,b.U)(t=>t-this.track.offset),(0,b.U)(i=>n*(i-t)/e),(0,b.U)(t=>this.handleDrag(t,n)),(0,M.b)(t=>this.scrollTo(t)),(0,v.R)(r))))}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(na),i.Y36(sa),i.Y36(HTMLElement),i.Y36(void 0))},t.\u0275dir=i.lG2({type:t,outputs:{dragging:"dragging"}}),t})(),ca=(()=>{class t extends sa{constructor(t,e,n){super(t,e.nativeElement,n),this.cmp=t,this.document=n}get pageProperty(){return"pageX"}get offset(){return this.clientRect.left}get size(){return this.trackElement.clientWidth}mapToScrollToOption(t){return{left:t}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(na),i.Y36(i.SBq),i.Y36(o.K0))},t.\u0275dir=i.lG2({type:t,selectors:[["","scrollbarTrackX",""]],features:[i.qOj]}),t})(),da=(()=>{class t extends sa{constructor(t,e,n){super(t,e.nativeElement,n),this.cmp=t,this.document=n}get pageProperty(){return"pageY"}get offset(){return this.clientRect.top}get size(){return this.trackElement.clientHeight}mapToScrollToOption(t){return{top:t}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(na),i.Y36(i.SBq),i.Y36(o.K0))},t.\u0275dir=i.lG2({type:t,selectors:[["","scrollbarTrackY",""]],features:[i.qOj]}),t})(),pa=(()=>{class t extends la{constructor(t,e,n,i,o){super(t,e,n.nativeElement,i),this.cmp=t,this.track=e,this.element=n,this.document=i,this.dir=o}get clientProperty(){return"clientX"}get pageProperty(){return"pageX"}get viewportScrollSize(){return this.cmp.viewport.scrollWidth}get viewportScrollOffset(){return this.cmp.viewport.scrollLeft}get viewportScrollMax(){return this.cmp.viewport.scrollMaxX}get dragStartOffset(){return this.clientRect.left+this.document.defaultView.pageXOffset||0}get size(){return this.thumbElement.clientWidth}updateStyles(t,e){this.thumbElement.style.width=`${e}px`,this.thumbElement.style.transform=`translate3d(${t}px, 0, 0)`}handleDrag(t,e){if("rtl"===this.dir.value){if(1===this.cmp.manager.rtlScrollAxisType)return t-e;if(2===this.cmp.manager.rtlScrollAxisType)return e-t}return t}handleDirection(t,e){if("rtl"===this.dir.value){if(2===this.cmp.manager.rtlScrollAxisType)return-t;if(0===this.cmp.manager.rtlScrollAxisType)return t-e}return t}setDragging(t){this.cmp.setDragging({horizontalDragging:t})}scrollTo(t){this.cmp.viewport.scrollXTo(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(na),i.Y36(ca),i.Y36(i.SBq),i.Y36(o.K0),i.Y36(y.Is))},t.\u0275dir=i.lG2({type:t,selectors:[["","scrollbarThumbX",""]],features:[i.qOj]}),t})(),ua=(()=>{class t extends la{constructor(t,e,n,i){super(t,e,n.nativeElement,i),this.cmp=t,this.track=e,this.element=n,this.document=i}get pageProperty(){return"pageY"}get viewportScrollSize(){return this.cmp.viewport.scrollHeight}get viewportScrollOffset(){return this.cmp.viewport.scrollTop}get viewportScrollMax(){return this.cmp.viewport.scrollMaxY}get clientProperty(){return"clientY"}get dragStartOffset(){return this.clientRect.top+this.document.defaultView.pageYOffset||0}get size(){return this.thumbElement.clientHeight}updateStyles(t,e){this.thumbElement.style.height=`${e}px`,this.thumbElement.style.transform=`translate3d(0px, ${t}px, 0)`}handleDrag(t){return t}handleDirection(t){return t}setDragging(t){this.cmp.setDragging({verticalDragging:t})}scrollTo(t){this.cmp.viewport.scrollYTo(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(na),i.Y36(da),i.Y36(i.SBq),i.Y36(o.K0))},t.\u0275dir=i.lG2({type:t,selectors:[["","scrollbarThumbY",""]],features:[i.qOj]}),t})(),ha=(()=>{class t{constructor(t,e,n,i,o){this.el=t,this.cmp=e,this.platform=n,this.document=i,this.zone=o,this.destroyed=new c.x}activatePointerEvents(){let t,e,n;return"viewport"===this.cmp.pointerEventsMethod?(this.viewportTrackClicked=new c.x,this.viewportThumbClicked=new c.x,this.cmp.viewport.activatePointerEvents(this.cmp.viewportPropagateMouseMove,this.destroyed),t=this.viewportThumbClicked,e=this.viewportTrackClicked,n=this.cmp.viewport.hovered.pipe((0,b.U)(t=>Wr(t,this.el.getBoundingClientRect())),(0,Nr.x)(),(0,M.b)(t=>this.document.onselectstart=t?()=>!1:null)),this.cmp.viewport.clicked.pipe((0,M.b)(t=>{t?Wr(t,this.thumb.clientRect)?this.viewportThumbClicked.next(t):Wr(t,this.track.clientRect)&&(this.cmp.setClicked(!0),this.viewportTrackClicked.next(t)):this.cmp.setClicked(!1)}),(0,v.R)(this.destroyed)).subscribe()):(t=this.thumb.clicked,e=this.track.clicked,n=this.hovered),(0,m.T)(n.pipe((0,M.b)(t=>this.setHovered(t))),t.pipe((0,O.w)(t=>this.thumb.dragged(t))),e.pipe((0,O.w)(t=>this.track.onTrackClicked(t,this.thumb.size,this.viewportScrollSize))))}get hovered(){const t=(0,xr.R)(this.el,"mouseenter",{passive:!0}).pipe($r(),(0,b.U)(()=>!0)),e=(0,xr.R)(this.el,"mouseleave",{passive:!0}).pipe($r(),(0,b.U)(()=>!1));return(0,m.T)(t,e)}ngOnInit(){this.zone.runOutsideAngular(()=>{!(this.platform.IOS||this.platform.ANDROID)&&!this.cmp.pointerEventsDisabled&&this.activatePointerEvents().pipe((0,v.R)(this.destroyed)).subscribe(),(0,m.T)(this.cmp.scrolled,this.cmp.updated).pipe((0,M.b)(()=>{var t;return null===(t=this.thumb)||void 0===t?void 0:t.update()}),(0,v.R)(this.destroyed)).subscribe()})}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete(),this.viewportThumbClicked&&this.viewportTrackClicked&&(this.viewportTrackClicked.complete(),this.viewportThumbClicked.complete())}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(HTMLElement),i.Y36(na),i.Y36(a.t4),i.Y36(void 0),i.Y36(i.R0b))},t.\u0275dir=i.lG2({type:t}),t})(),ga=(()=>{class t extends ha{constructor(t,e,n,i,o){super(t.nativeElement,e,n,i,o),this.cmp=e,this.platform=n,this.document=i,this.zone=o}get viewportScrollSize(){return this.cmp.viewport.scrollHeight}setHovered(t){this.cmp.setHovered({verticalHovered:t})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(na),i.Y36(a.t4),i.Y36(o.K0),i.Y36(i.R0b))},t.\u0275cmp=i.Xpm({type:t,selectors:[["scrollbar-y"]],viewQuery:function(t,e){if(1&t&&(i.Gf(da,7),i.Gf(ua,7)),2&t){let t;i.iGM(t=i.CRH())&&(e.track=t.first),i.iGM(t=i.CRH())&&(e.thumb=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&i.ekj("scrollbar-control",!0)},features:[i.qOj],decls:2,vars:6,consts:[["scrollbarTrackY",""],["scrollbarThumbY",""]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i._UZ(1,"div",1),i.qZA()),2&t&&(i.Gre("ng-scrollbar-track ",e.cmp.trackClass,""),i.xp6(1),i.Gre("ng-scrollbar-thumb ",e.cmp.thumbClass,""))},directives:[da,ua],styles:[".ng-scrollbar-wrapper>scrollbar-y.scrollbar-control{width:var(--vertical-scrollbar-total-size)}  .ng-scrollbar-wrapper>scrollbar-y.scrollbar-control>.ng-scrollbar-track{width:var(--vertical-scrollbar-size);height:calc(100% - var(--scrollbar-padding) * 2)}  .ng-scrollbar-wrapper>scrollbar-y.scrollbar-control>.ng-scrollbar-track>.ng-scrollbar-thumb{height:0;width:100%}  .ng-scrollbar-wrapper[verticalDragging=true]>scrollbar-y.scrollbar-control .ng-scrollbar-thumb,   .ng-scrollbar-wrapper[verticalHovered=true]>scrollbar-y.scrollbar-control .ng-scrollbar-thumb{background-color:var(--scrollbar-thumb-hover-color)}  .ng-scrollbar-wrapper[deactivated=false]>scrollbar-y.scrollbar-control{top:0;bottom:0}  .ng-scrollbar-wrapper[deactivated=false][dir=ltr]>scrollbar-y.scrollbar-control{right:0;left:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=ltr][position=invertAll]>scrollbar-y.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][dir=ltr][position=invertY]>scrollbar-y.scrollbar-control{left:0;right:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=rtl]>scrollbar-y.scrollbar-control{left:0;right:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=rtl][position=invertAll]>scrollbar-y.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][dir=rtl][position=invertY]>scrollbar-y.scrollbar-control{left:unset;right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all]>scrollbar-y.scrollbar-control[fit=true]{bottom:var(--scrollbar-total-size);top:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][position=invertAll]>scrollbar-y.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][position=invertX]>scrollbar-y.scrollbar-control[fit=true]{top:var(--scrollbar-total-size);bottom:0}"],changeDetection:0}),t})(),ma=(()=>{class t extends ha{constructor(t,e,n,i,o){super(t.nativeElement,e,n,i,o),this.cmp=e,this.platform=n,this.document=i,this.zone=o}get viewportScrollSize(){return this.cmp.viewport.scrollWidth}setHovered(t){this.cmp.setHovered({horizontalHovered:t})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(na),i.Y36(a.t4),i.Y36(o.K0),i.Y36(i.R0b))},t.\u0275cmp=i.Xpm({type:t,selectors:[["scrollbar-x"]],viewQuery:function(t,e){if(1&t&&(i.Gf(ca,7),i.Gf(pa,7)),2&t){let t;i.iGM(t=i.CRH())&&(e.track=t.first),i.iGM(t=i.CRH())&&(e.thumb=t.first)}},hostVars:2,hostBindings:function(t,e){2&t&&i.ekj("scrollbar-control",!0)},features:[i.qOj],decls:2,vars:6,consts:[["scrollbarTrackX",""],["scrollbarThumbX",""]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i._UZ(1,"div",1),i.qZA()),2&t&&(i.Gre("ng-scrollbar-track ",e.cmp.trackClass,""),i.xp6(1),i.Gre("ng-scrollbar-thumb ",e.cmp.thumbClass,""))},directives:[ca,pa],styles:[".ng-scrollbar-wrapper>scrollbar-x.scrollbar-control{height:var(--horizontal-scrollbar-total-size)}  .ng-scrollbar-wrapper>scrollbar-x.scrollbar-control>.ng-scrollbar-track{height:var(--horizontal-scrollbar-size);width:calc(100% - var(--scrollbar-padding) * 2)}  .ng-scrollbar-wrapper>scrollbar-x.scrollbar-control>.ng-scrollbar-track>.ng-scrollbar-thumb{width:0;height:100%}  .ng-scrollbar-wrapper[horizontalDragging=true]>scrollbar-x.scrollbar-control .ng-scrollbar-thumb,   .ng-scrollbar-wrapper[horizontalHovered=true]>scrollbar-x.scrollbar-control .ng-scrollbar-thumb{background-color:var(--scrollbar-thumb-hover-color)}  .ng-scrollbar-wrapper[position=invertAll]>scrollbar-x.scrollbar-control,   .ng-scrollbar-wrapper[position=invertX]>scrollbar-x.scrollbar-control{top:0;bottom:unset}  .ng-scrollbar-wrapper[deactivated=false]>scrollbar-x.scrollbar-control{left:0;right:0;bottom:0;top:unset}  .ng-scrollbar-wrapper[deactivated=false][position=invertAll]>scrollbar-x.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][position=invertX]>scrollbar-x.scrollbar-control{top:0;bottom:unset}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr]>scrollbar-x.scrollbar-control[fit=true]{right:var(--scrollbar-total-size);left:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr][position=invertAll]>scrollbar-x.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr][position=invertY]>scrollbar-x.scrollbar-control[fit=true]{left:var(--scrollbar-total-size);right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl]>scrollbar-x.scrollbar-control[fit=true]{left:var(--scrollbar-total-size);right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl][position=invertAll]>scrollbar-x.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl][position=invertY]>scrollbar-x.scrollbar-control[fit=true]{right:var(--scrollbar-total-size);left:0}"],changeDetection:0}),t})(),va=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Xr,useValue:e}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[o.ez,y.vT,Cr.eL,a.ud,Ar]]}),t})();function fa(t,e){if(1&t&&(i.TgZ(0,"span"),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&t){const t=i.oxw(2);i.Gre("status-pill status-",null==t.paymentStatus?null:t.paymentStatus.replace(" ","").toLowerCase(),""),i.xp6(1),i.Oqu(i.lcZ(2,4,t.paymentStatusMapper[null==t.paymentStatus?null:t.paymentStatus.toLowerCase()]))}}function ba(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"img",26),i.NdJ("load",function(){return i.CHM(t),i.oxw(2).orgImageLoading=!1}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("src",t.orgLogoUrl,i.LSH)}}function _a(t,e){if(1&t&&(i.TgZ(0,"label",28),i._uU(1),i.qZA()),2&t){const t=i.oxw(3);i.xp6(1),i.Oqu(t.orgName)}}function Ma(t,e){if(1&t&&i.YNc(0,_a,2,1,"label",27),2&t){const t=i.oxw(2);i.Q6J("ngIf",t.orgName)}}function Oa(t,e){if(1&t&&(i.TgZ(0,"tr"),i.TgZ(1,"td",44),i.TgZ(2,"h6",31),i._uU(3),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(3),i.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}function ya(t,e){if(1&t&&(i.TgZ(0,"span",45),i._uU(1),i.qZA()),2&t){const t=i.oxw(5);i.xp6(1),i.hij(" ","person"===(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase())?t.customerValue:t.workProviderValue," ")}}function Ca(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-input",46),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw().$implicit,o=i.oxw(4);return n.recipient=e.value===o.workProviderValue?1:2,o.isAllocationChanged()}),i.qZA()}if(2&t){const t=i.oxw().index,e=i.oxw(2).$implicit,n=i.oxw(2);i.Q6J("inputModel",n.radioList[e.key][t])}}const xa=function(t,e,n,i,o){return[t,e,n,i,o]},Pa=function(t){return{"provide-td":t}};function wa(t,e){if(1&t&&(i.TgZ(0,"tbody"),i.YNc(1,Oa,4,1,"tr",39),i.TgZ(2,"tr"),i.TgZ(3,"td"),i._uU(4),i.qZA(),i.TgZ(5,"td"),i._uU(6),i.qZA(),i.TgZ(7,"td",40),i._uU(8),i.qZA(),i.TgZ(9,"td"),i._uU(10),i.ALo(11,"xaCurrency"),i.qZA(),i.TgZ(12,"td"),i._uU(13),i.ALo(14,"xaCurrency"),i.qZA(),i.TgZ(15,"td",41),i.YNc(16,ya,2,1,"span",42),i.YNc(17,Ca,1,1,"chq-input",43),i.qZA(),i.qZA(),i.qZA()),2&t){const t=e.$implicit,n=e.index,o=i.oxw(2).$implicit,r=i.oxw(2);i.xp6(1),i.Q6J("ngIf","Paint"===o.key&&(0===n||n>0&&t.serviceSubType!==r.invoiceList[o.key][n-1].serviceSubType)),i.xp6(3),i.Oqu(t.description),i.xp6(2),i.Oqu(t.code),i.xp6(2),i.Oqu(t.quantity),i.xp6(2),i.hij(" ",i.G7q(11,9,i.qbA(21,xa,t.cost,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," "),i.xp6(3),i.hij(" ",i.G7q(14,15,i.qbA(27,xa,t.total,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," "),i.xp6(2),i.Q6J("ngClass",i.VKq(33,Pa,"retail"===(null==r.currentWorkProvider?null:r.currentWorkProvider.toLowerCase()))),i.xp6(1),i.Q6J("ngIf","retail"===(null==r.currentWorkProvider?null:r.currentWorkProvider.toLowerCase())),i.xp6(1),i.Q6J("ngIf","retail"!==(null==r.currentWorkProvider?null:r.currentWorkProvider.toLowerCase()))}}function Ta(t,e){if(1&t&&(i.TgZ(0,"ng-scrollbar",33),i.TgZ(1,"table",34),i.TgZ(2,"thead"),i.TgZ(3,"tr"),i.TgZ(4,"td"),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.TgZ(7,"td"),i._uU(8),i.ALo(9,"translate"),i.qZA(),i.TgZ(10,"td"),i._uU(11),i.ALo(12,"translate"),i.qZA(),i.TgZ(13,"td"),i._uU(14),i.ALo(15,"translate"),i.qZA(),i.TgZ(16,"td"),i._uU(17),i.ALo(18,"translate"),i.qZA(),i.TgZ(19,"td",35),i._uU(20),i.ALo(21,"translate"),i.qZA(),i.qZA(),i.qZA(),i.YNc(22,wa,18,35,"tbody",36),i.ALo(23,"orderBy"),i.TgZ(24,"tfoot"),i.TgZ(25,"tr"),i.TgZ(26,"td",37),i._uU(27),i.ALo(28,"translate"),i.qZA(),i.TgZ(29,"td",38),i._uU(30),i.ALo(31,"xaCurrency"),i.ALo(32,"sum"),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw().$implicit,e=i.oxw(2);i.Q6J("disabled",!e.isiOS)("track","horizontal")("autoHeightDisabled",!1),i.xp6(5),i.Oqu(i.lcZ(6,14,"description")),i.xp6(3),i.Oqu(i.lcZ(9,16,"code")),i.xp6(3),i.Oqu(i.lcZ(12,18,"units")),i.xp6(3),i.AsE("",i.lcZ(15,20,"price_unit"),"(",e.currencySymbol,")"),i.xp6(3),i.AsE("",i.lcZ(18,22,"total_price"),"(",e.currencySymbol,")"),i.xp6(3),i.Oqu(i.lcZ(21,24,"payer")),i.xp6(2),i.Q6J("ngForOf",i.Dn7(23,26,e.invoiceList[t.key],"serviceSubtype","asc")),i.xp6(5),i.Oqu(i.lcZ(28,30,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),i.xp6(3),i.hij(" ",i.G7q(31,32,i.qbA(41,xa,i.xi3(32,38,e.invoiceList[t.key],"total"),e.i18n.currencySymbol,e.i18n.digitsInfo,e.i18n.locale,e.i18n.position))," ")}}function Da(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",29),i.TgZ(1,"span",30),i.NdJ("click",function(){const e=i.CHM(t).$implicit;return i.oxw(2).hideShowSection(e.key)}),i.TgZ(2,"mat-icon"),i._uU(3),i.qZA(),i.TgZ(4,"h6",31),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.qZA(),i.YNc(7,Ta,33,47,"ng-scrollbar",32),i.qZA()}if(2&t){const t=e.$implicit,n=i.oxw(2);i.xp6(3),i.Oqu(n.getSection(t.key)?"keyboard_arrow_up":"keyboard_arrow_down"),i.xp6(2),i.Oqu(i.lcZ(6,3,null==t.key?null:t.key.toLowerCase())),i.xp6(2),i.Q6J("ngIf",n.getSection(t.key))}}function Sa(t,e){if(1&t&&i._UZ(0,"chq-button",47),2&t){const t=i.oxw(2);i.Q6J("buttonModel",t.previewButtonModel)}}function Ia(t,e){if(1&t&&i._UZ(0,"chq-button",47),2&t){const t=i.oxw(2);i.Q6J("buttonModel",t.saveButtonModel)}}function ka(t,e){if(1&t&&i._UZ(0,"chq-button",47),2&t){const t=i.oxw(2);i.Q6J("buttonModel",t.generateInvoiceButtonModel)}}function Za(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",1),i.TgZ(1,"div",2),i.YNc(2,fa,3,6,"span",3),i.ALo(3,"sum"),i.qZA(),i.TgZ(4,"div",4),i.TgZ(5,"section",5),i.TgZ(6,"div",6),i.TgZ(7,"div",7),i.YNc(8,ba,1,1,"img",8),i.YNc(9,Ma,1,1,"ng-template",null,9,i.W1O),i._UZ(11,"chq-customloader",10),i.qZA(),i.TgZ(12,"div",11),i.TgZ(13,"h4"),i._uU(14),i.ALo(15,"translate"),i.qZA(),i.TgZ(16,"h5"),i._uU(17),i.ALo(18,"translate"),i.qZA(),i.TgZ(19,"h5"),i._uU(20),i.ALo(21,"translate"),i.qZA(),i.TgZ(22,"h5"),i._uU(23),i.ALo(24,"translate"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(25,"div",12),i.TgZ(26,"chq-input",13,14),i.NdJ("controlOutput",function(e){i.CHM(t);const n=i.oxw();return n.invoiceIssuedDate.value=e.value||null,n.isAllocationChanged()}),i.qZA(),i.qZA(),i.qZA(),i.TgZ(28,"section",15),i.TgZ(29,"div",16),i.TgZ(30,"span",17),i.NdJ("click",function(){return i.CHM(t),i.oxw().expandCollapse(!0)}),i._uU(31),i.ALo(32,"translate"),i.qZA(),i.TgZ(33,"span",17),i.NdJ("click",function(){return i.CHM(t),i.oxw().expandCollapse(!1)}),i._uU(34),i.ALo(35,"translate"),i.qZA(),i.qZA(),i.TgZ(36,"div",18),i.YNc(37,Da,8,5,"div",19),i.ALo(38,"keyvalue"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(39,"div",20),i.TgZ(40,"div",21),i.TgZ(41,"div",22),i._UZ(42,"img",23),i.qZA(),i.qZA(),i.TgZ(43,"div",24),i.YNc(44,Sa,1,1,"chq-button",25),i.YNc(45,Ia,1,1,"chq-button",25),i.YNc(46,ka,1,1,"chq-button",25),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.MAs(10),e=i.oxw();i.xp6(2),i.Q6J("ngIf",i.xi3(3,23,e.charges,"total")>0),i.xp6(6),i.Q6J("ngIf",e.orgLogoUrl)("ngIfElse",t),i.xp6(3),i.Q6J("showLoading",e.orgImageLoading),i.xp6(3),i.AsE("",i.lcZ(15,26,"repair_id"),": ",e.repairId,""),i.xp6(3),i.AsE("",i.lcZ(18,28,"make"),": ",e.make,""),i.xp6(3),i.AsE("",i.lcZ(21,30,"model"),": ",e.model,""),i.xp6(3),i.AsE("",i.lcZ(24,32,"license_plate"),": ",e.licensePlate,""),i.xp6(3),i.Q6J("inputModel",e.invoiceIssuedDate),i.xp6(4),i.ekj("secondary-color",e.isAllExpanded),i.xp6(1),i.Oqu(i.lcZ(32,34,"expand_all")),i.xp6(2),i.ekj("secondary-color",!e.isAllExpanded),i.xp6(1),i.hij("",i.lcZ(35,36,"collapse_all")," "),i.xp6(3),i.Q6J("ngForOf",i.xi3(38,38,e.invoiceList,e.valueAscOrder)),i.xp6(7),i.Q6J("ngIf","retail"!==(null==e.currentWorkProvider?null:e.currentWorkProvider.toLowerCase())),i.xp6(1),i.Q6J("ngIf","readytoinvoice"!==e.status.toLowerCase()&&!e.commonService.isViewOnly),i.xp6(1),i.Q6J("ngIf","readytoinvoice"===e.status.toLowerCase()||!e.commonService.isViewOnly)}}let Aa=(()=>{class t{constructor(t,e,n,i,o,r,a){this.commonService=t,this.invoiceService=e,this.bookingService=n,this.monitorServie=i,this.dialog=o,this.router=r,this.route=a,this.digitInfo="",this.locale="",this.repairId="",this.make="",this.maxPoint=1e7,this.model="",this.status="",this.licensePlate="",this.currencySymbol="",this.caseGuid="",this.orgImageLoading=!0,this.orgLogoUrl="",this.orgName="",this.paymentStatus="",this.isAllExpanded=!0,this.isPartsExpanded=!0,this.isLabourExpanded=!0,this.isPaintExpanded=!0,this.workProviderValue="",this.customerValue="",this.partsCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",units:"2",cost:"500",total:"1500"}],this.totalPartsCost=0,this.currentChangesString="",this.totalPaintCost=0,this.hasPaint=!1,this.hasParts=!1,this.hasLabour=!1,this.repairStatus="",this.paintCost=[],this.invoiceList={},this.isDataLoading=!0,this.radioList={},this.summary={},this.charges=[],this.currentWorkProvider="",this.currentWorkProviderType="",this.currentDate=new Date,this.invoiceIssuedDate={placeHolder:"Select Date",label:"INVOICE DATE",name:"issuedDate",value:this.currentDate,maxDate:this.currentDate,minDate:Je().subtract(1,"year").toDate(),type:"date",required:!1,disabled:!1,mode:"date"},this.radioButtonList=[],this.previewButtonModel={label:"Preview",type:"outline",onclick:()=>this.previewInvoiceSummary()},this.saveButtonModel={label:"Save",type:"disabled-outline",onclick:()=>{this.updateEstimateCharge()}},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.hashPropTable={},this.generateInvoiceButtonModel={label:"Generate Invoice",icon:"invoices",type:"primary",onclick:()=>{this.goToGenerateInvoice()}},this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}goToGenerateInvoice(){var t,e,n;if("readytoinvoice"===(null===(t=this.status)||void 0===t?void 0:t.toLowerCase())){let t=1;return"retail"===(null===(e=this.currentWorkProvider)||void 0===e?void 0:e.toLowerCase())&&"person"===(null===(n=this.currentWorkProviderType)||void 0===n?void 0:n.toLowerCase())&&(t=2),void this.router.navigate(["../invoicesEdit"],{relativeTo:this.route,queryParams:{formType:t}})}this.commonService.openConfirmYesNoDialog("Confirm to Continue","Once the invoice is generated, you won\u2019t be able to edit the estimate again. Are you sure you want to continue?").afterClosed().subscribe(t=>{t&&this.updateEstimateCharge(!0)})}parseFloatingPoint(t,e){return this.hashPropTable[e]?t:(e&&(this.hashPropTable[e]=!0),t*this.maxPoint)}get isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}valueAscOrder(t,e){var n,i;const o={part:"1",labour:"2",paint:"3"};return o[null===(n=t.key)||void 0===n?void 0:n.toLowerCase()].localeCompare(o[null===(i=e.key)||void 0===i?void 0:i.toLowerCase()])}validateLabourTypes(t,e,n,i){return e===Lt.UW.Paint?(this.hasPaint=!0,"PaintLabour"===n.serviceSubType?(t.paintLabourHourSubTotal=this.parseFloatingPoint(t.paintLabourHourSubTotal,`paintLabourHourSubTotal_${i}`)+this.parseFloatingPoint(n.quantity),t.paintLabourAmountSubTotal=this.parseFloatingPoint(t.paintLabourAmountSubTotal,`paintLabourAmountSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.paintLabourSubTotal=this.parseFloatingPoint(t.paintLabourSubTotal,`paintLabourSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.paintLabourTotal=this.parseFloatingPoint(t.paintLabourTotal,`paintLabourSubTotal+${i}`)+this.parseFloatingPoint(n.total)*((100-parseFloat(t.paintLabourDiscountPercentage))/100)):(t.paintMaterialSubTotal=this.parseFloatingPoint(t.paintMaterialSubTotal,`paintMaterialSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.paintMaterialTotal=this.parseFloatingPoint(t.paintMaterialTotal,`paintMaterialTotal_${i}`)+this.parseFloatingPoint(n.total)*((100-parseFloat(t.paintMateriaDiscountPercentage))/100))):e===Lt.UW.Labour?(this.hasLabour=!0,t.labourTotalBeforeDiscount=this.parseFloatingPoint(t.labourTotalBeforeDiscount,`labourTotalBeforeDiscount_${i}`)+this.parseFloatingPoint(n.total),t.labourAmountSubTotal=this.parseFloatingPoint(t.labourAmountSubTotal,`labourAmountSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.labourTotal=this.parseFloatingPoint(t.labourTotal,`labourTotal_${i}`)+this.parseFloatingPoint(n.total)*((100-parseFloat(t.labourTotalDiscountPercentage))/100),t.labourHourSubTotal=this.parseFloatingPoint(t.labourHourSubTotal,`labourHourSubTotal_${i}`)+this.parseFloatingPoint(n.total),t.labourTimeHours=this.parseFloatingPoint(t.labourTimeHours,`labourTimeHours_${i}`)+this.parseFloatingPoint(n.quantity)):(this.hasParts=!0,t.partsTotalBeforeDiscount=this.parseFloatingPoint(t.partsTotalBeforeDiscount,`partsTotalBeforeDiscount_${i}`)+this.parseFloatingPoint(n.total),t.partsTotal=this.parseFloatingPoint(t.partsTotal,`partsTotal_${i}`)+this.parseFloatingPoint(n.total)*((100-parseFloat(t.partsTotalDiscountPercentage))/100),t.partsSubTotal=this.parseFloatingPoint(t.partsSubTotal,`partsSubTotal_${i}`)+this.parseFloatingPoint(n.total)),t}calculateSummary(t){var e,n,i,o;this.hashPropTable={};const r=Object.keys(t);t.paintLabourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.paintLabourSubTotal=0,t.labourTotal=0,t.paintLabourTotal=0,t.labourTimeHours=0,t.labourTotalBeforeDiscount=0,t.paintMaterialTotal=0,t.paintMaterialSubTotal=0,t.labourAmountSubTotal=0,t.labourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.partsSubTotal=0,t.partsTotal=0,t.partsTotalBeforeDiscount=0,r.forEach(e=>{t[e]=t[e]||"0"===t[e]?parseFloat(t[e]):0});let a=!1,s=!1;const l=JSON.parse(JSON.stringify(t)),c=[];l.title="work_provider_invoice";const d={};null===(e=this.charges)||void 0===e||e.forEach(t=>{1===t.recipient&&(a=!0,d[t.serviceType]||(d[t.serviceType]=[]),d[t.serviceType].push(t))}),a&&(l.invoiceList=d,c[0]=l);const p=JSON.parse(JSON.stringify(t));p.title="driver_owner_invoice";const u={};return null===(n=this.charges)||void 0===n||n.forEach(t=>{2===t.recipient&&(s=!0,u[t.serviceType]||(u[t.serviceType]=[]),u[t.serviceType].push(t))}),s&&(p.invoiceList=u,c[1]=p),this.charges.forEach(t=>{const e=t.serviceType;(t.cost||"0"===t.cost)&&(t.cost=parseFloat(t.cost)),(t.quantity||"0"===t.quantity)&&(t.quantity=parseFloat(t.quantity)),(t.total||"0"===t.total)&&(t.total=parseFloat(t.total)),1===t.recipient?c[0]=this.validateLabourTypes(c[0],e,t,t.recipient):c[1]=this.validateLabourTypes(c[1],e,t,t.recipient)}),a&&(c[0].paintLabourHourSubTotal=c[0].paintLabourHourSubTotal/this.maxPoint,c[0].paintLabourSubTotal=c[0].paintLabourSubTotal/this.maxPoint,c[0].labourTotal=c[0].labourTotal/this.maxPoint,c[0].paintLabourTotal=c[0].paintLabourTotal/this.maxPoint,c[0].labourTimeHours=c[0].labourTimeHours/this.maxPoint,c[0].labourTotalBeforeDiscount=c[0].labourTotalBeforeDiscount/this.maxPoint,c[0].paintMaterialTotal=c[0].paintMaterialTotal/this.maxPoint,c[0].paintMaterialSubTotal=c[0].paintMaterialSubTotal/this.maxPoint,c[0].labourAmountSubTotal=c[0].labourAmountSubTotal/this.maxPoint,c[0].labourHourSubTotal=c[0].labourHourSubTotal/this.maxPoint,c[0].paintLabourAmountSubTotal=c[0].paintLabourAmountSubTotal/this.maxPoint,c[0].partsSubTotal=c[0].partsSubTotal/this.maxPoint,c[0].partsTotal=c[0].partsTotal/this.maxPoint,c[0].partsTotalBeforeDiscount=c[0].partsTotalBeforeDiscount/this.maxPoint),s&&(c[1].paintLabourHourSubTotal=c[1].paintLabourHourSubTotal/this.maxPoint,c[1].paintLabourSubTotal=c[1].paintLabourSubTotal/this.maxPoint,c[1].labourTotal=c[1].labourTotal/this.maxPoint,c[1].paintLabourTotal=c[1].paintLabourTotal/this.maxPoint,c[1].labourTimeHours=c[1].labourTimeHours/this.maxPoint,c[1].labourTotalBeforeDiscount=c[1].labourTotalBeforeDiscount/this.maxPoint,c[1].paintMaterialTotal=c[1].paintMaterialTotal/this.maxPoint,c[1].paintMaterialSubTotal=c[1].paintMaterialSubTotal/this.maxPoint,c[1].labourAmountSubTotal=c[1].labourAmountSubTotal/this.maxPoint,c[1].labourHourSubTotal=c[1].labourHourSubTotal/this.maxPoint,c[1].paintLabourAmountSubTotal=c[1].paintLabourAmountSubTotal/this.maxPoint,c[1].partsSubTotal=c[1].partsSubTotal/this.maxPoint,c[1].partsTotal=c[1].partsTotal/this.maxPoint,c[1].partsTotalBeforeDiscount=c[1].partsTotalBeforeDiscount/this.maxPoint),"retail"===(null===(i=this.currentWorkProvider)||void 0===i?void 0:i.toLowerCase())?"person"===(null===(o=this.currentWorkProviderType)||void 0===o?void 0:o.toLowerCase())?[c[1]]:[c[0]]:c}isAllocationChanged(){const t=JSON.stringify(this.invoiceList);this.saveButtonModel=this.invoiceIssuedDate.disabled||t===this.currentChangesString&&Je(this.invoiceIssuedDate.value).format("DD/MM/YYYY")==Je(this.currentDate).format("DD/MM/YYYY")?Object.assign(Object.assign({},this.saveButtonModel),{type:"disabled-outline"}):Object.assign(Object.assign({},this.saveButtonModel),{type:"outline"})}hideShowSection(t){"part"===(null==t?void 0:t.toLowerCase())?this.isPartsExpanded=!this.isPartsExpanded:"labour"===(null==t?void 0:t.toLowerCase())?this.isLabourExpanded=!this.isLabourExpanded:this.isPaintExpanded=!this.isPaintExpanded}getSection(t){return"part"===(null==t?void 0:t.toLowerCase())?this.isPartsExpanded:"labour"===(null==t?void 0:t.toLowerCase())?this.isLabourExpanded:this.isPaintExpanded}getBookingRepairDetails(){var t;this.commonService.showLoading();const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.monitorServie.logEvent("getBookingRepairDetails",["InvoicesComponent","addenda-repair"],{repairGuid:e}),this.bookingService.getRepairDetailByGuid(e).subscribe({next:t=>(0,kt.mG)(this,void 0,void 0,function*(){var n,i,o,r,a,s,l,c,d,p,u,h,g;if(null==t?void 0:t.data){this.commonService.repairDetails.next(t.data),this.commonService.bookingId.next(t.data.repairNumber),this.caseGuid=t.data.quoteId,this.repairStatus=t.data.status,this.status=t.data.invoiceStatus||"";const m=t.data.createdDate,v=Je(new Date).diff(Je(m),"minutes");if(this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{minDate:Je(m).toDate(),disabled:v<0,maxDate:v<0?Je(m).toDate():new Date}),["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(this.repairStatus.toLowerCase())||(this.generateInvoiceButtonModel=Object.assign(Object.assign({},this.generateInvoiceButtonModel),{type:"disabled"})),this.currentWorkProvider=t.data.customer.companyOrgType,this.currentWorkProviderType=t.data.customer.customerTypeName,this.orgName=null===(i=null===(n=t.data)||void 0===n?void 0:n.organizationDetail)||void 0===i?void 0:i.nameOfOrganization,this.orgLogoUrl=null===(r=null===(o=t.data)||void 0===o?void 0:o.organizationDetail)||void 0===r?void 0:r.logoOfOrg,this.customerValue=`${null===(s=null===(a=t.data)||void 0===a?void 0:a.customer)||void 0===s?void 0:s.firstName} ${null===(c=null===(l=t.data)||void 0===l?void 0:l.customer)||void 0===c?void 0:c.lastName}`,this.workProviderValue=(null===(p=null===(d=t.data)||void 0===d?void 0:d.customer)||void 0===p?void 0:p.companyName)||(null===(h=null===(u=t.data)||void 0===u?void 0:u.customer)||void 0===h?void 0:h.customerTypeName),this.orgLogoUrl||(this.orgImageLoading=!1),"technician"===(null===(g=this.commonService.roleName)||void 0===g?void 0:g.toLowerCase()))return;this.invoiceService.invoicePerDetail(e).subscribe({next:t=>{var e,n;const{chargesDTO:i,chargeSummary:o,repairEstimateId:r,repairId:a,repairNumber:s,status:l,paymentStatus:c,vehicle:d,invoiceDate:p}=t.data;if(this.repairId=s,this.repairIntId=a,this.estimateIntId=r,this.paymentStatus=c,this.summary=o,this.make=d.vehicleMake,this.model=d.vehicleModel,this.licensePlate=d.licensePlateNumber,this.charges=i,p&&(this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{value:p})),("readytoinvoice"===(null===(e=this.status)||void 0===e?void 0:e.toLowerCase())||"paid"===(null===(n=this.paymentStatus)||void 0===n?void 0:n.toLowerCase()))&&(this.generateInvoiceButtonModel=Object.assign(Object.assign({},this.generateInvoiceButtonModel),{label:"view_invoices"}),this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{mode:"text"})),this.commonService.isViewOnly&&(this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{mode:"text"})),!this.charges||0===this.charges.length)return this.commonService.showToast(0,"no_charges"),void this.commonService.hideLoading();this.isDataLoading=!1,i.forEach(t=>{var e,n,i;this.invoiceList[t.serviceType]||(this.invoiceList[t.serviceType]=[],this.radioList[t.serviceType]=[]),t.serviceType===Lt.UW.Paint?this.hasPaint=!0:t.serviceType===Lt.UW.Labour?this.hasLabour=!0:this.hasParts=!0;let o={placeHolder:"",label:"",name:"payer",idField:"payer",value:1===t.recipient?this.workProviderValue:this.customerValue,type:"radio",disabled:"readytoinvoice"===l.toLowerCase(),options:[{label:this.workProviderValue,id:1},{label:this.customerValue,id:2}]};if("retail"===(null===(e=this.currentWorkProvider)||void 0===e?void 0:e.toLowerCase())){const t="person"===(null===(n=this.currentWorkProviderType)||void 0===n?void 0:n.toLowerCase())?this.customerValue:this.workProviderValue,e="person"===(null===(i=this.currentWorkProviderType)||void 0===i?void 0:i.toLowerCase())?2:1;o=Object.assign(Object.assign({},o),{options:[{label:t,id:e}],mode:"text"})}this.radioList[t.serviceType].push(o),this.invoiceList[t.serviceType].push(t)}),this.currentChangesString=JSON.stringify(this.invoiceList),this.commonService.hideLoading()}})}else this.commonService.hideLoading()}),error:t=>{this.commonService.hideLoading(),this.isDataLoading=!1,this.monitorServie.logException(t,Qt._.Error)}})}updateEstimateCharge(t){const e={repairId:this.repairIntId,estimateId:this.estimateIntId,status:t?3:1,invoiceDate:this.invoiceIssuedDate.value,estimateCharges:[]};Object.keys(this.invoiceList).forEach(t=>{this.invoiceList[t].forEach(t=>{e.estimateCharges.push({estimateChargeId:t.chargeId,RecipientId:t.recipient})})}),this.commonService.showLoading(),this.invoiceService.assignInvoice(e).subscribe({next:e=>{var n,i;if(e){this.commonService.showInfoToast(1e3,"Invoice saved successfully");let e=1;"retail"===(null===(n=this.currentWorkProvider)||void 0===n?void 0:n.toLowerCase())&&"person"===(null===(i=this.currentWorkProviderType)||void 0===i?void 0:i.toLowerCase())&&(e=2),this.commonService.hideLoading(),t&&this.router.navigate(["../invoicesEdit"],{relativeTo:this.route,queryParams:{formType:e}})}},error:()=>{this.commonService.hideLoading()}})}ngOnInit(){this.getBookingRepairDetails()}expandCollapse(t){this.isAllExpanded=t,this.isPartsExpanded=t,this.isPaintExpanded=t,this.isLabourExpanded=t}previewInvoiceSummary(){const t=this.calculateSummary(this.summary).filter(t=>null==t?void 0:t.title);this.dialog.open(yr,{width:" 58.5rem",height:"39.625rem",disableClose:!0,data:{title:"delete",message:"delete_confirm",messageEntity:"entity",okText:"yes",cancelText:"no",summaryData:t,showPaint:this.hasPaint,showLabour:this.hasLabour,showParts:this.hasParts},autoFocus:!1})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(te.v),i.Y36(Ji),i.Y36($t.q),i.Y36(Et.M),i.Y36(qt.uw),i.Y36(Ot.F0),i.Y36(Ot.gz))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-repair-invoices"]],decls:1,vars:1,consts:[["class","repair-invoice-wrapper",4,"ngIf"],[1,"repair-invoice-wrapper"],[1,"status-pill-wrapper"],[3,"class",4,"ngIf"],[1,"page-container"],[1,"repair-info"],[1,"repair-info-col-1"],[1,"org-image"],["alt","org logo",3,"src","load",4,"ngIf","ngIfElse"],["name",""],[3,"showLoading"],[1,"repair-detail"],[1,"repair-info-col-2"],[1,"col-6","invoice-date-input",3,"inputModel","controlOutput"],["regDate",""],[1,"invoices-table-wrapper"],[1,"expand-collapse-btn"],[3,"click"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["alt","addenda logo","src","assets/img/addenda-repair.png"],[1,"button-container"],[3,"buttonModel",4,"ngIf"],["alt","org logo",3,"src","load"],["class","org-name",4,"ngIf"],[1,"org-name"],[1,"table-parent"],[1,"expand-container",3,"click"],[1,"small-heading"],["class","wrapper-table-scroll",3,"disabled","track","autoHeightDisabled",4,"ngIf"],[1,"wrapper-table-scroll",3,"disabled","track","autoHeightDisabled"],["width","100%"],["align","center"],[4,"ngFor","ngForOf"],["colspan","5"],["align","right"],[4,"ngIf"],[1,"text-light"],[3,"ngClass"],["class","provider-class",4,"ngIf"],["class","payer-radio-btn",3,"inputModel","controlOutput",4,"ngIf"],["colspan","6"],[1,"provider-class"],[1,"payer-radio-btn",3,"inputModel","controlOutput"],[3,"buttonModel"]],template:function(t,e){1&t&&i.YNc(0,Za,47,41,"div",0),2&t&&i.Q6J("ngIf",!e.isDataLoading)},directives:[o.O5,mo.h,Nt.D,o.sg,Mt.Hw,na,o.mk,Ut.E],pipes:[_o,yt.X$,o.Nd,fo,bo.j],styles:[".repair-invoice-wrapper[_ngcontent-%COMP%]{background-color:#dbdde2;height:calc(100% - 315px);padding-top:50px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:.625rem;font-style:normal;font-weight:700;padding:.6875rem 2rem;border-radius:.625rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:rgba(255,255,255,.82)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.5rem;gap:1.5rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .org-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5.58956rem;height:4.86131rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]{display:flex;grid-gap:.5rem;gap:.5rem;flex-direction:column}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2{display:flex;flex-direction:column;grid-gap:1rem;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2 chq-input.invoice-date-input{width:16.28494rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2 chq-input.invoice-date-input div.input-wrapper:not(.text-mode) input{outline:2px solid black}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]{margin-top:2.4rem;display:flex;flex-direction:column;grid-gap:1rem;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;padding-left:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:rgba(26,34,51,.4);color:var(--colors-gray-40, rgba(26, 34, 51, .4));font-size:.75rem;font-style:normal;font-weight:600;line-height:.875rem;cursor:pointer}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem;margin-bottom:1.5rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0 0;border-bottom:1px solid rgba(26,34,51,.1);border-bottom:1px solid var(--colors-gray-10, rgba(26, 34, 51, .1));background:#f1f2f6;background:var(--colors-background, #f1f2f6)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:700}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:12px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray);font-size:10px;font-weight:500}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{padding-right:calc(5px + 1.5vw);align-items:center;display:flex;grid-gap:1rem;gap:1rem;justify-content:flex-end}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}.provide-td[_ngcontent-%COMP%]{text-align:center}.provider-class[_ngcontent-%COMP%]{height:20px}.wrapper-table-scroll[_ngcontent-%COMP%]{max-width:100%;overflow-x:auto}.wrapper-table-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{display:inherit}.wrapper-table-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}[_ngcontent-%COMP%]::-webkit-scrollbar{-webkit-appearance:none;width:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,.5);box-shadow:0 0 1px rgba(255,255,255,.5)}.wrapper-table-scroll[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{border-radius:10px;background:rgba(100,100,100,.8);-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.5)}@media screen and (max-width: 864px){  .payer-radio-btn div.input-wrapper .radio{flex-direction:column;grid-gap:0px;gap:0px}}"]}),t})();function qa(t,e){if(1&t&&(i.TgZ(0,"div",19),i.TgZ(1,"div",20),i._uU(2),i.ALo(3,"uppercase"),i.ALo(4,"translate"),i.qZA(),i.TgZ(5,"div",21),i._uU(6),i.qZA(),i.qZA()),2&t){const t=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,i.lcZ(4,4,"status"))),i.xp6(4),i.Oqu(t.partsStatus)}}function La(t,e){if(1&t&&i._UZ(0,"chq-button",24),2&t){const t=i.oxw(2);i.Q6J("buttonModel",t.addPartButtonModel)}}function Ea(t,e){1&t&&(i.TgZ(0,"div",22),i.YNc(1,La,1,1,"chq-button",23),i.qZA()),2&t&&(i.xp6(1),i.Q6J("chqPermission","repairAddParts"))}function Ra(t,e){if(1&t&&(i.TgZ(0,"div",30),i._UZ(1,"mat-icon",31),i.TgZ(2,"span"),i._uU(3),i.qZA(),i.qZA()),2&t){const t=i.oxw().$implicit,e=i.oxw(2);i.xp6(1),i.Q6J("svgIcon",e.partMapper[t.statusId+"_icon"]),i.xp6(2),i.hij("",e.partMapper[t.statusId+"_name"]," ")}}function ja(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-input",32),i.NdJ("controlOutput",function(e){return i.CHM(t),i.oxw(3).onStatusChange(e)}),i.qZA()}if(2&t){const t=i.oxw().index,e=i.oxw(2);i.Q6J("inputModel",e.individualStatusModels[t])}}function Fa(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"mat-icon",33),i.NdJ("click",function(){i.CHM(t);const e=i.oxw(),n=e.index,o=e.$implicit;return i.oxw(2).showDropdown(n,o.partId)}),i.qZA()}if(2&t){const t=i.oxw().index,e=i.oxw(2);i.Q6J("svgIcon",e.editMode[t]?"cross":"edit")}}const Na=function(t,e,n,i,o){return[t,e,n,i,o]};function Ua(t,e){if(1&t&&(i.TgZ(0,"tr"),i.TgZ(1,"td"),i._uU(2),i.qZA(),i.TgZ(3,"td"),i._uU(4),i.qZA(),i.TgZ(5,"td"),i._uU(6),i.qZA(),i.TgZ(7,"td"),i._uU(8),i.ALo(9,"xaCurrency"),i.qZA(),i.TgZ(10,"td",26),i._uU(11),i.ALo(12,"xaCurrency"),i.qZA(),i.TgZ(13,"td"),i.YNc(14,Ra,4,2,"div",27),i.YNc(15,ja,1,1,"chq-input",28),i.qZA(),i.TgZ(16,"td"),i.YNc(17,Fa,1,1,"mat-icon",29),i.qZA(),i.qZA()),2&t){const t=e.$implicit,n=e.index,o=i.oxw(2);i.xp6(2),i.hij(" ",t.description," "),i.xp6(2),i.hij(" ",t.code," "),i.xp6(2),i.hij(" ",t.quantity," "),i.xp6(2),i.hij(" ",i.G7q(9,8,i.qbA(20,Na,t.cost,o.i18n.currencySymbol,o.i18n.digitsInfo,o.i18n.locale,o.i18n.position))," "),i.xp6(3),i.hij(" ",i.G7q(12,14,i.qbA(26,Na,t.total,o.i18n.currencySymbol,o.i18n.digitsInfo,o.i18n.locale,o.i18n.position))," "),i.xp6(3),i.Q6J("ngIf",!o.editMode[n]),i.xp6(1),i.Q6J("ngIf",o.editMode[n]),i.xp6(2),i.Q6J("ngIf",!o.readOnlyMode&&!o.commonService.isViewOnly)}}function Ja(t,e){if(1&t&&(i.TgZ(0,"tbody"),i.YNc(1,Ua,18,32,"tr",25),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngForOf",t.parts)}}function Ya(t,e){1&t&&(i.TgZ(0,"tbody"),i.TgZ(1,"tr"),i.TgZ(2,"td",34),i._uU(3),i.ALo(4,"translate"),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Oqu(i.lcZ(4,1,"no_parts_available")))}function Ba(t,e){if(1&t&&i._UZ(0,"chq-button",24),2&t){const t=i.oxw();i.Q6J("buttonModel",t.saveButtonModel)}}let za=(()=>{class t{constructor(t,e,n,i,o,r,a,s){var l,c;this.dialog=t,this.bookingService=e,this.commonService=n,this.route=i,this.monitorService=o,this.repairEstimateService=r,this.repairEstimateOperationService=a,this.router=s,this.notifyServiceButtonModel={label:"Notify Service Advisor",type:"outline",icon:"paperplane",iconColor:"black"},this.addPartButtonModel={label:"Add Part",type:"outline",icon:"plus",onclick:this.openPartPopup.bind(this)},this.saveButtonModel={label:"Save",type:"disabled",onclick:this.saveParts.bind(this)},this.individualStatusModel={placeHolder:"Select Status",name:"indStatus",label:"",type:"select",value:0,displayValue:"name",options:[]},this.individualStatusModels=[],this.parts=[],this.partsStatus="",this.repairGuid="",this.estimateSource="",this.userPermission={},this.partMapper={},this.editMode=[],this.formData=[],this.repairStatus="",this.readOnlyMode=!1,this.hideButton=!1,this.repairTypesArray=[],this.afterOperation=!1,this.commonService.accessRight.closed&&(this.commonService.accessRight=new Zt.X(!0)),this.commonService.userProfileData.subscribe(t=>{if(t&&t.data){const{userPermission:e}=t.data;this.userPermission=e||{}}}),this.i18n=this.commonService.geti18nInfo(),null===(c=null===(l=this.route.parent)||void 0===l?void 0:l.params)||void 0===c||c.subscribe(t=>{""!=this.repairGuid&&this.repairGuid!==t.id&&(this.repairGuid=t.id,this.getRepairDetails(),this.getParts())})}get disableEdit(){var t;return!!["pendingapproval","readytoinvoice","invoiced","complete"].includes(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())}ngOnInit(){var t;this.repairGuid=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id"),this.commonService.showLoading(),(0,_n.D)({partStatuses:this.repairEstimateOperationService.getPartStatuses(),part:this.repairEstimateOperationService.getParts(this.repairGuid),repairDetail:this.bookingService.getRepairDetailByGuid(this.repairGuid)}).pipe((0,Mn.K)(t=>(0,On.of)(t))).subscribe({next:t=>{var e,n,i;if(t.partStatuses&&this.getPartStatuses(null===(e=t.partStatuses)||void 0===e?void 0:e.data),t.part){const e=t.part;e&&(this.parts=e.repairParts,(null===(n=this.parts)||void 0===n?void 0:n.length)>0&&this.parts.forEach((t,e)=>{this.individualStatusModels[e]=this.individualStatusModel,this.individualStatusModels[e]=Object.assign(Object.assign({},this.individualStatusModels[e]),{selectedOption:{name:t.status,id:t.statusId},name:`ind-status-${e}`}),this.editMode[e]=!1}),this.partsStatus=this.mapStatus(e.status))}if(t.repairDetail){const e=t.repairDetail;this.repairResponse=t.repairDetail.data,this.commonService.bookingId.next(this.repairResponse.repairNumber),this.commonService.repairGuid.next(this.repairResponse.repairGuid),this.commonService.repairDetails.next(this.repairResponse),this.estimateSource=this.repairResponse.estimateSource||"",this.repairStatus=this.repairResponse.status,this.disableEdit?(this.readOnlyMode=!0,this.hideButton=!0):("GTMotive"!=this.estimateSource&&this.checkGTEstimatePermission()||"GTMotive"==this.estimateSource&&!this.checkGTEstimatePermission())&&(this.readOnlyMode=!0),"repair"==(null===(i=e.data.repairType)||void 0===i?void 0:i.toLowerCase())&&(this.afterOperation||this.getInitialRepairTypes(e.data.repairServiceTypes))}},error:t=>{this.commonService.hideLoading()}})}getPartStatuses(t){if(t){this.individualStatusModel=Object.assign(Object.assign({},this.individualStatusModel),{options:t});const e={};this.individualStatusModel.options.forEach((t,n)=>{this.individualStatusModel.options[n]=Object.assign(Object.assign({},this.individualStatusModel.options[n]),{dropdownItemIcon:this.getIcon(t.name)}),e[t.id+"_name"]=t.description,e[t.id+"_icon"]=this.getIcon(t.name)}),this.partMapper=e}}getIcon(t){switch(t){case"NotOrdered":return"parts-not-ordered";case"Ordered":return"parts-ordered";case"Arrived":return"parts-arrived";default:return""}}mapStatus(t){switch(t){case"NotOrdered":return"Not Ordered";case"OrderedPartially":return"Ordered Partially";case"ArrivedPartially":return"Arrived Partially";default:return t}}getParts(){this.commonService.showLoading(),this.repairEstimateOperationService.getParts(this.repairGuid).subscribe({next:t=>{var e;t&&(this.parts=t.repairParts,(null===(e=this.parts)||void 0===e?void 0:e.length)>0&&this.parts.forEach((t,e)=>{this.individualStatusModels[e]=this.individualStatusModel,this.individualStatusModels[e]=Object.assign(Object.assign({},this.individualStatusModels[e]),{selectedOption:{name:t.status,id:t.statusId},name:`ind-status-${e}`}),this.editMode[e]=!1}),this.partsStatus=this.mapStatus(t.status))},complete:()=>{this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}saveParts(){this.commonService.showLoading(),this.repairEstimateOperationService.editPartStatuses(this.formData,this.repairGuid).subscribe({next:t=>{t&&(this.getParts(),this.formData=[],this.saveButtonModel.type="disabled")},complete:()=>{this.commonService.hideLoading()}})}getRepairDetails(){this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairGuid).subscribe({next:t=>{var e;this.repairResponse=t.data,this.commonService.bookingId.next(this.repairResponse.repairNumber),this.commonService.repairGuid.next(this.repairResponse.repairGuid),this.commonService.repairDetails.next(this.repairResponse),this.estimateSource=this.repairResponse.estimateSource||"",this.repairStatus=this.repairResponse.status,this.disableEdit?(this.readOnlyMode=!0,this.hideButton=!0):("GTMotive"!=this.estimateSource&&this.checkGTEstimatePermission()||"GTMotive"==this.estimateSource&&!this.checkGTEstimatePermission())&&(this.readOnlyMode=!0),"repair"==(null===(e=t.data.repairType)||void 0===e?void 0:e.toLowerCase())&&(this.afterOperation?"GTMotive"!=this.estimateSource&&(this.showRepairTypeUpdateMessage(t.data.repairServiceTypes,this.repairTypesArray),-1!==location.search.indexOf("?mode=edit")?this.router.navigate([`/repair/booking/${this.repairGuid}/estimate`],{queryParams:{mode:"edit"}}):this.router.navigate([`/repair/booking/${this.repairGuid}/estimate`])):this.getInitialRepairTypes(t.data.repairServiceTypes)),this.commonService.hideLoading()},complete:()=>{this.commonService.hideLoading()}})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,e=t.filter(t=>"Repair Estimate"===t.automotiveServiceName);if(e&&e.length>0){const{permissions:t}=e[0],n=t.filter(t=>"gt.estimate"===t.permissionName||"gt.estimate.vinquery"===t.permissionName);if(n&&n.length>0)return!0}return!1}redirectToGtEstimate(){this.commonService.showLoading(),this.monitorService.logEvent("redirectToGtEstimate",["RepairPartsComponent","addenda-repair",{repairId:this.repairGuid}]),this.repairEstimateService.createEstimateFromRepair(this.repairGuid).subscribe({next:t=>{t&&(location.href=t.data.url,sessionStorage.setItem("update","1"),sessionStorage.setItem("current-url",this.router.url.toString()),sessionStorage.setItem("initial-repair-types",JSON.stringify(this.repairTypesArray)))},complete:()=>{this.commonService.hideLoading()}})}onStatusChange(t){var e,n,i,o;const r=null===(e=t.name)||void 0===e?void 0:e.replace("ind-status-","");this.individualStatusModels[r]=Object.assign(Object.assign({},this.individualStatusModels[r]),{selectedOption:t.value});const a=this.formData.find(t=>{var e;return t.partGuid==(null===(e=this.parts[r])||void 0===e?void 0:e.partGuidId)});a?a.status=null===(n=t.value)||void 0===n?void 0:n.name:this.formData.push({status:null===(i=t.value)||void 0===i?void 0:i.name,partGuid:null===(o=this.parts[r])||void 0===o?void 0:o.partGuidId}),this.saveButtonModel.type="primary"}showDropdown(t,e=""){var n;if(this.editMode[t]=!this.editMode[t],this.saveButtonModel.type=this.editMode.some(t=>!0===t)?"primary":"disabled",0==this.editMode[t]){const i=this.parts.find(t=>t.partId==e);i&&(this.individualStatusModels[t]=Object.assign(Object.assign({},this.individualStatusModels[t]),{selectedOption:{name:i.status,id:i.statusId}})),this.formData=null===(n=this.formData)||void 0===n?void 0:n.filter(t=>t.partGuid!=i.partGuidId)}}openPartPopup(){if("GTMotive"==this.estimateSource)this.redirectToGtEstimate();else{if(this.checkGTEstimatePermission())return void this.commonService.showToast(0,"msg_gt_permission");this.dialog.open(De,{data:{repairId:this.repairGuid},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:t=>{t&&(this.afterOperation=!0,this.getRepairDetails())}})}}getInitialRepairTypes(t){t.forEach(t=>{this.repairTypesArray.push(t.repairServiceType)})}showRepairTypeUpdateMessage(t,e){const n=[];if(null==t||t.forEach(t=>{n.push("object"==typeof t?t.repairServiceType:t)}),n.length>0){const t=n.filter(t=>!e.includes(t));t.length>0&&(this.commonService.showInfoToast(1e3,`Repair Type was updated: Added ${t.join(",")}`),this.repairTypesArray=[...this.repairTypesArray,...t])}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(qt.uw),i.Y36($t.q),i.Y36(te.v),i.Y36(Ot.gz),i.Y36(Et.M),i.Y36(Ye.H),i.Y36(Xt),i.Y36(Ot.F0))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-repair-parts"]],decls:39,vars:28,consts:[[1,"repair-part-wrapper"],[1,"page-container"],[1,"toolbar-container"],[1,"toolbar-wrapper","row"],["class","part-status col-6",4,"ngIf"],[1,"col-6","button-section-wrapper"],["class","button-section",4,"ngIf"],[1,"table-container"],[1,"main-table"],["width","40%"],[1,"price"],[1,"total-price"],[4,"ngIf"],[1,"button-container"],[3,"buttonModel",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[1,"part-status","col-6"],[1,"part-status-label"],[1,"part-status-text"],[1,"button-section"],[3,"buttonModel",4,"chqPermission"],[3,"buttonModel"],[4,"ngFor","ngForOf"],[1,"total"],["class","dropdown-parts",4,"ngIf"],[3,"inputModel","controlOutput",4,"ngIf"],[3,"svgIcon","click",4,"ngIf"],[1,"dropdown-parts"],[3,"svgIcon"],[3,"inputModel","controlOutput"],[3,"svgIcon","click"],["colspan","7",1,"no-parts"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"div",3),i.YNc(4,qa,7,6,"div",4),i.TgZ(5,"div",5),i.YNc(6,Ea,2,1,"div",6),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"div",7),i.TgZ(8,"table",8),i.TgZ(9,"thead"),i.TgZ(10,"th",9),i._uU(11),i.ALo(12,"translate"),i.qZA(),i.TgZ(13,"th"),i._uU(14),i.ALo(15,"translate"),i.qZA(),i.TgZ(16,"th"),i._uU(17),i.ALo(18,"translate"),i.qZA(),i.TgZ(19,"th",10),i._uU(20),i.ALo(21,"translate"),i.qZA(),i.TgZ(22,"th",11),i._uU(23),i.ALo(24,"translate"),i.qZA(),i.TgZ(25,"th"),i._uU(26),i.ALo(27,"translate"),i.qZA(),i.TgZ(28,"th"),i._uU(29),i.ALo(30,"translate"),i.qZA(),i.qZA(),i.YNc(31,Ja,2,1,"tbody",12),i.YNc(32,Ya,5,3,"tbody",12),i.qZA(),i.qZA(),i.TgZ(33,"div",13),i.YNc(34,Ba,1,1,"chq-button",14),i.qZA(),i.qZA(),i.TgZ(35,"div",15),i.TgZ(36,"div",16),i.TgZ(37,"div",17),i._UZ(38,"img",18),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(4),i.Q6J("ngIf",(null==e.parts?null:e.parts.length)>0),i.xp6(2),i.Q6J("ngIf",!e.hideButton&&!e.commonService.isViewOnly),i.xp6(5),i.Oqu(i.lcZ(12,14,"parts_description")),i.xp6(3),i.Oqu(i.lcZ(15,16,"code")),i.xp6(3),i.Oqu(i.lcZ(18,18,"units")),i.xp6(3),i.AsE("",i.lcZ(21,20,"price_unit"),"(",e.i18n.currencySymbol,")"),i.xp6(3),i.AsE("",i.lcZ(24,22,"total_price"),"(",e.i18n.currencySymbol,")"),i.xp6(3),i.Oqu(i.lcZ(27,24,"status")),i.xp6(3),i.hij("",i.lcZ(30,26,"actions")," "),i.xp6(2),i.Q6J("ngIf",(null==e.parts?null:e.parts.length)>0),i.xp6(1),i.Q6J("ngIf",0===(null==e.parts?null:e.parts.length)),i.xp6(2),i.Q6J("ngIf",!e.hideButton&&!e.commonService.isViewOnly))},directives:[o.O5,Qe.A,Ut.E,o.sg,Mt.Hw,Nt.D],pipes:[yt.X$,o.gd,bo.j],styles:[".repair-part-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-tab-background);padding-top:calc(5px + 1.5vw)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:rgba(255,255,255,.82)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]{justify-content:flex-end}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:53px;padding-top:.5px;justify-content:center}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]   .part-status-label[_ngcontent-%COMP%]{font-size:14px;font-style:normal;font-weight:400;line-height:14px;color:var(--xa-dark-gray)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]   .part-status-text[_ngcontent-%COMP%]{font-size:16px;line-height:20px;display:flex;height:48px;flex-direction:column;justify-content:center;align-items:flex-start;align-self:stretch}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]     chq-dropdown{width:50%}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .button-section-wrapper[_ngcontent-%COMP%]   .button-section[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;grid-gap:10px;gap:10px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{margin-bottom:30px;overflow:scroll;margin-top:30px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-light-gray);background:white}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:12px;line-height:14px;color:var(--xa-black);text-align:left;padding:10px;grid-gap:10px;gap:10px;height:34px;-moz-appearance:none}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:500;background:rgba(26,34,51,.1)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:400;font-size:14px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]     chq-input a, .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]     chq-input a{background-color:var(--xa-popup-light-gray)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .dropdown-parts[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .dropdown-parts[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:5px;gap:5px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td.no-parts[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.no-parts[_ngcontent-%COMP%]{text-align:center}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}"]}),t})();var Ha=(()=>{return(t=Ha||(Ha={})).Start="Start",t.Pause="Pause",t.Stop="Stop",Ha;var t})(),Ga=(()=>{return(t=Ga||(Ga={})).NotStarted="NotStarted",t.Completed="Completed",Ga;var t})();const Qa=function(t){return{selected:t}};function Va(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",3),i.NdJ("click",function(){const e=i.CHM(t).$implicit;return i.oxw().triggerMenuItemClick(e)}),i.TgZ(1,"div",4),i.TgZ(2,"span",5),i._uU(3),i.qZA(),i.TgZ(4,"span"),i._uU(5),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit;i.Q6J("ngClass",i.VKq(5,Qa,t.active)),i.xp6(1),i.Udp("background",t.color),i.xp6(2),i.hij("",t.displayName,"%"),i.xp6(2),i.Oqu(t.name)}}let $a=(()=>{class t{constructor(t,e){this.monitorService=t,this.router=e,this.menuItemClick=new i.vpe,this.router.events.subscribe(()=>{this.setCurrentActiveMenu()})}triggerMenuItemClick(t){this.menuItemClick.emit(t)}splitter(t){const e=null==t?void 0:t.split("/");if((null==e?void 0:e.length)>0){const t=e[e.length-1];return t.includes("?")?t.split("?")[0]:t}return""}setCurrentActiveMenu(){var t,e;null===(t=this.menuItems)||void 0===t||t.map(t=>t.active=!1);const n=this.splitter(location.href),i=null===(e=this.menuItems)||void 0===e?void 0:e.filter(t=>{var e;return this.splitter(t.url)===n||t.childMenuLinks&&(null===(e=t.childMenuLinks)||void 0===e?void 0:e.includes(n))});i&&i.length>0?i[0].active=!0:this.menuItems[0]&&(this.menuItems[0].active=!0)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Et.M),i.Y36(Ot.F0))},t.\u0275cmp=i.Xpm({type:t,selectors:[["button-tabs"]],inputs:{menuItems:"menuItems"},outputs:{menuItemClick:"menuItemClick"},decls:3,vars:1,consts:[[1,"button-wrapper"],[1,"button-toggle"],["class","menu-wrapper",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"menu-wrapper",3,"ngClass","click"],[1,"menu-block"],[1,"head"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.YNc(2,Va,6,7,"div",2),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.Q6J("ngForOf",e.menuItems))},directives:[o.sg,o.mk],styles:[".button-wrapper[_ngcontent-%COMP%]{display:inline-flex;padding:7.31px 0 0 29px;justify-content:flex-start;align-items:center;flex:1;width:100%;overflow-x:auto}.menu-block[_ngcontent-%COMP%]{display:flex;height:59px;padding:10px 11px;align-items:center;grid-gap:12px;gap:12px;justify-content:space-between;border-radius:10px;color:var(--xa-white);width:135px;border:1px solid var(--xa-white);margin-top:13px}.menu-block[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:400;line-height:14px}.menu-block[_ngcontent-%COMP%]   span.head[_ngcontent-%COMP%]{font-size:16px;font-weight:700;line-height:20px}.menu-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:flex-start;grid-gap:20px;gap:20px;border-radius:14px 14px 0 0}.selected[_ngcontent-%COMP%]{background:var(--xa-popup-light-gray);padding:13px 20px}.selected[_ngcontent-%COMP%]   .menu-block[_ngcontent-%COMP%]{margin-top:0}.button-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;padding-top:10px;grid-gap:10px;gap:10px}"]}),t})();var Wa=n(8358),Ka=n(15058),Xa=n(4885);function ts(t,e){1&t&&(i.TgZ(0,"div",18),i.TgZ(1,"span",19),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.Oqu(i.lcZ(3,1,"label_mandatory")))}function es(t,e){1&t&&(i.TgZ(0,"span",31),i._uU(1,"*"),i.qZA())}function ns(t,e){if(1&t&&(i.TgZ(0,"span",32),i._uU(1),i.ALo(2,"date"),i.qZA()),2&t){const t=i.oxw().$implicit;i.xp6(1),i.Oqu(i.xi3(2,1,t.updatedDate,"dd/MM/yyyy hh:mm:ss"))}}function is(t,e){1&t&&i._UZ(0,"div",33)}function os(t,e){1&t&&(i.TgZ(0,"div",34),i._UZ(1,"div",35),i.TgZ(2,"div",36),i._UZ(3,"mat-spinner",37),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Q6J("strokeWidth",2)("diameter",20))}const rs=function(t){return{"not-allowed":t}};function as(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"span",38),i.NdJ("click",function(){i.CHM(t);const e=i.oxw().$implicit;return i.oxw().updateTaskStatus(e)}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("ngClass",i.VKq(1,rs,t.commonService.isViewOnly))}}function ss(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"span",39),i.NdJ("click",function(){i.CHM(t);const e=i.oxw().$implicit;return i.oxw().updateTaskStatus(e)}),i.qZA()}}function ls(t,e){1&t&&(i.TgZ(0,"div",34),i._UZ(1,"div",35),i.TgZ(2,"div",36),i._UZ(3,"mat-spinner",37),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Q6J("strokeWidth",2)("diameter",20))}function cs(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",20),i.TgZ(1,"div",8),i._uU(2),i.YNc(3,es,2,0,"span",21),i.qZA(),i.TgZ(4,"div",9),i._uU(5),i.qZA(),i.TgZ(6,"div",9),i.TgZ(7,"div",22),i.TgZ(8,"span"),i._uU(9),i.qZA(),i.YNc(10,ns,3,4,"span",23),i.qZA(),i.qZA(),i.TgZ(11,"div",9),i.TgZ(12,"div",24),i.TgZ(13,"mat-icon",25),i.NdJ("click",function(e){const n=i.CHM(t).$implicit,o=i.oxw();return e.stopPropagation(),o.showCommentDialog(null==n?null:n.notes,n)}),i.qZA(),i.YNc(14,is,1,0,"div",26),i.qZA(),i.YNc(15,os,4,2,"div",27),i.qZA(),i.TgZ(16,"div",28),i.YNc(17,as,1,3,"span",29),i.YNc(18,ss,1,0,"span",30),i.YNc(19,ls,4,2,"div",27),i._uU(20),i.ALo(21,"translate"),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit;i.xp6(2),i.Oqu(t.name),i.xp6(1),i.Q6J("ngIf",t.isMandatory),i.xp6(2),i.Oqu(t.repairTypeNames),i.xp6(4),i.Oqu(t.modifiedBy),i.xp6(1),i.Q6J("ngIf",t.updatedDate),i.xp6(3),i.Q6J("svgIcon","comment"),i.xp6(1),i.Q6J("ngIf",null==t?null:t.notes),i.xp6(1),i.Q6J("ngIf",t.isNoteLoading),i.xp6(2),i.Q6J("ngIf",t.completedDate&&!t.isLoading),i.xp6(1),i.Q6J("ngIf",!t.completedDate&&!t.isLoading),i.xp6(1),i.Q6J("ngIf",t.isLoading),i.xp6(1),i.hij(" ",i.lcZ(21,12,t.isLoading?"updating_task":"task_done")," ")}}function ds(t,e){1&t&&(i.TgZ(0,"div",40),i.TgZ(1,"label"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.qZA()),2&t&&(i.xp6(2),i.Oqu(i.lcZ(3,1,"no_repair_tasks_available")))}function ps(t,e){if(1&t&&i._UZ(0,"chq-button",42),2&t){const t=i.oxw(2);i.Q6J("buttonModel",t.notifyButtonModel)}}function us(t,e){if(1&t&&i._UZ(0,"chq-button",42),2&t){const t=i.oxw(2);i.Q6J("buttonModel",t.addPartButtonModel)}}function hs(t,e){if(1&t&&(i.ynx(0),i.YNc(1,ps,1,1,"chq-button",41),i.YNc(2,us,1,1,"chq-button",41),i.BQk()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngIf",t.activateNotifyButton&&!t.commonService.isViewOnly&&t.notifyData.communicationList.length>0),i.xp6(1),i.Q6J("ngIf","go_invoice"===t.addPartButtonModel.label||!t.commonService.isViewOnly)}}let gs=(()=>{class t{constructor(t,e,n,o,r){this.monitorService=t,this.dialog=e,this.bookingService=n,this.translateService=o,this.commonService=r,this.updateJobs=new i.vpe,this.confirmJob=new i.vpe,this.taskList=[],this.mandatoryTasks=0,this.allMandatoryTasks=0,this.notifyButtonModel={label:"notify",type:"outline",icon:"send",onclick:this.openNotify.bind(this)},this.addPartButtonModel={label:"Complete Repair",type:"disabled",onclick:this.completeJob.bind(this)}}openNotify(){this.dialog.open(Ka.b,{data:{repairGuid:this.notifyData.repairGuid,domainId:this.notifyData.domainId,templateId:1,communicationList:this.notifyData.communicationList,communicatedList:this.notifyData.communicatedList,method:"notifier"},backdropClass:"confirmation-popup-backdrop",maxHeight:"693px",maxWidth:"629px"}).afterClosed().subscribe({next:t=>{(null==t?void 0:t.notifySend)&&(console.log(t),t.selectedCommunication&&t.selectedCommunication.forEach(e=>{this.notifyData.communicatedList.push({id:0,eventName:t.templateKey,communicationTypeId:e})}),this.commonService.showInfoToast(1e3,"Message sent"))}})}completeJob(){this.confirmJob.emit()}ngOnChanges(t){var e;this.monitorService.logEvent("ngOnChanges",["ChqEstimateDetailsComponent","addenda-repair"]),t&&(this.activateNotifyButton&&t.repairStatus&&t.repairStatus.currentValue&&(this.activateNotifyButton="repairinprogress"===t.repairStatus.currentValue.toLowerCase()),t.repairDataMappings&&t.repairDataMappings.currentValue&&(this.taskList=[...this.repairDataMappings.repairJobTasks],this.taskList.forEach(t=>{const e=t.repairJobMappings.map(t=>t.repairServiceTypeName);t.repairTypeNames=e.join(", ")}),this.mandatoryTasks=this.taskList.filter(t=>!0===t.isMandatory&&"Completed"!==t.statusName).length,this.allMandatoryTasks=this.taskList.filter(t=>!0===t.isMandatory).length),t.activateRepairButton&&t.activateRepairButton.currentValue&&(this.addPartButtonModel=Object.assign(Object.assign({},this.addPartButtonModel),{type:"primary"})),["readytoinvoice","invoiced","paid","complete"].includes(null===(e=this.repairStatus)||void 0===e?void 0:e.toLowerCase())&&this.activateRepairButton&&(this.addPartButtonModel=Object.assign(Object.assign({},this.addPartButtonModel),{label:"go_invoice"})),setTimeout(()=>{this.mandatoryTasks=this.taskList.filter(t=>!0===t.isMandatory&&"Completed"!==t.statusName).length}))}ngOnInit(){var t;this.repairDataMappings&&(this.taskList=[...this.repairDataMappings.repairJobTasks],this.taskList.forEach(t=>{const e=t.repairJobMappings.map(t=>t.repairServiceTypeName);t.repairTypeNames=e.join(", ")}),this.mandatoryTasks=this.taskList.filter(t=>!0===t.isMandatory&&"Completed"!==t.statusName).length,this.allMandatoryTasks=this.taskList.filter(t=>!0===t.isMandatory).length),"readytoinvoice"===(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())&&this.activateRepairButton&&(this.addPartButtonModel=Object.assign(Object.assign({},this.addPartButtonModel),{label:"go_invoice"}))}updateTaskStatus(t){var e,n;if(!this.commonService.isViewOnly){if(!this.repairDataMappings.startDate)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_comment")).afterClosed().subscribe();if((null===(n=null===(e=this.repairDataMappings)||void 0===e?void 0:e.timerLog)||void 0===n?void 0:n.statusName)===Ha.Pause)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_pause_comment")).afterClosed().subscribe();if(!this.repairDataMappings.startDate)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_comment")).afterClosed().subscribe();if(this.repairDataMappings.endDate)return void this.commonService.openAlertDialog(this.translateService.instant("cannot_update_status"),this.translateService.instant("job_completed")).afterClosed().subscribe();if(this.mandatoryTasks<=1&&t.isMandatory)return void this.commonService.openConfirmationOkDialog(this.translateService.instant("confirm_action"),this.translateService.instant("job_no_mandatory_task")).afterClosed().subscribe(e=>{e?(t.isLoading=!0,this.bookingService.updateRepairTaskStatus(t.repairTaskGuid,this.repairDataMappings.repairJobGuid,t.completedDate?Ga.NotStarted:Ga.Completed).subscribe({next:()=>{t.completedDate=t.completedDate?null:new Date,this.mandatoryTasks--,this.updateJobs.emit(),t.isLoading=!1},error:()=>{t.isLoading=!1}})):t.isLoading=!1});t.isLoading=!0,this.bookingService.updateRepairTaskStatus(t.repairTaskGuid,this.repairDataMappings.repairJobGuid,t.completedDate?Ga.NotStarted:Ga.Completed).subscribe({next:()=>{t.completedDate=t.completedDate?null:new Date,this.updateJobs.emit(),t.isLoading=!1},error:()=>{t.isLoading=!1}})}}showCommentDialog(t,e){let n="";t&&(n=t),this.monitorService.logEvent("showCommentDialog",["CommentDialogComponent","addenda-repair"]),this.dialog.open(Wa.E,{data:{notes:n},panelClass:"comment-modalbox",autoFocus:!1}).afterClosed().subscribe({next:t=>{!t||(t.delete&&(t.comment=""),e.isNoteLoading=!0,this.bookingService.updateRepairTaskNotes(this.repairDataMappings.repairJobGuid,t.comment,e.repairTaskGuid).subscribe({next:()=>{e.notes=t.comment,this.updateJobs.emit(),e.isNoteLoading=!1},error:()=>{e.isNoteLoading=!1}}))}})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Et.M),i.Y36(qt.uw),i.Y36($t.q),i.Y36(yt.sK),i.Y36(te.v))},t.\u0275cmp=i.Xpm({type:t,selectors:[["repair-stages-table"]],inputs:{repairDataMappings:"repairDataMappings",notifyData:"notifyData",activateRepairButton:"activateRepairButton",activateNotifyButton:"activateNotifyButton",repairStatus:"repairStatus"},outputs:{updateJobs:"updateJobs",confirmJob:"confirmJob"},features:[i.TTD],decls:33,vars:20,consts:[[1,"card"],[1,"card-header"],[1,"title"],[1,"card-body"],[1,"wrapper"],[1,"header-wrapper"],["class","mandatory-div",4,"ngIf"],[1,"header","row","header-repair"],[1,"col-4"],[1,"col-2"],[1,"data-wrapper"],["class","data-row row",4,"ngFor","ngForOf"],["class","wrapper error-wrapper",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[4,"chqPermission"],[1,"mandatory-div"],[1,"mandatory-text","text-danger"],[1,"data-row","row"],["class","text-danger",4,"ngIf"],[1,"wrapper-span"],["class","span-date",4,"ngIf"],[1,"comment-div"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon","click"],["class","red-icon",4,"ngIf"],["class","loading",4,"ngIf"],[1,"col-2","relate-spinner"],["class","checked",3,"ngClass","click",4,"ngIf"],["class","circle",3,"click",4,"ngIf"],[1,"text-danger"],[1,"span-date"],[1,"red-icon"],[1,"loading"],[1,"overlay"],[1,"spinner"],[3,"strokeWidth","diameter"],[1,"checked",3,"ngClass","click"],[1,"circle",3,"click"],[1,"wrapper","error-wrapper"],["class","submit-button",3,"buttonModel",4,"ngIf"],[1,"submit-button",3,"buttonModel"]],template:function(t,e){1&t&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"h3",2),i._uU(3),i.qZA(),i.qZA(),i.TgZ(4,"div",3),i.TgZ(5,"div",4),i.TgZ(6,"div",5),i.YNc(7,ts,4,3,"div",6),i.TgZ(8,"div",7),i.TgZ(9,"div",8),i._uU(10),i.ALo(11,"translate"),i.qZA(),i.TgZ(12,"div",9),i._uU(13),i.ALo(14,"translate"),i.qZA(),i.TgZ(15,"div",9),i._uU(16),i.ALo(17,"translate"),i.qZA(),i.TgZ(18,"div",9),i._uU(19),i.ALo(20,"translate"),i.qZA(),i.TgZ(21,"div",9),i._uU(22),i.ALo(23,"translate"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(24,"div",10),i.YNc(25,cs,22,14,"div",11),i.YNc(26,ds,4,3,"div",12),i.qZA(),i.qZA(),i.qZA(),i.TgZ(27,"div",13),i.TgZ(28,"div",14),i.TgZ(29,"div",15),i._UZ(30,"img",16),i.qZA(),i.qZA(),i.TgZ(31,"div",14),i.YNc(32,hs,3,2,"ng-container",17),i.qZA(),i.qZA(),i.qZA()),2&t&&(i.xp6(3),i.Oqu(null==e.repairDataMappings?null:e.repairDataMappings.name),i.xp6(4),i.Q6J("ngIf",e.allMandatoryTasks>0),i.xp6(3),i.Oqu(i.lcZ(11,10,"item_name")),i.xp6(3),i.Oqu(i.lcZ(14,12,"repair_type")),i.xp6(3),i.Oqu(i.lcZ(17,14,"modified_by")),i.xp6(3),i.Oqu(i.lcZ(20,16,"notes")),i.xp6(3),i.Oqu(i.lcZ(23,18,"status")),i.xp6(3),i.Q6J("ngForOf",e.taskList),i.xp6(1),i.Q6J("ngIf",e.taskList&&0===e.taskList.length),i.xp6(6),i.Q6J("chqPermission","newBooking"))},directives:[o.O5,o.sg,Qe.A,Mt.Hw,Xa.$g,o.mk,Ut.E],pipes:[yt.X$,o.uU],styles:['.card[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:10px;flex:none;order:0;align-self:stretch;flex-grow:0}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;justify-content:space-between;align-items:center;padding:calc(5px + .5vw);padding-left:30px;height:35px;background:var(--xa-secondary);border-radius:10px 10px 0 0}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:20px;line-height:25px;color:var(--xa-white)}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-weight:500}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]{min-height:60px!important;display:flex;align-items:center}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:12px;line-height:35px;display:flex;align-items:center;color:var(--xa-black-medium)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{padding-left:40px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;background:var(--xa-table-header-light)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:12px;font-weight:500;line-height:35px;letter-spacing:-.25px;height:36px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--xa-black);font-size:12px;font-weight:400;line-height:14px;height:36px;align-items:center;display:flex}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]{padding:14px 0}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{padding-left:30px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   .comment-div[_ngcontent-%COMP%]{position:relative}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   .comment-div[_ngcontent-%COMP%]   .red-icon[_ngcontent-%COMP%]{height:7px;width:7px;position:absolute;background:var(--xa-red);top:3px;right:-1px;border-radius:50%;border:2px solid var(--xa-white)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{border:none;font-style:normal;font-weight:700;font-size:11px;line-height:35px;color:var(--xa-black)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .image-text[_ngcontent-%COMP%]{display:flex;align-items:center;grid-gap:calc(5px + .5vw);gap:calc(5px + .5vw)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .image-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{background:white;padding:0 10px;border-radius:19px;text-transform:capitalize;width:90px;height:20px;font-style:normal;font-size:10px;line-height:10px;display:flex;align-items:center;color:#0b0e15;flex:none;order:0;flex-grow:0;justify-content:center;font-weight:500}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.assigned[_ngcontent-%COMP%]{background:#76D672}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.readyforinvoice[_ngcontent-%COMP%]{background:#B3E573}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.noshow[_ngcontent-%COMP%]{background:#B53E3E;color:#fff}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.pickedup[_ngcontent-%COMP%]{background:#E8DA18}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.likelyouttoday[_ngcontent-%COMP%]{background:#B3E573}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]:nth-child(even){background-color:var(--xa-white-light);margin-right:0;margin-left:0}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--xa-table-light);margin-right:0;margin-left:0}.header-text[_ngcontent-%COMP%]{color:var(--xa-black);font-size:13px;font-weight:700;line-height:35px;letter-spacing:-.25px}.checked[_ngcontent-%COMP%]{border:1px solid var(--xa-repair-header);background-color:var(--xa-repair-header);border-radius:50%;height:20px;width:20px;position:relative;cursor:pointer;margin-right:4px}.circle[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray);background-color:var(--xa-light-radio-gray);border-radius:50%;height:20px;width:20px;position:relative;cursor:pointer;margin-right:4px}.mandatory-div[_ngcontent-%COMP%]{margin-top:10px}.mandatory-text[_ngcontent-%COMP%]{font-size:12px;font-weight:700;padding-left:30px;line-height:20px}.checked[_ngcontent-%COMP%]:after{content:"";position:absolute}.span-date[_ngcontent-%COMP%]{font-size:10px;line-height:14px;font-weight:300}.wrapper-span[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:2px;gap:2px;align-items:flex-start!important;justify-content:center!important}.checked[_ngcontent-%COMP%]:after{left:7px;top:3px;width:4px;height:10px;border:solid var(--xa-white);border-width:0 3px 3px 0;transform:rotate(45deg)}.submit-button[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:20px}.relate-spinner[_ngcontent-%COMP%]{position:relative}.loading[_ngcontent-%COMP%]{margin-left:4px}.error-wrapper[_ngcontent-%COMP%]{padding:12px;justify-content:center}.error-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-align:center}.not-allowed[_ngcontent-%COMP%]{cursor:not-allowed}']}),t})();var ms=n(62119),vs=n(39912),fs=n(9988),bs=n(54135);const _s=["addPhotos"],Ms=["imageUploaders"];function Os(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"add-photos",10,11),i.NdJ("mode",function(e){return i.CHM(t),i.oxw(3).handleMode(e)}),i.qZA()}if(2&t){const t=i.oxw(3);i.Q6J("caseData",t.caseData)("caseNumber",t.photosHeader.caseNumber)("repairUnapproved",t.isInvalidStatus)("showSPI",t.showSPI)("photosHeader",t.addPhotosHeader)("hideBulk",t.hideBulk)("hidden",t.hideContent)("showEstimate",!1)}}function ys(t,e){1&t&&(i.TgZ(0,"div",12),i.TgZ(1,"div",13),i._UZ(2,"img",14),i.TgZ(3,"label",15),i._uU(4," No Content Available "),i.qZA(),i.qZA(),i.TgZ(5,"div",16),i._UZ(6,"div",17),i._UZ(7,"div",17),i._UZ(8,"div",17),i._UZ(9,"div",17),i.qZA(),i.qZA())}function Cs(t,e){if(1&t&&(i.TgZ(0,"div",18),i.TgZ(1,"div",19),i.TgZ(2,"div",20),i._UZ(3,"img",21),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw(3);i.xp6(3),i.MGl("src","assets/img/",+t.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",i.LSH)}}function xs(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"chq-images-uploader",22,23),i.NdJ("handleDeleteAllEvent",function(){return i.CHM(t),i.oxw(3).handleDeleteAll()})("backToUpload",function(){return i.CHM(t),i.oxw(3).setInitialMode()})("updateMassUpload",function(e){return i.CHM(t),i.oxw(3).updateCurrentStatus(e)}),i.qZA()}if(2&t){const t=i.oxw(3);i.Q6J("maximumImages",t.minimumImageJob)("hideAI",!t.displayAI)("hidden",t.showDamageAnalysis||!t.showUploading)("currentAdditionalModeMultiple",t.currentAdditionalModeMultiple)("fileUploaderService",t.currentObservable)("footerOptions",t.footer)("isRepairStage",!0)("isMassUpload",t.isMultipleUpload)("showReTakeDelete",!0)("imageStatusSteps",t.imageStatusSteps)("header",t.photosHeader)("inspectionId",t.inspectionId)("inspection","photos")}}function Ps(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"damage-analysis",24),i.NdJ("backEvent",function(e){return i.CHM(t),i.oxw(3).handleBack(e)}),i.qZA()}if(2&t){const t=i.oxw(3);i.Q6J("isBulkUpload",t.isMultipleUpload)("minPhotoRequired",t.minimumPhotosRequired)("caseDetail",t.partialCaseDetail||t.repairDetail)("steps",t.imageStatusSteps)("isRepairStage",!0)("isRepairModule",t.photosHeader.isRepairModule)("jobId",t.objectId)}}function ws(t,e){if(1&t&&(i.ynx(0),i.YNc(1,Os,2,8,"add-photos",5),i.YNc(2,ys,10,0,"div",6),i.YNc(3,Cs,4,1,"div",7),i.YNc(4,xs,2,13,"chq-images-uploader",8),i.YNc(5,Ps,1,7,"damage-analysis",9),i.BQk()),2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("ngIf",!1===t.showUploading),i.xp6(1),i.Q6J("ngIf",t.noImagesData),i.xp6(1),i.Q6J("ngIf",t.noImagesData),i.xp6(1),i.Q6J("ngIf",(t.showSPI||!t.hideBulk)&&(!0===t.showUploading||t.isMultipleUpload||t.imageStatusSteps&&t.imageStatusSteps.length>0)),i.xp6(1),i.Q6J("ngIf",t.showDamageAnalysis)}}const Ts=function(t){return{"photo-container":t}};function Ds(t,e){if(1&t&&(i.TgZ(0,"div",3),i.YNc(1,ws,6,5,"ng-container",4),i.qZA()),2&t){const t=i.oxw();i.Q6J("ngClass",i.VKq(2,Ts,t.photosHeader.isRepairModule)),i.xp6(1),i.Q6J("chqPermission","repairStages")}}function Ss(t,e){1&t&&i._UZ(0,"no-access-error")}const Is={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let ks=(()=>{class t{constructor(t,e,n,o,r,a,s,l,c,d){this.cd=t,this.commonService=e,this.route=n,this.router=o,this.caseService=r,this.monitorService=a,this.inspectionService=s,this.bookingService=l,this.translateService=c,this.estimateService=d,this.photosHeader=Is,this.currentUploadMode=new i.vpe,this.noImagesData=!1,this.imageStatusSteps=[],this.showUploading=!1,this.isMultipleUpload=!1,this.triggerMassUpload=!1,this.caseStatus="",this.caseId="0",this.bookingId="",this.maximumImages=20,this.setStatus=new i.vpe,this.minimumPhotosRequired=0,this.hideContent=!0,this.currentAdditionalModeMultiple=!1,this.hideUploaders=!1,this.repairTypes=[],this.repairType="",this.repairId="",this.currentRepairStatus="",this.originalSteps=[],this.showNoAccess=!1,this.footer={text:"Next create estimate",icon:"boardview",route:"case/gt",status:"UploadPhotos",caseId:"",currentStatus:"",showButton:!0,showUploadOption:!0,section:"repair-stage"},e.pageName.closed&&(e.pageName=new Zt.X(null)),e.pageName.next("photos"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new Zt.X(!0))}handleBack(t){this.showDamageAnalysis=!t.back}get checkRepairTypes(){return-1===location.href.indexOf("repair")||"repair"!==this.repairType||this.repairTypes.filter(t=>"Body"===t.repairServiceType||"Paint"===t.repairServiceType).length>0}updateCurrentStatus(t){this.monitorService.logEvent("updateCurrentStatus",["RepairPhotosComponent","addenda-quote",{caseId:t}]),t.initial?this.setInitialMode():(this.showUploading=!0,this.uploadBulkUploadFile(t.steps))}handleDeleteAll(){this.setInitialMode()}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","photos"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["RepairPhotosComponent","addenda-quote"])}uploadBulkUploadFile(t){for(let e=0;e<(null==t?void 0:t.length);e++){const n=new Image;n.src=t[e].image,n.onload=()=>{const i={height:n.height,width:n.width,inspectionId:this.inspectionId,templateId:this.inspectionBulkTemplateId,type:this.vehicelType||"",isBulk:!0,isSPI:!1,domainId:3100,objectId:this.objectId},o=t[e];o.uploadInProgress=!0,o.isSkipped=!1,o.isUploadFailed=!1,o.isUploadSuccess=!1,this.monitorService.logEvent("uploadBulkUploadFile",["RepairPhotosComponent","addenda-quote",{uploadObject:i}]),this.inspectionService.uploadImageBulkJob(i,o.imageFile).subscribe({next:t=>{var e;o.url=null===(e=t.rawImage)||void 0===e?void 0:e.rawAzureBlobUrl,o.inspectionItem=t,o.procedureSteps="Bulk Upload Image",this.imageUploaders.updateUploadStatus("success",o,null,t),this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1})},error:t=>{401!=t.status&&(this.imageUploaders.imageStatusSteps=this.imageUploaders.imageStatusSteps.filter(t=>t.index!==o.index||t.stepName!==o.stepName||!0!==t.uploadInProgress),this.imageUploaders.updateUploadStatus("failed",o,t,null,!0)),this.monitorService.logException(t,Qt._.Error)}})}}}uploadFile(t){const e={height:t.imageHeight,width:t.imageWidth,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,inspectionitemId:t.inspectionItem.id,type:this.vehicelType||"",isBulk:!1,isSPI:!0,domainId:3100,objectId:this.objectId};this.monitorService.logEvent("uploadFile",["RepairPhotosComponent","addenda-quote",{uploadObject:e}]),t.uploadInProgress=!0,t.isSkipped=!1,t.isUploadFailed=!1,t.isUploadSuccess=!1,this.commonService.inProgressSteps.next(1),this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1}),this.commonService.showNotification(this.translateService.instant("photos_upload",{value:t.stepName})),this.inspectionService.uploadImageBulkJob(e,t.imageFile).subscribe({next:e=>{var n,i;this.commonService.showNotification(this.translateService.instant("photos_upload_success",{value:t.stepName}));const o=this.inspectionItemTemplates.find(t=>t.inspectionItem.id==(null==e?void 0:e.id));o.inspectionItem.rawAzureBlobUrl=null===(n=e.rawImage)||void 0===n?void 0:n.rawAzureBlobUrl,o&&(t.url=null===(i=e.rawImage)||void 0===i?void 0:i.rawAzureBlobUrl,this.imageUploaders.updateUploadStatus("success",t,null,e))},error:e=>{401!=e.status&&(this.commonService.showNotification(this.translateService.instant("photo_upload_error",{value:t.stepName})),this.imageUploaders.updateUploadStatus("failed",t,e),this.monitorService.logException(e,Qt._.Error))}})}ngOnDestroy(){this.commonService.pageName.unsubscribe(),this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["RepairPhotosComponent","addenda-quote"])}mapInspection(t){if(t)try{this.inspection=t,this.uploadType=this.inspection.uploadType;let e="SPI";this.uploadType&&(this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1})),"Bulk"===this.uploadType&&(e="BULK");const n=this.inspectionTemplates.filter(t=>"Bulk Upload Image"===t.name),i=this.inspection.inspectionItems.filter(t=>("Bulk Upload Image"===t.name||t.inspectionItemTemplateID===n[0].id)&&t.rawAzureBlobUrl);if((null==i?void 0:i.length)>0||"Bulk"===this.uploadType){const t=[];this.currentUploadMode.emit({mode:"multiple"});for(const e in i){const o=Object.assign(Object.assign({},n[0]),{name:i[e].name||n[0].name,inspectionItem:i[e]});t.push(o)}this.inspectionItemTemplates=t}else this.currentUploadMode.emit({mode:"single"}),this.inspectionTemplates.map(t=>{const e=this.inspection.inspectionItems.find(e=>e.inspectionItemTemplateID==t.id);e&&(t.inspectionItem=e)}),this.inspectionItemTemplates=this.inspectionTemplates.filter(t=>"Bulk Upload Image"!=t.name);(null==n?void 0:n.length)>0&&(this.inspectionBulkTemplateId=n[0].id),this.inspectionItemTemplates.map(t=>{var e,n;(null===(e=t.inspectionItem)||void 0===e?void 0:e.rawAzureBlobUrl)?(t.isUploadSuccess=!0,t.image=null===(n=t.inspectionItem)||void 0===n?void 0:n.rawAzureBlobUrl):(t.inspectionItem||(t.inspectionItem={rawAzureBlobUrl:""}),t.inspectionItem.rawAzureBlobUrl="",t.isUploadFailed=!1,t.isUploadSuccess=!1,t.uploadInProgress=!1)}),this.uploadType&&("SPI"===e?(this.isMultipleUpload=!1,this.showUploading=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{title:"back_smart_photo"})),this.minimumPhotosRequired=this.minimumImageJob||this.inspectionItemTemplates.filter(t=>!0!==t.isSkipEnabled).length,this.currentObservable=this.uploadFile.bind(this)):(this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.minimumPhotosRequired=this.minimumImageJob||this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!0,this.isBulkUploaded=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{title:"bulk_upload"}))))}catch(e){console.log(e)}}getInspectionTemplateByObject(){var t,e,n,i,o;for(let r=0;r<(null===(t=this.inspectionItemTemplates)||void 0===t?void 0:t.length);r++){const t=this.inspectionItemTemplates[r],a=(0,Ie.A1)(t,r),s=-1!=(null===(e=a.stepName)||void 0===e?void 0:e.toLowerCase().indexOf("additional photo")),l=-1!=(null===(n=a.stepName)||void 0===n?void 0:n.toLowerCase().indexOf("bulk upload image")),c=s&&!a.url;this.imageStatusSteps.push(Object.assign(Object.assign({},a),{mandatory:!t.isSkipEnabled,index:r,isAdditionalDocumentFromReviewPageOnly:c,isMassUpload:l,updatedDate:a.url?null===(i=null==t?void 0:t.inspectionItem)||void 0===i?void 0:i.updatedDate:"",uploadedDate:a.url?null===(o=null==t?void 0:t.inspectionItem)||void 0===o?void 0:o.created:"",domainId:this.domainId,objectId:this.objectId,uploadedPartGuid:"",uploadedGuid:""}))}}createInspectionForJob(t,e,n){this.inspectionService.createInspectionItemJobDetail({objectId:t,inspectionId:e,templateId:n}).subscribe({next:t=>{const e=t.data;this.uploadType=t.data.uploadType,this.mapInspection(e),setTimeout(()=>{if(this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.isJobLoading=!1,this.uploadType)this.imageUploaders.goToReview();else{if(this.showSPI&&this.hideBulk)return void this.addPhotos.allowSingleUpload();!this.showSPI&&!this.hideBulk&&this.addPhotos.allowMultipleUpload()}}),this.commonService.hideLoading()},error:()=>{this.isJobLoading=!1,this.noImagesData=!0,this.commonService.hideLoading()}})}loadApiData(){const t={};this.isJobLoading=!0,t.jobDetail=this.inspectionService.getInspectionJobDetail(this.inspectionId,this.objectId),(0,_n.D)(t).pipe((0,Mn.K)(t=>(0,On.of)(t))).subscribe({next:t=>{const{jobDetail:e}=t;if(204!==e.status)if(e.body){const t=e.body.data;t&&(this.inspectionDetail=t),this.mapInspection(t),this.getInspectionTemplateByObject(),setTimeout(()=>{if(this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.isJobLoading=!1,this.uploadType)this.imageUploaders.goToReview();else{if(this.showSPI&&this.hideBulk)return void this.addPhotos.allowSingleUpload();!this.showSPI&&!this.hideBulk&&this.addPhotos.allowMultipleUpload()}})}else this.noImagesData=!0,this.commonService.hideLoading();else this.createInspectionForJob(this.objectId,this.inspectionId,this.inspectionTemplateId)},error:()=>{this.noImagesData=!0,this.isJobLoading=!1,this.commonService.hideLoading()}})}ngOnInit(){var t;const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.addPhotosHeader=Object.assign(Object.assign({},this.photosHeader),{isHeaderOnly:!1}),this.monitorService.logEvent("ngOnInit",["RepairPhotosComponent","addenda-quote",{caseId:e,repairId:e}]),this.footer=Object.assign(Object.assign({},this.footer),{caseId:this.photosHeader.isRepairModule?"":e,repairId:this.photosHeader.isRepairModule?e:"",handleBack:this.handleBack.bind(this)}),this.commonService.accessRight.subscribe({next:t=>{t||(this.showNoAccess=!0)}}),this.showSPI||!this.hideBulk?this.loadApiData():(this.bookingService.getRepairDetailByGuid(e).subscribe({next:t=>{const{vehicle:e,repairNumber:n,status:i}=t.data;this.setStatus.emit(i),this.repairDetail=t.data,this.inspectionId=e.inspectionId,this.footer=Object.assign(Object.assign({},this.footer),{isRepairModule:!0,from:Vt.j.repair}),this.commonService.repairDetails.next(t.data),this.commonService.bookingId.next(n)}}),this.hideContent=!1);const n=document.querySelector(".addenda-container");n&&(n.scrollTop=0),this.currentObservable=this.uploadFile.bind(this)}reloadInspection(){this.commonService.showLoading(),this.inspectionId&&this.inspectionService.getInspectionJobDetail(this.inspectionId,this.objectId).subscribe({next:t=>{t&&t.body&&t.body.data&&(this.mapInspection(t.body.data),this.getInspectionTemplateByObject(),this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,setTimeout(()=>{this.hideContent=!1,this.showUploading=!0}))},complete:()=>{this.commonService.hideLoading()}})}setInitialMode(){this.showUploading=!1,this.imageStatusSteps=[],this.triggerMassUpload=!1,this.isBulkUploaded=!1,this.imageUploaders.isReviewSection=!1,this.isMultipleUpload=!1,this.currentAdditionalModeMultiple=!1}handleMode(t){var e;this.monitorService.logEvent("handleMode",["RepairPhotosComponent","addenda-quote",{$event:t}]),this.inspectionId?(this.currentUploadMode.emit(t),"single"===t.mode?(0===(null===(e=this.imageStatusSteps)||void 0===e?void 0:e.length)?(this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,this.minimumPhotosRequired=this.minimumImageJob||this.inspectionItemTemplates.filter(t=>!0!==t.isSkipEnabled).length,this.reloadInspection()):(this.isMultipleUpload=!1,this.showUploading=!0,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.minimumPhotosRequired=this.minimumImageJob||this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!1),this.currentObservable=this.uploadFile.bind(this)):(this.imageStatusSteps=[],this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.triggerMassUpload=!0,this.showUploading=!0)):this.currentUploadMode.emit({mode:"error",id:this.bookingId})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.sBO),i.Y36(te.v),i.Y36(Ot.gz),i.Y36(Ot.F0),i.Y36(wn.n),i.Y36(Et.M),i.Y36(Dn.a),i.Y36($t.q),i.Y36(yt.sK),i.Y36(Ye.H))},t.\u0275cmp=i.Xpm({type:t,selectors:[["repair-photos"]],viewQuery:function(t,e){if(1&t&&(i.Gf(_s,5),i.Gf(Ms,5)),2&t){let t;i.iGM(t=i.CRH())&&(e.addPhotos=t.first),i.iGM(t=i.CRH())&&(e.imageUploaders=t.first)}},inputs:{photosHeader:"photosHeader",displayAI:"displayAI",isInvalidStatus:"isInvalidStatus",objectId:"objectId",showSPI:"showSPI",minimumImageJob:"minimumImageJob",hideBulk:"hideBulk",inspectionId:"inspectionId",currentInspectionTemplate:"currentInspectionTemplate",repairDetail:"repairDetail",inspectionTemplateId:"inspectionTemplateId",inspectionTemplates:"inspectionTemplates"},outputs:{currentUploadMode:"currentUploadMode",setStatus:"setStatus"},decls:3,vars:3,consts:[[3,"showLoading"],[3,"ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass"],[4,"chqPermission"],[3,"caseData","caseNumber","repairUnapproved","showSPI","photosHeader","hideBulk","hidden","showEstimate","mode",4,"ngIf"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"maximumImages","hideAI","hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isRepairStage","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload",4,"ngIf"],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairStage","isRepairModule","jobId","backEvent",4,"ngIf"],[3,"caseData","caseNumber","repairUnapproved","showSPI","photosHeader","hideBulk","hidden","showEstimate","mode"],["addPhotos",""],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[3,"maximumImages","hideAI","hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isRepairStage","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload"],["imageUploaders",""],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairStage","isRepairModule","jobId","backEvent"]],template:function(t,e){1&t&&(i._UZ(0,"chq-customloader",0),i.YNc(1,Ds,2,4,"div",1),i.YNc(2,Ss,1,0,"no-access-error",2)),2&t&&(i.Q6J("showLoading",e.isJobLoading),i.xp6(1),i.Q6J("ngIf",!e.showNoAccess),i.xp6(1),i.Q6J("ngIf",e.showNoAccess))},directives:[mo.h,o.O5,o.mk,Qe.A,ms.b,vs.q,fs.wm,bs.U],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),t})();const Zs=["basicTimer"],As=function(t){return{selected:t}};function qs(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",4),i.NdJ("click",function(){return i.CHM(t),i.oxw().setTabActive("photos")}),i._uU(1),i.ALo(2,"translate"),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("ngClass",i.VKq(4,As,"photos"===t.currentActiveTab)),i.xp6(1),i.Oqu(i.lcZ(2,2,"photos"))}}function Ls(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",14),i.NdJ("click",function(){i.CHM(t);const e=i.oxw(2);return e.currentJobStarted&&!e.currentJobPaused?e.stopJobTimer():e.startJobTimer()}),i._UZ(1,"mat-icon",13),i._uU(2),i.ALo(3,"translate"),i.qZA()}if(2&t){const t=i.oxw(2);i.xp6(1),i.Q6J("svgIcon",t.currentJobStarted&&!t.currentJobPaused?"stop":"start"),i.xp6(1),i.hij(" ",i.lcZ(3,2,t.currentJobStarted&&!t.currentJobPaused?"Stop Job":t.currentJobPaused?"Continue":"Start Job")," ")}}const Es=function(t){return{"row-reverse":t}};function Rs(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",10),i.YNc(1,Ls,4,4,"div",11),i.TgZ(2,"div",12),i.NdJ("click",function(){i.CHM(t);const e=i.oxw();return e.currentJobPaused?e.stopJobTimer():e.pauseJobTimer()}),i._UZ(3,"mat-icon",13),i.qZA(),i.qZA()}if(2&t){const t=i.oxw();i.Q6J("ngClass",i.VKq(3,Es,t.currentJobStarted&&!t.currentJobStopped)),i.xp6(1),i.Q6J("ngIf",!t.currentJobStopped),i.xp6(2),i.Q6J("svgIcon",!t.currentJobStarted||t.currentJobPaused||t.currentJobStopped?"stop":"pause")}}function js(t,e){if(1&t&&i._UZ(0,"cd-timer",17,18),2&t){const t=i.oxw(2);i.Q6J("startTime",t.timeDuration)}}function Fs(t,e){if(1&t&&(i.TgZ(0,"div",15),i.TgZ(1,"span"),i._uU(2),i.ALo(3,"translate"),i.qZA(),i.YNc(4,js,2,1,"cd-timer",16),i.qZA()),2&t){const t=i.oxw();i.xp6(2),i.Oqu(i.lcZ(3,2,t.currentJobStopped?"time_spent":"timer")),i.xp6(2),i.Q6J("ngIf",t.currentJobStarted)}}function Ns(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"repair-stages-table",22),i.NdJ("updateJobs",function(){return i.CHM(t),i.oxw(2).getJobs(!0)})("confirmJob",function(){return i.CHM(t),i.oxw(2).completeJob()}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("repairStatus",t.repairStatus)("activateRepairButton",t.enableCompleteButton)("activateNotifyButton",t.enableNotifyButton)("hidden","photos"===t.currentActiveTab)("repairDataMappings",t.currentJobList)("notifyData",t.notifyData)}}function Us(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"repair-photos",23),i.NdJ("confirmJob",function(){return i.CHM(t),i.oxw(2).completeJob()})("setStatus",function(e){return i.CHM(t),i.oxw(2).setRepairStatus(e)})("currentUploadMode",function(e){return i.CHM(t),i.oxw(2).handleUpdateMode(e)}),i.qZA()}if(2&t){const t=i.oxw(2);i.Q6J("isInvalidStatus",!t.currentStatus)("inspectionTemplates",t.inspectionTemplates)("currentInspectionTemplate",t.currentInspectionTemplate)("repairDetail",t.repairDetail)("inspectionId",t.inspectionId)("inspectionTemplateId",t.inspectionTemplateId)("minimumImageJob",t.currentJobList.minNumOfPhotos)("showSPI",(null==t.currentJobList?null:t.currentJobList.isUploadPhotosRequired)&&t.currentJobList.isSPIEnabled)("displayAI",t.currentJobList.isAIAnalysisEnabled)("hideBulk",!(null!=t.currentJobList&&t.currentJobList.isUploadPhotosRequired&&t.currentJobList.isBulkUploadEnabled))("objectId",null==t.currentJobList?null:t.currentJobList.id)("hidden","tasks"===t.currentActiveTab)("photosHeader",t.header)}}function Js(t,e){if(1&t&&(i.TgZ(0,"div",19),i.YNc(1,Ns,1,6,"repair-stages-table",20),i.YNc(2,Us,1,13,"repair-photos",21),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngIf",t.currentJobList),i.xp6(1),i.Q6J("ngIf",t.currentJobList)}}const Ys=function(t,e){return{selected:t,"all-border":e}};let Bs=(()=>{class t{constructor(t,e,n,i,o,r,a){this.bookingService=t,this.commonService=e,this.inspectionService=n,this.router=i,this.translateService=o,this.route=r,this.monitorService=a,this.header={title:"Upload Images",step:0,description:"",stepName:"back_bulk_upload",rightActionText:"delete_all",rightActionIcon:"delete",isRepairModule:!0,showTitle:!0},this.jobList=null,this.currentActiveIndex=0,this.currentJobStarted=!1,this.currentJobStopped=!1,this.currentJobPaused=!1,this.timeDuration=0,this.repairId="",this.currentActiveTab="tasks",this.isJobLoading=!0,this.currentJobList=null,this.menuItems=[],this.repairStatus="",this.isResumed=!1,this.notifyData={},this.outBoundStatus=""}setTabActive(t){this.currentActiveTab=t}startJobTimer(){var t,e;const n=null===(e=null===(t=this.repairDetail)||void 0===t?void 0:t.booking)||void 0===e?void 0:e.startDate;if(Je(new Date).diff(Je(n),"days")<0)return void this.commonService.showToast(1e3,this.translateService.instant("cannot_start_future_date"));const i=this.currentJobList.repairJobGuid;this.commonService.showLoading(),this.updateJobTimerStatus(i,Ha.Start)}pauseJobTimer(){const t=this.currentJobList.repairJobGuid;this.commonService.showLoading(),this.updateJobTimerStatus(t,Ha.Pause)}get currentStatus(){var t;return["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())}updateJobTimerStatus(t,e){var n,i,o;if(null===(n=this.currentJobList)||void 0===n?void 0:n.endDate)return void this.commonService.hideLoading();if(!["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(null===(i=this.repairStatus)||void 0===i?void 0:i.toLowerCase()))return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("start_job"));const r=null===(o=this.jobList)||void 0===o?void 0:o.filter(t=>t.startDate&&!t.endDate);if(r&&(null==r?void 0:r.length)>0&&e===Ha.Start&&r[0].id!==this.currentJobList.id)return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("job_in_progress",{value:r[0].name}));this.bookingService.updateRepairTimerStatus(t,e).subscribe({next:()=>{var t,n,i,o,r;let a=!1;if(e===Ha.Start)if(this.currentJobStarted=!0,this.currentJobPaused){this.currentJobPaused=!1;try{null===(t=this.basicTimer)||void 0===t||t.resume(),this.isResumed=!0}catch(s){this.isResumed=!1}}else"repairinprogress"!==(null===(n=this.repairDetail)||void 0===n?void 0:n.status.toLowerCase())&&this.bookingService.getRepairDetailByGuid(null===(i=this.repairDetail)||void 0===i?void 0:i.repairGuid).subscribe({next:t=>(0,kt.mG)(this,void 0,void 0,function*(){(null==t?void 0:t.data)&&(this.commonService.repairDetails.next(t.data),this.commonService.bookingId.next(t.data.repairNumber))}),error:t=>{this.monitorService.logException(t,Qt._.Error)}}),a=!0;else e===Ha.Stop?(this.currentJobStopped=!0,this.currentJobPaused&&(null===(o=this.basicTimer)||void 0===o||o.stop(),this.currentJobPaused=!1)):(null===(r=this.basicTimer)||void 0===r||r.stop(),this.currentJobPaused=!0);this.outBoundStatus="Repair In Progress",this.repairStatus="RepairInProgress",this.getJobs(!0,a)},error:()=>{this.commonService.hideLoading()}})}stopJobTimer(){const t=this.currentJobList.repairJobGuid;this.currentJobList.endDate||(this.currentJobList.repairJobTasks.filter(t=>!1===t.isMandatory&&null===t.completedDate).length>0?this.commonService.openConfirmationOkDialog(this.translateService.instant("confirm_action"),this.translateService.instant("confirm_normal_action")).afterClosed().subscribe(e=>{e?(this.commonService.showLoading(),this.updateJobTimerStatus(t,Ha.Stop)):this.commonService.hideLoading()}):(this.commonService.showLoading(),this.updateJobTimerStatus(t,Ha.Stop)))}loadApiData(t){if(t&&"0"!=t){this.commonService.showLoading();const e={inspectionList:this.inspectionService.getInspectionTemplateList(),repairDetail:this.bookingService.getRepairDetailByGuid(t)};this.isJobLoading=!0,(0,_n.D)(e).pipe((0,Mn.K)(t=>(0,On.of)(t))).subscribe({next:t=>{const{inspectionList:e,repairDetail:n}=t;if(n){const{vehicle:t,repairNumber:e,status:i}=n.data;this.setRepairStatus(i),this.repairDetail=n.data,this.inspectionId=t.inspectionId,this.commonService.repairDetails.next(n.data),this.commonService.bookingId.next(e),this.notifyData={repairGuid:this.repairDetail.repairGuid,domainId:this.repairDetail.domainId,communicationList:this.repairDetail.booking.communicationTypeId,communicatedList:this.repairDetail.communicationEvents}}const i=null==e?void 0:e.data;this.outBoundStatus=this.repairDetail.outboundStatus,(null==i?void 0:i.length)>0&&(this.currentInspectionTemplate=i[0],this.inspectionTemplateId=i[0].id);const o={};o.inspectionTemplate=this.inspectionService.getInspectionTemplate(this.inspectionTemplateId),(0,_n.D)(o).pipe((0,Mn.K)(t=>(0,On.of)(t))).subscribe({next:t=>{const{inspectionTemplate:e}=t;this.inspectionTemplates=e.inspectionItemTemplates,this.getJobs(),this.isJobLoading=!1},error:()=>{this.commonService.hideLoading(),this.isJobLoading=!1}})},error:()=>{this.isJobLoading=!1}})}}getJobs(t,e){var n;const i=null===(n=this.route.parent)||void 0===n?void 0:n.snapshot.paramMap.get("id");t?this.commonService.hideLoading():this.commonService.showLoading(),this.bookingService.getRepairTask(i).subscribe({next:n=>(0,kt.mG)(this,void 0,void 0,function*(){var i;if(this.jobList=n.data,0===(null===(i=this.jobList)||void 0===i?void 0:i.length))return void this.commonService.hideLoading();const o=this.jobList.filter(t=>!t.endDate),r=this.jobList.filter(t=>t.startDate);if(this.enableNotifyButton=!1,(null==r?void 0:r.length)>0&&"Repair In Progress"===this.outBoundStatus&&(this.enableNotifyButton=!0),0===(null==o?void 0:o.length))this.enableCompleteButton=!0;else{let t=!1;o.forEach(e=>{e.repairJobTasks&&e.repairJobTasks.length>0&&e.repairJobTasks.filter(t=>!0===t.isMandatory&&null===t.completedDate).length>0&&(t=!0)}),this.enableCompleteButton=!t}t?this.updateActiveTask(this.currentActiveIndex,e,t):(this.menuItems=this.jobList.map(t=>({name:t.name,icon:"",displayName:t.taskCompletionPercentage,url:"",title:t.name,subTitle:"",color:t.color,permission:!0})),this.setActiveJob(this.menuItems[this.currentActiveIndex])),this.commonService.hideLoading()}),error:()=>{this.commonService.hideLoading()}})}setRepairStatus(t){this.repairStatus=t}updateActiveTask(t,e,n){var i;if(this.currentJobList=this.jobList[t],this.currentJobList=Object.assign({},this.currentJobList),this.menuItems[t].displayName=this.currentJobList.taskCompletionPercentage,null===(i=this.currentJobList)||void 0===i?void 0:i.timerLog){const{startDate:t,endDate:i,statusName:o}=this.currentJobList.timerLog,r=Je(new Date),a=Je(t);if(this.currentJobStarted=!0,Ha.Pause===o){if(this.currentJobPaused=!0,i){const t=Je(i).diff(a,"seconds");this.timeDuration=t,this.isResumed=!1,setTimeout(()=>{var t;null===(t=this.basicTimer)||void 0===t||t.stop()})}}else if(Ha.Stop===o){if(this.currentJobStopped=!0,i){const t=Je(i).diff(a,"seconds");this.timeDuration=t,this.isResumed=!1,setTimeout(()=>{var t;null===(t=this.basicTimer)||void 0===t||t.stop()})}}else{if(!e&&n||(this.timeDuration=r.diff(a,"seconds"),!e&&this.isResumed))return;setTimeout(()=>{var t,i;e?null===(t=this.basicTimer)||void 0===t||t.start():(n||null===(i=this.basicTimer)||void 0===i||i.resume(),this.isResumed=!0)})}}}setActiveJob(t){const e=this.jobList.filter(e=>e.name===t.name);if(e.name!==t.name&&(null==e?void 0:e.length)>0){const n=this.menuItems.findIndex(e=>e.name===t.name);this.menuItems.forEach(t=>{t.active=!1}),t.active=!0,this.currentJobStarted=!1,this.currentJobStopped=!1,this.currentJobPaused=!1,this.timeDuration=0,this.menuItems[n]=t,this.menuItems=[...this.menuItems],this.reinitialize=!0,this.currentJobList=null,this.currentActiveTab="tasks",setTimeout(()=>{var t;if(this.currentActiveIndex=n,this.currentJobList=e[0],this.reinitialize=!1,null===(t=this.currentJobList)||void 0===t?void 0:t.timerLog){const{startDate:t,endDate:e,statusName:n}=this.currentJobList.timerLog,i=Je(new Date),o=Je(t);if(this.currentJobStarted=!0,Ha.Pause===n){if(this.currentJobPaused=!0,e){const t=Je(e).diff(o,"seconds");this.timeDuration=t,setTimeout(()=>{this.basicTimer.stop()})}}else if(Ha.Stop===n){if(this.currentJobStopped=!0,e){const t=Je(e).diff(o,"seconds");this.timeDuration=t,setTimeout(()=>{var t;null===(t=this.basicTimer)||void 0===t||t.stop()})}}else this.timeDuration=i.diff(o,"seconds"),setTimeout(()=>{this.basicTimer.resume()})}})}}completeJob(){var t,e;const n=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.jobList.filter(t=>t.startDate&&!t.endDate).length>0?this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("stop_job_complete")).afterClosed().subscribe():["readytoinvoice","invoiced","paid","complete"].includes(null===(e=this.repairStatus)||void 0===e?void 0:e.toLowerCase())?this.router.navigate([`repair/booking/${n}/invoices`]):this.commonService.openConfirmationOkDialog("confirm_completing","complete_repair_process").afterClosed().subscribe({next:t=>{t&&(this.commonService.showLoading(),this.bookingService.updateRepairStatus("ReadytoInvoice",n,"").subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate([`repair/booking/${n}/invoices`])}}))},error:()=>{this.commonService.hideLoading()}})}handleUpdateMode(t){this.header=Object.assign(Object.assign({},this.header),"single"===t.mode?{title:"back_smart_photo"}:{title:"back_bulk_upload"})}ngOnInit(){var t;const e=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.loadApiData(e)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36($t.q),i.Y36(te.v),i.Y36(Dn.a),i.Y36(Ot.F0),i.Y36(yt.sK),i.Y36(Ot.gz),i.Y36(Et.M))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-repair-stages"]],viewQuery:function(t,e){if(1&t&&i.Gf(Zs,5),2&t){let t;i.iGM(t=i.CRH())&&(e.basicTimer=t.first)}},decls:12,vars:12,consts:[[3,"menuItems","menuItemClick"],[1,"content-wrapper"],[1,"control-nav"],[1,"switch"],[3,"ngClass","click"],[3,"ngClass","click",4,"ngIf"],[1,"time-counter"],["class","button-wrapper",3,"ngClass",4,"ngIf"],["class","timer-div",4,"ngIf"],["class","content",4,"ngIf"],[1,"button-wrapper",3,"ngClass"],["class","start-capsule",3,"click",4,"ngIf"],[1,"stop-capsule",3,"click"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon"],[1,"start-capsule",3,"click"],[1,"timer-div"],[3,"startTime",4,"ngIf"],[3,"startTime"],["basicTimer",""],[1,"content"],[3,"repairStatus","activateRepairButton","activateNotifyButton","hidden","repairDataMappings","notifyData","updateJobs","confirmJob",4,"ngIf"],[3,"isInvalidStatus","inspectionTemplates","currentInspectionTemplate","repairDetail","inspectionId","inspectionTemplateId","minimumImageJob","showSPI","displayAI","hideBulk","objectId","hidden","photosHeader","confirmJob","setStatus","currentUploadMode",4,"ngIf"],[3,"repairStatus","activateRepairButton","activateNotifyButton","hidden","repairDataMappings","notifyData","updateJobs","confirmJob"],[3,"isInvalidStatus","inspectionTemplates","currentInspectionTemplate","repairDetail","inspectionId","inspectionTemplateId","minimumImageJob","showSPI","displayAI","hideBulk","objectId","hidden","photosHeader","confirmJob","setStatus","currentUploadMode"]],template:function(t,e){1&t&&(i.TgZ(0,"button-tabs",0),i.NdJ("menuItemClick",function(t){return e.setActiveJob(t)}),i.qZA(),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"div",3),i.TgZ(4,"div",4),i.NdJ("click",function(){return e.setTabActive("tasks")}),i._uU(5),i.ALo(6,"translate"),i.qZA(),i.YNc(7,qs,3,6,"div",5),i.qZA(),i.TgZ(8,"div",6),i.YNc(9,Rs,4,5,"div",7),i.YNc(10,Fs,5,4,"div",8),i.qZA(),i.qZA(),i.YNc(11,Js,3,2,"div",9),i.qZA()),2&t&&(i.Q6J("menuItems",e.menuItems),i.xp6(4),i.Q6J("ngClass",i.WLB(9,Ys,"tasks"===e.currentActiveTab,!(null!=e.currentJobList&&e.currentJobList.isUploadPhotosRequired&&(null!=e.currentJobList&&e.currentJobList.isSPIEnabled||null!=e.currentJobList&&e.currentJobList.isBulkUploadEnabled)))),i.xp6(1),i.Oqu(i.lcZ(6,7,"tasks")),i.xp6(2),i.Q6J("ngIf",(null==e.currentJobList?null:e.currentJobList.isUploadPhotosRequired)&&((null==e.currentJobList?null:e.currentJobList.isSPIEnabled)||(null==e.currentJobList?null:e.currentJobList.isBulkUploadEnabled))),i.xp6(2),i.Q6J("ngIf",!e.commonService.isViewOnly),i.xp6(1),i.Q6J("ngIf",null==e.currentJobList?null:e.currentJobList.isTimerEnabled),i.xp6(1),i.Q6J("ngIf",!e.reinitialize))},directives:[$a,o.mk,o.O5,Mt.Hw,xt,gs,ks],pipes:[yt.X$],styles:[".content-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray);padding:16px 30px}.control-nav[_ngcontent-%COMP%]{display:flex;grid-gap:46px;gap:46px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]{display:flex;padding:8px 16px;align-items:center;grid-gap:10px;gap:10px;border-radius:10px;margin-bottom:20px;background:var(--xa-bold-gray);color:var(--xa-black-medium);font-size:12px;font-weight:400;line-height:14px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .start-capsule[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer;grid-gap:10px;gap:10px;padding:7px 14px;flex-shrink:0;border-radius:18px;border:1px solid var(--xa-light-gray);background:var(--xa-light-capsule-white)}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .start-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:14px;width:14px;cursor:inherit}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]{border-radius:50%;background:var(--xa-bold-gray);display:flex;align-items:center;justify-content:center;padding:8px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:12px;width:12px;fill:var(--xa-lighter-gray)!important}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray)}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:16px!important;width:16px!important;fill:var(--xa-black)!important}button-tabs[_ngcontent-%COMP%]{display:flex}.button-wrapper[_ngcontent-%COMP%]{display:flex;grid-gap:10px;gap:10px}.timer-div[_ngcontent-%COMP%]{display:flex;align-items:center;grid-gap:10px;gap:10px}.switch[_ngcontent-%COMP%]{display:flex;margin-bottom:18px;align-items:center}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;padding:10px 21px;flex-direction:column;align-items:center;grid-gap:10px;gap:10px;cursor:pointer;color:var(--xa-black);font-size:16px;font-style:normal;font-weight:400;line-height:20px;border:1px solid var(--xa-light-gray);background:var(--xa-popup-light-gray)}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{border-radius:8px 0 0 8px}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{border-radius:0 8px 8px 0}.switch[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:var(--xa-secondary);color:var(--xa-white)}.switch[_ngcontent-%COMP%]   .all-border[_ngcontent-%COMP%]{border-radius:8px!important}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:700}.hide-block[_ngcontent-%COMP%]{display:none!important}"]}),t})();var zs=n(20363);const Hs=[{path:"",component:Li},{path:"refresh",component:Li},{path:"document",component:Fi,resolve:{version:Tt.n}},{path:"photos",component:Ri,resolve:{version:Tt.n}},{path:"estimate",component:bn,resolve:{version:Tt.n}},{path:"parts",component:za,resolve:{version:Tt.n}},{path:"repair-stages",component:Bs,resolve:{version:Tt.n}},{path:"invoices",component:Aa,resolve:{version:Tt.n}},{path:"invoicesEdit",component:$o,resolve:{version:Tt.n}}];let Gs=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[o.ez,Ot.Bz.forChild(Hs),It.H,St.m,_t.FA,Mt.Ps,bt,Dt.T,Pt,yt.aw,wt.k,zs.Z,Xa.Cq,va],Ot.Bz,_t.FA,va]}),t})()}}]);