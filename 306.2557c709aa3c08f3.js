(self.webpackChunkcar_heal_quote=self.webpackChunkcar_heal_quote||[]).push([[306],{17771:(ht,at,s)=>{"use strict";s.d(at,{A:()=>O,D:()=>B});const O={draft:"repair/booking/{{repairGUID}}",vehicledetails:"repair/booking/{{repairGUID}}",uploaddocuments:"repair/booking/{{repairGUID}}/document",uploadphotos:"repair/booking/{{repairGUID}}/photos",repairestimation:"repair/booking/{{repairGUID}}/estimate",pendingapproval:"repair/booking/{{repairGUID}}/estimate",approved:"repair/booking/{{repairGUID}}/estimate",reject:"repair/booking/{{repairGUID}}/estimate",rejected:"repair/booking/{{repairGUID}}/estimate",closed:"repair/booking/{{repairGUID}}/invoices",complete:"repair/booking/{{repairGUID}}/invoices",partsorderedpartially:"repair/booking/{{repairGUID}}/parts",partsordered:"repair/booking/{{repairGUID}}/parts",repairinprogress:"repair/booking/{{repairGUID}}/repair-stages",readytoinvoice:"repair/booking/{{repairGUID}}/invoices",invoiced:"repair/booking/{{repairGUID}}/invoices",paid:"repair/booking/{{repairGUID}}/invoices",others:"repair/booking/{{repairGUID}}"},B={draft:"quote/case/{{caseGUID}}",vehicledetails:"quote/case/{{caseGUID}}/vehicle",uploaddocuments:"quote/case/{{caseGUID}}/document",uploadphotos:"quote/case/{{caseGUID}}/photos",aianalysis:"quote/case/{{caseGUID}}/ai",repairestimation:"quote/case/{{caseGUID}}/estimate",approved:"quote/case/{{caseGUID}}/estimate",reject:"quote/case/{{caseGUID}}/estimate",rejected:"quote/case/{{caseGUID}}/estimate",closed:"quote/case/{{caseGUID}}/estimate",complete:"quote/case/{{caseGUID}}/estimate",others:"quote/case/{{caseGUID}}/estimate"}},15058:(ht,at,s)=>{"use strict";s.d(at,{b:()=>$});var O=s(24006),B=s(7274),j=s(71764),r=s(83853),c=s(94650),J=s(12484),a=s(85567),Z=s(81364),e=s(21937),Y=s(36895),S=s(97392),H=s(14315),o=s(36978),V=s(89383);const it=["emailRef"],t=["codeRef"],rt=["phoneRef"];function ot(y,X){1&y&&(c.TgZ(0,"h3"),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&y&&(c.xp6(1),c.Oqu(c.lcZ(2,1,"send_message")))}function ct(y,X){1&y&&(c.TgZ(0,"div",10),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&y&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"status_already_send")," "))}function pt(y,X){1&y&&(c.TgZ(0,"div",26),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&y&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"select_one_communication")," "))}function gt(y,X){if(1&y){const _=c.EpF();c.TgZ(0,"div",12)(1,"div",15)(2,"chq-input",13),c.NdJ("controlOutput",function(R){c.CHM(_);const G=c.oxw(3);return c.KtG(G.onFormUpdate(R))}),c.qZA()()()}if(2&y){const _=c.oxw(3);c.xp6(2),c.Q6J("inputModel",_.emailForm.cc)}}function I(y,X){if(1&y){const _=c.EpF();c.TgZ(0,"div",12)(1,"div",15)(2,"chq-input",13),c.NdJ("controlOutput",function(R){c.CHM(_);const G=c.oxw(3);return c.KtG(G.onFormUpdate(R))}),c.qZA()()()}if(2&y){const _=c.oxw(3);c.xp6(2),c.Q6J("inputModel",_.emailForm.ccExtra)}}function W(y,X){if(1&y&&(c.TgZ(0,"div",27)(1,"label",24),c._uU(2),c.ALo(3,"translate"),c.qZA(),c._UZ(4,"label",28),c.qZA()),2&y){const _=c.oxw(3);c.xp6(2),c.hij("",c.lcZ(3,2,"subject")," "),c.xp6(2),c.Q6J("innerHTML",_.data.subject,c.oJD)}}function P(y,X){if(1&y){const _=c.EpF();c.TgZ(0,"div",11)(1,"div",12)(2,"chq-input",13),c.NdJ("controlOutput",function(R){c.CHM(_);const G=c.oxw(2);return c.KtG(G.onFormUpdate(R))}),c.qZA(),c.YNc(3,pt,3,3,"div",14),c.qZA(),c.TgZ(4,"div",12)(5,"div",15)(6,"chq-input",13,16),c.NdJ("controlOutput",function(R){c.CHM(_);const G=c.oxw(2);return c.KtG(G.onFormUpdate(R))}),c.qZA()()(),c.YNc(8,gt,3,1,"div",17),c.YNc(9,I,3,1,"div",17),c.TgZ(10,"div",18)(11,"div",19)(12,"chq-input",13,20),c.NdJ("controlOutput",function(R){c.CHM(_);const G=c.oxw(2);return c.KtG(G.onFormUpdate(R))}),c.qZA(),c.TgZ(14,"div",21)(15,"chq-input",13,22),c.NdJ("controlOutput",function(R){c.CHM(_);const G=c.oxw(2);return c.KtG(G.onFormUpdate(R))}),c.qZA()()()(),c.YNc(17,W,5,4,"div",23),c.TgZ(18,"div",12)(19,"label",24),c._uU(20),c.ALo(21,"translate"),c.qZA(),c.TgZ(22,"div",15),c._UZ(23,"div",25),c.qZA()()()}if(2&y){const _=c.oxw(2);c.xp6(2),c.Q6J("inputModel",_.communicationOptions),c.xp6(1),c.Q6J("ngIf",_.communicationTouched&&0===_.emailRequest.communicationTypeIds.length),c.xp6(3),c.Q6J("inputModel",_.emailForm.email),c.xp6(2),c.Q6J("ngIf",_.showCC),c.xp6(1),c.Q6J("ngIf",_.showCC),c.xp6(3),c.Q6J("inputModel",_.dropdownModel),c.xp6(3),c.Q6J("inputModel",_.emailForm.phone),c.xp6(2),c.Q6J("ngIf",_.data.subject),c.xp6(3),c.Oqu(c.lcZ(21,10,"message")),c.xp6(3),c.Q6J("innerHTML",_.data.body,c.oJD)}}function L(y,X){if(1&y&&(c.TgZ(0,"div",29),c._UZ(1,"chq-button",30),c.qZA()),2&y){const _=c.oxw(2);c.xp6(1),c.Q6J("buttonModel",_.sendButton)}}function K(y,X){if(1&y){const _=c.EpF();c.TgZ(0,"div",1)(1,"div",2),c.YNc(2,ot,3,3,"h3",3),c.YNc(3,ct,3,3,"div",4),c.TgZ(4,"div",5),c.NdJ("click",function(){c.CHM(_);const R=c.oxw();return c.KtG(R.cancel())}),c._UZ(5,"mat-icon",6),c.qZA()(),c.TgZ(6,"div",7),c.YNc(7,P,24,12,"div",8),c.qZA(),c.YNc(8,L,2,1,"div",9),c.qZA()}if(2&y){const _=c.oxw();c.xp6(2),c.Q6J("ngIf",!_.allCommunicationSent),c.xp6(1),c.Q6J("ngIf",_.allCommunicationSent),c.xp6(2),c.Q6J("svgIcon","cross"),c.xp6(2),c.Q6J("ngIf",!_.allCommunicationSent),c.xp6(1),c.Q6J("ngIf",!_.allCommunicationSent)}}let $=(()=>{class y{constructor(_,U,R,G,Mt,N){this.dialogRef=_,this.monitorService=U,this.coreService=R,this.commonService=G,this.notifyService=Mt,this.data=N,this.showCC=!1,this.emailRequest={subject:"",messageContent:"",toEmails:[],ccEmails:[],phoneNumber:"",communicationTypeIds:[],templateKey:""},this.pageReady=!1,this.emailForm={email:{label:"email_address",name:"email",placeHolder:"email_address",value:"",type:"text",validation:{name:"email",validationFunction:()=>O.kI.compose([O.kI.required,(0,r.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:F=>F.required?"email_required":F.invalidEmailNumber?"email_invalid_number":F.invalidEmail?"email_valid":""},disabled:!0},phone:{label:"mobile_number",name:"phone",placeHolder:"mobile_number",value:"",type:"number",validation:{name:"phone",validationFunction:()=>O.kI.compose([O.kI.required,O.kI.pattern("^[0-9]+[0-9 ,.'-]+$")]),validationMessage:F=>F.required?"required_mobile_number":F.pattern?"valid_mobile_number":""},disabled:!0},cc:{label:"CC",name:"cc",placeHolder:"CC",value:"",type:"text",validation:{name:"cc",validationFunction:()=>O.kI.compose([O.kI.email,O.kI.maxLength(50),O.kI.pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:F=>F.maxlength?"email_length":F.pattern||F.email?"email_valid":""}},ccExtra:{label:"CC",name:"ccExtra",placeHolder:"CC",value:"",type:"text",validation:{name:"ccExtra",validationFunction:()=>O.kI.compose([O.kI.email,O.kI.maxLength(50),O.kI.pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:F=>F.maxlength?"email_length":F.pattern||F.email?"email_valid":""}}},this.communicationOptions={placeHolder:"communication",name:"communication",label:"",value:"",type:"checkbox",options:[]},this.dropdownModel={placeHolder:"select_dot",label:"code",name:"code",value:0,type:"select",showImageFlag:!0,displayValue:"phoneCountryCode",fieldValue:"phoneCountryCode",options:[{label:"+90"},{label:"+971"},{label:"+977"}],validation:{name:"code",validationFunction:()=>O.kI.compose([O.kI.required]),validationMessage:F=>F.required?"required_code":""},disabled:!0},this.selectedCode="",this.allCommunicationSent=!1,this.communicationTouched=!1,this.ccValue="",this.ccExtraValue="",this.ccIsValid=!0,this.ccExtraIsvalid=!0,this.phoneIsValid=!0}onFormUpdate(_){if("communication"===_.name){const U=this.emailRequest.communicationTypeIds||[],R=Number(_.keyFieldValue);if(_.value)-1===U.indexOf(R)&&U.push(R);else{const G=U.indexOf(R);U.splice(G,1)}this.emailRequest.communicationTypeIds=U,this.communicationTouched=!0,this.emailRequest.communicationTypeIds.includes(2)?(this.emailForm.email={...this.emailForm.email,disabled:!1,validation:{name:"email",validationFunction:()=>O.kI.compose([O.kI.required,(0,r.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:G=>G.required?"email_required":G.invalidEmailNumber?"email_invalid_number":G.invalidEmail?"email_valid":""}},this.emailRef?.setDirty()):(this.emailForm.email={...this.emailForm.email,disabled:!0,validation:null},this.emailRef?.setUnTouched()),this.emailRequest.communicationTypeIds.includes(1)||this.emailRequest.communicationTypeIds.includes(3)?(this.dropdownModel={...this.dropdownModel,disabled:!1,validation:{name:"code",validationFunction:()=>O.kI.compose([O.kI.required]),validationMessage:G=>G.required?"required_code":""}},this.emailForm.phone={...this.emailForm.phone,disabled:!1,validation:{name:"phone",validationFunction:()=>O.kI.compose([O.kI.required,O.kI.pattern("^[0-9]+[0-9 ,.'-]+$")]),validationMessage:G=>G.required?"required_mobile_number":G.pattern?"valid_mobile_number":""}},this.codeRef&&(this.codeRef?.setDirty(),this.codeRef.dropdownContainer.dropdownConfig.isTouched=!0,this.selectedCode||(this.codeRef.dropdownValidationMessage="required_code")),this.phoneRef?.setDirty()):(this.emailForm.phone={...this.emailForm.phone,disabled:!0,validation:null},this.dropdownModel={...this.dropdownModel,disabled:!0,validation:null},this.codeRef&&(this.codeRef?.setUnTouched(),this.codeRef.dropdownValidationMessage="",this.codeRef.dropdownContainer.dropdownConfig.isDirty=!1,this.codeRef.dropdownContainer.dropdownConfig.isTouched=!1,this.codeRef.dropdownContainer.empty=!1),this.phoneRef?.setUnTouched())}else if("email"===_.name)this.emailRequest.toEmails=_.isValid?"email"===_.name?_.value?.split(",")||[]:_.value:[],this.sendButton=this.emailRequest.toEmails&&this.emailRequest.toEmails.length>0?{...this.sendButton,type:"primary"}:{...this.sendButton,type:"disabled"},this.emailForm.email.value=_.value;else if("code"===_.name){this.selectedCode=_.value.phoneCountryCode;const R=_.value.regExpression;this.dropdownModel={...this.dropdownModel,selectedOption:_.value},this.phoneRef?.updateCurrentValidation(R,!0),this.dropdownModel.value=_.value}else"phone"===_.name?(this.emailRequest.phoneNumber=_.value,this.phoneIsValid=!!_.isValid,this.emailForm.phone.value=_.value):"cc"===_.name?_.isValid?(this.ccIsValid=!0,this.ccValue=_.value):this.ccIsValid=!1:"ccExtra"===_.name&&(_.isValid?(this.ccExtraIsvalid=!0,this.ccExtraValue=_.value):this.ccExtraIsvalid=!1);if("cc"===_.name||"ccExtra"===_.name){const U=[];this.ccValue&&U.push(this.ccValue),this.ccExtraValue&&U.push(this.ccExtraValue),this.emailRequest.ccEmails=U}this.checkCanValidateSend()}cancel(){this.monitorService.logEvent("send",["NotifyDialogComponent","addenda"]),this.dialogRef.close()}send(){this.monitorService.logEvent("send",["NotifyDialogComponent","addenda"]);const _={...this.emailRequest,phoneNumber:this.selectedCode+this.emailRequest.phoneNumber,subject:btoa(this.emailRequest.subject),messageContent:btoa(this.emailRequest.messageContent),parameters:[{name:"pickupdate",value:this.pickUpDate}]};this.emailRequest.communicationTypeIds.includes(1)||this.emailRequest.communicationTypeIds.includes(3)||(_.phoneNumber=null),this.emailRequest.communicationTypeIds.includes(2)||(_.toEmails=[]),this.commonService.showLoading(),this.notifyService.sendNotify(this.data.repairGuid,_).subscribe({next:()=>{this.commonService.hideLoading(),this.dialogRef.close({notifySend:!0,templateKey:this.emailRequest.templateKey,selectedCommunication:this.emailRequest.communicationTypeIds})},error:()=>{this.commonService.hideLoading()}})}ngOnInit(){this.getNotifyTemplate(),this.sendButton={label:"send",type:"disabled",icon:"send",onclick:this.send.bind(this)}}getNotifyTemplate(){this.commonService.showLoading(),this.notifyService.getNotifyTemplate(this.data.repairGuid,this.data.domainId,this.data.templateId).subscribe({next:_=>{this.commonService.hideLoading(),this.data.subject=_[1].data.subject.replace("{{Make}}",_[0].data.vehicle.vehicleMake).replace("{{Model}}",_[0].data.vehicle.vehicleModel).replace("{{License Plate}}",_[0].data.vehicle.licensePlateNumber).replace("{{make}}",_[0].data.vehicle.vehicleMake).replace("{{model}}",_[0].data.vehicle.vehicleModel).replace("{{licensenumber}}",_[0].data.vehicle.licensePlateNumber),this.pickUpDate=j(_[0].data.pickUpDate).local().format("DD/MM/YYYY h:mm a"),this.data.body=_[1].data.body.replace("{{firstname}}",_[0].data.customer.firstName).replace("{{lastname}}",_[0].data.customer.lastName).replace("{{make}}",_[0].data.vehicle.vehicleMake).replace("{{model}}",_[0].data.vehicle.vehicleModel).replace("{{licensenumber}}",_[0].data.vehicle.licensePlateNumber).replace("{{pickupdate}}",this.pickUpDate).replace("{{message}}","").replace("{{orgname}}",_[0].data.organizationDetail.nameOfOrganization).replace("{{orgcontactnumber}}",_[0].data.organizationDetail.phoneNumber),this.emailRequest={...this.emailRequest,subject:this.data.subject,messageContent:this.data.body,templateKey:_[1].data.templateKey},this.monitorService.logEvent("ngOnInit",["NotifyDialogComponent","addenda"]),this.dropdownModel.selectedOption||(this.dropdownModel.selectedOption={}),this.dropdownModel.selectedOption[this.dropdownModel.displayValue]=_[0].data.customer.countryCode||"+91",this.dropdownModel.observable||(this.dropdownModel.observable=this.coreService.getPhoneNumber()),this.selectedCode=_[0].data.customer.countryCode||"+91",this.selectedCode&&(this.dropdownModel.onObservableLoad=this.onObservableLoad.bind(this)),_[0].data.customer.email&&(this.emailForm.email={...this.emailForm.email,value:_[0].data.customer.email},this.emailRequest={...this.emailRequest,toEmails:[_[0].data.customer.email]}),_[0].data.customer.mobileNumber&&(this.emailForm.phone={...this.emailForm.phone,value:_[0].data.customer.mobileNumber},this.emailRequest={...this.emailRequest,phoneNumber:_[0].data.customer.mobileNumber}),this.communicationOptions.options=[{label:"SMS",value:"3",checked:!1,disabled:!(this.data.communicationList.includes(3)&&!this.data.communicatedList.some(U=>3==U.communicationTypeId&&U.eventName==_[1].data.templateKey))},{label:"Email",value:"2",checked:!1,disabled:!(this.data.communicationList.includes(2)&&!this.data.communicatedList.some(U=>2==U.communicationTypeId&&U.eventName==_[1].data.templateKey))},{label:"Whatsapp",value:"1",checked:!1,disabled:!(this.data.communicationList.includes(1)&&!this.data.communicatedList.some(U=>1==U.communicationTypeId&&U.eventName==_[1].data.templateKey))}],this.allCommunicationSent=!this.communicationOptions.options.some(U=>!U.disabled),this.pageReady=!0,this.checkCanValidateSend()},error:_=>{this.commonService.hideLoading(),this.pageReady=!0}})}checkCanValidateSend(){let _=!1;this.emailRequest.communicationTypeIds?.length>0&&(this.emailRequest.phoneNumber||!(this.emailRequest.communicationTypeIds.includes(1)||this.emailRequest.communicationTypeIds.includes(3)))&&(this.emailRequest.toEmails?.length>0||!this.emailRequest.communicationTypeIds.includes(2))&&this.ccIsValid&&this.ccExtraIsvalid&&(this.phoneIsValid||!(this.emailRequest.communicationTypeIds.includes(1)||this.emailRequest.communicationTypeIds.includes(3)))&&(_=!0),this.sendButton=_?{...this.sendButton,type:"primary"}:{...this.sendButton,type:"disabled"}}onObservableLoad(_){if(this.monitorService.logEvent("onObservableLoad",["EditMobileDialogComponent","addenda-quote"]),_){if(_&&_.length>0){const U=_.filter(R=>R.phoneCountryCode===this.selectedCode);if(U.length>0){const R=U[0],G=R.regExpression;this.dropdownModel={...this.dropdownModel,selectedOption:R},this.phoneRef?.updateCurrentValidation(G,!0)}}}else this.dialogRef.close()}}return y.\u0275fac=function(_){return new(_||y)(c.Y36(B.so),c.Y36(J.M),c.Y36(a.p),c.Y36(Z.v),c.Y36(e.c),c.Y36(B.WI))},y.\u0275cmp=c.Xpm({type:y,selectors:[["notify-dialog"]],viewQuery:function(_,U){if(1&_&&(c.Gf(it,5),c.Gf(t,5),c.Gf(rt,5)),2&_){let R;c.iGM(R=c.CRH())&&(U.emailRef=R.first),c.iGM(R=c.CRH())&&(U.codeRef=R.first),c.iGM(R=c.CRH())&&(U.phoneRef=R.first)}},decls:1,vars:1,consts:[["class","dialog-container",4,"ngIf"],[1,"dialog-container"],[1,"header"],[4,"ngIf"],["style","padding: 8px;padding-right: 30px;",4,"ngIf"],[1,"close-icon",3,"click"],[3,"svgIcon"],["mat-dialog-content","",1,"email-dialog-body"],["class","form-container",4,"ngIf"],["class","btn-container",4,"ngIf"],[2,"padding","8px","padding-right","30px"],[1,"form-container"],[1,"input-wrapper"],[3,"inputModel","controlOutput"],["class","invalid",4,"ngIf"],[1,"div-wrapper"],["emailRef",""],["class","input-wrapper",4,"ngIf"],[1,"input-wrapper",2,"margin-bottom","34px"],[1,"div-wrapper","flex"],["codeRef",""],[1,"input-container"],["phoneRef",""],["class","input-wrapper label-wrapper",4,"ngIf"],[1,"title"],[1,"message",3,"innerHTML"],[1,"invalid"],[1,"input-wrapper","label-wrapper"],[3,"innerHTML"],[1,"btn-container"],[1,"right",3,"buttonModel"]],template:function(_,U){1&_&&c.YNc(0,K,9,5,"div",0),2&_&&c.Q6J("ngIf",U.pageReady)},dependencies:[Y.O5,S.Hw,B.xY,H.D,o.E,V.X$],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--xa-popup-light-gray)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:30px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-bottom:24px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:first-child{text-transform:uppercase;font-size:12px;line-height:14px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .div-wrapper.flex[_ngcontent-%COMP%]{gap:5px;height:60px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .div-wrapper.flex[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{width:100%}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{display:flex;gap:20px;flex-direction:column}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;line-height:14px;font-weight:400}.dialog-container[_ngcontent-%COMP%]   .email-dialog-body[_ngcontent-%COMP%]{max-height:calc(90vh - 174px)!important;padding:0 30px!important}.dialog-container[_ngcontent-%COMP%]   .attachment-list[_ngcontent-%COMP%]{margin-bottom:24px}.toggle-wrapper[_ngcontent-%COMP%]{margin-top:22px;font-weight:400;font-size:12px;color:var(--xa-neutral-black);display:flex;gap:10px;align-items:center;line-height:14px}.files[_ngcontent-%COMP%]{display:flex;justify-content:space-between;border-top:1px solid var(--xa-border-gray);padding:5px 0;align-items:center}.files[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-black);font-size:12px;font-weight:500;line-height:14px}.files[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-red)!important}.attachment-icon[_ngcontent-%COMP%]{gap:26px;display:flex}.attachment-header[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-family:Inter;font-size:8px;margin-bottom:8px;font-weight:400;line-height:12px;text-transform:uppercase}.files[_ngcontent-%COMP%]:last-child{border-bottom:1px solid var(--xa-border-gray)}.cc-span[_ngcontent-%COMP%]{position:absolute;right:10px;font-size:16px;line-height:14px;top:44px;color:var(--xa-black-medium);cursor:pointer}.message[_ngcontent-%COMP%]{color:var(--xa-black-dark);margin-bottom:18px;font-size:16px;font-weight:400;line-height:20px;letter-spacing:0em}.div-wrapper[_ngcontent-%COMP%]{position:relative}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;padding:0 30px 30px;background:var(--xa-popup-light-gray)}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not([type=radio]){width:auto!important}.invalid[_ngcontent-%COMP%]{margin-top:3px;font-style:normal;font-weight:400;font-size:12px;line-height:12px;color:var(--xa-red);flex:none;order:2;align-self:stretch;flex-grow:0}"]}),y})()},92498:(ht,at,s)=>{"use strict";s.d(at,{o:()=>Wt});var O=s(71764),B=s(31545),j=s(25268),tt=s(25454),r=s(91009),c=s(39646),J=s(4128),a=s(54004),Z=s(70262),e=s(17771),Y=s(56785),S=s(7274),H=s(81390),o=s(39300),V=s(18505),it=s(95698),t=s(94650),rt=s(81364),ot=s(36895),ct=s(97392),pt=s(65513),gt=s(10266),I=s(22406),W=s(89383);function P(g,T){if(1&g&&(t.ynx(0),t.TgZ(1,"span",22),t._uU(2),t.qZA(),t.BQk()),2&g){const n=t.oxw();t.xp6(2),t.Oqu(n.joinAssignees(n.data.Assignees))}}function L(g,T){1&g&&(t.TgZ(0,"span",14),t._uU(1,"-"),t.qZA())}function K(g,T){if(1&g&&(t.ynx(0),t._UZ(1,"mat-icon",24),t.BQk()),2&g){const n=T.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("svgIcon",i.iconMapper[n.RepairServiceTypeName])("matTooltip",n.RepairServiceTypeName)}}function $(g,T){if(1&g&&(t.TgZ(0,"div",11)(1,"div",12)(2,"label"),t._uU(3),t.ALo(4,"translate"),t.YNc(5,K,2,2,"ng-container",23),t.qZA()()()),2&g){const n=t.oxw();t.xp6(3),t.hij("",t.lcZ(4,2,"repair_type"),": "),t.xp6(2),t.Q6J("ngForOf",n.data.RepairServiceTypes)}}function y(g,T){if(1&g&&(t.TgZ(0,"div",11)(1,"div",12)(2,"label"),t._uU(3),t.ALo(4,"translate"),t.TgZ(5,"span",14),t._uU(6),t.qZA()()()()),2&g){const n=t.oxw();t.xp6(3),t.hij("",t.lcZ(4,2,"stage"),": "),t.xp6(3),t.Oqu(n.data.Stage||"-")}}function X(g,T){if(1&g&&(t.TgZ(0,"div",12)(1,"label"),t._uU(2),t.ALo(3,"translate"),t.TgZ(4,"div",25)(5,"div",26),t._UZ(6,"mat-icon",27),t.qZA()()()()),2&g){const n=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,3,"parts"),": "),t.xp6(3),t.Q6J("matTooltip",n.data.RepairPartsGeneralStatus||"Not Ordered"),t.xp6(1),t.Q6J("svgIcon",n.partsIconMapper[n.data.RepairPartsGeneralStatus||"Not Ordered"])}}function _(g,T){1&g&&(t.TgZ(0,"label",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&g&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"edit_booking")))}function U(g,T){1&g&&(t.TgZ(0,"label",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&g&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"view_booking")))}const R=function(){return{mode:"edit"}};function G(g,T){if(1&g&&(t.TgZ(0,"a",28),t._UZ(1,"mat-icon",29),t.YNc(2,_,3,3,"label",30),t.YNc(3,U,3,3,"label",30),t.qZA()),2&g){const n=t.oxw();t.Q6J("routerLink",n.bookingStatusUrl)("queryParams",t.DdM(5,R)),t.xp6(1),t.Q6J("svgIcon","edit"),t.xp6(1),t.Q6J("ngIf",!n.data.isReadOnlyPermission),t.xp6(1),t.Q6J("ngIf",n.data.isReadOnlyPermission)}}function Mt(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(n);const d=t.oxw(2);return t.KtG(d.deleteBooking(d.data.BookingGuid))}),t._UZ(1,"mat-icon",29),t.TgZ(2,"label",31),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&g&&(t.xp6(1),t.Q6J("svgIcon","delete"),t.xp6(2),t.Oqu(t.lcZ(4,2,"cancel_booking")))}function N(g,T){1&g&&(t.TgZ(0,"div",11)(1,"div",12),t.YNc(2,Mt,5,4,"button",32),t.qZA()()),2&g&&(t.xp6(2),t.Q6J("chqPermission","newBooking"))}function F(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"div",34)(3,"label",35),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",36)(7,"chq-toggle",37),t.NdJ("ToggleChange",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onToggleChange(d))}),t.qZA()()()()()}if(2&g){const n=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,3,"arrived")),t.xp6(3),t.Q6J("checked",n.isArrived)("name","arrived")}}function f(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"div",11)(1,"div",12)(2,"div",34)(3,"label",35),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",36)(7,"chq-toggle",37),t.NdJ("ToggleChange",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onToggleChange(d))}),t.qZA()()()()()}if(2&g){const n=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,3,"no_show")),t.xp6(3),t.Q6J("checked",n.isNoShow)("name","noshow")}}const m=function(g){return{"background-color":g}};let A=(()=>{class g{constructor(n,i,d,h,x,q){this.dialog=n,this.dialogRef=i,this.data=d,this.router=h,this.calendarService=x,this.commonService=q,this.iconMapper={Body:"car",Maintenance:"house",Paint:"paintbrush",Tyres:"tire",Electric:"bolt-car",Tires:"tire",Electrical:"bolt-car",Mechanical:"mechanical",Diagnosis:"diagnosis",Others:"gears"},this.isArrived=!1,this.isNoShow=!1,this.isArrivedVisible=!1,this.isNoShowVisible=!1,this.isRepairCreatedFromCase=!1,this.status="",this.changesMade=!1,this.partsIconMapper={Ordered:"parts-ordered","Arrived Partially":"parts-arrived-partial",Arrived:"parts-arrived","Ordered Partially":"parts-ordered-partial","Not Ordered":"parts-not-ordered"},h.events.pipe((0,o.h)(dt=>dt instanceof H.OD),(0,V.b)(()=>this.dialogRef.close()),(0,it.q)(1)).subscribe()}get bookingStatusUrl(){const{StatusName:n,ObjectGuid:i}=this.data;let d=e.A[n?.replace(/\s/g,"")?.toLowerCase()]||e.A.others;return d=d.replace("{{repairGUID}}",i),d}get showDelete(){return"draft"===this.status?.toLowerCase()||1==this.isRepairCreatedFromCase&&"repairestimation"==this.status?.toLowerCase()}ngOnInit(){this.isArrived=this.data.IsArrived,this.isNoShow=this.data.IsNoShow,this.status=this.data.StatusName,this.isRepairCreatedFromCase=this.data.IsRepairCreatedFromCase,this.calculateTimeDifference(),this.dialogRef.keydownEvents().subscribe(n=>{"Escape"===n.key&&this.dialogRef.close({success:this.changesMade,type:"refresh"})}),this.dialogRef.backdropClick().subscribe(()=>{this.dialogRef.close({success:this.changesMade,type:"refresh"})})}ngOnChanges(){this.isArrived=this.data.IsArrived,this.isNoShow=this.data.IsNoShow,this.status=this.data.StatusName,this.isRepairCreatedFromCase=this.data.IsRepairCreatedFromCase,this.calculateTimeDifference()}calculateTimeDifference(){const n=new Date,i=this.data.StartDate;n>new Date(i.getTime()-18e5)&&(this.isArrivedVisible=!0),n>i&&(this.isNoShowVisible=!0,this.isArrivedVisible=!1)}deleteBooking(n){this.commonService.openDeleteDialog().afterClosed().subscribe(i=>{i&&(this.commonService.showLoading(),this.calendarService.deleteBooking(n).subscribe({next:()=>{this.dialogRef.close({success:!0,type:"delete",id:n}),this.commonService.hideLoading()}}))})}onToggleChange(n){n.checked&&"noshow"==n.name?(this.isNoShow=!0,this.isArrived=!1):n.checked&&"arrived"==n.name?(this.isNoShow=!1,this.isArrived=!0):(this.isNoShow=!1,this.isArrived=!1);const i=[{op:"replace",path:"IsArrived",value:this.isArrived?"True":"False"},{op:"replace",path:"IsNoShow",value:this.isNoShow?"True":"False"}];this.commonService.showLoading(),this.calendarService.updateBooking(this.data.BookingGuid,i).subscribe({next:()=>{this.commonService.hideLoading(),this.changesMade=!0},error:()=>{n.cancel=!0}})}joinAssignees(n){return n?.map(i=>i.AssigneeName).join(", ")}closeDialog(){this.dialogRef.close({success:this.changesMade,type:"refresh"})}}return g.\u0275fac=function(n){return new(n||g)(t.Y36(S.uw),t.Y36(S.so),t.Y36(S.WI),t.Y36(H.F0),t.Y36(Y.o),t.Y36(rt.v))},g.\u0275cmp=t.Xpm({type:g,selectors:[["booking-preview"]],features:[t._Bn([Y.o]),t.TTD],decls:124,vars:81,consts:[[1,"dialog-with-header","large-width"],[1,"header",3,"ngStyle"],[1,"title"],[1,"action"],["color","white",3,"svgIcon","click"],[1,"mat-typography"],[1,"booking-preview-wrapper"],[1,"booking-preview-content"],[1,"section-header"],[1,"section-title"],["color","black-medium",3,"svgIcon"],[1,"detail-row"],[1,"detail-col"],[1,"info-content","short-text"],[1,"info-content"],[4,"ngIf","ngIfElse"],["emptyAssignee",""],["class","detail-row",4,"ngIf"],["class","detail-col",4,"ngIf"],[1,"booking-preview-action"],[1,"section-header","transparent"],["class","button button-outline",3,"routerLink","queryParams",4,"chqPermission"],["inner","",1,"info-content"],[4,"ngFor","ngForOf"],[3,"svgIcon","matTooltip"],[1,"icon-container"],["matTooltipPosition","above",1,"icon-wrapper",3,"matTooltip"],[3,"svgIcon"],[1,"button","button-outline",3,"routerLink","queryParams"],["aria-hidden"," false","aria-label","edit icon",3,"svgIcon"],["class","action-btn",4,"ngIf"],[1,"action-btn"],["class","button-outline-danger",3,"click",4,"chqPermission"],[1,"button-outline-danger",3,"click"],[1,"toggle"],[1,"label-toggle"],[1,"toggle-button"],[3,"checked","name","ToggleChange"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",3)(6,"button")(7,"mat-icon",4),t.NdJ("click",function(){return i.closeDialog()}),t.qZA()()()(),t.TgZ(8,"mat-dialog-content",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9),t._UZ(13,"mat-icon",10),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"translate"),t.qZA()()(),t.TgZ(17,"div",11)(18,"div",12)(19,"label"),t._uU(20),t.ALo(21,"translate"),t.TgZ(22,"span",13),t._uU(23),t.qZA()()(),t.TgZ(24,"div",12)(25,"label"),t._uU(26),t.ALo(27,"translate"),t.TgZ(28,"span",13),t._uU(29),t.qZA()()()(),t.TgZ(30,"div",11)(31,"div",12)(32,"label"),t._uU(33),t.ALo(34,"translate"),t.TgZ(35,"span",14),t._uU(36),t.qZA()()()(),t.TgZ(37,"div",8)(38,"div",9),t._UZ(39,"mat-icon",10),t.TgZ(40,"span"),t._uU(41),t.ALo(42,"translate"),t.qZA()()(),t.TgZ(43,"div",11)(44,"div",12)(45,"label"),t._uU(46),t.ALo(47,"translate"),t.TgZ(48,"span",14),t._uU(49),t.qZA()()()(),t.TgZ(50,"div",11)(51,"div",12)(52,"label"),t._uU(53),t.ALo(54,"translate"),t.TgZ(55,"span",14),t._uU(56),t.qZA()()()(),t.TgZ(57,"div",11)(58,"div",12)(59,"label"),t._uU(60),t.ALo(61,"translate"),t.TgZ(62,"span",14),t._uU(63),t.qZA()()()(),t.TgZ(64,"div",11)(65,"div",12)(66,"label"),t._uU(67),t.ALo(68,"translate"),t.TgZ(69,"span",14),t._uU(70),t.qZA()()()(),t.TgZ(71,"div",8)(72,"div",9),t._UZ(73,"mat-icon",10),t.TgZ(74,"span"),t._uU(75),t.ALo(76,"translate"),t.qZA()()(),t.TgZ(77,"div",11)(78,"div",12)(79,"label"),t._uU(80),t.ALo(81,"translate"),t.YNc(82,P,3,1,"ng-container",15),t.YNc(83,L,2,0,"ng-template",null,16,t.W1O),t.qZA()()(),t.TgZ(85,"div",11)(86,"div",12)(87,"label"),t._uU(88),t.ALo(89,"translate"),t.TgZ(90,"span",14),t._uU(91),t.qZA()()()(),t.YNc(92,$,6,4,"div",17),t.YNc(93,y,7,4,"div",17),t.TgZ(94,"div",11)(95,"div",12)(96,"label"),t._uU(97),t.ALo(98,"translate"),t.TgZ(99,"span",14),t._uU(100),t.ALo(101,"date"),t.qZA()()()(),t.TgZ(102,"div",11)(103,"div",12)(104,"label"),t._uU(105),t.ALo(106,"translate"),t.TgZ(107,"span",14),t._uU(108),t.ALo(109,"date"),t.qZA()()()(),t.TgZ(110,"div",11),t.YNc(111,X,7,5,"div",18),t.qZA()(),t.TgZ(112,"div",19)(113,"div",20)(114,"div",9)(115,"span"),t._uU(116),t.ALo(117,"translate"),t.qZA()()(),t.TgZ(118,"div",11)(119,"div",12),t.YNc(120,G,4,6,"a",21),t.qZA()(),t.YNc(121,N,3,1,"div",17),t.YNc(122,F,8,5,"div",17),t.YNc(123,f,8,5,"div",17),t.qZA()()()()),2&n){const d=t.MAs(84);t.xp6(1),t.Q6J("ngStyle",t.VKq(79,m,i.data.Color)),t.xp6(2),t.AsE(" ",t.lcZ(4,41,"booking_details")," - ",i.data.TypeName," "),t.xp6(4),t.Q6J("svgIcon","cross"),t.xp6(6),t.Q6J("svgIcon","person-circle"),t.xp6(2),t.Oqu(t.lcZ(16,43,"customer_details")),t.xp6(5),t.hij("",t.lcZ(21,45,"first_name"),": "),t.xp6(3),t.Oqu((null==i.data.Customer?null:i.data.Customer.FirstName)||"-"),t.xp6(3),t.hij("",t.lcZ(27,47,"last_name"),": "),t.xp6(3),t.Oqu((null==i.data.Customer?null:i.data.Customer.LastName)||"-"),t.xp6(4),t.hij("",t.lcZ(34,49,"work_provider"),": "),t.xp6(3),t.Oqu((null==i.data.WorkProviderDto?null:i.data.WorkProviderDto.CompanyName)||(null==i.data.WorkProviderDto?null:i.data.WorkProviderDto.CompanyOrgType)||"-"),t.xp6(3),t.Q6J("svgIcon","car"),t.xp6(2),t.Oqu(t.lcZ(42,51,"vehicle_detail")),t.xp6(5),t.hij("",t.lcZ(47,53,"car_make"),": "),t.xp6(3),t.Oqu((null==i.data.Vehicle?null:i.data.Vehicle.Make)||"-"),t.xp6(4),t.hij("",t.lcZ(54,55,"car_model"),": "),t.xp6(3),t.Oqu((null==i.data.Vehicle?null:i.data.Vehicle.Model)||"-"),t.xp6(4),t.hij("",t.lcZ(61,57,"license_plate"),": "),t.xp6(3),t.Oqu((null==i.data.Vehicle?null:i.data.Vehicle.LicensePlate)||"-"),t.xp6(4),t.hij("",t.lcZ(68,59,"import_interval"),": "),t.xp6(3),t.hij(" ",null!=i.data.Vehicle&&i.data.Vehicle.VehicleId&&(null==i.data.Vehicle?null:i.data.Vehicle.ModelInterval)||"-"," "),t.xp6(3),t.Q6J("svgIcon","magazine"),t.xp6(2),t.Oqu(t.lcZ(76,61,"booking_details")),t.xp6(5),t.hij("",t.lcZ(81,63,"assigned_to"),": "),t.xp6(2),t.Q6J("ngIf",(null==i.data.Assignees?null:i.data.Assignees.length)>0)("ngIfElse",d),t.xp6(6),t.hij("",t.lcZ(89,65,"status"),": "),t.xp6(3),t.hij(" ",i.data.DisplayStatus||"-",""),t.xp6(1),t.Q6J("ngIf","Repair"===i.data.TypeName),t.xp6(1),t.Q6J("ngIf","Repair"===i.data.TypeName),t.xp6(4),t.hij("",t.lcZ(98,67,"booking_in"),": "),t.xp6(3),t.Oqu(t.xi3(101,69,i.data.StartDate,"EE d MMM y h:mm:ss a")),t.xp6(5),t.hij("",t.lcZ(106,72,"booking_out"),": "),t.xp6(3),t.Oqu(t.xi3(109,74,i.data.EndDate,"EE d MMM y h:mm:ss a")),t.xp6(3),t.Q6J("ngIf","Repair"===i.data.TypeName),t.xp6(5),t.Oqu(t.lcZ(117,77,"actions")),t.xp6(4),t.Q6J("chqPermission","viewBooking"),t.xp6(1),t.Q6J("ngIf",!i.data.isReadOnlyPermission&&i.showDelete),t.xp6(1),t.Q6J("ngIf","Repair"===i.data.TypeName&&i.isArrivedVisible&&!i.data.isReadOnlyPermission),t.xp6(1),t.Q6J("ngIf","Repair"===i.data.TypeName&&"Draft"===i.data.StatusName&&i.isNoShowVisible&&!i.data.isReadOnlyPermission)}},dependencies:[ot.sg,ot.O5,ot.PC,ct.Hw,H.rH,pt.f,S.xY,gt.gM,I.A,ot.uU,W.X$],styles:[".booking-preview-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;padding:16px 25px;gap:25px}.booking-preview-wrapper[_ngcontent-%COMP%]   .booking-preview-content[_ngcontent-%COMP%]{display:flex;flex:1 1 calc(100% - 140px);flex-direction:column;align-items:flex-start;gap:16px}.booking-preview-wrapper[_ngcontent-%COMP%]   .booking-preview-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:14px;line-height:14px;display:flex;align-items:center;color:var(--xa-dark-gray);gap:5px}.booking-preview-wrapper[_ngcontent-%COMP%]   .booking-preview-content[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{font-weight:500;color:var(--xa-black)}.booking-preview-wrapper[_ngcontent-%COMP%]   .booking-preview-action[_ngcontent-%COMP%]{display:flex;flex:1 1 140px;flex-direction:column;align-items:flex-start;gap:10px}.booking-preview-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:18px;width:18px}.detail-row[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;width:100%}.detail-row[_ngcontent-%COMP%]   .detail-col[_ngcontent-%COMP%]{flex:1 1 auto}.detail-row[_ngcontent-%COMP%]   .detail-col[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:14px;line-height:14px;display:flex;align-items:center;gap:5px}.toggle[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex:1 1 auto}.toggle[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]{cursor:pointer}.button-outline[_ngcontent-%COMP%], .button-outline-danger[_ngcontent-%COMP%]{width:155px!important;height:33px!important;justify-content:flex-start!important;filter:drop-shadow(0px 1px 3px rgba(96,108,128,.05))}.button-outline[_ngcontent-%COMP%]:hover, .button-outline-danger[_ngcontent-%COMP%]:hover{filter:drop-shadow(10px 1px 3px rgba(96,108,128,.05))}a.button-outline[_ngcontent-%COMP%]{height:11px!important;width:128px!important;text-decoration:none}.icon-container[_ngcontent-%COMP%]{display:flex;gap:10px}.icon-wrapper[_ngcontent-%COMP%]{background:var(--xa-lighter-gray);padding:6px 4px;height:25px;width:30px;border-radius:8px;display:flex;align-items:center;justify-content:center}"]}),g})();var Q=s(24006),et=s(8985),_t=s(38709),Pt=s(93077),bt=s(84943),xt=s(99106),Dt=s(17595),Tt=s(14315),kt=s(36978),wt=s(23267);const M=["filter"],E=["draftcustomer"];function l(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"chq-button",3),t.NdJ("click",function(){t.CHM(n);const d=t.oxw();return t.KtG(d.newBooking())}),t.qZA()}if(2&g){const n=t.oxw();t.Q6J("buttonModel",n.newBookingButton)}}function C(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"chq-button",3),t.NdJ("click",function(){t.CHM(n);const d=t.oxw();return t.KtG(d.openDraftCustomer())}),t.qZA()}if(2&g){const n=t.oxw();t.Q6J("buttonModel",n.draftButton)}}function v(g,T){1&g&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&g&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"no_of_booking")," "))}function u(g,T){1&g&&(t._uU(0),t.ALo(1,"translate")),2&g&&t.hij(" ",t.lcZ(1,1,"no_of_bookings")," ")}const w=function(g,T,n,i){return{"disable-date":g,weekend:T,readonly:n,dinner:i}};function p(g,T){if(1&g&&(t.TgZ(0,"div",47),t._uU(1),t.qZA()),2&g){const n=T.$implicit,i=t.oxw(2);t.Q6J("ngClass",t.l5B(2,w,i.disabledDate[n.startDate.toDateString()],i.weekendDate[n.startDate.toDateString()],i.isReadOnlyPermission,i.lunchTime[n.startDate.toString()])),t.xp6(1),t.hij(" ","month"===i.currentView?n.startDate.getDate():""," ")}}const D=function(g){return{"flex-column":g}};function b(g,T){if(1&g&&t._UZ(0,"p",50),2&g){const n=t.oxw().$implicit,i=t.oxw(2);t.Q6J("ngClass",t.VKq(2,D,i.getDateText(n.date).length>105))("innerHtml",i.getDateText(n.date),t.oJD)}}function z(g,T){if(1&g&&(t.TgZ(0,"p",51),t._uU(1),t.ALo(2,"date"),t.qZA()),2&g){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,n.date,"d EEE")," ")}}function st(g,T){if(1&g&&(t.TgZ(0,"p",51),t._uU(1),t.qZA()),2&g){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.text," ")}}const ut=function(g){return{"disable-date":g}};function nt(g,T){if(1&g&&(t.TgZ(0,"div",47),t.YNc(1,b,1,4,"p",48),t.YNc(2,z,3,4,"p",49),t.YNc(3,st,2,1,"p",49),t.qZA()),2&g){const n=T.$implicit,i=t.oxw(2);t.Q6J("ngClass",t.VKq(4,ut,i.disabledDate[n.date.toDateString()])),t.xp6(1),t.Q6J("ngIf","month"!==i.currentView),t.xp6(1),t.Q6J("ngIf","month"!==i.currentView),t.xp6(1),t.Q6J("ngIf","month"===i.currentView)}}function ft(g,T){if(1&g&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&g){const n=T.$implicit;t.xp6(1),t.hij(" ",n.text?t.xi3(2,1,n.date,"HH:mm"):""," ")}}function k(g,T){if(1&g&&(t.TgZ(0,"div")(1,"div",52)(2,"div",53)(3,"div",54)(4,"span"),t._uU(5),t.qZA()()()()()),2&g){const n=T.$implicit;t.xp6(1),t.Udp("background",n.targetedAppointmentData.Color),t.xp6(4),t.AsE("",null==n.targetedAppointmentData.Customer?null:n.targetedAppointmentData.Customer.FirstName," ",null==n.targetedAppointmentData.Customer?null:n.targetedAppointmentData.Customer.LastName,"")}}function Ct(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"div")(1,"div",55)(2,"div",56)(3,"div",54)(4,"span"),t._uU(5),t.qZA()(),t.TgZ(6,"div",57)(7,"div",58),t._uU(8),t.qZA(),t.TgZ(9,"div",59),t._uU(10),t.qZA()()(),t.TgZ(11,"div",60)(12,"button",17),t.NdJ("click",function(d){const x=t.CHM(n).$implicit,q=t.oxw(2);return t.KtG(q.handleContextMenu("preview",d,x.targetedAppointmentData))}),t._UZ(13,"mat-icon",61),t.qZA()()()()}if(2&g){const n=T.$implicit;t.xp6(1),t.Udp("border-left","12px solid "+n.targetedAppointmentData.Color),t.xp6(4),t.AsE("",null==n.targetedAppointmentData.Customer?null:n.targetedAppointmentData.Customer.FirstName," ",null==n.targetedAppointmentData.Customer?null:n.targetedAppointmentData.Customer.LastName,""),t.xp6(3),t.hij("Work Provider: ",null==n.targetedAppointmentData.WorkProviderDto?null:n.targetedAppointmentData.WorkProviderDto.CompanyName," "),t.xp6(2),t.hij("Status: ",n.targetedAppointmentData.DisplayStatus,""),t.xp6(3),t.Q6J("svgIcon","show")}}const lt=function(){return["day","week","month"]};function vt(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"dx-scheduler",42),t.NdJ("onAppointmentFormOpening",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onAppointmentFormOpening(d))})("onAppointmentUpdating",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onAppointmentUpdating(d))})("onAppointmentUpdated",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onAppointmentUpdated(d))})("onAppointmentClick",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onAppointmentClick(d))})("onAppointmentDblClick",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onAppointmentDblClick(d))})("onOptionChanged",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onOptionChanged(d))})("onCellClick",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onCellClick(d))}),t.YNc(1,p,2,7,"div",43),t.YNc(2,nt,4,6,"div",43),t.YNc(3,ft,3,4,"div",44),t.YNc(4,k,6,4,"div",44),t.YNc(5,Ct,14,7,"div",44),t._UZ(6,"dxo-appointment-dragging",45)(7,"dxo-scrolling",46),t.qZA()}if(2&g){const n=t.oxw();t.Q6J("width",n.calendarWidth)("height",n.calendarHeight)("editing",!0)("dataSource",n.calendarData)("views",t.DdM(23,lt))("currentView",n.currentView)("adaptivityEnabled",n.isSmallScreen)("firstDayOfWeek",1)("startDayHour",0)("endDayHour",24)("currentDate",n.currentDate)("cellDuration",30)("useDropDownViewSwitcher",!1)("crossScrollingEnabled",!0)("showCurrentTimeIndicator",!0)("maxAppointmentsPerCell",n.maxAppointmentsPerCell),t.xp6(1),t.Q6J("dxTemplateOf","dataCellTemplate"),t.xp6(1),t.Q6J("dxTemplateOf","dateCellTemplate"),t.xp6(1),t.Q6J("dxTemplateOf","timeCellTemplate"),t.xp6(1),t.Q6J("dxTemplateOf","appointment-template"),t.xp6(1),t.Q6J("dxTemplateOf","appointment-tooltip-template"),t.xp6(1),t.Q6J("group","customer")("onAdd",n.onAppointmentAdd)}}function Ot(g,T){1&g&&t._UZ(0,"hr",23)}function Zt(g,T){1&g&&t._UZ(0,"hr")}function yt(g,T){1&g&&t._UZ(0,"hr",23)}function Lt(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"div",20)(1,"div",21)(2,"chq-input",22),t.NdJ("controlOutput",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onFormUpdate(d))}),t.qZA()()()}if(2&g){const n=t.oxw();t.xp6(2),t.Q6J("inputModel",n.filterModal[7])}}function Ut(g,T){1&g&&t._UZ(0,"hr",23)}function qt(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"div",20)(1,"div",21)(2,"chq-input",22),t.NdJ("controlOutput",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onFormUpdate(d))}),t.qZA()()()}if(2&g){const n=t.oxw();t.xp6(2),t.Q6J("inputModel",n.filterModal[4])}}function Nt(g,T){1&g&&t._UZ(0,"hr")}function Et(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"div",20)(1,"div",21)(2,"chq-input",22),t.NdJ("controlOutput",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onFormUpdate(d))}),t.qZA()()()}if(2&g){const n=t.oxw();t.xp6(2),t.Q6J("inputModel",n.filterModal[5])}}function Jt(g,T){1&g&&t._UZ(0,"hr")}function Rt(g,T){1&g&&(t.TgZ(0,"div",62)(1,"div",63),t._UZ(2,"img",64),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"translate"),t.qZA()()()),2&g&&(t.xp6(4),t.Oqu(t.lcZ(5,2,"no_result_found")),t.xp6(3),t.hij("",t.lcZ(8,4,"could_not_find_any_data"),"."))}function Ft(g,T){if(1&g&&(t.TgZ(0,"span"),t._uU(1," License Plate: "),t.TgZ(2,"span",69),t._uU(3),t.qZA()()),2&g){const n=t.oxw().$implicit;t.xp6(3),t.Oqu(n.licensePlateNumber)}}const It=function(g,T,n,i,d){return[g,T,n,i,d]};function Bt(g,T){if(1&g&&(t.TgZ(0,"span"),t._uU(1," Amount: "),t.TgZ(2,"span",69),t._uU(3),t.ALo(4,"xaCurrency"),t.qZA()()),2&g){const n=t.oxw().$implicit,i=t.oxw();t.xp6(3),t.hij(" ",t.G7q(4,1,t.qbA(7,It,n.cost,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))," ")}}function Yt(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"a",17),t.NdJ("click",function(d){t.CHM(n);const h=t.oxw().$implicit,x=t.oxw();return t.KtG(x.handleDraftAction("delete",d,h))}),t._UZ(1,"mat-icon",73),t.qZA()}2&g&&(t.xp6(1),t.Q6J("svgIcon","trash"))}const Qt=function(g){return{disabled:g}},jt=function(g){return[g]};function Ht(g,T){if(1&g){const n=t.EpF();t.TgZ(0,"dx-draggable",65),t.NdJ("onDragStart",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onItemDragStart(d))})("onDragEnd",function(d){t.CHM(n);const h=t.oxw();return t.KtG(h.onItemDragEnd(d))}),t.TgZ(1,"div",66),t._UZ(2,"mat-icon",67),t.TgZ(3,"div",68)(4,"div",54)(5,"span"),t._uU(6),t.qZA()(),t.TgZ(7,"div",57)(8,"span",69),t._uU(9),t.ALo(10,"date"),t.qZA(),t.YNc(11,Ft,4,1,"span",28),t.YNc(12,Bt,5,13,"span",28),t.qZA(),t.TgZ(13,"div")(14,"span"),t._uU(15),t.qZA()()(),t.TgZ(16,"div",70)(17,"a",71),t._UZ(18,"mat-icon",61),t.qZA(),t.YNc(19,Yt,2,1,"a",72),t.qZA()()()}if(2&g){const n=T.$implicit,i=t.oxw();t.Q6J("clone",!0)("group","customer")("data",n),t.xp6(2),t.Q6J("svgIcon","list"),t.xp6(4),t.AsE(" ",n.firstName," ",n.lastName," "),t.xp6(3),t.hij(" ",t.xi3(10,17,n.createdDate,"dd/MM/yyyy hh:mm:ss")," "),t.xp6(2),t.Q6J("ngIf","RepairEstimation"===n.statusClass),t.xp6(1),t.Q6J("ngIf","RepairEstimation"===n.statusClass),t.xp6(1),t.Gre("status ",n.statusClass,""),t.xp6(2),t.hij(" ",n.status," "),t.xp6(2),t.Q6J("ngClass",t.VKq(20,Qt,!i.hasQuotePermission&&"Quote"===n.draftCustomerType))("routerLink",t.VKq(22,jt,n.url)),t.xp6(1),t.Q6J("svgIcon","show"),t.xp6(1),t.Q6J("chqPermission","bookingJournal")}}const St=function(g){return{"margin-right":g}},Gt=function(g){return{"two-per-row":g}};O.extend(j),O.extend(B),(0,r.SP)("en");let Wt=(()=>{class g{constructor(n,i,d,h,x,q,dt,mt,At,$t,zt,Vt){this.router=n,this.route=i,this.formBuilder=d,this.dialog=h,this.calendarService=x,this.commonService=q,this.datePipe=dt,this.cdr=mt,this.bookingService=At,this.caseService=$t,this.xaCurrencyPipe=zt,this.translateService=Vt,this.currentDate=new Date,this.startHour=0,this.endHour=24,this.filterButton={label:"filter",type:"outline",icon:"filter"},this.draftButton={label:"draft_customer",type:"outline",icon:"person-add"},this.newBookingButton={label:"new_booking",type:"primary",icon:"plus"},this.applyButton={label:"apply",type:"primary"},this.resetButton={label:"reset_all",type:"outline"},this.calendarData=[],this.draftData=[],this.currentView=localStorage.getItem("currentView")||"week",this.calendarWidth="100%",this.defaultHeight="calc(100vh - (5px + 0.8vw + 5px + 1.5vw + 50px))",this.calendarHeight="month"===this.currentView?"100%":this.defaultHeight,this.filterForm=this.formBuilder.group({TypeName:[],Booking:[],WorkProviderDto:[],WorkProviderName:[],CustomerName:[],OrgName:"",Assignees:[],RepairType:[]}),this.filterModal=[{placeHolder:"booking_type",name:"TypeName",label:"booking_type",value:"",type:"checkbox",options:[]},{placeHolder:"select_organization",label:"organization",name:"OrgName",value:"",type:"select",displayValue:"label",fieldValue:"value",options:[],isMultiSelect:!1},{placeHolder:"booking",name:"Booking",label:"booking",value:"",type:"checkbox",options:[{label:"Start Date",value:"bookingIn",checked:!1},{label:"End Date",value:"bookingOut",checked:!1}]},{placeHolder:"work_provider",name:"WorkProviderDto",label:"work_provider",value:"",type:"checkbox",options:[]},{placeHolder:"driver_name",name:"CustomerName",label:"driver_name",value:"",type:"select",displayValue:"label",fieldValue:"value",options:[],isMultiSelect:!0},{placeHolder:"assigned_to",label:"assigned_to",name:"Assignees",value:"",type:"select",displayValue:"label",fieldValue:"value",options:[],isMultiSelect:!0},{placeHolder:"repair_type",name:"RepairType",label:"repair_type",value:"",type:"checkbox",options:[]},{placeHolder:"work_provider_name",name:"WorkProviderName",label:"work_provider_name",value:"",type:"select",displayValue:"label",fieldValue:"value",options:[],isMultiSelect:!0}],this.filterDataLoaded=!1,this.draftDataLoaded=!1,this.isFromCalendar=!1,this.calendarCurrentStartDate=null,this.calendarCurrentEndDate=null,this.isSmallScreen=!1,this.isTouchScreen=!1,this.maxAppointmentsPerCell=2,this.userIsBM=!1,this.i18n=this.commonService.geti18nInfo(),this.isReadOnlyPermission=!0,this.showCalendar=!0,this.hasQuotePermission=!1,this.windowInnerWidth=0,this.lunchTime={},this.bookingIdList=[],this.totalEstimate=0,this.totalLabour=0,this.totalBooking=0,this.isDoubleClick=!1,this.previewOpen=!1,this.noPermissionRoles={bookingJournal:["bodyshop manager","service advisor"]},this.showProviderChild=!1,this.disabledDate={},this.weekendDate={},this.onAppointmentAdd=this.onAppointmentAdd.bind(this),this.getScreenSize(),this.isTouchScreen="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.maxTouchPoints>0}get isiOS(){return!1}getScreenSize(){this.windowInnerWidth=window.innerWidth,this.maxAppointmentsPerCell=window.innerWidth<1024?1:2,window.innerWidth<500&&(this.isSmallScreen=!0,this.maxAppointmentsPerCell=0),this.scheduler?.instance.getDataSource().reload()}ngOnInit(){this.windowInnerWidth=window.innerWidth,this.commonService.userProfileData.subscribe(n=>{this.userDetail=n?.data;const i=n?.data?.userPermission?.automotiveServices;this.hasQuotePermission=i?.some(h=>"Carheal Quote"===h.automotiveServiceName),this.userIsBM=this.userDetail?.roleDetail.some(h=>"Bodyshop Manager"==h.name),this.userDetail?.organizationDetail?.id&&this.filterForm.get("OrgName").setValue(this.userDetail?.organizationDetail.id);const d=i?.find(h=>"addenda repair"===h.automotiveServiceName.toLowerCase());this.isReadOnlyPermission=!d||!this.noPermissionRoles.bookingJournal.includes(d.roleName.toLowerCase())}),this.route.queryParams.subscribe(n=>{n.bookInDate&&(this.currentDate=new Date(n.bookInDate))})}ngAfterViewInit(){this.getCalendarData(this.generateFilterQuery()),this.cdr.detectChanges()}openDraftCustomer(){this.draftDataLoaded?this.showDraftCustomer():(this.commonService.showLoading(),this.calendarService.getDraftCustomer()?.subscribe({next:n=>{this.draftData=n.data.map(i=>{const d=i.status?.replace(/\s/g,"");let h="/";return"Repair"===i.draftCustomerType?(h+=e.A[d?.toLowerCase()]||e.A.others,h=h.replace("{{repairGUID}}",i.repairGuid)):"Quote"===i.draftCustomerType&&(h+=e.D[d?.toLowerCase()]||e.D.others,h=h.replace("{{caseGUID}}",i.caseGuid)),{...i,url:h,statusClass:d}}).sort(function(i,d){return new Date(d.createdDate).getTime()-new Date(i.createdDate).getTime()}),this.commonService.hideLoading(),this.draftDataLoaded=!0,this.showDraftCustomer()}}))}showDraftCustomer(n=!0){n&&this.draftCustomer.open(),this.calendarWidth=window.innerWidth-400+"px",this.calendarHeight=this.defaultHeight,this.showCalendar=!1,setTimeout(()=>{this.showCalendar=!0,setTimeout(()=>{this.scrollToCurrentTime()},0)},0)}getOrgIfBM(){return this.userIsBM?this.caseService.getOrganizations():(0,c.of)(null)}openFilter(){this.filterDataLoaded?this.filter.toggle():(this.commonService.showLoading(),(0,J.D)([this.bookingService.getBookingRepairTypes(`?orgIds=${this.userDetail?.organizationDetail.id}`),this.getOrgIfBM(),this.caseService.getProvidersByOrgId(`?orgIds=${this.userDetail?.organizationDetail.id}`),this.bookingService.getEmployeesByCompetencies(null,this.calendarCurrentStartDate,this.calendarCurrentEndDate,this.userDetail?.organizationDetail.id)]).pipe((0,a.U)(([n,i,d,h])=>({bookingRepairType:n,orgList:i,workProvider:d,employeeList:h}))).subscribe(n=>{n?.bookingRepairType?.data&&(this.filterModal[0].options=n?.bookingRepairType?.data.BookingTypes.map(i=>({label:i.name,value:i.name}))),this.filterModal[1]=this.userIsBM?{...this.filterModal[1],selectedOption:{label:this.userDetail?.organizationDetail.name,value:this.userDetail?.organizationDetail.id},options:n.orgList.data.map(i=>({label:i.name,value:i.id}))}:{...this.filterModal[1],selectedOption:{label:this.userDetail?.organizationDetail.name,value:this.userDetail?.organizationDetail.id},options:[{label:this.userDetail?.organizationDetail.name,value:this.userDetail?.organizationDetail.id}],disabled:!0},n?.workProvider?.data&&(this.filterModal[3].options=n?.workProvider?.data.map(i=>({label:i,value:i}))),n?.employeeList?.data&&(this.filterModal[5]={...this.filterModal[5],options:n.employeeList?.data.map(i=>({label:`${i.firstName} ${i.lastName}`,value:i.employeeId}))}),n.bookingRepairType.data.RepairType&&n.bookingRepairType.data.RepairType.length>0&&(this.filterModal[6].options=n.bookingRepairType.data.RepairType[0].RepairTypes.map(i=>({label:i.name,value:i.id,icon:this.getRepairTpeIcon(i.name)}))),this.filter.toggle(),this.commonService.hideLoading(),this.filterDataLoaded=!0}))}getRepairTpeIcon(n){return{Body:"car",Maintenance:"house",Paint:"paint",Tires:"tire",Electric:"bolt-car",Electrical:"bolt-car",Mechanical:"mechanical",Diagnosis:"diagnosis",Others:"gears"}[n]}getDisplayStatus(n){return{draft:"Draft",vehicledetails:"Vehicle Details",uploaddocuments:"Upload Documents",uploadphotos:"Upload Photos",repairestimation:"Repair Estimation",pendingapproval:"Pending Approval",approved:"Approved",reject:"Reject",rejected:"Rejected",closed:"Closed",complete:"Complete",partsorderedpartially:"Parts Ordered Partially",partsordered:"Parts Ordered",repairinprogress:"Repair In Progress",readytoinvoice:"Ready To Invoice",invoiceready:"Invoice Ready",invoiced:"Invoiced",paid:"Paid",others:"Others"}[n.replace(/\s/g,"").toLowerCase()]||n}refreshCalendarData(){this.calendarData=[],this.getCalendarData(this.generateFilterQuery())}generateFilterQuery(){this.calendarCurrentStartDate=this.calendarCurrentStartDate||new Date(this.scheduler.instance.getStartViewDate().toDateString()).toISOString(),this.calendarCurrentEndDate=this.calendarCurrentEndDate||new Date(new Date(this.scheduler.instance.getEndViewDate().toDateString()).getTime()+864e5-1e3).toISOString();let n=this.calendarCurrentStartDate,i=this.calendarCurrentEndDate;this.isFromCalendar&&(n=new Date(this.scheduler.instance.getStartViewDate().toDateString()).toISOString(),i=new Date(new Date(this.scheduler.instance.getEndViewDate().toDateString()).getTime()+864e5-1e3).toISOString(),this.calendarCurrentStartDate=n,this.calendarCurrentEndDate=i,this.isFromCalendar=!1);const d=this.filterForm.value;let h=`?$filter=((StartDate ge ${n} and StartDate le ${i}) or (EndDate ge ${n} and EndDate le ${i}) or (StartDate le ${n} and EndDate ge ${i}))`;return d.Booking&&(d.Booking.includes("bookingIn")&&d.Booking.includes("bookingOut")?h=`?$filter=((StartDate ge ${n} and StartDate le ${i}) and (EndDate ge ${n} and EndDate le ${i}))`:d.Booking.includes("bookingIn")?h=`?$filter=((StartDate ge ${n} and StartDate le ${i}))`:d.Booking.includes("bookingOut")&&(h=`?$filter=((EndDate ge ${n} and EndDate le ${i}))`)),Object.keys(d).forEach(x=>{switch(x){case"OrgName":d[x]&&(h+=` and (OrgId eq ${d[x]})`);break;case"TypeName":d[x]&&d[x].length>0&&(h+=` and (${d[x].map(q=>x+" eq '"+q+"'").join(" or ")})`);break;case"WorkProviderDto":d[x]&&d[x].length>0&&(h+=` and (${d[x].map(q=>"WorkProviderDto/CompanyOrgType eq '"+q+"'").join(" or ")})`);break;case"WorkProviderName":d[x]&&d[x].length>0&&(h+=` and (${d[x].map(q=>"WorkProviderDto/CompanyName eq '"+q+"'").join(" or ")})`);break;case"CustomerName":d[x]&&d[x].length>0&&(h+=` and (${d[x].map(q=>"Customer/Email eq '"+q+"'").join(" or ")})`);break;case"Assignees":if(d[x]&&d[x].length>0){const q=`${d[x].map(dt=>"c/AssigneeId eq "+dt).join(" or ")}`;h+=` and Assignees/any(c: (${q}))`}break;case"RepairType":if(d[x]&&d[x].length>0){const q=`${d[x].map(dt=>"c/RepairServiceTypeId eq "+dt).join(" or ")}`;h+=` and RepairServiceTypes/any(c: (${q}))`}}}),h+"&$count=true"}calculateSum(n,i){return n.reduce((d,h)=>d+h[i],0)}getCalendarData(n){this.totalEstimate=0,this.totalLabour=0,this.totalBooking=0,this.bookingIdList=[],this.disabledDate={},this.weekendDate={},this.startHour=0,this.endHour=24,this.commonService.showLoading(),(0,J.D)([this.calendarService.getCalendarData(n),this.calendarService.getSchedule(this.userDetail?.userId,this.calendarCurrentStartDate,this.calendarCurrentEndDate).pipe((0,Z.K)(i=>(0,c.of)(null)))]).pipe((0,a.U)(([i,d])=>{const h=[];return i.value.forEach(x=>{const q={...x,StartDate:O(x.StartDate).toDate(),EndDate:O(x.EndDate).toDate(),Color:x.BookingTypeColor,Icon:"Assessment"===x.TypeName?"booking-type-assessment":"booking-type-repair",DisplayStatus:this.getDisplayStatus(x.StatusName)};this.isSameDay(q.StartDate,q.EndDate)||(q.allDay=!0),h.push(q),this.bookingIdList.push(q.BookingGuid);const dt="month"===this.currentView?new Date(this.currentDate.getFullYear(),this.currentDate.getMonth(),1):new Date(this.calendarCurrentStartDate),mt="month"===this.currentView?new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,0,11,59,59):new Date(this.calendarCurrentEndDate);this.checkDateRange(dt,mt,q.StartDate)&&(this.totalEstimate+=q.EstimateCost||0,this.totalLabour+=q.LabourCost||0,this.totalBooking++)}),{calendarData:h,scheduleData:d}})).subscribe(i=>{this.calendarData=[...i.calendarData],this.commonService.hideLoading(),this.checkSchedule(i.scheduleData),this.scrollToCurrentTime()})}scrollToCurrentTime(){const n=new Date;let i=n.getHours()>0?n.getHours()-1:n.getHours();i<this.startHour&&(i=this.startHour),i>this.endHour&&(i=this.endHour-1),this.scheduler.instance.scrollToTime(i,n.getMinutes())}checkSchedule(n){let i,d;n?.data?.calenderDays?.forEach(h=>{if(h.breaks&&h.breaks.length>0){let q=O(`${h.date} ${h.breaks[0].startTime} Z`,"YYYY-MM-DD hh:mm A Z");const dt=O(`${h.date} ${h.breaks[0].endTime} Z`,"YYYY-MM-DD hh:mm A Z");do{const mt=O(q.toDate()).toDate().toString();this.lunchTime[mt]=!0,q=O.utc(q.toDate()).add(30,"m")}while(q<dt)}const x=O(`${h.date} 00:00 AM Z`,"YYYY-MM-DD hh:mm A Z");if(h.isOff&&(this.disabledDate[x.toDate().toDateString()]=!0),h.isWeekend&&(this.weekendDate[x.toDate().toDateString()]=!0),h.timeSlots&&h.timeSlots.length>0){const q=O(`${h.date} ${h.timeSlots[0].startTime} Z`,"YYYY-MM-DD HH:mm Z"),dt=O(`${h.date} ${h.timeSlots[0].endTime} Z`,"YYYY-MM-DD HH:mm Z");(!i||i>q.toDate().getHours())&&(i=q.toDate().getHours()),(!d||d<dt.toDate().getHours())&&(d=dt.toDate().getHours(),dt.toDate().getMinutes()>0&&d<24&&(d+=1))}}),this.startHour=i||0,this.endHour=d||24}getStringDate(n){return O(n).format("YYYYMMDDHHmm")}isSameDay(n,i){return this.datePipe.transform(n,"yyyy-MM-dd")===this.datePipe.transform(i,"yyyy-MM-dd")}newBooking(){this.router.navigate(["/repair/booking/0"])}handleContextMenu(n,i,d){"preview"===n?this.previewOpen||this.openPreview(d):"delete"===n&&this.scheduler.instance.deleteAppointment(this.calendarData[this.calendarData.findIndex(h=>h.Id==d.Id)])}cancelEvent(n){n.cancel=!0}openPreview(n){this.previewOpen=!0,n.isReadOnlyPermission=this.isReadOnlyPermission,this.dialog.open(A,{data:n,maxHeight:"90vh",disableClose:!0}).afterClosed().subscribe(d=>{this.previewOpen=!1,d?.success&&("delete"===d.type||"refresh"===d.type)&&(this.refreshCalendarData(),this.draftClose(),this.draftData=[],this.draftDataLoaded=!1)})}onAppointmentClick(n){setTimeout(()=>{!this.isDoubleClick&&!this.previewOpen&&this.openPreview(n.appointmentData)},500),this.isDoubleClick=!1,n.cancel=!0}onAppointmentDblClick(n){this.isDoubleClick=!0;const i=e.A[n.appointmentData.StatusName?.replace(/\s/g,"").toLowerCase()]||e.A.others;this.router.navigate([i.replace("{{repairGUID}}",n.appointmentData.ObjectGuid)]),n.cancel=!0}onOptionChanged(n){"currentView"===n.name?(this.currentView=n.value,localStorage.setItem("currentView",this.currentView),this.isFromCalendar=!0,setTimeout(()=>{this.draftClose(),this.draftData=[],this.draftDataLoaded=!1,this.refreshCalendarData()},100),this.calendarHeight="month"===this.currentView?"100%":this.defaultHeight):"currentDate"===n.name&&(this.currentDate=n.value,this.isFromCalendar=!0,setTimeout(()=>{this.draftClose(),this.draftData=[],this.draftDataLoaded=!1,this.refreshCalendarData()},100))}onCellClick(n){this.previewOpen||(this.isReadOnlyPermission?(n.cancel=!0,this.commonService.showInfoToast(5e3,"msg_gt_permission")):this.checkDateAndOpen(n))}checkDateAndOpen(n){if(this.isPastDate(n.cellData.startDate))n.cancel=!0,this.commonService.showInfoToast(5e3,"cannot_past_date");else if(this.isValidAppointment(n.component,n.cellData)){const d=this.datePipe.transform(n.cellData.startDate,"yyyy-MM-ddTHH:mm:ss"),h=this.datePipe.transform(n.cellData.endDate,"yyyy-MM-ddTHH:mm:ss");this.router.navigate(["/repair/booking/0"],{queryParams:{startDate:d,endDate:h}})}else n.cancel=!0,this.notifyDisableDate()}onAppointmentFormOpening(n){n.cancel=!0,this.isValidAppointmentDate(n.appointmentData.startDate)||(n.cancel=!0,this.notifyDisableDate())}onAppointmentAdding(n){this.isValidAppointment(n.component,n.appointmentData)||(n.cancel=!0,this.notifyDisableDate())}onAppointmentUpdating(n){const i=["draft","vehicledetails","uploaddocuments","uploadphotos","repairestimation","pendingapproval","approved","reject","rejected","repairinprogress"],d=n.oldData.StatusName.toLowerCase().replace(/\s/g,"");if(!this.isReadOnlyPermission&&i.includes(d))this.isValidAppointment(n.component,n.newData)||(n.cancel=!0,this.notifyDisableDate()),"Assessment"===n.newData.TypeName&&(n.newData.StartDate.getTime()===n.oldData.StartDate.getTime()&&n.newData.EndDate.getTime()!==n.oldData.EndDate.getTime()||n.newData.StartDate.getTime()!==n.oldData.StartDate.getTime()&&n.newData.EndDate.getTime()===n.oldData.EndDate.getTime())&&(n.cancel=!0);else if(n.cancel=!0,!i.includes(d)){const h=this.translateService.instant("cannot_update_datetime_for_status",{status:this.getDisplayStatus(d)});this.commonService.showInfoToast(5e3,h)}}onAppointmentUpdated(n){if(this.isReadOnlyPermission)n.cancel=!0;else{const i=new Date(n.appointmentData.StartDate.getTime());let d=new Date(n.appointmentData.EndDate.getTime());n.appointmentData.allDay&&i.getDate()==d.getDate()&&(d=new Date(n.appointmentData.StartDate.getTime()),d.setDate(d.getDate()+1)),this.patchBooking(i,d,n.appointmentData.BookingGuid).subscribe({next:()=>{this.commonService.hideLoading(),this.refreshCalendarData()}})}}patchBooking(n,i,d){const h=[{op:"replace",path:"StartDate",value:O.utc(n).format("YYYY-MM-DDTHH:mm:ss.000")+"Z"},{op:"replace",path:"EndDate",value:O.utc(i).format("YYYY-MM-DDTHH:mm:ss.000")+"Z"},{op:"replace",path:"IsArrived",value:"False"},{op:"replace",path:"IsNoShow",value:"False"}];return this.commonService.showLoading(),this.calendarService.updateBooking(d,h)}notifyDisableDate(){this.commonService.showInfoToast(5e3,"cannot_disabled_date")}isHoliday(n){const i=n.toLocaleDateString();return this.calendarService.getHolidays().filter(h=>h.toLocaleDateString()===i).length>0}isWeekend(n){return 0===n.getDay()}isDisableDate(n){return this.isHoliday(n)}isPastDate(n){return n<new Date}isDisabledDateCell(n){return"month"===this.currentView?this.isWeekend(n):this.isDisableDate(n)}isValidAppointment(n,i){const d=new Date(i.StartDate||i.startDate),h=new Date(i.EndDate||i.endDate);return this.isValidAppointmentInterval(d,h,30)}isValidAppointmentInterval(n,i,d){const h=new Date(i.getTime());return!!this.isValidAppointmentDate(h)}isValidAppointmentDate(n){return!this.isPastDate(n)}applyDisableDatesToDateEditors(n){const i=this.calendarService.getHolidays();n.getEditor("startDate").option("disabledDates",i),n.getEditor("endDate").option("disabledDates",i)}getDateText(n){const i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),d=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1),h=this.calendarData.filter(x=>this.checkDateRange(i,d,x.StartDate)).map(x=>x);return h.length>0?"<span>"+this.xaCurrencyPipe.transform(this.calculateSum(h,"EstimateCost"),this.i18n.currencySymbol,this.i18n.digitsInfo,this.i18n.locale,this.i18n.position)+"<span>E</span></span><span>"+this.xaCurrencyPipe.transform(this.calculateSum(h,"LabourCost"),this.i18n.currencySymbol,this.i18n.digitsInfo,this.i18n.locale,this.i18n.position)+'<span>L</span></span><span class="has-background">'+h.length+"</span>":"<span>"+this.xaCurrencyPipe.transform(0,this.i18n.currencySymbol,this.i18n.digitsInfo,this.i18n.locale,this.i18n.position)+"<span>E</span></span><span>"+this.xaCurrencyPipe.transform(0,this.i18n.currencySymbol,this.i18n.digitsInfo,this.i18n.locale,this.i18n.position)+'<span>L</span></span><span class="has-background">0</span>'}checkDateRange(n,i,d){return n<=d&&d<=i}onFormUpdate(n){if("TypeName"===n.name||"Booking"===n.name||"WorkProviderDto"===n.name||"RepairType"===n.name){let i=this.filterForm.get(n.name).value||[];if(n.value)-1===i.indexOf(n.keyFieldValue)&&i.push(n.keyFieldValue);else{const d=i.indexOf(n.keyFieldValue);i.splice(d,1)}if(this.filterForm.get(n.name).setValue(i),"WorkProviderDto"===n.name&&(this.showProviderChild=i.length>1||1==i.length&&!i.includes("Retail")),i.length>0&&"WorkProviderDto"===n.name){this.filterModal[4]={...this.filterModal[4],value:"",selectedOption:""},this.filterForm.get("CustomerName").setValue(""),this.filterModal[7]={...this.filterModal[7],value:"",options:[],selectedOption:""},this.filterForm.get("WorkProviderName").setValue(""),this.commonService.showLoading();let d=`?$orderBy=CreatedDate desc&$filter=(OrgId eq ${this.filterForm.get("OrgName").value})`;d+=`and (${i.map(x=>`CompanyOrgType eq '${x}'`).join(" or ")})`;const h=`?orgId=${this.filterForm.get("OrgName").value}`;i.forEach(x=>{this.caseService.getCompanyData(x,h).subscribe({next:q=>{const dt=this.filterModal[7].options.concat(q.data.map(mt=>({label:mt.companyName||mt.partnershipName,value:mt.companyName||mt.partnershipName})));this.filterModal[7]={...this.filterModal[7],options:dt}}})}),this.calendarService.getCustomer(d).subscribe({next:x=>{this.commonService.hideLoading(),this.filterModal[4]=x?{...this.filterModal[4],options:x.value.filter((q,dt,mt)=>mt.findIndex(At=>At.ContactId===q.ContactId)===dt).map(q=>({label:q.FirstName+" "+q.LastName,value:q.Email,html:`<div class='workflow-customer-item'><span class='name'>${q.FirstName+" "+q.LastName}</span><span class='email'>${q.Email}</span></div>`}))}:{...this.filterModal[4],options:[]}},error:()=>{this.filterModal[4]={...this.filterModal[4],options:[]},this.commonService.hideLoading()}})}else this.filterModal[4]={...this.filterModal[4],options:[]}}else"Assignees"===n.name?(this.filterModal[5]={...this.filterModal[5],selectedOption:n.value},this.filterForm.get(n.name).setValue(n.value.map(i=>i.value))):"CustomerName"===n.name?(this.filterModal[4]={...this.filterModal[4],selectedOption:n.value},this.filterForm.get(n.name).setValue(n.value.map(i=>i.value))):"WorkProviderName"===n.name?(this.filterModal[7]={...this.filterModal[7],selectedOption:n.value},this.filterForm.get(n.name).setValue(n.value.map(i=>i.value))):"OrgName"===n.name?(this.filterModal[1]={...this.filterModal[1],selectedOption:n.value},this.filterForm.get(n.name).setValue(n.value.value),this.filterModal[0]={...this.filterModal[0],options:[]},this.filterModal[3]={...this.filterModal[3],options:[]},this.filterModal[4]={...this.filterModal[4],options:[]},this.filterModal[5]={...this.filterModal[5],options:[]},this.filterModal[6]={...this.filterModal[6],options:[]},this.filterModal[7]={...this.filterModal[7],options:[]},this.filterForm.get("WorkProviderDto").setValue(""),this.filterForm.get("WorkProviderName").setValue(""),this.filterForm.get("CustomerName").setValue(""),this.filterForm.get(n.name).value?(this.getWorkProviders(this.filterForm.get(n.name).value),this.applyButton={...this.applyButton,type:"primary"}):this.applyButton={...this.applyButton,type:"disabled"},this.showProviderChild=!1):this.filterForm.get(n.name).setValue(n.value)}formatLabel(n){return n>=1e3?Math.round(n/1e3)+"k":`${n} `}applyFilter(){this.refreshCalendarData(),this.filter.close()}resetFilter(){this.filterForm.reset();for(let n=0;n<this.filterModal.length;n++)this.filterModal[n].disabled||(this.filterModal[n]={...this.filterModal[n],value:"",selectedOption:"",options:this.filterModal[n].options?.map(i=>(i.checked=!1,i))});this.showProviderChild=!1,this.userDetail?.organizationDetail?.id&&(this.filterForm.get("OrgName").setValue(this.userDetail?.organizationDetail.id),this.filterModal[1]={...this.filterModal[1],selectedOption:{label:this.userDetail?.organizationDetail.name,value:this.userDetail?.organizationDetail.id}},this.filterForm.get("OrgName").value&&this.getWorkProviders(this.filterForm.get("OrgName").value)),this.applyButton={...this.applyButton,type:"primary"}}onItemDragStart(n){n.itemData=n.fromData}onItemDragEnd(n){n.toData&&(n.cancel=!0)}onAppointmentAdd(n){this.isReadOnlyPermission?this.commonService.showInfoToast(5e3,"msg_gt_permission"):this.addAppointmentFromDraft(n)}addAppointmentFromDraft(n){if(this.isPastDate(n.itemData.StartDate))n.cancel=!0,this.commonService.showInfoToast(5e3,"cannot_past_date");else if(this.isValidAppointment(n.component,n.itemData))if("Quote"===n.itemData.draftCustomerType)if("Repair Estimation"==n.itemData.status){const d=this.datePipe.transform(n.itemData.StartDate,"yyyy-MM-ddTHH:mm:ss"),h=this.datePipe.transform(n.itemData.EndDate,"yyyy-MM-ddTHH:mm:ss");this.router.navigate(["repair/booking/0"],{queryParams:{caseId:n.itemData.caseGuid,startDate:d,endDate:h}})}else this.router.navigate([`/quote/case/${n.itemData.caseGuid}`]);else"Repair"===n.itemData.draftCustomerType?this.patchBooking(n.itemData.StartDate,n.itemData.EndDate,n.itemData.bookingGuid).subscribe({next:()=>{this.commonService.hideLoading(),this.draftDataLoaded=!1,this.refreshCalendarData(),this.openDraftCustomer()}}):this.commonService.showInfoToast(1e3,"draft_type_not_defined");else n.cancel=!0,this.notifyDisableDate()}handleDraftAction(n,i,d){"preview"===n?"Repair"==d.draftCustomerType?this.router.navigate([`/repair/booking/${d.repairGuid}`]):"Quote"==d.draftCustomerType&&this.router.navigate([`/quote/case/${d.caseGuid}`]):"delete"===n&&this.commonService.openDeleteDialog("customer").afterClosed().subscribe(h=>{h&&(this.commonService.showLoading(),this.calendarService.deleteDraftCustomer(d.id).subscribe({next:()=>{this.commonService.hideLoading(),this.draftDataLoaded=!1,this.openDraftCustomer()}}))})}draftClose(){this.draftCustomer.close(),this.calendarWidth="100%",this.calendarHeight="month"===this.currentView?"100%":this.defaultHeight}getWorkProviders(n){this.commonService.showLoading(),(0,J.D)([this.bookingService.getBookingRepairTypes(`?orgIds=${n}`),this.caseService.getProvidersByOrgId(`?orgIds=${n}`),this.bookingService.getEmployeesByCompetencies(null,this.calendarCurrentStartDate,this.calendarCurrentEndDate,n)]).pipe((0,a.U)(([i,d,h])=>({bookingRepairType:i,workProvider:d,employeeList:h}))).subscribe(i=>{i?.bookingRepairType?.data&&(this.filterModal[0].options=i?.bookingRepairType?.data.BookingTypes.map(d=>({label:d.name,value:d.name}))),i?.workProvider?.data&&(this.filterModal[3].options=i?.workProvider?.data.map(d=>({label:d,value:d}))),i?.employeeList?.data&&(this.filterModal[5]={...this.filterModal[5],options:i?.employeeList?.data?.map(d=>({label:`${d.firstName} ${d.lastName}`,value:d.employeeId}))}),i.bookingRepairType.data.RepairType&&i.bookingRepairType.data.RepairType.length>0&&(this.filterModal[6].options=i.bookingRepairType.data.RepairType[0].RepairTypes.map(d=>({label:d.name,value:d.id,icon:this.getRepairTpeIcon(d.name)}))),this.commonService.hideLoading()})}}return g.\u0275fac=function(n){return new(n||g)(t.Y36(H.F0),t.Y36(H.gz),t.Y36(Q.qu),t.Y36(S.uw),t.Y36(Y.o),t.Y36(rt.v),t.Y36(ot.uU),t.Y36(t.sBO),t.Y36(et.q),t.Y36(_t.n),t.Y36(Pt.j),t.Y36(W.sK))},g.\u0275cmp=t.Xpm({type:g,selectors:[["chr-booking-journal"]],viewQuery:function(n,i){if(1&n&&(t.Gf(tt.n,5),t.Gf(M,5),t.Gf(E,5)),2&n){let d;t.iGM(d=t.CRH())&&(i.scheduler=d.first),t.iGM(d=t.CRH())&&(i.filter=d.first),t.iGM(d=t.CRH())&&(i.draftCustomer=d.first)}},hostBindings:function(n,i){1&n&&t.NdJ("resize",function(h){return i.getScreenSize(h)},!1,t.Jf7)},features:[t._Bn([Y.o])],decls:90,vars:81,consts:[[1,"calendar-header-container",3,"ngClass"],[1,"filter"],[3,"buttonModel","click",4,"chqPermission"],[3,"buttonModel","click"],[1,"total"],[1,"has-background"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"booking-calendar","mh-0",3,"ngClass"],["startDateExpr","StartDate","endDateExpr","EndDate","dateCellTemplate","dateCellTemplate","timeCellTemplate","timeCellTemplate","dataCellTemplate","dataCellTemplate","appointmentTemplate","appointment-template","appointmentTooltipTemplate","appointment-tooltip-template",3,"width","height","editing","dataSource","views","currentView","adaptivityEnabled","firstDayOfWeek","startDayHour","endDayHour","currentDate","cellDuration","useDropDownViewSwitcher","crossScrollingEnabled","showCurrentTimeIndicator","maxAppointmentsPerCell","onAppointmentFormOpening","onAppointmentUpdating","onAppointmentUpdated","onAppointmentClick","onAppointmentDblClick","onOptionChanged","onCellClick",4,"ngIf"],[3,"hasBackdrop"],[1,"filter-sidenav",3,"mode","position"],["filter",""],[1,"filter-container"],[1,"header"],[1,"title"],[1,"action"],[3,"click"],["color","white",3,"svgIcon"],[1,"form-container",3,"formGroup"],[1,"row"],[1,"col-12"],[3,"inputModel","controlOutput"],[1,"no-line"],[1,"row","custom-checkbox"],[3,"ngClass","inputModel","controlOutput"],["class","no-line",4,"ngIf"],[1,"two-per-row",3,"inputModel","controlOutput"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"footer"],[1,"col-6"],[1,"draft-sidenav-container",3,"hasBackdrop"],[1,"draft-sidenav",3,"mode","position"],["draftcustomer",""],[1,"draft-container"],["class","no-data-wrapper",4,"ngIf"],["class","item dx-card dx-theme-text-color dx-theme-background-color","handle",".draggable",3,"clone","group","data","onDragStart","onDragEnd",4,"ngFor","ngForOf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],["startDateExpr","StartDate","endDateExpr","EndDate","dateCellTemplate","dateCellTemplate","timeCellTemplate","timeCellTemplate","dataCellTemplate","dataCellTemplate","appointmentTemplate","appointment-template","appointmentTooltipTemplate","appointment-tooltip-template",3,"width","height","editing","dataSource","views","currentView","adaptivityEnabled","firstDayOfWeek","startDayHour","endDayHour","currentDate","cellDuration","useDropDownViewSwitcher","crossScrollingEnabled","showCurrentTimeIndicator","maxAppointmentsPerCell","onAppointmentFormOpening","onAppointmentUpdating","onAppointmentUpdated","onAppointmentClick","onAppointmentDblClick","onOptionChanged","onCellClick"],[3,"ngClass",4,"dxTemplate","dxTemplateOf"],[4,"dxTemplate","dxTemplateOf"],[3,"group","onAdd"],["mode","virtual"],[3,"ngClass"],["class","calendar-header header-info",3,"ngClass","innerHtml",4,"ngIf"],["class","calendar-header date-info",4,"ngIf"],[1,"calendar-header","header-info",3,"ngClass","innerHtml"],[1,"calendar-header","date-info"],[1,"template-wrap"],[1,"template-content-wrap"],[1,"subject"],[1,"tooltip-template-wrap"],[1,"tooltip-content-wrap"],[1,"booking-detail"],[1,"assigned"],[1,"status"],[1,"context-menu"],["color","black",3,"svgIcon"],[1,"no-data-wrapper"],[1,"no-data-content"],["src","assets/img/no-data.png","alt",""],["handle",".draggable",1,"item","dx-card","dx-theme-text-color","dx-theme-background-color",3,"clone","group","data","onDragStart","onDragEnd"],[1,"draft-wrap"],["color","light-gray",1,"draggable",3,"svgIcon"],[1,"draft-content-wrap"],[1,"value"],[1,"draft-action-menu"],[3,"ngClass","routerLink"],[3,"click",4,"chqPermission"],["color","red",3,"svgIcon"]],template:function(n,i){if(1&n){const d=t.EpF();t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,l,1,1,"chq-button",2),t.YNc(3,C,1,1,"chq-button",2),t.TgZ(4,"chq-button",3),t.NdJ("click",function(){return i.openFilter()}),t.qZA()(),t.TgZ(5,"p",4)(6,"span")(7,"span"),t._uU(8,"E"),t.qZA(),t.TgZ(9,"b"),t._uU(10),t.ALo(11,"xaCurrency"),t.qZA(),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"span")(15,"span"),t._uU(16,"L"),t.qZA(),t.TgZ(17,"b"),t._uU(18),t.ALo(19,"xaCurrency"),t.qZA(),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"span")(23,"span",5),t._uU(24),t.qZA(),t.YNc(25,v,3,3,"ng-container",6),t.YNc(26,u,2,3,"ng-template",null,7,t.W1O),t.qZA()()(),t.TgZ(28,"div",8),t.YNc(29,vt,8,24,"dx-scheduler",9),t.qZA(),t.TgZ(30,"mat-sidenav-container",10)(31,"mat-sidenav",11,12)(33,"div",13)(34,"div",14)(35,"div",15),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"div",16)(39,"button",17),t.NdJ("click",function(){t.CHM(d);const x=t.MAs(32);return t.KtG(x.toggle())}),t._UZ(40,"mat-icon",18),t.qZA()()(),t.TgZ(41,"form",19)(42,"div",20)(43,"div",21)(44,"chq-input",22),t.NdJ("controlOutput",function(x){return i.onFormUpdate(x)}),t.qZA()()(),t._UZ(45,"hr",23),t.TgZ(46,"div",24)(47,"div",21)(48,"chq-input",25),t.NdJ("controlOutput",function(x){return i.onFormUpdate(x)}),t.qZA()()(),t.YNc(49,Ot,1,0,"hr",26),t.TgZ(50,"div",24)(51,"div",21)(52,"chq-input",27),t.NdJ("controlOutput",function(x){return i.onFormUpdate(x)}),t.qZA()()(),t.YNc(53,Zt,1,0,"hr",28),t.TgZ(54,"div",24)(55,"div",21)(56,"chq-input",27),t.NdJ("controlOutput",function(x){return i.onFormUpdate(x)}),t.qZA()()(),t.YNc(57,yt,1,0,"hr",26),t.YNc(58,Lt,3,1,"div",29),t.YNc(59,Ut,1,0,"hr",26),t.YNc(60,qt,3,1,"div",29),t.YNc(61,Nt,1,0,"hr",28),t.YNc(62,Et,3,1,"div",29),t.YNc(63,Jt,1,0,"hr",28),t.TgZ(64,"div",24)(65,"div",21)(66,"chq-input",27),t.NdJ("controlOutput",function(x){return i.onFormUpdate(x)}),t.qZA()()()(),t.TgZ(67,"div",30)(68,"div",20)(69,"div",31)(70,"chq-button",3),t.NdJ("click",function(){return i.applyFilter()}),t.qZA()(),t.TgZ(71,"div",31)(72,"chq-button",3),t.NdJ("click",function(){return i.resetFilter()}),t.qZA()()()()()()(),t.TgZ(73,"mat-sidenav-container",32)(74,"mat-sidenav",33,34)(76,"div",35)(77,"div",14)(78,"div",15),t._uU(79),t.ALo(80,"translate"),t.qZA(),t.TgZ(81,"div",16)(82,"button",17),t.NdJ("click",function(){return i.draftClose()}),t._UZ(83,"mat-icon",18),t.qZA()()(),t.YNc(84,Rt,9,6,"div",36),t.YNc(85,Ht,20,24,"dx-draggable",37),t.qZA()()(),t.TgZ(86,"div",38)(87,"div",39)(88,"div",40),t._UZ(89,"img",41),t.qZA()()()}if(2&n){const d=t.MAs(27);t.Q6J("ngClass",t.VKq(63,St,i.isiOS)),t.xp6(2),t.Q6J("chqPermission","bookingJournal"),t.xp6(1),t.Q6J("chqPermission","bookingJournal"),t.xp6(1),t.Q6J("buttonModel",i.filterButton),t.xp6(6),t.Oqu(t.G7q(11,43,t.qbA(65,It,i.totalEstimate,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),t.xp6(2),t.hij(" ",t.lcZ(13,49,"total_estimated"),""),t.xp6(6),t.Oqu(t.G7q(19,51,t.qbA(71,It,i.totalLabour,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),t.xp6(2),t.hij(" ",t.lcZ(21,57,"total_labour"),""),t.xp6(4),t.Oqu(i.totalBooking),t.xp6(1),t.Q6J("ngIf",1===i.totalBooking)("ngIfElse",d),t.xp6(3),t.Q6J("ngClass",t.VKq(77,St,i.isiOS)),t.xp6(1),t.Q6J("ngIf",i.showCalendar),t.xp6(1),t.Q6J("hasBackdrop",!0),t.xp6(1),t.Q6J("mode","over")("position","end"),t.xp6(5),t.hij(" ",t.lcZ(37,59,"filters")," "),t.xp6(4),t.Q6J("svgIcon","cross"),t.xp6(1),t.Q6J("formGroup",i.filterForm),t.xp6(3),t.Q6J("inputModel",i.filterModal[1]),t.xp6(4),t.Q6J("ngClass",t.VKq(79,Gt,i.filterModal[0].options.length<3||(null==i.filterModal[0].options[2]?null:i.filterModal[0].options[2].label.length)>12))("inputModel",i.filterModal[0]),t.xp6(1),t.Q6J("ngIf",i.filterModal[0].options.length>0),t.xp6(3),t.Q6J("inputModel",i.filterModal[2]),t.xp6(1),t.Q6J("ngIf",i.filterModal[3].options.length>0),t.xp6(3),t.Q6J("inputModel",i.filterModal[3]),t.xp6(1),t.Q6J("ngIf",i.showProviderChild),t.xp6(1),t.Q6J("ngIf",i.showProviderChild),t.xp6(1),t.Q6J("ngIf",i.filterForm.get("WorkProviderDto").value&&i.filterForm.get("WorkProviderDto").value.length>0),t.xp6(1),t.Q6J("ngIf",i.filterForm.get("WorkProviderDto").value&&i.filterForm.get("WorkProviderDto").value.length>0),t.xp6(1),t.Q6J("ngIf",i.filterModal[5].options.length>0),t.xp6(1),t.Q6J("ngIf",i.filterModal[5].options.length>0),t.xp6(1),t.Q6J("ngIf",i.filterModal[6].options.length>0),t.xp6(3),t.Q6J("inputModel",i.filterModal[6]),t.xp6(4),t.Q6J("buttonModel",i.applyButton),t.xp6(2),t.Q6J("buttonModel",i.resetButton),t.xp6(1),t.Q6J("hasBackdrop",!1),t.xp6(1),t.Q6J("mode","over")("position","end"),t.xp6(5),t.hij(" ",t.lcZ(80,61,"draft_customers")," "),t.xp6(4),t.Q6J("svgIcon","cross"),t.xp6(1),t.Q6J("ngIf",!i.draftData||0===i.draftData.length),t.xp6(1),t.Q6J("ngForOf",i.draftData)}},dependencies:[ot.mk,ot.sg,ot.O5,Q._Y,Q.JL,Q.sg,ct.Hw,H.rH,tt.n,bt.V61,bt.PXJ,xt.p6,Dt.x,Tt.D,kt.E,wt.JX,wt.TM,I.A,ot.uU,Pt.j,W.X$],styles:["[_nghost-%COMP%]  .mat-drawer-container{background-color:transparent;z-index:501!important}[_nghost-%COMP%]  .mat-drawer-container .mat-drawer-backdrop{position:fixed}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav{position:fixed;width:300px}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav.filter-sidenav{background-color:#f1f2f6;width:400px}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .mat-drawer-inner-container{overflow-x:hidden}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .filter-container{padding:calc(15px + .8vw);padding-bottom:calc(55px + .8vw)}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .header .title{font-weight:700;font-size:20px;line-height:25px}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .header .action button{display:flex;flex-direction:row;align-items:flex-start;padding:10px;background:var(--xa-black);border-radius:50%;height:36px}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .header .action button .mat-icon{height:16px;width:16px}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container .checkbox{align-items:center!important}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container .custom-checkbox .input-wrapper .input-label{margin-bottom:10px}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container .custom-checkbox .input-wrapper .checkbox-wrapper{flex-wrap:wrap}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container .custom-checkbox .input-wrapper .checkbox-wrapper label{min-width:74px;max-width:95%}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container .custom-checkbox .input-wrapper .checkbox-wrapper label .span-label{font-size:12px;height:14px;line-height:14px;color:var(--xa-black-medium);text-transform:none}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container .custom-checkbox .input-wrapper .dropdown-item .checkbox-wrapper label{width:100%;height:auto}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container hr{margin:20px 0}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container hr.no-line{border:none;margin:10px 0}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container mat-slider{width:100%}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .form-container .two-per-row label{min-width:133px!important;width:auto!important}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .footer{position:fixed;bottom:0;right:0;width:400px;background-color:#f1f2f6;z-index:500;height:68px;align-items:center;display:flex;justify-content:space-around}[_nghost-%COMP%]  .mat-drawer-container .mat-sidenav .footer .row{width:92%}.calendar-header-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;position:relative}.calendar-header-container[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{font-weight:600;font-size:14px;line-height:20px}.calendar-header-container[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{display:flex;align-items:flex-end;margin-left:auto;flex-wrap:wrap;gap:20px;margin-bottom:10px}.approved[_ngcontent-%COMP%], .Approved[_ngcontent-%COMP%]{color:var(--xa-approve)}.PendingApproval[_ngcontent-%COMP%], .pendingapproval[_ngcontent-%COMP%]{color:var(--xa-pending-approval)}.rejected[_ngcontent-%COMP%], .Rejected[_ngcontent-%COMP%], .reject[_ngcontent-%COMP%], .Reject[_ngcontent-%COMP%]{color:var(--xa-red)}.closed[_ngcontent-%COMP%], .Closed[_ngcontent-%COMP%], .Complete[_ngcontent-%COMP%], .complete[_ngcontent-%COMP%]{color:var(--xa-blue)}.draft[_ngcontent-%COMP%], .Draft[_ngcontent-%COMP%]{color:var(--xa-draft)}.noshow[_ngcontent-%COMP%], .NoShow[_ngcontent-%COMP%]{color:var(--xa-noshow)}.repairestimation[_ngcontent-%COMP%], .RepairEstimation[_ngcontent-%COMP%]{color:var(--xa-repair-estimate)}.uploaddocuments[_ngcontent-%COMP%], .UploadDocuments[_ngcontent-%COMP%]{color:var(--xa-upload-document)}.addphotos[_ngcontent-%COMP%], .AddPhotos[_ngcontent-%COMP%], .uploadPhotos[_ngcontent-%COMP%], .UploadPhotos[_ngcontent-%COMP%]{color:var(--xa-upload-photo)}.vehicledetails[_ngcontent-%COMP%], .VehicleDetails[_ngcontent-%COMP%]{color:var(--xa-vehicle-detail)}.total[_ngcontent-%COMP%]{position:absolute;top:60px;z-index:2;display:flex;justify-content:center;gap:.2vw;font-size:.8rem}@media (max-width: 1250px){.total[_ngcontent-%COMP%]{top:100px;width:100%}}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;flex-direction:row;padding:3px 6px;gap:.4vw;border-radius:3px;justify-content:center;align-items:center;word-break:break-all;white-space:break-spaces}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .has-background[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{line-height:14px}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:not(.has-background){background:black;color:#fff}.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   span.has-background[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.margin-right[_ngcontent-%COMP%]{margin-right:50px}.no-data-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:calc(50vh - 170px)}.no-data-wrapper[_ngcontent-%COMP%]   .no-data-content[_ngcontent-%COMP%]{display:inline-grid;justify-items:center;color:var(--xa-dark-gray);gap:8px}"]}),g})()},94526:(ht,at,s)=>{"use strict";s.d(at,{i:()=>gt});var O=s(36895),B=s(71764),tt=s(33938),r=s(94650),c=s(81364),J=s(36978),a=s(48262),Z=s(73546),e=s(97392),Y=s(81390),S=s(89383);function H(I,W){if(1&I){const P=r.EpF();r.TgZ(0,"img",24),r.NdJ("error",function(){r.CHM(P);const K=r.oxw(2);return r.KtG(K.avatar="")})("load",function(){r.CHM(P);const K=r.oxw(2);return r.KtG(K.orgImageLoading=!1)}),r.qZA()}if(2&I){const P=r.oxw(2);r.Q6J("src",P.orgLogoUrl,r.LSH)}}function o(I,W){if(1&I&&(r.TgZ(0,"label",26),r._uU(1),r.qZA()),2&I){const P=r.oxw(3);r.xp6(1),r.Oqu(P.orgName)}}function V(I,W){if(1&I&&r.YNc(0,o,2,1,"label",25),2&I){const P=r.oxw(2);r.Q6J("ngIf",P.orgName)}}function it(I,W){if(1&I&&(r.TgZ(0,"div",13)(1,"div",14)(2,"div",15)(3,"a",16)(4,"div",17),r.YNc(5,H,1,1,"img",18),r.YNc(6,V,1,1,"ng-template",null,19,r.W1O),r._UZ(8,"chq-customloader",20),r.qZA()(),r.TgZ(9,"div",21),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"div",22),r._uU(13),r.qZA()()(),r.TgZ(14,"div",23),r._uU(15),r.ALo(16,"translate"),r.qZA()()),2&I){const P=r.MAs(7),L=r.oxw();r.xp6(5),r.Q6J("ngIf",L.orgLogoUrl)("ngIfElse",P),r.xp6(3),r.Q6J("showLoading",L.orgImageLoading),r.xp6(2),r.Oqu(r.lcZ(11,7,"outbound_dashboard")),r.xp6(3),r.Oqu(L.currentDate),r.xp6(2),r.AsE(" ",r.lcZ(16,9,"last_refreshed"),": ",L.LastRefreshed," ")}}function t(I,W){if(1&I&&(r.TgZ(0,"button",50),r._UZ(1,"mat-icon",51),r.qZA()),2&I){const P=W.$implicit,L=r.oxw(3);r.xp6(1),r.Q6J("svgIcon",L.jobIconDictionary[P.Name]?L.jobIconDictionary[P.Name]:"gears"),r.uIk("color","black")}}function rt(I,W){if(1&I&&(r.TgZ(0,"th",33)(1,"div",34),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"div",48),r.YNc(5,t,2,2,"button",49),r.qZA()()),2&I){const P=r.oxw().$implicit;r.xp6(2),r.Oqu(r.lcZ(3,2,"repair_types")),r.xp6(3),r.Q6J("ngForOf",P.RepairServiceTypes)}}function ot(I,W){if(1&I&&(r.TgZ(0,"th",52)(1,"div",53)(2,"div",54),r._uU(3),r.qZA(),r.TgZ(4,"div",55),r._uU(5),r.qZA()()()),2&I){const P=W.$implicit;r.xp6(1),r.Udp("background-color",P.Color),r.xp6(2),r.Oqu(P.JobName),r.xp6(2),r.hij("",P.CompletePercentage,"%")}}function ct(I,W){if(1&I){const P=r.EpF();r.TgZ(0,"mat-card",27)(1,"div",28)(2,"div",29)(3,"div",30)(4,"table",31)(5,"tr",32)(6,"th",33)(7,"div",34),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.TgZ(10,"div",35),r._uU(11),r.qZA()(),r.TgZ(12,"th",33)(13,"div",34),r._uU(14),r.ALo(15,"translate"),r.qZA(),r.TgZ(16,"div",35),r._uU(17),r.qZA()(),r.TgZ(18,"th",33)(19,"div",34),r._uU(20),r.ALo(21,"translate"),r.qZA(),r.TgZ(22,"div",35),r._uU(23),r.qZA()(),r.TgZ(24,"th",33)(25,"div",34),r._uU(26),r.ALo(27,"translate"),r.qZA(),r.TgZ(28,"div",35),r._uU(29),r.qZA()(),r.YNc(30,rt,6,4,"th",36),r.TgZ(31,"th",33)(32,"div",37)(33,"button",38),r._uU(34),r.ALo(35,"translate"),r.ALo(36,"lowercase"),r.qZA()()()()()()(),r.TgZ(37,"div",39)(38,"div",40)(39,"div",41)(40,"table",42)(41,"tr",43)(42,"th",44)(43,"div",45)(44,"img",46),r.NdJ("load",function(){const $=r.CHM(P).$implicit;return r.KtG($.ImageUrlFirstLoad=!1)}),r.qZA(),r._UZ(45,"chq-customloader",20),r.qZA()(),r.YNc(46,ot,6,4,"th",47),r.TgZ(47,"th",44)(48,"div",45)(49,"img",46),r.NdJ("load",function(){const $=r.CHM(P).$implicit;return r.KtG($.ImageUrlLastLoad=!1)}),r.qZA(),r._UZ(50,"chq-customloader",20),r.qZA()()()()()()()()()}if(2&I){const P=W.$implicit;r.Q6J("ngClass",null===P.OutboundStatus||"Repair Not Started"===P.OutboundStatus||"Repair In Progress"===P.OutboundStatus?"card-gray":"Ready To PickUp"===P.OutboundStatus?"card-yellow":"Picked Up"===P.OutboundStatus?"card-green":"card-gray"),r.xp6(8),r.Oqu(r.lcZ(9,17,"work_provider")),r.xp6(3),r.Oqu(P.VehicleInsurerName),r.xp6(3),r.Oqu(r.lcZ(15,19,"driver_owner_name")),r.xp6(3),r.Oqu(P.CustomerName),r.xp6(3),r.Oqu(r.lcZ(21,21,"vehicle")),r.xp6(3),r.AsE("",P.VehicleMake," ",P.VehicleName,""),r.xp6(3),r.Oqu(r.lcZ(27,23,"plate_number")),r.xp6(3),r.Oqu(P.VehicleLicensePlate),r.xp6(1),r.Q6J("ngIf",P.RepairServiceTypes.length>0),r.xp6(4),r.Oqu(r.lcZ(35,25,r.lcZ(36,27,P.OutboundStatus.split(" ").join("")))),r.xp6(10),r.Q6J("src",null===P.ImageUrlFirst?"assets/img/front-left.png":P.ImageUrlFirst,r.LSH),r.xp6(1),r.Q6J("showLoading",P.ImageUrlFirstLoad),r.xp6(1),r.Q6J("ngForOf",P.Jobs),r.xp6(3),r.Q6J("src",null===P.ImageUrlLast?"assets/img/front-left.png":P.ImageUrlLast,r.LSH),r.xp6(1),r.Q6J("showLoading",P.ImageUrlLastLoad)}}function pt(I,W){1&I&&(r.TgZ(0,"div",56)(1,"div",57),r._UZ(2,"img",58),r.TgZ(3,"span"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"span"),r._uU(7),r.ALo(8,"translate"),r.qZA()()()),2&I&&(r.xp6(4),r.Oqu(r.lcZ(5,2,"no_result_found")),r.xp6(3),r.hij("",r.lcZ(8,4,"could_not_find_any_data"),"."))}let gt=(()=>{class I{constructor(P,L,K,$){this.datePipe=P,this.commonService=L,this.OutboundService=K,this.document=$,this.FullscreenButton={label:"view_full_screen",type:"outline",icon:"fullscreen"},this.jobIconDictionary={Body:"car",Paint:"paint-nozzle",Mechanical:"mechanical",Electrical:"electric",Tires:"tire",Preparation:"car-roof","Check In":"checkbox-open","Panel Repair":"door-panel","Panel Fitup":"door-panel",Polish:"car-paint",Detailing:"car-cleaning",Maintenance:"maintenance",Diagnosis:"diagnosis",Others:"gears"},this.currentDate=B().format("MMMM DD, YYYY hh:mm a"),this.LastRefreshed=B().format("DD/MM/YYYY HH:mm:ss"),this.loungeTimeout=null,this.currentDateTimeout=null,this.subs=[],this.CallingAPI=!1,this.outboundData=[],this.FocusedRepairIndex=0,this.orgImageLoading=!0,this.orgLogoUrl="",this.orgName="",this.i18n=this.commonService.geti18nInfo(),this.commonService.userProfileData.subscribe({next:y=>{y&&(this.orgLogoUrl=y?.data.organizationDetail?.logoUrl,this.orgName=y?.data.organizationDetail?.name,this.orgLogoUrl||(this.orgImageLoading=!1))}})}ngOnInit(){this.chkScreenMode(),this.elem=document.documentElement,this.getOutboundData(!0)}getOutboundData(P){this.CallingAPI=!0,P&&this.commonService.showLoading();const L=new Date((new Date).toDateString()).toISOString(),K=new Date(new Date((new Date).toDateString()).getTime()+864e5-1e3).toISOString();this.subs.push(this.OutboundService.getDeparturesDetails(`$filter=BookingEndDate ge ${L} and BookingEndDate lt ${K} or PickUpDate ge ${L} and PickUpDate lt ${K}`).subscribe({next:y=>{this.CallingAPI=!1,this.outboundData=[],y.value.forEach(X=>{if(X?.Jobs?.length>0){if(null!==X.PickUpDate&&!(new Date(L)<new Date(X.PickUpDate)&&new Date(K)>new Date(X.PickUpDate)))return;X.ImageUrlFirstLoad=!0,X.ImageUrlLastLoad=!0,this.outboundData.push(X)}}),this.LastRefreshed=B().format("DD/MM/YYYY HH:mm:ss"),this.commonService.hideLoading(),clearTimeout(this.currentDateTimeout),this.currentDateTimeout=setTimeout(()=>{this.updateCurrentDateTime()},6e4),setTimeout(()=>{const X=document.querySelectorAll(".card");0==this.FocusedRepairIndex?document.querySelector(".lounge-content").scrollTop=0:X[this.FocusedRepairIndex].scrollIntoView({behavior:"smooth",block:"start"})},500),clearTimeout(this.loungeTimeout),this.loungeTimeout=setTimeout(()=>{this.getOutboundData(!1)},3e5)},error:y=>{this.CallingAPI=!1,clearTimeout(this.loungeTimeout)}}))}updateCurrentDateTime(){this.currentDate=B().format("MMMM DD, YYYY hh:mm a"),this.autoScrollLastVisibleNode(),clearTimeout(this.currentDateTimeout),this.currentDateTimeout=setTimeout(()=>{this.updateCurrentDateTime()},6e4)}autoScrollLastVisibleNode(){const P=document.querySelector(".lounge-content"),L=document.querySelectorAll(".card");if(null==P||null==L)return;if(this.FocusedRepairIndex==L.length-1)return this.FocusedRepairIndex=0,void(P.scrollTop=0);let K=0;const $=P.clientHeight;for(let y=this.FocusedRepairIndex;y<L.length;y++){if(K+=L[y].clientHeight,K>=$){this.FocusedRepairIndex=y,L[y].scrollIntoView({behavior:"smooth",block:"start"});break}y===L.length-1&&(this.FocusedRepairIndex=0,P.scrollTop=0)}}fullscreenmodes(P){this.chkScreenMode()}chkScreenMode(){this.isFullScreen=!(!document.fullscreenElement&&!document.webkitIsFullScreen)}openFullscreen(){this.elem.requestFullscreen?this.elem.requestFullscreen():this.elem.mozRequestFullScreen?this.elem.mozRequestFullScreen():this.elem.webkitRequestFullscreen?this.elem.webkitRequestFullscreen():this.elem.msRequestFullscreen&&this.elem.msRequestFullscreen()}ngOnDestroy(){this.subs.forEach(P=>P.unsubscribe()),clearTimeout(this.loungeTimeout)}}return I.\u0275fac=function(P){return new(P||I)(r.Y36(O.uU),r.Y36(c.v),r.Y36(tt.Q),r.Y36(O.K0))},I.\u0275cmp=r.Xpm({type:I,selectors:[["app-lounge-list"]],hostBindings:function(P,L){1&P&&r.NdJ("fullscreenchange",function($){return L.fullscreenmodes($)},!1,r.evT)("webkitfullscreenchange",function($){return L.fullscreenmodes($)},!1,r.evT)("mozfullscreenchange",function($){return L.fullscreenmodes($)},!1,r.evT)("MSFullscreenChange",function($){return L.fullscreenmodes($)},!1,r.evT)("onwebkitfullscreenchange",function($){return L.fullscreenmodes($)},!1,r.evT)},features:[r._Bn([tt.Q])],decls:15,vars:8,consts:[[1,"page-container","lounge-list-container","mh-0","mt-0","fx-col"],[1,"fx-0","lounge-list-header"],[1,"header-content","fx-row","justify-space-between","align-center"],[1,"last-updated"],[3,"buttonModel","click"],["class","fullscreen",4,"ngIf"],[1,"lounge-content"],["class","card block",3,"ngClass",4,"ngFor","ngForOf"],["class","no-data-wrapper",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png","alt",""],[1,"fullscreen"],[1,"lounge-header","fx-0","fx-col","justify-center"],[1,"lounge-header-content","align-center","fx-row"],["routerLink","/",1,"xa-logo-wrapper"],[1,"menu-image"],[3,"src","error","load",4,"ngIf","ngIfElse"],["name",""],[3,"showLoading"],[1,"lounge-title-wrapper"],[1,"lounge-date-wrapper"],[1,"last-updated","fx-0","flex","justify-end"],[3,"src","error","load"],["class","org-name",4,"ngIf"],[1,"org-name"],[1,"card","block",3,"ngClass"],[1,"card-container"],[1,"card-header"],[1,"card-header-container","align-center","fx-row"],[1,"card-head-table"],[1,"head-row"],[1,"head-item"],[1,"header-title"],[1,"header-content-data"],["class","head-item",4,"ngIf"],[1,"repair-state"],[1,"repair-state-btn"],[1,"card-content"],[1,"job-list-container","fx-row","align-center"],[1,"jobs-list"],[1,"card-table"],[1,"card-row"],[1,"card-job"],[1,"img-container"],["alt","",3,"src","load"],["class","card-job text-white",4,"ngFor","ngForOf"],[1,"fx-row",2,"display","flex !important","padding-top","5px","flex-wrap","wrap"],["class","outbound-icon-btn",4,"ngFor","ngForOf"],[1,"outbound-icon-btn"],[3,"svgIcon"],[1,"card-job","text-white"],[1,"card-job-content","block"],[1,"job-name"],[1,"job-percent"],[1,"no-data-wrapper"],[1,"no-data-content"],["src","assets/img/no-data.png","alt",""]],template:function(P,L){1&P&&(r.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"chq-button",4),r.NdJ("click",function(){return L.openFullscreen()}),r.qZA()()(),r.YNc(7,it,17,11,"div",5),r.TgZ(8,"div",6),r.YNc(9,ct,51,29,"mat-card",7),r.YNc(10,pt,9,6,"div",8),r.qZA()(),r.TgZ(11,"div",9)(12,"div",10)(13,"div",11),r._UZ(14,"img",12),r.qZA()()()),2&P&&(r.xp6(4),r.AsE(" ",r.lcZ(5,6,"last_refreshed"),": ",L.LastRefreshed," "),r.xp6(2),r.Q6J("buttonModel",L.FullscreenButton),r.xp6(1),r.Q6J("ngIf",L.isFullScreen),r.xp6(2),r.Q6J("ngForOf",L.outboundData),r.xp6(1),r.Q6J("ngIf",0===L.outboundData.length&&!L.CallingAPI))},dependencies:[O.mk,O.sg,O.O5,J.E,a.h,Z.a8,e.Hw,Y.rH,O.i8,S.X$],styles:[".lounge-list-container[_ngcontent-%COMP%]{background:var(--xa-popup-light-gray);height:calc(100vh - 76px - (58px + 1.6vw))}.lounge-list-container[_ngcontent-%COMP%]   .lounge-list-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{margin:2vh 1vw}.lounge-list-container[_ngcontent-%COMP%]   .lounge-list-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .last-updated[_ngcontent-%COMP%]{font-size:16px;font-weight:400;line-height:20px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]{overflow:hidden;overflow-y:auto}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{margin:2vh 1vw;background-color:#1a22330d;border-radius:10px;width:calc(98vw - 100px)}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:10px;border-radius:10px 10px 0 0}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]{justify-content:space-between}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]{width:100%}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]{text-align:left;display:flex;justify-content:space-between;align-items:center}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]   .head-item[_ngcontent-%COMP%]{text-align:left}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]   .head-item[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-weight:400;font-size:14px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]   .head-item[_ngcontent-%COMP%]   .header-content-data[_ngcontent-%COMP%]{padding-top:5px;font-size:16px;font-weight:700;display:inline-block;word-break:break-all}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]   .head-item[_ngcontent-%COMP%]   .outbound-icon-btn[_ngcontent-%COMP%]{margin:0 2px;max-width:45px;max-height:35px;background-color:#1f202314}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]   .head-item[_ngcontent-%COMP%]   .outbound-icon-btn[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:30px;height:30px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]   .head-item[_ngcontent-%COMP%]   .repair-state[_ngcontent-%COMP%]   .repair-state-btn[_ngcontent-%COMP%]{font-weight:700;font-size:16px;font-family:Inter;font-style:normal;pointer-events:none;min-width:168px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .card-header-container[_ngcontent-%COMP%]   .card-head-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]   .head-item[_ngcontent-%COMP%]   .repair-state[_ngcontent-%COMP%]   .lap-btn[_ngcontent-%COMP%]{background-color:var(--xa-red);color:var(--xa-white);border:2px solid var(--xa-white)}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{border-radius:0 0 10px 10px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]{width:100%;padding:20px 0}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]   .jobs-list[_ngcontent-%COMP%]{padding:0 15px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]   .jobs-list[_ngcontent-%COMP%]   .card-table[_ngcontent-%COMP%]   .card-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]   .jobs-list[_ngcontent-%COMP%]   .card-table[_ngcontent-%COMP%]   .card-row[_ngcontent-%COMP%]   .card-job[_ngcontent-%COMP%]{padding:0 10px;position:relative;overflow:hidden}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]   .jobs-list[_ngcontent-%COMP%]   .card-table[_ngcontent-%COMP%]   .card-row[_ngcontent-%COMP%]   .card-job[_ngcontent-%COMP%]   .card-job-content[_ngcontent-%COMP%]{display:inline-grid;padding:10px 9px;height:105px;width:128px;border-radius:10px;border:2px solid var(--xa-white);font-size:12px;font-weight:400}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]   .jobs-list[_ngcontent-%COMP%]   .card-table[_ngcontent-%COMP%]   .card-row[_ngcontent-%COMP%]   .card-job[_ngcontent-%COMP%]   .card-job-content[_ngcontent-%COMP%]   .job-name[_ngcontent-%COMP%]{padding-top:20px;word-break:break-all}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]   .jobs-list[_ngcontent-%COMP%]   .card-table[_ngcontent-%COMP%]   .card-row[_ngcontent-%COMP%]   .card-job[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]{position:relative;height:118px;width:148px;border-radius:10px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]   .jobs-list[_ngcontent-%COMP%]   .card-table[_ngcontent-%COMP%]   .card-row[_ngcontent-%COMP%]   .card-job[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:148px;height:118px;border-radius:10px}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .job-list-container[_ngcontent-%COMP%]   .jobs-move-btn[_ngcontent-%COMP%]{background-color:transparent}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:first-child{margin-top:0}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-green[_ngcontent-%COMP%]{border:1px solid #03A31B}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-green[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{background-color:transparent}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-green[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background-color:#1b9235}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-yellow[_ngcontent-%COMP%]{border:1px solid #D2A120}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-yellow[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{background-color:transparent}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-yellow[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background-color:#d2a600}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-gray[_ngcontent-%COMP%]{border:1px solid #1a2233}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-gray[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{background-color:transparent}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .card-gray[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{background-color:#78777d}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .no-data-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:10%}.lounge-list-container[_ngcontent-%COMP%]   .lounge-content[_ngcontent-%COMP%]   .no-data-wrapper[_ngcontent-%COMP%]   .no-data-content[_ngcontent-%COMP%]{display:inline-grid;justify-items:center;color:var(--xa-dark-gray);gap:8px}.lounge-list-container[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   .last-updated[_ngcontent-%COMP%]{margin:2vh 1vw}.lounge-list-container[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   .lounge-header[_ngcontent-%COMP%]{background-color:#1b03a3;color:var(--xa-white);min-height:81px;position:sticky;top:0;z-index:9}.lounge-list-container[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   .lounge-header[_ngcontent-%COMP%]   .lounge-header-content[_ngcontent-%COMP%]{justify-content:space-between;background-color:transparent;padding:0 15px 0 40px;height:100%}.lounge-list-container[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   .lounge-header[_ngcontent-%COMP%]   .lounge-header-content[_ngcontent-%COMP%]   .lounge-title-wrapper[_ngcontent-%COMP%]{font-size:30px;font-weight:700}.lounge-list-container[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   .lounge-header[_ngcontent-%COMP%]   .lounge-header-content[_ngcontent-%COMP%]   .xa-logo-wrapper[_ngcontent-%COMP%]{text-decoration:none}.lounge-list-container[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   .lounge-header[_ngcontent-%COMP%]   .lounge-header-content[_ngcontent-%COMP%]   .xa-logo-wrapper[_ngcontent-%COMP%]   .menu-image[_ngcontent-%COMP%]{display:flex;height:60px;position:relative}.lounge-list-container[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   .lounge-header[_ngcontent-%COMP%]   .lounge-header-content[_ngcontent-%COMP%]   .xa-logo-wrapper[_ngcontent-%COMP%]   .menu-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;max-height:60px}.lounge-list-container[_ngcontent-%COMP%]   .fullscreen[_ngcontent-%COMP%]   .lounge-header[_ngcontent-%COMP%]   .lounge-header-content[_ngcontent-%COMP%]   .xa-logo-wrapper[_ngcontent-%COMP%]   .menu-image[_ngcontent-%COMP%]   .org-name[_ngcontent-%COMP%]{font-weight:500;font-size:8px;line-height:14px;color:var(--xa-black-dark);padding:8px 4px;text-align:center;border:1px solid var(--xa-light-gray);border-radius:8px;display:flex;cursor:pointer;flex:1;justify-content:center;align-items:center;box-sizing:border-box;background-color:var(--xa-white)}"]}),I})()},68358:(ht,at,s)=>{"use strict";s.d(at,{e:()=>wt});var O=s(15861),B=s(71764),j=s(33938),tt=s(7274),r=s(81390),c=s(39300),J=s(18505),a=s(95698),Z=s(8358),e=s(94650),Y=s(81364),S=s(36895),H=s(73546),o=s(97392),V=s(89383);function it(M,E){1&M&&(e.TgZ(0,"div",19)(1,"span",20),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&M&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"label_mandatory")))}function t(M,E){1&M&&(e.TgZ(0,"span",38),e._uU(1,"*"),e.qZA())}function rt(M,E){1&M&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function ot(M,E){if(1&M&&(e.TgZ(0,"span",23),e._uU(1),e.YNc(2,rt,2,0,"span",18),e.qZA()),2&M){const l=E.$implicit,C=E.index,v=e.oxw().$implicit;e.xp6(1),e.hij(" ",l.repairServiceTypeName,""),e.xp6(1),e.Q6J("ngIf",C!==v.repairJobMappings.length-1)}}function ct(M,E){if(1&M&&(e.TgZ(0,"div",39),e._uU(1),e.ALo(2,"date"),e.qZA()),2&M){const l=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,l.completedDate,"dd/MM/yyyy hh:mm:ss"))}}function pt(M,E){1&M&&e._UZ(0,"div",40)}function gt(M,E){1&M&&e._UZ(0,"span",41)}function I(M,E){1&M&&e._UZ(0,"span",42)}function W(M,E){if(1&M){const l=e.EpF();e.TgZ(0,"tr",21)(1,"td",22)(2,"span",23),e._uU(3),e.YNc(4,t,2,0,"span",24),e.qZA()(),e.TgZ(5,"td",25),e.YNc(6,ot,3,2,"span",26),e.qZA(),e.TgZ(7,"td",27)(8,"div",23)(9,"div",28),e._uU(10),e.qZA(),e.YNc(11,ct,3,4,"div",29),e.qZA()(),e.TgZ(12,"td",30)(13,"span",23)(14,"div",31)(15,"mat-icon",32),e.NdJ("click",function(v){const w=e.CHM(l).$implicit,p=e.oxw();return v.stopPropagation(),e.KtG(p.showCommentDialog(null==w?null:w.notes,w))}),e.qZA(),e.YNc(16,pt,1,0,"div",33),e.qZA()()(),e.TgZ(17,"td",34)(18,"div",35),e.YNc(19,gt,1,0,"span",36),e.YNc(20,I,1,0,"span",37),e._uU(21),e.ALo(22,"translate"),e.qZA()()()}if(2&M){const l=E.$implicit;e.xp6(3),e.Oqu(l.name),e.xp6(1),e.Q6J("ngIf",l.isMandatory),e.xp6(2),e.Q6J("ngForOf",l.repairJobMappings),e.xp6(4),e.Oqu(l.modifiedBy),e.xp6(1),e.Q6J("ngIf",l.completedDate),e.xp6(4),e.Q6J("svgIcon","comment"),e.xp6(1),e.Q6J("ngIf",null==l?null:l.notes),e.xp6(3),e.Q6J("ngIf",null!==l.completedBy),e.xp6(1),e.Q6J("ngIf",null===l.completedBy),e.xp6(1),e.hij(" ",e.lcZ(22,10,"task_done")," ")}}function P(M,E){1&M&&(e.TgZ(0,"div")(1,"span",43),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&M&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"no_task_found")))}let L=(()=>{class M{constructor(l,C,v,u,w,p){this.dialog=l,this.dialogRef=C,this.data=v,this.OutboundService=w,this.commonService=p,this.subs=[],this.ListOfRepairs=[],this.CallingAPI=!1,this.allMandatoryTasks=0,u.events.pipe((0,c.h)(D=>D instanceof r.OD),(0,J.b)(()=>this.dialogRef.close()),(0,a.q)(1)).subscribe()}ngOnInit(){this.getTaskDetails()}getTaskDetails(){const l=this.data.repair.RepairGuid,C=this.data.job.JobGuid;this.CallingAPI=!0,this.commonService.showLoading(),this.subs.push(this.OutboundService.getTaskDetails(l,C).subscribe({next:v=>{this.ListOfRepairs=v,this.allMandatoryTasks=this.ListOfRepairs.filter(u=>!0===u.isMandatory).length,this.CallingAPI=!1,this.commonService.hideLoading()},error:v=>{this.CallingAPI=!1}}))}showCommentDialog(l,C){let v="";l&&(v=l),this.dialog.open(Z.E,{data:{notes:v,hideUpdate:!0},panelClass:"comment-modalbox",autoFocus:!1}).afterClosed().subscribe({next:u=>{u&&(u.delete&&(u.comment=""),C.isNoteLoading=!0)}})}ngOnDestroy(){this.subs.forEach(l=>l.unsubscribe())}}return M.\u0275fac=function(l){return new(l||M)(e.Y36(tt.uw),e.Y36(tt.so),e.Y36(tt.WI),e.Y36(r.F0),e.Y36(j.Q),e.Y36(Y.v))},M.\u0275cmp=e.Xpm({type:M,selectors:[["app-check-in-task"]],features:[e._Bn([j.Q])],decls:31,vars:20,consts:[[1,"dialog-with-header"],[1,"header"],[1,"title"],[1,"action"],[1,"close-dailog-btn"],["color","white",3,"svgIcon","mat-dialog-close"],[1,"mat-content-dialog"],[1,"repair-card","border-10"],[1,"repair-table-header"],["class","mandatory-div",4,"ngIf"],[1,"repair-dialog-table"],[1,"task-hearder"],[1,"task-hearder-item","task_Name_column"],[1,"task-hearder-item","repair_type_column"],[1,"task-hearder-item","modified_column"],[1,"task-hearder-item","note_column"],[1,"task-hearder-item","status_column"],["class","task-data-row",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mandatory-div"],[1,"mandatory-text","text-danger"],[1,"task-data-row"],[1,"task-data-item","task_Name_column"],[1,"task-data"],["class","text-danger",4,"ngIf"],[1,"task-data-item","repair_type_column"],["class","task-data",4,"ngFor","ngForOf"],[1,"task-data-item","modified_column"],[1,"modified_name"],["class","span-date",4,"ngIf"],[1,"task-data-item","note_column"],[1,"comment-div"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon","click"],["class","red-icon",4,"ngIf"],[1,"task-data-item","status_column"],[1,"col-2","relate-spinner"],["class","checked",4,"ngIf"],["class","circle",4,"ngIf"],[1,"text-danger"],[1,"span-date"],[1,"red-icon"],[1,"checked"],[1,"circle"],[1,"not-found-task"]],template:function(l,C){1&l&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3)(5,"button",4),e._UZ(6,"mat-icon",5),e.qZA()()(),e.TgZ(7,"mat-dialog-content",6)(8,"mat-card",7)(9,"div",8),e.YNc(10,it,4,3,"div",9),e.TgZ(11,"table",10)(12,"tr",11)(13,"th",12),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th",13),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th",14),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th",15),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th",16),e._uU(26),e.ALo(27,"translate"),e.qZA()()()(),e.TgZ(28,"table",10),e.YNc(29,W,23,12,"tr",17),e.qZA()(),e.YNc(30,P,4,3,"div",18),e.qZA()()),2&l&&(e.xp6(3),e.hij(" ",C.data.job.JobName," "),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(4),e.Q6J("ngIf",C.allMandatoryTasks>0),e.xp6(4),e.Oqu(e.lcZ(15,10,"item_name")),e.xp6(3),e.Oqu(e.lcZ(18,12,"repair_type")),e.xp6(3),e.Oqu(e.lcZ(21,14,"modified_by")),e.xp6(3),e.Oqu(e.lcZ(24,16,"notes")),e.xp6(3),e.Oqu(e.lcZ(27,18,"done")),e.xp6(3),e.Q6J("ngForOf",C.ListOfRepairs),e.xp6(1),e.Q6J("ngIf",0===C.ListOfRepairs.length&&!C.CallingAPI))},dependencies:[S.sg,S.O5,H.a8,o.Hw,tt.ZT,tt.xY,S.uU,V.X$],styles:['.dialog-with-header[_ngcontent-%COMP%]{height:600px;width:1015px}.dialog-with-header[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background-color:#4c6bd2;color:var(--xa-white)}.dialog-with-header[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .close-dailog-btn[_ngcontent-%COMP%]{border-radius:50%;background-color:#0000007a;width:40px;height:40px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .task-name[_ngcontent-%COMP%]{background-color:#eff1ff;height:30px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .task-name[_ngcontent-%COMP%]   .ml-25[_ngcontent-%COMP%]{font-weight:700;color:#000;font-size:18px;vertical-align:sub}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]{background-color:#eff1ff}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-hearder[_ngcontent-%COMP%]{background-color:#eff1ff;height:30px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-hearder[_ngcontent-%COMP%]   .task-hearder-item[_ngcontent-%COMP%]{text-align:left;color:var(--xa-dark-gray);font-size:12px;font-weight:500;line-height:35px;letter-spacing:-.25px;height:36px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-hearder[_ngcontent-%COMP%]   .task_Name_column[_ngcontent-%COMP%]{width:314px;padding-left:25px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-hearder[_ngcontent-%COMP%]   .repair_type_column[_ngcontent-%COMP%]{width:184px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-hearder[_ngcontent-%COMP%]   .modified_column[_ngcontent-%COMP%]{width:136px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-hearder[_ngcontent-%COMP%]   .note_column[_ngcontent-%COMP%]{width:35px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-table-header[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-hearder[_ngcontent-%COMP%]   .status_column[_ngcontent-%COMP%]{width:114px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]{border-collapse:collapse}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]{background-color:#fff;height:61px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .task-data-item[_ngcontent-%COMP%]{color:var(--xa-black);font-size:12px;font-weight:400;line-height:14px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .task-data-item[_ngcontent-%COMP%]   .task-data[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{height:20px;width:20px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .task-data-item[_ngcontent-%COMP%]   .task-data[_ngcontent-%COMP%]   .comment-div[_ngcontent-%COMP%]{position:relative}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .task-data-item[_ngcontent-%COMP%]   .task-data[_ngcontent-%COMP%]   .comment-div[_ngcontent-%COMP%]   .red-icon[_ngcontent-%COMP%]{height:7px;width:7px;position:absolute;background:var(--xa-red);top:-1px;left:12px;border-radius:50%;border:2px solid var(--xa-white)}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .task_Name_column[_ngcontent-%COMP%]{width:314px;padding-left:25px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .repair_type_column[_ngcontent-%COMP%]{width:184px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .modified_column[_ngcontent-%COMP%]{width:136px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .note_column[_ngcontent-%COMP%]{width:35px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]   .status_column[_ngcontent-%COMP%]{width:114px}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]:nth-child(even){background-color:var(--xa-white-light);margin-right:0;margin-left:0}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .repair-card[_ngcontent-%COMP%]   .repair-dialog-table[_ngcontent-%COMP%]   .task-data-row[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--xa-table-light);margin-right:0;margin-left:0}.dialog-with-header[_ngcontent-%COMP%]   .mat-content-dialog[_ngcontent-%COMP%]   .not-found-task[_ngcontent-%COMP%]{justify-content:space-around;display:flex;font-weight:500;font-size:20px;color:var(--xa-gray);margin-top:20px}.ml-25[_ngcontent-%COMP%]{margin-left:25px}.round[_ngcontent-%COMP%]{position:relative}.checked[_ngcontent-%COMP%]{display:inline-flex;border:1px solid var(--xa-repair-header);background-color:var(--xa-repair-header);border-radius:50%;height:20px;width:20px;position:relative;cursor:pointer;margin-right:4px}.circle[_ngcontent-%COMP%]{display:inline-flex;border:1px solid var(--xa-light-gray);background-color:var(--xa-light-radio-gray);border-radius:50%;height:20px;width:20px;position:relative;cursor:pointer;margin-right:4px}.checked[_ngcontent-%COMP%]:after{content:"";position:absolute}.checked[_ngcontent-%COMP%]:after{left:7px;top:3px;width:4px;height:10px;border:solid var(--xa-white);border-width:0 3px 3px 0;transform:rotate(45deg)}.relate-spinner[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.mandatory-div[_ngcontent-%COMP%]{margin-top:10px}.mandatory-text[_ngcontent-%COMP%]{font-size:12px;font-weight:700;padding-left:20px;line-height:20px}.span-date[_ngcontent-%COMP%]{font-size:10px;line-height:14px;font-weight:300}']}),M})();var K=s(15058),$=s(17771),y=s(8985),X=s(36978),_=s(48262),U=s(10266),R=s(22284),G=s(93077);function Mt(M,E){if(1&M){const l=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){const u=e.CHM(l).$implicit,w=e.oxw();return e.KtG(w.changeCurrentDate(u))}),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"date"),e.qZA()()}if(2&M){const l=E.$implicit,C=e.oxw();e.Q6J("ngClass",l.getDay()===C.currentWeek.getDay()?"active":""),e.xp6(2),e.Oqu(e.xi3(3,3,l,"dd EEEE")),e.xp6(3),e.Oqu(e.xi3(6,6,l,"MMM"))}}function N(M,E){if(1&M&&(e.TgZ(0,"div",63),e._uU(1),e.qZA()),2&M){const l=E.$implicit;e.xp6(1),e.Oqu(l.AssigneeName)}}function F(M,E){if(1&M&&(e.TgZ(0,"th")(1,"div",34),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",36),e.YNc(5,N,2,1,"div",62),e.qZA()()),2&M){const l=e.oxw().$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"assigned")),e.xp6(3),e.Q6J("ngForOf",l.Assignees)}}function f(M,E){if(1&M&&(e.TgZ(0,"div",66)(1,"button",67),e.ALo(2,"translate"),e.ALo(3,"lowercase"),e._UZ(4,"mat-icon",68),e.qZA()()),2&M){const l=E.$implicit,C=e.oxw(4);e.xp6(1),e.s9C("matTooltip",e.lcZ(2,3,e.lcZ(3,5,null===l.Name?"Others":l.Name))),e.xp6(3),e.Q6J("svgIcon",C.jobIconDictionary[l.Name]?C.jobIconDictionary[l.Name]:"gears"),e.uIk("color","black")}}function m(M,E){if(1&M&&(e.TgZ(0,"th")(1,"div",34),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",64),e.YNc(5,f,5,7,"div",65),e.qZA()()),2&M){const l=e.oxw().$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"repair_types")),e.xp6(3),e.Q6J("ngForOf",l.RepairServiceTypes)}}function A(M,E){if(1&M&&(e.TgZ(0,"th"),e._UZ(1,"div",34),e.TgZ(2,"div",69)(3,"button",67),e.ALo(4,"translate"),e._UZ(5,"mat-icon",68),e.qZA()()()),2&M){const l=e.oxw().$implicit;e.xp6(3),e.Q6J("matTooltip",e.lcZ(4,3,l.IsTowedIn?"towed_in":"not_towed_in")),e.xp6(2),e.Q6J("svgIcon","towing"),e.uIk("color",l.IsTowedIn?"black":"dark-gray-disabled")}}function Q(M,E){if(1&M){const l=e.EpF();e.TgZ(0,"div",70)(1,"button",71),e.NdJ("click",function(){e.CHM(l),e.oxw();const v=e.MAs(42),u=e.oxw(2);return e.KtG(u.move_scroll("left",v))}),e._UZ(2,"mat-icon",6),e.qZA()()}}function et(M,E){if(1&M){const l=e.EpF();e.TgZ(0,"th")(1,"div",72),e.NdJ("click",function(){const u=e.CHM(l).$implicit,w=e.oxw().$implicit,p=e.oxw(2);return e.KtG(p.openJobpopup(w,u))}),e.TgZ(2,"div")(3,"span",73),e._uU(4),e.qZA()(),e.TgZ(5,"p"),e._uU(6),e.qZA()()()}if(2&M){const l=E.$implicit;e.xp6(1),e.Udp("background-color",l.Color),e.xp6(3),e.Oqu(l.JobName),e.xp6(2),e.hij("",l.CompletePercentage,"%")}}function _t(M,E){if(1&M){const l=e.EpF();e.TgZ(0,"div",74)(1,"button",71),e.NdJ("click",function(){e.CHM(l),e.oxw();const v=e.MAs(42),u=e.oxw(2);return e.KtG(u.move_scroll("right",v))}),e._UZ(2,"mat-icon",9),e.qZA()()}}function Pt(M,E){1&M&&(e.TgZ(0,"span",75),e._uU(1,"Pick up date cannot set as past date"),e.qZA())}function bt(M,E){if(1&M){const l=e.EpF();e.TgZ(0,"chq-button",76),e.NdJ("click",function(){e.CHM(l);const v=e.oxw().$implicit,u=e.oxw(2);return e.KtG(u.openEmailForNotify(v))}),e.qZA()}if(2&M){const l=e.oxw(3);e.Q6J("buttonModel",l.notifyButton)}}const xt=function(M,E,l,C,v){return[M,E,l,C,v]};function Dt(M,E){if(1&M){const l=e.EpF();e.TgZ(0,"mat-card",31)(1,"table",32)(2,"tr",33)(3,"th")(4,"div",34),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",35),e.NdJ("click",function(){const u=e.CHM(l).$implicit,w=e.oxw(2);return e.KtG(w.bookingStatusUrl(u))}),e._uU(8),e.qZA()(),e.TgZ(9,"th")(10,"div",34),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",36),e._uU(14),e.qZA()(),e.TgZ(15,"th")(16,"div",34),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"div",36),e._uU(20),e.qZA()(),e.TgZ(21,"th")(22,"div",34),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div",36),e._uU(26),e.qZA()(),e.YNc(27,F,6,4,"th",37),e.TgZ(28,"th")(29,"div",34),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"div",38)(33,"div"),e._uU(34),e.ALo(35,"xaCurrency"),e.qZA()()(),e.YNc(36,m,6,4,"th",37),e.YNc(37,A,6,5,"th",37),e.qZA()(),e.TgZ(38,"div",39)(39,"div",40),e.YNc(40,Q,3,0,"div",41),e.TgZ(41,"div",42,43)(43,"table",44)(44,"tr",45)(45,"th")(46,"div",46)(47,"img",47),e.NdJ("load",function(){const u=e.CHM(l).$implicit;return e.KtG(u.ImageUrlFirstLoad=!1)}),e.qZA(),e._UZ(48,"chq-customloader",48),e.qZA()(),e.YNc(49,et,7,4,"th",49),e.TgZ(50,"th")(51,"div",46)(52,"img",50),e.NdJ("load",function(){const u=e.CHM(l).$implicit;return e.KtG(u.ImageUrlLastLoad=!1)}),e.qZA(),e._UZ(53,"chq-customloader",48),e.qZA()()()()(),e.YNc(54,_t,3,0,"div",51),e.qZA(),e.TgZ(55,"div",52)(56,"div",53)(57,"div",54)(58,"div",55)(59,"label",56),e._uU(60),e.ALo(61,"translate"),e.qZA(),e.TgZ(62,"dx-date-box",57),e.NdJ("onValueChanged",function(v){const u=e.CHM(l),w=u.$implicit,p=u.index,D=e.oxw(2);return e.KtG(D.updateInput(v,w.RepairGuid,p))}),e.qZA(),e.YNc(63,Pt,2,0,"span",58),e.qZA(),e.YNc(64,bt,1,1,"chq-button",59),e.qZA()(),e.TgZ(65,"div",60)(66,"span",61),e._uU(67),e.ALo(68,"translate"),e.ALo(69,"translate"),e.qZA()()()()()}if(2&M){const l=E.$implicit,C=e.MAs(42),v=e.oxw(2);e.Q6J("ngClass",null===l.OutboundStatus||"Repair Not Started"===l.OutboundStatus||"Repair In Progress"===l.OutboundStatus?"card-table-gray":"Ready To PickUp"===l.OutboundStatus?"card-table-yellow":"Picked Up"===l.OutboundStatus?"card-table-green":"card-table-gray"),e.xp6(1),e.Q6J("ngClass",null===l.OutboundStatus||"Repair Not Started"===l.OutboundStatus||"Repair In Progress"===l.OutboundStatus?"header-table-gray":"Ready To PickUp"===l.OutboundStatus?"header-table-yellow":"Picked Up"===l.OutboundStatus?"header-table-green":"card-table-gray"),e.xp6(4),e.Oqu(e.lcZ(6,43,"booking_id")),e.xp6(3),e.Oqu(l.RepairNumber),e.xp6(3),e.Oqu(e.lcZ(12,45,"work_provider")),e.xp6(3),e.Oqu(l.VehicleInsurerName),e.xp6(3),e.Oqu(e.lcZ(18,47,"driver_owner_name")),e.xp6(3),e.Oqu(l.CustomerName),e.xp6(3),e.Oqu(e.lcZ(24,49,"vehicle")),e.xp6(3),e.AsE("",l.VehicleMake," ",l.VehicleName,""),e.xp6(1),e.Q6J("ngIf",l.Assignees.length>0),e.xp6(3),e.Oqu(e.lcZ(31,51,"cost")),e.xp6(4),e.Oqu(e.G7q(35,53,e.qbA(65,xt,l.TotalAmount,v.i18n.currencySymbol,v.i18n.digitsInfo,v.i18n.locale,v.i18n.position))),e.xp6(2),e.Q6J("ngIf",l.RepairServiceTypes.length>0),e.xp6(1),e.Q6J("ngIf",l.IsTowedIn),e.xp6(3),e.Q6J("ngIf",v.checkJobWrapperScroll("left",C)),e.xp6(7),e.Q6J("src",null===l.ImageUrlFirst?"assets/img/front-left.png":l.ImageUrlFirst,e.LSH),e.xp6(1),e.Q6J("showLoading",l.ImageUrlFirstLoad),e.xp6(1),e.Q6J("ngForOf",l.Jobs),e.xp6(3),e.Q6J("src",null===l.ImageUrlLast?"assets/img/front-left.png":l.ImageUrlLast,e.LSH),e.xp6(1),e.Q6J("showLoading",l.ImageUrlLastLoad),e.xp6(1),e.Q6J("ngIf",v.checkJobWrapperScroll("right",C)),e.xp6(6),e.Oqu(e.lcZ(61,59,v.PickUpDateTextBox.label)),e.xp6(2),e.Q6J("value",l.PickUpDate)("acceptCustomValue",!1)("invalidDateMessage","")("max",v.PickUpDateTextBox.maxDate)("min",v.PickUpDateTextBox.minDate)("validationError",!1)("validationMessageMode","none")("disabled",!!v.isTechnician||"Ready To PickUp"!==l.OutboundStatus)("showClearButton",!1)("useMaskBehavior",!0)("openOnFieldClick",!0)("adaptivityEnabled",!0)("pickerType","calendar"),e.xp6(1),e.Q6J("ngIf",null==l?null:l.PickupDateError),e.xp6(1),e.Q6J("ngIf",!v.isTechnician&&!l.IsPickedUp&&null!==l.PickUpDate&&"Ready To PickUp"===l.OutboundStatus&&l.CommunicationTypes.length>0),e.xp6(3),e.HOy("",e.lcZ(68,61,"initial_booking_out_date"),": ",v.date_format(l.BookingEndDate)," | ",l.LagInDays," ",e.lcZ(69,63,"days"),"")}}function Tt(M,E){if(1&M&&(e.TgZ(0,"div",21)(1,"div",22)(2,"div",23)(3,"label"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"div",24),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"div",25)(10,"div",26)(11,"mat-icon",27),e._uU(12,"directions_car"),e.qZA(),e.TgZ(13,"label"),e._uU(14),e.qZA()(),e.TgZ(15,"div",28),e._UZ(16,"mat-icon",29),e.TgZ(17,"label"),e._uU(18),e.ALo(19,"xaCurrency"),e.qZA()()()(),e.YNc(20,Dt,70,71,"mat-card",30),e.qZA()),2&M){const l=e.oxw();e.xp6(4),e.hij(" ",e.xi3(5,6,l.currentWeek,"EEEE, d MMMM y")," "),e.xp6(3),e.AsE("",e.lcZ(8,9,"last_refreshed"),": ",l.lastUpdated,""),e.xp6(7),e.Oqu(l.departures.length),e.xp6(4),e.Oqu(e.G7q(19,11,e.qbA(17,xt,l.TotalAmount,l.i18n.currencySymbol,l.i18n.digitsInfo,l.i18n.locale,l.i18n.position))),e.xp6(2),e.Q6J("ngForOf",l.departures)}}function kt(M,E){1&M&&(e.TgZ(0,"div",77)(1,"div",78),e._UZ(2,"img",79),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA()()()),2&M&&(e.xp6(4),e.Oqu(e.lcZ(5,2,"no_result_found")),e.xp6(3),e.hij("",e.lcZ(8,4,"could_not_find_any_data"),"."))}let wt=(()=>{class M{constructor(l,C,v,u,w,p){this.OutboundService=l,this.router=C,this.dialog=v,this.datePipe=u,this.bookingService=w,this.commonService=p,this.jobIconDictionary={Body:"car",Paint:"paint-nozzle",Mechanical:"mechanical",Electrical:"electric",Tires:"tire",Preparation:"car-roof","Check In":"checkbox-open","Panel Repair":"door-panel","Panel Fitup":"door-panel",Polish:"car-paint",Detailing:"car-cleaning",Maintenance:"maintenance",Diagnosis:"diagnosis",Others:"gears"},this.departures=[],this.subs=[],this.PickUpDateTextBox={placeHolder:"pickup_date",label:"pick_up_date_time",name:"",type:"datetime",maxDate:B().add(6,"month").toDate(),minDate:new Date,value:new Date},this.notifyButton={label:"notify",type:"outline",icon:"send"},this.currentWeek=new Date,this.currentWeekNumber=1,this.dates=[],this.IntervalGetOutBound=null,this.lastUpdated=B().format("DD/MM/YYYY HH:mm:ss"),this.CallingAPI=!1,this.isTechnician=!1,this.TotalAmount=0,this.i18n=this.commonService.geti18nInfo(),this.getWeekDates(new Date(this.currentWeek))}ngOnInit(){this.getDeparturesDetails(),this.commonService.userProfileData.subscribe(l=>{if(l?.data){const v=l?.data?.userPermission?.automotiveServices?.find(u=>"addenda repair"===u.automotiveServiceName.toLowerCase());this.isTechnician=!(!v||"technician"!==v.roleName.toLowerCase())}})}getDeparturesDetails(){var l=this;return(0,O.Z)(function*(){l.CallingAPI=!0,l.commonService.showLoading(),l.departures=[];const C=new Date(l.currentWeek.toDateString()).toISOString(),v=new Date(new Date(l.currentWeek.toDateString()).getTime()+864e5-1e3).toISOString();l.subs.push(l.OutboundService.getDeparturesDetails(`$filter=BookingEndDate ge ${C} and BookingEndDate lt ${v} or PickUpDate ge ${C} and PickUpDate lt ${v}`).subscribe({next:w=>{l.CallingAPI=!1,l.TotalAmount=0,w.value.forEach(p=>{if(p?.Jobs?.length>0){if(null!==p.PickUpDate&&!(new Date(C)<new Date(p.PickUpDate)&&new Date(v)>new Date(p.PickUpDate)))return;p.ImageUrlFirstLoad=!0,p.ImageUrlLastLoad=!0,l.TotalAmount+=p.TotalAmount,l.departures.push(p)}}),l.lastUpdated=B().format("DD/MM/YYYY HH:mm:ss"),l.commonService.hideLoading(),clearTimeout(l.IntervalGetOutBound),l.IntervalGetOutBound=setTimeout(()=>{l.getDeparturesDetails()},3e5)},error:w=>{l.CallingAPI=!1,clearTimeout(l.IntervalGetOutBound)}}))})()}date_format(l){return B(l).format("D dddd, of MMMM YYYY")}updateInput(l,C,v){if(new Date(l.value).getTime()===new Date(l.previousValue).getTime())return;if(this.departures[v].PickupDateError=!1,new Date(l.value)<new Date)return void(this.departures[v].PickupDateError=!0);const u=new Date(l.value).toISOString();new Date(u)!=new Date(this.departures[v].PickUpDate)&&(this.commonService.showLoading(),this.subs.push(this.OutboundService.setPickupDate(C,u,!1).subscribe({next:w=>{this.commonService.showInfoToast(1e3,w.message),this.commonService.hideLoading(),this.departures[v].PickUpDate=u}})))}openJobpopup(l,C){this.dialog.open(L,{data:{repair:l,job:C}})}getWeekNumber(l){const C=l,v=new Date(C.getFullYear(),0,1),u=Math.floor((C-v)/864e5);return Math.ceil(u/7)}getWeekDates(l){const v=[],u=0==l.getDay()?7:l.getDay(),w=new Date(l.setDate(l.getDate()-u+1));for(let p=0;p<7;p++){const D=new Date(w),b=new Date(D.setDate(w.getDate()+p));b.getMonth()<w.getMonth()&&b.getMonth()==l.getFullYear()&&b.setMonth(w.getMonth()),v.push(b)}return this.currentWeekNumber=this.getWeekNumber(this.currentWeek),this.dates=v,v}changeCurrentWeek(l){if("left"===l){const C=this.dates[0];this.currentWeek=new Date(C.setDate(C.getDate()-7))}else{const C=this.dates[6];this.currentWeek=new Date(C.setDate(C.getDate()+1))}this.getWeekDates(new Date(this.currentWeek)),this.departures=[],this.getDeparturesDetails()}TodayWeek(){this.currentWeek=new Date,this.getWeekDates(new Date(this.currentWeek)),this.departures=[],this.getDeparturesDetails()}changeCurrentDate(l){this.currentWeek=l,this.departures=[],this.getDeparturesDetails()}move_scroll(l,C){C.scrollLeft="left"===l?C.scrollLeft-160:C.scrollLeft+160}checkJobWrapperScroll(l,C){return"left"===l?!(C.scrollLeft<=0):!(C.scrollLeft>=C.scrollWidth-C.clientWidth-1)}openEmailForNotify(l){var v,C=this;this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(l.RepairGuid).subscribe({next:(v=(0,O.Z)(function*(u){u?.data&&C.openEmailForNotifyInner(l.RepairGuid,u.data.domainId,u.data.booking.communicationTypeId,u.data.communicationEvents),C.commonService.hideLoading()}),function(w){return v.apply(this,arguments)}),error:function(){var v=(0,O.Z)(function*(u){C.commonService.hideLoading()});return function(w){return v.apply(this,arguments)}}()})}openEmailForNotifyInner(l,C,v,u){this.dialog.open(K.b,{data:{repairGuid:l,domainId:C,templateId:2,communicationList:v,communicatedList:u},backdropClass:"confirmation-popup-backdrop",maxHeight:"693px",maxWidth:"629px"})}bookingStatusUrl(l){const{RepairStatus:C,RepairGuid:v}=l,u=C.split(" ").join("");let w=$.A[u?.toLowerCase()]||$.A.others;w=w.replace("{{repairGUID}}",v),this.router.navigate([w])}ngOnDestroy(){this.subs.forEach(l=>l.unsubscribe()),clearTimeout(this.IntervalGetOutBound)}}return M.\u0275fac=function(l){return new(l||M)(e.Y36(j.Q),e.Y36(r.F0),e.Y36(tt.uw),e.Y36(S.uU),e.Y36(y.q),e.Y36(Y.v))},M.\u0275cmp=e.Xpm({type:M,selectors:[["app-outbound"]],features:[e._Bn([j.Q])],decls:27,vars:23,consts:[[1,"page-container","outbound-container","mh-0","mt-0","fx-col"],[1,"fx-0","outbound-header"],[1,"fx-row","date-filter-wrapper",2,"padding-bottom","26px"],[1,"fx-row","change-week-btn","align-center"],[1,"fx-row","align-center","week-days-tile"],["type","button",1,"btn","btn-left",3,"click"],["color","black","svgIcon","arrow-left"],[1,"week-tile-content"],["type","button",1,"btn","btn-right",3,"click"],["color","black","svgIcon","arrow-right"],["type","button",1,"btn","current-week-btn",3,"click"],[1,"fx-row","week-tiles"],["type","button","class","day-tile",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"outbound-container-wrapper"],["class","outbound-card",4,"ngIf"],["class","no-data-wrapper",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png","alt",""],["type","button",1,"day-tile",3,"ngClass","click"],[1,"outbound-card"],[1,"card-header","fx-row","justify-space-between"],[1,"fx-col","left-content"],[1,"last-updated"],[1,"fx-row","right-content"],[1,"fx-row","align-center","repair-count"],["color","dark-gray"],[1,"fx-row","align-center","total-amount"],["svgIcon","double-database",2,"margin-right","8px"],["class","card border-10",3,"ngClass",4,"ngFor","ngForOf"],[1,"card","border-10",3,"ngClass"],[1,"header-table","border-top-10",2,"padding-bottom","8px",3,"ngClass"],[2,"text-align","left","padding","10px","display","flex","justify-content","space-between"],[1,"header-type-text"],[1,"header-content","link",3,"click"],[1,"header-content"],[4,"ngIf"],[1,"flex","align-center","header-content"],[1,"outbound-card-content","border-bottom-10"],[1,"outbound-jobs-container","fx-row","align-center"],["class","move-left-wrapper",4,"ngIf"],[1,"outbound-jobs-wrapper"],["job_scroll_wrapper",""],[1,"outbound-table","border-bottom-10"],[1,"flex","align-center"],[1,"img-container"],["alt","",1,"rapair-car-img",3,"src","load"],[3,"showLoading"],[4,"ngFor","ngForOf"],["alt","",3,"src","load"],["class","move-right-wrapper",4,"ngIf"],[1,"date-card","flex","align-end"],[1,"date-selector"],[1,"input-wrapper","flex","align-end"],[1,"pickup_wrapper"],[1,"input-label","text-muted","uppercase"],["type","datetime",3,"value","acceptCustomValue","invalidDateMessage","max","min","validationError","validationMessageMode","disabled","showClearButton","useMaskBehavior","openOnFieldClick","adaptivityEnabled","pickerType","onValueChanged"],["class","pickupDate-error input-label text-muted",4,"ngIf"],["class","notify-btn",3,"buttonModel","click",4,"ngIf"],[1,"day-counter"],[1,"text-muted"],["class","flex",4,"ngFor","ngForOf"],[1,"flex"],[1,"flex","align-center",2,"flex-wrap","wrap"],["class","header-repair-type",4,"ngFor","ngForOf"],[1,"header-repair-type"],["matTooltipPosition","above",1,"outbound-icon-btn",3,"matTooltip"],[3,"svgIcon"],[1,"is-towing"],[1,"move-left-wrapper"],["type","button",1,"jobs-move-btn",3,"click"],[1,"outbound-header-card",3,"click"],[1,"uppercase"],[1,"move-right-wrapper"],[1,"pickupDate-error","input-label","text-muted"],[1,"notify-btn",3,"buttonModel","click"],[1,"no-data-wrapper"],[1,"no-data-content"],["src","assets/img/no-data.png","alt",""]],template:function(l,C){1&l&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),e.NdJ("click",function(){return C.changeCurrentWeek("left")}),e._UZ(6,"mat-icon",6),e.qZA(),e.TgZ(7,"span",7),e._uU(8),e.ALo(9,"date"),e.ALo(10,"date"),e.ALo(11,"date"),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"button",8),e.NdJ("click",function(){return C.changeCurrentWeek("right")}),e._UZ(14,"mat-icon",9),e.qZA()(),e.TgZ(15,"button",10),e.NdJ("click",function(){return C.TodayWeek()}),e._uU(16),e.ALo(17,"translate"),e.qZA()(),e.TgZ(18,"div",11),e.YNc(19,Mt,7,9,"button",12),e.qZA()()(),e.TgZ(20,"div",13),e.YNc(21,Tt,21,23,"div",14),e.YNc(22,kt,9,6,"div",15),e.qZA()(),e.TgZ(23,"div",16)(24,"div",17)(25,"div",18),e._UZ(26,"img",19),e.qZA()()()),2&l&&(e.xp6(8),e.xDo("",e.xi3(9,9,C.dates[0],"dd"),"-",e.xi3(10,12,C.dates[6],"dd")," ",e.xi3(11,15,C.dates[0],"MMM")," ",e.xi3(12,18,C.dates[0],"YY")," (",C.currentWeekNumber,")"),e.xp6(8),e.Oqu(e.lcZ(17,21,"today")),e.xp6(3),e.Q6J("ngForOf",C.dates),e.xp6(2),e.Q6J("ngIf",C.departures.length>0),e.xp6(1),e.Q6J("ngIf",0===C.departures.length&&!C.CallingAPI))},dependencies:[S.mk,S.sg,S.O5,X.E,_.h,H.a8,o.Hw,U.gM,R.M,S.i8,S.uU,G.j,V.X$],styles:[".outbound-container[_ngcontent-%COMP%]{height:calc(100vh - 76px - (58px + 1.6vw));overflow-y:auto}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]{position:relative;top:0;padding-top:5px;z-index:1;background:var(--xa-popup-light-gray)}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]{display:grid;justify-content:space-around;background:var(--xa-popup-light-gray)}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .change-week-btn[_ngcontent-%COMP%]{margin-bottom:25px;justify-content:center;gap:25px}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .change-week-btn[_ngcontent-%COMP%]   .week-days-tile[_ngcontent-%COMP%]{gap:20px}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .change-week-btn[_ngcontent-%COMP%]   .week-days-tile[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background-color:transparent}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .change-week-btn[_ngcontent-%COMP%]   .week-days-tile[_ngcontent-%COMP%]   .week-tile-content[_ngcontent-%COMP%]{font-size:20px;flex:none}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .change-week-btn[_ngcontent-%COMP%]   .week-days-tile[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:15px;height:15px}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .change-week-btn[_ngcontent-%COMP%]   .current-week-btn[_ngcontent-%COMP%]{height:40px;width:61px;background-color:#f4f5fd;border:1px solid var(--xa-light-gray)!important}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .week-tiles[_ngcontent-%COMP%]   .day-tile[_ngcontent-%COMP%]{background-color:#f4f5fd;border:1px solid var(--xa-light-gray)!important;display:grid;min-height:70px;height:auto;border-radius:0;font-size:16px}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .week-tiles[_ngcontent-%COMP%]   .day-tile.active[_ngcontent-%COMP%]{background-color:#4c6bd2;color:var(--xa-white)}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .week-tiles[_ngcontent-%COMP%]   .day-tile[_ngcontent-%COMP%]:first-child{border-radius:8px 0 0 8px}.outbound-container[_ngcontent-%COMP%]   .outbound-header[_ngcontent-%COMP%]   .date-filter-wrapper[_ngcontent-%COMP%]   .week-tiles[_ngcontent-%COMP%]   .day-tile[_ngcontent-%COMP%]:last-child{border-radius:0 8px 8px 0}.container[_ngcontent-%COMP%]{padding-bottom:0!important}.header-type-text[_ngcontent-%COMP%]{margin-bottom:5px;font-size:12px;font-style:normal;font-weight:400;line-height:20px}.border-10[_ngcontent-%COMP%]{border-radius:10px}.border-top-10[_ngcontent-%COMP%]{border-top-left-radius:10px;border-top-right-radius:10px}.border-bottom-10[_ngcontent-%COMP%]{border-bottom-left-radius:10px;border-bottom-right-radius:10px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]{margin-bottom:20px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{margin:15px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;line-height:18px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .left-content[_ngcontent-%COMP%]   .last-updated[_ngcontent-%COMP%]{font-weight:500;font-size:11px;color:var(--xa-gray);line-height:21.23px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]{gap:34px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]   .repair-count[_ngcontent-%COMP%]{gap:6px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]   .repair-count[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .right-content[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:20px;font-weight:500;line-height:25px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{min-height:332.15px;margin:15px;background-color:#1a22330d;width:calc(100% - 30px)}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table[_ngcontent-%COMP%]{min-height:68px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{max-width:240px;display:inline-block;overflow:hidden;font-size:12px;font-weight:700;word-break:break-all}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]:hover{cursor:pointer;text-decoration:underline}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table[_ngcontent-%COMP%]   .header-repair-type[_ngcontent-%COMP%]{margin-right:10px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table[_ngcontent-%COMP%]   .header-repair-type[_ngcontent-%COMP%]   .outbound-icon-btn[_ngcontent-%COMP%]{padding:0;width:30px;height:30px;background-color:#1f202314}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table[_ngcontent-%COMP%]   .is-towing[_ngcontent-%COMP%]{margin:18px 0 0;padding-right:20px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table[_ngcontent-%COMP%]   .is-towing[_ngcontent-%COMP%]   .outbound-icon-btn[_ngcontent-%COMP%]{padding:0;width:30px;height:30px;background-color:#1f202314}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table-gray[_ngcontent-%COMP%]{background-color:#78777d}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table-green[_ngcontent-%COMP%]{background-color:#1b9235}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .header-table-yellow[_ngcontent-%COMP%]{background-color:#d2a600}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .outbound-jobs-container[_ngcontent-%COMP%]{justify-content:space-between}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .outbound-jobs-container[_ngcontent-%COMP%]   .outbound-jobs-wrapper[_ngcontent-%COMP%]{overflow-x:hidden;width:100%}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .outbound-jobs-container[_ngcontent-%COMP%]   .outbound-jobs-wrapper[_ngcontent-%COMP%]   .outbound-table[_ngcontent-%COMP%]{height:160px;width:100%}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .outbound-jobs-container[_ngcontent-%COMP%]   .outbound-jobs-wrapper[_ngcontent-%COMP%]   .outbound-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:0 10px;position:relative;overflow:hidden}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .outbound-jobs-container[_ngcontent-%COMP%]   .outbound-jobs-wrapper[_ngcontent-%COMP%]   .outbound-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]{position:relative;height:126px;width:144px;border-radius:10px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .outbound-jobs-container[_ngcontent-%COMP%]   .outbound-jobs-wrapper[_ngcontent-%COMP%]   .outbound-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:126px;width:144px;border-radius:10px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .outbound-jobs-container[_ngcontent-%COMP%]   .outbound-jobs-wrapper[_ngcontent-%COMP%]   .outbound-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .outbound-header-card[_ngcontent-%COMP%]{width:116px;height:100px;border-radius:10px;border:2px solid var(--xa-white);font-size:12px;font-weight:400;padding:13px 14px;margin:16px auto;color:#fff;display:flex;flex-direction:column;justify-content:space-around;cursor:pointer}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .outbound-jobs-container[_ngcontent-%COMP%]   .jobs-move-btn[_ngcontent-%COMP%]{background-color:transparent}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .date-card[_ngcontent-%COMP%]{justify-content:space-between;margin:0 20px 20px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .date-card[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .pickup_wrapper[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{font-size:12px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .date-card[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .pickup_wrapper[_ngcontent-%COMP%]   .pickupDate-error[_ngcontent-%COMP%]{color:var(--xa-red)}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .date-card[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .notify-btn[_ngcontent-%COMP%]{padding-left:5px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .date-card[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]   .date-card[_ngcontent-%COMP%]   .day-counter[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{font-weight:500;font-size:14px}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-table-gray[_ngcontent-%COMP%]{border:1px solid #1a2233}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-table-gray[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]{background-color:transparent}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-table-green[_ngcontent-%COMP%]{border:1px solid #03A31B}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-table-green[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]{background-color:transparent}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-table-yellow[_ngcontent-%COMP%]{border:1px solid #D2A120}.outbound-container-wrapper[_ngcontent-%COMP%]   .outbound-card[_ngcontent-%COMP%]   .card-table-yellow[_ngcontent-%COMP%]   .outbound-card-content[_ngcontent-%COMP%]{background-color:transparent}.outbound-container-wrapper[_ngcontent-%COMP%]   .no-data-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:10%}.outbound-container-wrapper[_ngcontent-%COMP%]   .no-data-wrapper[_ngcontent-%COMP%]   .no-data-content[_ngcontent-%COMP%]{display:inline-grid;justify-items:center;color:var(--xa-dark-gray);gap:8px}"]}),M})()},45306:(ht,at,s)=>{"use strict";s.r(at),s.d(at,{RepairModule:()=>v});var O=s(36895),B=s(97392),j=s(81390),tt=s(61978),r=s(89383),c=s(20489),J=s(20363),a=s(44466),Z=s(9655),e=s(39300),Y=s(35235),S=s(75983),H=s(38588),o=s(94650),V=s(38709),it=s(81364),t=s(13975),rt=s(35493),ot=s(87855),ct=s(12484),pt=s(7274),gt=s(77782),I=s(54135),W=s(65504);const P=["tabs"],L=["tabMain"],K=["userDetail"];function $(u,w){if(1&u&&(o.TgZ(0,"div",25)(1,"div",26),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"div",19),o._uU(5),o.qZA()()),2&u){const p=o.oxw(3);o.xp6(2),o.hij("",o.lcZ(3,2,"make"),": "),o.xp6(3),o.hij("",p.caseData.vehicleMake," ")}}function y(u,w){if(1&u&&(o.TgZ(0,"span",20)(1,"span",21),o._uU(2),o.ALo(3,"translate"),o.qZA(),o._uU(4,": "),o.TgZ(5,"b"),o._uU(6),o.qZA()()),2&u){const p=o.oxw(4);o.xp6(2),o.Oqu(o.lcZ(3,2,"model")),o.xp6(4),o.Oqu(p.caseData.vehicleModel)}}function X(u,w){if(1&u&&(o.TgZ(0,"span",20)(1,"span",21),o._uU(2),o.ALo(3,"translate"),o.qZA(),o._uU(4,": "),o.TgZ(5,"b"),o._uU(6),o.qZA()()),2&u){const p=o.oxw(4);o.xp6(2),o.Oqu(o.lcZ(3,2,"license_plate")),o.xp6(4),o.Oqu(p.caseData.licensePlate)}}function _(u,w){if(1&u&&(o.TgZ(0,"div",30),o.YNc(1,y,7,4,"span",31),o.YNc(2,X,7,4,"span",31),o.qZA()),2&u){const p=o.oxw(3);o.xp6(1),o.Q6J("ngIf",null==p.caseData?null:p.caseData.vehicleModel),o.xp6(1),o.Q6J("ngIf",null==p.caseData?null:p.caseData.licensePlate)}}const U=function(u){return{"expand-main-wrapper":u}},R=function(u){return{width:u}};function G(u,w){if(1&u){const p=o.EpF();o.TgZ(0,"div",15)(1,"div",16,17)(3,"div",18)(4,"div",19),o._uU(5),o.qZA(),o.TgZ(6,"div",20)(7,"span",21),o._uU(8),o.ALo(9,"translate"),o.qZA(),o._uU(10,": "),o.TgZ(11,"b"),o._uU(12),o.qZA()()(),o.TgZ(13,"div",22)(14,"div",23),o.YNc(15,$,6,4,"div",24),o.TgZ(16,"div",25)(17,"div",26),o._uU(18),o.ALo(19,"translate"),o.qZA(),o.TgZ(20,"div",19),o._uU(21),o.qZA()()(),o.YNc(22,_,3,2,"div",27),o.qZA(),o.TgZ(23,"div",28)(24,"mat-icon",29),o.NdJ("click",function(){o.CHM(p);const b=o.oxw(2);return o.KtG(b.expand())}),o.qZA()()()()}if(2&u){const p=o.oxw(2);o.Q6J("ngClass",o.VKq(15,U,p.expandUserDetail))("ngStyle",o.VKq(17,R,p.expandUserDetail?p.containerWidth:"")),o.xp6(5),o.AsE("",p.customerData.firstName," ",p.customerData.lastName,""),o.xp6(3),o.Oqu(o.lcZ(9,11,"booking_id")),o.xp6(4),o.hij("",p.bookingId," "),o.xp6(3),o.Q6J("ngIf",null==p.caseData?null:p.caseData.vehicleMake),o.xp6(3),o.hij("",o.lcZ(19,13,"status"),": "),o.xp6(3),o.hij("",p.statusDesc," "),o.xp6(1),o.Q6J("ngIf",null==p.caseData?null:p.caseData.vehicleMake),o.xp6(2),o.Q6J("svgIcon",p.expandUserDetail?"dropdown-up":"dropdown")}}function Mt(u,w){if(1&u&&(o.ynx(0),o.YNc(1,G,25,19,"div",14),o.BQk()),2&u){const p=o.oxw();o.xp6(1),o.Q6J("ngIf",p.showUserSection)}}function N(u,w){if(1&u&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"translate"),o.TgZ(3,"b"),o._uU(4),o.qZA()()),2&u){const p=o.oxw(3);o.xp6(1),o.hij("",o.lcZ(2,2,"status"),": "),o.xp6(3),o.Oqu(p.statusDesc)}}function F(u,w){if(1&u&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"translate"),o.TgZ(3,"b"),o._uU(4),o.qZA()()),2&u){const p=o.oxw(3);o.xp6(1),o.hij("",o.lcZ(2,2,"make"),": "),o.xp6(3),o.Oqu(p.caseData.vehicleMake)}}function f(u,w){if(1&u&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"translate"),o.TgZ(3,"b"),o._uU(4),o.qZA()()),2&u){const p=o.oxw(3);o.xp6(1),o.hij("",o.lcZ(2,2,"year"),": "),o.xp6(3),o.Oqu(p.caseData.year)}}function m(u,w){if(1&u&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"translate"),o.TgZ(3,"b"),o._uU(4),o.qZA()()),2&u){const p=o.oxw(3);o.xp6(1),o.hij("",o.lcZ(2,2,"model"),": "),o.xp6(3),o.Oqu(p.caseData.vehicleModel)}}function A(u,w){if(1&u&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"translate"),o.TgZ(3,"b"),o._uU(4),o.qZA()()),2&u){const p=o.oxw(3);o.xp6(1),o.hij("",o.lcZ(2,2,"license_plate"),": "),o.xp6(3),o.Oqu(p.caseData.licensePlate)}}const Q=function(u){return{expand:u}};function et(u,w){if(1&u){const p=o.EpF();o.TgZ(0,"div",15)(1,"div",16,17)(3,"div",18)(4,"div",19),o._uU(5),o.qZA(),o.TgZ(6,"div",20)(7,"span",21),o._uU(8),o.ALo(9,"translate"),o.qZA(),o._uU(10,": "),o.TgZ(11,"b"),o._uU(12),o.qZA()()(),o.TgZ(13,"div",28)(14,"mat-icon",29),o.NdJ("click",function(){o.CHM(p);const b=o.oxw(2);return o.KtG(b.expand())}),o.qZA()()(),o.TgZ(15,"div",32)(16,"div",33)(17,"div",34),o.NdJ("click",function(){o.CHM(p);const b=o.oxw(2);return o.KtG(b.openLabourRate())}),o.TgZ(18,"span"),o._uU(19),o.ALo(20,"translate"),o.qZA()(),o.TgZ(21,"div",22)(22,"div",35),o.YNc(23,N,5,4,"span",12),o.YNc(24,F,5,4,"span",12),o.YNc(25,f,5,4,"span",12),o.YNc(26,m,5,4,"span",12),o.YNc(27,A,5,4,"span",12),o.qZA()()()()()}if(2&u){const p=o.oxw(2);o.Q6J("ngClass",o.VKq(18,U,p.expandUserDetail))("ngStyle",o.VKq(20,R,p.expandUserDetail?p.containerWidth:"")),o.xp6(5),o.AsE("",p.customerData.firstName," ",p.customerData.lastName,""),o.xp6(3),o.Oqu(o.lcZ(9,14,"booking_id")),o.xp6(4),o.hij("",p.bookingId," "),o.xp6(2),o.Q6J("svgIcon",p.expandUserDetail?"dropdown-up":"dropdown"),o.xp6(1),o.Q6J("ngClass",o.VKq(22,Q,p.expandUserDetail)),o.xp6(4),o.Oqu(o.lcZ(20,16,"labour_rate_discount")),o.xp6(4),o.Q6J("ngIf",p.status),o.xp6(1),o.Q6J("ngIf",null==p.caseData?null:p.caseData.vehicleMake),o.xp6(1),o.Q6J("ngIf",null==p.caseData?null:p.caseData.year),o.xp6(1),o.Q6J("ngIf",null==p.caseData?null:p.caseData.vehicleModel),o.xp6(1),o.Q6J("ngIf",null==p.caseData?null:p.caseData.licensePlate)}}function _t(u,w){if(1&u&&(o.ynx(0),o.YNc(1,et,28,24,"div",14),o.BQk()),2&u){const p=o.oxw();o.xp6(1),o.Q6J("ngIf",p.showUserSection)}}function Pt(u,w){if(1&u){const p=o.EpF();o.TgZ(0,"chq-tabs",3,36),o.NdJ("menuItemClick",function(b){o.CHM(p);const z=o.oxw();return o.KtG(z.navigate(b))}),o.qZA()}if(2&u){const p=o.oxw();o.Q6J("mode","default")("menuItems",p.menuItems)}}function bt(u,w){if(1&u){const p=o.EpF();o.TgZ(0,"chq-tabs",3,36),o.NdJ("menuItemClick",function(b){o.CHM(p);const z=o.oxw();return o.KtG(z.navigate(b))}),o.qZA()}if(2&u){const p=o.oxw();o.Q6J("mode","default")("menuItems",p.menuRepairItems)}}function xt(u,w){1&u&&(o.TgZ(0,"div",8),o._UZ(1,"router-outlet"),o.qZA())}function Dt(u,w){1&u&&o._UZ(0,"no-access-error")}function Tt(u,w){if(1&u){const p=o.EpF();o.TgZ(0,"history",37),o.NdJ("toggleExpand",function(b){o.CHM(p);const z=o.oxw();return o.KtG(z.onHistoryExpand(b))}),o.qZA()}if(2&u){const p=o.oxw();o.Q6J("history",p.history)("isLoading",p.isHistoryLoading)}}let kt=(()=>{class u{constructor(p,D,b,z,st,ut,nt,ft,k,Ct,lt,vt){this.router=p,this.caseService=D,this.route=b,this.commonService=z,this.cdr=st,this.inspectionService=ut,this.messageService=nt,this.translateService=ft,this.repairEstimateService=k,this.monitorService=Ct,this.dialog=lt,this.datePipe=vt,this.activeItem="Booking",this.bookingId="",this.repairGuid="0",this.repairObjectId=0,this.domainId=3100,this.repairTypes=[],this.showUserSection=!1,this.expandUserDetail=!1,this.status="",this.statusDesc="",this.stepInProgress=!1,this.vehicleId=0,this.caseId="0",this.estimationOperationLength=!1,this.caseData={vehicleMake:"",vehicleModel:""},this.customerData={firstName:"",lastName:"",countryCode:"",mobileNumber:"",email:""},this.history=[],this.workProvider="",this.isCompany=!1,this.isHistoryLoading=!1,this.subscriptions=[],this.isNoShow=!1,this.repairType="",this.roleName="",this.showNoAccess=!1,this.menuItems=H.w0,this.repairMenuItems=H.W1,this.menuRepairItems=H.eg,this.commonService.inProgressSteps.subscribe(Ot=>{this.stepInProgress=Ot>0})}get currentStatus(){return!(!this.status||-1!==["draft","uploaddocuments","uploadphotos"].indexOf(this.status?.toLowerCase()))}onHistoryExpand(p){p&&this.getCaseHistory(this.repairGuid,this.domainId)}mapInspection(p,D){if(p)try{const b=p;if(this.commonService.repairInspectionTemplate){const z=this.commonService.repairInspectionTemplate;if(b?.uploadType)if("spi"===b?.uploadType.toLowerCase()){const nt=b.inspectionItems?.filter(k=>!0!==k.isSkipEnabled).length;if(b.inspectionItems?.filter(k=>k.rawAzureBlobUrl).length<nt)return void this.commonService.showToast(0,`All ${nt} sides images are mandatory and cannot skip to next section.`)}else{const nt=z?.minImageLimit;if(b.inspectionItems.filter(k=>null!=k.rawAzureBlobUrl&&""!=k.rawAzureBlobUrl).length<nt)return void this.commonService.showToast(0,`All ${nt} sides images are mandatory and cannot skip to next section.`)}const st=location.search,ut=D.url;this.tabs?.setActiveMenu(D),-1!==st.indexOf("mode=edit")?this.router.navigate([ut.replace("{bookingId}",this.repairGuid||"")],{queryParams:{mode:"edit"}}):this.router.navigate([ut.replace("{bookingId}",this.repairGuid||"")])}}catch(b){console.log(b)}}getCaseHistory(p,D){this.history=[],this.isHistoryLoading=!0,this.caseService.getCaseHistory(p,D).subscribe({next:b=>{if(b){let z=[];for(let nt=0;nt<b.length;nt++)z=[...z,...b[nt].auditTrailResponseDetails];const st=z.map(nt=>({...nt,auditDate:this.datePipe.transform(nt.actionedOn,"dd/MM/YYYY")})),ut=[];for(let nt=0;nt<st.length;nt++){const ft=ut.find(k=>k.auditDate===st[nt].auditDate);ft?ft.auditTrailResponseDetails.push(st[nt]):ut.push({auditDate:st[nt].auditDate,auditTrailResponseDetails:[st[nt]]})}this.history=ut}},complete:()=>{this.isHistoryLoading=!1}})}getInspectionItems(p,D){this.commonService.showLoading(),this.inspectionService.getInspection(p).subscribe({next:b=>{b&&this.mapInspection(b,D),this.commonService.hideLoading()},complete:()=>{this.commonService.hideLoading()}})}ngOnInit(){const p=this.router.url.split("/");let D=p.length>0?p[p.length-1]:"";-1!=D.indexOf("?")&&(D=D.substring(0,D.indexOf("?"))),["parts","invoices","repair-stages","invoicesEdit"].includes(D)&&(this.activeItem="Repair"),this.route?.params.subscribe(k=>{if(k&&k.id&&(this.repairGuid=k.id,"0"!==this.repairGuid)){const Ct=this.commonService.domainId.pipe((0,e.h)(lt=>null!==lt)).subscribe({next:lt=>{this.getCaseHistory(this.repairGuid,lt),this.domainId=lt}});this.subscriptions.push(Ct)}});const z=this.commonService.accessRightRepair.subscribe({next:k=>{k||(this.showNoAccess=!0)}}),st=this.commonService.bookingId.subscribe({next:k=>{this.bookingId=k,this.cdr.detectChanges()}}),ut=this.commonService.activeItem.subscribe({next:k=>{k&&(this.activeItem=k)}}),nt=this.commonService.repairDetails.subscribe({next:k=>{if(this.showHideTopHeader(),k){this.status=k.status,this.statusDesc=k?.statusDescription,this.customerData.firstName=k.customer?.firstName||"",this.customerData.lastName=k.customer?.lastName||"",this.customerData.mobileNumber=(k.customer?.countryCode||"")+" "+k.customer?.mobileNumber||"",this.customerData.email=k.customer?.email||"",this.workProvider=k.customer?.companyOrgType||"",this.isCompany="Person"!==k.customer?.customerTypeName||!1,this.caseData.vehicleMake=k.vehicle?.vehicleMake||"",this.caseData.vehicleModel=k.vehicle?.vehicleModel||"",this.caseData.licensePlate=k.vehicle?.licensePlateNumber||"",this.caseData.year=k.vehicle?.modelYearRange||"",this.inspectionId=k.vehicle?.inspectionId,this.repairTypes=k.repairServiceTypes,this.repairType=k.repairType,this.domainId=k.domainId,this.commonService.isViewOnly=this.currentOrganizationId!=k.organizationDetail?.organizationId;const Ct=this.router.url.split("/");let lt=Ct.length>0?Ct[Ct.length-1]:"";if(lt.includes("photos")&&!this.inspectionId)return void this.displayMissingInspectionMessage(this.repairGuid);const vt=location.search;if("invoices"===lt&&!vt.includes("isBack=true")){let yt=1;if("paid"===this.status?.toLowerCase()||"invoiced"===this.status?.toLowerCase()||"complete"===this.status?.toLowerCase())return"Retail"===this.workProvider&&!this.isCompany&&(yt=2),void this.router.navigate([`/repair/booking/${this.repairGuid}/invoicesEdit`],{queryParams:{formType:yt}})}if(this.vehicleId=k.vehicle?.vehicleId,this.caseId=k.quoteId,this.domainId=k.domainId,this.repairObjectId=k.id,this.repairMenuItems[1].disabled="assessment"===this.repairType?.toLowerCase(),this.isNoShow=k?.booking?.isNoShow,-1!=lt.indexOf("?")&&(lt=lt.substring(0,lt.indexOf("?"))),"technician"===this.roleName?.toLowerCase()&&"invoices"===lt)return void this.router.navigate([`/repair/booking/${this.repairGuid}/repair-stages`]);["parts","invoices","repair-stages","invoicesEdit"].includes(lt)&&this.getEstimationDetail(k.estimateSource),this.cdr.detectChanges()}}}),ft=this.commonService.userProfileData.subscribe(k=>{if(k?.data){const lt=k?.data?.userPermission?.automotiveServices?.find(Ot=>"addenda repair"===Ot.automotiveServiceName.toLowerCase());this.roleName=lt.roleName.toLowerCase(),this.commonService.roleName=this.roleName,"technician"==this.roleName?.toLowerCase()&&(this.menuRepairItems=this.menuRepairItems.filter(Ot=>"Invoices"!=Ot.name));const vt=k.data.organizationDetail;vt&&(this.currentOrganizationId=vt.id)}});this.subscriptions.push(st),this.subscriptions.push(ut),this.subscriptions.push(nt),this.subscriptions.push(ft),this.subscriptions.push(z)}getEstimationDetail(p){"GTMotive"===p?this.getGTEstimationDetail():this.getManualEstimationDetail()}getGTEstimationDetail(){this.vehicleId&&this.inspectionId&&(this.monitorService.logEvent("getGTEstimationDetail",["CustomerLayoutComponent","addenda-repair"],{repairGuid:this.repairGuid,caseGuid:this.caseId,inspectionId:this.inspectionId,vehicleId:this.vehicleId}),this.commonService.showLoading(),this.repairEstimateService.getEstimate(this.caseId,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:p=>{p?.data?.estimateCharges?.length>0&&(this.estimationOperationLength=!0),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}}))}getManualEstimationDetail(){this.vehicleId&&this.inspectionId&&(this.monitorService.logEvent("getManualEstimationDetail",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId}),this.commonService.showLoading(),this.repairEstimateService.getRepairEstimate(this.repairGuid,this.inspectionId,this.vehicleId).subscribe({next:p=>{p?.estimateCharges?.length&&(this.estimationOperationLength=!0),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}}))}navigate(p){const D=location.search,b=p.url,z=location.pathname;if(b.includes("/repair-stages")){if(["draft","uploaddocuments","uploadphotos","repairestimation","pendingapproval","rejected"].includes(this.status?.toLowerCase()))return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("start_job"));if(this.isNoShow)return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("stages_no_allowed"));if("repair"!==this.repairType?.toLowerCase())return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("stages_repair"))}if(b.includes("/invoices")){if(!this.estimationOperationLength)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("no_charges"));if("rejected"===this.status?.toLowerCase())return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("invoice_access"))}if(z.includes("/document")&&this.stepInProgress){const st=z.includes("/photos")?"images":"documents";this.commonService.showToast(0,`Please wait until all ${st} are uploaded.`)}else{if(z.includes("/photos")){if(this.stepInProgress){const st=z.includes("/photos")?"images":"documents";return void this.commonService.showToast(0,`Please wait until all ${st} are uploaded.`)}if(b.includes("/estimate"))return void this.getInspectionItems(this.inspectionId,p)}if(b.includes("invoices")){let ut=1;if("paid"===this.status?.toLowerCase()||"invoiced"===this.status?.toLowerCase()||"complete"===this.status?.toLowerCase())return"Retail"===this.workProvider&&!this.isCompany&&(ut=2),void this.router.navigate([b.replace("{bookingId}",this.repairGuid||"").replace("invoices","invoicesEdit")],{queryParams:{formType:ut}})}if("/repair/booking/{bookingId}"===b)-1!==D.indexOf("mode=edit")?this.router.navigate([b.replace("{bookingId}",this.repairGuid||"")],{queryParams:{mode:"edit"}}):this.router.navigate([b.replace("{bookingId}",this.repairGuid||"")]);else if("/repair/booking"===z||"/repair/booking/0"===z||z===`/repair/booking/${this.repairGuid}`){if("/repair/booking/{bookingId}"===b)return;"technician"===this.roleName?.toLowerCase()||"complete"===this.status?.toLowerCase()?this.commonService.viewActionTriggeredBooking.next(-1!==D.indexOf("mode=edit")?b+D:b):this.commonService.actionTriggered.next(-1!==D.indexOf("mode=edit")?b+D:b)}else{if((b.includes("/photos")||b.includes("/estimate"))&&!this.inspectionId)return void this.displayMissingInspectionMessage(this.repairGuid);this.tabs?.setActiveMenu(p),-1!==D.indexOf("mode=edit")?this.router.navigate([b.replace("{bookingId}",this.repairGuid||"")],{queryParams:{mode:"edit"}}):this.router.navigate([b.replace("{bookingId}",this.repairGuid||"")])}}}changeTab(p){let D="";const b=location.search;if(!p.disabled){if("Booking"==p.name)D="/repair/booking/"+this.repairGuid,this.repairMenuItems.filter(z=>"Repair"==z.name)[0].active=!1;else{if(!this.currentStatus)return;D="/repair/booking/"+this.repairGuid+"/parts",this.repairMenuItems.filter(z=>"Booking"==z.name)[0].active=!1}p.active=!0,this.repairMenuItems=[...this.repairMenuItems],-1!==b.indexOf("?mode=edit")?this.router.navigate([D.replace("{bookingId}",this.repairGuid||"")],{queryParams:{mode:"edit"}}):this.router.navigate([D.replace("{bookingId}",this.repairGuid||"")]),this.activeItem=p.name}}displayMissingInspectionMessage(p){this.commonService.openAlertDialog("Notification","Please add your vehicle in order to add car images.").afterClosed().subscribe({next:D=>{D&&this.router.navigate([`repair/booking/${p}`])},error:()=>{this.commonService.hideLoading()}})}expand(){this.containerWidth=`${this.userDetail?.nativeElement.offsetWidth}px`,this.expandUserDetail=!this.expandUserDetail}showHideTopHeader(){this.showUserSection=!(!this.repairGuid||"0"==this.repairGuid)}openLabourRate(){this.monitorService.logEvent("openLabourRate",["CustomerLayoutComponent","addenda-repair"]);let p=this.dialog.open(Y.c,{data:{repairId:this.repairGuid,from:S.j.repair},autoFocus:!1});p.afterClosed().subscribe(D=>{p=null,D&&(this.commonService.labourData.next(D),this.commonService.isRefreshRepairEstimateDetails.next(!0))})}ngOnDestroy(){this.monitorService.logEvent("ngOnDestroy",["CustomerLayoutComponent","addenda-repair",{repairId:this.repairGuid}]),this.subscriptions&&this.subscriptions.forEach(p=>p.unsubscribe()),this.commonService.activeItem.next(null),this.commonService.repairDetails.next(null),this.commonService.accessRightRepair.next(!0),this.commonService.isViewOnly=!1}}return u.\u0275fac=function(p){return new(p||u)(o.Y36(j.F0),o.Y36(V.n),o.Y36(j.gz),o.Y36(it.v),o.Y36(o.sBO),o.Y36(t.a),o.Y36(rt.K),o.Y36(r.sK),o.Y36(ot.H),o.Y36(ct.M),o.Y36(pt.uw),o.Y36(O.uU))},u.\u0275cmp=o.Xpm({type:u,selectors:[["app-customer-layout"]],viewQuery:function(p,D){if(1&p&&(o.Gf(P,5),o.Gf(L,5),o.Gf(K,5)),2&p){let b;o.iGM(b=o.CRH())&&(D.tabs=b.first),o.iGM(b=o.CRH())&&(D.tabMain=b.first),o.iGM(b=o.CRH())&&(D.userDetail=b.first)}},decls:16,vars:9,consts:[[1,"page-container","mh-0","mt-0","fx-col"],[1,"tab-container","fx-0"],[1,"main-tab-wrapper"],[3,"mode","menuItems","menuItemClick"],["tabMain",""],[1,"user-wrapper"],[4,"ngIf","ngIfElse"],["expanding",""],[1,"tab-wrapper"],[3,"mode","menuItems","menuItemClick",4,"ngIf"],[1,"tab-content","fx-1"],["class","tab-wrapper",4,"ngIf"],[4,"ngIf"],["serviceType","repair",3,"history","isLoading","toggleExpand",4,"ngIf"],["class","user-detail-container fx-col",3,"ngClass","ngStyle",4,"ngIf"],[1,"user-detail-container","fx-col",3,"ngClass","ngStyle"],[1,"user-detail-wrapper"],["userDetail",""],[1,"user-detail"],[1,"heading-text"],[2,"font-weight","500"],[1,"title"],[1,"vehicle-detail"],[1,"make-status","fx-row"],["class","fx-row align-center",4,"ngIf"],[1,"fx-row","align-center"],[1,"heading-label"],["class","fx-row",4,"ngIf"],[1,"arrow-drop"],[3,"svgIcon","click"],[1,"fx-row"],["style","font-weight: 500;",4,"ngIf"],[1,"user-detail-expand-wrapper",3,"ngClass"],[1,"user-detail-more","fx-col"],[1,"labour-container",3,"click"],[1,"vehicle-detail-expand","fx-col"],["tabs",""],["serviceType","repair",3,"history","isLoading","toggleExpand"]],template:function(p,D){if(1&p&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"chq-tabs",3,4),o.NdJ("menuItemClick",function(z){return D.changeTab(z)}),o.qZA(),o.TgZ(5,"div",5),o.YNc(6,Mt,2,1,"ng-container",6),o.YNc(7,_t,2,1,"ng-template",null,7,o.W1O),o.qZA()(),o.TgZ(9,"div",8),o.YNc(10,Pt,2,2,"chq-tabs",9),o.YNc(11,bt,2,2,"chq-tabs",9),o.qZA()(),o.TgZ(12,"div",10),o.YNc(13,xt,2,0,"div",11),o.YNc(14,Dt,1,0,"no-access-error",12),o.qZA()(),o.YNc(15,Tt,1,2,"history",13)),2&p){const b=o.MAs(8);o.xp6(3),o.Q6J("mode","underline")("menuItems",D.repairMenuItems),o.xp6(3),o.Q6J("ngIf",!D.expandUserDetail)("ngIfElse",b),o.xp6(4),o.Q6J("ngIf","Booking"===D.activeItem),o.xp6(1),o.Q6J("ngIf","Repair"===D.activeItem),o.xp6(2),o.Q6J("ngIf",!D.showNoAccess),o.xp6(1),o.Q6J("ngIf",D.showNoAccess),o.xp6(1),o.Q6J("ngIf","0"!==D.repairGuid)}},dependencies:[O.mk,O.O5,O.PC,j.lC,gt.K,B.Hw,I.U,W.u,r.X$],styles:[".page-container[_ngcontent-%COMP%]{height:calc(100vh - 76px - (58px + 1.6vw))}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray);padding-top:.5vw}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   chq-tabs[_ngcontent-%COMP%]{padding-top:20px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]{position:relative;min-height:82px;margin-right:0}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]{background:var(--xa-bold-gray);border-radius:10px;margin:2px calc(5px + 1.5vw);padding:10px;z-index:1}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container.expand-main-wrapper[_ngcontent-%COMP%]{background:white;position:absolute;top:0;right:0}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;gap:10px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .user-detail[_ngcontent-%COMP%], .page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .vehicle-detail[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .user-detail[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .vehicle-detail[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:12px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .user-detail[_ngcontent-%COMP%]   .fx-row[_ngcontent-%COMP%], .page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .vehicle-detail[_ngcontent-%COMP%]   .fx-row[_ngcontent-%COMP%]{gap:10px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .arrow-drop[_ngcontent-%COMP%]{align-self:center}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]{display:none;overflow:hidden;margin-top:5px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]{gap:10px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]   .labour-container[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-blue);cursor:pointer}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]   .labour-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration-line:underline}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]   .email-phone-container-wrapper[_ngcontent-%COMP%]   .email-container[_ngcontent-%COMP%], .page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]   .email-phone-container-wrapper[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:0 8px;gap:5px;width:198px;height:40px;cursor:pointer;border:.4px solid #1B03A3;border-radius:39px;flex:none;order:0;flex-grow:0;font-size:12px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]   .email-phone-container-wrapper[_ngcontent-%COMP%]   .email-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]   .email-phone-container-wrapper[_ngcontent-%COMP%]   .phone-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:14px;width:14px}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]   .vehicle-detail[_ngcontent-%COMP%]   .vehicle-detail-expand[_ngcontent-%COMP%]{gap:8px;font-size:12px;line-height:20px;color:var(--xa-dark-gray);font-weight:500}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper[_ngcontent-%COMP%]   .user-detail-more[_ngcontent-%COMP%]   .vehicle-detail[_ngcontent-%COMP%]   .vehicle-detail-expand[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{color:var(--xa-black)}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .main-tab-wrapper[_ngcontent-%COMP%]   .user-wrapper[_ngcontent-%COMP%]   .user-detail-container[_ngcontent-%COMP%]   .user-detail-expand-wrapper.expand[_ngcontent-%COMP%]{display:block}.page-container[_ngcontent-%COMP%]   .tab-container[_ngcontent-%COMP%]   .tab-wrapper[_ngcontent-%COMP%]{margin-left:calc(6px + 1.5vw);display:flex;flex-direction:row;justify-content:space-between}.page-container[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{background:var(--xa-tab-background);overflow:auto}.heading-text[_ngcontent-%COMP%]{font-size:16px!important;font-weight:700;line-height:20px;max-width:20ch;word-break:break-all}.heading-label[_ngcontent-%COMP%]{font-weight:400;color:var(--xa-dark-gray);font-size:16px!important}chq-tabs[_ngcontent-%COMP%]     button{font-size:16px;line-height:20px;font-weight:500}@media screen and (min-device-width: 700px) and (max-device-width: 940px){.main-tab-wrapper[_ngcontent-%COMP%]{margin-bottom:6px}.user-detail-container[_ngcontent-%COMP%]{padding:12px!important}.user-detail-container[_ngcontent-%COMP%]   .user-detail-wrapper[_ngcontent-%COMP%]   .vehicle-detail[_ngcontent-%COMP%]{gap:5px}}"]}),u})();var wt=s(92498),M=s(94526),E=s(68358),l=s(16517);const C=[{path:"",pathMatch:"full",redirectTo:"booking-journal"},{path:"booking",canActivate:[c.a],loadChildren:()=>Promise.all([s.e(299),s.e(592),s.e(284)]).then(s.bind(s,85284)).then(u=>u.AddRepairCustomersModule)},{path:"booking/:id",component:kt,canActivate:[c.a],loadChildren:()=>Promise.all([s.e(299),s.e(592),s.e(284)]).then(s.bind(s,85284)).then(u=>u.AddRepairCustomersModule)},{path:"customers",canActivate:[c.a],loadChildren:()=>s.e(551).then(s.bind(s,57551)).then(u=>u.CustomerTableModule)},{path:"booking-journal",component:wt.o,canActivate:[c.a],loadChildren:()=>Promise.all([s.e(592),s.e(119)]).then(s.bind(s,82119)).then(u=>u.BookingJournalModule)},{path:"workflow",component:l.v,canActivate:[c.a],loadChildren:()=>Promise.all([s.e(592),s.e(885)]).then(s.bind(s,95885)).then(u=>u.WorkflowModule)},{path:"outbound",component:E.e,canActivate:[c.a],loadChildren:()=>Promise.all([s.e(592),s.e(688)]).then(s.bind(s,73688)).then(u=>u.OutboundModule)},{path:"lounge",component:M.i,canActivate:[tt.RQ],loadChildren:()=>Promise.all([s.e(592),s.e(71)]).then(s.bind(s,36071)).then(u=>u.LoungeListModule)}];let v=(()=>{class u{}return u.\u0275fac=function(p){return new(p||u)},u.\u0275mod=o.oAB({type:u}),u.\u0275inj=o.cJS({imports:[O.ez,a.m,B.Ps,j.Bz.forChild(C),Z.H,r.aw,J.Z]}),u})()},16517:(ht,at,s)=>{"use strict";s.d(at,{v:()=>Mt});var O=s(15861),B=s(71764),j=s(4128),tt=s(54004),r=s(39646),c=s(17771),J=s(92340),a=s(94650),Z=s(80529);let e=(()=>{class N{constructor(f){this.http=f}getWorkflowDetails(){return this.http.get(`${J.N.caseMgmtUrl}/odata/waterfall`)}getWorkflowDetailsWithQuery(f){return this.http.get(`${J.N.caseMgmtUrl}/odata/waterfall${f}`)}getCustomer(f){return this.http.get(`${J.N.caseMgmtUrl}/api/waterfallcustomer?$filter=OrgId eq ${f}`)}}return N.\u0275fac=function(f){return new(f||N)(a.LFG(Z.eN))},N.\u0275prov=a.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})();var Y=s(81390),S=s(81364),H=s(38709),o=s(89383),V=s(24006),it=s(36895),t=s(14315),rt=s(36978),ot=s(48262),ct=s(73546),pt=s(97392),gt=s(23267),I=s(10266),W=s(22406),P=s(93077);const L=["filter"];function K(N,F){if(1&N){const f=a.EpF();a.TgZ(0,"chq-button",30),a.NdJ("click",function(){a.CHM(f);const A=a.oxw();return a.KtG(A.openFilter())}),a.qZA()}if(2&N){const f=a.oxw();a.Q6J("buttonModel",f.filterButton)}}const $=function(N,F,f,m,A){return[N,F,f,m,A]};function y(N,F){if(1&N&&(a.TgZ(0,"th",39)(1,"div",40)(2,"div",41)(3,"button",42),a._uU(4),a.qZA()(),a.TgZ(5,"div")(6,"p"),a._uU(7),a.ALo(8,"xaCurrency"),a.qZA()(),a.TgZ(9,"span",43),a._uU(10),a.qZA()()()),2&N){const f=F.$implicit,m=a.oxw(2);a.xp6(1),a.Udp("background-color",f.Color),a.xp6(3),a.Oqu(f.WaterfallRepairs.length),a.xp6(3),a.Oqu(a.G7q(8,5,a.qbA(11,$,f.ManualCost,m.i18n.currencySymbol,m.i18n.digitsInfo,m.i18n.locale,m.i18n.position))),a.xp6(3),a.Oqu(f.JobName)}}function X(N,F){if(1&N&&(a.TgZ(0,"button",51),a.ALo(1,"translate"),a.ALo(2,"lowercase"),a._UZ(3,"mat-icon",58),a.qZA()),2&N){const f=a.oxw().$implicit,m=a.oxw(3);a.s9C("matTooltip",a.lcZ(1,3,a.lcZ(2,5,f.LastestTaskUpdatedRepairType?f.LastestTaskUpdatedRepairType:"Others"))),a.xp6(3),a.Q6J("svgIcon",m.jobIconDictionary[f.LastestTaskUpdatedRepairType]?m.jobIconDictionary[f.LastestTaskUpdatedRepairType]:"gears"),a.uIk("color","black")}}function _(N,F){if(1&N){const f=a.EpF();a.TgZ(0,"mat-card",45)(1,"a",46),a.NdJ("click",function(){const Q=a.CHM(f).$implicit,et=a.oxw(3);return a.KtG(et.bookingStatusUrl(Q))}),a.TgZ(2,"div",47)(3,"img",48),a.NdJ("load",function(){const Q=a.CHM(f).$implicit;return a.KtG(Q.isloaded=!0)}),a.qZA(),a._UZ(4,"chq-customloader",49),a.qZA(),a.TgZ(5,"div",50)(6,"button",51),a.ALo(7,"translate"),a._UZ(8,"mat-icon",52),a.qZA(),a.TgZ(9,"button",51),a.ALo(10,"translate"),a._UZ(11,"mat-icon",53),a.qZA(),a.TgZ(12,"button",51),a._UZ(13,"mat-icon",52),a.qZA(),a.TgZ(14,"button",51),a.ALo(15,"translate"),a._UZ(16,"mat-icon",54),a.qZA(),a.YNc(17,X,4,7,"button",55),a.TgZ(18,"button",51),a.ALo(19,"translate"),a._UZ(20,"mat-icon",56),a.qZA()(),a.TgZ(21,"span",57),a._uU(22),a.ALo(23,"translate"),a.TgZ(24,"b"),a._uU(25),a.ALo(26,"translate"),a.ALo(27,"date"),a.qZA()()()()}if(2&N){const f=F.$implicit,m=a.oxw(3);a.xp6(3),a.Q6J("src",null!==f.ImageUrl&&""!==f.ImageUrl?f.ImageUrl:"assets/img/front-left.png",a.LSH),a.xp6(1),a.Q6J("showLoading",!f.isloaded),a.xp6(2),a.s9C("matTooltip",a.lcZ(7,17,0===f.Assignees.length?"No Assignee":f.Assignees.length>1?"Multi Assignees":"Single Assignee")),a.xp6(2),a.Q6J("svgIcon",f.Assignees.length>1?"multi-users":"single-user"),a.uIk("color",0===f.Assignees.length?"dark-gray-disabled":"black"),a.xp6(1),a.s9C("matTooltip",a.lcZ(10,19,"Transparent"===f.JobStatusColor?"job_not_started":"Green"===f.JobStatusColor?"job_start_today":"job_start_in_past")),a.xp6(2),a.uIk("color","Transparent"===f.JobStatusColor?"dark-gray-disabled":"Green"===f.JobStatusColor?"green-medium":"dark-red2"),a.xp6(1),a.Q6J("matTooltip",m.PartTypetoolTip(f.PartGeneralStatus)),a.xp6(1),a.Q6J("svgIcon",m.PartTypeIcon(f.PartGeneralStatus)),a.xp6(1),a.s9C("matTooltip",a.lcZ(15,21,f.IsAttentionRequired?"attention_required":"attention_not_required")),a.xp6(2),a.uIk("color",null===f.IsAttentionRequired?"dark-gray-disabled":f.IsAttentionRequired?"dark-red2":"dark-gray-disabled"),a.xp6(1),a.Q6J("ngIf",f.LastestTaskUpdatedRepairType&&""!==f.LastestTaskUpdatedRepairType),a.xp6(1),a.s9C("matTooltip",a.lcZ(19,23,f.IsTowedIn?"towed_in":"not_towed_in")),a.xp6(2),a.Q6J("svgIcon","towing"),a.uIk("color",f.IsTowedIn?"black":"dark-gray-disabled"),a.xp6(2),a.hij("",a.lcZ(23,25,"due_out"),": "),a.xp6(3),a.Oqu(a.lcZ(26,27,a.xi3(27,29,f.BookingOutDate,"dd/MM/yy HH:mm")))}}function U(N,F){if(1&N&&(a.TgZ(0,"td",39),a.YNc(1,_,28,32,"mat-card",44),a.qZA()),2&N){const f=F.$implicit;a.xp6(1),a.Q6J("ngForOf",f.WaterfallRepairs)}}function R(N,F){if(1&N&&(a.TgZ(0,"div",35)(1,"table",36)(2,"thead",37)(3,"tr"),a.YNc(4,y,11,17,"th",38),a.qZA()(),a.TgZ(5,"tbody")(6,"tr"),a.YNc(7,U,2,1,"td",38),a.qZA()()()()),2&N){const f=a.oxw();a.xp6(4),a.Q6J("ngForOf",f.workflowData),a.xp6(3),a.Q6J("ngForOf",f.workflowData)}}function G(N,F){1&N&&(a.TgZ(0,"div",59)(1,"div",60),a._UZ(2,"img",61),a.TgZ(3,"span"),a._uU(4),a.ALo(5,"translate"),a.qZA(),a.TgZ(6,"span"),a._uU(7),a.ALo(8,"translate"),a.qZA()()()),2&N&&(a.xp6(4),a.Oqu(a.lcZ(5,2,"no_result_found")),a.xp6(3),a.hij("",a.lcZ(8,4,"could_not_find_any_data"),"."))}let Mt=(()=>{class N{constructor(f,m,A,Q,et,_t){this.workflowService=f,this.router=m,this.commonService=A,this.caseService=Q,this.translateService=et,this.formBuilder=_t,this.totalCost=0,this.totalCount=0,this.workflowData=[],this.CallingAPI=!1,this.IntervalGetWorkflow=null,this.LastRefreshedDate=B().format("DD/MM/YYYY HH:mm:ss"),this.userDetail=null,this.userIsBM=!1,this.filterButton={label:"filter",type:"outline",icon:"filter"},this.filterForm=this.formBuilder.group({OrgName:[],CustomerId:[]}),this.applyButton={label:"apply",type:"primary"},this.resetButton={label:"reset_all",type:"outline"},this.filterModal=[{placeHolder:"select_organization",label:"organization",name:"OrgName",value:"",type:"select",displayValue:"label",fieldValue:"value",options:[],isMultiSelect:!1},{placeHolder:"select_type",label:"customer_name",name:"CustomerId",value:"",type:"select",displayValue:"label",fieldValue:"value",options:[],isMultiSelect:!0}],this.filterDataLoaded=!1,this.repairSizeColors={sm:"bg-light-blue",s:"bg-light-blue",l:"bg-light-green text-white",m:"bg-light-pink text-white",xl:"bg-dark-red text-white"},this.settingsButtonModel={label:"filter",type:"outline",icon:"filter",width:"13px",height:"13px"},this.jobIconDictionary={Body:"car",Paint:"paint-nozzle",Mechanical:"mechanical",Electrical:"electric",Tires:"tire",Preparation:"car-roof","Check In":"checkbox-open","Panel Repair":"door-panel","Panel Fitup":"door-panel",Polish:"car-paint",Detailing:"car-cleaning",Maintenance:"maintenance",Diagnosis:"diagnosis",Others:"gears"},this.subs=[],this.i18n=this.commonService.geti18nInfo()}ngOnInit(){this.commonService.userProfileData.subscribe(f=>{this.userDetail=f?.data,this.userIsBM=this.userDetail?.roleDetail.some(m=>"Bodyshop Manager"==m.name),this.userDetail?.organizationDetail?.id&&this.filterForm.get("OrgName").setValue(this.userDetail.organizationDetail.id)})}ngAfterViewInit(){this.getWorkflowDetails(this.generateFilterQuery()),this.IntervalGetWorkflow=setInterval(()=>{this.getWorkflowDetails(this.generateFilterQuery())},3e5)}getWorkflowDetails(f){var m=this;return(0,O.Z)(function*(){m.commonService.showLoading(),m.CallingAPI=!0,m.subs.push("?$filter="!==f?m.workflowService.getWorkflowDetailsWithQuery(f).subscribe({next:A=>{m.workflowData=m.getTotals(A.value),m.workflowData&&m.workflowData.map(Q=>Q?.WaterfallRepairs.map(et=>et.isLoaded=!1)),m.CallingAPI=!1,m.LastRefreshedDate=B().format("DD/MM/YYYY HH:mm:ss"),m.commonService.hideLoading()},error:()=>{m.CallingAPI=!1}}):m.workflowService.getWorkflowDetails().subscribe({next:A=>{m.workflowData=m.getTotals(A.value),m.workflowData&&m.workflowData.map(Q=>Q?.WaterfallRepairs.map(et=>et.isLoaded=!1)),m.CallingAPI=!1,m.LastRefreshedDate=B().format("DD/MM/YYYY HH:mm:ss"),m.commonService.hideLoading()},error:()=>{m.CallingAPI=!1}}))})()}getTotals(f){return this.totalCost=0,this.totalCount=0,f.forEach(m=>{this.totalCount+=m.WaterfallRepairs.length,m.ManualCost=0,m.WaterfallRepairs.forEach(A=>{this.totalCost+=A.EstimateCost,m.ManualCost+=A.EstimateCost})}),f}current_date_format(){return B().format("D dddd, of MMMM YYYY")}openFilter(){this.filterDataLoaded?this.filter.open():(this.commonService.showLoading(),(0,j.D)([this.getOrgIfBM(),this.workflowService.getCustomer(this.userDetail.organizationDetail.id)]).pipe((0,tt.U)(([f,m])=>({orgList:f,CustomerList:m}))).subscribe(f=>{this.filterModal[0]=this.userIsBM?{...this.filterModal[0],selectedOption:{label:this.userDetail?.organizationDetail.name,value:this.userDetail?.organizationDetail.id},options:f.orgList.data.map(m=>({label:m.name,value:m.id}))}:{...this.filterModal[0],selectedOption:{label:this.userDetail?.organizationDetail.name,value:this.userDetail?.organizationDetail.id},options:[{label:this.userDetail?.organizationDetail.name,value:this.userDetail?.organizationDetail.id}],disabled:!0},this.filterModal[1]={...this.filterModal[1],options:f.CustomerList.filter((m,A,Q)=>Q.findIndex(et=>et.contactId===m.contactId)===A).map(m=>{const A=m.firstName+" "+m.lastName;return{label:m.isIndividual?A:m.companyName,subLabel:m.isIndividual?m.email:m.licenseNumber,value:m.id,html:`<div class='workflow-customer-item'><span class='name'>${m.isIndividual?A:m.companyName}</span><span class='email'>${m.isIndividual?m.email:m.licenseNumber}</span></div>`}})},this.filter.open(),this.commonService.hideLoading(),this.filterDataLoaded=!0}))}getOrgIfBM(){return this.userIsBM?this.caseService.getOrganizations():(0,r.of)(null)}getCustomer(f){this.commonService.showLoading(),this.workflowService.getCustomer(f).subscribe({next:m=>{this.filterModal[1]={...this.filterModal[1],options:m.filter((A,Q,et)=>et.findIndex(_t=>_t.contactId===A.contactId)===Q).map(A=>{const Q=A.firstName+" "+A.lastName;return{label:A.isIndividual?Q:A.companyName,subLabel:A.isIndividual?A.email:A.licenseNumber,value:A.id,html:`<div class='workflow-customer-item'><span class='name'>${A.isIndividual?Q:A.companyName}</span><span class='email'>${A.isIndividual?A.email:A.licenseNumber}</span></div>`}})},console.log(this.filterModal[1]),this.commonService.hideLoading()},error:()=>{this.commonService.showLoading()}})}generateFilterQuery(){const f=this.filterForm.value;let m="?$filter=";return f.OrgName&&f.OrgName>0&&(m+=`OrgId eq ${f.OrgName}`),f.CustomerId&&f.CustomerId.length>0&&("?$filter="!==m?m+="&":m="?",m+="$expand=WaterfallRepairs($filter=",m+=`(${f.CustomerId.map(A=>"CustomerId eq "+A).join(" or ")}))`),m}onFormUpdate(f){"CustomerId"===f.name?(this.filterModal[1]={...this.filterModal[1],selectedOption:f.value},this.filterForm.get(f.name).setValue(f.value.map(m=>m.value))):"OrgName"===f.name&&(this.filterModal[0]={...this.filterModal[0],selectedOption:f.value},f.value?(this.filterForm.get(f.name).setValue(f.value.value),this.getCustomer(f.value.value)):this.filterModal[1]={...this.filterModal[1],value:"",selectedOption:"",options:[]})}applyFilter(){this.workflowData=[],this.getWorkflowDetails(this.generateFilterQuery()),this.filter.close()}resetFilter(){this.filterForm.reset();for(let f=0;f<this.filterModal.length;f++)this.filterModal[f]={...this.filterModal[f],value:"",selectedOption:"",options:this.filterModal[f].options?.map(m=>(m.checked=!1,m))};this.userDetail?.organizationDetail?.id&&(this.filterForm.get("OrgName").setValue(this.userDetail.organizationDetail.id),this.filterModal[0]={...this.filterModal[0],selectedOption:{label:this.userDetail?.organizationDetail.name,value:this.userDetail?.organizationDetail.id}},this.getCustomer(this.userDetail?.organizationDetail.id))}PartTypeIcon(f){switch(f){case"NotOrdered":default:return"parts-not-ordered";case"Ordered":return"parts-ordered";case"Arrived":return"parts-arrived";case"OrderedPartially":return"parts-ordered-partial";case"ArrivedPartially":return"parts-arrived-partial"}}PartTypetoolTip(f){let m="";switch(f){case"NotOrdered":default:m="parts_not_ordered";break;case"Ordered":m="part_ordered";break;case"Arrived":m="part_arrived";break;case"OrderedPartially":m="part_ordered_partial";break;case"ArrivedPartially":m="part_arrived_partial"}return this.translateService.instant(m)}bookingStatusUrl(f){const{Status:m,RepairGuid:A}=f;let Q=c.A[m?.toLowerCase()]||c.A.others;Q=Q.replace("{{repairGUID}}",A),this.router.navigate([Q])}ngOnDestroy(){this.subs.forEach(f=>f.unsubscribe()),clearInterval(this.IntervalGetWorkflow)}}return N.\u0275fac=function(f){return new(f||N)(a.Y36(e),a.Y36(Y.F0),a.Y36(S.v),a.Y36(H.n),a.Y36(o.sK),a.Y36(V.qu))},N.\u0275cmp=a.Xpm({type:N,selectors:[["app-workflow"]],viewQuery:function(f,m){if(1&f&&a.Gf(L,5),2&f){let A;a.iGM(A=a.CRH())&&(m.filter=A.first)}},features:[a._Bn([e])],decls:54,vars:34,consts:[[1,"page-container","workflow-container","mh-0","mt-0","fx-col"],[1,"fx-0"],[1,"fx-row","date-filter-container"],[1,"text-muted",2,"display","block"],[1,"current-data"],[1,"",3,"innerHTML"],[1,"updated-date"],[1,"flex","align-center",2,"gap","25px","margin-left","auto"],[1,"flex","align-center"],["color","dark-gray",2,"margin-right","8px"],["svgIcon","double-database",2,"margin-right","8px"],[3,"buttonModel","click",4,"chqPermission"],["class","fx-1","style","overflow: auto;",4,"ngIf"],["class","no-data-wrapper",4,"ngIf"],[3,"hasBackdrop"],[1,"filter-sidenav",3,"mode","position"],["filter",""],[1,"filter-container"],[1,"header"],[1,"title"],[1,"action"],[3,"click"],["color","white",3,"svgIcon"],[1,"form-container",3,"formGroup"],[1,"row"],[1,"col-12"],[3,"inputModel","controlOutput"],[1,"customer-list-w",3,"inputModel","controlOutput"],[1,"footer"],[1,"col-6"],[3,"buttonModel","click"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png","alt",""],[1,"fx-1",2,"overflow","auto"],[1,"workflow-table"],[1,"workflow-table-thead"],["class","right-border",4,"ngFor","ngForOf"],[1,"right-border"],[1,"workflow-header-card"],[1,""],[1,"bg-white","rounded-icon"],[1,"uppercase"],["class","workflow-details-card",4,"ngFor","ngForOf"],[1,"workflow-details-card"],[1,"detail-card-link",3,"click"],[1,"img-container"],["alt","",3,"src","load"],[3,"showLoading"],[1,"workflow-repair-items","flex",2,"padding","5px 0px","gap","5px"],["matTooltipPosition","above",1,"repair-items",2,"padding","1px 6px",3,"matTooltip"],[1,"svg-17px",3,"svgIcon"],["svgIcon","clock2"],["svgIcon","flag-circle",1,"svg-17px"],["class","repair-items","style","padding:1px 6px;","matTooltipPosition","above",3,"matTooltip",4,"ngIf"],[3,"svgIcon"],[1,"due-date-span",2,"margin-top","6px"],[1,"repairType-custom-class",3,"svgIcon"],[1,"no-data-wrapper"],[1,"no-data-content"],["src","assets/img/no-data.png","alt",""]],template:function(f,m){if(1&f){const A=a.EpF();a.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3)(4,"div",4),a._uU(5),a.ALo(6,"translate"),a._UZ(7,"span",5),a.qZA(),a.TgZ(8,"div",6),a._uU(9),a.ALo(10,"translate"),a.qZA()(),a.TgZ(11,"span",7)(12,"span",8)(13,"mat-icon",9),a._uU(14,"directions_car"),a.qZA(),a.TgZ(15,"label")(16,"b"),a._uU(17),a.qZA()()(),a.TgZ(18,"span",8),a._UZ(19,"mat-icon",10),a.TgZ(20,"label")(21,"b"),a._uU(22),a.ALo(23,"xaCurrency"),a.qZA()()(),a.YNc(24,K,1,1,"chq-button",11),a.qZA()()(),a.YNc(25,R,8,2,"div",12),a.YNc(26,G,9,6,"div",13),a.qZA(),a.TgZ(27,"mat-sidenav-container",14)(28,"mat-sidenav",15,16)(30,"div",17)(31,"div",18)(32,"div",19),a._uU(33," Filters "),a.qZA(),a.TgZ(34,"div",20)(35,"button",21),a.NdJ("click",function(){a.CHM(A);const et=a.MAs(29);return a.KtG(et.toggle())}),a._UZ(36,"mat-icon",22),a.qZA()()(),a.TgZ(37,"form",23)(38,"div",24)(39,"div",25)(40,"chq-input",26),a.NdJ("controlOutput",function(et){return m.onFormUpdate(et)}),a.qZA()()(),a.TgZ(41,"div",24)(42,"div",25)(43,"chq-input",27),a.NdJ("controlOutput",function(et){return m.onFormUpdate(et)}),a.qZA()()()(),a.TgZ(44,"div",28)(45,"div",24)(46,"div",29)(47,"chq-button",30),a.NdJ("click",function(){return m.applyFilter()}),a.qZA()(),a.TgZ(48,"div",29)(49,"chq-button",30),a.NdJ("click",function(){return m.resetFilter()}),a.qZA()()()()()()(),a.TgZ(50,"div",31)(51,"div",32)(52,"div",33),a._UZ(53,"img",34),a.qZA()()()}2&f&&(a.xp6(5),a.hij(" ",a.lcZ(6,18,"current_date"),": "),a.xp6(2),a.Q6J("innerHTML",m.current_date_format(),a.oJD),a.xp6(2),a.AsE("",a.lcZ(10,20,"last_refreshed"),": ",m.LastRefreshedDate,""),a.xp6(8),a.Oqu(m.totalCount),a.xp6(5),a.Oqu(a.G7q(23,22,a.qbA(28,$,m.totalCost,m.i18n.currencySymbol,m.i18n.digitsInfo,m.i18n.locale,m.i18n.position))),a.xp6(2),a.Q6J("chqPermission","workflow"),a.xp6(1),a.Q6J("ngIf",m.totalCost>0&&m.totalCount>0),a.xp6(1),a.Q6J("ngIf",(0===m.workflowData.length||0===m.totalCost&&0===m.totalCount)&&!m.CallingAPI),a.xp6(1),a.Q6J("hasBackdrop",!0),a.xp6(1),a.Q6J("mode","over")("position","end"),a.xp6(8),a.Q6J("svgIcon","cross"),a.xp6(1),a.Q6J("formGroup",m.filterForm),a.xp6(3),a.Q6J("inputModel",m.filterModal[0]),a.xp6(3),a.Q6J("inputModel",m.filterModal[1]),a.xp6(4),a.Q6J("buttonModel",m.applyButton),a.xp6(2),a.Q6J("buttonModel",m.resetButton))},dependencies:[it.sg,it.O5,t.D,rt.E,ot.h,ct.a8,pt.Hw,V._Y,V.JL,V.sg,gt.JX,gt.TM,I.gM,W.A,it.i8,it.uU,P.j,o.X$],styles:[".mat-drawer-container[_ngcontent-%COMP%]{background-color:transparent;z-index:501!important}.mat-drawer-container[_ngcontent-%COMP%]     .mat-drawer-backdrop{position:fixed}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]{position:fixed;width:300px}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav.filter-sidenav[_ngcontent-%COMP%]{background-color:#f1f2f6;width:400px}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .mat-drawer-inner-container[_ngcontent-%COMP%]{overflow-x:hidden}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]{padding:calc(15px + .8vw);padding-bottom:calc(55px + .8vw)}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;font-size:20px;line-height:25px}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;padding:10px;background:var(--xa-black);border-radius:50%;height:36px}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{height:16px;width:16px}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{margin-bottom:10px}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .checkbox-wrapper[_ngcontent-%COMP%]{flex-wrap:wrap}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .checkbox-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{min-width:74px;width:74px;max-width:95%}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .checkbox-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .span-label[_ngcontent-%COMP%]{font-size:12px;height:14px;line-height:14px;color:var(--xa-black-medium);text-transform:none;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]   .checkbox-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%;height:auto}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{margin:20px 0}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   hr.no-line[_ngcontent-%COMP%]{border:none}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   mat-slider[_ngcontent-%COMP%]{width:100%}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .two-per-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{min-width:133px!important;width:auto!important}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:fixed;bottom:0;right:0;width:400px;background-color:#f1f2f6;z-index:500;height:68px;align-items:center;display:flex;justify-content:space-around}.mat-drawer-container[_ngcontent-%COMP%]   .mat-sidenav[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{width:92%}.mat-drawer-container[_ngcontent-%COMP%]   .customer-list-w[_ngcontent-%COMP%]     .checkbox-wrapper label{display:flex;align-items:center}.mat-drawer-container[_ngcontent-%COMP%]     .workflow-customer-item .email{display:block;font-style:italic;opacity:.7}.workflow-table[_ngcontent-%COMP%]{width:100%;margin-top:-25px;background-color:var(--xa-popup-light-gray);display:contents}.workflow-table[_ngcontent-%COMP%]   .workflow-table-thead[_ngcontent-%COMP%]{position:sticky;top:0;z-index:9;background-color:var(--xa-popup-light-gray)}.workflow-table[_ngcontent-%COMP%]   .right-border[_ngcontent-%COMP%]{background-image:linear-gradient(rgba(26,34,51,.2) 40%,rgba(255,255,255,0) 0%);background-position:top right;background-size:2px 35px;width:195px;background-repeat:repeat-y}.workflow-table[_ngcontent-%COMP%]   .right-border[_ngcontent-%COMP%]:last-child{background-size:0px;padding-right:0}.workflow-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{min-height:330px}.workflow-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.workflow-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .workflow-header-card[_ngcontent-%COMP%]{width:116px;height:100px;border-radius:10px;font-size:12px;font-weight:400;padding:13px 14px;margin:0 auto 16px;color:#fff;display:flex;flex-direction:column;justify-content:space-between}.workflow-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .workflow-header-card[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#000}.workflow-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .workflow-header-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;margin:0}.workflow-table[_ngcontent-%COMP%]   th.Green[_ngcontent-%COMP%], .workflow-table[_ngcontent-%COMP%]   th.Red[_ngcontent-%COMP%]{background-color:var(--xa-green-medium)}.workflow-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}.workflow-details-card[_ngcontent-%COMP%]{width:160px;border-radius:10px;padding:4px;display:flex;flex-direction:column;font-size:10px;margin:auto auto 20px}.workflow-details-card[_ngcontent-%COMP%]   .detail-card-link[_ngcontent-%COMP%]{text-decoration:none;cursor:auto;color:#000;text-align:center}.workflow-details-card[_ngcontent-%COMP%]   .img-container[_ngcontent-%COMP%]{position:relative}.workflow-details-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:8px;max-height:77px;min-height:77px;object-fit:contain}.workflow-details-card[_ngcontent-%COMP%]   .workflow-repair-items[_ngcontent-%COMP%]{flex-wrap:wrap}.workflow-details-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:26px;height:26px;font-size:12px;line-height:4px}.workflow-details-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{height:20px;width:20px}.workflow-details-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .repairType-custom-class[_ngcontent-%COMP%]{height:16px;width:18px}.workflow-details-card[_ngcontent-%COMP%]   .due-date-span[_ngcontent-%COMP%]{color:var(--xa-dark-gray);float:left;padding-left:3px}.rounded-icon[_ngcontent-%COMP%]{border-radius:50%;font-size:12px;width:30px;height:30px;line-height:2px;font-weight:700;margin-right:10px;position:relative;left:40%}.workflow-container[_ngcontent-%COMP%]{height:calc(100vh - 76px - (58px + 1.6vw))}.workflow-container[_ngcontent-%COMP%]   .fx-0[_ngcontent-%COMP%]   .date-filter-container[_ngcontent-%COMP%]{margin-left:auto;padding:15px 30px}.workflow-container[_ngcontent-%COMP%]   .no-data-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:10%}.workflow-container[_ngcontent-%COMP%]   .no-data-wrapper[_ngcontent-%COMP%]   .no-data-content[_ngcontent-%COMP%]{display:inline-grid;justify-items:center;color:var(--xa-dark-gray);gap:8px}.svg-17px[_ngcontent-%COMP%]{width:17px}.main-content[_ngcontent-%COMP%]   .addenda-container[_ngcontent-%COMP%]{padding-bottom:0!important}span.text-muted[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.current-data[_ngcontent-%COMP%]{font-size:17px}.updated-date[_ngcontent-%COMP%]{font-size:12px;margin-top:15px}"]}),N})()},33938:(ht,at,s)=>{"use strict";s.d(at,{Q:()=>tt});var O=s(92340),B=s(94650),j=s(80529);let tt=(()=>{class r{constructor(J){this.http=J}getDeparturesDetails(J){return this.http.get(`${O.N.caseMgmtUrl}/odata/departures?${J}`)}setPickupDate(J,a,Z){return this.http.put(`${O.N.caseMgmtUrl}/api/departures/${J}/pickupdate`,{pickUpDate:a,isPickedUp:Z})}getTaskDetails(J,a){return this.http.get(`${O.N.caseMgmtUrl}/api/departures/tasks/${J}/${a}`)}setRepairStatusComplete(J){return this.http.put(`${O.N.caseMgmtUrl}/api/repair/${J}/status`,{status:"Complete",reason:"repair complete"})}}return r.\u0275fac=function(J){return new(J||r)(B.LFG(j.eN))},r.\u0275prov=B.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},35493:(ht,at,s)=>{"use strict";s.d(at,{K:()=>r});var O=s(92340),B=s(94650),j=s(80529),tt=s(25001);let r=(()=>{class c{constructor(a,Z){this.http=a,this.fileService=Z}sendApprovalMessage(a,Z){return this.http.post(`${O.N.caseMgmtUrl}/api/message/${Z}/estimate-approval`,a)}getMessageTemplate(a,Z,e){return this.http.get(`${O.N.xaAggregationApi}/repaircommunicationtemplate/${a}/${Z}/${e}`)}setMessage(a,Z){return this.http.post(`${O.N.caseMgmtUrl}/api/message/${Z}/send-message`,a)}sendFreeCommunicationMessage(a,Z,e){const Y=`${O.N.messageApi}/Message/email`,S=new FormData;return S.append("ToEmail",a.email?.join(",")),a.cc&&S.append("CCEmail",a.cc),S.append("Content",a.message),S.append("Subject",a.subject),S.append("ObjectId",a.objectId),a.files&&a.files.length>0&&a.files.forEach(H=>{S.append("files",H)}),this.fileService.uploadFile(Y,S,Z,e)}}return c.\u0275fac=function(a){return new(a||c)(B.LFG(j.eN),B.LFG(tt.I))},c.\u0275prov=B.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},21937:(ht,at,s)=>{"use strict";s.d(at,{c:()=>tt});var O=s(92340),B=s(94650),j=s(80529);let tt=(()=>{class r{constructor(J){this.http=J}getNotifyTemplate(J,a,Z){return this.http.get(`${O.N.xaAggregationApi}/repaircommunicationtemplate/${J}/${a}/${Z}`)}sendNotify(J,a){return this.http.post(`${O.N.caseMgmtUrl}/api/message/${J}/send-message`,a)}}return r.\u0275fac=function(J){return new(J||r)(B.LFG(j.eN))},r.\u0275prov=B.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},31545:function(ht){ht.exports=function(){"use strict";var at={year:0,month:1,day:2,hour:3,minute:4,second:5},s={};return function(O,B,j){var tt,r=function(Z,e,Y){void 0===Y&&(Y={});var S=new Date(Z);return function(o,V){void 0===V&&(V={});var it=V.timeZoneName||"short",t=o+"|"+it,rt=s[t];return rt||(rt=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:o,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:it}),s[t]=rt),rt}(e,Y).formatToParts(S)},c=function(Z,e){for(var Y=r(Z,e),S=[],H=0;H<Y.length;H+=1){var o=Y[H],t=at[o.type];t>=0&&(S[t]=parseInt(o.value,10))}var rt=S[3],pt=+Z;return(j.utc(S[0]+"-"+S[1]+"-"+S[2]+" "+(24===rt?0:rt)+":"+S[4]+":"+S[5]+":000").valueOf()-(pt-=pt%1e3))/6e4},J=B.prototype;J.tz=function(Z,e){void 0===Z&&(Z=tt);var Y=this.utcOffset(),S=this.toDate(),H=S.toLocaleString("en-US",{timeZone:Z}),o=Math.round((S-new Date(H))/1e3/60),V=j(H).$set("millisecond",this.$ms).utcOffset(15*-Math.round(S.getTimezoneOffset()/15)-o,!0);if(e){var it=V.utcOffset();V=V.add(Y-it,"minute")}return V.$x.$timezone=Z,V},J.offsetName=function(Z){var e=this.$x.$timezone||j.tz.guess(),Y=r(this.valueOf(),e,{timeZoneName:Z}).find(function(S){return"timezonename"===S.type.toLowerCase()});return Y&&Y.value};var a=J.startOf;J.startOf=function(Z,e){if(!this.$x||!this.$x.$timezone)return a.call(this,Z,e);var Y=j(this.format("YYYY-MM-DD HH:mm:ss:SSS"));return a.call(Y,Z,e).tz(this.$x.$timezone,!0)},j.tz=function(Z,e,Y){var S=Y&&e,H=Y||e||tt,o=c(+j(),H);if("string"!=typeof Z)return j(Z).tz(H);var V=function(ot,ct,pt){var gt=ot-60*ct*1e3,I=c(gt,pt);if(ct===I)return[gt,ct];var W=c(gt-=60*(I-ct)*1e3,pt);return I===W?[gt,I]:[ot-60*Math.min(I,W)*1e3,Math.max(I,W)]}(j.utc(Z,S).valueOf(),o,H),t=V[1],rt=j(V[0]).utcOffset(t);return rt.$x.$timezone=H,rt},j.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},j.tz.setDefault=function(Z){tt=Z}}}()}}]);