(self.webpackChunkcar_heal_quote=self.webpackChunkcar_heal_quote||[]).push([[284],{85284:(zt,Qt,k)=>{"use strict";k.r(Qt),k.d(Qt,{AddRepairCustomersModule:()=>Qc});var e=k(94650),f=k(36895),Rt=k(67376),he=k(83353),j=k(21281),Ne=k(12687),ne=k(77579),_t=k(50727),Pn=k(34986),cn=k(82805),On=k(66406),Xe=k(69751),W=k(56451),J=k(82722),oe=k(68675),te=k(54004),at=k(95698),H=k(18505),ge=k(63900),ke=k(40445);function je(a,c,t){for(let n in c)if(c.hasOwnProperty(n)){const r=c[n];r?a.setProperty(n,r,t?.has(n)?"important":""):a.removeProperty(n)}return a}function fe(a,c){const t=c?"":"none";je(a.style,{"touch-action":c?"":"none","-webkit-user-drag":c?"":"none","-webkit-tap-highlight-color":c?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function Ke(a,c,t){je(a.style,{position:c?"":"fixed",top:c?"":"0",opacity:c?"":"0",left:c?"":"-999em"},t)}function Vt(a,c){return c&&"none"!=c?a+" "+c:a}function vi(a){const c=a.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(a)*c}function yn(a,c){return a.getPropertyValue(c).split(",").map(n=>n.trim())}function fo(a){const c=a.getBoundingClientRect();return{top:c.top,right:c.right,bottom:c.bottom,left:c.left,width:c.width,height:c.height,x:c.x,y:c.y}}function bi(a,c,t){const{top:n,bottom:r,left:s,right:d}=a;return t>=n&&t<=r&&c>=s&&c<=d}function Qn(a,c,t){a.top+=c,a.bottom=a.top+a.height,a.left+=t,a.right=a.left+a.width}function xr(a,c,t,n){const{top:r,right:s,bottom:d,left:u,width:v,height:P}=a,y=v*c,w=P*c;return n>r-w&&n<d+w&&t>u-y&&t<s+y}class jt{constructor(c){this._document=c,this.positions=new Map}clear(){this.positions.clear()}cache(c){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),c.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:fo(t)})})}handleScroll(c){const t=(0,he.sA)(c),n=this.positions.get(t);if(!n)return null;const r=n.scrollPosition;let s,d;if(t===this._document){const P=this.getViewportScrollPosition();s=P.top,d=P.left}else s=t.scrollTop,d=t.scrollLeft;const u=r.top-s,v=r.left-d;return this.positions.forEach((P,y)=>{P.clientRect&&t!==y&&t.contains(y)&&Qn(P.clientRect,u,v)}),r.top=s,r.left=d,{top:u,left:v}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function Lt(a){const c=a.cloneNode(!0),t=c.querySelectorAll("[id]"),n=a.nodeName.toLowerCase();c.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return"canvas"===n?Tr(a,c):("input"===n||"select"===n||"textarea"===n)&&vt(a,c),wr("canvas",a,c,Tr),wr("input, textarea, select",a,c,vt),c}function wr(a,c,t,n){const r=c.querySelectorAll(a);if(r.length){const s=t.querySelectorAll(a);for(let d=0;d<r.length;d++)n(r[d],s[d])}}let Ci=0;function vt(a,c){"file"!==c.type&&(c.value=a.value),"radio"===c.type&&c.name&&(c.name=`mat-clone-${c.name}-${Ci++}`)}function Tr(a,c){const t=c.getContext("2d");if(t)try{t.drawImage(a,0,0)}catch{}}const Dr=(0,he.i$)({passive:!0}),Mi=(0,he.i$)({passive:!1}),wn=new Set(["position"]);class _s{get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(c){const t=(0,j.Ig)(c);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(n=>fe(n,t)))}constructor(c,t,n,r,s,d){this._config=t,this._document=n,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=d,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new ne.x,this._pointerMoveSubscription=_t.w0.EMPTY,this._pointerUpSubscription=_t.w0.EMPTY,this._scrollSubscription=_t.w0.EMPTY,this._resizeSubscription=_t.w0.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new ne.x,this.started=new ne.x,this.released=new ne.x,this.ended=new ne.x,this.entered=new ne.x,this.exited=new ne.x,this.dropped=new ne.x,this.moved=this._moveEvents,this._pointerDown=u=>{if(this.beforeStarted.next(),this._handles.length){const v=this._getTargetHandle(u);v&&!this._disabledHandles.has(v)&&!this.disabled&&this._initializeDragSequence(v,u)}else this.disabled||this._initializeDragSequence(this._rootElement,u)},this._pointerMove=u=>{const v=this._getPointerPositionOnPage(u);if(!this._hasStartedDragging){if(Math.abs(v.x-this._pickupPositionOnPage.x)+Math.abs(v.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const q=Date.now()>=this._dragStartTime+this._getDragStartDelay(u),se=this._dropContainer;if(!q)return void this._endDragSequence(u);(!se||!se.isDragging()&&!se.isReceiving())&&(u.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(u)))}return}u.preventDefault();const P=this._getConstrainedPointerPosition(v);if(this._hasMoved=!0,this._lastKnownPointerPosition=v,this._updatePointerDirectionDelta(P),this._dropContainer)this._updateActiveDropContainer(P,v);else{const y=this.constrainPosition?this._initialClientRect:this._pickupPositionOnPage,w=this._activeTransform;w.x=P.x-y.x+this._passiveTransform.x,w.y=P.y-y.y+this._passiveTransform.y,this._applyRootElementTransform(w.x,w.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:P,event:u,distance:this._getDragDistance(P),delta:this._pointerDirectionDelta})})},this._pointerUp=u=>{this._endDragSequence(u)},this._nativeDragStart=u=>{if(this._handles.length){const v=this._getTargetHandle(u);v&&!this._disabledHandles.has(v)&&!this.disabled&&u.preventDefault()}else this.disabled||u.preventDefault()},this.withRootElement(c).withParent(t.parentDragRef||null),this._parentPositions=new jt(n),d.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(c){this._handles=c.map(n=>(0,j.fI)(n)),this._handles.forEach(n=>fe(n,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(n=>{this._handles.indexOf(n)>-1&&t.add(n)}),this._disabledHandles=t,this}withPreviewTemplate(c){return this._previewTemplate=c,this}withPlaceholderTemplate(c){return this._placeholderTemplate=c,this}withRootElement(c){const t=(0,j.fI)(c);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,Mi),t.addEventListener("touchstart",this._pointerDown,Dr),t.addEventListener("dragstart",this._nativeDragStart,Mi)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(c){return this._boundaryElement=c?(0,j.fI)(c):null,this._resizeSubscription.unsubscribe(),c&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(c){return this._parentDragRef=c,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(c){!this._disabledHandles.has(c)&&this._handles.indexOf(c)>-1&&(this._disabledHandles.add(c),fe(c,!0))}enableHandle(c){this._disabledHandles.has(c)&&(this._disabledHandles.delete(c),fe(c,this.disabled))}withDirection(c){return this._direction=c,this}_withDropContainer(c){this._dropContainer=c}getFreeDragPosition(){const c=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:c.x,y:c.y}}setFreeDragPosition(c){return this._activeTransform={x:0,y:0},this._passiveTransform.x=c.x,this._passiveTransform.y=c.y,this._dropContainer||this._applyRootElementTransform(c.x,c.y),this}withPreviewContainer(c){return this._previewContainer=c,this}_sortFromLastPointerPosition(){const c=this._lastKnownPointerPosition;c&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(c),c)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview?.remove(),this._previewRef?.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(c){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this,event:c}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(c),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(c);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:c})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(c){Vn(c)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const n=this._rootElement,r=n.parentNode,s=this._placeholder=this._createPlaceholderElement(),d=this._anchor=this._anchor||this._document.createComment(""),u=this._getShadowRoot();r.insertBefore(d,n),this._initialTransform=n.style.transform||"",this._preview=this._createPreviewElement(),Ke(n,!1,wn),this._document.body.appendChild(r.replaceChild(s,n)),this._getPreviewInsertionPoint(r,u).appendChild(this._preview),this.started.next({source:this,event:c}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this,event:c}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(c,t){this._parentDragRef&&t.stopPropagation();const n=this.isDragging(),r=Vn(t),s=!r&&0!==t.button,d=this._rootElement,u=(0,he.sA)(t),v=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),P=r?(0,Ne.yG)(t):(0,Ne.X6)(t);if(u&&u.draggable&&"mousedown"===t.type&&t.preventDefault(),n||s||v||P)return;if(this._handles.length){const D=d.style;this._rootElementTapHighlight=D.webkitTapHighlightColor||"",D.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._initialClientRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(D=>this._updateOnScroll(D)),this._boundaryElement&&(this._boundaryRect=fo(this._boundaryElement));const y=this._previewTemplate;this._pickupPositionInElement=y&&y.template&&!y.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialClientRect,c,t);const w=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:w.x,y:w.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(c){Ke(this._rootElement,!0,wn),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialClientRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,n=t.getItemIndex(this),r=this._getPointerPositionOnPage(c),s=this._getDragDistance(r),d=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s,dropPoint:r,event:c}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:d,distance:s,dropPoint:r,event:c}),t.drop(this,n,this._initialIndex,this._initialContainer,d,s,r,c),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:c,y:t},{x:n,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,c,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(c,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,c,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(n,r),this._dropContainer._sortItem(this,c,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(c,t):this._applyPreviewTransform(c-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){const c=this._previewTemplate,t=this.previewClass,n=c?c.template:null;let r;if(n&&c){const s=c.matchSize?this._initialClientRect:null,d=c.viewContainer.createEmbeddedView(n,c.context);d.detectChanges(),r=jn(d,this._document),this._previewRef=d,c.matchSize?Kn(r,s):r.style.transform=Kt(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=Lt(this._rootElement),Kn(r,this._initialClientRect),this._initialTransform&&(r.style.transform=this._initialTransform);return je(r.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},wn),fe(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>r.classList.add(s)):r.classList.add(t)),r}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const c=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(c.left,c.top);const t=function zn(a){const c=getComputedStyle(a),t=yn(c,"transition-property"),n=t.find(u=>"transform"===u||"all"===u);if(!n)return 0;const r=t.indexOf(n),s=yn(c,"transition-duration"),d=yn(c,"transition-delay");return vi(s[r])+vi(d[r])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(n=>{const r=d=>{(!d||(0,he.sA)(d)===this._preview&&"transform"===d.propertyName)&&(this._preview?.removeEventListener("transitionend",r),n(),clearTimeout(s))},s=setTimeout(r,1.5*t);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const c=this._placeholderTemplate,t=c?c.template:null;let n;return t?(this._placeholderRef=c.viewContainer.createEmbeddedView(t,c.context),this._placeholderRef.detectChanges(),n=jn(this._placeholderRef,this._document)):n=Lt(this._rootElement),n.style.pointerEvents="none",n.classList.add("cdk-drag-placeholder"),n}_getPointerPositionInElement(c,t,n){const r=t===this._rootElement?null:t,s=r?r.getBoundingClientRect():c,d=Vn(n)?n.targetTouches[0]:n,u=this._getViewportScrollPosition();return{x:s.left-c.left+(d.pageX-s.left-u.left),y:s.top-c.top+(d.pageY-s.top-u.top)}}_getPointerPositionOnPage(c){const t=this._getViewportScrollPosition(),n=Vn(c)?c.touches[0]||c.changedTouches[0]||{pageX:0,pageY:0}:c,r=n.pageX-t.left,s=n.pageY-t.top;if(this._ownerSVGElement){const d=this._ownerSVGElement.getScreenCTM();if(d){const u=this._ownerSVGElement.createSVGPoint();return u.x=r,u.y=s,u.matrixTransform(d.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(c){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:n,y:r}=this.constrainPosition?this.constrainPosition(c,this,this._initialClientRect,this._pickupPositionInElement):c;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(n=this._pickupPositionOnPage.x),this._boundaryRect){const{x:s,y:d}=this._pickupPositionInElement,u=this._boundaryRect,{width:v,height:P}=this._getPreviewRect(),y=u.top+d,w=u.bottom-(P-d);n=Tn(n,u.left+s,u.right-(v-s)),r=Tn(r,y,w)}return{x:n,y:r}}_updatePointerDirectionDelta(c){const{x:t,y:n}=c,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,d=Math.abs(t-s.x),u=Math.abs(n-s.y);return d>this._config.pointerDirectionChangeThreshold&&(r.x=t>s.x?1:-1,s.x=t),u>this._config.pointerDirectionChangeThreshold&&(r.y=n>s.y?1:-1,s.y=n),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const c=this._handles.length>0||!this.isDragging();c!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=c,fe(this._rootElement,c))}_removeRootElementListeners(c){c.removeEventListener("mousedown",this._pointerDown,Mi),c.removeEventListener("touchstart",this._pointerDown,Dr),c.removeEventListener("dragstart",this._nativeDragStart,Mi)}_applyRootElementTransform(c,t){const n=Kt(c,t),r=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=r.transform&&"none"!=r.transform?r.transform:""),r.transform=Vt(n,this._initialTransform)}_applyPreviewTransform(c,t){const n=this._previewTemplate?.template?void 0:this._initialTransform,r=Kt(c,t);this._preview.style.transform=Vt(r,n)}_getDragDistance(c){const t=this._pickupPositionOnPage;return t?{x:c.x-t.x,y:c.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:c,y:t}=this._passiveTransform;if(0===c&&0===t||this.isDragging()||!this._boundaryElement)return;const n=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(0===r.width&&0===r.height||0===n.width&&0===n.height)return;const s=r.left-n.left,d=n.right-r.right,u=r.top-n.top,v=n.bottom-r.bottom;r.width>n.width?(s>0&&(c+=s),d>0&&(c-=d)):c=0,r.height>n.height?(u>0&&(t+=u),v>0&&(t-=v)):t=0,(c!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:c})}_getDragStartDelay(c){const t=this.dragStartDelay;return"number"==typeof t?t:Vn(c)?t.touch:t?t.mouse:0}_updateOnScroll(c){const t=this._parentPositions.handleScroll(c);if(t){const n=(0,he.sA)(c);this._boundaryRect&&n!==this._boundaryElement&&n.contains(this._boundaryElement)&&Qn(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,he.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(c,t){const n=this._previewContainer||"global";if("parent"===n)return c;if("global"===n){const r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return(0,j.fI)(n)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialClientRect),this._previewRect}_getTargetHandle(c){return this._handles.find(t=>c.target&&(c.target===t||t.contains(c.target)))}}function Kt(a,c){return`translate3d(${Math.round(a)}px, ${Math.round(c)}px, 0)`}function Tn(a,c,t){return Math.max(c,Math.min(t,a))}function Vn(a){return"t"===a.type[0]}function jn(a,c){const t=a.rootNodes;if(1===t.length&&t[0].nodeType===c.ELEMENT_NODE)return t[0];const n=c.createElement("div");return t.forEach(r=>n.appendChild(r)),n}function Kn(a,c){a.style.width=`${c.width}px`,a.style.height=`${c.height}px`,a.style.transform=Kt(c.left,c.top)}function _o(a,c,t){const n=Wn(c,a.length-1),r=Wn(t,a.length-1);if(n===r)return;const s=a[n],d=r<n?-1:1;for(let u=n;u!==r;u+=d)a[u]=a[u+d];a[r]=s}function Wn(a,c){return Math.max(0,Math.min(c,a))}class Et{constructor(c,t){this._element=c,this._dragDropRegistry=t,this._itemPositions=[],this.orientation="vertical",this._previousSwap={drag:null,delta:0,overlaps:!1}}start(c){this.withItems(c)}sort(c,t,n,r){const s=this._itemPositions,d=this._getItemIndexFromPointerPosition(c,t,n,r);if(-1===d&&s.length>0)return null;const u="horizontal"===this.orientation,v=s.findIndex(Me=>Me.drag===c),P=s[d],w=P.clientRect,D=v>d?1:-1,q=this._getItemOffsetPx(s[v].clientRect,w,D),se=this._getSiblingOffsetPx(v,s,D),Be=s.slice();return _o(s,v,d),s.forEach((Me,ln)=>{if(Be[ln]===Me)return;const K=Me.drag===c,Pe=K?q:se,Bt=K?c.getPlaceholderElement():Me.drag.getRootElement();Me.offset+=Pe,u?(Bt.style.transform=Vt(`translate3d(${Math.round(Me.offset)}px, 0, 0)`,Me.initialTransform),Qn(Me.clientRect,0,Pe)):(Bt.style.transform=Vt(`translate3d(0, ${Math.round(Me.offset)}px, 0)`,Me.initialTransform),Qn(Me.clientRect,Pe,0))}),this._previousSwap.overlaps=bi(w,t,n),this._previousSwap.drag=P.drag,this._previousSwap.delta=u?r.x:r.y,{previousIndex:v,currentIndex:d}}enter(c,t,n,r){const s=null==r||r<0?this._getItemIndexFromPointerPosition(c,t,n):r,d=this._activeDraggables,u=d.indexOf(c),v=c.getPlaceholderElement();let P=d[s];if(P===c&&(P=d[s+1]),!P&&(null==s||-1===s||s<d.length-1)&&this._shouldEnterAsFirstChild(t,n)&&(P=d[0]),u>-1&&d.splice(u,1),P&&!this._dragDropRegistry.isDragging(P)){const y=P.getRootElement();y.parentElement.insertBefore(v,y),d.splice(s,0,c)}else(0,j.fI)(this._element).appendChild(v),d.push(c);v.style.transform="",this._cacheItemPositions()}withItems(c){this._activeDraggables=c.slice(),this._cacheItemPositions()}withSortPredicate(c){this._sortPredicate=c}reset(){this._activeDraggables.forEach(c=>{const t=c.getRootElement();if(t){const n=this._itemPositions.find(r=>r.drag===c)?.initialTransform;t.style.transform=n||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(c){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(n=>n.drag===c)}updateOnScroll(c,t){this._itemPositions.forEach(({clientRect:n})=>{Qn(n,c,t)}),this._itemPositions.forEach(({drag:n})=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}_cacheItemPositions(){const c="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(t=>{const n=t.getVisibleElement();return{drag:t,offset:0,initialTransform:n.style.transform||"",clientRect:fo(n)}}).sort((t,n)=>c?t.clientRect.left-n.clientRect.left:t.clientRect.top-n.clientRect.top)}_getItemOffsetPx(c,t,n){const r="horizontal"===this.orientation;let s=r?t.left-c.left:t.top-c.top;return-1===n&&(s+=r?t.width-c.width:t.height-c.height),s}_getSiblingOffsetPx(c,t,n){const r="horizontal"===this.orientation,s=t[c].clientRect,d=t[c+-1*n];let u=s[r?"width":"height"]*n;if(d){const v=r?"left":"top",P=r?"right":"bottom";-1===n?u-=d.clientRect[v]-s[P]:u+=s[v]-d.clientRect[P]}return u}_shouldEnterAsFirstChild(c,t){if(!this._activeDraggables.length)return!1;const n=this._itemPositions,r="horizontal"===this.orientation;if(n[0].drag!==this._activeDraggables[0]){const d=n[n.length-1].clientRect;return r?c>=d.right:t>=d.bottom}{const d=n[0].clientRect;return r?c<=d.left:t<=d.top}}_getItemIndexFromPointerPosition(c,t,n,r){const s="horizontal"===this.orientation,d=this._itemPositions.findIndex(({drag:u,clientRect:v})=>u!==c&&((!r||u!==this._previousSwap.drag||!this._previousSwap.overlaps||(s?r.x:r.y)!==this._previousSwap.delta)&&(s?t>=Math.floor(v.left)&&t<Math.floor(v.right):n>=Math.floor(v.top)&&n<Math.floor(v.bottom))));return-1!==d&&this._sortPredicate(d,c)?d:-1}}const Sr=.05;class $n{constructor(c,t,n,r,s){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new ne.x,this.entered=new ne.x,this.exited=new ne.x,this.dropped=new ne.x,this.sorted=new ne.x,this.receivingStarted=new ne.x,this.receivingStopped=new ne.x,this._isDragging=!1,this._draggables=[],this._siblings=[],this._activeSiblings=new Set,this._viewportScrollSubscription=_t.w0.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new ne.x,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function Tt(a=0,c=Pn.z){return a<0&&(a=0),(0,cn.H)(a,a,c)}(0,On.Z).pipe((0,J.R)(this._stopScrollTimers)).subscribe(()=>{const d=this._scrollNode,u=this.autoScrollStep;1===this._verticalScrollDirection?d.scrollBy(0,-u):2===this._verticalScrollDirection&&d.scrollBy(0,u),1===this._horizontalScrollDirection?d.scrollBy(-u,0):2===this._horizontalScrollDirection&&d.scrollBy(u,0)})},this.element=(0,j.fI)(c),this._document=n,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new jt(n),this._sortStrategy=new Et(this.element,t),this._sortStrategy.withSortPredicate((d,u)=>this.sortPredicate(d,u,this))}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(c,t,n,r){this._draggingStarted(),null==r&&this.sortingDisabled&&(r=this._draggables.indexOf(c)),this._sortStrategy.enter(c,t,n,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:c,container:this,currentIndex:this.getItemIndex(c)})}exit(c){this._reset(),this.exited.next({item:c,container:this})}drop(c,t,n,r,s,d,u,v={}){this._reset(),this.dropped.next({item:c,currentIndex:t,previousIndex:n,container:this,previousContainer:r,isPointerOverContainer:s,distance:d,dropPoint:u,event:v})}withItems(c){const t=this._draggables;return this._draggables=c,c.forEach(n=>n._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>-1===c.indexOf(r))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(c){return this._sortStrategy.direction=c,this}connectedTo(c){return this._siblings=c.slice(),this}withOrientation(c){return this._sortStrategy.orientation=c,this}withScrollableParents(c){const t=(0,j.fI)(this.element);return this._scrollableElements=-1===c.indexOf(t)?[t,...c]:c.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(c){return this._isDragging?this._sortStrategy.getItemIndex(c):this._draggables.indexOf(c)}isReceiving(){return this._activeSiblings.size>0}_sortItem(c,t,n,r){if(this.sortingDisabled||!this._clientRect||!xr(this._clientRect,.05,t,n))return;const s=this._sortStrategy.sort(c,t,n,r);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:c})}_startScrollingIfNecessary(c,t){if(this.autoScrollDisabled)return;let n,r=0,s=0;if(this._parentPositions.positions.forEach((d,u)=>{u===this._document||!d.clientRect||n||xr(d.clientRect,.05,c,t)&&([r,s]=function Oi(a,c,t,n){const r=st(c,n),s=Dn(c,t);let d=0,u=0;if(r){const v=a.scrollTop;1===r?v>0&&(d=1):a.scrollHeight-v>a.clientHeight&&(d=2)}if(s){const v=a.scrollLeft;1===s?v>0&&(u=1):a.scrollWidth-v>a.clientWidth&&(u=2)}return[d,u]}(u,d.clientRect,c,t),(r||s)&&(n=u))}),!r&&!s){const{width:d,height:u}=this._viewportRuler.getViewportSize(),v={width:d,height:u,top:0,right:d,bottom:u,left:0};r=st(v,t),s=Dn(v,c),n=window}n&&(r!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||n!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=n,(r||s)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const c=(0,j.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=c.msScrollSnapType||c.scrollSnapType||"",c.scrollSnapType=c.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const c=(0,j.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(c).clientRect}_reset(){this._isDragging=!1;const c=(0,j.fI)(this.element).style;c.scrollSnapType=c.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_isOverContainer(c,t){return null!=this._clientRect&&bi(this._clientRect,c,t)}_getSiblingContainerFromPosition(c,t,n){return this._siblings.find(r=>r._canReceive(c,t,n))}_canReceive(c,t,n){if(!this._clientRect||!bi(this._clientRect,t,n)||!this.enterPredicate(c,this))return!1;const r=this._getShadowRoot().elementFromPoint(t,n);if(!r)return!1;const s=(0,j.fI)(this.element);return r===s||s.contains(r)}_startReceiving(c,t){const n=this._activeSiblings;!n.has(c)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(n.add(c),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:c,receiver:this,items:t}))}_stopReceiving(c){this._activeSiblings.delete(c),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:c,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(c=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(c);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const c=(0,he.kV)((0,j.fI)(this.element));this._cachedShadowRoot=c||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const c=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,c))}}function st(a,c){const{top:t,bottom:n,height:r}=a,s=r*Sr;return c>=t-s&&c<=t+s?1:c>=n-s&&c<=n+s?2:0}function Dn(a,c){const{left:t,right:n,width:r}=a,s=r*Sr;return c>=t-s&&c<=t+s?1:c>=n-s&&c<=n+s?2:0}const yi=(0,he.i$)({passive:!1,capture:!0});let Xn=(()=>{class a{constructor(t,n){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new ne.x,this.pointerUp=new ne.x,this.scroll=new ne.x,this._preventDefaultWhileDragging=r=>{this._activeDragInstances.length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=n}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,yi)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,yi)}startDragging(t,n){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const r=n.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:yi}),r||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:yi}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,d)=>{this._document.addEventListener(d,s.handler,s.options)})})}}stopDragging(t){const n=this._activeDragInstances.indexOf(t);n>-1&&(this._activeDragInstances.splice(n,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const n=[this.scroll];return t&&t!==this._document&&n.push(new Xe.y(r=>this._ngZone.runOutsideAngular(()=>{const d=u=>{this._activeDragInstances.length&&r.next(u)};return t.addEventListener("scroll",d,!0),()=>{t.removeEventListener("scroll",d,!0)}}))),(0,W.T)(...n)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,n)=>{this._document.removeEventListener(n,t.handler,t.options)}),this._globalListeners.clear()}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(e.R0b),e.LFG(f.K0))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const vs={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let pn=(()=>{class a{constructor(t,n,r,s){this._document=t,this._ngZone=n,this._viewportRuler=r,this._dragDropRegistry=s}createDrag(t,n=vs){return new _s(t,n,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new $n(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(f.K0),e.LFG(e.R0b),e.LFG(Rt.rL),e.LFG(Xn))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const Wt=new e.OlP("CDK_DRAG_PARENT"),ei=new e.OlP("CdkDropListGroup"),xi=new e.OlP("CDK_DRAG_CONFIG");let Co=0;const wi=new e.OlP("CdkDropList");let Ti=(()=>{class a{get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=(0,j.Ig)(t)}constructor(t,n,r,s,d,u,v){this.element=t,this._changeDetectorRef=r,this._scrollDispatcher=s,this._dir=d,this._group=u,this._destroyed=new ne.x,this.connectedTo=[],this.id="cdk-drop-list-"+Co++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.sorted=new e.vpe,this._unsortedItems=new Set,this._dropListRef=n.createDropList(t),this._dropListRef.data=this,v&&this._assignDefaults(v),this._dropListRef.enterPredicate=(P,y)=>this.enterPredicate(P.data,y.data),this._dropListRef.sortPredicate=(P,y,w)=>this.sortPredicate(P,y.data,w.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),a._dropLists.push(this),u&&u._items.add(this)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,n)=>t._dragRef.getVisibleElement().compareDocumentPosition(n._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=a._dropLists.indexOf(this);t>-1&&a._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe((0,oe.O)(this._dir.value),(0,J.R)(this._destroyed)).subscribe(n=>t.withDirection(n)),t.beforeStarted.subscribe(()=>{const n=(0,j.Eq)(this.connectedTo).map(r=>"string"==typeof r?a._dropLists.find(d=>d.id===r):r);if(this._group&&this._group._items.forEach(r=>{-1===n.indexOf(r)&&n.push(r)}),!this._scrollableParentsResolved){const r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(s=>s.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=(0,j.Ig)(this.sortingDisabled),t.autoScrollDisabled=(0,j.Ig)(this.autoScrollDisabled),t.autoScrollStep=(0,j.su)(this.autoScrollStep,2),t.connectedTo(n.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(n=>{this.entered.emit({container:this,item:n.item.data,currentIndex:n.currentIndex})}),t.exited.subscribe(n=>{this.exited.emit({container:this,item:n.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(n=>{this.sorted.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,container:this,item:n.item.data})}),t.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,item:n.item.data,isPointerOverContainer:n.isPointerOverContainer,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),(0,W.T)(t.receivingStarted,t.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(t){const{lockAxis:n,draggingDisabled:r,sortingDisabled:s,listAutoScrollDisabled:d,listOrientation:u}=t;this.disabled=r??!1,this.sortingDisabled=s??!1,this.autoScrollDisabled=d??!1,this.orientation=u||"vertical",n&&(this.lockAxis=n)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}}return a._dropLists=[],a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(pn),e.Y36(e.sBO),e.Y36(Rt.mF),e.Y36(ke.Is,8),e.Y36(ei,12),e.Y36(xi,8))},a.\u0275dir=e.lG2({type:a,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,n){2&t&&(e.uIk("id",n.id),e.ekj("cdk-drop-list-disabled",n.disabled)("cdk-drop-list-dragging",n._dropListRef.isDragging())("cdk-drop-list-receiving",n._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],data:["cdkDropListData","data"],orientation:["cdkDropListOrientation","orientation"],id:"id",lockAxis:["cdkDropListLockAxis","lockAxis"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],standalone:!0,features:[e._Bn([{provide:ei,useValue:void 0},{provide:wi,useExisting:a}])]}),a})();const ti=new e.OlP("CdkDragHandle"),kr=new e.OlP("CdkDragPlaceholder"),Ar=new e.OlP("CdkDragPreview");let Er=(()=>{class a{get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=(0,j.Ig)(t),this._dragRef.disabled=this._disabled}constructor(t,n,r,s,d,u,v,P,y,w,D){this.element=t,this.dropContainer=n,this._ngZone=s,this._viewContainerRef=d,this._dir=v,this._changeDetectorRef=y,this._selfHandle=w,this._parentDrag=D,this._destroyed=new ne.x,this.started=new e.vpe,this.released=new e.vpe,this.ended=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.dropped=new e.vpe,this.moved=new Xe.y(q=>{const se=this._dragRef.moved.pipe((0,te.U)(Be=>({source:this,pointerPosition:Be.pointerPosition,event:Be.event,delta:Be.delta,distance:Be.distance}))).subscribe(q);return()=>{se.unsubscribe()}}),this._dragRef=P.createDrag(t,{dragStartThreshold:u&&null!=u.dragStartThreshold?u.dragStartThreshold:5,pointerDirectionChangeThreshold:u&&null!=u.pointerDirectionChangeThreshold?u.pointerDirectionChangeThreshold:5,zIndex:u?.zIndex}),this._dragRef.data=this,a._dragInstances.push(this),u&&this._assignDefaults(u),n&&(this._dragRef._withDropContainer(n._dropListRef),n.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,at.q)(1),(0,J.R)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const n=t.rootElementSelector,r=t.freeDragPosition;n&&!n.firstChange&&this._updateRootElement(),r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=a._dragInstances.indexOf(this);t>-1&&a._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const t=this.element.nativeElement;let n=t;this.rootElementSelector&&(n=void 0!==t.closest?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(n||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?this.element.nativeElement.closest(t):(0,j.fI)(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const n=this._dir,r=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,d=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof r&&r?r:(0,j.su)(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(d).withPreviewContainer(this.previewContainer||"global"),n&&t.withDirection(n.value)}}),t.beforeStarted.pipe((0,at.q)(1)).subscribe(()=>{if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let n=this.element.nativeElement.parentElement;for(;n;){if(n.classList.contains("cdk-drag")){t.withParent(a._dragInstances.find(r=>r.element.nativeElement===n)?._dragRef||null);break}n=n.parentElement}})}_handleEvents(t){t.started.subscribe(n=>{this.started.emit({source:this,event:n.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(n=>{this.released.emit({source:this,event:n.event})}),t.ended.subscribe(n=>{this.ended.emit({source:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(n=>{this.entered.emit({container:n.container.data,item:this,currentIndex:n.currentIndex})}),t.exited.subscribe(n=>{this.exited.emit({container:n.container.data,item:this})}),t.dropped.subscribe(n=>{this.dropped.emit({previousIndex:n.previousIndex,currentIndex:n.currentIndex,previousContainer:n.previousContainer.data,container:n.container.data,isPointerOverContainer:n.isPointerOverContainer,item:this,distance:n.distance,dropPoint:n.dropPoint,event:n.event})})}_assignDefaults(t){const{lockAxis:n,dragStartDelay:r,constrainPosition:s,previewClass:d,boundaryElement:u,draggingDisabled:v,rootElementSelector:P,previewContainer:y}=t;this.disabled=v??!1,this.dragStartDelay=r||0,n&&(this.lockAxis=n),s&&(this.constrainPosition=s),d&&(this.previewClass=d),u&&(this.boundaryElement=u),P&&(this.rootElementSelector=P),y&&(this.previewContainer=y)}_setupHandlesListener(){this._handles.changes.pipe((0,oe.O)(this._handles),(0,H.b)(t=>{const n=t.filter(r=>r._parentDrag===this).map(r=>r.element);this._selfHandle&&this.rootElementSelector&&n.push(this.element),this._dragRef.withHandles(n)}),(0,ge.w)(t=>(0,W.T)(...t.map(n=>n._stateChanges.pipe((0,oe.O)(n))))),(0,J.R)(this._destroyed)).subscribe(t=>{const n=this._dragRef,r=t.element.nativeElement;t.disabled?n.disableHandle(r):n.enableHandle(r)})}}return a._dragInstances=[],a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(wi,12),e.Y36(f.K0),e.Y36(e.R0b),e.Y36(e.s_b),e.Y36(xi,8),e.Y36(ke.Is,8),e.Y36(pn),e.Y36(e.sBO),e.Y36(ti,10),e.Y36(Wt,12))},a.\u0275dir=e.lG2({type:a,selectors:[["","cdkDrag",""]],contentQueries:function(t,n,r){if(1&t&&(e.Suo(r,Ar,5),e.Suo(r,kr,5),e.Suo(r,ti,5)),2&t){let s;e.iGM(s=e.CRH())&&(n._previewTemplate=s.first),e.iGM(s=e.CRH())&&(n._placeholderTemplate=s.first),e.iGM(s=e.CRH())&&(n._handles=s)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,n){2&t&&e.ekj("cdk-drag-disabled",n.disabled)("cdk-drag-dragging",n._dragRef.isDragging())},inputs:{data:["cdkDragData","data"],lockAxis:["cdkDragLockAxis","lockAxis"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],boundaryElement:["cdkDragBoundary","boundaryElement"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"],disabled:["cdkDragDisabled","disabled"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],previewContainer:["cdkDragPreviewContainer","previewContainer"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],standalone:!0,features:[e._Bn([{provide:Wt,useExisting:a}]),e.TTD]}),a})(),Cs=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[pn],imports:[Rt.ZD]}),a})();var qr=k(99602),Le=k(97392),ye=k(81390),pe=k(89383);const Ms=["*"];let Po=(()=>{class a{constructor(t,n){this.elt=t,this.renderer=n,this.onStart=new e.vpe,this.onStop=new e.vpe,this.onTick=new e.vpe,this.onComplete=new e.vpe,this.autoStart=!0,this.startTime=0,this.endTime=0,this.timeoutId=null,this.countdown=!1,this.format="default"}ngAfterViewInit(){const t=this.elt.nativeElement.lastChild;this.ngContentSchema=t?t.nodeValue:"",(void 0===this.autoStart||!0===this.autoStart)&&this.start()}ngOnDestroy(){this.resetTimeout()}start(){this.initVar(),this.resetTimeout(),this.computeTimeUnits(),this.startTickCount(),this.onStart.emit(this)}resume(){this.resetTimeout(),this.startTickCount()}stop(){this.clear(),this.onStop.emit(this)}reset(){this.initVar(),this.resetTimeout(),this.clear(),this.computeTimeUnits(),this.renderText()}get(){return{seconds:this.seconds,minutes:this.minutes,hours:this.hours,days:this.days,timer:this.timeoutId,tick_count:this.tickCounter}}initVar(){this.startTime=this.startTime||0,this.endTime=this.endTime||0,this.countdown=this.countdown||!1,this.tickCounter=this.startTime,this.countdown&&0===this.startTime&&(this.countdown=!1),this.format||(this.format=this.ngContentSchema.length>5?"user":"default")}resetTimeout(){this.timeoutId&&clearInterval(this.timeoutId)}renderText(){let t;if("user"===this.format){const n={seconds:this.seconds,minutes:this.minutes,hours:this.hours,days:this.days};t=this.ngContentSchema;for(const r of Object.keys(n))t=t.replace("["+r+"]",n[r].toString())}else"intelli"===this.format?(t="",this.days>0&&(t+=this.days.toString()+"day"+(this.days>1?"s":"")+" "),(this.hours>0||this.days>0)&&(t+=this.hours.toString()+"h "),(this.minutes>0||this.hours>0)&&0===this.days&&(t+=this.minutes.toString().padStart(2,"0")+"min "),0===this.hours&&0===this.days&&(t+=this.seconds.toString().padStart(2,"0")+"s")):"hms"===this.format?(t=this.hours.toString().padStart(2,"0")+":",t+=this.minutes.toString().padStart(2,"0")+":",t+=this.seconds.toString().padStart(2,"0")):"ms"===this.format?(t="",this.hours>0&&(t=this.hours.toString().padStart(2,"0")+":"),t+=this.minutes.toString().padStart(2,"0")+":",t+=this.seconds.toString().padStart(2,"0")):(t=this.days.toString()+"d ",t+=this.hours.toString()+"h ",t+=this.minutes.toString()+"m ",t+=this.seconds.toString()+"s");this.renderer.setProperty(this.elt.nativeElement,"innerHTML",t)}clear(){this.resetTimeout(),this.timeoutId=null}computeTimeUnits(){this.maxTimeUnit&&"day"!==this.maxTimeUnit?"second"===this.maxTimeUnit?(this.seconds=this.tickCounter,this.minutes=0,this.hours=0,this.days=0):"minute"===this.maxTimeUnit?(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60),this.hours=0,this.days=0):"hour"===this.maxTimeUnit&&(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60%60),this.hours=Math.floor(this.tickCounter/3600),this.days=0):(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60%60),this.hours=Math.floor(this.tickCounter/3600%24),this.days=Math.floor(this.tickCounter/3600/24)),this.renderText()}startTickCount(){const t=this;t.timeoutId=setInterval(function(){let n;if(t.countdown?(n=t.tickCounter,t.startTime>t.endTime&&(n=t.tickCounter-t.endTime-1)):(n=t.tickCounter-t.startTime,t.endTime>t.startTime&&(n=t.endTime-t.tickCounter-1)),t.computeTimeUnits(),t.onTick.emit({seconds:t.seconds,minutes:t.minutes,hours:t.hours,days:t.days,timer:t.timeoutId,tick_count:t.tickCounter}),n<0)return t.stop(),void t.onComplete.emit(t);t.countdown?t.tickCounter--:t.tickCounter++},1e3)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(e.Qsj))},a.\u0275cmp=e.Xpm({type:a,selectors:[["cd-timer"]],inputs:{startTime:"startTime",endTime:"endTime",countdown:"countdown",autoStart:"autoStart",maxTimeUnit:"maxTimeUnit",format:"format"},outputs:{onStart:"onStart",onStop:"onStop",onTick:"onTick",onComplete:"onComplete"},ngContentSelectors:Ms,decls:1,vars:0,template:function(t,n){1&t&&(e.F$t(),e.Hsn(0))},encapsulation:2}),a})(),Ps=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[]]}),a})();var Di=k(22284),Os=k(64346),dn=k(74743),ys=k(88784),xs=k(65504),ws=k(44466),Ts=k(9655),ue=k(15861),Ct=k(61135),Ee=k(83905),xe=k(7274),un=k(38588),we=k(12484),Zr=k(77782),T=k(24006);const Fr=()=>({placeHolder:"labour_time",name:"labourTime",label:"labour_time_hours",value:0,type:"number",maxLength:4,validation:{name:"labourTime",validationFunction:()=>T.kI.compose([T.kI.maxLength(4)]),validationMessage:a=>a.maxlength?"labour_time_not_be_more_than_4_characters":""}}),ni=(a,c)=>({placeHolder:"labour_amount",name:"labourAmount",label:a.instant("labour_amount_currency")?.replace("{{currency}}",c)||"",value:0,type:"number",maxLength:7,validation:{name:"labourTime",validationFunction:()=>T.kI.compose([T.kI.maxLength(7)]),validationMessage:t=>t.maxlength?"labour_amount_not_be_more_than_7_characters":""}});function Is(){const a={invalidPrice:!1};return c=>c.value>9999999.99?(a.invalidPrice=!0,a):null}const re={replace:"Replace",repair:"Repair",removeAndRefit:"Remove & Refit",painting:"Painting",polish:"Polish",checkFields:"Check",performFields:"Perform"};var _e=k(56969),Sn=k(75983),Dt=k(8985),ve=k(92340),yo=k(80529);let Ii=(()=>{class a{constructor(t){this.http=t,this.apiUrl="operation",this.repairOperationType=[]}getOperations(t,n=null){const r=(t.currentPage-1)*t.pageSize;return this.http.get(`${ve.N.caseMgmtUrl}/odata/${this.apiUrl}?${n=n?`$top=${t.pageSize}&$skip=${r}&${n}`:`$top=${t.pageSize}&$skip=${r}`}&$orderby=${t.orderBy} ${t.sortDirection}&count=true`)}getRepairOperationType(){return this.http.get(`${ve.N.caseMgmtUrl}/api/lookup?type=RepairOperationType`)}addRepairOperation(t,n){return this.http.post(`${ve.N.caseMgmtUrl}/api/operation/${t}`,n)}editRepairOperation(t){return this.http.put(`${ve.N.caseMgmtUrl}/api/operation`,t)}deleteOperation(t){return this.http.delete(`${ve.N.caseMgmtUrl}/api/operation/${t}`)}editRepairEstimateOperation(t,n){return this.http.put(`${ve.N.caseMgmtUrl}/api/operation/repairoperation/${t}`,n)}getRepairEstimateOperationDetails(t){return this.http.get(`${ve.N.caseMgmtUrl}/api/operation/repairoperation/${t}`)}deleteRepairEstimateOperation(t,n){return this.http.delete(`${ve.N.caseMgmtUrl}/api/operation/repairoperation/${t}/${n}`)}addOperationsToReapir(t,n){return this.http.post(`${ve.N.caseMgmtUrl}/api/operation/repairoperation/${t}`,n)}getParts(t){return this.http.get(`${ve.N.caseMgmtUrl}/api/repair/${t}/parts`)}getPartStatuses(){return this.http.get(`${ve.N.caseMgmtUrl}/api/lookup?type=PartStatus`)}editPartStatuses(t,n){return this.http.put(`${ve.N.caseMgmtUrl}/api/repair/${n}/partStatus`,t)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(yo.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var be=k(81364),Mt=k(14315),He=k(36978);const xo=["operationTypeControl"],ks=["repairTypeControl"],Nr=["operationControl"],ki=["codeControl"],Ur=["informationControl"],As=["labourAmountControl"],Jr=["labourTimeControl"],Gr=["quantityControl"],wo=["priceControl"];function Rs(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",2)(1,"chq-input",19,20),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA(),e.TgZ(3,"chq-input",19,21),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("inputModel",t.formModel.quantity),e.xp6(2),e.Q6J("inputModel",t.formModel.price)}}function Br(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",2)(1,"chq-input",19,22),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA(),e.TgZ(3,"chq-input",19,23),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("inputModel",t.formModel.labourAmount),e.xp6(2),e.Q6J("inputModel",t.formModel.labourTime)}}function To(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",19,22),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onFormUpdate(r))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("inputModel",t.formModel.labourAmount)}}function Do(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",2),e.YNc(1,To,2,1,"chq-input",24),e.TgZ(2,"chq-input",19,23),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.formData.operationType===t.OPERATION_TYPE.replace),e.xp6(1),e.Q6J("inputModel",t.formModel.labourTime)}}function In(a,c){1&a&&(e.TgZ(0,"div",25)(1,"div",26),e._UZ(2,"mat-icon",27),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()),2&a&&(e.xp6(2),e.Q6J("svgIcon","information-operation"),e.xp6(2),e.Oqu(e.lcZ(5,2,"operation_replace_information_popup")))}function Yr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",28),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("inputModel",t.formModel.saveOperation)}}let zr=(()=>{class a{constructor(t,n,r,s,d,u){this.bookingService=t,this.repairEstimateOperationService=n,this.commonService=r,this.monitorService=s,this.changeDetectorRef=d,this.translateService=u,this.switchToOperationLIst=new e.vpe,this.cancelDialog=new e.vpe,this.OPERATION_TYPE=re,this.formData={operationType:"",operation:"",code:"",repairType:"",information:"",quantity:0,price:0,labourTime:0,labourAmount:0,saveOperation:!1},this.currencySymbol="",this.addButtonModel={label:"add",type:"disabled",icon:"",onclick:this.beforeSubmit.bind(this)},this.resetButtonModel={label:"reset",type:"outline",icon:"",onclick:this.resetForm.bind(this)},this.i18n=this.commonService.geti18nInfo(),this.currencySymbol=this.i18n.currencySymbol}ngOnInit(){this.monitorService.logEvent("ngOnInit",["OperationAddComponent","addenda-repair"]),this.formModel={operationType:{placeHolder:"select_operation_type",name:"operationType",label:"operation_type",options:[{}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,showSelectedOption:!1,validation:{name:"operationType",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"please_select_operation_type":""}},operation:{placeHolder:"part_operation",label:"part_operation",name:"operation",value:0,type:"text",maxLength:50,required:!0,validation:{name:"operation",validationFunction:()=>T.kI.compose([T.kI.required,T.kI.maxLength(50),T.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:a=>a.required?"please_enter_part_operation":a.maxlength?"part_operation_should_have_not_more_than_50_characters":a.pattern?"part_operation_only_alphanumberic_characters":""}},code:{placeHolder:"code",label:"code",name:"code",value:"",type:"text",maxLength:50,required:!0,validation:{name:"code",validationFunction:()=>T.kI.compose([T.kI.required,T.kI.maxLength(50),T.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:a=>a.required?"please_enter_code":a.maxlength?"code_should_have_not_more_than_50_characters":a.pattern?"part_operation_only_alphanumberic_characters":""}},repairType:{placeHolder:"select_repair_type",name:"repairType",label:"repair_type",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:"",required:!0,validation:{name:"repairType",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"please_select_repair_type":""}},information:{placeHolder:"information",label:"information",name:"information",value:"",type:"textarea",maxLength:150,validation:{name:"information",validationFunction:()=>T.kI.compose([T.kI.maxLength(150),T.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:a=>a.maxlength?"information_should_have_not_more_than_150_characters":a.pattern?"part_operation_only_alphanumberic_characters":""}},saveOperation:{placeHolder:"",label:"",name:"saveOperation",idField:"saveOperation",value:1,type:"checkbox",options:[{label:"save_operation",id:1,value:1,checked:!1}]}},!this.formModel.operationType.observable&&!this.repairEstimateOperationService.repairOperationType?.length&&(this.formModel.operationType.observable=this.repairEstimateOperationService.getRepairOperationType(),this.formModel.operationType.onObservableLoad=this.onObservableLoadOperationType.bind(this)),!this.formModel.repairType.observable&&!this.bookingService.repairTypes?.length&&(this.formModel.repairType.observable=this.bookingService.getRepairTypes(),this.formModel.repairType.onObservableLoad=this.onObservableLoadRepairTypes.bind(this))}ngAfterViewInit(){this.monitorService.logEvent("ngAfterViewInit",["OperationAddComponent","addenda-repair"]),this.populateFormData(),this.repairEstimateOperationService.repairOperationType?.length&&this.onObservableLoadOperationType(this.repairEstimateOperationService.repairOperationType),this.bookingService.repairTypes?.length&&this.onObservableLoadRepairTypes(this.bookingService.repairTypes),this.checkForFormValidation()}populateFormData(){this.operationToEdit&&(Object.keys(this.operationToEdit).length>0&&(this.addButtonModel.label="save"),this.operationToEdit.Code&&(this.formModel.code={...this.formModel.code,value:this.operationToEdit.Code},this.formData.code=this.operationToEdit.Code),this.operationToEdit.Information&&(this.formModel.information.value=this.operationToEdit.Information,this.formData.information=this.operationToEdit.Information),this.operationToEdit.OperationName&&(this.formModel.operation={...this.formModel.operation,value:this.operationToEdit.OperationName},this.formData.operation=this.operationToEdit.OperationName))}populateConditionalFieldsData(){this.operationToEdit&&(this.operationToEdit.Price&&this.formModel.price&&(this.formModel.price.value=this.operationToEdit.Price,this.formData.price=this.operationToEdit.Price),this.operationToEdit.LabourTime&&this.formModel.labourTime&&(this.formModel.labourTime.value=this.operationToEdit.LabourTime,this.formData.labourTime=this.operationToEdit.LabourTime),this.operationToEdit.LabourAmount&&this.formModel.labourAmount&&(this.formModel.labourAmount.value=this.operationToEdit.LabourAmount,this.formData.labourAmount=this.operationToEdit.LabourAmount),this.operationToEdit.Quantity&&this.formModel.quantity&&(this.formModel.quantity.value=this.operationToEdit.Quantity,this.formData.quantity=this.operationToEdit.Quantity),(this.operationToEdit.LabourAmount||this.operationToEdit.LabourTime)&&this.formData.operationType!==re.replace&&this.formData.operationType!==re.painting&&(this.operationToEdit.LabourAmount?this.formModel?.labourTime&&(this.formModel.labourTime.disabled=!0):this.formModel?.labourAmount&&(this.formModel.labourAmount.disabled=!0)),this.checkForFormValidation(),this.triggerValidation())}triggerValidation(){Object.keys(this.formModel).forEach(t=>{"saveOperation"!==t&&this.formModel[t]?.formControl?.markAsTouched&&this.formModel[t].formControl.markAsTouched()})}setInitialStateOfForm(){if(this.operationToEdit?.RepairOperationTypeId){const t=this.formModel.operationType.options.find(n=>n.id===this.operationToEdit.RepairOperationTypeId);t&&(this.formModel.operationType={...this.formModel.operationType,selectedOption:t},this.showHideFieldsBasedOnOperationType({name:this.formModel.operationType.name,type:this.formModel.operationType.type,value:t}),this.populateConditionalFieldsData())}else{const t=this.formModel.operationType.options.find(n=>n.name===re.replace);t&&(this.formModel.operationType={...this.formModel.operationType,selectedOption:t},this.showHideFieldsBasedOnOperationType({name:this.formModel.operationType.name,type:this.formModel.operationType.type,value:t}))}}hideDropdown(t){t===this.formModel.operationType.name?this.repairTypeControl.closeDropdown():t===this.formModel.repairType.name&&this.operationTypeControl.closeDropdown()}onFormUpdate(t){if("select"===t.type)if(this.formModel[t.name]={...this.formModel[t.name],selectedOption:t.value},"operationType"===t.name)if(this.formData[t.name]=t?.value?.name||"",this.showHideFieldsBasedOnOperationType(t),t?.value?.name===re.painting||t?.value?.name===re.polish){const n=this.formModel.repairType.options?.find(r=>"paint"===r.name.toLowerCase());n&&(this.formModel.repairType={...this.formModel.repairType,selectedOption:n},this.formData.repairType=n.name,this.repairTypeControl.getDropdownOutput({name:this.formModel.repairType.name,type:this.formModel.repairType.type,value:n}))}else this.formModel.repairType={...this.formModel.repairType,selectedOption:{}},this.formData.repairType="";else this.formData[t.name]="repairType"===t.name?t.value.name:t.value;else this.formModel[t.name].value=t.value,this.formData[t.name]=t.value,this.formData.operationType!==re.painting&&("labourAmount"===t.name?this.formModel.labourTime.disabled=!!t.value:"labourTime"===t.name&&(this.formModel.labourAmount.disabled=!!t.value));this.checkForFormValidation()}showHideFieldsBasedOnOperationType(t){this.formData[t.name]=t?.value?.name||"",t?.value?.name===re.replace||t?.value?.name===re.painting?(delete this.formModel.labourTime,delete this.formModel.labourAmount,this.formModel.quantity={placeHolder:"quantity",name:"quantity",label:"quantity",value:0,type:"number",maxLength:3,validation:{name:"quantity",validationFunction:()=>T.kI.compose([T.kI.maxLength(3)]),validationMessage:a=>a.maxlength?"quantity_should_not_be_more_than_3_characters":""}},this.formModel.price=((a,c)=>({placeHolder:"price",name:"price",label:this.translateService.instant("price_currency")?.replace("{{currency}}",c)||"",value:0,type:"number",maxLength:10,validation:{name:"price",validationFunction:()=>T.kI.compose([Is()]),validationMessage:t=>t.invalidPrice?"price_max_length_validation":""}}))(0,this.currencySymbol),this.formModel.labourTime=Fr(),t?.value?.name===re.replace&&(this.formModel.labourAmount=ni(this.translateService,this.currencySymbol)),this.resetFormData()):t?.value?.name===re.repair||t?.value?.name===re.removeAndRefit||t?.value?.name===re.polish||t?.value?.name===re.checkFields||t?.value?.name===re.performFields?(delete this.formModel.quantity,delete this.formModel.price,delete this.formModel.labourTime,this.formModel.labourAmount=ni(this.translateService,this.currencySymbol),this.formModel.labourTime=Fr(),this.resetFormData()):(delete this.formModel.quantity,delete this.formModel.price,delete this.formModel.labourTime,delete this.formModel.labourAmount,delete this.formModel.labourTime,this.resetFormData())}resetFormData(){this.formData.labourTime=0,this.formData.labourAmount=0,this.formData.price=0,this.formData.quantity=0,this.operationToEdit?.Quantity||this.formModel.quantity&&(this.formModel.quantity.value=1,this.formData.quantity=1)}checkForFormValidation(){this.addButtonModel.type=this.isOperationFormValid()?"primary":"disabled"}isOperationFormValid(){this.changeDetectorRef.detectChanges();let t=!0;return this.formData.operationType&&this.formData.repairType&&this.formData.operation&&this.formData.code&&this.operationControl.formControl.valid&&this.codeControl.formControl.valid&&this.informationControl.formControl.valid||(t=!1),this.formData.operationType===re.replace||this.formData.operationType===re.painting?(this.quantityControl.formControl.valid&&this.priceControl.formControl.valid&&this.labourTimeControl.formControl.valid||(t=!1),this.formData.operationType===re.replace&&!this.labourAmountControl.formControl.valid&&(t=!1),this.formData.operationType===re.replace&&!this.formData.labourTime&&!this.formData.labourAmount&&(t=!1)):this.formData.operationType!==re.repair&&this.formData.operationType!==re.removeAndRefit&&this.formData.operationType!==re.polish&&this.formData.operationType!==re.checkFields&&this.formData.operationType!==re.performFields||this.labourAmountControl.formControl.valid&&this.labourTimeControl.formControl.valid||(t=!1),t}onObservableLoadRepairTypes(t){if(t&&t.length>0&&t.forEach((n,r)=>{t[r]={...t[r],dropdownItemIcon:this.getIcon(n.name)}}),this.formModel.repairType={...this.formModel.repairType,options:t},this.bookingService.repairTypes?.length||(this.bookingService.repairTypes=t),this.operationToEdit?.RepairServiceTypeId){const n=this.formModel.repairType.options?.find(r=>r.id===this.operationToEdit.RepairServiceTypeId);n&&(this.formModel.repairType={...this.formModel.repairType,selectedOption:n},this.formData.repairType=n.name,this.checkForFormValidation())}else if(this.formData.operationType===re.painting||this.formData.operationType===re.polish){const n=this.formModel.repairType.options?.find(r=>"Paint"===r.name);n&&(this.formModel.repairType={...this.formModel.repairType,selectedOption:n},this.formData.repairType=n.name)}}getIcon(t){switch(t){case"Body":return"car";case"Maintenance":return"house";case"Tires":return"tire";case"Paint":return"paintbrush";case"Others":return"gears";case"Electrical":return"bolt-car";case"Diagnosis":return"diagnosis";case"Mechanical":return"mechanical";default:return""}}beforeSubmit(){(this.operationToEdit?.RepairOperationGuid||this.operationToEdit?.OperationGuid)&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.submitForm.bind(this),Sn.j.quote):this.submitForm()}submitForm(){if(!this.isOperationFormValid())return;this.monitorService.logEvent("submitForm",["OperationAddComponent","addenda-repair"]);const t=this.formModel.operationType.options.find(s=>s.name===this.formData.operationType);if(!t)return;let n;this.formData.repairType&&(n=this.formModel.repairType.options.find(s=>s.name===this.formData.repairType));const r={operationName:this.formData.operation,repairOperationTypeId:t?.id};this.formData.code&&(r.code=this.formData.code),this.formData.information&&(r.information=this.formData.information),n&&(r.repairServiceTypeId=n.id),this.formData.operationType===re.replace||this.formData.operationType===re.painting?(this.formData.quantity&&(r.quantity=this.formData.quantity),this.formData.price&&(r.price=this.formData.price),this.formData.labourTime&&(r.labourTime=this.formData.labourTime),this.formData.operationType===re.replace&&this.formData.labourAmount&&(r.labourAmount=this.formData.labourAmount)):(this.formData.labourTime&&(r.labourTime=this.formData.labourTime),this.formData.labourAmount&&(r.labourAmount=this.formData.labourAmount)),r.labourTime&&"string"==typeof r.labourTime&&(r.labourTime=parseFloat(r.labourTime)),r.labourAmount&&"string"==typeof r.labourAmount&&(r.labourAmount=parseFloat(r.labourAmount)),r.quantity&&"string"==typeof r.quantity&&(r.quantity=parseFloat(r.quantity)),r.price&&"string"==typeof r.price&&(r.price=parseFloat(r.price)),this.commonService.showLoading(),this.operationToEdit?.RepairOperationGuid?(r.repairOperationGuid=this.operationToEdit.RepairOperationGuid,this.monitorService.logEvent("editRepairEstimateOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:r}),this.repairEstimateOperationService.editRepairEstimateOperation(this.repairId,r).subscribe({next:s=>{s&&(this.commonService.hideLoading(),this.cancelDialog.emit(!0))},error:s=>{this.commonService.hideLoading(),this.monitorService.logException(s,_e._.Error)}})):this.operationToEdit?.OperationGuid?(r.operationGuid=this.operationToEdit.OperationGuid,this.monitorService.logEvent("editRepairOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:r}),this.repairEstimateOperationService.editRepairOperation(r).subscribe({next:s=>{s&&(this.commonService.hideLoading(),this.switchToOperationLIst.emit())},error:s=>{this.commonService.hideLoading(),this.monitorService.logException(s,_e._.Error)}})):(r.saveOperation=this.formData.saveOperation,this.monitorService.logEvent("addRepairOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:r}),this.repairEstimateOperationService.addRepairOperation(this.repairId,r).subscribe({next:s=>{s&&(this.commonService.hideLoading(),this.cancelDialog.emit(!0))},error:s=>{this.commonService.hideLoading(),this.monitorService.logException(s,_e._.Error)}}))}resetForm(t=!0){if(this.operationToEdit?.Id)this.populateFormData(),this.setInitialStateOfForm(),this.onObservableLoadRepairTypes(this.formModel.repairType.options);else if(t&&this.setInitialStateOfForm(),this.formModel.code={...this.formModel.code,value:""},this.formData.code="",this.formModel.operation={...this.formModel.operation,value:""},this.formData.operation="",this.formModel.operation.formControl.reset(),this.formModel.repairType={...this.formModel.repairType,selectedOption:[]},this.formData.repairType="",this.formModel.information={...this.formModel.information,value:""},this.formData.information="",this.formModel.quantity&&(this.formModel.quantity={...this.formModel.quantity,value:0},this.formData.quantity=0),this.formModel.price&&(this.formModel.price={...this.formModel.price,value:0},this.formData.price=0),this.formModel.labourTime&&(this.formModel.labourTime={...this.formModel.labourTime,value:0},this.formData.labourTime=0),this.formModel.labourAmount&&(this.formModel.labourAmount={...this.formModel.labourAmount,value:0},this.formData.labourAmount=0),this.formModel.saveOperation){const n=this.formModel.saveOperation.options;n[0].checked=!1,this.formModel.saveOperation={...this.formModel.saveOperation,options:[...n]},this.formData.saveOperation=!1}}onObservableLoadOperationType(t){this.formModel.operationType={...this.formModel.operationType,options:t},this.repairEstimateOperationService.repairOperationType=t,this.setInitialStateOfForm()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Dt.q),e.Y36(Ii),e.Y36(be.v),e.Y36(we.M),e.Y36(e.sBO),e.Y36(pe.sK))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-operation-add"]],viewQuery:function(t,n){if(1&t&&(e.Gf(xo,5),e.Gf(ks,5),e.Gf(Nr,5),e.Gf(ki,5),e.Gf(Ur,5),e.Gf(As,5),e.Gf(Jr,5),e.Gf(Gr,5),e.Gf(wo,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.operationTypeControl=r.first),e.iGM(r=e.CRH())&&(n.repairTypeControl=r.first),e.iGM(r=e.CRH())&&(n.operationControl=r.first),e.iGM(r=e.CRH())&&(n.codeControl=r.first),e.iGM(r=e.CRH())&&(n.informationControl=r.first),e.iGM(r=e.CRH())&&(n.labourAmountControl=r.first),e.iGM(r=e.CRH())&&(n.labourTimeControl=r.first),e.iGM(r=e.CRH())&&(n.quantityControl=r.first),e.iGM(r=e.CRH())&&(n.priceControl=r.first)}},inputs:{operationToEdit:"operationToEdit",repairId:"repairId"},outputs:{switchToOperationLIst:"switchToOperationLIst",cancelDialog:"cancelDialog"},decls:35,vars:12,consts:[[1,"estimate-add-operation","fx-col","h-100"],[1,"fx-1"],[1,"row"],[1,"col-6"],[3,"inputModel","clicked","controlOutput"],["operationTypeControl",""],["operationControl",""],["codeControl",""],["class","row",4,"ngIf"],[1,"col-6","repair-type"],["repairTypeControl",""],["informationControl",""],["class","information",4,"ngIf"],[1,"fx-0","justify-space-between","d-flex"],[1,"col-6","save-operation"],[3,"inputModel","controlOutput",4,"ngIf"],[1,"footer-button"],[1,"reset-button",3,"buttonModel"],[3,"buttonModel"],[1,"col-6",3,"inputModel","clicked","controlOutput"],["quantityControl",""],["priceControl",""],["labourAmountControl",""],["labourTimeControl",""],["class","col-6",3,"inputModel","clicked","controlOutput",4,"ngIf"],[1,"information"],[1,"icon-wrapper"],[1,"cross",3,"svgIcon"],[3,"inputModel","controlOutput"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"chq-input",4,5),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()(),e.TgZ(6,"div",3)(7,"chq-input",4,6),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()()(),e.TgZ(9,"div",2)(10,"div",3)(11,"chq-input",4,7),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()(),e.TgZ(13,"div",3),e.YNc(14,Rs,5,2,"div",8),e.YNc(15,Br,5,2,"div",8),e.qZA()(),e.TgZ(16,"div",2)(17,"div",9)(18,"chq-input",4,10),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()(),e.TgZ(20,"div",3),e.YNc(21,Do,4,2,"div",8),e.qZA()(),e.TgZ(22,"div",2)(23,"div",3)(24,"chq-input",4,11),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()(),e.TgZ(26,"div",3),e.YNc(27,In,6,4,"div",12),e.qZA()()(),e.TgZ(28,"div",13)(29,"div",14),e.YNc(30,Yr,1,1,"chq-input",15),e.qZA(),e.TgZ(31,"div",3)(32,"div",16),e._UZ(33,"chq-button",17)(34,"chq-button",18),e.qZA()()()()),2&t&&(e.xp6(4),e.Q6J("inputModel",n.formModel.operationType),e.xp6(3),e.Q6J("inputModel",n.formModel.operation),e.xp6(4),e.Q6J("inputModel",n.formModel.code),e.xp6(3),e.Q6J("ngIf",n.formData.operationType===n.OPERATION_TYPE.replace||n.formData.operationType===n.OPERATION_TYPE.painting),e.xp6(1),e.Q6J("ngIf",n.formData.operationType===n.OPERATION_TYPE.repair||n.formData.operationType===n.OPERATION_TYPE.removeAndRefit||n.formData.operationType===n.OPERATION_TYPE.polish||n.formData.operationType===n.OPERATION_TYPE.checkFields||n.formData.operationType===n.OPERATION_TYPE.performFields),e.xp6(3),e.Q6J("inputModel",n.formModel.repairType),e.xp6(3),e.Q6J("ngIf",n.formData.operationType===n.OPERATION_TYPE.replace||n.formData.operationType===n.OPERATION_TYPE.painting),e.xp6(3),e.Q6J("inputModel",n.formModel.information),e.xp6(3),e.Q6J("ngIf",n.formData.operationType===n.OPERATION_TYPE.replace),e.xp6(3),e.Q6J("ngIf",!(null!=n.operationToEdit&&n.operationToEdit.Id)),e.xp6(3),e.Q6J("buttonModel",n.resetButtonModel),e.xp6(1),e.Q6J("buttonModel",n.addButtonModel))},dependencies:[f.O5,Le.Hw,T._Y,T.JL,T.F,Mt.D,He.E,pe.X$],styles:[".estimate-add-operation[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{display:flex;justify-content:end}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]     button{width:195px}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{margin-right:15px}.estimate-add-operation[_ngcontent-%COMP%]   .save-operation[_ngcontent-%COMP%]{display:flex;align-items:center}.estimate-add-operation[_ngcontent-%COMP%]   .repair-type[_ngcontent-%COMP%]     .dropdown-wrapper   mat-icon{height:15px;width:15px}.estimate-add-operation[_ngcontent-%COMP%]     textarea{font-family:Inter,sans-serif;font-size:14px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .checkmark{height:20px;width:20px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .span-label{font-size:12px;color:#0b0e15;padding-left:10px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .checkmark:after{left:7px;top:2px;width:5px;height:9px}.estimate-add-operation[_ngcontent-%COMP%]   .information[_ngcontent-%COMP%]{border-radius:8px;border:1px solid var(--xa-blue);background:rgba(59,130,246,.35);box-shadow:0 2px 4px #0000000d;padding:7px 20px;display:flex;align-items:center}.estimate-add-operation[_ngcontent-%COMP%]   .information[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--xa-secondary);font-family:Inter;font-size:14px;font-style:normal;font-weight:400;line-height:18px;margin-left:20px}@media (orientation: portrait){.estimate-add-operation[_ngcontent-%COMP%]     .input-wrapper   label{max-width:100%}}.operation-content.edit-estimate[_ngcontent-%COMP%]{flex:1}.operation-content[_ngcontent-%COMP%]:not(.edit-estimate){height:calc(80vh - 186px);overflow:hidden;overflow-y:auto}"]}),a})();var So=k(7772);const Qr={columns:[{id:"Selection",width:"60px",header:{text:"",tooltip:"",style:"visibility: hidden"},selector:{field:"OperationGuid"},cellStyle:"justify-content:center;padding:0",widget:{type:"checkbox"}},{id:"Part",sortable:!1,header:{text:"part_operation",tooltip:""},selector:{field:"OperationName"},widget:{type:"text"}},{id:"Code",sortable:!1,selector:{field:"Code"},header:{text:"code",tooltip:""},widget:{type:"text"}},{id:"Information",sortable:!1,selector:{field:"Information"},header:{text:"information",tooltip:""},widget:{type:"text"}},{id:"RepairType",sortable:!1,selector:{field:"RepairServiceType"},header:{text:"repair_type",tooltip:""},widget:{type:"text"}},{id:"Price",sortable:!1,selector:{field:"Price"},header:{text:"Price",tooltip:""},widget:{type:"number"}},{id:"LabourTime",sortable:!1,selector:{field:"LabourTime"},header:{text:"labour_time",tooltip:"",style:""},cellStyle:"",widget:{type:"text"}},{id:"EditAction",width:"30px",sortable:!1,style:"border-right: 0",selector:{field:"OperationGuid"},header:{text:"",tooltip:"",style:"visibility: hidden"},cellStyle:"justify-content: center; border-right: 0",widget:{type:"icon",config:{svgIcon:"edit",style:"width: 18px; height: 18px;"}}},{id:"DeleteAction",width:"30px",sortable:!1,selector:{field:"OperationGuid"},header:{text:"",tooltip:"",style:"visibility: hidden"},cellStyle:"justify-content: center",widget:{type:"icon",config:{svgIcon:"delete",style:"fill: var(--xa-dark-red2) !important; width: 15px; height: 15px;"}}}]};var Io=k(63298);const Es=["operationTable"];function qs(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",10)(1,"chq-paginator",11,12),e.NdJ("paginationChange",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.handlePaginationChange(r))}),e.qZA()()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("pagination",t.pagination)}}function Zs(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div"),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"div",3),e.ynx(6),e.TgZ(7,"div",4),e._UZ(8,"chq-mat-table",5,6),e.qZA(),e.YNc(10,qs,3,1,"div",7),e.BQk(),e.qZA(),e.TgZ(11,"div",8)(12,"chq-button",9),e.NdJ("click",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.handleRefreshOperationList(r))}),e.qZA(),e.TgZ(13,"chq-button",9),e.NdJ("click",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.handleAddClick(r))}),e.qZA()()()}if(2&a){const t=e.oxw();e.xp6(3),e.AsE("",e.lcZ(4,11,"selected_operations"),": ",t.selectedRows.length,""),e.xp6(4),e.Q6J("ngClass",(null==t.tableData?null:t.tableData.length)>0&&t.pagination.count>t.pagination.pageSize?"height-with-pagination":"height-without-pagination"),e.xp6(1),e.Q6J("config",t.tableConfig)("tableData",t.tableData)("cellClicked",t.handleCellClick)("pageChanged",t.pageChanged)("i18n",t.i18n),e.xp6(2),e.Q6J("ngIf",(null==t.tableData?null:t.tableData.length)>0&&t.pagination.count>t.pagination.pageSize),e.xp6(2),e.Q6J("buttonModel",t.refreshButtonModel),e.xp6(1),e.Q6J("buttonModel",t.addButtonModel)}}let Vr=(()=>{class a{constructor(t,n,r){this.repairEstimateOperationService=t,this.monitorService=n,this.commonService=r,this.tableData=[],this.pageChanged=!1,this.selectedRows=[],this.pagination=So.G,this.showData=!1,this.configData=Qr,this.handleEditRow=new e.vpe,this.cancelDialog=new e.vpe,this.refreshButtonModel={label:"refresh",type:"outline",icon:""},this.addButtonModel={label:"add",type:"disabled",icon:""},this.handleCellClick=(s,d)=>{"Selection"===d.id?(-1!==this.selectedRows.indexOf(s[0]?.result?.value)?this.selectedRows.splice(this.selectedRows.indexOf(s[0]?.result?.value),1):this.selectedRows.push(s[0]?.result?.value),this.monitorService.logEvent("handleCellClick",["OperationListComponent","addenda-repair"],{selectedRows:this.selectedRows}),this.changeAddButtonState()):"DeleteAction"===d.id?this.deleteRow(s[0]?.result?.value):"EditAction"===d.id&&this.editRow(s[0]?.result?.value)},this.changeAddButtonState=()=>{this.addButtonModel.type=this.selectedRows.length>0?"primary":"disabled"},this.handleRefreshOperationList=s=>{this.selectedRows=[],this.operationTable?.selection?.clear(),this.getOperations()},this.handleAddClick=s=>{0!==this.selectedRows.length&&(this.monitorService.logEvent("handleAddClick",["OperationListComponent","addenda-repair"],{repairId:this.repairId,operationds:this.selectedRows}),this.commonService.showLoading(),this.repairEstimateOperationService.addOperationsToReapir(this.repairId,this.selectedRows).subscribe({next:d=>{d&&this.cancelDialog.emit(!0),this.commonService.hideLoading()},error:d=>{this.commonService.hideLoading(),this.monitorService.logException(d,_e._.Error)}}))},this.i18n=this.commonService.geti18nInfo()}ngOnInit(){this.monitorService.logEvent("ngOnInit",["OperationListComponent","addenda-repair"]),this.tableConfig=this.configData,this.showData=!1,this.pagination={...this.pagination,pageSize:10,count:0,currentPage:a.currentPage,orderBy:"Id",sortDirection:"desc"},this.getOperations()}getOperations(){var t=this;return(0,ue.Z)(function*(){return t.commonService.showLoading(),t.monitorService.logEvent("getOperations",["OperationListComponent","addenda-repair"]),(0,Ee.z)(t.repairEstimateOperationService.getOperations(t.pagination)).then(n=>{n.value&&(t.tableData=n.value,t.showData=!0,t.pagination={...t.pagination,count:n["@odata.count"]},t.changeAddButtonState(),setTimeout(()=>{const r=[];t.selectedRows.forEach(s=>{n.value.find(u=>u.OperationGuid==s)&&r.push({id:"Selection",result:{value:s}})}),r.length>0&&t.operationTable.selectMultiple(r)})),t.commonService.hideLoading()}).catch(n=>{t.commonService.hideLoading(),t.monitorService.logException(n,_e._.Error)})})()}handlePaginationChange(t){const n={pageSize:t.pageSize,offset:t.offset,currentPage:t.currentPage};this.pagination.currentPage=t.currentPage,this.pagination={...this.pagination,...n},this.pageChanged=!0,this.getOperations()}deleteRow(t){this.commonService.openDeleteDialog().afterClosed().subscribe(n=>{n&&(this.commonService.showLoading(),this.monitorService.logEvent("deleteRow",["OperationListComponent","addenda-repair"],{selectedRows:this.selectedRows}),(0,Ee.z)(this.repairEstimateOperationService.deleteOperation(t)).then(r=>{r?.message&&this.commonService.showInfoToast(5e3,r.message),-1!==this.selectedRows.indexOf(t)&&this.selectedRows.splice(this.selectedRows.indexOf(t),1),this.getOperations()}).catch(r=>{this.commonService.hideLoading(),this.monitorService.logException(r,_e._.Error)}))})}editRow(t){if(t){const n=this.tableData.find(r=>r.OperationGuid==t);n&&this.handleEditRow.emit(n)}}}return a.currentPage=1,a.\u0275fac=function(t){return new(t||a)(e.Y36(Ii),e.Y36(we.M),e.Y36(be.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-operation-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(Es,5),2&t){let r;e.iGM(r=e.CRH())&&(n.operationTable=r.first)}},inputs:{repairId:"repairId"},outputs:{handleEditRow:"handleEditRow",cancelDialog:"cancelDialog"},decls:1,vars:1,consts:[["class","h-100 fx-col",4,"ngIf"],[1,"h-100","fx-col"],[1,"selected-operations"],[1,"table-container"],[1,"table-wrapper",3,"ngClass"],[3,"config","tableData","cellClicked","pageChanged","i18n"],["operationTable",""],["class","pagination-wrapper",4,"ngIf"],[1,"footer-button"],[3,"buttonModel","click"],[1,"pagination-wrapper"],[3,"pagination","paginationChange"],["paginator",""]],template:function(t,n){1&t&&e.YNc(0,Zs,14,13,"div",0),2&t&&e.Q6J("ngIf",n.showData)},dependencies:[f.mk,f.O5,Io.B,He.E,So.l,pe.X$],styles:[".table-container[_ngcontent-%COMP%]   .height-with-pagination[_ngcontent-%COMP%]{height:calc(90vh - 283px);overflow:auto}.table-container[_ngcontent-%COMP%]   .height-without-pagination[_ngcontent-%COMP%]{height:calc(90vh - 244px);overflow:auto}.table-container[_ngcontent-%COMP%]     thead{position:sticky;top:0;z-index:1}.table-container[_ngcontent-%COMP%]     mat-cell:first-of-type, .table-container[_ngcontent-%COMP%]     mat-header-cell:first-of-type, .table-container[_ngcontent-%COMP%]     mat-footer-cell:first-of-type{padding-left:0!important}.footer-button[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px}.footer-button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{margin-right:20px}.selected-operations[_ngcontent-%COMP%]{font-size:14px;line-height:20px;color:var(--xa-dark-gray);padding-bottom:11px;text-align:end}"]}),a})();const Fs=[{name:"Front",displayName:"Front",image:"assets/img/part-front.png",title:"",subTitle:"",active:!0},{name:"Right Side",displayName:"Right Side",image:"assets/img/part-right.png",title:"",subTitle:""},{name:"Left Side",displayName:"Left Side",image:"assets/img/part-left.png",title:"",subTitle:""},{name:"Above",displayName:"Above",image:"assets/img/part-above.png",title:"",subTitle:""},{name:"Rear",displayName:"Rear",image:"assets/img/part-rear.png",title:"",subTitle:""},{name:"Interior",displayName:"Interior",image:"assets/img/part-interior.png",title:"",subTitle:""},{name:"Mechanical",displayName:"Mechanical",image:"assets/img/part-mechanical.png",title:"",subTitle:""}],Us=["operationType"];let Js=(()=>{class a{constructor(){this.formData={operationType:"",operation:"",code:"",repairType:"",quantity:0,price:0,labourTime:0,labourAmount:0},this.addButtonModel={label:"Add",type:"disabled",icon:"",onclick:this.submitForm.bind(this)},this.resetButtonModel={label:"Reset",type:"outline",icon:"",onclick:this.resetForm.bind(this)},this.menuItems=Fs}ngOnInit(){this.formModel={operationType:{placeHolder:"Select Operation Type",name:"operationType",label:"Operation Type",options:[{id:1,name:"Check"}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"operationType",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"Please select operation type":""}},operation:{placeHolder:"Part/Operation",label:"part/operation",name:"operation",options:[{id:1,name:"Top-Section M"}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"operation",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"Please enter part/operation":""}},code:{placeHolder:"Code",label:"Code",name:"code",value:"",type:"text",maxLength:50,validation:{name:"code",validationFunction:()=>T.kI.compose([T.kI.maxLength(50),T.kI.pattern(/^[a-z\d\s]+$/i)]),validationMessage:a=>a.maxlength?"Code should have not more than 50 characters":a.pattern?"Only alphanumberic characters are allowed":""}},repairType:{placeHolder:"Select Repair type",name:"repairType",label:"REPAIR TYPE",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:""},quantity:{placeHolder:"Quantity",label:"Quantity",name:"quantity",value:"",type:"number",validation:{name:"quantity",validationFunction:()=>T.kI.compose([]),validationMessage:a=>""}},price:{placeHolder:"Price",label:"Price",name:"price",value:"",type:"number",validation:{name:"price",validationFunction:()=>T.kI.compose([]),validationMessage:a=>""}},labourTime:{placeHolder:"Labour Time",name:"labourTime",label:"Labour time(HOURs)",value:0,type:"number",validation:{name:"time",validationFunction:()=>T.kI.compose([]),validationMessage:a=>""}}}}submitForm(){}resetForm(t=!0){}hideDropdown(t){t===this.formModel.operationType.name&&this.operationType?.closeDropdown()}onFormUpdate(t){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-part-add"]],viewQuery:function(t,n){if(1&t&&e.Gf(Us,5),2&t){let r;e.iGM(r=e.CRH())&&(n.operationType=r.first)}},decls:32,vars:11,consts:[[1,"estimate-add-part","fx-col","h-100"],[1,"toolbar"],[3,"mode","menuItems"],["tabs",""],[1,"fx-1"],[1,"row"],[1,"col-6"],[3,"inputModel","clicked","controlOutput"],["operationType",""],["operationControl",""],["codeControl",""],[1,"col-6",3,"inputModel","clicked","controlOutput"],[1,"col-6","repair-type"],[1,"footer-button","fx-row","justify-end"],[1,"reset-button",3,"buttonModel"],[3,"buttonModel"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"chq-tabs",2,3),e.qZA(),e.TgZ(4,"form",4)(5,"div",5)(6,"div",6)(7,"chq-input",7,8),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()(),e.TgZ(9,"div",6)(10,"chq-input",7,9),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()()(),e.TgZ(12,"div",5)(13,"div",6)(14,"chq-input",7,10),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()(),e.TgZ(16,"div",6)(17,"div",5)(18,"chq-input",11),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA(),e.TgZ(19,"chq-input",11),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()()()(),e.TgZ(20,"div",5)(21,"div",12)(22,"chq-input",7),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()(),e.TgZ(23,"div",6)(24,"div",5)(25,"chq-input",11),e.NdJ("clicked",function(s){return n.hideDropdown(s)})("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()()()()(),e.TgZ(26,"div",5),e._UZ(27,"div",6),e.TgZ(28,"div",6)(29,"div",13),e._UZ(30,"chq-button",14)(31,"chq-button",15),e.qZA()()()()),2&t&&(e.xp6(2),e.Q6J("mode","default")("menuItems",n.menuItems),e.xp6(5),e.Q6J("inputModel",n.formModel.operationType),e.xp6(3),e.Q6J("inputModel",n.formModel.operation),e.xp6(4),e.Q6J("inputModel",n.formModel.code),e.xp6(4),e.Q6J("inputModel",n.formModel.quantity),e.xp6(1),e.Q6J("inputModel",n.formModel.price),e.xp6(3),e.Q6J("inputModel",n.formModel.repairType),e.xp6(3),e.Q6J("inputModel",n.formModel.labourTime),e.xp6(5),e.Q6J("buttonModel",n.resetButtonModel),e.xp6(1),e.Q6J("buttonModel",n.addButtonModel))},dependencies:[T._Y,T.JL,T.F,Mt.D,He.E,Zr.K],styles:[".estimate-add-part[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{margin-bottom:20px}.estimate-add-part[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   chq-tabs[_ngcontent-%COMP%]     button{flex-direction:column;height:45px;gap:0px;font-size:12px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{gap:15px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:195px}"]}),a})();function ko(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",8)(1,"chq-tabs",9),e.NdJ("menuItemClick",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onMenuItemClick(r))}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("mode","button")("menuItems",t.menuItems)}}function Gs(a,c){1&a&&(e.ynx(0),e._UZ(1,"app-part-add"),e.BQk())}function Bs(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-operation-add",10),e.NdJ("cancelDialog",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.cancelDialog(r))})("switchToOperationLIst",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.switchToOperationList())}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("operationToEdit",t.operationToEdit)("repairId",t.data.repairId)}}function Ys(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-operation-list",11),e.NdJ("handleEditRow",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.switchToEditOperation(r))})("cancelDialog",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.cancelDialog(r))}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("repairId",t.data.repairId)}}let Ao=(()=>{class a{constructor(t,n,r){this.data=t,this.dialogRef=n,this.monitorService=r,this.menuItems=[...un.HT],this.operationToEdit={},this.editrepairEstimateOperation=!1}cancelDialog(t){this.dialogRef.close(t)}ngOnInit(){this.monitorService.logEvent("ngOnInit",["RepairEstimateOperationComponent","addenda-repair"]),this.menuItems[0].active=!0,this.activeMenu=this.menuItems[0].name,this.data?.operationDetails&&(this.operationToEdit=this.data.operationDetails,this.editrepairEstimateOperation=!0,this.onMenuItemClick(this.menuItems[0]))}onMenuItemClick(t){this.menuItems.forEach(r=>r.active=!1);const n=this.menuItems.findIndex(r=>r.name==t.name);this.menuItems[n].active=!0,this.activeMenu=this.menuItems[n].name,"create-parts-operations"!==this.activeMenu&&(this.operationToEdit={})}switchToEditOperation(t){this.operationToEdit=t,this.onMenuItemClick(this.menuItems[0])}switchToOperationList(){this.onMenuItemClick(this.menuItems[1])}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(xe.WI),e.Y36(xe.so),e.Y36(we.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-repair-estimate-operation"]],decls:13,vars:8,consts:[[1,"operation-container","fx-col"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content","fx-col","fx-1"],["class","content-header",4,"ngIf"],[1,"content-body","fx-1"],[4,"ngIf"],[1,"content-header"],[3,"mode","menuItems","menuItemClick"],[3,"operationToEdit","repairId","cancelDialog","switchToOperationLIst"],[3,"repairId","handleEditRow","cancelDialog"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2)(6,"mat-icon",3),e.NdJ("click",function(){return n.cancelDialog(!1)}),e.qZA()()(),e.TgZ(7,"div",4),e.YNc(8,ko,2,2,"div",5),e.TgZ(9,"div",6),e.YNc(10,Gs,2,0,"ng-container",7),e.YNc(11,Bs,2,2,"ng-container",7),e.YNc(12,Ys,2,1,"ng-container",7),e.qZA()()()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,6,"operation")),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(2),e.Q6J("ngIf",!n.editrepairEstimateOperation),e.xp6(2),e.Q6J("ngIf","add-parts"===n.activeMenu),e.xp6(1),e.Q6J("ngIf","create-parts-operations"===n.activeMenu),e.xp6(1),e.Q6J("ngIf","operation-list"===n.activeMenu))},dependencies:[f.O5,Le.Hw,Zr.K,zr,Vr,Js,pe.X$],styles:[".operation-container[_ngcontent-%COMP%]{height:calc(90vh - 40px);overflow:auto;padding:20px}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:flex-end;display:flex;cursor:pointer}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:36px!important;width:36px!important;background:var(--xa-black);border-radius:50%;text-align:center}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg   path{fill:var(--xa-white)}.operation-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:15px}.operation-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]{margin-bottom:15px}.operation-container[_ngcontent-%COMP%]     button{font-family:Inter,sans-serif}"]}),a})();var Hs=k(14368),X=k(83853),le=k(85567);const zs=["code"],Qs=["phone"];function Vs(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",15)(2,"chq-input",16),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()()}if(2&a){const t=e.oxw();e.xp6(2),e.Q6J("inputModel",t.emailForm.email)}}function js(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",17)(2,"chq-input",18,19),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA(),e.TgZ(4,"chq-input",16,20),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()()}if(2&a){const t=e.oxw();e.xp6(2),e.Q6J("inputModel",t.emailForm.code),e.xp6(2),e.Q6J("inputModel",t.emailForm.phone)}}function Ks(a,c){if(1&a&&(e.TgZ(0,"div",8)(1,"label",9),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"label",21),e.qZA()),2&a){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"subject")," "),e.xp6(2),e.Q6J("innerHTML",t.data.emailSubject,e.oJD)}}function Ws(a,c){1&a&&(e.TgZ(0,"div",22)(1,"label",23),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",24)(6,"label"),e._uU(7,"Repair Estimate"),e.qZA(),e.TgZ(8,"div",25),e._UZ(9,"mat-icon",3),e.qZA()()()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,2,e.lcZ(4,4,"attachments"))," "),e.xp6(7),e.Q6J("svgIcon","pdf-file"))}let jr=(()=>{class a{constructor(t,n,r,s,d){this.dialogRef=t,this.monitorService=n,this.coreService=r,this.commonService=s,this.data=d,this.emailRequest={subject:"",email:[],message:"",phone:"",code:""},this.step={},this.emailForm={subject:{placeHolder:"subject",label:"subject",name:"subject",value:0,type:"text",validation:{name:"subject",validationFunction:()=>T.kI.compose([T.kI.required,T.kI.maxLength(100)]),validationMessage:u=>u.required?"send_message":u.maxlength?"subject_length":""}},email:{label:"email_address",name:"email",placeHolder:"email_address",value:"",type:"text",required:!0,validation:{name:"email",validationFunction:()=>T.kI.compose([T.kI.required,(0,X.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:u=>u.required?"email_required":u.invalidEmailNumber?"email_invalid_number":u.invalidEmail?"email_valid":""}},code:{placeHolder:"select_dot",label:"code",name:"code",value:91,showImageFlag:!0,type:"select",selectedOption:{phoneCountryCode:"+91"},displayValue:"phoneCountryCode",fieldValue:"phoneCountryCode",options:[{label:"+90"},{label:"+971"},{label:"+977"}],required:!0,validation:{name:"driverCode",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:u=>u.required?"required_code":""}},phone:{placeHolder:"mobile_number",label:"mobile_number",name:"phone",value:0,type:"number",required:!0,validation:{name:"driverPhone",validationFunction:()=>T.kI.compose([T.kI.required,T.kI.pattern("^[0-9]+[0-9 ,.'-]+$")]),validationMessage:u=>u.required?"required_mobile_number":u.pattern?"valid_mobile_number":""}}},this.selectedCode=""}onFormUpdate(t){this.emailRequest[t.name]=!!t.isValid&&("email"===t.name?t.value?.split(",")||[]:t.value),"code"===t.name&&this.selectedCode!==t.value.phoneCountryCode&&(this.phone?.updateCurrentValidation(t.value.regExpression),this.selectedCode=t.value.phoneCountryCode,this.emailForm.code={...this.emailForm.code,selectedOption:t.value},this.emailForm.phone.value=""),this.sendButton="email"===this.data.channel?this.emailRequest.email?{...this.sendButton,type:"primary"}:{...this.sendButton,type:"disabled"}:this.emailRequest.phone&&this.emailForm.code.selectedOption?{...this.sendButton,type:"primary"}:{...this.sendButton,type:"disabled"}}cancel(){this.monitorService.logEvent("send",["EmailDialogComponent","addenda"]),this.dialogRef.close()}send(){let t;this.monitorService.logEvent("send",["EmailDialogComponent","addenda"]),t="email"===this.data.channel?{toEmails:this.emailRequest.email,communicationTypeIds:[2],templateKey:"EstimateApprovalRequest"}:"whatsapp"===this.data.channel?{messageContent:btoa(this.data.body),PhoneNumber:`${this.emailForm.code.selectedOption.phoneCountryCode}${this.emailRequest.phone}`,communicationTypeIds:[1],templateKey:"EstimateApprovalRequest"}:{messageContent:btoa(this.data.body),PhoneNumber:`${this.emailForm.code.selectedOption.phoneCountryCode}${this.emailRequest.phone}`,communicationTypeIds:[3],templateKey:"EstimateApprovalRequest"},this.dialogRef.close(t)}setMessageHTML(t){this.emailRequest.message=btoa(t)}ngOnInit(){this.monitorService.logEvent("ngOnInit",["EmailDialogComponent","addenda"]),this.emailForm.code?.observable||(this.emailForm.code.observable=this.coreService.getPhoneNumber(),this.emailForm.code.onObservableLoad=this.onObservableLoad.bind(this)),this.data.email&&(this.emailForm.email={...this.emailForm.email,value:this.data.email},this.emailRequest={...this.emailRequest,email:[this.data.email]}),this.sendButton={label:"send",type:"disabled",icon:"send",onclick:this.send.bind(this)},this.emailForm.code.selectedOption[this.emailForm.code.displayValue]=this.data.code,this.emailForm.phone={...this.emailForm.phone,value:this.data.phone},this.sendButton="email"===this.data.channel?this.emailRequest.email?{...this.sendButton,type:"primary"}:{...this.sendButton,type:"disabled"}:this.emailRequest.phone&&this.emailForm.code.selectedOption?{...this.sendButton,type:"primary"}:{...this.sendButton,type:"disabled"}}onObservableLoad(t){if(this.commonService.hideLoading(),t&&t&&t.length>0){const n=t.filter(r=>r.phoneCountryCode===this.emailForm.code.selectedOption?.phoneCountryCode);if(n.length>0){const r=n[0],s=r.regExpression;this.emailForm.code={...this.emailForm.code,selectedOption:r},this.phone&&this.phone.updateCurrentValidation(s,!0)}}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(xe.so),e.Y36(we.M),e.Y36(le.p),e.Y36(be.v),e.Y36(xe.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["request-approval-dialog"]],viewQuery:function(t,n){if(1&t&&(e.Gf(zs,5),e.Gf(Qs,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.code=r.first),e.iGM(r=e.CRH())&&(n.phone=r.first)}},decls:20,vars:13,consts:[[1,"dialog-container"],[1,"header"],[1,"close-icon",3,"click"],[3,"svgIcon"],["mat-dialog-content","",1,"email-dialog-body"],[1,"form-container"],["class","input-wrapper",4,"ngIf"],["class","input-wrapper label-wrapper",4,"ngIf"],[1,"input-wrapper","label-wrapper"],[1,"title"],[1,"message-content",3,"innerHTML"],["class","attachment-list",4,"ngIf"],[1,"btn-container"],[1,"right",3,"buttonModel"],[1,"input-wrapper"],[1,"div-wrapper"],[3,"inputModel","controlOutput"],[1,"div-wrapper","fx-row",2,"gap","10px"],[2,"width","115px",3,"inputModel","controlOutput"],["code",""],["phone",""],[3,"innerHTML"],[1,"attachment-list"],[1,"attachment-header"],[1,"files"],[1,"attachment-icon"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2),e.NdJ("click",function(){return n.cancel()}),e._UZ(6,"mat-icon",3),e.qZA()(),e.TgZ(7,"div",4)(8,"div",5),e.YNc(9,Vs,3,1,"div",6),e.YNc(10,js,6,2,"div",6),e.YNc(11,Ks,5,4,"div",7),e.TgZ(12,"div",8)(13,"label",9),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"label",10),e.qZA()(),e.YNc(17,Ws,10,6,"div",11),e.qZA(),e.TgZ(18,"div",12),e._UZ(19,"chq-button",13),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,9,n.data.title)),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(3),e.Q6J("ngIf","email"===(null==n.data?null:n.data.channel)),e.xp6(1),e.Q6J("ngIf","email"!==(null==n.data?null:n.data.channel)),e.xp6(1),e.Q6J("ngIf","email"===(null==n.data?null:n.data.channel)&&n.data.emailSubject),e.xp6(3),e.hij("",e.lcZ(15,11,"message")," "),e.xp6(2),e.Q6J("innerHTML",n.data.body,e.oJD),e.xp6(1),e.Q6J("ngIf","email"===(null==n.data?null:n.data.channel)),e.xp6(2),e.Q6J("buttonModel",n.sendButton))},dependencies:[f.O5,Le.Hw,xe.xY,Mt.D,He.E,f.gd,pe.X$],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--xa-popup-light-gray)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:30px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-bottom:24px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:first-child{text-transform:uppercase;font-size:12px;line-height:14px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{display:flex;gap:8px;flex-direction:column}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;line-height:14px;font-weight:400}.dialog-container[_ngcontent-%COMP%]   .email-dialog-body[_ngcontent-%COMP%]{max-height:calc(90vh - 174px)!important;padding:0 30px!important}.dialog-container[_ngcontent-%COMP%]   .attachment-list[_ngcontent-%COMP%]{margin-bottom:24px}.toggle-wrapper[_ngcontent-%COMP%]{margin-top:22px;font-weight:400;font-size:12px;color:var(--xa-neutral-black);display:flex;gap:10px;align-items:center;line-height:14px}.files[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:5px 0;align-items:center}.files[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-black);font-size:14px;font-weight:500;line-height:14px}.files[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-red)!important}.attachment-icon[_ngcontent-%COMP%]{gap:26px;display:flex}.attachment-header[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:12px}.cc-span[_ngcontent-%COMP%]{position:absolute;right:10px;font-size:16px;line-height:14px;top:44px;color:var(--xa-black-medium);cursor:pointer}.message[_ngcontent-%COMP%]{font-weight:500;color:var(--xa-black-dark);font-size:14px;line-height:14px;margin-bottom:18px;display:flex}.div-wrapper[_ngcontent-%COMP%]{position:relative}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;padding:0 30px 30px;background:var(--xa-popup-light-gray)}.cc-email[_ngcontent-%COMP%]     input{padding-right:36px!important}.message-content[_ngcontent-%COMP%]{font-size:16px!important;font-weight:400;line-height:20px!important;color:var(--xa-black)}  .message-content td{border-radius:5px!important;padding:5px!important}  .message-content a{color:#fff!important;text-decoration:none!important;pointer-events:none!important}"]}),a})();function $s(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",10)(1,"chq-input",11),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("inputModel",t.notesModel)}}const Ae=function(a){return{selected:a}};let Kr=(()=>{class a{constructor(t,n,r,s,d){this.commonService=t,this.bookingService=n,this.route=r,this.data=s,this.dialogRef=d,this.approveRadio={placeHolder:"approve",label:"approve",name:"approve",idField:"",value:"1",type:"radio",hideLabel:!0,options:[{label:"approve",id:1}]},this.notesModel={placeHolder:"let_us_know_issue",label:"notes",name:"notes",value:"",type:"textarea",maxLength:300,rows:4},this.repairId="",this.urlToken="",this.checkedStatus="",this.reason="",this.declineRadio={placeHolder:"decline",label:"decline",name:"decline",idField:"",value:"2",type:"radio",hideLabel:!0,options:[{label:"decline",id:2}]},this.cancelButtonModel={label:"cancel",type:"outline"},this.nextButtonModel={label:"confirm",type:"disabled"}}cancel(){this.dialogRef.close(!1)}updateRepairStatus(){const t="Approved"===this.checkedStatus?"Approved":"Rejected";this.commonService.showLoading(),this.bookingService.updateRepairStatus(t,this.repairId,this.reason.trim()).subscribe({next:()=>{this.dialogRef.close(!0),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}ngOnInit(){this.repairId=this.data,console.log(this.repairId),this.nextButtonModel={...this.nextButtonModel,onclick:this.updateRepairStatus.bind(this)},this.cancelButtonModel={...this.cancelButtonModel,onclick:this.cancel.bind(this)}}onFormUpdate(t){const{name:n,value:r}=t;"approve"===n?2!==this.declineRadio.value&&r&&(this.checkedStatus="Approved",this.nextButtonModel={...this.nextButtonModel,type:"primary"},this.declineRadio={...this.declineRadio,value:""}):"decline"===n?1!==this.approveRadio.value&&r&&(this.checkedStatus="declined",this.reason.trim()&&(this.nextButtonModel={...this.nextButtonModel,type:"primary"}),this.approveRadio={...this.approveRadio,value:""}):"notes"===n&&(this.reason=r,this.nextButtonModel=this.checkedStatus&&"declined"===this.checkedStatus&&this.reason.trim()?{...this.nextButtonModel,type:"primary"}:{...this.nextButtonModel,type:"disabled"})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(be.v),e.Y36(Dt.q),e.Y36(ye.gz),e.Y36(xe.WI),e.Y36(xe.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-estimate-approval"]],decls:26,vars:25,consts:[[1,"approval-form"],[1,"wrapper"],[1,"wrapper-header"],[1,"radio-container"],[1,"radio-wrapper",3,"ngClass"],["aria-hidden","false","aria-label","edit icon",3,"svgIcon"],[1,"company-input","col-3",3,"inputModel","controlOutput"],["class","content",4,"ngIf"],[1,"button-container"],[3,"buttonModel"],[1,"content"],["tabindex","-1",3,"inputModel","controlOutput"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"div",3)(10,"div",4),e._UZ(11,"mat-icon",5),e.TgZ(12,"label"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"chq-input",6),e.NdJ("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()(),e.TgZ(16,"div",4),e._UZ(17,"mat-icon",5),e.TgZ(18,"label"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"chq-input",6),e.NdJ("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()()(),e.YNc(22,$s,2,1,"div",7),e.TgZ(23,"div",8),e._UZ(24,"chq-button",9)(25,"chq-button",9),e.qZA()()()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,13,"approve_or_decline_the_request")),e.xp6(3),e.Oqu(e.lcZ(8,15,"select_approve/reject_option")),e.xp6(3),e.Q6J("ngClass",e.VKq(21,Ae,"Approved"===n.checkedStatus)),e.xp6(1),e.Q6J("svgIcon","check"),e.xp6(2),e.Oqu(e.lcZ(14,17,"approve")),e.xp6(2),e.Q6J("inputModel",n.approveRadio),e.xp6(1),e.Q6J("ngClass",e.VKq(23,Ae,"declined"===n.checkedStatus)),e.xp6(1),e.Q6J("svgIcon","cross"),e.xp6(2),e.Oqu(e.lcZ(20,19,"decline")),e.xp6(2),e.Q6J("inputModel",n.declineRadio),e.xp6(1),e.Q6J("ngIf","declined"===n.checkedStatus),e.xp6(2),e.Q6J("buttonModel",n.cancelButtonModel),e.xp6(1),e.Q6J("buttonModel",n.nextButtonModel))},dependencies:[f.mk,f.O5,Le.Hw,Mt.D,He.E,pe.X$],styles:[".approval-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;background:var(--xa-popup-light-gray)}.approval-form[_ngcontent-%COMP%]   .approval-header[_ngcontent-%COMP%]{display:flex;gap:40px;justify-content:flex-start;position:fixed;top:0;align-items:center}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{align-self:center;display:flex;gap:28px;flex-direction:column;align-items:center;padding:30px;border-radius:10px;width:calc(100% - 60px)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:28px;width:100%}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;font-weight:400;line-height:18px}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]{display:flex;gap:20px;width:100%;justify-content:center}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]{display:flex;padding:17px 33px;flex-direction:column;justify-content:center;align-items:center;gap:4px;border-radius:8px;border:1px solid var(--xa-light-gray)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{padding:10px 12px}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:18px;font-size:13px;color:var(--xa-black-dark)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background:var(--xa-white);border:none}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;gap:10px;width:100%}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{flex:1}.approval-form[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.approval-form[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}"]}),a})();var E=k(71764),Ai=k(87855),Ri=k(35493),et=k(56785),Wr=k(21937),Ro=k(8851),$r=k(72076),kn=k(22406);function Xr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",7)(1,"chq-estimate-details",8),e.NdJ("iconClicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.handleIconClicked(r))})("downloadPdf",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.downloadPdf())}),e.qZA()()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("estimateResponse",t.estimateResponse)("editEstimate",t.editEstimate)("estimateSource",t.estimateSource)("i18n",t.i18n)}}function ea(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"chq-button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handleSaveEditedEstimate())}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("buttonModel",t.saveEditedModel)}}function tt(a,c){if(1&a&&e._UZ(0,"chq-button",17),2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.cancelButtonModel)}}function Xs(a,c){if(1&a&&(e.ynx(0),e.YNc(1,tt,1,1,"chq-button",16),e.BQk()),2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.showDelete)}}function lt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.handleEditEstimate())}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("buttonModel",t.editEstimateModel)}}function el(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(4);return e.KtG(r.handleRequestStatus())}),e.qZA()}if(2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.requestStatusModel)}}function ta(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-dropdown",19),e.NdJ("selected",function(r){e.CHM(t);const s=e.oxw(4);return e.KtG(s.handleSelectedOption(r))}),e.qZA()}if(2&a){const t=e.oxw(4);e.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function $t(a,c){if(1&a&&(e.ynx(0),e.YNc(1,el,1,1,"chq-button",15),e.YNc(2,ta,1,1,"chq-dropdown",18),e.BQk()),2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&t.repairNotInvoiced()),e.xp6(1),e.Q6J("ngIf",(null==t.communications?null:t.communications.length)>0&&t.repairNotInvoiced()&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0)}}function Li(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.openOperationPopup())}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("buttonModel",t.addOperationModel)}}function Lo(a,c){if(1&a&&(e.ynx(0,13),e.YNc(1,Xs,2,1,"ng-container",14),e.YNc(2,lt,1,1,"chq-button",15),e.YNc(3,$t,3,2,"ng-container",14),e.YNc(4,Li,1,1,"chq-button",15),e.BQk()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("chqPermission","newBooking"),e.xp6(1),e.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&(null==t.repairStatus?null:t.repairStatus.toLowerCase())!=="PendingApproval".toLowerCase()&&t.repairNotInvoiced()),e.xp6(1),e.Q6J("chqPermission","newBooking"),e.xp6(1),e.Q6J("ngIf","GTMotive"!==t.estimateSource&&(null==t.repairStatus?null:t.repairStatus.toLowerCase())!=="PendingApproval".toLowerCase()&&t.repairNotInvoiced())}}function me(a,c){if(1&a&&(e.TgZ(0,"div",9),e.YNc(1,ea,2,1,"ng-container",10),e.YNc(2,Lo,5,4,"ng-container",11),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.editEstimate),e.xp6(1),e.Q6J("ngIf",!t.editEstimate)}}function Xt(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"chq-button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handleSaveEditedEstimate())}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("buttonModel",t.saveEditedModel)}}function Eo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-dropdown",19),e.NdJ("selected",function(r){e.CHM(t);const s=e.oxw(4);return e.KtG(s.handleSelectedOption(r))}),e.qZA()}if(2&a){const t=e.oxw(4);e.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function tl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(5);return e.KtG(r.handleRequestStatus())}),e.qZA()}if(2&a){const t=e.oxw(5);e.Q6J("buttonModel",t.requestStatusModel)}}function qo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-dropdown",19),e.NdJ("selected",function(r){e.CHM(t);const s=e.oxw(5);return e.KtG(s.changeCaseStatusDialog(r))}),e.qZA()}if(2&a){const t=e.oxw(5);e.Q6J("dropdownModel",t.dropdownModelFilter)}}function nl(a,c){if(1&a&&(e.ynx(0),e.YNc(1,tl,1,1,"chq-button",15),e.YNc(2,qo,1,1,"chq-dropdown",18),e.BQk()),2&a){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf","pendingapproval"===(null==t.repairStatus?null:t.repairStatus.toLowerCase())&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&t.repairNotInvoiced()),e.xp6(1),e.Q6J("ngIf","pendingapproval"!==(null==t.repairStatus?null:t.repairStatus.toLowerCase())&&"complete"!==(null==t.repairStatus?null:t.repairStatus.toLowerCase()))}}function il(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Eo,1,1,"chq-dropdown",18),e.YNc(2,nl,3,2,"ng-container",14),e.BQk()),2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.repairNotInvoiced()&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0),e.xp6(1),e.Q6J("chqPermission","newBooking")}}function ol(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(4);return e.KtG(r.openOperationPopup())}),e.qZA()}if(2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.addOperationModel)}}function na(a,c){if(1&a&&e.YNc(0,ol,1,1,"chq-button",15),2&a){const t=e.oxw(3);e.Q6J("ngIf","GTMotive"!==t.estimateSource)}}function Ei(a,c){if(1&a&&(e.ynx(0),e.YNc(1,il,3,2,"ng-container",21),e.YNc(2,na,1,1,"ng-template",null,22,e.W1O),e.BQk()),2&a){const t=e.MAs(3),n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==n.estimateResponse||null==n.estimateResponse.estimateCharges?null:n.estimateResponse.estimateCharges.length)>0)("ngIfElse",t)}}function An(a,c){if(1&a&&(e.TgZ(0,"div",20),e.YNc(1,Xt,2,1,"ng-container",10),e.YNc(2,Ei,4,2,"ng-container",10),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.editEstimate),e.xp6(1),e.Q6J("ngIf",!t.editEstimate)}}let rl=(()=>{class a{constructor(t,n,r,s,d,u,v,P,y,w,D,q){this.commonService=t,this.repairEstimateService=n,this.route=r,this.dialog=s,this.bookingService=d,this.translationService=u,this.repairEstimateOperationService=v,this.monitorService=P,this.messageService=y,this.calendarService=w,this.router=D,this.notifyService=q,this.editEstimateModel={label:"edit_estimate",type:"outline",icon:"edit"},this.requestStatusModel={label:"self_approval",type:"outline",icon:"clock-new"},this.addOperationModel={label:"add_operation",type:"outline",icon:"plus"},this.bookInModel={label:"book_in",type:"primary",icon:""},this.saveEditedModel={label:"done",type:"primary",icon:""},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.showData=!1,this.editEstimate=!1,this.caseGuid="",this.repairStatus="",this.communications=[],this.email="",this.repairGuid="",this.repairId="",this.estimateSource="",this.repairNumber="",this.claimNumber="",this.organizationEmail="",this.organizationPhone="",this.organizationCountryCode="",this.organizationName="",this.dropdownModelFilter={options:[],placeHolder:this.translationService.instant("options"),label:"",appearance:"button",placeHolderIcon:"settings",name:"option",displayValue:"label",selectedOption:{}},this.communicationChannels=[{},{dropdownItemIcon:"whatsapp",color:"var(xa-white) !important;",label:this.translationService.instant("whatsapp")},{dropdownItemIcon:"email",color:"var(xa-white) !important;",label:this.translationService.instant("email")},{dropdownItemIcon:"sms",color:"var(xa-white) !important;",label:this.translationService.instant("sms")}],this.dropdownApprovalModelFilter={options:[{dropdownItemIcon:"whatsapp",color:"var(xa-white) !important;",label:this.translationService.instant("whatsapp")},{dropdownItemIcon:"email",color:"var(xa-white) !important;",label:this.translationService.instant("email")},{dropdownItemIcon:"sms",color:"var(xa-white) !important;",label:this.translationService.instant("sms")}],placeHolder:"request_approval",label:"",hideDropdownIcon:!0,appearance:"button",placeHolderIcon:"send",name:"option",displayValue:"label",selectedOption:{}},this.userPermission={},this.repairTypesArray=[],this.afterOperation=!1,this.isRepairCreatedFromCase=!1,this.bookingId="",this.invoiceStatus="",this.commonService.accessRight.closed&&(this.commonService.accessRight=new Ct.X(!0)),this.commonService.activeItem.closed?this.commonService.activeItem=new Ct.X("Booking"):this.commonService.activeItem.next("Booking"),this.commonService.userProfileData.subscribe(se=>{if(se&&se.data){const{userPermission:Be,email:Me}=se.data;this.email=Me,this.userPermission=Be||{}}}),this.i18n=this.commonService.geti18nInfo(),this.route.parent?.params?.subscribe(se=>{""!=this.repairGuid&&this.repairGuid!==se.id&&"0"!==se.id&&(this.monitorService.logEvent("ngOnInit",["EstimateComponent","addenda-repair"]),this.commonService.updatePage("/repair/customers/0","add-customer"),this.repairGuid=this.route.parent?.snapshot.paramMap.get("id"),this.getBookingRepairDetails()),setTimeout(()=>{-1!==this.router.url.indexOf("parts")&&document.querySelector("chq-tabs .active").click()},300)})}get showDelete(){return!(!this.repairId||"draft"!==this.repairStatus?.toLowerCase())||!(!this.repairId||!this.caseGuid||1!=this.isRepairCreatedFromCase||"repairestimation"!=this.repairStatus?.toLowerCase())}handleSelectedOption(t){this.showRequestApprovalDialog(t?.value?.label)}redirectToGtEstimate(){this.commonService.showLoading(),this.monitorService.logEvent("redirectToGtEstimate",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid,status}]),this.route.snapshot.queryParams.send&&"true"==this.route.snapshot.queryParams.send&&this.router.navigate([],{relativeTo:this.route,queryParams:{send:"false"},queryParamsHandling:"merge"}),this.repairEstimateService.createEstimateFromRepair(this.repairGuid).subscribe({next:t=>{t&&(location.href=t.data.url,sessionStorage.setItem("update","1"),sessionStorage.setItem("current-url",this.router.url.toString()),sessionStorage.setItem("initial-repair-types",JSON.stringify(this.repairTypesArray)))},complete:()=>{this.commonService.hideLoading()}})}showRequestApprovalDialog(t){var n=this;return(0,ue.Z)(function*(){n.commonService.showLoading();const r=yield(0,Ee.z)(n.notifyService.getNotifyTemplate(n.repairGuid,n.domainId,4));n.commonService.hideLoading();const s=`<strong class='text-black-medium'>Request approval: </strong> <strong class='text-black-medium'>${n.repairNumber} / </strong> <strong class='text-black-medium'>${n.vehicleObj.vehicleMake} / </strong>\n    <strong class='text-black-medium'>${n.vehicleObj.vehicleModel} / </strong> <strong class='text-black-medium'>${n.vehicleObj.licensePlateNumber}</strong> ${n.claimNumber?`<strong class='text-black-medium'> / ${n.claimNumber} </strong>`:""}`;let d="send_message",u="",v="";"email"===t?.toLowerCase()?(d="send_email",u=s,v=r[1].data.body.replace("{{firstname}} {{lastname}}",n.organizationName).replace("{{make}}",r[0].data.vehicle?.vehicleMake).replace("{{model}}",r[0].data.vehicle?.vehicleModel).replace("{{licensenumber}}",r[0].data.vehicle?.licensePlateNumber).replace("{{pickupdate}}",E(r[0].data?.pickUpDate?r[0].data?.pickUpDate:r[0].data?.booking?.endDate).format("DD/MM/YYYY HH:MM a")).replace("{{message}}","").replace("{{orgname}}",r[0].data.organizationDetail?.nameOfOrganization).replace("{{orgcontactnumber}}",r[0].data.organizationDetail?.phoneNumber).replace("{{claimnumber}}",r[0].data.customer?.claimNumber)):"whatsapp"===t?.toLowerCase()?(v=r[1].data.whatsAppBody.replace("{{firstname}} {{lastname}}",n.organizationName).replace("{{make}}",r[0].data.vehicle?.vehicleMake).replace("{{model}}",r[0].data.vehicle?.vehicleModel).replace("{{licensenumber}}",r[0].data.vehicle?.licensePlateNumber).replace("{{pickupdate}}",E(r[0].data?.pickUpDate?r[0].data?.pickUpDate:r[0].data?.booking.endDate).format("DD/MM/YYYY HH:MM a")).replace("{{message}}","").replace("{{orgname}}",r[0].data.organizationDetail?.nameOfOrganization).replace("{{orgcontactnumber}}",r[0].data.organizationDetail?.phoneNumber).replace("{{approvalurl}}","Approve/Reject"),v=r[0].data.customer?.claimNumber?v.replace("{{claimnumber}}",r[0].data.customer?.claimNumber):v.replace("/{{claimnumber}}","")):"sms"===t?.toLowerCase()&&(v=r[1].data.smsBody.replace("{{estimateurl}}","").replace("{{approvalurl}}","")),n.dialog.open(jr,{data:{title:d,email:n.organizationEmail,emailSubject:u,channel:t?.toLowerCase(),body:v,code:n.organizationCountryCode,phone:n.organizationPhone},backdropClass:"confirmation-popup-backdrop",maxHeight:"90vh",minWidth:"629px",width:"629px",autoFocus:!1}).afterClosed().subscribe({next:y=>{y&&(n.commonService.showLoading(),n.messageService.sendApprovalMessage(y,n.repairGuid).subscribe({next:()=>{const w=n.translationService.instant("request_approval_msg");n.commonService.showInfoToast(1e3,w),n.commonService.hideLoading(),n.getBookingRepairDetails()},error:()=>{n.commonService.hideLoading()}}))}})})()}get isValidCurrentStatus(){return["readytoinvoice"].includes(this.repairStatus.toLowerCase())}showConfirmationPopup(){this.dialog.open(Hs.I,{disableClose:!0,data:{message:"msg_estimate_zero"},backdropClass:"confirmation-popup-backdrop",autoFocus:!1}).afterClosed().subscribe({next:n=>{console.log(n),n&&this.redirectToGtEstimate()}})}getManualEstimationDetail(t){this.vehicleId&&this.inspectionId?(this.monitorService.logEvent("getManualEstimationDetail",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId}),this.repairEstimateService.getRepairEstimate(this.repairGuid,this.inspectionId,this.vehicleId).subscribe({next:n=>{this.showData=!0,this.estimateResponse=n||{},this.i18n=this.commonService.geti18nInfo(),this.commonService.isRefreshRepairEstimateDetails.next(null),this.editEstimate=!1,this.commonService.hideLoading(),this.toggleOptions(),t&&this.commonService.showInfoToast(5e3,t)},error:n=>{this.commonService.hideLoading(),this.monitorService.logException(n,_e._.Error)}})):(this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid))}getEstimationDetail(t){"GTMotive"===this.estimateSource?this.getGTEstimationDetail():this.getManualEstimationDetail()}getGTEstimationDetail(){this.vehicleId&&this.inspectionId?(this.monitorService.logEvent("getGTEstimationDetail",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,caseGuid:this.caseGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId}),this.repairEstimateService.getEstimate(this.caseGuid,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:t=>{if(this.estimateResponse=t?.data||{},0==this.estimateResponse?.estimateCharges?.length)return this.showConfirmationPopup(),void this.commonService.hideLoading();this.showData=!0,this.i18n=this.commonService.getDefaulti18nInfo(),this.estimateResponse.currencyCode=this.estimateResponse?.currencyCode,this.editEstimate=!1,this.toggleOptions(),this.commonService.hideLoading()},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,_e._.Error)}})):(this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid))}getEstimateFromCaseAndRepair(t,n){if(this.vehicleId&&this.inspectionId){this.monitorService.logEvent("getEstimateFromCaseAndRepair",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId});const r=sessionStorage.getItem("update")||"0";this.route.snapshot.queryParams.send&&-1!=(sessionStorage.getItem("current-url")||"").indexOf("mode=edit")&&this.router.navigate([],{relativeTo:this.route,queryParams:{mode:"edit"},queryParamsHandling:"merge"}),"0"===r?this.getEstimationDetail(t):"1"===r&&this.route.snapshot.queryParams.send&&"true"==this.route.snapshot.queryParams.send?this.repairEstimateService.readUpdateEstimate(this.caseGuid,this.inspectionId,this.vehicleId,"put",this.domainId).subscribe({next:()=>{sessionStorage.setItem("update","0"),this.getEstimationDetail(t),this.router.navigate([],{relativeTo:this.route,queryParams:{send:"false"},queryParamsHandling:"merge"}),""!=sessionStorage["initial-repair-types"]&&(this.afterOperation=!0,this.getBookingRepairDetails()),this.commonService.hideLoading()}}):this.getEstimationDetail(t)}else this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid)}showRepairTypeUpdateMessage(t,n){const s=[];if(t?.forEach(d=>{s.push("object"==typeof d?d.repairServiceType:d)}),s.length>0){const d=s.filter(u=>!n.includes(u));d.length>0&&(this.commonService.showNotification(`Repair Type was updated: Added ${d.join(",")}`),this.repairTypesArray=[...this.repairTypesArray,...d])}}displayMissingInspectionMessage(t){this.commonService.openAlertDialog("Notification","Please add your vehicle in order to add estimate.").afterClosed().subscribe({next:n=>{n&&this.router.navigate([`repair/booking/${t}`])},error:()=>{this.commonService.hideLoading()}})}getBookingRepairDetails(){var n,t=this;this.commonService.showLoading(),this.monitorService.logEvent("getBookingRepairDetails",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid}),this.bookingService.getRepairDetailByGuid(this.repairGuid).subscribe({next:(n=(0,ue.Z)(function*(r){if(r?.data){if(t.commonService.repairDetails.next(r.data),t.commonService.bookingId.next(r.data.repairNumber),t.repairNumber=r.data.repairNumber,t.repairId=r.data.id,t.repairStatus=r.data.status,t.invoiceStatus=r.data.invoiceStatus,t.inspectionId=r.data.vehicle?.inspectionId,t.vehicleId=r.data.vehicle?.vehicleId,t.caseGuid=r.data.quoteId,t.domainId=r.data.domainId,t.vehicleObj=r.data.vehicle,t.claimNumber=r.data?.customer?.claimNumber,t.estimateSource=r.data.estimateSource||"",t.organizationEmail=r.data?.organizationDetail?.partnerships?r.data?.organizationDetail?.partnerships[0]?.email:"",t.organizationPhone=r.data?.organizationDetail?.partnerships?r.data?.organizationDetail?.partnerships[0]?.phoneNumber?.replace(r.data?.organizationDetail?.partnerships[0]?.countryCode,""):"",t.organizationCountryCode=r.data?.organizationDetail?.partnerships?r.data?.organizationDetail?.partnerships[0]?.countryCode:"",t.organizationName=r.data?.organizationDetail?.partnerships?r.data?.organizationDetail?.partnerships[0]?.companyName:"",t.isRepairCreatedFromCase=r.data.isRepairCreatedFromCase,t.bookingId=r.data.booking?.bookingGuid,!t.vehicleId)return t.commonService.hideLoading(),void t.displayMissingInspectionMessage(t.repairGuid);"repair"==r.data.repairType?.toLowerCase()&&(t.afterOperation?"GTMotive"!=t.estimateSource?t.showRepairTypeUpdateMessage(r.data.repairServiceTypes,t.repairTypesArray):(t.repairTypesArray=[],t.getInitialRepairTypes(r.data.repairServiceTypes),""!=sessionStorage["initial-repair-types"]&&t.showRepairTypeUpdateMessage(t.repairTypesArray,JSON.parse(sessionStorage["initial-repair-types"])),sessionStorage.setItem("initial-repair-types","")):t.getInitialRepairTypes(r.data.repairServiceTypes));const s=[];r.data?.booking?.communicationTypeId&&r.data?.booking?.communicationTypeId.length>0&&r.data?.booking?.communicationTypeId.forEach(d=>{t.communicationChannels[d]&&s.push(t.communicationChannels[d])}),s.sort((d,u)=>d.label.localeCompare(u.label)),t.communications=r.data?.booking?.communicationTypeId,t.dropdownApprovalModelFilter={...t.dropdownApprovalModelFilter,options:s},r.data.customer&&"Retail"===r.data.customer?.companyOrgType&&(r.data.customer?.isCompany||(t.organizationEmail=r.data.customer?.email,t.organizationPhone=r.data.customer?.mobileNumber,t.organizationCountryCode=r.data.customer?.countryCode,t.organizationName=`${r.data.customer?.firstName} ${r.data.customer?.lastName}`)),!t.estimateSource&&t.checkGTEstimatePermission()?t.redirectToGtEstimate():t.getEstimateFromCaseAndRepair(r.data?.organizationDetail?.nameOfOrganization||"",""),t.toggleOptions()}else t.commonService.hideLoading()}),function(s){return n.apply(this,arguments)}),error:n=>{this.commonService.hideLoading(),this.monitorService.logException(n,_e._.Error)}})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,n=t.filter(r=>"Repair Estimate"===r.automotiveServiceName);if(n&&n.length>0){const{permissions:r}=n[0],s=r.filter(d=>"gt.estimate"===d.permissionName||"gt.estimate.vinquery"===d.permissionName);if(s&&s.length>0)return!0}return!1}ngOnInit(){this.monitorService.logEvent("ngOnInit",["EstimateComponent","addenda-repair"]),this.commonService.updatePage("/repair/customers/0","add-customer"),this.repairGuid=this.route.parent?.snapshot.paramMap.get("id"),this.getBookingRepairDetails(),this.subscription=this.commonService.isRefreshRepairEstimateDetails.subscribe({next:t=>{t&&"GTMotive"!==this.estimateSource&&this.vehicleId&&this.inspectionId&&this.getManualEstimationDetail()}})}toggleOptions(){if(this.dropdownModelFilter.options){if("GTMotive"!==this.estimateSource&&this.repairStatus?.toLowerCase()!=="PendingApproval".toLowerCase()&&"readytoinvoice"!==this.repairStatus?.toLowerCase())this.dropdownModelFilter.options?.find(n=>"addOperation"==n.value)||(this.dropdownModelFilter={...this.dropdownModelFilter,options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("add_operation"),dropdownItemIcon:"plus",value:"addOperation"}]});else{const t=this.dropdownModelFilter.options?.findIndex(r=>"addOperation"==r.value),n=[...this.dropdownModelFilter.options];-1!==t&&n.splice(t,1),this.dropdownModelFilter={...this.dropdownModelFilter,options:[...n]}}if(this.estimateResponse?.estimateCharges?.length>0&&this.repairStatus?.toLowerCase()!=="PendingApproval".toLowerCase()&&"readytoinvoice"!==this.repairStatus?.toLowerCase())this.dropdownModelFilter.options?.find(n=>"editOperation"==n.value)||(this.dropdownModelFilter={...this.dropdownModelFilter,options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("edit_estimate"),dropdownItemIcon:"edit",value:"editOperation"}]});else{const t=this.dropdownModelFilter.options?.findIndex(r=>"editOperation"==r.value),n=[...this.dropdownModelFilter.options];-1!==t&&n.splice(t,1),this.dropdownModelFilter={...this.dropdownModelFilter,options:[...n]}}if(this.estimateResponse?.estimateCharges?.length>0&&"readytoinvoice"!==this.repairStatus?.toLowerCase())this.dropdownModelFilter.options?.find(n=>"requestStatus"==n.value)||(this.dropdownModelFilter={...this.dropdownModelFilter,options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("self_approval"),dropdownItemIcon:"clock-new",value:"requestStatus"}]});else{const t=this.dropdownModelFilter.options?.findIndex(r=>"requestStatus"==r.value),n=[...this.dropdownModelFilter.options];-1!==t&&n.splice(t,1),this.dropdownModelFilter={...this.dropdownModelFilter,options:[...n]}}}}changeCaseStatusDialog(t){"addOperation"===t.value.value?this.openOperationPopup():"editOperation"===t.value.value?this.handleEditEstimate():"requestStatus"===t.value.value&&this.handleRequestStatus()}openOperationPopup(){this.checkGTEstimatePermission()?this.commonService.showToast(0,"msg_gt_permission"):this.dialog.open(Ao,{data:{repairId:this.repairGuid},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:n=>{n&&(["draft","uploaddocuments","uploadphotos"].includes(this.repairStatus?.toLowerCase())&&(this.repairStatus="RepairEstimation"),this.afterOperation=!0,this.getBookingRepairDetails())}})}handleEditEstimate(){"GTMotive"!==this.estimateSource?this.checkGTEstimatePermission()?this.commonService.showToast(0,"msg_gt_permission"):this.editEstimate=!0:this.caseGuid&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.redirectToGtEstimate.bind(this),Sn.j.quote):this.redirectToGtEstimate()}handleSaveEditedEstimate(){this.editEstimate=!1}handleEditRepairOperation(t){var n=this;return(0,ue.Z)(function*(){try{n.commonService.showLoading(),n.monitorService.logEvent("getRepairEstimateOperationDetails",["EstimateComponent","addenda-repair"]);const r=yield n.getRepairEstimateOperationDetails(t);if(n.commonService.hideLoading(),r?.data){const d=Object.entries(r.data).map(P=>[P[0][0].toUpperCase()+P[0].slice(1),P[1]]),u=Object.fromEntries(d);n.dialog.open(Ao,{data:{repairId:n.repairGuid,operationDetails:u},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:P=>{P&&n.getEstimateFromCaseAndRepair("","")}})}}catch(r){n.commonService.hideLoading(),n.monitorService.logException(r,_e._.Error)}})()}getRepairEstimateOperationDetails(t){var n=this;return(0,ue.Z)(function*(){return(0,Ee.z)(n.repairEstimateOperationService.getRepairEstimateOperationDetails(t))})()}handleIconClicked(t){const{id:n,action:r}=t;"edit"===r&&this.handleEditRepairOperation(n),"delete"===r&&(this.caseGuid?this.commonService.showChangeWarningMessage(this.handleDeleteRepairOperation.bind(this,n),Sn.j.quote):this.handleDeleteRepairOperation(n))}handleDeleteRepairOperation(t){this.commonService.openDeleteDialog().afterClosed().subscribe(n=>{n&&(this.monitorService.logEvent("getBookingRepairDetails",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,id:t}),this.commonService.showLoading(),(0,Ee.z)(this.repairEstimateOperationService.deleteRepairEstimateOperation(this.repairGuid,t)).then(r=>{let s="";r?.message&&(s=r.message),this.getManualEstimationDetail(s)}).catch(()=>{this.commonService.hideLoading()}))})}downloadPdf(){this.commonService.showLoading(),this.monitorService.logEvent("downloadPdf",["RepairEstimateComponent","addenda-repair",{caseId:this.caseGuid}]),this.repairEstimateService.getXADownloadUrl(this.caseGuid).subscribe({next:n=>{window.open(n.data.url,"_top"),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}getInitialRepairTypes(t){t.forEach(n=>{this.repairTypesArray.push(n.repairServiceType)})}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(t=>{t&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}handleRequestStatus(){this.dialog.open(Kr,{width:"629px",maxWidth:"629px",autoFocus:!1,data:this.repairGuid}).afterClosed().subscribe({next:n=>{n&&this.getBookingRepairDetails()}})}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.subscription.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["EstimateComponent","addenda-repair"])}repairNotInvoiced(){return!("invoiced"===this.repairStatus?.toLowerCase()||"paid"===this.repairStatus?.toLowerCase()||"closed"===this.repairStatus?.toLowerCase()||"complete"===this.repairStatus?.toLowerCase()||"readytoinvoice"===this.repairStatus?.toLowerCase()||"readytoinvoice"===this.invoiceStatus?.toLowerCase()||"invoiced"===this.invoiceStatus?.toLowerCase())}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(be.v),e.Y36(Ai.H),e.Y36(ye.gz),e.Y36(xe.uw),e.Y36(Dt.q),e.Y36(pe.sK),e.Y36(Ii),e.Y36(we.M),e.Y36(Ri.K),e.Y36(et.o),e.Y36(ye.F0),e.Y36(Wr.c))},a.\u0275cmp=e.Xpm({type:a,selectors:[["estimate"]],decls:8,vars:3,consts:[["class","repair-estimate-step",4,"ngIf"],[1,"footer-full-wrapper","estimate-details-footer"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],["class","footer-button-wrapper show-md",4,"ngIf"],["class","footer-button-wrapper show-sm",4,"ngIf"],[1,"repair-estimate-step"],["serviceType","repair",3,"estimateResponse","editEstimate","estimateSource","i18n","iconClicked","downloadPdf"],[1,"footer-button-wrapper","show-md"],[4,"ngIf"],["class","show-md",4,"ngIf"],[3,"buttonModel","click"],[1,"show-md"],[4,"chqPermission"],[3,"buttonModel","click",4,"ngIf"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel"],[3,"dropdownModel","selected",4,"ngIf"],[3,"dropdownModel","selected"],[1,"footer-button-wrapper","show-sm"],[4,"ngIf","ngIfElse"],["elseTemplate",""]],template:function(t,n){1&t&&(e.YNc(0,Xr,2,4,"div",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3),e._UZ(4,"img",4),e.qZA()(),e.ynx(5),e.YNc(6,me,3,2,"div",5),e.YNc(7,An,3,2,"div",6),e.BQk(),e.qZA()),2&t&&(e.Q6J("ngIf",n.showData),e.xp6(6),e.Q6J("ngIf",n.showData&&!n.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",n.showData&&!n.commonService.isViewOnly))},dependencies:[f.O5,Ro.I,He.E,$r.r,kn.A],styles:[".repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container{border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-white);margin-top:25px;margin-bottom:25px;padding:0 32px 32px}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container chq-customloader{margin:auto}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-label{margin-top:25px}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-label, .repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.estimate-details-footer[_ngcontent-%COMP%]   .show-sm[_ngcontent-%COMP%]{display:none!important}@media (max-width: 985px){.estimate-details-footer[_ngcontent-%COMP%]   .show-md[_ngcontent-%COMP%]{display:none!important}.estimate-details-footer[_ngcontent-%COMP%]   .show-sm[_ngcontent-%COMP%]{display:flex!important}.estimate-details-footer[_ngcontent-%COMP%]     .dropdown-container.dropdown-edit-mode{top:0}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label .placeHolder{font-size:14px!important}.estimate-details-footer[_ngcontent-%COMP%]     a.dropdown{width:180px!important}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label mat-icon{height:17px;width:17px}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label .content mat-icon{height:15px;width:15px}.estimate-details-footer[_ngcontent-%COMP%]     .dropdown-container .dropdown .dropdown-wrapper{border-color:var(--xa-light-gray)!important}}"]}),a})();var Rn=k(4128),Ln=k(70262),ct=k(39646),Zo=k(32076);function sl(a){let c,t;return n=>(c||(c=n,t=a.formControl,t.valueChanges.subscribe(()=>{"VALID"==t.status&&c.updateValueAndValidity({onlySelf:!0})})),new Date(t.value)>new Date(c.value)?{invalid:!0}:null)}var qi=k(60562),nt=k(25268),Zi=k(38709),ii=k(4093),Fi=k(13975),ra=k(74178),ll=k(11145),cl=k(50356),pl=k(8571);const dl=["companyOrg"],ul=["licenseId"],En=["driverPhone"],hl=["driverCode"],ml=["orgType"],No=["make"],aa=["model"],en=["year"],Ni=["mileage"],gl=["license"],fl=["regDate"],_l=["repairType"],qn=["bookingout"],Pt=["serviceType"],sa=["communicationChannel"],vl=["bookingInDate"],bl=["chqUpload"];function Cl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",40),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("inputModel",t.formModel.customerData.claimNumber)}}const tn=function(a){return{hide:a}};function Ml(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",82)(1,"div",14)(2,"div",83)(3,"chq-input",84),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA()()()()}if(2&a){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(2,tn,t.isFormConfirmed)),e.xp6(3),e.Q6J("inputModel",t.formModel.customerData.carOwnerSelector)}}const qt=function(a){return{"disable-input disable-controls":a}};function C(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"div",83)(3,"chq-input",85,86),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA(),e.TgZ(5,"chq-input",87,88),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA()()()()}if(2&a){const t=e.oxw(2);e.xp6(3),e.Q6J("inputModel",t.formModel.customerData.companyName),e.xp6(2),e.Q6J("ngClass",e.VKq(3,qt,"select"===t.formModel.customerData.companyName.type))("inputModel",t.formModel.customerData.licenseId)}}function x(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",89),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("inputModel",t.formModel.customerData.email)}}function O(a,c){if(1&a&&(e.TgZ(0,"div",90)(1,"div",91)(2,"div",92),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",93)(6,"span"),e._uU(7),e.qZA()()()()),2&a){const t=e.oxw(2);e.xp6(3),e.hij("",e.lcZ(4,2,t.formModel.customerData.email.label)," "),e.xp6(4),e.Oqu(t.formModel.customerData.email.value)}}function L(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",94,95),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("inputModel",t.formModel.customerData.driverPhone)}}function G(a,c){if(1&a&&(e.TgZ(0,"div",91)(1,"div",92),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",93)(5,"span"),e._uU(6),e.qZA()()()),2&a){const t=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,t.formModel.customerData.driverPhone.label)," "),e.xp6(4),e.Oqu(t.formModel.customerData.driverPhone.value)}}function ie(a,c){if(1&a&&(e.TgZ(0,"div",96)(1,"label"),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"label"),e._uU(6),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,e.lcZ(4,4,"type_of_service"))),e.xp6(4),e.Oqu(t.serviceTypeString)}}function De(a,c){if(1&a&&(e.TgZ(0,"div",96)(1,"label"),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"label"),e._uU(6),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,e.lcZ(4,4,"types_of_repair"))),e.xp6(4),e.Oqu(t.repairTypesString)}}function de(a,c){if(1&a&&(e.TgZ(0,"div",96)(1,"label"),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"label"),e._uU(6),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,e.lcZ(4,4,"assign_to"))," "),e.xp6(4),e.Oqu(t.assigneeString)}}function Uo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",109),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.expandCollapseAssignedTo(r))}),e.TgZ(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div"),e._UZ(4,"mat-icon",110),e.qZA()()}if(2&a){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.repair," "),e.xp6(2),e.Q6J("svgIcon",t.active?"dropdown-up":"dropdown")}}function Pl(a,c){1&a&&e._UZ(0,"img",114)}function pt(a,c){1&a&&e._UZ(0,"img",115)}function Ui(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.firstName," ",t.lastName,"")}}function Ol(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.assigneeName)}}function Zn(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",111),e.NdJ("dblclick",function(){const s=e.CHM(t).$implicit,d=e.oxw().$implicit,u=e.oxw(3);return e.KtG(u.onDoubleClick(s,d))}),e.YNc(1,Pl,1,0,"img",112),e.YNc(2,pt,1,0,"img",113),e.YNc(3,Ui,2,2,"span",70),e.YNc(4,Ol,2,1,"span",70),e.qZA()}if(2&a){const t=c.$implicit;e.Q6J("cdkDragDisabled",!t.isAvailable),e.xp6(1),e.Q6J("ngIf",t.isAvailable),e.xp6(1),e.Q6J("ngIf",!t.isAvailable),e.xp6(1),e.Q6J("ngIf",!t.assigneeName),e.xp6(1),e.Q6J("ngIf",t.assigneeName)}}function Ji(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.firstName," ",t.lastName,"")}}function Gi(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.assigneeName)}}function ae(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",116),e._UZ(1,"img",114),e.YNc(2,Ji,2,2,"span",70),e.YNc(3,Gi,2,1,"span",70),e.TgZ(4,"mat-icon",117),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw().$implicit,u=e.oxw(3);return e.KtG(u.unAssignEmployee(s,d))}),e.qZA()()}if(2&a){const t=c.$implicit;e.xp6(2),e.Q6J("ngIf",!t.assigneeName),e.xp6(1),e.Q6J("ngIf",t.assigneeName),e.xp6(1),e.Q6J("svgIcon","cross")}}const yl=function(a){return[a]};function la(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",98),e.YNc(1,Uo,5,2,"div",99),e.TgZ(2,"div",82)(3,"div",100)(4,"div",101),e._uU(5),e.ALo(6,"uppercase"),e.ALo(7,"uppercase"),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div",102)(10,"div",103),e.YNc(11,Zn,5,5,"div",104),e.qZA()()(),e.TgZ(12,"div",100)(13,"div",101),e._uU(14),e.ALo(15,"uppercase"),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",105)(18,"div",106,107),e.NdJ("cdkDropListDropped",function(r){const d=e.CHM(t).$implicit,u=e.oxw(3);return e.KtG(u.drop(r,d.repairId))}),e.YNc(20,ae,5,3,"div",108),e.qZA()()()()()}if(2&a){const t=c.$implicit,n=e.MAs(19),r=e.oxw(3);e.Q6J("ngClass",r.isTechnician||"complete"===(null==r.status?null:r.status.toLowerCase())?"disable-container":""),e.xp6(1),e.Q6J("ngIf","Repair"===r.personalInfoData.serviceType),e.xp6(1),e.Q6J("ngClass",e.VKq(21,tn,!t.active&&"Repair"===r.personalInfoData.serviceType)),e.xp6(3),e.AsE(" ",e.lcZ(6,11,null==t.repair?null:t.repair.toString())," ",e.lcZ(7,13,e.lcZ(8,15,"specialists"))," "),e.xp6(5),e.Q6J("cdkDropListConnectedTo",e.VKq(23,yl,n))("cdkDropListData",t.employees),e.xp6(1),e.Q6J("ngForOf",t.employees),e.xp6(3),e.hij(" ",e.lcZ(15,17,e.lcZ(16,19,"specialists_assigned"))," "),e.xp6(4),e.Q6J("cdkDropListData",t.employeesAssigned),e.xp6(2),e.Q6J("ngForOf",t.employeesAssigned)}}function Bi(a,c){if(1&a&&(e.ynx(0),e.YNc(1,la,21,25,"div",97),e.BQk()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.repairEmployees)}}function xl(a,c){if(1&a&&(e.TgZ(0,"div",118)(1,"label"),e._uU(2),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(t.formModel.towedIn.value)}}const ca=function(){return{"pointer-events":"none"}},pa=function(){return{}};function Yi(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",56)(1,"div",57),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span",7),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"div",119)(7,"div",13)(8,"div",14)(9,"chq-input",120,121),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onFormUpdate(r))}),e.qZA()()()()()}if(2&a){const t=e.oxw(2);e.xp6(2),e.hij(" ",e.lcZ(3,3,"preferred_comm")," "),e.xp6(7),e.Q6J("inputModel",t.formModel.communicationChannel)("ngStyle",t.formModel.communicationChannel.disabled?e.DdM(5,ca):e.DdM(6,pa))}}function nn(a,c){if(1&a&&e._UZ(0,"chq-button",22),2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.cancelButtonModel)}}function Hi(a,c){if(1&a&&e._UZ(0,"chq-button",22),2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.bookingButtonModel)}}function da(a,c){if(1&a&&e._UZ(0,"chq-button",22),2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.closeButtonModel)}}function zi(a,c){if(1&a&&(e.TgZ(0,"div",123),e.YNc(1,nn,1,1,"chq-button",124),e.YNc(2,Hi,1,1,"chq-button",124),e.YNc(3,da,1,1,"chq-button",124),e.qZA()),2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.showDelete),e.xp6(1),e.Q6J("ngIf",!t.repairId||"complete"!==(null==t.status?null:t.status.toLowerCase())),e.xp6(1),e.Q6J("ngIf",t.repairId&&t.isFormConfirmed)}}function ua(a,c){1&a&&(e.ynx(0),e.YNc(1,zi,4,3,"div",122),e.BQk()),2&a&&(e.xp6(1),e.Q6J("chqPermission","newBooking"))}const ha=function(a,c){return{"text-mode bg-tab-default-content":a,"page-wrapper":c}},oi=function(a){return{"text-mode":a}},ma=function(a){return{"partial-disable-info":a}},ri=function(a){return{"partial-disable-info disable-controls":a}},hn=function(a,c){return{"disable-controls disable-input":a,hide:c}};function Qi(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",6)(5,"span",7),e._uU(6,"*"),e.qZA(),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div",8)(10,"div",9)(11,"form",10)(12,"div",11)(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",13)(17,"chq-input",15,16),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA(),e.YNc(19,Cl,1,1,"chq-input",17),e.qZA()()(),e.YNc(20,Ml,4,4,"div",18),e.YNc(21,C,7,5,"div",19),e.qZA(),e.TgZ(22,"div",20)(23,"div",21),e._UZ(24,"chq-button",22),e.qZA()(),e.TgZ(25,"div",23)(26,"div",13)(27,"div",24)(28,"div",25)(29,"div",26)(30,"chq-input",27),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA(),e.TgZ(31,"chq-input",27),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA()()(),e.TgZ(32,"div",28)(33,"div",26),e.YNc(34,x,1,1,"chq-input",29),e.YNc(35,O,8,4,"div",30),e.TgZ(36,"div",31)(37,"div",26)(38,"chq-input",32,33),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA(),e.YNc(40,L,2,1,"chq-input",34),e.YNc(41,G,7,4,"div",35),e.qZA()()()()()()()(),e.TgZ(42,"div",36)(43,"div",37),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.TgZ(46,"div",38)(47,"div",39)(48,"chq-input",40),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateVehicle(r))}),e.qZA(),e.TgZ(49,"div",41),e._UZ(50,"chq-button",22),e.qZA()(),e.TgZ(51,"div",42)(52,"chq-input",43,44),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateVehicle(r))}),e.qZA(),e.TgZ(54,"chq-input",45,46),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateVehicle(r))}),e.qZA()(),e.TgZ(56,"div",47)(57,"chq-input",48,49),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateVehicle(r))}),e.qZA(),e.TgZ(59,"chq-input",40,50),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateVehicle(r))}),e.qZA()(),e.TgZ(61,"div",51)(62,"chq-input",52,53),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateVehicle(r))}),e.qZA(),e.TgZ(64,"chq-input",54,55),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateVehicle(r))}),e.qZA()()()(),e.TgZ(66,"div",56)(67,"div",57),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"div",58)(71,"div",13)(72,"chq-input",59,60),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA(),e.YNc(74,ie,7,6,"div",61),e.TgZ(75,"chq-input",62,63),e.NdJ("clicked",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.hideDropdown(r))})("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA(),e.YNc(77,De,7,6,"div",61),e.YNc(78,de,7,6,"div",61),e.qZA(),e.TgZ(79,"div",13)(80,"chq-input",64,65),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA(),e.TgZ(82,"chq-input",40,66),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()()(),e.TgZ(84,"div",67)(85,"div",57),e._uU(86),e.ALo(87,"translate"),e.qZA(),e.TgZ(88,"div",68)(89,"div",13)(90,"div",14)(91,"chq-input",69),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()()(),e.YNc(92,Bi,2,1,"ng-container",70),e.qZA(),e.TgZ(93,"div",71)(94,"div",57),e._uU(95),e.ALo(96,"translate"),e.qZA(),e.TgZ(97,"div",72)(98,"div",13)(99,"div",14)(100,"div",73)(101,"chq-input",74),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()(),e.YNc(102,xl,3,1,"div",75),e.qZA()()(),e.TgZ(103,"div",76)(104,"div",13)(105,"div",14)(106,"chq-input",74),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()()(),e.YNc(107,Yi,11,7,"div",77),e.qZA()()()(),e.TgZ(108,"div",78)(109,"div",79)(110,"div",80),e._UZ(111,"img",81),e.qZA()(),e.YNc(112,ua,2,1,"ng-container",70),e.qZA()()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.WLB(71,ha,t.isFormConfirmed,!t.isFormConfirmed)),e.xp6(1),e.Q6J("ngClass",e.VKq(74,oi,t.isFormConfirmed)),e.xp6(1),e.hij(" ",e.lcZ(3,59,"customer_details")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(76,tn,t.isFormConfirmed)),e.xp6(3),e.hij("",e.lcZ(8,61,"mandatory_fields")," "),e.xp6(10),e.Q6J("inputModel",t.formModel.customerData.companyOrgType),e.xp6(2),e.Q6J("ngIf","Insurance Company"===t.customerFormData.companyOrgType),e.xp6(1),e.Q6J("ngIf",t.isRetailProvider),e.xp6(1),e.Q6J("ngIf",!t.isRetailProvider||t.customerFormData[t.formModel.customerData.carOwnerSelector.name]&&"Person"!==t.customerFormData[t.formModel.customerData.carOwnerSelector.name]),e.xp6(1),e.Q6J("ngClass",e.VKq(78,tn,t.isFormConfirmed||!t.currentStatus||t.isTechnician)),e.xp6(2),e.Q6J("buttonModel",t.chqUploadDrivingLicense),e.xp6(6),e.Q6J("inputModel",t.formModel.customerData.firstName),e.xp6(1),e.Q6J("inputModel",t.formModel.customerData.lastName),e.xp6(3),e.Q6J("ngIf",!t.isFormConfirmed),e.xp6(1),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(3),e.Q6J("inputModel",t.formModel.customerData.driverCode),e.xp6(2),e.Q6J("ngIf",!t.isFormConfirmed),e.xp6(1),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(2),e.Q6J("ngClass",e.VKq(80,oi,t.isFormConfirmed)),e.xp6(1),e.hij(" ",e.lcZ(45,63,"vehicle_detail")," "),e.xp6(3),e.Q6J("ngClass",e.VKq(82,ma,t.searchDisabled)),e.xp6(1),e.Q6J("inputModel",t.formModel.vehicleData.vin),e.xp6(1),e.Q6J("ngClass",e.VKq(84,tn,t.isFormConfirmed||!t.currentStatus||t.isTechnician)),e.xp6(1),e.Q6J("buttonModel",t.chqUploadRegistrationCard),e.xp6(1),e.Q6J("ngClass",e.VKq(86,qt,t.inputDisabled)),e.xp6(1),e.Q6J("inputModel",t.formModel.vehicleData.make)("ngClass",e.VKq(88,qt,t.makeDisabled)),e.xp6(2),e.Q6J("inputModel",t.formModel.vehicleData.model)("ngClass",e.VKq(90,qt,t.modelDisabled)),e.xp6(2),e.Q6J("ngClass",e.VKq(92,qt,t.inputDisabled)),e.xp6(1),e.Q6J("inputModel",t.formModel.vehicleData.year)("ngClass",e.VKq(94,qt,t.yearDisabled)),e.xp6(2),e.Q6J("inputModel",t.formModel.vehicleData.licensePlate),e.xp6(2),e.Q6J("ngClass",e.VKq(96,ri,t.infoDisabled)),e.xp6(1),e.Q6J("inputModel",t.formModel.vehicleData.carMilege),e.xp6(2),e.Q6J("inputModel",t.formModel.vehicleData.registrationDate),e.xp6(4),e.hij(" ",e.lcZ(69,65,"booking_details")," "),e.xp6(4),e.Q6J("ngClass",e.VKq(98,tn,t.isFormConfirmed))("inputModel",t.formModel.serviceType),e.xp6(2),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(1),e.Q6J("inputModel",t.formModel.repairTypes)("ngClass",e.WLB(100,hn,t.repairTypeDisabled,t.isFormConfirmed)),e.xp6(2),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(1),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(2),e.Q6J("inputModel",t.formModel.bookingInDate)("ngClass",t.isFormConfirmed?"col-4":"col-6"),e.xp6(2),e.Q6J("inputModel",t.formModel.bookingOutDate),e.xp6(2),e.Q6J("ngClass",e.VKq(103,tn,t.isFormConfirmed)),e.xp6(2),e.hij(" ",e.lcZ(87,67,"job_allocation")," "),e.xp6(5),e.Q6J("inputModel",t.formModel.jobAllocation)("ngStyle",t.formModel.communicationChannel.disabled?e.DdM(105,ca):e.DdM(106,pa)),e.xp6(1),e.Q6J("ngIf",t.personalInfoData.jobAllocation&&"Repair"!==t.personalInfoData.serviceType||t.personalInfoData.jobAllocation&&"Repair"===t.personalInfoData.serviceType&&(null==t.formModel.repairTypes||null==t.formModel.repairTypes.selectedOption?null:t.formModel.repairTypes.selectedOption.length)),e.xp6(3),e.hij(" ",e.lcZ(96,69,"other_details")," "),e.xp6(5),e.Q6J("ngClass",e.VKq(107,tn,t.isFormConfirmed)),e.xp6(1),e.Q6J("inputModel",t.formModel.towedIn),e.xp6(1),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(4),e.Q6J("inputModel",t.formModel.notes),e.xp6(1),e.Q6J("ngIf",(null==t.formModel.communicationChannel.options?null:t.formModel.communicationChannel.options.length)>0),e.xp6(5),e.Q6J("ngIf",!t.commonService.isViewOnly)}}const wl=function(a){return{disabled:a}};E.extend(nt);let ga=(()=>{class a{constructor(t,n,r,s,d,u,v,P,y,w,D,q,se,Be,Me){this.router=t,this.commonService=n,this.monitorService=r,this.caseService=s,this.coreService=d,this.vehicleService=u,this.route=v,this.bookingService=P,this.formBuilder=y,this.inspectionService=w,this.mediaCollectionService=D,this.settingService=q,this.labourService=se,this.translateService=Be,this.calendarService=Me,this.isFormConfirmed=!1,this.inputDisabled=!0,this.infoDisabled=!0,this.searchDisabled=!1,this.inspectionTemplateId=0,this.makeDisabled=!1,this.preventVinCall=!1,this.modelDisabled=!1,this.yearDisabled=!1,this.caseId="",this.umc="",this.validVehicleFields=[],this.employeeList=[],this.towingDisabled=!0,this.repairTypeDisabled=!0,this.labourData=null,this.inspections=null,this.nextUrl="",this.originalVin="",this.isApiLoading=!0,this.documentSteps=[],this.countryId=6,this.canNavigate=!1,this.repairTypes=[],this.originalTariffObject={},this.vinFromOCR="",this.serviceTypeString="",this.repairTypesString="--",this.assigneeString="--",this.mode="",this.employeeRepairServiceType=[],this.previousCompetencies=[],this.isRepairCreatedFromCase=!1,this.isTechnician=!1,this.subscriptions=[],this.bookingInDateCalled=!1,this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.closeButtonModel={label:"Close",type:"primary",onclick:this.closeForm.bind(this)},this.bookingButtonModel={label:"book_in",type:"primary",onclick:this.submitForm.bind(this)},this.chqUploadDrivingLicense={label:"upload_license",type:"outline",icon:"camera",iconColor:"black"},this.chqUploadRegistrationCard={label:"upload_registration",type:"outline",icon:"camera",iconColor:"black"},this.vehicleFormData={vin:"",make:"",model:"",year:"",carMilege:"",licensePlate:"",registrationDate:"",inspectionID:"",inspectionGuid:"",isVinSpecifiedManualZ:!1},this.customerFormData={jobNumber:"",companyOrgType:"",claimNumber:"",companyName:"",tariffId:0,isTariffEditable:!0,licenseId:"",firstName:"",lastName:"",companyId:0,partnershipId:0,customerTypeID:1,driverCode:"",driverPhone:0,carOwnerSelector:"",email:""},this.personalInfoData={customerData:this.customerFormData,vehicleData:this.vehicleFormData,serviceType:"",serviceTypeId:0,repairTypes:null,bookingInDate:"",bookingOutDate:"",towedIn:"Not towed in",notes:"",communicationChannel:[],assignedTo:"",jobAllocation:!1},this.repairEmployees=[],this.repairAssignedEmployees=[],this.selectedOptionRepairs=[],this.userPermission={},this.communicationForm=this.formBuilder.group({communicationChannel:[[],T.kI.required]}),this.commonService.repairGuid.closed&&(this.commonService.repairGuid=new Ct.X(null)),this.commonService.actionTriggered.closed&&(this.commonService.actionTriggered=new Ct.X(null)),this.commonService.labourData.closed&&(this.commonService.labourData=new Ct.X(null)),this.commonService.actionTriggered.subscribe({next:K=>{K&&(this.checkForFormValidation()?(this.nextUrl=K,this.submitForm(K)):this.isFormConfirmed||this.commonService.showToast(0,"msg_booking_validation"))}}),this.commonService.viewActionTriggeredBooking.closed&&(this.commonService.viewActionTriggeredBooking=new Ct.X(null)),this.commonService.viewActionTriggeredBooking.subscribe({next:K=>{K&&K&&"string"==typeof K&&(-1!=K.indexOf("?mode=edit")?(K=K.replace("?mode=edit",""),this.router.navigate([K.replace("{bookingId}",this.repairId)],{queryParams:{mode:"edit"}})):this.router.navigate([K.replace("{bookingId}",this.repairId)]))}});const ln=this.commonService.eventfromToastComponent$.subscribe(K=>{K&&(this.monitorService.logEvent("eventfromToastComponent",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.router.navigate(this.nextUrl&&"string"==typeof this.nextUrl?[this.nextUrl.replace("{bookingId}",this.repairId)]:["/repair/booking-journal"]))});this.subscriptions.push(ln),this.commonService.userProfileData.subscribe(K=>{if(K&&K.data){const{userPermission:Pe,organizationDetail:Bt,vehicleSourceType:ho}=K.data;this.userPermission=Pe||{},this.currentOrgId=Bt.id,this.countryCode=Bt.countryCode,this.estimateId=ho}}),this.commonService.labourData.subscribe(K=>{K&&(this.labourData=K)})}get isRetailProvider(){return!!this.customerFormData.companyOrgType&&"Retail"===this.customerFormData.companyOrgType}get showDelete(){return!(this.repairId&&(!this.repairId||"draft"!==this.status?.toLowerCase())&&(!this.repairId||!this.caseId||1!=this.isRepairCreatedFromCase||"repairestimation"!=this.status?.toLowerCase()))}get isRetailAndCompanyProvider(){return!!this.customerFormData.companyOrgType&&("Retail"!==this.customerFormData.companyOrgType||"Retail"===this.customerFormData.companyOrgType&&this.customerFormData.carOwnerSelector&&"Person"!==this.customerFormData.carOwnerSelector)}get retail(){return this.customerFormData.companyOrgType?this.formModel.customerData.companyOrgType.selectedOption[this.formModel.customerData.companyOrgType.displayValue]:""}get currentStatus(){return!this.status&&!this.isFormConfirmed||-1!==["draft","uploaddocuments","uploadphotos"].indexOf(this.status?.toLowerCase())&&!this.isFormConfirmed}setCommunicationMethods(){this.commonService.userProfileData?.subscribe(t=>{const n=t?.data?.userPermission.orgPackages.find(s=>"Communication Channel"===s.automotiveServiceName)?.permissions;let r="~";n?.forEach(s=>{r+=s.permissionName.toLowerCase()}),this.formModel.communicationChannel.options=this.formModel.communicationChannel.options.filter(s=>r.includes(s.label.toLowerCase()))})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,n=t.filter(r=>"Repair Estimate"===r.automotiveServiceName);if(n&&n.length>0){const{permissions:r}=n[0],s=r.filter(d=>"gt.estimate"===d.permissionName||"gt.estimate.vinquery"===d.permissionName);if(s&&s.length>0)return!0}return!1}checkVINQueryPermission(){const{orgPackages:t=[]}=this.userPermission,n=t.filter(r=>"vehicle identification"===r.automotiveServiceName?.toLowerCase());if(n&&n.length>0){const{permissions:r}=n[0],s=r.filter(d=>"gt.data.vincoding"===d.permissionName);if(s&&s.length>0)return!0}return!1}checkRouteParams(t){this.route.queryParams.subscribe(n=>{n.caseId&&(this.caseId=n.caseId),n.mode&&(this.mode=n.mode),n.startDate&&n.endDate&&(this.startDate=n.startDate,this.endDate=n.endDate),t()})}handleImageOutput(t){const{file:n}=t;this.commonService.showLoading();const r={mediaCollectionId:this.mediaTemplate.collectionGuid,domainId:this.domainId,objectId:this.objectId,mediaTemplateId:this.currentStep.templateGuid,mediaPartTemplateId:this.currentStep.partTemplateGuid};this.monitorService.logEvent("handleImageOutput",["PersonalInfoComponent","addenda-repair",{obj:r}]),this.currentStep.uploadInProgress=!0,this.currentStep.isSkipped=!1,this.currentStep.isUploadFailed=!1,this.currentStep.isUploadSuccess=!1,this.mediaCollectionService.uploadDocumentOCR(n,r).subscribe({next:s=>{this.prefillDriverDetailsFromOcr(s?.ocrTags),this.handleRegistrationPrefillOCR(s?.ocrTags),this.currentStep.stepName.includes("Driving")?this.chqUploadDrivingLicense={...this.chqUploadDrivingLicense,label:"Retake",icon:"retake"}:this.chqUploadRegistrationCard={...this.chqUploadRegistrationCard,label:"Retake",icon:"retake"}},error:s=>{this.monitorService.logException(s,_e._.Error),this.commonService.hideLoading()},complete:()=>this.commonService.hideLoading()})}getMediaTemplateByObject(){this.mediaPartTemplates=this.commonService.getAllChild(this.mediaTemplate?.mediaTemplates,"mediaPartTemplates","mediaTemplateGuid",{parentProp:"name",childProp:"parentName"});for(let t=0;t<this.mediaPartTemplates.length;t++){const n=this.mediaPartTemplates[t];if(n.name.includes("Vehicle Registration")&&n.name.includes("Driving License"))continue;const r=(0,X.sH)(n,t);this.documentSteps.push({...r,mandatory:n.mandatory,index:t,parentName:n.parentName,isFront:n.frontSide,updatedDate:"00000000-0000-0000-0000-000000000000"!=n.mediaPartGuid?n.updatedDate:"",uploadedDate:"00000000-0000-0000-0000-000000000000"!=n.mediaPartGuid?n.createdDate:"",domainId:this.domainId,objectId:this.objectId,sizeLimit:n.sizeLimit,allowExtension:n.allowExtension,uploadedPartGuid:"00000000-0000-0000-0000-000000000000"!=n.mediaPartGuid?n.mediaPartGuid:"",uploadedGuid:"00000000-0000-0000-0000-000000000000"!=n.mediaGuid?n.mediaGuid:"",partTemplateGuid:n.mediaPartTemplateGuid,templateGuid:n.mediaTemplateGuid})}}prefillDriverDetailsFromOcr(t){if(t&&t.length>0)for(let n=0;n<t.length;n++){const r=t[n];if(r[r.key]=r.value,r.Name){const s=r.Name.split(" ");this.customerFormData.firstName=s[0],this.formModel.customerData.firstName={...this.formModel.customerData.firstName,value:s[0],selectedOption:{}},s.splice(0,1),this.customerFormData.lastName=s.join(" "),this.formModel.customerData.lastName={...this.formModel.customerData.lastName,value:s.join(" "),selectedOption:{}}}}}handleRegistrationPrefillOCR(t){if(this.resetVehicleDropdown(!0),this.vehicleFormData.vin="",this.formModel.vehicleData.vin={...this.formModel.vehicleData.vin,value:""},t&&t.length>0)for(let n=0;n<t.length;n++){const r=t[n],s=r.value;if(this.infoDisabled=!1,r.key.includes("Chassis"))this.vehicleFormData.vin=s,this.formModel.vehicleData.vin={...this.formModel.vehicleData.vin,value:s},this.searchDisabled=!1,this.preventVinCall=!1,this.vinFromOCR=s;else if(r.key.includes("Plate"))this.vehicleFormData.licensePlate=s,this.inputDisabled=!1,this.formModel.vehicleData.licensePlate={...this.formModel.vehicleData.licensePlate,value:s};else if(r.key.includes("Make")||r.key.includes("Veh.")){if(1==this.countryId){const d=s?.toString().trim().split(" ");if(d?.length>0)if(2==d?.length)this.vehicleFormData.make=d[0],this.vehicleFormData.model=d[1];else if(d?.length>2)if(["ALFA ROMEO","MERCEDES BENZ","LAND ROVER"].includes(d[0]+" "+d[1])){this.vehicleFormData.make=d[0]+" "+d[1];let v="";for(let P=2;P<d?.length;P++)v+=d[P]+" ";this.vehicleFormData.model=v.trim()}else{this.vehicleFormData.make=d[0];let v="";for(let P=1;P<d?.length;P++)v+=d[P]+" ";this.vehicleFormData.model=v.trim()}else this.vehicleFormData.make=d[0];this.formModel.vehicleData.make={...this.formModel.vehicleData.make,selectedOption:{name:this.vehicleFormData.make}},this.formModel.vehicleData.model={...this.formModel.vehicleData.model,selectedOption:{modelDescription:this.vehicleFormData.model}},this.modelDisabled=!1}else this.vehicleFormData.make=s,this.formModel.vehicleData.make={...this.formModel.vehicleData.make,selectedOption:{name:s}};this.inputDisabled=!1,this.makeDisabled=!1}else if(r.key.includes("Manufacturer")){const d=s.split("/"),u=`${d[2]}-${d[1]}-${d[0]}T00:00:00`;this.vehicleFormData.registrationDate=u,this.formModel.vehicleData.registrationDate={...this.formModel.vehicleData.registrationDate,value:u}}else r.key.includes("Model")&&(1==this.countryId?(this.vehicleFormData.year=s,this.formModel.vehicleData.year={...this.formModel.vehicleData.year,selectedOption:{name:"0"==s?null:s}}):(this.vehicleFormData.model=s,this.formModel.vehicleData.model={...this.formModel.vehicleData.model,selectedOption:{modelDescription:s}}),this.modelDisabled=!1)}}checkMakeModelExistFromOCR(){const t=this.formModel.vehicleData.make.selectedOption?.name;if(this.commonService.openAlertDialog("warning_header_ocr","warning_message_ocr"),t)if(this.vehicleFormData.isVinSpecifiedManualZ=!0,this.formModel.vehicleData.make.options?.some(r=>r.name==t)){if(!this.formModel.vehicleData.model.selectedOption?.modelDescription||!this.checkGTEstimatePermission()){const r=this.formModel.vehicleData.make.options?.find(s=>s.name==t);this.formModel.vehicleData.model={...this.formModel.vehicleData.model,observable:this.vehicleService.getVehicleModel(r.id,this.estimateId),onObservableLoad:this.loadYears.bind(this)},setTimeout(()=>{this.model?.triggerObservable()})}}else 1!=this.countryId&&this.formModel.vehicleData.model.selectedOption?.modelDescription&&(this.formModel.vehicleData.year={...this.formModel.vehicleData.year,selectedOption:{id:"",name:"00- "}},this.vehicleFormData.year="00- ")}loadYears(t){if(this.enableDropdowns(),t&&t&&t.length>0&&(this.formModel.vehicleData.model={...this.formModel.vehicleData.model,options:t},this.formModel.vehicleData.model.selectedOption?.modelDescription)){const n=this.formModel.vehicleData.model.options?.filter(r=>r.modelDescription==this.formModel.vehicleData.model.selectedOption?.modelDescription);n.length>0&&this.vehicleService.getVehicleYearByModel(n[0].id,this.estimateId)?.subscribe(r=>{this.formModel.vehicleData.year={...this.formModel.vehicleData.year,options:r}})}}handleDrivingLicenseVehicleUpload(t){let n="Driving License";t&&(n="Vehicle Registration"),1===this.countryId&&t&&(n+=" Back");const r=this.documentSteps.filter(s=>s.stepName.includes(n));this.currentStep=r[0],this.repairId||this.objectId?(this.currentStep.objectId=this.objectId,this.vinFromOCR="",this.chqUpload.triggerUpload()):(this.commonService.hideLoading(),this.submitForm("",!0,()=>{this.currentStep.objectId=this.objectId,this.chqUpload.triggerUpload(),this.commonService.hideLoading()}))}handleDrivingLicenseClick(){this.handleDrivingLicenseVehicleUpload()}handleRegistrationCardClick(){this.handleDrivingLicenseVehicleUpload(!0)}ngOnInit(){this.formModel={search:{placeHolder:"Search",name:"search",label:"",type:"search",value:0,icon:"cross",preIcon:"search"},serviceType:{placeHolder:"select_dot",name:"serviceType",label:"type_of_service",value:0,type:"select",displayValue:"name",idField:"serviceType",fieldValue:"id",options:[],errorWhenEmpty:!0,validation:{name:"serviceType",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"warning_service_type":""}},repairTypes:{placeHolder:"select_dot",name:"repairTypes",label:"types_of_repair",value:0,type:"select",displayValue:"name",idField:"repairName",fieldValue:"id",errorWhenEmpty:!0,isMultiSelect:!0,validation:{name:"repairTypes",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"required_repair_type":""},options:[]},bookingInDate:{placeHolder:"booking_in",label:"booking_in",name:"bookingInDate",value:new Date,type:"datetime",maxDate:E().add(10,"year").toDate(),minDate:new Date,validation:{name:"bookingInDate",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"required_date":a.invalidDateFormat?"msg_enter_future_date":""}},bookingOutDate:{placeHolder:"booking_out",label:"booking_out",name:"bookingOutDate",value:E().add(30,"minutes").toDate(),type:"datetime",maxDate:E().add(10,"year").toDate(),validation:{name:"bookingOutDate",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"required_date":""}},towedIn:{placeHolder:"",label:"",name:"towedIn",idField:"towedIn",value:"Not Towed In",type:"radio",options:[{label:"Not Towed In",id:1},{label:"Towed In/Non-Drivable",id:2}]},notes:{placeHolder:"notes",label:"notes",name:"notes",value:"",type:"textarea",maxLength:500},communicationChannel:{placeHolder:"",label:"",name:"communicationChannel",idField:"communicationChannel",value:"Whatsapp",type:"checkbox",options:[{label:"Whatsapp",id:1,value:1,checked:!1},{label:"Email",id:2,value:2,checked:!1},{label:"SMS",id:3,value:3,checked:!1}],validation:{name:"communicationChannel",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"required_comm_chan":""}},jobAllocation:{placeHolder:"",label:"",name:"jobAllocation",idField:"jobAllocation",value:"",type:"checkbox",options:[{label:"job_assignation",id:1,value:1,checked:!1}]},assignedTo:{placeHolder:"select_dot",name:"assignedTo",label:"assigned_to",value:0,type:"select",displayValue:"name",idField:"assignedTo",fieldValue:"id",errorWhenEmpty:!0,validation:{name:"assignedTo",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:a=>a.required?"required_assign_to":""},options:[]},estimatedEffortHour:{placeHolder:"total_estimated_effort_hour",label:"total_estimated_effort_hour",name:"estimatedEffortHour",value:0,type:"text",maxLength:4,icon:"clock-new",validation:{name:"estimatedEffortHour",validationFunction:()=>T.kI.compose([a=>{const t=a.value;return!t||/^([01][0-9]|2[0-3])$/.test(t)?null:{invalidTimeFormat:!0}}]),validationMessage:a=>a.required?"Please enter estimated effort hour(s)":a.invalidTimeFormat?"Hours should be between 00 - 23":""}},estimatedEffortMinutes:{placeHolder:"total_estimated_effort_min",label:"total_estimated_effort_min",name:"estimatedEffortMinutes",value:0,type:"text",maxLength:4,icon:"clock-new",validation:{name:"estimatedEffortMinutes",validationFunction:()=>T.kI.compose([a=>{const t=a.value;return!t||/^([0-5][0-9])$/.test(t)?null:{invalidTimeFormat:!0}}]),validationMessage:a=>a.required?"Please enter estimated effort minutes(s)":a.invalidTimeFormat?"Minutes should be between 00 - 59":""}}},this.formModel={...this.formModel,customerData:(0,X.U6)(),vehicleData:(0,qi.br)()},delete this.formModel.customerData.claimNumber.validation,this.formModel.vehicleData.vin.icon="",this.formModel.bookingOutDate={...this.formModel.bookingOutDate,validation:{name:"bookingOutDate",validationFunction:()=>T.kI.compose([T.kI.required,sl(this.formModel.bookingInDate)]),validationMessage:t=>t.required?"required_date":"bookingout_greater_msg"}},this.formModel.vehicleData.make={...this.formModel.vehicleData.make,validation:{name:"make",validationFunction:()=>T.kI.compose([])}},this.formModel.vehicleData.model={...this.formModel.vehicleData.model,validation:{name:"model",validationFunction:()=>T.kI.compose([])}},this.formModel.vehicleData.year={...this.formModel.vehicleData.year,validation:{name:"year",validationFunction:()=>T.kI.compose([])}},this.formModel.bookingInDate={...this.formModel.bookingInDate,validation:{name:"bookingInDate",validationFunction:()=>T.kI.compose([T.kI.required])}},this.formModel.communicationChannel={...this.formModel.communicationChannel,validation:{name:"communicationChannel",validationFunction:()=>T.kI.compose([])}},this.inspectionService.getInspectionTemplateList().subscribe({next:t=>{const n=t?.data;n.length>0&&(this.commonService.repairInspectionTemplate=n[0],this.inspectionTemplateId=n[0].id)}}),this.chqUploadDrivingLicense={...this.chqUploadDrivingLicense,onclick:this.handleDrivingLicenseClick.bind(this),type:"disabled-outline"},this.chqUploadRegistrationCard={...this.chqUploadRegistrationCard,onclick:this.handleRegistrationCardClick.bind(this),type:"disabled-outline"},this.formModel.customerData.driverCode.observable||(this.formModel.customerData.driverCode.observable=this.coreService.getPhoneNumber(),this.formModel.customerData.driverCode.onObservableLoad=this.onObservableLoad.bind(this)),this.mediaCollectionService.getMediaTemplate().subscribe({next:t=>{if(t.data&&t.data.length>0){const{id:n,collectionGuid:r}=t.data[0];this.domainId=3100,this.mediaTemplateId=n,(0,Rn.D)({mediaTemplateDetail:this.mediaCollectionService.getMediaTemplateById(r)}).pipe((0,Ln.K)(d=>(0,ct.of)(d))).subscribe({next:d=>{d.mediaTemplateDetail&&(this.mediaTemplate=d.mediaTemplateDetail.data,this.countryId=this.mediaTemplate.countryID,this.mediaTemplate.mediaTemplates=this.mediaTemplate.mediaTemplates.sort((v,P)=>v.orderNumber-P.orderNumber),this.getMediaTemplateByObject())}})}}}),this.checkRouteParams(()=>{const t=this.route.parent?.snapshot.paramMap.get("id");this.setRequiredLabel(),this.getBookingRepairDetails(t),this.repairId||(this.caseId?this.caseService.getCaseDetail(this.caseId).subscribe({next:n=>{this.prefillCaseData(n)},error:()=>{this.prefillVehicleData()}}):this.prefillVehicleData())}),this.setCommunicationMethods()}ngAfterViewInit(){this.repairId||this.setValidatorForVehicle()}setValidatorForVehicle(){this.mileage?.setValidatorForVehicle([T.kI.maxLength(7),T.kI.pattern("^[0-9]+$"),(0,qi.nG)()]),this.license?.setValidatorForVehicle([T.kI.maxLength(12),T.kI.pattern("^[a-zA-Z0-9]*$"),(0,qi.Gp)()]),this.regDate?.setValidatorForVehicle([])}getBookingRepairDetails(t){const n=Object.keys(this.formModel.customerData);if(t&&"0"!=t)this.isApiLoading=!0,this.repairId=t,this.loadRepair();else{this.isApiLoading=!1,this.caseId||this.getProvider();for(const r in n){const s=n[r];"driverCode"!==s?this.formModel.customerData[s]={...this.formModel.customerData[s],value:"",selectedOption:{}}:(this.formModel.customerData[s]={...this.formModel.customerData[s],value:"",selectedOption:{phoneCountryCode:this.countryCode??"+91"}},this.customerFormData.driverCode=this.countryCode??"+91")}this.getEmployees(),this.populateDropdowns(),this.formModel.communicationChannel.options?.length>0&&setTimeout(()=>{this.communicationChannelControl?.setValidatorForControls([T.kI.required])})}}getEmployees(){this.caseService.getCaseUsers("domainId=3100").subscribe({next:t=>{this.employeeList=t.data}})}loadRepair(){var t=this;return(0,ue.Z)(function*(){const n=Object.keys(t.formModel.customerData);t.commonService.showLoading(),t.bookingButtonModel.label="save",yield t.populateReadonlyFields().then(r=>{console.log(r),t.repairResponse=r.data,t.objectId=t.repairResponse.id,t.status=t.repairResponse.status,t.statusId=t.repairResponse.statusId,t.vehicleId=t.repairResponse.vehicle?.vehicleId||"0",t.isRepairCreatedFromCase=t.repairResponse.isRepairCreatedFromCase,"technician"==t.commonService.roleName?.toLowerCase()&&(t.isTechnician=!0),t.inspections={inspectionGuid:t.repairResponse.vehicle?.inspectionGuid,inspectionId:t.repairResponse.vehicle?.inspectionId},t.caseId=t.repairResponse.quoteId,t.repairResponse.tariffs?.length>0&&(t.labourData=t.repairResponse.tariffs[0]),t.originalTariffObject={make:t.repairResponse.vehicle?.vehicleMake,partnershipId:t.repairResponse.customer?.partnershipId,registrationDate:E(t.repairResponse.vehicle?.registrationDate).format("YYYY-MM-DDT00:00:00")},t.repairResponse.inspections?.length>0&&t.commonService.inspectionId.next(t.repairResponse.inspections[0].inspectionId),t.commonService.bookingId.next(t.repairResponse.repairNumber),t.commonService.repairGuid.next(t.repairResponse.repairGuid),t.commonService.repairDetails.next(t.repairResponse),t.customerFormData=(0,X.Qb)(t.repairResponse.customer);for(const d in n){const u=t.formModel.customerData[n[d]],{type:v,displayValue:P,fieldValue:y}=u;if(t.customerFormData[n[d]])if("select"===v){const w={};w[P]="",w[y]=t.customerFormData[n[d]],"companyOrgType"===n[d]&&(w[P]=t.customerFormData[n[d]]),t.formModel.customerData[n[d]]={...t.formModel.customerData[n[d]],value:"",selectedOption:w,disabled:!(!t.caseId&&!t.isTechnician&&t.currentOrgId==t.repairResponse?.organizationDetail?.organizationId)}}else{let w={};"companyName"===n[d]&&(w={companyName:t.customerFormData[n[d]]}),t.formModel.customerData[n[d]]={...t.formModel.customerData[n[d]],value:t.customerFormData[n[d]],selectedOption:w,disabled:!(!t.caseId&&!t.isTechnician&&t.currentOrgId==t.repairResponse?.organizationDetail?.organizationId)}}}t.populateVehicleData(),t.populateBookingData()}).catch(()=>{t.commonService.hideLoading()}),t.isApiLoading=!1,t.formModel.communicationChannel.options?.length>0&&setTimeout(()=>{t.communicationChannelControl?.setValidatorForControls([T.kI.required])}),t.currentStatus&&t.currentOrgId===t.repairResponse?.organizationDetail?.organizationId&&t.getProvider(),yield t.populateDropdowns(),t.checkForFormValidation(),t.checkWorkProvider(),t.currentOrgId!=t.repairResponse?.organizationDetail?.organizationId&&t.disableAll(),"complete"==t.status?.toLowerCase()&&(t.bookingButtonModel.type="disabled")})()}populateReadonlyFields(){var t=this;return(0,ue.Z)(function*(){if(t.repairId&&"0"!=t.repairId)return t.commonService.showLoading(),(0,Ee.z)(t.bookingService.getRepairDetailByGuid(t.repairId))})()}populateBookingData(){const{startDate:t,endDate:n,bookingGuid:r,notes:d,communicationTypeId:u,assignees:v}=this.repairResponse.booking;this.bookingId=r,this.formModel.bookingInDate={...this.formModel.bookingInDate,value:t,disabled:!("complete"!==this.status?.toLowerCase()&&!this.isTechnician&&"readytoinvoice"!==this.status?.toLowerCase()&&"invoiced"!==this.status?.toLowerCase())},this.formModel.bookingOutDate={...this.formModel.bookingOutDate,value:n,disabled:!("complete"!==this.status?.toLowerCase()&&!this.isTechnician)},this.formModel.serviceType={...this.formModel.serviceType,selectedOption:{id:this.repairResponse.repairTypeId,name:this.repairResponse.repairType},disabled:!("complete"!==this.status?.toLowerCase()&&!this.isTechnician)},this.serviceTypeString=this.repairResponse.repairType,this.assigneeString=v?.map(y=>y.assigneeName).join(", "),this.formModel.notes={...this.formModel.notes,value:d,disabled:!("complete"!==this.status?.toLowerCase()&&!this.isTechnician)},this.formModel.towedIn={...this.formModel.towedIn,value:this.repairResponse.isTowingNeeded?"Towed In/Non-Drivable":"Not Towed In",disabled:!("complete"!==this.status?.toLowerCase()&&!this.isTechnician)},this.formModel.communicationChannel={...this.formModel.communicationChannel,value:u,disabled:!("complete"!==this.status?.toLowerCase()&&!this.isTechnician)},this.formModel.communicationChannel.options.forEach(y=>{y.checked=!!this.formModel.communicationChannel.value.some(w=>w==y.value)}),this.communicationForm.get("communicationChannel").setValue(this.formModel.communicationChannel.value);const P=[];if(this.formModel.jobAllocation={...this.formModel.jobAllocation,value:this.repairResponse.isJobAssignationRequired,disabled:!("complete"!==this.status?.toLowerCase()&&!this.isTechnician)},this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=this.repairResponse.isJobAssignationRequired),"repair"==this.repairResponse.repairType?.toLowerCase()){const y=[];this.repairResponse.repairServiceTypes.forEach(w=>{P.push({id:w.repairServiceTypeId,name:w.repairServiceType}),this.repairTypes.push({id:w.repairServiceTypeId,name:w.repairServiceType}),y.push(w.repairServiceType)}),this.repairTypesString=y.join(","),this.formModel.repairTypes={...this.formModel.repairTypes,selectedOption:P,disabled:!("complete"!==this.status?.toLowerCase()&&!this.isTechnician)},this.repairTypeDisabled=!1}else"repair"!=this.repairResponse.repairType?.toLowerCase()&&this.repairResponse.repairServiceTypes?.length>0&&(this.selectedOptionRepairs=[],this.repairResponse.repairServiceTypes.forEach(y=>{y.repairServiceTypeId&&this.selectedOptionRepairs.push({id:y.repairServiceTypeId,name:y.repairServiceType,dropdownItemIcon:this.getIcon(y.repairServiceType),disabled:!0})}));this.personalInfoData={...this.personalInfoData,bookingInDate:t,bookingOutDate:n,notes:d,communicationChannel:u,serviceType:this.repairResponse.repairType,jobAllocation:this.repairResponse.isJobAssignationRequired,serviceTypeId:this.repairResponse.repairTypeId,repairTypes:this.repairTypes?.length>0?this.repairTypes:null},this.initialBookingIn=t}populateVehicleData(){const{vinNumber:t,licensePlateNumber:n,vehicleMileage:r,registrationDate:s,vehicleMake:d,vehicleModel:u,modelYear:v,inspectionId:P,inspectionGuid:y,umc:w,id:D,modelYearRange:q,isVinSpecifiedManualZ:se}=this.repairResponse.vehicle;0!=D&&(this.infoDisabled=!1,this.searchDisabled=!1,this.inputDisabled=!1,this.originalVin=t),(!this.currentStatus||this.isTechnician)&&(this.infoDisabled=!0),this.formModel.vehicleData.vin={...this.formModel.vehicleData.vin,value:t,disabled:!(!this.caseId&&!this.isTechnician)},this.formModel.vehicleData.licensePlate={...this.formModel.vehicleData.licensePlate,value:n,disabled:!(!this.caseId&&!this.isTechnician)},this.formModel.vehicleData.carMilege={...this.formModel.vehicleData.carMilege,value:r,disabled:!(!this.caseId&&!this.isTechnician)},this.formModel.vehicleData.registrationDate={...this.formModel.vehicleData.registrationDate,value:s,disabled:!(!this.caseId&&!this.isTechnician)},this.formModel.vehicleData.make={...this.formModel.vehicleData.make,selectedOption:{name:d},disabled:!(!this.caseId&&!this.isTechnician)},this.formModel.vehicleData.year={...this.formModel.vehicleData.year,selectedOption:{name:"0"==q?null:q},disabled:!(!this.caseId&&!this.isTechnician)},this.formModel.vehicleData.model={...this.formModel.vehicleData.model,selectedOption:{modelDescription:u},disabled:!(!this.caseId&&!this.isTechnician)},this.umc=w,P&&this.commonService.inspectionId.next(P),this.vehicleFormData={...this.vehicleFormData,vin:t,make:d,model:u,year:v||q,carMilege:r,licensePlate:n,registrationDate:s,inspectionGuid:y,inspectionID:P,isVinSpecifiedManualZ:se}}prefillCaseData(t){if(t){const n=(0,X.Wk)(t.data);this.customerFormData=(0,X.Qb)(n);const r=Object.keys(this.formModel.customerData);this.customerFormData.tariffId=t.data.tariffs[0].tariffId,this.customerFormData.partnershipId=t.data.tariffs[0].partnershipId,this.labourData=t.data.tariffs[0],this.status=t.data.status;for(const s in r){const d=this.formModel.customerData[r[s]],{type:u,displayValue:v,fieldValue:P}=d;if(this.customerFormData[r[s]])if("select"===u){const y={};y[v]="",y[P]=this.customerFormData[r[s]],"companyOrgType"===r[s]&&(y[v]=this.customerFormData[r[s]]),this.formModel.customerData[r[s]]={...this.formModel.customerData[r[s]],value:"",selectedOption:y,disabled:!0}}else{let y={};"companyName"===r[s]&&(y={companyName:this.customerFormData[r[s]]}),this.formModel.customerData[r[s]]={...this.formModel.customerData[r[s]],value:this.customerFormData[r[s]],selectedOption:y,disabled:!0}}}this.checkWorkProvider(),this.processVehicleData(t)}}processVehicleData(t){var n=this;return(0,ue.Z)(function*(){if(null==t.data)return void n.commonService.hideLoading();const r=t.data.vehicleId||0,s=t.data.inspections,{inspectionId:d,inspectionGuid:u}=s?.length>0?s[0]:[];n.vehicleId=r;const{vinNumber:v,licensePlateNumber:P,vehicleMileage:y,registrationDate:w,vehicleMake:D,vehicleModel:q,modelYear:se,umc:Be}=t.data;0!=r&&(n.infoDisabled=!1,n.searchDisabled=!1,n.inputDisabled=!1,n.preventVinCall=!0),n.formModel.vehicleData.vin={...n.formModel.vehicleData.vin,value:v,disabled:!0},n.formModel.vehicleData.licensePlate={...n.formModel.vehicleData.licensePlate,value:P,disabled:!0},n.formModel.vehicleData.carMilege={...n.formModel.vehicleData.carMilege,value:y,disabled:!0},n.formModel.vehicleData.registrationDate={...n.formModel.vehicleData.registrationDate,value:w,disabled:!0},n.formModel.vehicleData.make={...n.formModel.vehicleData.make,selectedOption:{name:D},disabled:!0},n.formModel.vehicleData.year={...n.formModel.vehicleData.year,disabled:!0,selectedOption:{name:se||t.data.modelYearRange}},n.formModel.vehicleData.model={...n.formModel.vehicleData.model,selectedOption:{modelDescription:q},disabled:!0},n.umc=Be,n.vehicleFormData={...n.vehicleFormData,vin:v,make:D,model:q,year:se||t.data.modelYearRange,carMilege:y,licensePlate:P,registrationDate:w,vehicleId:r,inspectionGuid:u,inspectionID:d},n.commonService.hideLoading(),yield n.populateDropdowns()})()}updateButton(){var t=this;return(0,ue.Z)(function*(){t.monitorService.logEvent("updateButton",["PersonalInfoComponent","addenda-repair",{repairId:t.repairId}]),t.isFormConfirmed=!t.isFormConfirmed,t.setMode(t.isFormConfirmed?"text":"value"),"edit booking"==t.bookingButtonModel.label.toLowerCase()&&(t.preventVinCall=!0,t.vehicleFormData.vin&&t.vehicleService.getVinDecoder(t.vehicleFormData.vin).subscribe({next:r=>{t.makeDisabled=!!r?.success}}),yield t.populateDropdowns()),t.bookingButtonModel={...t.bookingButtonModel,label:t.isFormConfirmed?"Edit Booking":"Save",type:t.isFormConfirmed?"outline":"primary",icon:t.isFormConfirmed?"edit":""}})()}openDocument(){this.caseService.getCases({offset:0,pageSize:1,maxPageButtons:6,currentPage:1,orderBy:"CreatedDate",sortDirection:"asc"}).subscribe(n=>{if(n&&n.value&&n.value.length){const{CaseGuid:r}=n.value[0];this.router.navigate([`repair/booking/${r}/document`],{queryParams:{fromPersonal:!0}})}})}addVehicle(){var t=this;return(0,ue.Z)(function*(){const n={vin:t.vehicleFormData.vin,vehicleCountryId:1,umc:t.umc,make:t.vehicleFormData.make,model:t.vehicleFormData.model,mileage:Number(t.vehicleFormData.carMilege),firstRegistrationDate:E(t.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"),registrationNumber:t.vehicleFormData.licensePlate,condition:1,ModelYearRange:t.vehicleFormData.year,InspectionTemplateId:t.inspectionTemplateId,CustomerName:t.customerFormData.firstName,CustomerEmail:t.customerFormData.email};return(0,Ee.z)(t.vehicleService.addVehicle(n,3100,0)).then(r=>{r&&(t.vehicleId=r.id,t.vehicleFormData.inspectionID=r.inspectionId,t.vehicleFormData.inspectionGuid=r.inspectionGuid)}).catch(r=>{throw t.commonService.hideLoading(),r})})()}setPrefillData(t){const n=this.commonService.getSessionStorage("selectedSearchItem");if(!this.caseId&&n){const r=JSON.parse(n);if(this.formModel.customerData.email={...this.formModel.customerData.email,value:r.email,selectedOption:{}},this.customerFormData.email=r.email,r.firstName&&(this.customerFormData.firstName=r.firstName,this.formModel.customerData.firstName={...this.formModel.customerData.firstName,value:this.customerFormData.firstName,selectedOption:{}}),r.lastName&&(this.customerFormData.lastName=r.lastName,this.formModel.customerData.lastName={...this.formModel.customerData.lastName,value:this.customerFormData.lastName,selectedOption:{}}),r.phoneNumber){const s=r.phoneNumber?.substring(0,3),d=r.phoneNumber?.substring(0,4);let u="",v=t.filter(P=>P.phoneCountryCode===s);if(0===v.length?(u=r.phoneNumber?.substring(4,r.phoneNumber?.length),v=t.filter(P=>P.phoneCountryCode===d)):u=r.phoneNumber?.substring(3,r.phoneNumber?.length),v.length>0){const P=v[0],y=P.regExpression;this.customerFormData.driverCode=P?.phoneCountryCode,this.formModel.customerData.driverCode={...this.formModel.customerData.driverCode,selectedOption:P},this.driverPhone?.updateCurrentValidation(y,!0)}this.formModel.customerData.driverPhone={...this.formModel.customerData.driverPhone,value:u,selectedOption:{}},this.customerFormData.driverPhone=parseInt(u)}(r.email||r.phoneNumber||r.firstName)&&this.commonService.setSessionStorage("selectedSearchItem","")}}setRequiredLabel(){const t=["notes","repairtypes","claimnumber"];Object.keys(this.formModel).forEach(n=>{"customerdata"==n.toLowerCase()||"vehicledata"==n.toLowerCase()?Object.keys(this.formModel[n]).forEach(r=>{"vehicledata"==n.toLowerCase()?this.formModel[n][r].required=!1:t.includes(r.toLowerCase())||(this.formModel[n][r].required=!0)}):t.includes(n.toLowerCase())||(this.formModel[n].required=!0)}),this.startDate&&this.endDate?(this.personalInfoData.bookingInDate=E(this.startDate).local().utc().format(),this.formModel.bookingInDate={...this.formModel.bookingInDate,value:this.personalInfoData.bookingInDate},this.personalInfoData.bookingOutDate=E(this.endDate).local().utc().format(),this.formModel.bookingOutDate={...this.formModel.bookingOutDate,value:this.personalInfoData.bookingOutDate}):(this.personalInfoData.bookingInDate=E.utc(this.formModel.bookingInDate.value.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z",this.personalInfoData.bookingOutDate=E.utc(this.formModel.bookingOutDate.value.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z")}disableAll(){Object.keys(this.formModel).forEach(t=>{"customerdata"==t.toLowerCase()||"vehicledata"==t.toLowerCase()?Object.keys(this.formModel[t]).forEach(n=>{this.formModel[t][n].disabled=!0}):this.formModel[t].disabled=!0})}populateDropdowns(){var t=this;return(0,ue.Z)(function*(){t.formModel.customerData.driverCode.observable||(t.formModel.customerData.driverCode={...t.formModel.customerData.driverCode,observable:t.coreService.getPhoneNumber(),onObservableLoad:t.onObservableLoad.bind(t)});const n=yield(0,Ee.z)(t.settingService.getBookingRepairType()),r=n?.data?.BookingTypes;let s=n?.data?.RepairType?.length?n.data?.RepairType[0].RepairTypes:null;if(r&&r.length>0){if(t.formModel.serviceType={...t.formModel.serviceType,options:r},t.repairId&&!t.formModel.serviceType.options?.some(u=>u.id==t.repairResponse?.repairTypeId)){const u=yield(0,Ee.z)(t.settingService.getAllSettings()),P=u?.data?.BookingTypes.find(y=>y.id==t.repairResponse.repairTypeId);if(P&&t.formModel.serviceType.options.push(P),"repair"==t.personalInfoData.serviceType?.toLowerCase()){const y=t.formModel.repairTypes?.selectedOption;s=u?.data?.RepairType[0].RepairTypes?.length?u.data?.RepairType[0].RepairTypes?.filter(w=>!y?.map(D=>D.id).includes(w.id)):null,s=[...s,...y],s.sort((w,D)=>w.id<D.id?-1:w.id>D.id?1:0)}}else if(t.repairId&&"repair"==t.personalInfoData.serviceType?.toLowerCase()){const v=t.formModel.repairTypes?.selectedOption.filter(P=>!s.map(y=>y.id).includes(P.id));v.length>0&&(s=[...s,...v],s.sort((P,y)=>P.id<y.id?-1:P.id>y.id?1:0))}"repair"!=t.personalInfoData.serviceType?.toLowerCase()&&(t.formModel.bookingOutDate.disabled=!0)}s&&s.length>0&&(s.forEach((u,v)=>{s[v]=t.selectedOptionRepairs.some(P=>P.id===u.id)?{...s[v],dropdownItemIcon:t.getIcon(u.name),disabled:!0}:{...s[v],dropdownItemIcon:t.getIcon(u.name)}}),t.repairTypes=s,t.formModel.repairTypes={...t.formModel.repairTypes,options:s});const d=t.repairResponse?.repairServiceTypes;if(t.personalInfoData.serviceType&&("Repair"==t.personalInfoData.serviceType?(d.some(u=>u.employees.length>0)&&(yield t.getAllAssignedEmployees(d?.filter(u=>null!=u.repairServiceType))),t.previousCompetencies=t.formModel.repairTypes.selectedOption?.map(u=>u.id)):(t.selectedOptionRepairs?.length>0&&(t.previousCompetencies=t.selectedOptionRepairs?.map(u=>u.id)),yield t.getAllAssignedEmployeesAssessment(d?.filter(u=>null==u.repairServiceType)))),t.currentStatus){t.commonService.showLoading();const u=yield(0,Ee.z)(t.vehicleService.getVehicleMake());t.formModel.vehicleData.make={...t.formModel.vehicleData.make,options:u.sort((y,w)=>y.name.localeCompare(w.name))};const P=t.formModel.vehicleData.make.options.filter(y=>y.name===t.vehicleFormData.make);P.length>0&&t.vehicleService.getVehicleModel(P[0].id,t.estimateId).subscribe(y=>{t.formModel.vehicleData.model={...t.formModel.vehicleData.model,options:y};const w=t.formModel.vehicleData.model.options?.filter(D=>D.umc==t.umc||D.modelDescription==t.vehicleFormData.model);w.length>0&&t.vehicleService.getVehicleYearByModel(w[0].id,t.estimateId)?.subscribe(D=>{t.formModel.vehicleData.year={...t.formModel.vehicleData.year,options:D}})}),t.commonService.hideLoading()}})()}prefillVehicleData(){const t=this.commonService.getSessionStorage("selectedSearchItem");if(t){const n=JSON.parse(t);n.make&&!this.vehicleFormData.make&&(this.vehicleFormData.make=n.make,this.formModel.vehicleData.make={...this.formModel.vehicleData.make,selectedOption:{name:n.make}}),n.model&&!this.vehicleFormData.model&&(this.vehicleFormData.model=n.model,this.formModel.vehicleData.model={...this.formModel.vehicleData.model,selectedOption:{modelDescription:n.model}}),n.vin&&!this.vehicleFormData.vin&&(this.vehicleFormData.vin=n.vin,this.preventVinCall=!0,this.formModel.vehicleData.vin={...this.formModel.vehicleData.vin,value:n.vin}),n.importInterval&&!this.vehicleFormData.year&&(this.vehicleFormData.year=n.importInterval,this.formModel.vehicleData.year={...this.formModel.vehicleData.year,value:n.importInterval,selectedOption:{name:n.importInterval}}),n.plate&&!this.vehicleFormData.licensePlate&&(this.vehicleFormData.licensePlate=n.plate,this.formModel.vehicleData.licensePlate={...this.formModel.vehicleData.licensePlate,value:n.plate}),(n.make||n.model||n.vin||n.plate)&&(this.infoDisabled=!1,this.searchDisabled=!1,this.inputDisabled=!1,(!n.email||!n.name||!n.phoneNumber)&&this.commonService.setSessionStorage("selectedSearchItem",""))}}onObservableLoad(t){if(this.commonService.hideLoading(),t&&t&&t.length>0){const n=t.filter(r=>r.phoneCountryCode===this.formModel.customerData.driverCode.selectedOption?.phoneCountryCode);if(n.length>0){const r=n[0],s=r.regExpression;this.formModel.customerData.driverCode={...this.formModel.customerData.driverCode,selectedOption:r},this.driverPhone&&this.driverPhone.updateCurrentValidation(s,!0),this.repairId||this.setPrefillData(t)}}}onObservableLoadRepairTypes(t){this.commonService.hideLoading(),t&&t.length>0&&t.forEach((n,r)=>{t[r]={...t[r],dropdownItemIcon:this.getIcon(n.name)}}),this.formModel.repairTypes={...this.formModel.repairTypes,options:t}}onObservableLoadServiceAndRepairTypes(t){if(this.commonService.hideLoading(),t){const n=t.BookingTypes,r=t.RepairType?.length?t.RepairType[0].RepairTypes:null;n&&n.length>0&&(this.formModel.serviceType={...this.formModel.serviceType,options:n}),r&&r.length>0&&(r.forEach((s,d)=>{r[d]={...r[d],dropdownItemIcon:this.getIcon(s.name)}}),this.formModel.repairTypes={...this.formModel.repairTypes,options:r})}}getIcon(t){switch(t){case"Body":return"car";case"Maintenance":return"house";case"Tires":return"tire";case"Paint":return"paintbrush";case"Others":return"gears";case"Electric":case"Electrical":return"bolt-car";case"Diagnosis":return"diagnosis";case"Mechanical":return"mechanical";default:return""}}setMode(t="text"){Object.keys(this.formModel).forEach(r=>{"customerdata"==r.toLowerCase()||"vehicledata"==r.toLowerCase()?Object.keys(this.formModel[r]).forEach(s=>{if("customerdata"==r.toLowerCase())if(this.formModel[r][s].required=!1,"companyOrgType"===s){const d={},{displayValue:u,fieldValue:v}=this.formModel[r][s];d[v]=this.customerFormData[s],d[u]="",d[u]=this.customerFormData[s],this.formModel[r][s]={...this.formModel[r][s],mode:t}}else this.formModel[r][s]={...this.formModel[r][s],mode:t};else this.formModel[r][s]={...this.formModel[r][s],mode:t}}):this.formModel[r]={...this.formModel[r],mode:t}}),"text"==t&&(this.bookingButtonModel={...this.bookingButtonModel,label:"Edit Booking",type:"outline",icon:"edit"})}onFormUpdate(t){var n=this;return(0,ue.Z)(function*(){if("select"===t.type){if(n.formModel[t.name]={...n.formModel[t.name],selectedOption:t.value},n.personalInfoData[t.name]="repairTypes"!==t.name?t.value[n.formModel[t.name].fieldValue]:t.value,"repairTypes"===t.name){if(""==t.value&&(n.formModel[t.name]={...n.formModel[t.name],selectedOption:[]}),setTimeout(()=>{n.repairType?.setUnTouched()}),1==n.personalInfoData.jobAllocation){let s=[];n.previousCompetencies.length<n.formModel.repairTypes.selectedOption?.length?(s=n.personalInfoData[t.name]?.filter(d=>!n.previousCompetencies.includes(d.id)),s&&s.length?yield n.getAllAssignedEmployees(n.repairResponse?.repairServiceTypes,s[0].id):yield n.getAllAssignedEmployees(n.repairResponse?.repairServiceTypes)):(s=n.previousCompetencies?.filter(d=>!n.formModel.repairTypes.selectedOption?.map(u=>u.id).includes(d)),s.length&&(n.repairEmployees=n.repairEmployees.filter(d=>d.repairId!=s[0]),n.employeeRepairServiceType=n.employeeRepairServiceType?.filter(d=>d.repairServiceTypeId!=s[0])))}!n.repairEmployees?.some(s=>s.employees?.length>0)&&n.personalInfoData.jobAllocation&&(n.commonService.showInfoToast(1e3,"msg_no_competency"),n.formModel.jobAllocation={...n.formModel.jobAllocation,value:!1},n.formModel.jobAllocation.options.length&&(n.formModel.jobAllocation.options[0].checked=!1),n.personalInfoData.jobAllocation=!1),n.previousCompetencies=n.formModel[t.name].selectedOption?.map(s=>s.id)}else if("serviceType"===t.name)if(n.personalInfoData.serviceType=t.value.name,n.personalInfoData.serviceTypeId=t.value.id,n.formModel.jobAllocation={...n.formModel.jobAllocation,value:!1},n.formModel.jobAllocation.options.length&&(n.formModel.jobAllocation.options[0].checked=!1),n.personalInfoData.jobAllocation=!1,n.employeeRepairServiceType=[],n.repairEmployees=[],n.previousCompetencies=n.selectedOptionRepairs?.length>0?n.selectedOptionRepairs?.map(s=>s.id):[],"Repair"==t.value?.name){if(n.selectedOptionRepairs.length>0&&"repair"!=n.serviceTypeString.toLowerCase()){const s=n.selectedOptionRepairs?.filter(d=>!n.repairTypes?.map(u=>u.id)?.includes(d.id));s?.length>0&&(n.repairTypes=[...n.repairTypes,...s]),n.formModel.repairTypes={...n.formModel.repairTypes,selectedOption:n.selectedOptionRepairs},n.personalInfoData.repairTypes=n.selectedOptionRepairs}n.formModel.repairTypes={...n.formModel.repairTypes,options:n.repairTypes},n.repairTypeDisabled=!1,n.formModel.bookingOutDate.disabled=!1,n.formModel.repairTypes.required=!0}else{n.formModel.repairTypes.required=!1;const s=n.formModel.serviceType.options.find(d=>d.id==t.value.id);if(s?.duration){const d=E.utc(n.formModel.bookingInDate.value.toString()).add(s?.duration,"minutes").toDate();n.formModel.bookingOutDate={...n.formModel.bookingOutDate,value:d},n.personalInfoData.bookingOutDate=E(d).local().utc().format(),n.formModel.bookingOutDate.disabled=!0}n.formModel.repairTypes={...n.formModel.repairTypes,selectedOption:[],options:[],placeHolder:"Select..."},n.personalInfoData.repairTypes=null,setTimeout(()=>{n.repairType&&(n.repairType.dropdownValidationMessage="",n.repairType.dropdownContainer.dropdownConfig.isTouched=!1,n.repairType.dropdownContainer.dropdownConfig.isDirty=!1)},0),n.repairTypeDisabled=!0}}else if("jobAllocation"==t.name)n.repairEmployees=[],"repair"===n.personalInfoData.serviceType.toLowerCase()?n.formModel.repairTypes.selectedOption?.length&&(1==t.value?(yield n.getAllAssignedEmployees(n.repairResponse?.repairServiceTypes),n.repairEmployees?.some(r=>r.employees?.length>0)||(n.commonService.showInfoToast(1e3,"msg_no_competency"),t.value=!1,n.formModel.jobAllocation={...n.formModel.jobAllocation,value:!1},n.formModel.jobAllocation.options.length&&(n.formModel.jobAllocation.options[0].checked=!1))):(n.repairResponse?.repairServiceTypes?.length&&(n.repairResponse.repairServiceTypes[0].employees=n.repairResponse?.repairServiceTypes[0].employees.filter(r=>null!=r.assigneeId)),n.employeeRepairServiceType=[])):n.personalInfoData.serviceType&&(1==t.value?(yield n.getAllAssignedEmployeesAssessment(0==n.selectedOptionRepairs?.length?n.repairResponse?.repairServiceTypes:[]),0==n.repairEmployees?.length&&(n.commonService.showInfoToast(1e3,"msg_no_competency"),t.value=!1,n.formModel.jobAllocation={...n.formModel.jobAllocation,value:!1},n.formModel.jobAllocation.options.length&&(n.formModel.jobAllocation.options[0].checked=!1))):(n.repairResponse?.repairServiceTypes?.length&&(n.repairResponse.repairServiceTypes[0].employees=n.repairResponse?.repairServiceTypes[0].employees.filter(r=>null!=r.assigneeId)),n.employeeRepairServiceType=[])),n.formModel[t.name].value=t.value,n.personalInfoData[t.name]=t.value;else if("checkbox"==t.type){if(t.value)n.personalInfoData.communicationChannel.push(t.keyFieldValue);else if(n.personalInfoData.communicationChannel.includes(t.keyFieldValue)){const r=n.personalInfoData.communicationChannel.indexOf(t.keyFieldValue);r>-1&&n.personalInfoData.communicationChannel.splice(r,1)}n.communicationForm.get("communicationChannel").setValue(n.personalInfoData.communicationChannel)}else{if("towedin"==t.name.toLowerCase())n.towingDisabled="towed in/non-drivable"!=t.value.toLowerCase();else if("bookingInDate"==t.name){if(n.repairId){if(n.initialBookingIn==t.value)return;if(new Date(E(new Date(t.value)).format("YYYY-MM-DDTHH:mm"))<new Date(E(new Date).format("YYYY-MM-DDTHH:mm")))return n.commonService.showInfoToast(5e3,"msg_enter_future_date"),n.formModel.bookingInDate={...n.formModel.bookingInDate,value:n.initialBookingIn},n.personalInfoData[t.name]=n.initialBookingIn,void(n.bookingInDateCalled=!0)}if("repair"!=n.personalInfoData.serviceType?.toLowerCase()){const r=n.formModel.serviceType.options.find(s=>s.id==n.personalInfoData.serviceTypeId);if(r?.duration){const s=E.utc(t.value).add(r?.duration,"minutes").toDate();n.formModel.bookingOutDate={...n.formModel.bookingOutDate,value:s},n.personalInfoData.bookingOutDate=E(s).local().utc().format()}}}t.isValid?(n.formModel[t.name].value=t.value,n.personalInfoData[t.name]=t.value):(n.formModel[t.name].value="",n.personalInfoData[t.name]=""),"bookingInDate"==t.name?t.isValid&&new Date(n.personalInfoData.bookingOutDate)>new Date(t.value)&&n.personalInfoData.jobAllocation&&(n.repairEmployees=[],n.employeeRepairServiceType=[],"repair"==n.personalInfoData.serviceType?.toLowerCase()?yield n.getAllAssignedEmployees(n.repairResponse?.repairServiceTypes):yield n.getAllAssignedEmployeesAssessment(0==n.selectedOptionRepairs?.length?n.repairResponse?.repairServiceTypes:[])):"bookingOutDate"==t.name&&t.isValid&&new Date(t.value)>new Date(n.personalInfoData.bookingInDate)&&n.personalInfoData.jobAllocation&&(n.repairEmployees=[],n.employeeRepairServiceType=[],"repair"==n.personalInfoData.serviceType?.toLowerCase()?yield n.getAllAssignedEmployees(n.repairResponse?.repairServiceTypes):yield n.getAllAssignedEmployeesAssessment(0==n.selectedOptionRepairs?.length?n.repairResponse?.repairServiceTypes:[]))}n.personalInfoData={...n.personalInfoData},n.checkForFormValidation()})()}getAllAssignedEmployees(t=[],n=0){var r=this;return(0,ue.Z)(function*(){const s=[];0==n?r.formModel.repairTypes?.selectedOption?.forEach(d=>{s.push(d.id)}):s.push(n),s.length>0&&(r.commonService.showLoading(),yield(0,Ee.z)(r.bookingService.getEmployeesByCompetencies(s,r.personalInfoData.bookingInDate,r.personalInfoData.bookingOutDate,null,r.bookingId??null)).then(d=>{d?.data&&d.data.forEach(u=>{let v=[],P=[],y=[];t?.length&&(v=t.filter(D=>D.repairServiceTypeId==u.repairServiceTypeId),v.length&&(P=v[0].employees.map(D=>D.assigneeId||D.employeeId),r.employeeRepairServiceType?.some(D=>D.repairServiceTypeId==u.repairServiceTypeId)||r.employeeRepairServiceType.push({employees:P,repairServiceTypeId:u.repairServiceTypeId}),y=u.employees.filter(D=>!P.includes(D.employeeId))));const w=r.formModel.repairTypes.selectedOption?.filter(D=>D.id==u.repairServiceTypeId).map(D=>D.name);r.repairEmployees.push({repair:w,repairId:u.repairServiceTypeId,employees:v.length>0?y:u.employees,employeesAssigned:v.length>0?v[0].employees:[],active:!0})}),r.commonService.hideLoading()}).catch(()=>{r.commonService.hideLoading()}))})()}getAllAssignedEmployeesAssessment(t=[]){var n=this;return(0,ue.Z)(function*(){n.commonService.showLoading(),yield(0,Ee.z)(n.bookingService.getEmployeesByCompetencies(null,n.personalInfoData.bookingInDate,n.personalInfoData.bookingOutDate,null,n.bookingId??null)).then(r=>{if(r?.data){n.repairEmployees=[];let s=[],d=[],u=[];t?.length?(s=t,d=s[0].employees.map(v=>v.assigneeId||v.employeeId),n.employeeRepairServiceType.push({employees:d,repairServiceTypeId:null}),u=r?.data.filter(v=>!d.includes(v.employeeId)),n.repairEmployees.push({repair:"",repairId:null,employees:u,employeesAssigned:s[0].employees})):n.repairEmployees.push({repair:"",repairId:null,employees:r.data,employeesAssigned:[]})}n.commonService.hideLoading()}).catch(()=>{n.commonService.hideLoading()})})()}setMinutesAndHours(t,n){const s=t,d=new Date(n).getTime()-new Date(s).getTime(),u=Math.round(d/6e4),v=Math.floor(u/60);this.formModel.estimatedEffortMinutes={...this.formModel.estimatedEffortMinutes,value:u%60},this.formModel.estimatedEffortHour={...this.formModel.estimatedEffortHour,value:v}}onFormUpdateCustomer(t){if("driverCode"===t.name&&this.driverPhone?.updateCurrentValidation(t.value.regExpression),"select"===t.type){const n=this.customerFormData[t.name],r=this.formModel.customerData[t.name].fieldValue||this.formModel.customerData[t.name].displayValue;if(this.formModel[t.name]?.selectedOption&&this.formModel[t.name]?.selectedOption[r]===t?.value[r])return;this.formModel.customerData[t.name]={...this.formModel.customerData[t.name],selectedOption:t.value},this.customerFormData[t.name]=t.value[r],"companyOrgType"===t.name&&(n!==this.customerFormData[t.name]&&setTimeout(()=>{this.companyOrg?.setUnTouched(),this.licenseId?.setUnTouched()}),t.value[r]&&"Insurance Company"!==t.value[this.formModel.customerData[t.name].displayValue]&&(this.formModel.customerData.claimNumber={...this.formModel.customerData.claimNumber,value:""}),t.value[r]&&"Retail"!==t.value[this.formModel.customerData[t.name].displayValue]?(this.formModel.customerData.companyName={...this.formModel.customerData.companyName,displayValue:"companyName",fieldValue:"companyName",onObservableLoad:this.updateCaseData.bind(this),placeHolder:"Select...",value:"",type:"select",observable:this.caseService.getCompanyData(t.value[r],"")},this.formModel.customerData.companyName.selectedOption&&this.formModel.customerData.companyName.selectedOption?.tariffId&&(this.customerFormData.companyId=null,this.customerFormData.companyName=null,this.formModel.customerData.companyName.selectedOption={}),this.customerFormData.licenseId="",this.formModel.customerData.licenseId={...this.formModel.customerData.licenseId,value:""},setTimeout(()=>{n&&"Retail"!==n&&this.currentStatus&&this.companyOrg?.triggerObservable()})):(t.value[r]&&"Retail"===t.value[this.formModel.customerData[t.name].displayValue]&&(this.formModel.customerData.claimNumber={...this.formModel.customerData.claimNumber,value:""},this.formModel.customerData.companyName={...this.formModel.customerData.companyName,placeHolder:"Company Name"},this.customerFormData.claimNumber="",this.caseService.getCompanyData(t.value[r],"").subscribe({next:s=>{if(s&&s.data?.length>0){const d=s.data[0];this.customerFormData.companyId=d.companyId,this.customerFormData.tariffId=d.tariffId,this.formModel.customerData.companyName.selectedOption&&this.formModel.customerData.companyName.selectedOption?.tariffId&&(this.customerFormData.licenseId="",this.formModel.customerData.licenseId={...this.formModel?.customerData.licenseId,value:""}),"Person"===this.customerFormData[this.formModel.customerData.carOwnerSelector.name]&&(this.customerFormData.companyName=null,this.formModel.customerData.companyName.value=""),this.customerFormData.isTariffEditable=d.isEditable,this.customerFormData.partnershipId=d.partnershipId,this.formModel.customerData.companyName.selectedOption=d[0],this.checkForFormValidation()}},error:()=>{this.customerFormData.tariffId=0,this.customerFormData.isTariffEditable=!1}})),this.formModel.customerData.companyName={...this.formModel.customerData.companyName,type:"text"})),"companyName"===t.name&&t.value&&(this.customerFormData.companyId=t.value.companyId,this.customerFormData.tariffId=t.value.tariffId,this.customerFormData.isTariffEditable=t.value.isEditable,this.customerFormData.licenseId=t.value.licenseId.toString(),this.formModel.customerData.licenseId={...this.formModel?.customerData.licenseId,value:t.value.licenseId.toString()},this.customerFormData.partnershipId=t.value.partnershipId),this.customerFormData[this.formModel.customerData[t.name].idField]=t.value[this.formModel.customerData[t.name].displayValue]}else"carOwnerSelector"===t.name&&t.keyFieldValue&&this.formModel.customerData[t.name].idField&&(this.customerFormData[this.formModel.customerData[t.name].idField]=t.keyFieldValue),t.isValid?(this.formModel.customerData[t.name].value=t.value,this.customerFormData[t.name]=t.value):(this.formModel.customerData[t.name].value="",this.customerFormData[t.name]="driverPhone"!==t.name?"":0);this.customerFormData={...this.customerFormData},this.checkForFormValidation(),this.checkWorkProvider()}checkWorkProvider(){if(this.customerFormData.companyOrgType)if("Insurance Company"===this.customerFormData.companyOrgType){if(this.customerFormData.companyId)return this.chqUploadDrivingLicense={...this.chqUploadDrivingLicense,type:"outline"},void(this.chqUploadRegistrationCard={...this.chqUploadRegistrationCard,type:"outline"})}else if("Retail"!=this.customerFormData.companyOrgType){if(this.customerFormData.companyId)return this.chqUploadDrivingLicense={...this.chqUploadDrivingLicense,type:"outline"},void(this.chqUploadRegistrationCard={...this.chqUploadRegistrationCard,type:"outline"})}else if(this.customerFormData.carOwnerSelector){if("Person"===this.customerFormData.carOwnerSelector)return this.chqUploadDrivingLicense={...this.chqUploadDrivingLicense,type:"outline"},void(this.chqUploadRegistrationCard={...this.chqUploadRegistrationCard,type:"outline"});if(this.customerFormData.companyName&&this.customerFormData.licenseId)return this.chqUploadDrivingLicense={...this.chqUploadDrivingLicense,type:"outline"},void(this.chqUploadRegistrationCard={...this.chqUploadRegistrationCard,type:"outline"})}this.chqUploadDrivingLicense={...this.chqUploadDrivingLicense,type:"disabled-outline"},this.chqUploadRegistrationCard={...this.chqUploadRegistrationCard,type:"disabled-outline"}}checkForFormValidationCustomer(){const t=Object.keys(this.customerFormData);let n=["claimNumber"];"Retail"===this.retail?n="Person"===this.customerFormData.carOwnerSelector?["companyName","claimNumber","licenseId","companyId"]:["claimNumber","companyId"]:"Insurance Company"!=this.customerFormData.companyOrgType&&(n=["claimNumber"]);let r=!0;for(const s in t){const d=t[s];if("isTariffEditable"!==d&&-1===n.indexOf(d)&&"carOwnerSelector"!=d&&"jobNumber"!=d&&"caseTypeID"!=d&&"tariffid"!=d.toLowerCase()&&"customerid"!=d.toLowerCase()&&"contactid"!=d.toLowerCase()&&!this.customerFormData[d]){r=!1;break}}return r}checkForFormValidationBooking(t=!1){this.monitorService.logEvent("checkForFormValidationBooking",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]);const n=["notes","repairtypes"],r=Object.keys(this.personalInfoData);let s=!0;for(const d in r){const u=r[d];if(!("customerdata"==u.toLowerCase()||"vehicledata"==u.toLowerCase()||"assignedto"==u.toLowerCase()||"joballocation"==u.toLowerCase()&&!this.personalInfoData[u]||"communicationchannel"==u.toLowerCase()&&0===this.formModel.communicationChannel.options?.length)){if("joballocation"==u.toLowerCase()&&!this.employeeRepairServiceType?.some(v=>v.employees?.length>0)){s=!1;break}if(Array.isArray(this.personalInfoData[u])&&0==this.personalInfoData[u].length){s=!1;break}if("repairtypes"==u.toLowerCase()&&"repair"==this.formModel.serviceType.selectedOption?.name?.toLowerCase()&&(!this.personalInfoData[u]||0==this.personalInfoData[u].length)){s=!1;break}if(!this.personalInfoData[u]&&!n.includes(u.toLowerCase())){s=!1;break}}}return s}checkForFormValidationVehicle(){this.monitorService.logEvent("checkForFormValidationVehicle",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]);let t=!0;return this.validVehicleFields.some(n=>0==n.valid)&&(t=!1),t}checkForFormValidation(){return this.isFormConfirmed?(this.bookingButtonModel.type="outline",!1):this.checkForFormValidationCustomer()&&this.checkForFormValidationBooking()&&this.checkForFormValidationVehicle()?(this.canNavigate=!0,this.bookingButtonModel.type="primary",!0):(this.bookingButtonModel.type="disabled",!1)}validateVehicle(){const t=Object.keys(this.vehicleFormData);let n=!0;for(const r in t){const s=t[r];if("inspectionid"!=s.toLowerCase()&&"inspectionguid"!=s.toLowerCase()&&"isvinspecifiedmanualz"!=s.toLowerCase()&&!this.vehicleFormData[s]){n=!1;break}}return n}validateBookingTime(){if(E(this.personalInfoData.bookingInDate).diff(new Date)>1||this.repairId&&"0"!=this.repairId)return!0;if(E.utc(new Date).diff(new Date(this.personalInfoData.bookingInDate),"minute")<=30){const n=E(new Date(this.personalInfoData.bookingOutDate)).diff(new Date(new Date(this.personalInfoData.bookingInDate)),"minute");return this.personalInfoData.bookingInDate=E(new Date).add(1,"minute").local().utc().format(),this.personalInfoData.bookingOutDate=E(new Date).add(n,"minute").local().utc().format(),!0}return this.commonService.showToast(0,"bookingin_greater_msg"),!1}submitForm(t,n,r){var s=this;return(0,ue.Z)(function*(){if(s.monitorService.logEvent("submitForm",["PersonalInfoComponent","addenda-repair",{repairId:s.repairId}]),s.isFormConfirmed)return s.formModel.customerData.companyOrgType.observable||(s.formModel.customerData.companyOrgType.selectedOption.name="",s.formModel.customerData.companyOrgType.observable=s.caseService.getProviders(),setTimeout(()=>{s.orgType?.triggerObservable()})),void s.updateButton();if(s.commonService.showLoading(),!s.validateBookingTime())return void s.commonService.hideLoading();const d={vin:s.vehicleFormData.vin,umc:s.umc,vehicleMake:s.vehicleFormData.make,vehicleModel:s.vehicleFormData.model,modelYearRange:s.vinGTMotive?.modelYearRange||s.vehicleFormData.year,vehicleID:parseInt(s.vehicleId)||0,licensePlateNumber:s.vehicleFormData.licensePlate,vehicleMileage:Number(s.vehicleFormData.carMilege),registrationDate:s.vehicleFormData.registrationDate?E(s.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"):null,inspectionID:s.vehicleFormData.inspectionID,inspectionGuid:s.vehicleFormData.inspectionGuid,isVinSpecifiedManualZ:s.vehicleFormData.isVinSpecifiedManualZ},u={companyOrgType:s.customerFormData.companyOrgType,customerTypeID:"Retail"===s.customerFormData.companyOrgType?s.customerFormData.customerTypeID:null,firstName:s.customerFormData.firstName,lastName:s.customerFormData.lastName,countryCode:s.customerFormData.driverCode,mobileNumber:s.customerFormData.driverPhone.toString(),email:s.customerFormData.email,companyId:s.customerFormData.companyId,workProviderId:s.customerFormData.partnershipId,claimNumber:"Insurance Company"===s.customerFormData.companyOrgType?s.customerFormData.claimNumber:"",companyName:s.isRetailAndCompanyProvider?s.customerFormData.companyName:"",companyLicenseNumber:s.isRetailAndCompanyProvider?s.customerFormData.licenseId:"",customerId:s.repairResponse?.customer?.customerId||"",contactId:s.repairResponse?.customer?.contactId,tariffId:s.customerFormData.tariffId,isTariffEditable:s.customerFormData.isTariffEditable,partnershipId:s.customerFormData.partnershipId};let v=[];"Repair"===s.formModel.serviceType.selectedOption?.name?s.personalInfoData.jobAllocation?(v=s.employeeRepairServiceType,s.personalInfoData.repairTypes?.filter(w=>!s.employeeRepairServiceType.map(D=>D.repairServiceTypeId).includes(w.id))?.forEach(w=>{s.employeeRepairServiceType.push({repairServiceTypeId:w.id})})):s.personalInfoData.repairTypes?.forEach(y=>{v.push({repairServiceTypeId:y.id,repairServiceTypeMappingId:0,repairServiceTypeEmployeeMappings:[]})}):(v=s.personalInfoData.jobAllocation?s.employeeRepairServiceType:null,s.personalInfoData.repairTypes=null);const P={domainId:3100,isTowingNeeded:"Towed In/Non-Drivable"==s.personalInfoData.towedIn,customer:u,vehicle:d,booking:{typeId:s.personalInfoData.serviceTypeId||null,typeName:s.personalInfoData.serviceType||null,bookingIn:s.personalInfoData.bookingInDate,bookingOut:s.personalInfoData.bookingOutDate,slotTypeID:null,notes:s.personalInfoData.notes,communicationTypeId:s.personalInfoData.communicationChannel},repairServiceTypes:v,statusId:s.statusId||"",isJobAssignationRequired:s.personalInfoData.jobAllocation||!1};if(s.caseId&&(P.quoteGuid=s.caseId,s.vehicleId&&(d.vehicleID=parseInt(s.vehicleId))),!s.caseId&&(s.validateVehicle()&&(!s.vehicleId||"0"==s.vehicleId)||s.validateVehicle()&&s.vehicleFormData.vin!==s.originalVin&&s.vehicleId))try{yield s.addVehicle(),P.vehicle.inspectionID=s.vehicleFormData.inspectionID,P.vehicle.inspectionGuid=s.vehicleFormData.inspectionGuid,P.vehicle.vehicleID=s.vehicleId}catch{return}var y;s.repairId?s.updateBooking(P,t):s.bookingService.addRepairBookings(P).subscribe({next:(y=(0,ue.Z)(function*(w){if(w){if(console.log(w),s.repairId=w.data?.repairGuid,s.status=w.data?.status,s.statusId=w.data?.statusId,P.repairDateCreated=w.data?.createdDate,s.objectId=w.data?.id,s.repairId=w.data?.repairGuid,s.commonService.repairGuid.next(w.data?.repairGuid),s.vehicleId&&"0"!=s.vehicleId&&!s.caseId){let D=!1;if(yield s.updateVehicle(P).then(q=>{q&&s.showLabourUpdateMessage()&&(D=!0)}),D)return}if(s.commonService.hideLoading(),n)r&&r();else if(t&&"string"==typeof t){if((t.includes("/photos")||t.includes("/estimate"))&&(!s.vehicleId||"0"==s.vehicleId))return void s.commonService.openAlertDialog("Notification","msg_add_vehicle").afterClosed().subscribe({next:D=>{}});-1!=t.indexOf("?mode=edit")?(t=t.replace("?mode=edit",""),s.router.navigate([t.replace("{bookingId}",w.data?.repairGuid)],{queryParams:{mode:"edit"}})):s.router.navigate([t.replace("{bookingId}",w.data?.repairGuid)])}else s.router.navigate(["/repair/booking-journal"],{queryParams:{bookInDate:s.personalInfoData.bookingInDate}})}}),function(D){return y.apply(this,arguments)}),error:y=>{s.commonService.hideLoading()}})})()}expandCollapseAssignedTo(t){t.active=!t.active}unAssignEmployee(t,n){const r=this.translateService.instant("unassign"),s=this.translateService.instant("unassign_employee_msg");this.commonService.openDeleteDialog(r,s).afterClosed().subscribe(u=>{if(u){const v=this.employeeRepairServiceType.filter(P=>P.repairServiceTypeId==n.repairId);if(v.length){const P=t.assigneeId||t.employeeId;v[0].employees=v[0].employees?.filter(w=>w!=P);let y=n.employeesAssigned?.filter(w=>(w.assigneeId||w.employeeId)==P)[0];y={...y,isAvailable:!0},n.employees?.push(y),n.employeesAssigned=n.employeesAssigned?.filter(w=>(w.assigneeId||w.employeeId)!=P)}this.checkForFormValidation()}})}showLabourUpdateMessage(){if(this.monitorService.logEvent("showLabourUpdateMessage",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.labourData?.isEditable){let t=!0;if(this.labourData.tariffLabourRates.forEach(n=>{n.amount>0&&(t=!1)}),t){const n={objectId:this.repairId,link:"here",labourData:this.labourData,from:Sn.j.repair};return this.commonService.hideLoading(),this.commonService.showInfoToast(5e5,this.translateService.instant("labour_value_update"),n),!0}return!1}return!1}updateVehicle(t){var n=this;return(0,ue.Z)(function*(){n.monitorService.logEvent("updateVehicle",["PersonalInfoComponent","addenda-repair",{repairId:n.repairId}]),n.commonService.showLoading();const r={vin:n.vehicleFormData.vin,umc:n.umc,vehicleMake:n.vehicleFormData.make,vehicleModel:n.vehicleFormData.model,modelYearRange:n.vinGTMotive?.modelYearRange||n.vehicleFormData.year,vehicleID:t.vehicle?.vehicleID,licensePlateNumber:n.vehicleFormData.licensePlate,vehicleMileage:Number(n.vehicleFormData.carMilege),registrationDate:E(n.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00")},s={inspectionID:t.vehicle?.inspectionID||n.inspections?.inspectionId,inspectionGuid:t.vehicle?.inspectionGuid||n.inspections?.inspectionGuid};return n.caseId||(n.originalTariffObject.make!=n.vehicleFormData.make||n.customerFormData.partnershipId!=n.originalTariffObject.partnershipId||E(n.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00")!=n.originalTariffObject.registrationDate||!n.labourData?.tariffLabourRates?.length)&&(yield n.getLabourData(n.customerFormData.tariffId,n.customerFormData.isTariffEditable,n.customerFormData.partnershipId,n.vehicleFormData.make,t.repairDateCreated)),(0,Ee.z)(n.vehicleService.updateVehicleRepair({vehicle:r,inspection:s,tariff:n.labourData},n.repairId))})()}getLabourData(t,n,r,s,d){var u=this;return(0,ue.Z)(function*(){return u.monitorService.logEvent("getLabourData",["PersonalInfoComponent","addenda-repair",{repairId:u.repairId}]),(0,Ee.z)(u.labourService.getLabourData(t,s,E(u.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"),d)).then(v=>{v.data&&(u.labourData={tariffId:v.data.id,tariffDiscountRates:v.data.tariffDiscountRates,tariffLabourRates:v.data.tariffLaborRates,isEditable:n,partnershipId:r})})})()}updateBooking(t,n){var s,r=this;this.monitorService.logEvent("updateBooking",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),t.repairGuid=this.repairId,this.bookingService.updateRepairBooking(t,this.repairId).subscribe({next:(s=(0,ue.Z)(function*(d){if(d){if(r.repairId=d.data?.repairGuid,t.repairDateCreated=d.data?.createdDate,r.vehicleId&&"0"!=r.vehicleId&&!r.caseId){let u=!1;if(yield r.updateVehicle(t).then(v=>{v&&r.showLabourUpdateMessage()&&(u=!0)}),u)return}if(r.commonService.hideLoading(),n&&"string"==typeof n){if((n.includes("/photos")||n.includes("/estimate"))&&(!r.vehicleId||"0"==r.vehicleId))return void r.commonService.openAlertDialog("Notification","msg_add_vehicle").afterClosed().subscribe({next:u=>{}});-1!=n.indexOf("?mode=edit")?(n=n.replace("?mode=edit",""),r.router.navigate([n.replace("{bookingId}",d.data?.repairGuid)],{queryParams:{mode:"edit"}})):r.router.navigate([n.replace("{bookingId}",d.data?.repairGuid)])}else r.router.navigate(["/repair/booking-journal"],{queryParams:{bookInDate:r.personalInfoData.bookingInDate}})}}),function(u){return s.apply(this,arguments)}),error:s=>{this.commonService.hideLoading()}})}onFormUpdateVehicle(t){if(this.monitorService.logEvent("onFormUpdateVehicle",["PersonalInfoComponent","addenda-quote",{repairId:this.repairId,output:t}]),"select"===t.type)this.formModel.vehicleData[t.name]={...this.formModel.vehicleData[t.name],selectedOption:t.value},this.vehicleFormData[t.name]=t.value[this.formModel.vehicleData[t.name].fieldValue],"make"==t.name?(this.vehicleFormData.model=null,this.vehicleFormData.year=null,this.modelDisabled=!0,this.yearDisabled=!0,this.formModel.vehicleData.year={...this.formModel.vehicleData.year,selectedOption:{},options:[],observable:null},this.formModel.vehicleData.year.options=[],this.formModel.vehicleData.model={...this.formModel.vehicleData.model,selectedOption:{},options:[],observable:null},t.value&&(this.vehicleFormData.isVinSpecifiedManualZ=!1,this.formModel.vehicleData.model={...this.formModel.vehicleData.model,observable:this.vehicleService.getVehicleModel(t.value.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)},setTimeout(()=>{this.model?.triggerObservable()}))):"model"==t.name&&(this.yearDisabled=!0,this.formModel.vehicleData.year={...this.formModel.vehicleData.year,selectedOption:{},observable:null,options:[]},this.vehicleFormData.year=null,t.value&&(this.umc=t.value.umc,this.formModel.vehicleData.year={...this.formModel.vehicleData.year,observable:this.vehicleService.getVehicleYearByModel(t.value.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)},setTimeout(()=>{this.year?.triggerObservable()})));else{t.isValid?(this.formModel.vehicleData[t.name].value=t.value,this.vehicleFormData[t.name]=t.value):(this.formModel.vehicleData[t.name].value="",this.vehicleFormData[t.name]="");const n=this.validVehicleFields.find(r=>r.field==t.name);null!=n?n.valid=t.isValid:this.validVehicleFields.push({valid:t.isValid,field:t.name})}this.vehicleFormData={...this.vehicleFormData},"vin"==t.name&&t.isValid&&this.populateForm(),this.checkForFormValidation()}hideDropdown(t){t===this.formModel.customerData.companyOrgType.name?(this.driverCode?.closeDropdown(),this.companyOrg?.closeDropdown(),this.model?.closeDropdown(),this.year?.closeDropdown(),this.make?.closeDropdown(),this.repairType?.closeDropdown(),this.serviceType?.closeDropdown()):t===this.formModel.customerData.companyName.name?(this.driverCode?.closeDropdown(),this.orgType?.closeDropdown(),this.model?.closeDropdown(),this.year?.closeDropdown(),this.make?.closeDropdown(),this.repairType?.closeDropdown(),this.serviceType?.closeDropdown()):t===this.formModel.customerData.driverCode.name?(this.orgType?.closeDropdown(),this.companyOrg?.closeDropdown(),this.model?.closeDropdown(),this.year?.closeDropdown(),this.make?.closeDropdown(),this.repairType?.closeDropdown(),this.serviceType?.closeDropdown()):t===this.formModel.vehicleData.make.name?(this.model?.closeDropdown(),this.year?.closeDropdown(),this.driverCode?.closeDropdown(),this.orgType?.closeDropdown(),this.companyOrg?.closeDropdown(),this.repairType?.closeDropdown(),this.serviceType?.closeDropdown()):t===this.formModel.vehicleData.model.name?(this.make?.closeDropdown(),this.year?.closeDropdown(),this.driverCode?.closeDropdown(),this.orgType?.closeDropdown(),this.companyOrg?.closeDropdown(),this.repairType?.closeDropdown(),this.serviceType?.closeDropdown()):t===this.formModel.vehicleData.year.name?(this.model?.closeDropdown(),this.make?.closeDropdown(),this.driverCode?.closeDropdown(),this.orgType?.closeDropdown(),this.companyOrg?.closeDropdown(),this.repairType?.closeDropdown(),this.serviceType?.closeDropdown()):t===this.formModel.repairTypes.name?(this.model?.closeDropdown(),this.make?.closeDropdown(),this.driverCode?.closeDropdown(),this.orgType?.closeDropdown(),this.companyOrg?.closeDropdown(),this.year?.closeDropdown(),this.serviceType?.closeDropdown()):t===this.formModel.serviceType.name&&(this.model?.closeDropdown(),this.make?.closeDropdown(),this.driverCode?.closeDropdown(),this.orgType?.closeDropdown(),this.companyOrg?.closeDropdown(),this.year?.closeDropdown(),this.repairType?.closeDropdown())}updateCaseData(t){if(t&&this.customerFormData.companyId&&!this.customerFormData.tariffId){const n=t.filter(r=>r.companyId===this.customerFormData.companyId);n.length>0&&(this.customerFormData.tariffId=n[0].tariffId,this.customerFormData.isTariffEditable=n[0].isEditable,this.formModel.customerData.licenseId={...this.formModel?.customerData.licenseId,value:n[0].licenseId.toString()},this.customerFormData.partnershipId=n[0].partnershipId,this.formModel.customerData.companyName.selectedOption=n[0])}}getProvider(){this.formModel.customerData.companyOrgType.observable||(this.repairId&&"0"!=this.repairId&&(this.formModel.customerData.companyOrgType.selectedOption.name=""),this.formModel.customerData.companyOrgType.observable=this.caseService.getProviders())}drop(t,n){if(t.previousContainer===t.container)_o(t.container.data,t.previousIndex,t.currentIndex);else{10===t.container.data.length&&this.commonService.showToast(0,"max_employee_assigned");const r=t.previousContainer.data[t.previousIndex];if(!r.isAvailable)return;!function bt(a,c,t,n){const r=Wn(t,a.length-1),s=Wn(n,c.length);a.length&&c.splice(s,0,a.splice(r,1)[0])}(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex);const s=this.employeeRepairServiceType.filter(d=>d.repairServiceTypeId==n||null==d.repairServiceTypeId);s.length?s[0].employees.push(r.employeeId||r.assigneeId):this.employeeRepairServiceType.push({employees:[r.employeeId],repairServiceTypeId:n}),this.checkForFormValidation()}}onDoubleClick(t,n){if(!t.isAvailable)return;10===n.employeesAssigned&&this.commonService.showToast(0,"max_employee_assigned");const r=t.assigneeId||t.employeeId,s=this.employeeRepairServiceType.find(u=>u.repairServiceTypeId==n.repairId);s&&(s.employees=s.employees?.filter(u=>u!=r));const d=n.employees?.find(u=>(u.assigneeId||u.employeeId)==r);d&&(n.employeesAssigned.push(d),n.employees=n.employees?.filter(u=>(u.assigneeId||u.employeeId)!=r),s?s.employees.push(d.employeeId||d.assigneeId):this.employeeRepairServiceType.push({employees:[d.employeeId],repairServiceTypeId:n.repairId})),this.checkForFormValidation()}populateForm(){this.monitorService.logEvent("populateForm",["PersonalInfoComponent","addenda-quote",{repairId:this.repairId}]);const t=this.formModel.vehicleData.vin.value?.toLocaleString();this.checkVINQueryPermission()?(0,Zo.D)(t).pipe().subscribe({complete:()=>{17==t.length&&!this.isFormConfirmed&&!this.preventVinCall&&(this.commonService.showLoading(),this.vehicleService.getVinDecoder(t).subscribe({error:()=>{this.commonService.hideLoading(),this.vinGTMotive=null,this.resetVehicleDropdown()},next:n=>{if(n?.success){this.vinGTMotive=n.data,this.umc=this.vinGTMotive?.umc,this.formModel.vehicleData.make={...this.formModel.vehicleData.make,selectedOption:{name:n.data.vehicleMake}},this.formModel.vehicleData.model={...this.formModel.vehicleData.model,selectedOption:{modelDescription:n.data.vehicleModel}};const s=this.formModel.vehicleData.make.options.filter(d=>d.name===n.data.vehicleMake);s.length>0&&(this.formModel.vehicleData.model={...this.formModel.vehicleData.model,observable:this.vehicleService.getVehicleModel(s[0].id,this.estimateId)},setTimeout(()=>{this.model.triggerObservable()})),this.formModel.vehicleData.year={...this.formModel.vehicleData.year,selectedOption:{name:n.data.modelYearRange}},this.vehicleFormData.make=n.data.vehicleMake,this.vehicleFormData.model=n.data.vehicleModel,this.vehicleFormData.year=n.data.modelYearRange,this.inputDisabled=!1,this.infoDisabled=!1,this.makeDisabled=!0,this.enableDropdowns()}else this.vinGTMotive=null,this.vinFromOCR==this.vehicleFormData.vin?this.checkMakeModelExistFromOCR():(this.commonService.showInfoToast(5e3,"show-info | "+n?.message),this.resetVehicleDropdown());this.make&&(this.make.dropdownValidationMessage="",this.make.dropdownContainer.dropdownConfig.isTouched=!1,this.make.dropdownContainer.dropdownConfig.isDirty=!1),this.model&&(this.model.dropdownValidationMessage="",this.model.dropdownContainer.dropdownConfig.isTouched=!1,this.model.dropdownContainer.dropdownConfig.isDirty=!1),this.year&&(this.year.dropdownValidationMessage="",this.year.dropdownContainer.dropdownConfig.isTouched=!1,this.year.dropdownContainer.dropdownConfig.isDirty=!1)},complete:()=>{this.commonService.hideLoading()}})),this.preventVinCall&&17==t.length&&(this.preventVinCall=!1)}}):(this.vinFromOCR==this.vehicleFormData.vin&&this.vinFromOCR&&this.checkMakeModelExistFromOCR(),this.inputDisabled=!1,this.infoDisabled=!1,this.enableDropdowns())}resetVehicleDropdown(t=!0){t&&(this.inputDisabled=!1,this.infoDisabled=!1,this.makeDisabled=!1),this.vehicleFormData.make="",this.vehicleFormData.model="",this.vehicleFormData.year=null,this.formModel.vehicleData.model.options=[],this.formModel.vehicleData.year.options=[],this.formModel.vehicleData.make={...this.formModel.vehicleData.make,selectedOption:{}},this.formModel.vehicleData.model={...this.formModel.vehicleData.model,selectedOption:{}},this.formModel.vehicleData.year={...this.formModel.vehicleData.year,selectedOption:{}}}enableDropdowns(){this.modelDisabled=!1,this.yearDisabled=!1}closeForm(){this.router.navigate(["/repair/booking-journal"])}cancelBooking(){this.repairId?this.commonService.openDeleteDialog().afterClosed().subscribe(t=>{t&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.closeForm()}}))}):this.closeForm()}ngOnDestroy(){this.commonService.actionTriggered.unsubscribe(),this.commonService.accessRight.unsubscribe(),this.commonService.viewActionTriggeredBooking.unsubscribe(),this.commonService.labourData.unsubscribe(),this.subscriptions&&this.subscriptions.forEach(t=>t.unsubscribe()),this.monitorService.logEvent("ngOnDestroy",["PersonalInfoComponent","addenda-repair"])}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ye.F0),e.Y36(be.v),e.Y36(we.M),e.Y36(Zi.n),e.Y36(le.p),e.Y36(ii.f),e.Y36(ye.gz),e.Y36(Dt.q),e.Y36(T.qu),e.Y36(Fi.a),e.Y36(ra.m),e.Y36(ll.g),e.Y36(cl.T),e.Y36(pe.sK),e.Y36(et.o))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-personal-info"]],viewQuery:function(t,n){if(1&t&&(e.Gf(dl,5),e.Gf(ul,5),e.Gf(En,5),e.Gf(hl,5),e.Gf(ml,5),e.Gf(No,5),e.Gf(aa,5),e.Gf(en,5),e.Gf(Ni,5),e.Gf(gl,5),e.Gf(fl,5),e.Gf(_l,5),e.Gf(qn,5),e.Gf(Pt,5),e.Gf(sa,5),e.Gf(vl,5),e.Gf(bl,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.companyOrg=r.first),e.iGM(r=e.CRH())&&(n.licenseId=r.first),e.iGM(r=e.CRH())&&(n.driverPhone=r.first),e.iGM(r=e.CRH())&&(n.driverCode=r.first),e.iGM(r=e.CRH())&&(n.orgType=r.first),e.iGM(r=e.CRH())&&(n.make=r.first),e.iGM(r=e.CRH())&&(n.model=r.first),e.iGM(r=e.CRH())&&(n.year=r.first),e.iGM(r=e.CRH())&&(n.mileage=r.first),e.iGM(r=e.CRH())&&(n.license=r.first),e.iGM(r=e.CRH())&&(n.regDate=r.first),e.iGM(r=e.CRH())&&(n.repairType=r.first),e.iGM(r=e.CRH())&&(n.bookingOut=r.first),e.iGM(r=e.CRH())&&(n.serviceType=r.first),e.iGM(r=e.CRH())&&(n.communicationChannelControl=r.first),e.iGM(r=e.CRH())&&(n.bookingInDateControl=r.first),e.iGM(r=e.CRH())&&(n.chqUpload=r.first)}},decls:4,vars:7,consts:[[1,"main-wrapper"],["class","page-container-personal-info",3,"ngClass",4,"ngIf"],[3,"currentStep","currentPageName","isCurrentAdditionalModeMultiple","ngClass","imageOutput"],["chqUpload",""],[1,"page-container-personal-info",3,"ngClass"],[1,"title",3,"ngClass"],[1,"sub-title",3,"ngClass"],[1,"required"],[1,"info-wrapper"],[1,"info"],[1,"form-container","gap-32"],[1,"control-container","fx-col","gap-15"],[1,"work-provider-container","fx-col","gap-32"],[1,"row"],[1,"col-12"],[1,"col-6",3,"inputModel","clicked","controlOutput"],["orgType",""],["class","col-6",3,"inputModel","controlOutput",4,"ngIf"],["class","row",3,"ngClass",4,"ngIf"],["class","row",4,"ngIf"],[1,"button-container","wrapper",3,"ngClass"],[1,"pdf-button"],[3,"buttonModel"],[1,"driver-container"],[1,"driver-details","col-12","gap-32"],[1,"driver-input-wrapper","row"],[1,"driver-fields-wrapper"],[1,"driver-field",3,"inputModel","controlOutput"],[1,"driver-address-wrapper","row"],["class","driver-field basis-272 email",3,"inputModel","controlOutput",4,"ngIf"],["class","driver-field basis-272 email",4,"ngIf"],[1,"driver-field","basis-272"],[1,"driver-field","driver-code-field","no-padding",3,"inputModel","clicked","controlOutput"],["driverCode",""],["class","driver-field no-padding",3,"inputModel","controlOutput",4,"ngIf"],["class","driver-field-content",4,"ngIf"],[1,"fx-col","gap-32"],[1,"info-title",3,"ngClass"],[1,"vehicle-container","fx-col","gap-32"],[1,"row","vin-wrapper",3,"ngClass"],[1,"col-6",3,"inputModel","controlOutput"],[1,"col-6","button-registration",3,"ngClass"],[1,"vehicle-brand-wrapper","row",3,"ngClass"],["id","input-make",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["make",""],["id","input-model",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["model",""],[1,"vehicle-info1-wrapper","row",3,"ngClass"],["id","input-year",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["year",""],["license",""],[1,"vehicle-info-wrapper","row",3,"ngClass"],[1,"col-6","extra-position",3,"inputModel","controlOutput"],["mileage",""],[1,"col-6","registration-date",3,"inputModel","controlOutput"],["regDate",""],[1,"wrapper","fx-col","gap-32"],[1,"info-title"],[1,"booking-container","fx-col","gap-32"],[1,"col-6",3,"ngClass","inputModel","clicked","controlOutput"],["serviceType",""],["class","col-4 col-text-mode",4,"ngIf"],[1,"col-6","repair-type",3,"inputModel","ngClass","clicked","controlOutput"],["repairType",""],[3,"inputModel","ngClass","controlOutput"],["bookingInDate",""],["bookingout",""],[1,"wrapper","assigned-to-container","fx-col",3,"ngClass"],[1,"job-allocation-container"],[1,"job-allocation",3,"inputModel","ngStyle","controlOutput"],[4,"ngIf"],[1,"other-container","wrapper","fx-col","gap-32"],[1,"towing-container"],[1,"towing-layout",3,"ngClass"],[3,"inputModel","controlOutput"],["class","towing-layout",4,"ngIf"],[1,"notes-container"],["class","wrapper fx-col gap-32",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[1,"row",3,"ngClass"],[1,"insurance-input-wrapper","row"],[1,"company-input","col-3",3,"inputModel","controlOutput"],[1,"company-input","col-6",3,"inputModel","clicked","controlOutput"],["companyOrg",""],[1,"col-6",3,"ngClass","inputModel","controlOutput"],["licenseId",""],[1,"driver-field","basis-272","email",3,"inputModel","controlOutput"],[1,"driver-field","basis-272","email"],[1,"driver-field-content"],[1,"label-text"],[1,"driver-content-value"],[1,"driver-field","no-padding",3,"inputModel","controlOutput"],["driverPhone",""],[1,"col-4","col-text-mode"],["class","repair-type-container-wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"repair-type-container-wrapper",3,"ngClass"],["class","repair-type-container",3,"click",4,"ngIf"],[1,"col-6"],[1,"text-secondary"],[1,"employee-list-wrapper"],["cdkDropList","","cdkDropListSortingDisabled","",1,"employee-list",3,"cdkDropListConnectedTo","cdkDropListData"],["class","employee","cdkDrag","",3,"cdkDragDisabled","dblclick",4,"ngFor","ngForOf"],[1,"employee-list-wrapper","dropped"],["cdkDropList","",1,"employee-list",3,"cdkDropListData","cdkDropListDropped"],["doneList","cdkDropList"],["class","employee assigned",4,"ngFor","ngForOf"],[1,"repair-type-container",3,"click"],[3,"svgIcon"],["cdkDrag","",1,"employee",3,"cdkDragDisabled","dblclick"],["src","assets/img/tick_icon.png",4,"ngIf"],["src","assets/img/cross_icon.png",4,"ngIf"],["src","assets/img/tick_icon.png"],["src","assets/img/cross_icon.png"],[1,"employee","assigned"],["color","red",3,"svgIcon","click"],[1,"towing-layout"],[1,"communication-container"],[1,"",3,"inputModel","ngStyle","controlOutput"],["communicationChannel",""],["class","footer-button-wrapper",4,"chqPermission"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Qi,113,109,"div",1),e.qZA(),e.TgZ(2,"chq-upload",2,3),e.NdJ("imageOutput",function(s){return n.handleImageOutput(s)}),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!n.isApiLoading),e.xp6(1),e.Q6J("currentStep",n.currentStep)("currentPageName","personal-info")("isCurrentAdditionalModeMultiple",!1)("ngClass",e.VKq(5,wl,null==n.currentStep?null:n.currentStep.uploadInProgress)))},dependencies:[f.mk,f.sg,f.O5,f.PC,Mt.D,He.E,pl.q,Le.Hw,Ti,Er,kn.A,f.gd,pe.X$],styles:[".page-container-personal-info[_ngcontent-%COMP%]{box-sizing:border-box;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px}.page-container-personal-info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{line-height:25px;font-weight:700}.page-container-personal-info[_ngcontent-%COMP%]   .title.text-mode[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray)}.page-container-personal-info[_ngcontent-%COMP%]   .sub-title[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-weight:700;margin-top:20px;color:var(--xa-red)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]{margin-top:calc(5px + 1.5vw)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{font-weight:700;font-size:16px;line-height:20px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .info-title.text-mode[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;flex:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;gap:5px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:10px;line-height:14px;align-self:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{align-self:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:30px;padding-right:34px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;font-size:12px;gap:10px;color:var(--xa-primary)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{display:flex;align-items:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child   mat-icon[_ngcontent-%COMP%]{width:12px;height:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]{flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .car-owner-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]{flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .insurance-input-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]{flex:4;display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-input-wrapper[_ngcontent-%COMP%], .page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-address-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{flex:1 1 120px;padding:0 10px;width:120px}@media (max-width: 850px){.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{padding:0 6px}}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.no-padding[_ngcontent-%COMP%]{padding:0}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.driver-code-field[_ngcontent-%COMP%]{min-width:120px;max-width:120px;padding:0 20px 0 0}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.basis-272[_ngcontent-%COMP%]{flex-basis:272px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .extra-position[_ngcontent-%COMP%]{position:relative;top:1px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .button-registration[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;position:relative;top:18px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .registration-date[_ngcontent-%COMP%]     .input-wrapper input{pointer-events:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .registration-date[_ngcontent-%COMP%]     .input-wrapper input[readonly]{opacity:.6}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]{margin-right:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{opacity:.3}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-button.no-opacity[_ngcontent-%COMP%]{opacity:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   .towing-button-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   .towing-button-layout[_ngcontent-%COMP%]   .button-top-text[_ngcontent-%COMP%]{font-size:10px;text-align:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-overflow:ellipsis!important;white-space:nowrap;overflow:hidden!important}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(1){font-size:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(2){color:#000}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .job-allocation-container[_ngcontent-%COMP%]{margin-top:32px;margin-bottom:32px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .job-allocation-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .job-allocation[_ngcontent-%COMP%]     .input-wrapper .checkbox-wrapper .checkbox .span-label{font-size:12px;line-height:14px;color:var(--xa-black)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]{padding:14px 10px;gap:32px;border-width:.4px 0px;border-style:solid;border-color:#000}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper.no-border-top[_ngcontent-%COMP%]{border-top:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper.disable-container[_ngcontent-%COMP%]{pointer-events:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .repair-type-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;font-size:14px;line-height:18px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .repair-type-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:14px;width:14px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row.collapse[_ngcontent-%COMP%]{display:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .text-secondary[_ngcontent-%COMP%]{font-size:8px;color:var(--xa-dark-gray);line-height:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]{margin-top:10px;border:1px solid gray;padding:22px 12px;height:100px;overflow-y:scroll;background:rgba(236,236,236,.6);border:1px solid rgba(26,34,51,.2);border-radius:8px;cursor:grab}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper.no-outline[_ngcontent-%COMP%]{border:none;background:transparent}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper.dropped[_ngcontent-%COMP%]{cursor:auto}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;gap:3px;padding:0;flex-wrap:wrap;height:inherit}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]{flex-basis:calc(33.33% - 10px);box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:10px 8px;width:auto;height:38px;background:var(--xa-white);border:1px solid rgba(26,34,51,.1);border-radius:14px;gap:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee.assigned[_ngcontent-%COMP%]{justify-content:space-between}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee.transparent[_ngcontent-%COMP%]{background:transparent;justify-content:space-between;padding:10px 8px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:14px;width:14px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;line-height:14px;display:flex;align-items:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;min-width:75px;max-width:150px;display:inline-block}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]:nth-of-type(3n){flex-grow:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .communication-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]{display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .communication-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .communication-text[_ngcontent-%COMP%]{font-size:12px;line-height:14px;padding:5px}  .disable-controls input{opacity:.6}.disable-input[_ngcontent-%COMP%], .partial-disable-info[_ngcontent-%COMP%]{pointer-events:none}.hide[_ngcontent-%COMP%]{display:none!important}.cdk-drag-preview[_ngcontent-%COMP%]{padding:10px 8px;gap:10px!important;width:auto;height:38px;font-size:12px;background:var(--xa-white);border:1px solid rgba(26,34,51,.1);border-radius:14px;cursor:grab;display:flex;flex-direction:row;align-items:center}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0;gap:10px!important}.cdk-drag-disabled[_ngcontent-%COMP%]{cursor:not-allowed}.main-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-tab-background);margin:calc(5px + 1.5vw)}.page-wrapper[_ngcontent-%COMP%]{background:rgba(255,255,255,.7)}.text-mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .text-mode[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray);padding-left:0!important}.text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{order:2}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;gap:10px;height:34px}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}.text-mode[_ngcontent-%COMP%]     chq-dropdown, .text-mode[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]{opacity:1!important}.gap-15[_ngcontent-%COMP%]{gap:15px}.gap-32[_ngcontent-%COMP%]{gap:32px}"]}),a})();var Tl=k(4704);let Vi=(()=>{class a{constructor(t,n,r){this.commonService=t,this.router=n,this.monitorService=r,this.header={title:"Upload Images",step:0,description:"",stepName:"Back / Bulk Upload",rightActionText:"Delete all and Start Over",rightActionIcon:"delete",isRepairModule:!0,showTitle:!0}}handleUpdateMode(t){"error"===t.mode?this.displayMissingInspectionMessage(t.id):this.header="single"===t.mode?{...this.header,title:"back_smart_photo"}:{...this.header,title:"back_bulk_upload"}}displayMissingInspectionMessage(t){this.commonService.openConfirmationOkDialog("Notification","Please add your vehicle in order to add car images.").afterClosed().subscribe({next:n=>{n&&this.router.navigate([`repair/booking/${t}`])},error:()=>{this.commonService.hideLoading()}})}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["Photos component","addenda-repair"])}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(be.v),e.Y36(ye.F0),e.Y36(we.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-photos"]],decls:1,vars:1,consts:[[3,"photosHeader","currentUploadMode"]],template:function(t,n){1&t&&(e.TgZ(0,"new-photos",0),e.NdJ("currentUploadMode",function(s){return n.handleUpdateMode(s)}),e.qZA()),2&t&&e.Q6J("photosHeader",n.header)},dependencies:[Tl.X]}),a})();var ji=k(64307);let Jo=(()=>{class a{constructor(t,n){this.commonService=t,this.monitorService=n,this.header={title:"Upload Document",step:0,description:"",stepName:"",isRepairModule:!0,isHeaderOnly:!0}}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["Document Component","addenda-repair"])}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(be.v),e.Y36(we.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["repair-new-documents"]],decls:1,vars:1,consts:[[3,"documentHeader"]],template:function(t,n){1&t&&e._UZ(0,"new-documents",0),2&t&&e.Q6J("documentHeader",n.header)},dependencies:[ji.O]}),a})();const Dl={value:[{Id:656,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Gargash Enterprise",VehicleMake:"BMW",VehicleModel:"3 series",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:657,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Honda",VehicleModel:"Accord",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:658,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:659,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:660,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:661,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:662,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:663,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:664,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:665,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:666,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Gargash Enterprise",VehicleMake:"BMW",VehicleModel:"3 series",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:667,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Honda",VehicleModel:"Accord",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:668,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:669,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:670,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:671,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:672,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:673,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:674,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:675,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null}]},fa={value:[{title:"TOTAL JOBS",percentage:0,amount:150},{title:"TOTAL LABOUR (36%)",percentage:0,amount:350526},{title:"PANEL LABOUR(23%)",percentage:0,amount:350526},{title:"PAINT LABOUR (14%)",percentage:0,amount:350526},{title:"PARTS",percentage:0,amount:350526},{title:"MISC",percentage:0,amount:350526},{title:"SUBLET",percentage:0,amount:350526},{title:"TOTAL",percentage:0,amount:350526}]};let Ki=(()=>{class a{constructor(t){this.http=t}getInvoices(t,n=null){return(0,ct.of)(Dl)}invoicePerDetail(t){return this.http.get(`${ve.N.caseMgmtUrl}/api/invoice/${t}`)}saveInvoicePerDetail(t){return this.http.post(`${ve.N.caseMgmtUrl}/api/invoice/detail`,t)}invoicePDF(t,n,r){return this.http.post(`${ve.N.caseMgmtUrl}/api/invoice/${t}/${n}/report`,r)}invoicePerDetailProvider(t,n){return this.http.get(`${ve.N.caseMgmtUrl}/api/invoice/${t}/detail/${n}`)}assignInvoice(t){return this.http.post(`${ve.N.caseMgmtUrl}/api/invoice`,t)}getInvoiceSummary(){return(0,ct.of)(fa)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(yo.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();function Ce(a,c){return t=>{const n={invalidPaymentAmount:""};return t.value<=0?(n.min=a.instant("invalid_amount"),n):t.value>c?(n.invalidPaymentAmount=a.instant("payment_amount_max_length_error").replace("{{maxAmount}}",c.toFixed(2)),n):null}}var Ue=k(25001);let _a=(()=>{class a{constructor(t,n){this.http=t,this.fileService=n}getPayments(t){return this.http.get(`${ve.N.caseMgmtUrl}/api/payment/${t}`)}getPaymentTypes(){return this.http.get(`${ve.N.caseMgmtUrl}/api/lookup?type=paymentType`)}deletePayment(t,n){return this.http.delete(`${ve.N.caseMgmtUrl}/api/payment/${n}/delete/${t}`)}addPayment(t){const n=`${ve.N.caseMgmtUrl}/api/payment`,r=new FormData;return r.append("InvoiceNumber",t.invoiceNumber),r.append("Amount",t.amount),r.append("PaymentDate",t.paymentDate),r.append("PaymentTypeId",t.paymentTypeId),r.append("Description",t.description),t.files&&t.files.length>0&&t.files.forEach(s=>{r.append("attachment",s)}),this.fileService.uploadFile(n,r,!1)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(yo.eN),e.LFG(Ue.I))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const Il=["uploader"];function va(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",19)(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"div")(4,"span"),e._UZ(5,"mat-icon",20),e.qZA(),e.TgZ(6,"span")(7,"mat-icon",21),e.NdJ("click",function(){const s=e.CHM(t).index,d=e.oxw(2);return e.KtG(d.handleFileRemove(s))}),e.qZA()()()()}if(2&a){const t=c.$implicit;e.xp6(2),e.Oqu(null==t?null:t.name),e.xp6(3),e.Q6J("svgIcon","attachment-refference"),e.xp6(2),e.Q6J("svgIcon","cross")}}function kl(a,c){1&a&&(e.TgZ(0,"div",22)(1,"span"),e._uU(2,"-"),e.qZA()())}function Go(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",23),e.NdJ("click",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.handleAddFileClick(r))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.attachmentButton)}}function ai(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"form",2)(1,"div",3)(2,"div",4)(3,"chq-input",5),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()(),e.TgZ(4,"div",4)(5,"chq-input",5),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()(),e.TgZ(6,"div",3)(7,"div",4)(8,"chq-input",5),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()(),e.TgZ(9,"div",6)(10,"chq-input",5),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()(),e.TgZ(11,"div",7)(12,"div",4)(13,"div",8)(14,"label",9),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.YNc(17,va,8,3,"div",10),e.YNc(18,kl,3,0,"div",11),e.qZA()(),e.TgZ(19,"div",4),e.YNc(20,Go,1,1,"chq-button",12),e.TgZ(21,"input",13,14),e.NdJ("change",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.handleUpload(r))}),e.qZA()()(),e.TgZ(23,"div",15)(24,"div",16)(25,"chq-input",5),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdate(r))}),e.qZA()()(),e.TgZ(26,"div",3)(27,"div",16)(28,"div",17)(29,"chq-button",18),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.handleFormSubmit())}),e.qZA()()()()()}if(2&a){const t=e.oxw();e.xp6(3),e.Q6J("inputModel",t.formModel.amount),e.xp6(2),e.Q6J("inputModel",t.formModel.paymentMethod),e.xp6(3),e.Q6J("inputModel",t.formModel.paymentDate),e.xp6(2),e.Q6J("inputModel",t.formModel.paymentStatus),e.xp6(5),e.Oqu(e.lcZ(16,10,"attachments")),e.xp6(2),e.Q6J("ngForOf",t.file),e.xp6(1),e.Q6J("ngIf",!t.file),e.xp6(2),e.Q6J("ngIf",t.file.length<1),e.xp6(5),e.Q6J("inputModel",t.formModel.description),e.xp6(4),e.Q6J("buttonModel",t.savePaymentButtonModel)}}function Bo(a,c){if(1&a&&(e.TgZ(0,"div",24)(1,"div",8)(2,"label",25),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div")(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA()()()()),2&a){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,2,"payment_status")),e.xp6(4),e.Oqu(e.lcZ(8,4,t.repairPaymentStatus))}}let Fn=(()=>{class a{constructor(t,n,r,s){this.monitorService=t,this.paymentService=n,this.commonService=r,this.translateService=s,this.handleAddPayment=new e.vpe,this.savePaymentButtonModel={label:"save_payment",type:"outline",icon:"save"},this.attachmentButton={label:"add_attachment",type:"outline",icon:"attachment"},this.formData={paymentTypeId:0,paymentDate:"",amount:0,description:"",paymentStatus:""},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.file=[]}set content(t){t&&(this.uploader=t)}ngOnInit(){this.monitorService.logEvent("ngOnInit",["PaymentListComponent","addenda-repair"]),this.formModel=(a=>({amount:{placeHolder:"payment_amount",label:"payment_amount",name:"amount",value:0,type:"number",required:!0,validation:{name:"paymentAmount",validationFunction:()=>T.kI.compose([T.kI.min(1)]),validationMessage:c=>c.required?a.instant("payment_amount_required"):c.pattern?a.instant("invalid_number"):c.min?a.instant("greater_than_0"):c.invalidPaymentAmount?c.invalidPaymentAmount:""}},paymentDate:{placeHolder:"payment_date",label:"payment_date",name:"paymentDate",value:new Date,type:"datetime",minDate:new Date,maxDate:new Date},paymentMethod:{placeHolder:"select_payment_method",name:"paymentMethod",label:"payment_method",options:[{}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"paymentMethod",validationFunction:()=>T.kI.compose([T.kI.required]),validationMessage:c=>c.required?a.instant("select_payment_method"):""}},paymentStatus:{placeHolder:"payment_status",label:"payment_status",name:"paymentStatus",value:"",type:"text",disabled:!0},description:{placeHolder:"add_description",label:"add_description",name:"description",value:"",type:"textarea",maxLength:100,validation:{name:"addDescription",validationFunction:()=>T.kI.compose([T.kI.maxLength(100)]),validationMessage:c=>c.maxlength?a.instant("payment_description_max_length_error"):""}}}))(this.translateService),this.formModel.paymentMethod.observable||(this.formModel.paymentMethod.observable=this.paymentService.getPaymentTypes(),this.formModel.paymentMethod.onObservableLoad=this.onObservableLoadPaymentMethods.bind(this)),this.formModel.paymentStatus={...this.formModel.paymentStatus,value:this.paymentStatusMapper[this.repairPaymentStatus?.toLowerCase()]},this.formData.paymentStatus=this.repairPaymentStatus,this.formModel.amount={...this.formModel.amount,value:this.dueAmount?.toFixed(2)},this.formData.amount=this.dueAmount,this.formData.paymentDate=new Date,this.formModel.paymentDate={...this.formModel.paymentDate,minDate:E(this.invoiceDate).toDate()}}ngAfterViewInit(){this.dueAmount&&this.formModel.amount.formControl.setValidators(T.kI.compose([T.kI.required,T.kI.pattern(/^\d*\.?\d+$/),Ce(this.translateService,this.dueAmount)]))}ngOnChanges(t){t.dueAmount&&this.formModel?.amount?.formControl&&(this.formModel.amount.formControl.setValidators(T.kI.compose([T.kI.required,Ce(this.translateService,t.dueAmount?.currentValue)])),this.formModel.amount={...this.formModel.amount,value:this.dueAmount?.toFixed(2)},this.formData.amount=this.dueAmount),t.repairPaymentStatus&&this.formModel&&(this.formModel.paymentStatus={...this.formModel?.paymentStatus,value:this.paymentStatusMapper[t.repairPaymentStatus?.currentValue]})}updateValidation(t,n){this.formModel.amount.formControl.setValidators(T.kI.compose([T.kI.required,Ce(this.translateService,t)])),this.formModel.amount={...this.formModel.amount,value:t?.toFixed(2)},this.formData.amount=t,this.formModel.paymentStatus={...this.formModel?.paymentStatus,value:this.paymentStatusMapper[n?.toLowerCase()]}}onFormUpdate(t){"select"===t.type?(this.formModel[t.name]={...this.formModel[t.name],selectedOption:t.value},"paymentMethod"===t.name?this.formData.paymentTypeId=t.value.id:this.formData[t.name]=t.value):(this.formModel[t.name].value=t.value,this.formData[t.name]=t.value),this.checkForFormValidation()}onObservableLoadPaymentMethods(t){this.formModel.paymentMethod={...this.formModel.paymentMethod,options:t}}checkForFormValidation(){this.savePaymentButtonModel.type=this.isPaymentFormValid()?"primary":"outline"}isPaymentFormValid(){let t=!0;return this.formData.amount&&this.formData.paymentDate&&this.formData.paymentTypeId&&this.formModel.amount.formControl.valid&&this.formModel.paymentDate.formControl.valid||(t=!1),t}checkFileSize(t){return this.monitorService.logEvent("checkFileSize",["PaymentAddComponent","addenda-repair",{fileSize:t.size}]),!(t.size>this.commonService.maxileSize)}isValidImageFile(t){const n=new RegExp("^.*\\.[a-zA-Z]+$","gm");if(this.monitorService.logEvent("isValidImageFile",["PaymentAddComponent","addenda-repair",{fileName:t}]),n.test(t)){const r=t.split(".").pop();return this.commonService.allowFilesExtension.includes(r?.toLowerCase())}return!1}handleUpload(t){const n=t.target.files||t.srcElement.files;if(this.monitorService.logEvent("handleUpload",["PaymentAddComponent","addenda-quote",{event:t}]),null!==n&&""!==n&&n.length>0){if(!this.checkFileSize(n[0])){const s=this.translateService.instant("file_size_5mb_error_message");return this.commonService.showToast(0,s),void(this.uploader.nativeElement.value=null)}if(!this.isValidImageFile(n[0].name)){const s=this.translateService.instant("upload_type_not_supported");return this.commonService.showToast(0,s),void(this.uploader.nativeElement.value=null)}const r=new FileReader;r.readAsDataURL(n[0]),r.onload=s=>{this.file.push(n[0]),this.checkForFormValidation()}}else this.checkForFormValidation()}handleFileRemove(t){this.commonService.openDeleteDialog("",this.translateService.instant("attachment_delete_confirmation"),this.translateService.instant("delete"),this.translateService.instant("cancel")).afterClosed().subscribe(n=>{n&&(this.monitorService.logEvent("handleFileRemove",["PaymentAddComponent","addenda-repair"]),this.file.splice(t,1))})}handleAddFileClick(t){this.uploader.nativeElement.click()}handleFormSubmit(){if(!this.isPaymentFormValid())return;this.monitorService.logEvent("submitForm",["PaymentAddComponent","addenda-repair"]);const t={amount:this.formData.amount/1,paymentTypeId:this.formData.paymentTypeId,paymentDate:E.utc(this.formData.paymentDate).format("YYYY-MM-DDTHH:mm:ss.000")+"Z",description:this.formData.description,invoiceNumber:this.invoiceNumber};this.file&&this.file.length>0&&(t.files=this.file),this.commonService.showLoading(),this.paymentService.addPayment(t).subscribe({next:n=>{console.log("result",n),n&&(this.commonService.hideLoading(),this.handleAddPayment.emit({Amount:this.formData.amount}),this.resetForm())},error:n=>{this.commonService.hideLoading(),this.monitorService.logException(n,_e._.Error)}})}resetForm(){this.formModel.amount={...this.formModel.amount,value:null},this.formData.amount=null,this.formModel.amount.formControl.reset(),this.formModel.paymentMethod={...this.formModel.paymentMethod,selectedOption:{}},this.formData.paymentTypeId=null,this.formModel.paymentDate={...this.formModel.paymentDate,value:new Date},this.formData.paymentDate=new Date,this.formModel.description={...this.formModel.description,value:null},this.formData.description=null,this.formModel.description.formControl.reset(),this.file=[]}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(we.M),e.Y36(_a),e.Y36(be.v),e.Y36(pe.sK))},a.\u0275cmp=e.Xpm({type:a,selectors:[["payment-add"]],viewQuery:function(t,n){if(1&t&&e.Gf(Il,5),2&t){let r;e.iGM(r=e.CRH())&&(n.content=r.first)}},inputs:{repairId:"repairId",repairPaymentStatus:"repairPaymentStatus",invoiceNumber:"invoiceNumber",invoiceDate:"invoiceDate",dueAmount:"dueAmount"},outputs:{handleAddPayment:"handleAddPayment"},features:[e.TTD],decls:3,vars:2,consts:[["class","fx-1 payment-add",4,"ngIf","ngIfElse"],["fullypaid",""],[1,"fx-1","payment-add"],[1,"row"],[1,"col-6"],[3,"inputModel","controlOutput"],[1,"col-6","payment-status"],[1,"row","mt-30","align-items-end"],[1,"input-wrapper"],[1,"input-label"],["class","file-proof",4,"ngFor","ngForOf"],["class","",4,"ngIf"],["class","add-file",3,"buttonModel","click",4,"ngIf"],["hidden","","type","file","accept","image/png, image/jpg, image/jpeg, application/pdf",3,"change"],["uploader",""],[1,"row","mt-30"],[1,"col-12"],[1,"footer-button"],[1,"save-payment",3,"buttonModel","click"],[1,"file-proof"],[1,"mr-20",3,"svgIcon"],[3,"svgIcon","click"],[1,""],[1,"add-file",3,"buttonModel","click"],[1,"payment-add"],[1,"input-label","uppercase"]],template:function(t,n){if(1&t&&(e.YNc(0,ai,30,12,"form",0),e.YNc(1,Bo,9,6,"ng-template",null,1,e.W1O)),2&t){const r=e.MAs(2);e.Q6J("ngIf",n.dueAmount>0)("ngIfElse",r)}},dependencies:[f.sg,f.O5,Le.Hw,T._Y,T.JL,T.F,Mt.D,He.E,pe.X$],styles:[".payment-add[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.payment-add[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{display:flex;margin-top:30px}.payment-add[_ngcontent-%COMP%]   .mt-30[_ngcontent-%COMP%]{margin-top:30px}.payment-add[_ngcontent-%COMP%]   .align-items-end[_ngcontent-%COMP%]{align-items:end}.payment-add[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{display:block;font-size:10px;padding-bottom:4px;text-transform:uppercase;color:var(--xa-dark-gray)}.payment-add[_ngcontent-%COMP%]   .add-file[_ngcontent-%COMP%]     button{width:auto;padding:6px 12px!important;height:auto}.payment-add[_ngcontent-%COMP%]   .add-file[_ngcontent-%COMP%]     .btn-disabled-outline{border:1px solid var(--xa-light-gray)!important}.payment-add[_ngcontent-%COMP%]   .mr-20[_ngcontent-%COMP%]{margin-right:20px}.payment-add[_ngcontent-%COMP%]   .file-proof[_ngcontent-%COMP%]{font-size:14px;padding:5px 0;border-bottom:1px solid var(--xa-light-gray);border-top:1px solid var(--xa-light-gray);display:flex;align-items:center;justify-content:space-between}.payment-add[_ngcontent-%COMP%]   .file-proof[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-red)!important}.payment-add[_ngcontent-%COMP%]     textarea{font-family:Inter,sans-serif;height:65px}.payment-add[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]     input{background:transparent;padding:0;opacity:1}.payment-add[_ngcontent-%COMP%]     dx-date-box.dx-invalid, .payment-add[_ngcontent-%COMP%]     dx-date-box.ng-invalid{border:none!important}"]}),a})();const si={columns:[{id:"Id",width:"0px",style:"display: none",header:{text:"Id",tooltip:"",style:"display: none; max-width: 0"},cellStyle:"display: none; max-width: 0",selector:{field:"paymentId"},widget:{type:"text"}},{id:"Payment",sortable:!1,header:{text:"payment",tooltip:""},selector:{field:"paymentId"},widget:{type:"text"}},{id:"Amount",sortable:!1,selector:{field:"amount"},header:{text:"amount",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center;",widget:{type:"currency"}},{id:"PaymentDate",sortable:!1,selector:{field:"paymentDate"},header:{text:"payment_date",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center;",widget:{type:"dateTime",dateFormat:"dd/MM/YYYY hh:mm a"}},{id:"PaymentMethod",sortable:!1,selector:{field:"paymentType"},header:{text:"payment_method",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center; text-transform: capitalize;",widget:{type:"text"}},{id:"Attachment",sortable:!1,selector:{field:"attachment"},header:{text:"attachment",tooltip:"attachment",style:"text-align: center;"},childColumns:[{id:"AttachmentRefference",selector:{field:"attachment"},widget:{type:"icon",config:{svgIcon:"attachment-refference"}}},{id:"Download",disableColumns:!0,selector:{field:"attachment"},widget:{type:"icon",config:{svgIcon:"download-arrow"}}},{id:"Preview",selector:{field:"attachment"},disableColumns:!0,widget:{type:"icon",config:{svgIcon:"eye"}}}],cellStyle:"justify-content: center;"},{id:"DeleteAction",width:"100px",sortable:!1,selector:{field:"Id"},header:{text:"action",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center",widget:{type:"icon",config:{svgIcon:"delete",style:"fill: var(--xa-dark-red2) !important; width: 15px; height: 15px;"}}},{id:"paymentGuid",width:"0px",style:"display: none",header:{text:"paymentGuid",tooltip:"",style:"display: none; max-width: 0"},cellStyle:"display: none; max-width: 0",selector:{field:"paymentGuid"},widget:{type:"text"}}]};var li=k(94327);const Wi=["paymentTableWrapper"],Nn=function(a){return{"fully-paid":a}};let Al=(()=>{class a{constructor(t,n,r,s){this.monitorService=t,this.paymentService=n,this.commonService=r,this.translateService=s,this.handlePaymentDelete=new e.vpe,this.tableConfig=si,this.tableData=[],this.pageChanged=!1,this.showData=!1,this.currencySymbol="",this.locale="",this.numberFormat="",this.handleCellClick=(d,u,v)=>{if("DeleteAction"===u.id)this.deletePayment(d[7]?.result?.value);else if("Download"===u.id){const P=d[5]?.result.value.split("/"),y=P[P?.length-1]?.split("?")[0];this.commonService.showLoading(),this.commonService.getFileBlob(d[5]?.result?.value).subscribe({next:w=>{this.commonService.hideLoading();const D=new Blob([w.res],{type:"application/octet-stream"});(0,li.saveAs)(D,y)},error:w=>{this.commonService.hideLoading(),this.monitorService.logException(w)}})}else"Preview"===u.id&&window.open(d[5]?.result?.value,"_top")},this.i18n=this.commonService.geti18nInfo(),this.currencySymbol=this.i18n.currencySymbol+" ",this.locale=this.i18n.locale,this.numberFormat=this.i18n.digitsInfo}ngOnInit(){this.monitorService.logEvent("ngOnInit",["PaymentListComponent","addenda-repair"]),this.getPayments(this.invoiceGuid)}get isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}getPayments(t){var n=this;return(0,ue.Z)(function*(){return n.commonService.showLoading(),n.commonService.isViewOnly&&(n.tableConfig.columns=n.tableConfig.columns.filter(r=>"DeleteAction"!==r.id)),n.monitorService.logEvent("getPayments",["PaymentListComponent","addenda-repair"]),(0,Ee.z)(n.paymentService.getPayments(t)).then(r=>{r.data&&(n.formatTableData(r.data),n.showData=!0),n.commonService.hideLoading()}).catch(r=>{n.commonService.hideLoading(),n.monitorService.logException(r,_e._.Error)})})()}formatTableData(t){this.tableData=t}deletePayment(t){var n=this;return(0,ue.Z)(function*(){n.commonService.openDeleteDialog("",n.translateService.instant("payment_delete_confirmation"),n.translateService.instant("delete"),n.translateService.instant("cancel")).afterClosed().subscribe(r=>{r&&(n.commonService.showLoading(),n.monitorService.logEvent("deleteRow",["PaymentListComponent","addenda-repair"],{paymentId:t}),(0,Ee.z)(n.paymentService.deletePayment(t,n.invoiceGuid)).then(s=>{n.commonService.hideLoading(),s?.message&&n.commonService.showInfoToast(5e3,s.message);const d=n.tableData.filter(u=>u.paymentGuid===t);n.handlePaymentDelete.emit({Amount:d[0]?.amount}),n.getPayments(n.invoiceGuid)}).catch(s=>{n.commonService.hideLoading(),n.monitorService.logException(s,_e._.Error)}))})})()}addPayment(t){const n=[...this.tableData];n.unshift(t),this.formatTableData(n),this.paymentTableWrapper.nativeElement.scrollIntoView({behavior:"smooth"})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(we.M),e.Y36(_a),e.Y36(be.v),e.Y36(pe.sK))},a.\u0275cmp=e.Xpm({type:a,selectors:[["payment-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(Wi,5),2&t){let r;e.iGM(r=e.CRH())&&(n.paymentTableWrapper=r.first)}},inputs:{invoiceGuid:"invoiceGuid",dueAmount:"dueAmount"},outputs:{handlePaymentDelete:"handlePaymentDelete"},decls:6,vars:8,consts:[[1,"table-container","payment-list",3,"ngClass"],[1,"table-wrapper"],["paymentTableWrapper",""],[3,"config","tableData","cellClicked","pageChanged","i18n"],["paymentTable",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1,2),e._UZ(4,"chq-mat-table",3,4),e.qZA(),e.BQk(),e.qZA()),2&t&&(e.Q6J("ngClass",e.VKq(6,Nn,n.dueAmount<=0)),e.xp6(4),e.Q6J("config",n.tableConfig)("tableData",n.tableData)("cellClicked",n.handleCellClick)("pageChanged",n.pageChanged)("i18n",n.i18n))},dependencies:[f.mk,Io.B],styles:[".payment-list[_ngcontent-%COMP%]{margin-top:30px}.payment-list.table-container[_ngcontent-%COMP%]:not(.fully-paid){height:calc(80vh - 614px);overflow:scroll;min-height:200px}.payment-list.table-container.fully-paid[_ngcontent-%COMP%]{height:calc(80vh - 237px);overflow:scroll}.payment-list[_ngcontent-%COMP%]     thead{position:sticky;top:0;z-index:1}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div{display:flex}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div mat-icon{margin:0 10px;text-align:center;align-items:center;display:flex;width:auto}@media (max-width: 1200px){.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div mat-icon{margin:0 6px}}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div   [data-mat-icon-name=download-arrow] svg{height:18px}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div   [data-mat-icon-name=eye] path{fill:var(--xa-black)}"]}),a})();const Rl=["paymentList"],Ll=["paymentadd"];function El(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"payment-add",8,9),e.NdJ("handleAddPayment",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.handleAddPayment(r))}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("repairId",t.data.repairId)("repairPaymentStatus",t.data.paymentStatus)("dueAmount",t.data.dueAmount)("invoiceDate",t.data.invoiceDate)("invoiceNumber",t.data.invoiceNumber)}}let ql=(()=>{class a{constructor(t,n,r,s,d){this.data=t,this.dialogRef=n,this.commonService=r,this.invoiceService=s,this.monitorService=d,this.closeButtonModel={label:"close",type:"primary",icon:""}}ngOnInit(){this.data=this.data.dueAmount===this.data.invoiceAmount?{...this.data,paymentStatus:"unpaid"}:0===this.data.dueAmount?{...this.data,paymentStatus:"paid"}:{...this.data,paymentStatus:"partialpaid"},this.monitorService.logEvent("ngOnInit",["PaymentsComponent","addenda-repair"])}getInvoiceDetail(){this.invoiceService.invoicePerDetailProvider(this.data.repairId,this.data.isWorkProvider?1:2).subscribe({next:t=>{const n=t?.data;this.data={...this.data,...n},setTimeout(()=>{this.paymentadd.updateValidation(this.data.dueAmount,this.data.paymentStatus)})}})}cancelDialog(t){this.dialogRef.close(this.data.dueAmount)}handleAddPayment(t){this.paymentList.getPayments(this.data.invoiceGuid),this.data.dueAmount=(1e5*this.data.dueAmount-1e5*t.Amount)/1e5,this.data=this.data.dueAmount===this.data.invoiceAmount?{...this.data,paymentStatus:"unpaid"}:0===this.data.dueAmount?{...this.data,paymentStatus:"paid"}:{...this.data,paymentStatus:"partialpaid"},this.getInvoiceDetail()}handlePaymentDelete(t){t?.Amount&&(this.data.dueAmount=(1e5*this.data.dueAmount+1e5*parseFloat(t.Amount))/1e5),this.data=this.data.dueAmount===this.data.invoiceAmount?{...this.data,paymentStatus:"unpaid"}:0===this.data.dueAmount?{...this.data,paymentStatus:"paid"}:{...this.data,paymentStatus:"partialpaid"},this.getInvoiceDetail()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(xe.WI),e.Y36(xe.so),e.Y36(be.v),e.Y36(Ki),e.Y36(we.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-payments"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Rl,7),e.Gf(Ll,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.paymentList=r.first),e.iGM(r=e.CRH())&&(n.paymentadd=r.first)}},decls:11,vars:7,consts:[[1,"payment-container","fx-col"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content","fx-col","fx-1"],[3,"repairId","repairPaymentStatus","dueAmount","invoiceDate","invoiceNumber","handleAddPayment",4,"ngIf"],[3,"invoiceGuid","dueAmount","handlePaymentDelete"],["paymentList",""],[3,"repairId","repairPaymentStatus","dueAmount","invoiceDate","invoiceNumber","handleAddPayment"],["paymentadd",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2)(6,"mat-icon",3),e.NdJ("click",function(){return n.cancelDialog(!1)}),e.qZA()()(),e.TgZ(7,"div",4),e.YNc(8,El,2,5,"payment-add",5),e.TgZ(9,"payment-list",6,7),e.NdJ("handlePaymentDelete",function(s){return n.handlePaymentDelete(s)}),e.qZA()()()),2&t&&(e.xp6(3),e.hij("",e.lcZ(4,5,"payment")," "),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(2),e.Q6J("ngIf",!n.commonService.isViewOnly),e.xp6(1),e.Q6J("invoiceGuid",n.data.invoiceGuid)("dueAmount",n.data.dueAmount))},dependencies:[f.O5,Le.Hw,Fn,Al,pe.X$],styles:[".payment-container[_ngcontent-%COMP%]{overflow:auto;padding:20px}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:flex-end;display:flex;cursor:pointer}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:36px!important;width:36px!important;background:var(--xa-black);border-radius:50%;text-align:center}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg   path{fill:var(--xa-white)}.payment-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:15px}.payment-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]{margin-bottom:15px}.payment-container[_ngcontent-%COMP%]   .popup-footer-buttons[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:10px}.payment-container[_ngcontent-%COMP%]     button{font-family:Inter,sans-serif}"]}),a})();function $i(a,c){if(1&a&&(e.TgZ(0,"span",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.InputModelDateTime.errorMessage))}}let ci=(()=>{class a{constructor(t,n,r,s){this.data=t,this.dialogRef=n,this.monitorService=r,this.commonService=s,this.InputModelDateTime={placeHolder:"pickup_date",label:"pick_up_date_time",name:"",type:"datetime",maxDate:E().add(6,"month").toDate(),minDate:E().subtract(1,"minute").toDate(),value:null,error:!1,errorMessage:""},this.confirmButton={label:"save",type:"disabled",onclick:this.continue.bind(this)},this.PickUpDate=null}ngOnInit(){this.monitorService.logEvent("ngOnInit",["SchedulePickupDatePopupComponent","addenda-repair"]),null!==this.data.pickupDate&&(this.PickUpDate=this.data.pickupDate,-1===this.data.pickupDate.indexOf("Z")&&(this.PickUpDate=this.PickUpDate+"Z"),"schedule"===this.data.callSource?new Date(this.PickUpDate)>new Date&&(this.confirmButton={...this.confirmButton,type:"primary"}):new Date(this.PickUpDate)<new Date&&(this.confirmButton={...this.confirmButton,type:"primary"})),"pickedUp"===this.data.callSource&&(this.InputModelDateTime.maxDate=E().add(1,"minute").toDate(),this.InputModelDateTime.minDate=E().subtract(6,"month").toDate())}close(){this.dialogRef.close()}continue(){this.monitorService.logEvent("continue",["SchedulePickupDatePopupComponent","addenda-repair"]),this.dialogRef.close({PickUpDate:this.PickUpDate})}updateInput({value:t}){if(this.InputModelDateTime.error=!1,"pickedUp"===this.data.callSource){if(new Date(t)>new Date)return E(new Date(t)).format("YYYY-MM-DD hh:mm")==E().format("YYYY-MM-DD hh:mm")?(this.InputModelDateTime.error=!1,this.PickUpDate=new Date(t.toString()),void(this.confirmButton={...this.confirmButton,type:"primary"})):(this.InputModelDateTime.error=!0,this.InputModelDateTime.errorMessage="pick_up_date_cannot_set_as_future_date",void(this.confirmButton={...this.confirmButton,type:"disabled"}))}else if(new Date(t)<new Date)return E(new Date(t)).format("YYYY-MM-DD hh:mm")==E().format("YYYY-MM-DD hh:mm")?(this.InputModelDateTime.error=!1,this.PickUpDate=new Date(t.toString()),void(this.confirmButton={...this.confirmButton,type:"primary"})):(this.InputModelDateTime.error=!0,this.InputModelDateTime.errorMessage="Pick_up_date_cannot_set_as_past_date",void(this.confirmButton={...this.confirmButton,type:"disabled"}));this.PickUpDate=new Date(t.toString()),this.confirmButton={...this.confirmButton,type:"primary"}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(xe.WI),e.Y36(xe.so),e.Y36(we.M),e.Y36(be.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-schedule-pickup-date-popup"]],decls:15,vars:16,consts:[[1,"message-container"],[1,"header"],[1,"header-text"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content"],[1,"input-label","uppercase","text-muted"],["type","datetime",3,"value","acceptCustomValue","invalidDateMessage","max","min","validationError","validationMessageMode","onValueChanged"],["class","pickupDate-error input-label text-muted",4,"ngIf"],[1,"footer","form-data-footer"],[1,"right",3,"buttonModel"],[1,"pickupDate-error","input-label","text-muted"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",3)(6,"mat-icon",4),e.NdJ("click",function(){return n.close()}),e.qZA()()(),e.TgZ(7,"div",5)(8,"label",6),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"dx-date-box",7),e.NdJ("onValueChanged",function(s){return n.updateInput(s)}),e.qZA(),e.YNc(12,$i,3,3,"span",8),e.qZA(),e.TgZ(13,"div",9),e._UZ(14,"chq-button",10),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,12,"pickedUp"===n.data.callSource?"picked_up_date_and_time":"schedule_pick_up")),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(3),e.Oqu(e.lcZ(10,14,n.InputModelDateTime.label)),e.xp6(2),e.Q6J("value",n.PickUpDate)("acceptCustomValue",!1)("invalidDateMessage","")("max",n.InputModelDateTime.maxDate)("min",n.InputModelDateTime.minDate)("validationError",!1)("validationMessageMode","none"),e.xp6(1),e.Q6J("ngIf",n.InputModelDateTime.error),e.xp6(2),e.Q6J("buttonModel",n.confirmButton))},dependencies:[f.O5,He.E,Le.Hw,Di.M,pe.X$],styles:[".message-container[_ngcontent-%COMP%]{padding:30px;width:483px;height:200px;background-color:var(--xa-popup-light-gray);display:flex;flex-direction:column}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{font-size:20px;font-weight:700;line-height:25px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:36px;height:60px}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label.input-label[_ngcontent-%COMP%]{font-size:12px;font-weight:400;color:var(--xa-dark-gray)}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .pickupDate-error[_ngcontent-%COMP%]{font-size:12px;font-weight:400;color:var(--xa-red);padding-top:10px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:36px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{margin-right:4px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:4px}"]}),a})();var ba=k(11481);const m=function(a){return{"cc-email":a}};let Un=(()=>{class a{constructor(t,n,r,s,d,u,v){this.dialogRef=t,this.monitorService=n,this.messagingService=r,this.commonService=s,this.invoiceService=d,this.sanitizer=u,this.data=v,this.showCC=!1,this.fileName="Invoice",this.templateKey="",this.emailRequest={subject:"",email:[],message:""},this.emailForm={email:{label:"email_address",name:"email",placeHolder:"email_address",value:"",type:"text",validation:{name:"email",validationFunction:()=>T.kI.compose([T.kI.required,(0,X.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:P=>P.required?"email_required":P.invalidEmailNumber?"email_invalid_number":P.invalidEmail?"email_valid":""}},cc:{label:"CC",name:"cc",placeHolder:"CC",value:"",type:"text",validation:{name:"email",validationFunction:()=>T.kI.compose([T.kI.required,(0,X.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:P=>P.required?"email_required":P.invalidEmailNumber?"email_invalid_number":P.invalidEmail||P.pattern||P.email?"email_valid":""}}}}downloadPDF(t){const n=this.data.invoiceId;let r;r=this.data.dueDate?{parameters:[{name:"dueDate",value:E(this.data.dueDate).format("YYYY-MM-DD")}]}:{parameters:[]},this.invoiceService.invoicePDF(t,n,r).subscribe({next:s=>{if(s){this.blobUrl=s?.data?.url;const u=this.blobUrl.substring(this.blobUrl.lastIndexOf("/")+1,this.blobUrl.length)?.split("?")[0];this.fileName=u}this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}onFormUpdate(t){return t.isValid?(this.emailRequest[t.name]="email"===t.name?t.value?.split(",")||[]:t.value,void(this.sendButton=this.emailRequest.email&&this.emailRequest.email.length>0?{...this.sendButton,type:"primary"}:{...this.sendButton,type:"disabled"})):(this.sendButton={...this.sendButton,type:"disabled"},void(this.emailRequest[t.name]=!1))}cancel(){this.dialogRef.close()}send(){const t={toEmails:this.emailRequest.email,communicationTypeIds:[2],templateKey:this.templateKey,invoiceType:this.data.isWorkProvider?1:2,subject:btoa(this.templateSubject.changingThisBreaksApplicationSecurity),messageContent:btoa(this.templateBody.changingThisBreaksApplicationSecurity),attachments:[{name:this.fileName,blobUrl:this.blobUrl}]};this.commonService.showLoading(),this.messagingService.setMessage(t,this.data.repairId).subscribe({next:n=>{this.commonService.showInfoToast(1e3,"email_sent"),this.commonService.hideLoading(),this.dialogRef.close()},error:()=>{this.commonService.hideLoading()}})}tagsReplacers(t){return t?this.sanitizer.bypassSecurityTrustHtml(t.replace(/{{firstName}}/i,(this.data.isWorkProvider?this.data.workProviderValue:this.data.customerValue)||"").replace(/{{lastName}}/i,"").replace(/{{make}}/i,this.repairDetails.vehicle.vehicleMake).replace(/{{model}}/i,this.repairDetails.vehicle.vehicleModel).replace("{{licensenumber}}",this.repairDetails.vehicle.licensePlateNumber).replace("{{pickupdate}}","").replace("{RepairId}",this.repairDetails.repairNumber).replace("{{License Plate}}",this.repairDetails.vehicle.licensePlateNumber).replace("{{orgname}} Team.",`<div style='margin-top:-12px;'>${this.repairDetails.organizationDetail?.nameOfOrganization||"--"} Team.</div>`).replace("{{orgcontactnumber}}",this.repairDetails.organizationDetail?.phoneNumber||"--")):""}ngOnInit(){this.sendButton={label:"send",type:"disabled",icon:"send",onclick:this.send.bind(this)},this.commonService.showLoading(),this.messagingService.getMessageTemplate(this.data.repairId,this.data.domainId,3).subscribe({next:t=>{if(t&&t[0]?.data){this.repairDetails=t[0].data;let r="";if(this.data.isWorkProvider||(r=this.repairDetails.customer?.email),this.emailRequest.email=this.data.isWorkProvider?[this.repairDetails.organizationDetail?.partnerships?this.repairDetails.organizationDetail?.partnerships[0]?.email:""]:[r],this.emailForm.email={...this.emailForm.email,value:this.emailRequest.email[0]},this.downloadPDF(this.data.repairId),t[1]?.data){const s=t[1]?.data;this.templateSubject=s.subject,this.templateBody=s.body,this.templateKey=t[1].data.templateKey,this.templateBody=this.tagsReplacers(this.templateBody),this.templateSubject=this.tagsReplacers(this.templateSubject)}}}}),this.sendButton=this.emailRequest.email&&this.emailRequest.email.length>0?{...this.sendButton,type:"primary"}:{...this.sendButton,type:"disabled"}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(xe.so),e.Y36(we.M),e.Y36(Ri.K),e.Y36(be.v),e.Y36(Ki),e.Y36(ba.H7),e.Y36(xe.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-send-invoice"]],decls:33,vars:21,consts:[[1,"dialog-container"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],["mat-dialog-content","",1,"email-dialog-body"],[1,"form-container"],[1,"input-wrapper"],[1,"div-wrapper"],[3,"ngClass","inputModel","controlOutput"],[1,"subject-wrapper","content-wrapper"],[1,"status",3,"innerHtml"],[1,"message-wrapper","content-wrapper"],[1,"message-container",3,"innerHtml"],[1,"attachment-wrapper","content-wrapper"],[1,"attachment-container"],[1,"attachment-item"],["src","../../../assets/img/pdf.png","alt",""],[1,"btn-container"],[1,"right",3,"buttonModel"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2)(6,"mat-icon",3),e.NdJ("click",function(){return n.cancel()}),e.qZA()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"chq-input",8),e.NdJ("controlOutput",function(s){return n.onFormUpdate(s)}),e.qZA()()(),e.TgZ(12,"div",9)(13,"label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"div",10),e.qZA(),e.TgZ(17,"div",11)(18,"label"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e._UZ(21,"div",12),e.qZA(),e.TgZ(22,"div",13)(23,"label"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"div",14)(27,"div",15)(28,"div"),e._uU(29),e.qZA(),e._UZ(30,"img",16),e.qZA()()()()(),e.TgZ(31,"div",17),e._UZ(32,"chq-button",18),e.qZA()()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,11,"send_email")),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(5),e.Q6J("ngClass",e.VKq(19,m,!n.showCC))("inputModel",n.emailForm.email),e.xp6(3),e.Oqu(e.lcZ(15,13,"subject")),e.xp6(2),e.Q6J("innerHtml",n.templateSubject,e.oJD),e.xp6(3),e.Oqu(e.lcZ(20,15,"message")),e.xp6(2),e.Q6J("innerHtml",n.templateBody,e.oJD),e.xp6(3),e.Oqu(e.lcZ(25,17,"attachments")),e.xp6(5),e.Oqu(n.fileName),e.xp6(3),e.Q6J("buttonModel",n.sendButton))},dependencies:[f.mk,Mt.D,He.E,Le.Hw,pe.X$],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--xa-popup-light-gray);width:39.3125rem;gap:2.25rem;padding:1.875rem}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:first-child{text-transform:uppercase;font-size:12px;line-height:14px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.24963rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:.75rem;font-style:normal;font-weight:400;text-transform:uppercase}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.44963rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]     p{margin:0;line-height:20px;color:var(--xa-black-medium);font-size:16px;font-family:inherit}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-weight:400;color:var(--xa-dark-gray)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{display:inline-block;color:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.4rem;font-size:1rem;font-weight:400;color:var(--xa-black-medium)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]     p{margin:0;line-height:20px;color:var(--xa-black-medium);font-size:16px;font-family:inherit}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]     br{display:none}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]{gap:.86625rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]   .attachment-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.86625rem;font-size:1rem;font-weight:400;color:#0b0e15}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]   .attachment-container[_ngcontent-%COMP%]   .attachment-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;border-top:1px solid #c1c1c1;border-bottom:1px solid #c1c1c1;padding:.3125rem 0rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{display:flex;gap:20px;flex-direction:column}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;line-height:14px;font-weight:400}.dialog-container[_ngcontent-%COMP%]   .email-dialog-body[_ngcontent-%COMP%]{max-height:calc(90vh - 174px)!important}.cc-span[_ngcontent-%COMP%]{position:absolute;right:10px;font-size:16px;line-height:14px;top:35px;color:var(--xa-black-medium);cursor:pointer}.div-wrapper[_ngcontent-%COMP%]{position:relative}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;background:var(--xa-popup-light-gray)}"]}),a})();var pi=k(33938),We=k(48262);let V=(()=>{class a{constructor(){this.maxPoint=1e8}transform(t,n){return t.reduce((s,d)=>s+this.parseFloatingPoint(d[n]),0)/this.maxPoint}parseFloatingPoint(t){return"string"==typeof t&&(t=parseFloat(t)),parseFloat(t)*this.maxPoint}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275pipe=e.Yjl({name:"sum",type:a,pure:!0}),a})();var Zl=k(17489);let Yo=(()=>{class a{constructor(){this.transform=Zl.orderBy}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275pipe=e.Yjl({name:"orderBy",type:a,pure:!0}),a})();var Xi=k(93077);const mn=["print"],Fl=["phone"],Ca=function(a,c){return{active:a,"all-border":c}};function Nl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.updateFormType(1))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.WLB(4,Ca,t.isWorkProvider,"retail"===(null==t.currentWorkProvider?null:t.currentWorkProvider.toLowerCase())&&"person"!==(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase()))),e.xp6(1),e.hij(" ",e.lcZ(2,2,"work_provider_invoice")," ")}}function Ul(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.updateFormType(2))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.WLB(4,Ca,!t.isWorkProvider,"retail"===(null==t.currentWorkProvider?null:t.currentWorkProvider.toLowerCase())&&"person"===(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase()))),e.xp6(1),e.hij(" ",e.lcZ(2,2,"driver_owner_invoice")," ")}}function Jl(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw();e.Gre("status-pill status-",null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase(),""),e.xp6(1),e.Oqu(e.lcZ(2,4,t.paymentStatusMapper[null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase()]))}}function Zt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"img",42),e.NdJ("load",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.orgImageLoading=!1)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("src",t.orgLogoUrl,e.LSH)}}function Gl(a,c){if(1&a&&(e.TgZ(0,"label",44),e._uU(1),e.qZA()),2&a){const t=e.oxw(3);e.xp6(1),e.Oqu(t.orgName)}}function Bl(a,c){if(1&a&&e.YNc(0,Gl,2,1,"label",43),2&a){const t=e.oxw(2);e.Q6J("ngIf",t.orgName)}}function Yl(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"h4"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"h5"),e._uU(5),e.qZA(),e.TgZ(6,"h5"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"h5"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"h5"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"h5"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"chq-input",45),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.dataResponse.invoiceDate=r.value)}),e.qZA(),e._UZ(19,"chq-input",46),e.TgZ(20,"chq-input",45),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.dataResponse.dueDate=r.value)}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,13,"work_provider")),e.xp6(3),e.Oqu(t.workProviderValue),e.xp6(2),e.AsE("",e.lcZ(8,15,"contact_phone_number"),": ",t.dataResponse.customerPhoneNumber,""),e.xp6(3),e.AsE("",e.lcZ(11,17,"contact_email"),": ",t.dataResponse.customerEmail,""),e.xp6(3),e.AsE("",e.lcZ(14,19,"vehicle_owner"),": ",t.dataResponse.vehicleOwnerName,""),e.xp6(3),e.AsE("",e.lcZ(17,21,"license_id_cin"),": ",t.dataResponse.licenseNumber,""),e.xp6(2),e.Q6J("inputModel",t.invoiceIssuedDate),e.xp6(1),e.Q6J("inputModel",t.invoiceNumberInput),e.xp6(1),e.Q6J("inputModel",t.dueDate)}}function Hl(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"h4"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"h5"),e._uU(5),e.qZA(),e.TgZ(6,"h5"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"h5"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"chq-input",45),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return s.dataResponse.address=r.value||null,e.KtG(s.isInvoiceFormValid())}),e.qZA(),e.TgZ(13,"chq-input",45),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return s.dataResponse.invoiceDate=r.value,e.KtG(s.isInvoiceFormValid())}),e.qZA(),e._UZ(14,"chq-input",46),e.TgZ(15,"chq-input",45),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.dataResponse.dueDate=r.value)}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,10,"driver_owner")),e.xp6(3),e.Oqu(t.customerValue),e.xp6(2),e.AsE("",e.lcZ(8,12,"driver_contact_phone_number"),": ",t.dataResponse.customerPhoneNumber,""),e.xp6(3),e.AsE("",e.lcZ(11,14,"driver_contact_email"),": ",t.dataResponse.customerEmail,""),e.xp6(2),e.Q6J("inputModel",t.addressInput),e.xp6(1),e.Q6J("inputModel",t.invoiceIssuedDate),e.xp6(1),e.Q6J("inputModel",t.invoiceNumberInput),e.xp6(1),e.Q6J("inputModel",t.dueDate)}}const zl=function(a){return{"text-mode":a}};function Ft(a,c){if(1&a&&(e.TgZ(0,"div",47)(1,"div",48),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",49)(5,"span"),e._uU(6),e.qZA()()()),2&a){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(6,zl,"paid"===(null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase())||"complete"===(null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase()))),e.xp6(2),e.hij(" ",e.lcZ(3,4,"contact_number")," "),e.xp6(4),e.AsE("",t.dataResponse.code," ",t.dataResponse.mobileNumber||"--","")}}function Ql(a,c){if(1&a&&(e.TgZ(0,"tr")(1,"td",58)(2,"h6",53),e._uU(3),e.qZA()()()),2&a){const t=e.oxw().$implicit;e.xp6(3),e.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}const qe=function(a,c,t,n,r){return[a,c,t,n,r]};function Vl(a,c){if(1&a&&(e.TgZ(0,"tbody"),e.YNc(1,Ql,4,1,"tr",28),e.TgZ(2,"tr")(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",57),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"xaCurrency"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"xaCurrency"),e.qZA()()()),2&a){const t=c.$implicit,n=c.index,r=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(1),e.Q6J("ngIf","Paint"===r.key&&(0===n||n>0&&t.serviceSubType!==s.invoiceList[r.key][n-1].serviceSubType)),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.hij(" ",e.G7q(11,6,e.qbA(18,qe,t.cost,s.i18n.currencySymbol,s.i18n.digitsInfo,s.i18n.locale,s.i18n.position))," "),e.xp6(3),e.hij(" ",e.G7q(14,12,e.qbA(24,qe,t.total,s.i18n.currencySymbol,s.i18n.digitsInfo,s.i18n.locale,s.i18n.position))," ")}}function jl(a,c){if(1&a&&(e.ynx(0),e.TgZ(1,"table",54)(2,"thead")(3,"tr")(4,"td"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"translate"),e.qZA()()(),e.YNc(19,Vl,15,30,"tbody",55),e.ALo(20,"orderBy"),e.qZA(),e.TgZ(21,"table",54)(22,"tfoot")(23,"tr")(24,"td"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"td",56),e._uU(28),e.ALo(29,"xaCurrency"),e.ALo(30,"sum"),e.qZA()()()(),e.BQk()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(5),e.Oqu(e.lcZ(6,10,"description")),e.xp6(3),e.Oqu(e.lcZ(9,12,"code")),e.xp6(3),e.Oqu(e.lcZ(12,14,"units")),e.xp6(3),e.AsE("",e.lcZ(15,16,"price_unit"),"(",n.currencySymbol,")"),e.xp6(3),e.AsE("",e.lcZ(18,18,"total_price"),"(",n.currencySymbol,")"),e.xp6(2),e.Q6J("ngForOf",e.Dn7(20,20,n.invoiceList[t.key],"serviceSubtype","asc")),e.xp6(6),e.Oqu(e.lcZ(26,24,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),e.xp6(3),e.hij(" ",e.G7q(29,26,e.qbA(35,qe,e.xi3(30,32,n.invoiceList[t.key],"total"),n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position))," ")}}function Kl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",50)(1,"span",51),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.hideShowSection(s.key))}),e.TgZ(2,"mat-icon",52),e._uU(3),e.qZA(),e.TgZ(4,"h6",53),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e.YNc(7,jl,31,41,"ng-container",28),e.qZA()}if(2&a){const t=c.$implicit,n=e.oxw(2);e.xp6(3),e.Oqu(n.getSection(t.key)?"keyboard_arrow_up":"keyboard_arrow_down"),e.xp6(2),e.Oqu(e.lcZ(6,3,null==t.key?null:t.key.toLowerCase())),e.xp6(2),e.Q6J("ngIf",n.getSection(t.key))}}function gn(a,c){if(1&a&&(e.TgZ(0,"div",65)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(3);e.xp6(2),e.hij("5% ",e.lcZ(3,2,"vat"),""),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,qe,.05*(t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.labourTotal+t.estimateSummary.partsTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position)))}}function Wl(a,c){if(1&a&&(e.TgZ(0,"div",65)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,2,"total_cost_including_vat")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,qe,t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.labourTotal+t.estimateSummary.partsTotal+.05*(t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.partsTotal+t.estimateSummary.labourTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position)))}}function $l(a,c){if(1&a&&(e.TgZ(0,"div",59)(1,"div",60)(2,"h5"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"h6"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",61)(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"span"),e._uU(13),e.ALo(14,"xaCurrency"),e.qZA()(),e.TgZ(15,"div",61)(16,"span"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"span"),e._uU(20),e.ALo(21,"xaCurrency"),e.qZA()(),e.TgZ(22,"div",61)(23,"span"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"span"),e._uU(27),e.ALo(28,"xaCurrency"),e.qZA()(),e.TgZ(29,"div",62)(30,"span"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"span"),e._uU(34),e.qZA()(),e.TgZ(35,"div",63)(36,"span"),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"span"),e._uU(40),e.ALo(41,"xaCurrency"),e.qZA()(),e.TgZ(42,"h6"),e._uU(43),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"div",61)(46,"span"),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"span"),e._uU(50),e.ALo(51,"xaCurrency"),e.qZA()(),e.TgZ(52,"div",61)(53,"span"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"span"),e._uU(57),e.qZA()(),e.TgZ(58,"div",62)(59,"span"),e._uU(60),e.ALo(61,"translate"),e.qZA(),e.TgZ(62,"span"),e._uU(63),e.qZA()(),e.TgZ(64,"div",63)(65,"span"),e._uU(66),e.ALo(67,"translate"),e.qZA(),e.TgZ(68,"span"),e._uU(69),e.ALo(70,"xaCurrency"),e.qZA()(),e.TgZ(71,"h6"),e._uU(72),e.ALo(73,"translate"),e.qZA(),e.TgZ(74,"div",61)(75,"span"),e._uU(76),e.ALo(77,"translate"),e.qZA(),e.TgZ(78,"span"),e._uU(79),e.qZA()(),e.TgZ(80,"div",61)(81,"span"),e._uU(82),e.ALo(83,"translate"),e.qZA(),e.TgZ(84,"span"),e._uU(85),e.ALo(86,"xaCurrency"),e.qZA()(),e.TgZ(87,"div",61)(88,"span"),e._uU(89),e.ALo(90,"translate"),e.qZA(),e.TgZ(91,"span"),e._uU(92),e.qZA()(),e.TgZ(93,"div",64)(94,"span"),e._uU(95),e.ALo(96,"translate"),e.qZA(),e.TgZ(97,"span"),e._uU(98),e.ALo(99,"xaCurrency"),e.qZA()(),e.TgZ(100,"div",61)(101,"span"),e._uU(102),e.ALo(103,"translate"),e.qZA(),e.TgZ(104,"span"),e._uU(105),e.ALo(106,"xaCurrency"),e.qZA()(),e.TgZ(107,"div",61)(108,"span"),e._uU(109),e.ALo(110,"translate"),e.qZA(),e.TgZ(111,"span"),e._uU(112),e.qZA()(),e.TgZ(113,"div",62)(114,"span"),e._uU(115),e.ALo(116,"translate"),e.qZA(),e.TgZ(117,"span"),e._uU(118),e.ALo(119,"xaCurrency"),e.qZA()(),e.TgZ(120,"div",63)(121,"span"),e._uU(122),e.ALo(123,"translate"),e.qZA(),e.TgZ(124,"span"),e._uU(125),e.ALo(126,"xaCurrency"),e.qZA()(),e.TgZ(127,"div",65)(128,"span"),e._uU(129),e.ALo(130,"translate"),e.qZA(),e.TgZ(131,"span"),e._uU(132),e.ALo(133,"xaCurrency"),e.qZA()(),e.YNc(134,gn,7,16,"div",66),e.YNc(135,Wl,7,16,"div",66),e.qZA()()),2&a){const t=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,42,"summary")),e.xp6(3),e.Oqu(e.lcZ(7,44,"parts")),e.xp6(4),e.Oqu(e.lcZ(11,46,"subtotal")),e.xp6(3),e.Oqu(e.G7q(14,48,e.qbA(158,qe,t.estimateSummary.partsSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(18,54,"sundry_parts")),e.xp6(3),e.Oqu(e.G7q(21,56,e.qbA(164,qe,t.estimateSummary.sundryParts,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(25,62,"total_before_discount")),e.xp6(3),e.Oqu(e.G7q(28,64,e.qbA(170,qe,t.estimateSummary.partsTotalBeforeDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(32,70,"discount_on_parts")),e.xp6(3),e.hij("",t.estimateSummary.partsTotalDiscountPercentage,"%"),e.xp6(3),e.Oqu(e.lcZ(38,72,"total_parts")),e.xp6(3),e.Oqu(e.G7q(41,74,e.qbA(176,qe,t.estimateSummary.partsTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(3),e.Oqu(e.lcZ(44,80,"labour")),e.xp6(4),e.Oqu(e.lcZ(48,82,"labour_amount_subtotal")),e.xp6(3),e.Oqu(e.G7q(51,84,e.qbA(182,qe,t.estimateSummary.labourAmountSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(55,90,"labour_hours")),e.xp6(3),e.hij("",t.estimateSummary.labourTimeHours," hrs"),e.xp6(3),e.Oqu(e.lcZ(61,92,"labour_discount")),e.xp6(3),e.hij("",t.estimateSummary.labourTotalDiscountPercentage,"%"),e.xp6(3),e.Oqu(e.lcZ(67,94,"total_labour_cost")),e.xp6(3),e.Oqu(e.G7q(70,96,e.qbA(188,qe,t.estimateSummary.labourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(3),e.Oqu(e.lcZ(73,102,"paint")),e.xp6(4),e.Oqu(e.lcZ(77,104,"paint_labour_time")),e.xp6(3),e.hij("",t.estimateSummary.paintLabourTimeHour,"hrs"),e.xp6(3),e.Oqu(e.lcZ(83,106,"paint_labour_subtotal")),e.xp6(3),e.Oqu(e.G7q(86,108,e.qbA(194,qe,t.estimateSummary.paintLabourSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(90,114,"paint_labour_discount")),e.xp6(3),e.hij(" ",t.estimateSummary.paintLabourDiscountPercentage,"%"),e.xp6(3),e.Oqu(e.lcZ(96,116,"labour_total")),e.xp6(3),e.Oqu(e.G7q(99,118,e.qbA(200,qe,t.estimateSummary.paintLabourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(103,124,"material_subtotal")),e.xp6(3),e.Oqu(e.G7q(106,126,e.qbA(206,qe,t.estimateSummary.paintMaterialSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(110,132,"material_discount")),e.xp6(3),e.hij("",t.estimateSummary.paintMateriaDiscountPercentage,"%"),e.xp6(3),e.Oqu(e.lcZ(116,134,"material_total")),e.xp6(3),e.Oqu(e.G7q(119,136,e.qbA(212,qe,t.estimateSummary.paintMaterialTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(123,142,"total_paint")),e.xp6(3),e.Oqu(e.G7q(126,144,e.qbA(218,qe,t.calculateSub(t.estimateSummary.paintLabourTotal,t.estimateSummary.paintMaterialTotal,0,0),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(130,150,"total_cost")),e.xp6(3),e.Oqu(e.G7q(133,152,e.qbA(224,qe,t.calculateSub(t.estimateSummary.paintLabourTotal,t.estimateSummary.paintMaterialTotal,t.estimateSummary.labourTotal,t.estimateSummary.partsTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",!1),e.xp6(1),e.Q6J("ngIf",!1)}}const Ze=function(a){return{"do-not-print":a}},Xl=function(a){return{"text-check":a}};function ec(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",20)(1,"section",21)(2,"div",22)(3,"div",23),e.YNc(4,Zt,1,1,"img",24),e.YNc(5,Bl,1,1,"ng-template",null,25,e.W1O),e._UZ(7,"chq-customloader",26),e.qZA(),e.TgZ(8,"div",27),e.YNc(9,Yl,21,23,"ng-container",28),e.YNc(10,Hl,16,16,"ng-container",28),e.qZA()(),e.TgZ(11,"div",29)(12,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.workShopName=r.value||null,e.KtG(s.isInvoiceFormValid())}),e.qZA(),e.TgZ(13,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.bankName=r.value||null,e.KtG(s.isInvoiceFormValid())}),e.qZA(),e.TgZ(14,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.ifscCode=r.value||null,e.KtG(s.isInvoiceFormValid())}),e.qZA(),e.TgZ(15,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.accountNumber=r.value||null,e.KtG(s.isInvoiceFormValid())}),e.qZA(),e.TgZ(16,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.trn=r.value||null,e.KtG(s.isInvoiceFormValid())}),e.qZA(),e.TgZ(17,"div",31)(18,"chq-input",32),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.onFormUpdateCustomer(r))}),e.qZA(),e.TgZ(19,"chq-input",33,34),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.mobileNumber=r.value||null,e.KtG(s.isInvoiceFormValid())}),e.qZA(),e.YNc(21,Ft,7,8,"div",35),e.qZA()()(),e.TgZ(22,"section",36)(23,"div",37)(24,"span",38),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.expandCollapse(!0))}),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"span",38),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.expandCollapse(!1))}),e._uU(28),e.ALo(29,"translate"),e.qZA()(),e.TgZ(30,"div",39),e.YNc(31,Kl,8,5,"div",40),e.ALo(32,"keyvalue"),e.YNc(33,$l,136,230,"div",41),e.qZA()()()}if(2&a){const t=e.MAs(6),n=e.oxw();e.xp6(4),e.Q6J("ngIf",n.orgLogoUrl)("ngIfElse",t),e.xp6(3),e.Q6J("showLoading",n.orgImageLoading),e.xp6(2),e.Q6J("ngIf",n.isWorkProvider),e.xp6(1),e.Q6J("ngIf",!n.isWorkProvider),e.xp6(2),e.Q6J("ngClass",e.VKq(36,Ze,!n.dataResponse.workShopName))("inputModel",n.payeeOrgNameInput),e.xp6(1),e.Q6J("ngClass",e.VKq(38,Ze,!n.dataResponse.bankName))("inputModel",n.payeeBankNameInput),e.xp6(1),e.Q6J("ngClass",e.VKq(40,Ze,!n.dataResponse.ifscCode))("inputModel",n.IfscCodeInput),e.xp6(1),e.Q6J("ngClass",e.VKq(42,Ze,!n.dataResponse.accountNumber))("inputModel",n.accountNumberInput),e.xp6(1),e.Q6J("ngClass",e.VKq(44,Ze,!n.dataResponse.trn))("inputModel",n.trnNumberInput),e.xp6(1),e.Q6J("ngClass",e.VKq(46,Xl,"paid"===(null==n.dataResponse||null==n.dataResponse.paymentStatus?null:n.dataResponse.paymentStatus.toLowerCase())||"complete"===(null==n.dataResponse||null==n.dataResponse.paymentStatus?null:n.dataResponse.paymentStatus.toLowerCase()))),e.xp6(1),e.Q6J("ngClass",e.VKq(48,Ze,!n.phoneCode.value))("inputModel",n.phoneCode),e.xp6(1),e.Q6J("ngClass",e.VKq(50,Ze,!n.dataResponse.mobileNumber))("inputModel",n.contactNumberInput),e.xp6(2),e.Q6J("ngIf",n.dataResponse.mobileNumber),e.xp6(3),e.ekj("secondary-color",n.isAllExpanded),e.xp6(1),e.Oqu(e.lcZ(26,29,"expand_all")),e.xp6(2),e.ekj("secondary-color",!n.isAllExpanded),e.xp6(1),e.hij("",e.lcZ(29,31,"collapse_all")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(32,33,n.invoiceList,n.valueAscOrder)),e.xp6(2),e.Q6J("ngIf",n.estimateSummary)}}const tc=function(a){return{value:a}};function nc(a,c){if(1&a&&(e.TgZ(0,"div",67),e._UZ(1,"mat-icon",68),e.TgZ(2,"p",69),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("svgIcon","estimate-no-data"),e.xp6(2),e.hij(" ",e.xi3(4,2,"no_invoice_result",e.VKq(5,tc,t.isWorkProvider?t.workProviderValue:t.customerValue)),". ")}}function ic(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-dropdown",70),e.NdJ("selected",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.handleSelectedOption(r))}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function Ma(a,c){if(1&a&&e._UZ(0,"chq-button",71),2&a){const t=e.oxw();e.Q6J("buttonModel",t.saveButtonModel)}}function Pa(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",72),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.openPaymentPopup())}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("buttonModel",t.paymentsButtonModel)}}function oc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",72),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.closeRepair())}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("buttonModel",t.closeRepairButtonModel)}}let rc=(()=>{class a{constructor(t,n,r,s,d,u,v,P,y,w,D){this.commonService=t,this.route=n,this.router=r,this.dialog=s,this.coreService=d,this.translateService=u,this.OutboundService=v,this.invoiceService=P,this.bookingService=y,this.translationService=w,this.monitorServie=D,this.digitInfo="",this.locale="",this.currencySymbol="",this.charges=[],this.subs=[],this.isOptionsOpen=!1,this.invoiceList={},this.isWorkProvider=!0,this.orgImageLoading=!0,this.orgLogoUrl="",this.orgName="",this.repairStatus="",this.domainId=3100,this.isAllExpanded=!0,this.isPartsExpanded=!0,this.isLabourExpanded=!0,this.isPaintExpanded=!0,this.isDataLoading=!0,this.dataResponse={},this.pickupDate=null,this.currentDueDate=null,this.bookingOutDate=null,this.trnNumberLimit=15,this.partsCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",units:"2",cost:"500",total:"1500"}],this.totalPartsCost=0,this.labourCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",hours:"5",cost:"500",total:"1500"}],this.totalLabourCost=0,this.maxPoint=1e7,this.estimateSummary={},this.currentWorkProvider="",this.currentWorkProviderType="",this.workProviderValue="",this.customerValue="",this.paintLabour=[{description:"Boot lid Repaired <50%",code:"GtP84000",unitHours:"1.60",cost:"500",total:"1500"}],this.paintMaterial=[{description:"Boot lid Repaired <50%",code:"GtP84000",unitHours:"1",cost:"300",total:"300"}],this.totalPaintCost=0,this.noDataFound=!1,this.paintCost=[],this.dropdownApprovalModelFilter={options:[{dropdownItemIconMaterial:"mail_outline",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"send",label:this.translationService.instant("send")},{dropdownItemIconMaterial:"download-arrow",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"download",label:this.translationService.instant("download")}],placeHolder:"Options",label:"",hideDropdownIcon:!1,appearance:"button",placeHolderIcon:"settings-outline",name:"option",displayValue:"label",selectedOption:{}},this.backButtonModel={label:"Back / Edit Invoice ",type:"outline",icon:"left-arrow",onclick:()=>{const q=this.route.parent?.snapshot.paramMap.get("id");this.router.navigate([`repair/booking/${q}/invoices`],{queryParams:{isBack:!0}})}},this.saveButtonModel={label:"Save",type:"outline",onclick:()=>{this.saveInvoiceComponent()}},this.invoiceGUID="",this.paymentsButtonModel={label:"Payments",icon:"credit-card",type:"outline"},this.closeRepairButtonModel={label:"Close Repair",icon:"cross",type:"primary"},this.invoiceIssuedDate={placeHolder:"Select Date",label:"INVOICE DATE",name:"invoiceDate",value:new Date,maxDate:new Date,type:"date",required:!0,disabled:!1,mode:"text"},this.dueDate={placeHolder:"Select Date",label:"DUE DATE",name:"dueDate",value:"",type:"date",required:!1,disabled:!1,mode:"date"},this.addressInput={placeHolder:"",label:"ADDRESS",name:"address",value:"St 123",type:"text",maxLength:200,validation:{name:"address",validationFunction:()=>T.kI.compose([T.kI.maxLength(200)]),validationMessage:q=>q.required?"Please select operation type":q.maxLength?this.translateService.instant("max_length",{value:200}):""}},this.invoiceNumberInput={placeHolder:"",label:"INVOICE NUMBER",name:"invoiceNumber",value:"",type:"text",mode:"text"},this.payeeOrgNameInput={placeHolder:"",label:"workshop",name:"orgName",value:"XA Prestige Automotive",type:"text",validation:{name:"orgName",validationFunction:()=>T.kI.compose([T.kI.maxLength(30)]),validationMessage:q=>q.maxlength?this.translateService.instant("max_length",{value:30}):""}},this.payeeBankNameInput={placeHolder:"",label:"Payee BANK  Name",name:"bankname",value:"Emirates NBD",type:"text",validation:{name:"orgName",validationFunction:()=>T.kI.compose([T.kI.maxLength(30)]),validationMessage:q=>q.maxlength?this.translateService.instant("max_length",{value:30}):""}},this.IfscCodeInput={placeHolder:"",label:"IFSC/Swift Code",name:"ifscCode",maxLength:11,value:"9076986696",type:"text",validation:{name:"orgName",validationFunction:()=>T.kI.compose([T.kI.maxLength(11),T.kI.minLength(11)]),validationMessage:q=>q.maxlength||q.minlength?this.translateService.instant("max_length",{value:11}):""}},this.accountNumberInput={placeHolder:"",label:"Account Number/IBAN",name:"accountNumber",value:"",type:"text",validation:{name:"accountNumber",validationFunction:()=>T.kI.compose([T.kI.minLength(9),T.kI.maxLength(34),T.kI.pattern("^[a-zA-Z0-9]{9,34}$")]),validationMessage:q=>q.minlength?"min_account_number":q.maxlength?"max_account_number":q.pattern?"Please enter a valid Account Number/IBAN":""}},this.trnNumberInput={placeHolder:"",label:"TRN",name:"trn",value:"",type:"number",maxLength:this.trnNumberLimit,validation:{name:"accountNumber",validationFunction:()=>T.kI.compose([T.kI.pattern(`^[0-9]{${this.trnNumberLimit}}$`)]),validationMessage:q=>q.pattern?"Please enter a valid TRN Number":""}},this.phoneCode={placeHolder:"select_dot",label:"code",name:"code",value:91,showImageFlag:!0,type:"select",selectedOption:{phoneCountryCode:"+91"},displayValue:"phoneCountryCode",fieldValue:"phoneCountryCode",options:[{label:"+90"},{label:"+971"},{label:"+977"}],validation:{name:"code",validationFunction:()=>T.kI.compose([]),validationMessage:q=>q.required?"required_code":""}},this.contactNumberInput={placeHolder:"",label:"CONTACT NUMBER",name:"contactNumber",value:"",type:"number",validation:{name:"contactNumber",validationFunction:()=>T.kI.compose([T.kI.pattern("^[0-9]+[0-9 ,.'-]+$")]),validationMessage:q=>q.required?"Please enter mobile number":q.pattern?"Please enter valid mobile number":""}},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.hashPropTable={},this.IsPickedup=!1,this.isWorkProvider=1==this.route.snapshot?.queryParams.formType,this.navigationEndSubscription=this.router.events.subscribe(q=>{q instanceof ye.m2&&(this.isWorkProvider=1==this.route.snapshot?.queryParams.formType)}),this.commonService.reloadDetail.closed&&(this.commonService.reloadDetail=new Ct.X(null)),this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}onObservableLoad(t){if(this.commonService.hideLoading(),t&&t&&t.length>0){if(!this.dataResponse.contactNumber)return this.phoneCode={...this.phoneCode,selectedOption:{}},void(this.contactNumberInput={...this.contactNumberInput,value:null});const n=this.dataResponse.contactNumber?.substring(0,3),r=this.dataResponse.contactNumber?.substring(0,4);let s="",d=t.filter(u=>u.phoneCountryCode===n);if(0===d.length?(s=this.dataResponse.contactNumber?.substring(4,this.dataResponse.contactNumber?.length),d=t.filter(u=>u.phoneCountryCode===r)):s=this.dataResponse.contactNumber?.substring(3,this.dataResponse.contactNumber?.length),d.length>0){const u=d[0],v=u.regExpression;this.phoneCode={...this.phoneCode,selectedOption:u,mode:"complete"===this.repairStatus.toLowerCase()||this.commonService.isViewOnly||"paid"===this.repairStatus.toLowerCase()?"text":null},this.dataResponse.code=u.phoneCountryCode,this.contactNumberInput={...this.contactNumberInput,value:s},this.phone&&(this.phone.updateCurrentValidation(v,!0,!0),this.phone.setDirty())}}}sendInvoice(){const t=this.route.parent?.snapshot.paramMap.get("id");this.dialog.open(Un,{data:{repairId:t,domainId:this.domainId,invoiceId:this.invoiceGUID,isWorkProvider:this.isWorkProvider,workProviderValue:this.workProviderValue,customerValue:this.customerValue,dueDate:this.currentDueDate},backdropClass:"confirmation-popup-backdrop",autoFocus:!1})}handleSelectedOption(t){"send"===t.value.value?this.sendInvoice():this.downloadPDF()}updateFormType(t){this.isDataLoading=!0,this.isWorkProvider=1===t,this.invoiceList={},this.noDataFound=!0,this.getBookingRepairDetails()}onFormUpdateCustomer(t){if("code"===t.name){const n=t.value.regExpression;this.dataResponse.code=t.value.phoneCountryCode,this.phoneCode={...this.phoneCode,selectedOption:t.value},this.phone?.updateCurrentValidation(n,!1,!0)}}valueAscOrder(t,n){const r={part:"1",labour:"2",paint:"3"};return r[t.key?.toLowerCase()].localeCompare(r[n.key?.toLowerCase()])}isInvoiceFormValid(){this.saveButtonModel=this.invoiceIssuedDate.formControl?.valid&&this.IfscCodeInput.formControl?.valid&&this.payeeBankNameInput.formControl?.valid&&this.payeeOrgNameInput.formControl?.valid&&this.accountNumberInput.formControl?.valid&&this.trnNumberInput.formControl?.valid&&this.contactNumberInput.formControl?.valid?{...this.saveButtonModel,type:"outline"}:{...this.saveButtonModel,type:"disabled-outline"}}getBookingRepairDetails(){var t=this;this.commonService.showLoading();const n=this.route.parent?.snapshot.paramMap.get("id");var r;this.monitorServie.logEvent("getBookingRepairDetails",["InvoicesComponent","addenda-repair"],{repairGuid:n}),this.bookingService.getRepairDetailByGuid(n).subscribe({next:(r=(0,ue.Z)(function*(s){if(s?.data){t.pickupDate=s.data.pickUpDate,t.bookingOutDate=s.data.booking.endDate,t.IsPickedup=s.data.isPickedUp,t.repairStatus=s.data.status,t.domainId=s.data.domainId;const d=s.data.createdDate,u=E(new Date).diff(E(d),"minutes");t.invoiceIssuedDate={...t.invoiceIssuedDate,minDate:E(d).toDate(),disabled:u<0,value:E(d).toDate(),maxDate:u<0?E(d).toDate():new Date},t.dueDate={...t.dueDate,minDate:E(d).toDate()},t.currentWorkProvider=s.data.customer.companyOrgType,t.currentWorkProviderType=s.data.customer.customerTypeName,t.customerValue=`${s.data?.customer?.firstName} ${s.data?.customer?.lastName}`,t.workProviderValue=s.data?.customer?.companyName||s.data?.customer?.customerTypeName,null!==s.data.organizationDetail?.country&&"india"===s.data.organizationDetail?.country.toLowerCase()&&(t.trnNumberInput={...t.trnNumberInput,label:"TIN",validation:{name:"accountNumber",validationFunction:()=>T.kI.compose([T.kI.pattern(`^[0-9]{${t.trnNumberLimit}}$`)]),validationMessage:v=>v.pattern?"Please enter a valid TIN Number":""}}),t.invoiceService.invoicePerDetailProvider(n,t.isWorkProvider?1:2).subscribe({next:v=>{if(!v)return t.commonService.hideLoading(),t.isDataLoading=!1,void(t.noDataFound=!0);const{orgName:P,logoUrl:w}=v.data;t.dataResponse=v.data,t.isDataLoading=!1,t.noDataFound=!1;let D=null;t.invoiceGUID=t.dataResponse.invoiceGuid,("paid"===t.dataResponse?.paymentStatus?.toLowerCase()||t.commonService.isViewOnly||"complete"===t.dataResponse?.paymentStatus?.toLowerCase()||"complete"===t.repairStatus?.toLowerCase())&&(D="text"),t.invoiceIssuedDate={...t.invoiceIssuedDate,value:t.dataResponse.invoiceDate},t.accountNumberInput={...t.accountNumberInput,value:t.dataResponse.accountNumber,mode:D},t.IfscCodeInput={...t.IfscCodeInput,value:t.dataResponse.ifscCode,mode:D},t.addressInput={...t.addressInput,value:t.dataResponse.address,mode:D},t.contactNumberInput={...t.contactNumberInput,mode:D},t.trnNumberInput={...t.trnNumberInput,value:t.dataResponse.trn,mode:D},t.payeeBankNameInput={...t.payeeBankNameInput,value:t.dataResponse.bankname,mode:D},t.payeeOrgNameInput={...t.payeeOrgNameInput,value:t.dataResponse.workShopName,mode:D},t.dueDate={...t.dueDate,value:t.dataResponse.dueDate||"",mode:D},t.currentDueDate=t.dataResponse.dueDate,t.invoiceNumberInput={...t.invoiceNumberInput,value:t.dataResponse.invoiceNumber},t.dataResponse.dueDate||(t.dataResponse.dueDate=new Date),t.phoneCode.observable||(t.phoneCode.observable=t.coreService.getPhoneNumber(),t.phoneCode.onObservableLoad=t.onObservableLoad.bind(t)),t.orgName=P,t.orgLogoUrl=w;const q=t.dataResponse.chargesDTO;t.charges=q,t.estimateSummary=t.dataResponse?.chargeSummary,q?.forEach(se=>{t.invoiceList[se.serviceType]||(t.invoiceList[se.serviceType]=[]),t.invoiceList[se.serviceType].push(se)}),t.orgLogoUrl||(t.orgImageLoading=!1),t.commonService.hideLoading(),t.commonService.repairDetails.next(s.data),t.commonService.bookingId.next(s.data.repairNumber)}})}else t.isDataLoading=!1,t.commonService.hideLoading()}),function(d){return r.apply(this,arguments)}),error:r=>{this.isDataLoading=!1,this.commonService.hideLoading(),this.monitorServie.logException(r,_e._.Error)}})}calculateSub(t,n,r,s){return(t*this.maxPoint+n*this.maxPoint+r*this.maxPoint+s*this.maxPoint)/this.maxPoint}parseFloatingPoint(t,n){return this.hashPropTable[n]?t:(n&&(this.hashPropTable[n]=!0),t*this.maxPoint)}validateLabourTypes(t,n,r,s){return n===un.UW.Paint?"PaintLabour"===r.serviceSubType?(t.paintLabourHourSubTotal=this.parseFloatingPoint(t.paintLabourHourSubTotal,`paintLabourHourSubTotal_${s}`)+this.parseFloatingPoint(r.quantity),t.paintLabourAmountSubTotal=this.parseFloatingPoint(t.paintLabourAmountSubTotal,`paintLabourAmountSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintLabourSubTotal=this.parseFloatingPoint(t.paintLabourSubTotal,`paintLabourSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintLabourTotal=this.parseFloatingPoint(t.paintLabourTotal,`paintLabourSubTotal+${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.paintLabourDiscountPercentage))/100)):(t.paintMaterialSubTotal=this.parseFloatingPoint(t.paintMaterialSubTotal,`paintMaterialSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintMaterialTotal=this.parseFloatingPoint(t.paintMaterialTotal,`paintMaterialTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.paintMateriaDiscountPercentage))/100)):n===un.UW.Labour?(t.labourTotalBeforeDiscount=this.parseFloatingPoint(t.labourTotalBeforeDiscount,`labourTotalBeforeDiscount_${s}`)+this.parseFloatingPoint(r.total),t.labourAmountSubTotal=this.parseFloatingPoint(t.labourAmountSubTotal,`labourAmountSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.labourTotal=this.parseFloatingPoint(t.labourTotal,`labourTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.labourTotalDiscountPercentage))/100),t.labourHourSubTotal=this.parseFloatingPoint(t.labourHourSubTotal,`labourHourSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.labourTimeHours=this.parseFloatingPoint(t.labourTimeHours,`labourTimeHours_${s}`)+this.parseFloatingPoint(r.quantity)):(t.partsTotalBeforeDiscount=this.parseFloatingPoint(t.partsTotalBeforeDiscount,`partsTotalBeforeDiscount_${s}`)+this.parseFloatingPoint(r.total),t.partsTotal=this.parseFloatingPoint(t.partsTotal,`partsTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.partsTotalDiscountPercentage))/100),t.partsSubTotal=this.parseFloatingPoint(t.partsSubTotal,`partsSubTotal_${s}`)+this.parseFloatingPoint(r.total)),t}calculateSummary(t){return this.hashPropTable={},t.paintLabourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.paintLabourSubTotal=0,t.labourTotal=0,t.paintLabourTotal=0,t.labourTimeHours=0,t.labourTotalBeforeDiscount=0,t.paintMaterialTotal=0,t.paintMaterialSubTotal=0,t.labourAmountSubTotal=0,t.labourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.partsSubTotal=0,t.partsTotal=0,t.partsTotalBeforeDiscount=0,this.charges.forEach(n=>{const r=n.serviceType;(n.cost||"0"===n.cost)&&(n.cost=parseFloat(n.cost)),(n.quantity||"0"===n.quantity)&&(n.quantity=parseFloat(n.quantity)),(n.total||"0"===n.total)&&(n.total=parseFloat(n.total)),t=this.validateLabourTypes(t,r,n,n.recipient)}),t.paintLabourHourSubTotal=t.paintLabourHourSubTotal/this.maxPoint,t.paintLabourAmountSubTotal=t.paintLabourAmountSubTotal/this.maxPoint,t.paintLabourSubTotal=t.paintLabourSubTotal/this.maxPoint,t.labourTotal=t.labourTotal/this.maxPoint,t.paintLabourTotal=t.paintLabourTotal/this.maxPoint,t.labourTimeHours=t.labourTimeHours/this.maxPoint,t.labourTotalBeforeDiscount=t.labourTotalBeforeDiscount/this.maxPoint,t.paintMaterialTotal=t.paintMaterialTotal/this.maxPoint,t.paintMaterialSubTotal=t.paintMaterialSubTotal/this.maxPoint,t.labourAmountSubTotal=t.labourAmountSubTotal/this.maxPoint,t.labourHourSubTotal=t.labourHourSubTotal/this.maxPoint,t.paintLabourAmountSubTotal=t.paintLabourAmountSubTotal/this.maxPoint,t.partsSubTotal=t.partsSubTotal/this.maxPoint,t.partsTotal=t.partsTotal/this.maxPoint,t.partsTotalBeforeDiscount=t.partsTotalBeforeDiscount/this.maxPoint,t}ngOnInit(){this.noDataFound=!0,this.commonService.isViewOnly&&(this.dropdownApprovalModelFilter={...this.dropdownApprovalModelFilter,options:[{dropdownItemIconMaterial:"download-arrow",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"download",label:this.translationService.instant("download")}]}),this.getBookingRepairDetails(),this.commonService.reloadDetail.subscribe({next:t=>{t&&this.dataResponse.dueAmount&&t!==this.dataResponse.dueAmount&&this.getBookingRepairDetails()}})}ngAfterViewInit(){this.isInvoiceFormValid()}expandCollapse(t){this.isAllExpanded=t,this.isPartsExpanded=t,this.isPaintExpanded=t,this.isLabourExpanded=t}hideShowSection(t){"part"===t?.toLowerCase()?this.isPartsExpanded=!this.isPartsExpanded:"labour"===t?.toLowerCase()?this.isLabourExpanded=!this.isLabourExpanded:this.isPaintExpanded=!this.isPaintExpanded}getSection(t){return"part"===t?.toLowerCase()?this.isPartsExpanded:"labour"===t?.toLowerCase()?this.isLabourExpanded:this.isPaintExpanded}downloadPDF(){const t=this.route.parent?.snapshot.paramMap.get("id"),n=this.dataResponse.invoiceGuid;let r;this.invoiceGUID=n,this.commonService.showLoading(),r=this.currentDueDate?{parameters:[{name:"dueDate",value:E(this.currentDueDate).format("YYYY-MM-DD")}]}:{parameters:[]},this.invoiceService.invoicePDF(t,n,r).subscribe({next:s=>{const d=s?.data?.url;d&&window.open(d,"_top"),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}saveInvoiceComponent(){this.dataResponse.contactNumber=this.dataResponse.code&&this.dataResponse.mobileNumber?this.dataResponse.code+this.dataResponse.mobileNumber:null;const t={...this.dataResponse,dueDate:E(this.dataResponse.dueDate).format("YYYY-MM-DD")+"T00:00:00Z",ifscCode:this.dataResponse.ifscCode||null};this.commonService.showLoading(),this.invoiceService.saveInvoicePerDetail(t).subscribe({next:()=>{this.commonService.showInfoToast(1e3,"Invoice detail saved successfully"),this.currentDueDate=this.dataResponse.dueDate,this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}ngOnDestroy(){this.navigationEndSubscription.unsubscribe(),this.subs.forEach(t=>t.unsubscribe()),this.commonService.reloadDetail.unsubscribe()}openPaymentPopup(){const t=this.route.parent?.snapshot.paramMap.get("id");this.dialog.open(ql,{data:{repairId:t,isWorkProvider:this.isWorkProvider,...this.dataResponse},width:"80vw",height:"80vh",panelClass:"payment-panel",autoFocus:!1}).afterClosed().subscribe({next:r=>{r!==this.dataResponse.dueAmount&&this.getBookingRepairDetails()}})}closeRepair(){var t=this;if("repairinprogress"==this.repairStatus.toLowerCase()||"approved"==this.repairStatus.toLowerCase())return void this.commonService.showInfoToast(1e3,this.translateService.instant("repair_stages_are_not_completed"));if("complete"==this.repairStatus.toLowerCase())return void this.commonService.showInfoToast(1e3,this.translateService.instant("repair_is_closed"));this.commonService.showLoading();const n=this.route.parent?.snapshot.paramMap.get("id");var r;this.bookingService.getRepairTask(n).subscribe({next:(r=(0,ue.Z)(function*(s){if(t.commonService.hideLoading(),s&&s.data&&s.data.length>0){let d=[];if(s.data.forEach(v=>{v.repairJobTasks&&v.repairJobTasks.length>0&&(d=[...d,...v.repairJobTasks])}),0===d.length)return void t.setRepairClose();if(null!==t.pickupDate&&t.IsPickedup)return void t.setRepairClose();t.commonService.openConfirmYesNoDialog(t.translateService.instant("confirm_to_continue"),t.translateService.instant("is_the_vehicle_picked_up")).afterClosed().subscribe(v=>{t.openSchedulerPopUpForPickUp(v?"pickedUp":"schedule")})}else t.setRepairClose()}),function(d){return r.apply(this,arguments)}),error:()=>{this.commonService.hideLoading()}})}setRepairClose(){this.commonService.openConfirmYesNoDialog(this.translateService.instant("confirm_closing_repair"),this.translateService.instant("repair_close_confirm_message")).afterClosed().subscribe(n=>{n&&this.setRepairCloseInner()})}setRepairCloseInner(){this.commonService.showLoading(),this.subs.push(this.OutboundService.setRepairStatusComplete(this.route.parent?.snapshot.paramMap.get("id")).subscribe({next:t=>{this.repairStatus="Complete";const n="text";this.invoiceIssuedDate={...this.invoiceIssuedDate,value:this.dataResponse.invoiceDate},this.accountNumberInput={...this.accountNumberInput,value:this.dataResponse.accountNumber,mode:n},this.IfscCodeInput={...this.IfscCodeInput,value:this.dataResponse.ifscCode,mode:n},this.addressInput={...this.addressInput,value:this.dataResponse.address,mode:n},this.contactNumberInput={...this.contactNumberInput,mode:n},this.trnNumberInput={...this.trnNumberInput,value:this.dataResponse.trn,mode:n},this.payeeBankNameInput={...this.payeeBankNameInput,value:this.dataResponse.bankname,mode:n},this.payeeOrgNameInput={...this.payeeOrgNameInput,value:this.dataResponse.workShopName,mode:n},this.dueDate={...this.dueDate,value:this.dataResponse.dueDate||new Date,mode:n},this.phoneCode={...this.phoneCode,mode:n};const r=this.route.parent?.snapshot.paramMap.get("id");this.bookingService.getRepairDetailByGuid(r).subscribe({next:s=>{s?.data&&(this.commonService.repairDetails.next(s.data),this.commonService.bookingId.next(s.data.repairNumber))},error:s=>{this.monitorServie.logException(s,_e._.Error)}}),this.commonService.showInfoToast(1e3,t.message),this.commonService.hideLoading()},error:t=>{this.commonService.hideLoading()}}))}openSchedulerPopUpForPickUp(t){this.dialog.open(ci,{data:{repairID:"",pickupDate:null===this.pickupDate?this.bookingOutDate:this.pickupDate,callSource:t},panelClass:"SchedulePickupDate-modalbox",autoFocus:!1}).afterClosed().subscribe({next:n=>{if(!n)return;const r=E.utc(n.PickUpDate.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z";this.setPickUpDateForRepair(r,t)}})}setPickUpDateForRepair(t,n){this.commonService.showLoading(),this.subs.push(this.OutboundService.setPickupDate(this.route.parent?.snapshot.paramMap.get("id"),t,"pickedUp"===n).subscribe({next:r=>{"pickedUp"===n&&(this.setRepairClose(),this.IsPickedup=!0),this.pickupDate=t,this.commonService.showInfoToast(1e3,r.message),this.commonService.hideLoading()},error:r=>{this.commonService.hideLoading()}}))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(be.v),e.Y36(ye.gz),e.Y36(ye.F0),e.Y36(xe.uw),e.Y36(le.p),e.Y36(pe.sK),e.Y36(pi.Q),e.Y36(Ki),e.Y36(Dt.q),e.Y36(pe.sK),e.Y36(we.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-generate-invoices"]],viewQuery:function(t,n){if(1&t&&(e.Gf(mn,5),e.Gf(Fl,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.print=r.first),e.iGM(r=e.CRH())&&(n.phone=r.first)}},features:[e._Bn([pi.Q])],decls:19,vars:10,consts:[[1,"repair-invoice-wrapper"],[1,"invoice-back-btn"],[1,"no-border",3,"buttonModel"],[1,"status-pill-wrapper"],[1,"invoice-mode"],["class","btn-work",3,"ngClass","click",4,"ngIf"],["class","btn-driver",3,"ngClass","click",4,"ngIf"],[3,"class",4,"ngIf"],["class","generate-invoice-page-container","id","print-section",4,"ngIf"],["class","estimate-details-no-data-found",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["alt","addenda logo","src","assets/img/addenda-repair.png"],[1,"button-container"],["class","option-sender",3,"dropdownModel","selected",4,"ngIf"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel","click",4,"ngIf"],[1,"btn-work",3,"ngClass","click"],[1,"btn-driver",3,"ngClass","click"],["id","print-section",1,"generate-invoice-page-container"],[1,"repair-info"],[1,"repair-info-col-1"],[1,"org-image"],["alt","org logo",3,"src","load",4,"ngIf","ngIfElse"],["name",""],[3,"showLoading"],[1,"repair-detail"],[4,"ngIf"],[1,"repair-info-col-2"],[1,"col-6","invoice-date-input","outline",3,"ngClass","inputModel","controlOutput"],[1,"driver-fields-wrapper","col-6","invoice-date-input",3,"ngClass"],[1,"driver-field","driver-code-field","no-padding","outline",3,"ngClass","inputModel","controlOutput"],[1,"driver-field","no-padding","outline",3,"ngClass","inputModel","controlOutput"],["phone",""],["class","driver-field-content",3,"ngClass",4,"ngIf"],[1,"invoices-table-wrapper"],[1,"expand-collapse-btn","do-not-print"],[3,"click"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],["class","invoice-detail",4,"ngIf"],["alt","org logo",3,"src","load"],["class","org-name",4,"ngIf"],[1,"org-name"],[1,"col-6","invoice-date-input","outline",3,"inputModel","controlOutput"],[1,"col-6","invoice-date-input",3,"inputModel"],[1,"driver-field-content",3,"ngClass"],[1,"label-text"],[1,"driver-content-value"],[1,"table-parent"],[1,"expand-container",3,"click"],[1,"do-not-print"],[1,"small-heading"],["width","100%"],[4,"ngFor","ngForOf"],["align","right"],[1,"text-light"],["colspan","5"],[1,"invoice-detail"],[1,"invoice-col"],[1,"invoice-row","border-b"],[1,"invoice-row"],[1,"total-invoice-row"],[1,"total-invoice-row","no-border"],[1,"total-box"],["class","total-box",4,"ngIf"],[1,"estimate-details-no-data-found"],[1,"no-data-svg",3,"svgIcon"],[1,"no-data-text"],[1,"option-sender",3,"dropdownModel","selected"],[3,"buttonModel"],[3,"buttonModel","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"chq-button",2),e.qZA(),e.TgZ(3,"div",3)(4,"div",4),e.YNc(5,Nl,3,7,"button",5),e.YNc(6,Ul,3,7,"button",6),e.qZA(),e.YNc(7,Jl,3,6,"span",7),e.qZA(),e.YNc(8,ec,34,52,"div",8),e.YNc(9,nc,5,7,"div",9),e.TgZ(10,"div",10)(11,"div",11)(12,"div",12),e._UZ(13,"img",13),e.qZA()(),e.TgZ(14,"div",14),e.YNc(15,ic,1,1,"chq-dropdown",15),e.YNc(16,Ma,1,1,"chq-button",16),e.YNc(17,Pa,1,1,"chq-button",17),e.YNc(18,oc,1,1,"chq-button",17),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("buttonModel",n.backButtonModel),e.xp6(3),e.Q6J("ngIf","retail"!==(null==n.currentWorkProvider?null:n.currentWorkProvider.toLowerCase())||"retail"===(null==n.currentWorkProvider?null:n.currentWorkProvider.toLowerCase())&&"person"!==(null==n.currentWorkProviderType?null:n.currentWorkProviderType.toLowerCase())),e.xp6(1),e.Q6J("ngIf","retail"!==(null==n.currentWorkProvider?null:n.currentWorkProvider.toLowerCase())||"retail"===(null==n.currentWorkProvider?null:n.currentWorkProvider.toLowerCase())&&"person"===(null==n.currentWorkProviderType?null:n.currentWorkProviderType.toLowerCase())),e.xp6(1),e.Q6J("ngIf",!n.noDataFound&&(null==n.dataResponse?null:n.dataResponse.invoiceAmount)>0),e.xp6(1),e.Q6J("ngIf",!n.isDataLoading&&!n.noDataFound),e.xp6(1),e.Q6J("ngIf",n.noDataFound&&!n.isDataLoading),e.xp6(6),e.Q6J("ngIf",!n.noDataFound),e.xp6(1),e.Q6J("ngIf",!n.noDataFound&&"paid"!==(null==n.dataResponse||null==n.dataResponse.paymentStatus?null:n.dataResponse.paymentStatus.toLowerCase())&&!n.commonService.isViewOnly&&"complete"!==n.repairStatus.toLowerCase()),e.xp6(1),e.Q6J("ngIf",!n.noDataFound&&(null==n.dataResponse?null:n.dataResponse.invoiceAmount)>0),e.xp6(1),e.Q6J("ngIf",!n.commonService.isViewOnly&&"complete"!==n.repairStatus.toLowerCase()))},dependencies:[f.mk,f.sg,f.O5,Mt.D,Ro.I,He.E,We.h,Le.Hw,f.Nd,V,Yo,Xi.j,pe.X$],styles:[".repair-invoice-wrapper[_ngcontent-%COMP%]{background-color:#dbdde2;height:calc(100% - 315px);padding-top:50px}.repair-invoice-wrapper[_ngcontent-%COMP%]     .invoice-back-btn{display:flex;margin-bottom:.75rem;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]     .invoice-back-btn chq-button button.button-outline{border:none!important}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]{display:flex;font-size:1rem;font-style:normal;font-weight:400}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .btn-work[_ngcontent-%COMP%]{background:transparent;border-radius:.5rem 0rem 0rem .5rem;border:1px solid var(--xa-draft);box-shadow:0 1px 3px #606c800d}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .btn-driver[_ngcontent-%COMP%]{border:1px solid var(--xa-draft);background:transparent;border-radius:0rem .5rem .5rem 0rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background:#4c6bd2;color:#fff}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;font-size:.625rem;font-style:normal;font-weight:700;padding:.5875rem 1rem;border-radius:.625rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:var(--xa-white)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]{margin-top:2.4rem;display:flex;flex-direction:column;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]{display:flex;gap:1.25rem;padding-left:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(rgba(26, 34, 51, .4));font-size:.75rem;font-style:normal;font-weight:600;line-height:.875rem;cursor:pointer}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{padding-right:calc(5px + 1.5vw);align-items:center;display:flex;gap:1rem;justify-content:flex-end}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}.repair-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .org-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5.58956rem;height:4.86131rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-direction:column}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:700}.repair-info[_ngcontent-%COMP%]   .repair-info-col-2[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-2[_ngcontent-%COMP%]   chq-input.invoice-date-input[_ngcontent-%COMP%]{width:20.28494rem}.invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem;margin-bottom:1.5rem}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0rem 0rem;border-bottom:1px solid var(rgba(26, 34, 51, .1));background:#f1f2f6}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:12px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;background:#f1f2f6;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f1f2f6;font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}@media screen and (max-width: 864px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:105px;padding-top:5px;padding-bottom:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex-wrap:wrap}}@media screen and (max-width: 672px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:200px;padding-top:5px;padding-bottom:5px}}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-red[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-green[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-yellow[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}  chq-input.outline div.input-wrapper:not(.text-mode) input, [_nghost-%COMP%]     .dropdown{outline:1px solid var(--xa-tab-background)}  chq-input.outline div.input-wrapper.text-mode .dropdown{outline:none}  chq-input.outline div.input-wrapper.text-mode input{border:0px!important}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:white;margin:30px;justify-content:center;min-height:calc(100vh - 385px - (53px + 3.1vw));border-radius:12px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:Inter;font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}.all-border[_ngcontent-%COMP%]{border-radius:.5rem!important}.invoice-detail[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:3.43rem;padding:10px;border-radius:.625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.0625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-weight:700}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:.8125rem;font-style:normal;font-weight:600}.invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.no-border[_ngcontent-%COMP%]{border:none!important}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-dp-light-gray)!important}.options-btn-container[_ngcontent-%COMP%]{position:relative}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]{position:absolute;bottom:45px;left:-5px;display:flex;align-items:stretch;padding:.625rem;flex-direction:column;gap:.625rem;border-radius:.625rem;background:#fff}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;border:none;box-shadow:none!important;justify-content:flex-start;padding:.425rem .75rem;font-size:1rem;font-weight:400;display:flex;gap:.5rem;cursor:pointer;-webkit-user-select:none;user-select:none}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.options-btn-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:1px solid var(--xa-light-gray)}.driver-field-content[_ngcontent-%COMP%]{display:none}@media print{.driver-field[_ngcontent-%COMP%]{display:none}  chq-input.outline div.input-wrapper .dropdown{outline:none}.driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;gap:10px;height:34px}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}}.text-check[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{display:none}.text-mode.driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.text-mode.driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;gap:10px;height:34px}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}.options-btn[_ngcontent-%COMP%]   .options-ico[_ngcontent-%COMP%]{font-size:.79638rem;width:.79638rem}.driver-fields-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{flex:1 1 120px;padding:0 10px;width:120px}@media (max-width: 850px){.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{padding:0 6px}}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.no-padding[_ngcontent-%COMP%]{padding:0}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.driver-code-field[_ngcontent-%COMP%]{min-width:120px;max-width:120px;padding:0 10px 0 0}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.basis-272[_ngcontent-%COMP%]{flex-basis:272px}"]}),a})();function Ho(a,c){if(1&a&&(e.TgZ(0,"h5"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,null==t?null:t.title))}}function di(a,c){if(1&a&&(e.TgZ(0,"tr",21)(1,"td",22)(2,"h6",15),e._uU(3),e.qZA()()()),2&a){const t=e.oxw().$implicit;e.xp6(3),e.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}const ze=function(a,c,t,n,r){return[a,c,t,n,r]};function ac(a,c){if(1&a&&(e.TgZ(0,"tbody"),e.YNc(1,di,4,1,"tr",20),e.TgZ(2,"tr")(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"xaCurrency"),e.qZA(),e.TgZ(8,"td",17),e._uU(9),e.ALo(10,"xaCurrency"),e.qZA()()()),2&a){const t=c.$implicit,n=c.index,r=e.oxw().$implicit,s=e.oxw(2).$implicit,d=e.oxw();e.xp6(1),e.Q6J("ngIf","Paint"===r.key.toString()&&(0===n||n>0&&t.serviceSubType!==s.invoiceList[r.key.toString()][n-1].serviceSubType)),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.hij(" ",e.G7q(7,4,e.qbA(16,ze,t.cost,d.i18n.currencySymbol,d.i18n.digitsInfo,d.i18n.locale,d.i18n.position))," "),e.xp6(3),e.hij(" ",e.G7q(10,10,e.qbA(22,ze,t.total,d.i18n.currencySymbol,d.i18n.digitsInfo,d.i18n.locale,d.i18n.position))," ")}}function Oa(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"subtotal")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,ze,t.partsSubTotal,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)))}}function sc(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"sundry_parts")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,ze,t.sundryParts,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)))}}function Nt(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"total_before_discount")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,ze,t.partsTotalBeforeDiscount,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)))}}function zo(a,c){if(1&a&&(e.TgZ(0,"div",26)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"discount_on_parts")),e.xp6(3),e.hij("",t.partsTotalDiscountPercentage,"%")}}function fn(a,c){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,Oa,7,16,"div",23),e.YNc(2,sc,7,16,"div",23),e.YNc(3,Nt,7,16,"div",23),e.YNc(4,zo,6,4,"div",24),e.qZA()),2&a){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showParts),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showParts),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showParts),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showParts)}}function dt(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"paint_labour_time")),e.xp6(3),e.hij("",t.paintLabourTimeHour,"hrs")}}function lc(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"paint_labour_subtotal")),e.xp6(3),e.hij(" ",e.G7q(6,4,e.qbA(10,ze,t.paintLabourSubTotal,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)),"")}}function ya(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"paint_labour_discount")),e.xp6(3),e.hij("",t.paintLabourDiscountPercentage,"%")}}function xa(a,c){if(1&a&&(e.TgZ(0,"div",29)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"labour_total")),e.xp6(3),e.hij(" ",e.G7q(6,4,e.qbA(10,ze,t.paintLabourTotal,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)),"")}}function ui(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"material_subtotal")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,ze,t.paintMaterialSubTotal,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)))}}function on(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"material_discount")),e.xp6(3),e.hij("",t.paintMateriaDiscountPercentage,"%")}}function wa(a,c){if(1&a&&(e.TgZ(0,"div",30)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"material_total")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,ze,t.paintMaterialTotal,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)))}}function cc(a,c){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,dt,6,4,"div",23),e.YNc(2,lc,7,16,"div",23),e.YNc(3,ya,6,4,"div",23),e.YNc(4,xa,7,16,"div",27),e.YNc(5,ui,7,16,"div",23),e.YNc(6,on,6,4,"div",23),e.YNc(7,wa,7,16,"div",28),e.qZA()),2&a){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint)}}function eo(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"labour_amount_subtotal")),e.xp6(3),e.hij(" ",e.G7q(6,4,e.qbA(10,ze,t.labourHourSubTotal,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)),"")}}function pc(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA()()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"labour_hours")),e.xp6(3),e.hij("",t.labourTimeHours," hrs")}}function Ta(a,c){if(1&a&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"number"),e.qZA()()),2&a){const t=e.oxw(4).$implicit,n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"labour_discount")),e.xp6(3),e.hij("",e.Dn7(6,4,t.labourTotalDiscountPercentage,n.digitInfo,n.locale),"%")}}function Fe(a,c){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,eo,7,16,"div",23),e.YNc(2,pc,6,4,"div",23),e.YNc(3,Ta,7,8,"div",23),e.qZA()),2&a){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showLabour),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showLabour),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showLabour)}}function Qo(a,c){if(1&a&&(e.TgZ(0,"div",13)(1,"span",14)(2,"h6",15),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.ynx(5),e.TgZ(6,"table",16)(7,"thead")(8,"tr")(9,"td"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"td",17),e._uU(16),e.ALo(17,"translate"),e.qZA()()(),e.YNc(18,ac,11,28,"tbody",18),e.ALo(19,"orderBy"),e.qZA(),e.YNc(20,fn,5,4,"div",8),e.YNc(21,cc,8,7,"div",8),e.YNc(22,Fe,4,3,"div",8),e.TgZ(23,"table",16)(24,"tfoot")(25,"tr")(26,"td"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"td",19),e._uU(30),e.ALo(31,"xaCurrency"),e.qZA()()()(),e.BQk(),e.qZA()),2&a){const t=c.$implicit,n=e.oxw(2).$implicit,r=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,12,t.key.toString().toLowerCase())),e.xp6(7),e.Oqu(e.lcZ(11,14,"description")),e.xp6(3),e.AsE("",e.lcZ(14,16,"price_unit"),"(",r.currencySymbol,")"),e.xp6(3),e.AsE("",e.lcZ(17,18,"total_price"),"(",r.currencySymbol,")"),e.xp6(2),e.Q6J("ngForOf",e.Dn7(19,20,n.invoiceList[t.key.toString()],"serviceSubtype","asc")),e.xp6(2),e.Q6J("ngIf","Part"===t.key.toString()),e.xp6(1),e.Q6J("ngIf","Paint"===t.key.toString()),e.xp6(1),e.Q6J("ngIf","Labour"===t.key.toString()),e.xp6(5),e.Oqu(e.lcZ(28,24,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),e.xp6(3),e.hij(" ",e.G7q(31,26,e.qbA(32,ze,"Paint"===t.key.toString()?n.paintLabourTotal+n.paintMaterialTotal:"Labour"===t.key.toString()?n.labourTotal:n.partsTotal,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," ")}}function Da(a,c){if(1&a&&(e.TgZ(0,"div",10),e.YNc(1,Qo,32,38,"div",11),e.ALo(2,"keyvalue"),e.TgZ(3,"div",12)(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"span"),e._uU(8),e.ALo(9,"xaCurrency"),e.qZA()()()),2&a){const t=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,3,t.invoiceList,n.valueAscOrder)),e.xp6(4),e.Oqu(e.lcZ(6,6,"total_cost")),e.xp6(3),e.Oqu(e.G7q(9,8,e.qbA(14,ze,t.paintLabourTotal+t.paintMaterialTotal+t.labourTotal+t.partsTotal,n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position)))}}const St=function(a){return{"full-flex":a}};function Vo(a,c){if(1&a&&(e.TgZ(0,"div",7),e.YNc(1,Ho,3,3,"h5",8),e.YNc(2,Da,10,20,"div",9),e.qZA()),2&a){const t=c.$implicit,n=e.oxw();e.Q6J("ngClass",e.VKq(3,St,1===(null==n.summaryDialogData.summaryData?null:n.summaryDialogData.summaryData.length))),e.xp6(1),e.Q6J("ngIf",null==t?null:t.title),e.xp6(1),e.Q6J("ngIf",null==t?null:t.title)}}let to=(()=>{class a{constructor(t,n,r){this.summaryDialogData=t,this.commonService=n,this.dialogRef=r,this.digitInfo="",this.locale="",this.currencySymbol="",this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}valueAscOrder(t,n){const r={part:"1",labour:"2",paint:"3"};return r[t.key?.toLowerCase()].localeCompare(r[n.key?.toLowerCase()])}onClose(){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(xe.WI),e.Y36(be.v),e.Y36(xe.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-invoice-summary"]],decls:10,vars:5,consts:[[1,"invoice-wrapper"],[1,"summary-container"],[1,"invoice-title"],[1,"close-icon"],[1,"cross",3,"svgIcon","click"],[1,"invoice-detail"],["class","invoice-col",3,"ngClass",4,"ngFor","ngForOf"],[1,"invoice-col",3,"ngClass"],[4,"ngIf"],["class","invoices-table-container",4,"ngIf"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],[1,"total-box"],[1,"table-parent"],[1,"expand-container"],[1,"small-heading"],["width","100%"],[1,"last-td"],[4,"ngFor","ngForOf"],["align","right"],["class","sub-heading",4,"ngIf"],[1,"sub-heading"],["colspan","5"],["class","invoice-row border-b",4,"ngIf"],["class","invoice-row",4,"ngIf"],[1,"invoice-row","border-b"],[1,"invoice-row"],["class","total-invoice-row no-border total-border",4,"ngIf"],["class","total-invoice-row no-border",4,"ngIf"],[1,"total-invoice-row","no-border","total-border"],[1,"total-invoice-row","no-border"]],template:function(t,n){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"h3"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",3)(7,"mat-icon",4),e.NdJ("click",function(){return n.onClose()}),e.qZA()()(),e.TgZ(8,"div",5),e.YNc(9,Vo,3,5,"div",6),e.qZA()()()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,3,"invoices_summary")),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(2),e.Q6J("ngForOf",n.summaryDialogData.summaryData))},dependencies:[f.mk,f.sg,f.O5,Le.Hw,f.JJ,f.Nd,Yo,Xi.j,pe.X$],styles:[".invoice-wrapper[_ngcontent-%COMP%]{min-height:100%;padding:1.88rem;background-color:#f1f2f6}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]{display:flex;gap:2.1rem;flex-direction:column;padding:.625rem}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;padding:.625rem;align-items:flex-start;border-radius:14.25rem;background:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f1f2f6;font-size:20px;width:20px;height:20px}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]{display:flex;padding:inherit;gap:10px;border-radius:.625rem;background:var(--xa-white);max-width:100%;overflow-x:auto}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0;flex-basis:50%}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:inherit;padding:10px}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:600}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:14px;line-height:16px;font-weight:500;color:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:14px;line-height:16px;font-weight:400;color:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:500}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:inherit;margin:0;font-size:.875rem;font-style:normal;font-weight:600}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-dp-light-gray)}.close-icon[_ngcontent-%COMP%]{border-radius:50%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:6px;background:var(--xa-black);width:36px;height:36px}.close-icon[_ngcontent-%COMP%]   .cross[_ngcontent-%COMP%]{height:24px!important;width:24px!important;cursor:pointer;fill:var(--xa-white)!important}.full-flex[_ngcontent-%COMP%]{flex-basis:100%!important}.invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem;margin-bottom:1.5rem}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0rem 0rem;border-bottom:1px solid var(rgba(26, 34, 51, .1))}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px!important;line-height:14px!important;font-style:normal;font-weight:500!important}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:16px!important;line-height:20px!important;font-weight:400!important;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500!important;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray);font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700!important;font-size:16px!important;border-bottom:4px solid var(--xa-white)}@media screen and (max-width: 864px){  .payer-radio-btn.outline div.input-wrapper .radio{flex-direction:column}}@media screen and (max-width: 864px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:105px;padding-top:5px;padding-bottom:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex-wrap:wrap}}@media screen and (max-width: 672px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:200px;padding-top:5px;padding-bottom:5px}}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-red[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-green[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-yellow[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}  chq-input.outline div.input-wrapper:not(.text-mode) input{outline:1px solid black}  chq-input.outline div.input-wrapper.text-mode input{border:0px!important}.small-heading[_ngcontent-%COMP%]{font-size:14px!important;line-height:16px!important;font-weight:500!important}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:white;margin:30px;justify-content:center;min-height:calc(100vh - 385px - (53px + 3.1vw));border-radius:12px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:Inter;font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}.all-border[_ngcontent-%COMP%]{border-radius:.5rem!important}.invoice-detail[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;padding:0;border-radius:.625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:500}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:.8125rem;font-style:normal;font-weight:600}.invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.no-border[_ngcontent-%COMP%]{border:none!important}.last-td[_ngcontent-%COMP%]{text-align:end}.sub-heading[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray)}.total-border[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black)!important;border-bottom:1px solid var(--xa-black)!important}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-lighter-gray)}.options-btn-container[_ngcontent-%COMP%]{position:relative}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]{position:absolute;bottom:45px;left:-5px;display:flex;align-items:stretch;padding:.625rem;flex-direction:column;gap:.625rem;border-radius:.625rem;background:#fff}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;border:none;box-shadow:none!important;justify-content:flex-start;padding:.425rem .75rem;font-size:1rem;font-weight:400;display:flex;gap:.5rem;cursor:pointer;-webkit-user-select:none;user-select:none}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.options-btn-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:1px solid var(--xa-light-gray)}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}"]}),a})();var _n=k(84080),Je=k(54968),Qe=k(54482),jo=k(72733),uc=k(22529),hc=k(28746),Ko=k(71345);const mc=new e.OlP("SMOOTH_SCROLL_OPTIONS");let hi=(()=>{class a{get _w(){return this._document.defaultView}get _now(){return this._w.performance&&this._w.performance.now?this._w.performance.now.bind(this._w.performance):Date.now}constructor(t,n,r){this._document=t,this._platform=n,this._onGoingScrolls=new Map,this._defaultOptions={duration:468,easing:{x1:.42,y1:0,x2:.58,y2:1},...r}}_scrollElement(t,n,r){t.scrollLeft=n,t.scrollTop=r}_getElement(t,n){return"string"==typeof t?(n||this._document).querySelector(t):(0,j.fI)(t)}_initSmoothScroll(t){return this._onGoingScrolls.has(t)&&this._onGoingScrolls.get(t).next(),this._onGoingScrolls.set(t,new ne.x).get(t)}_isFinished(t,n,r){return t.currentX!==t.x||t.currentY!==t.y||(n.next(),r(),!1)}_interrupted(t,n){return(0,W.T)((0,Je.R)(t,"wheel",{passive:!0,capture:!0}),(0,Je.R)(t,"touchmove",{passive:!0,capture:!0}),n).pipe((0,at.q)(1))}_destroy(t,n){n.complete(),this._onGoingScrolls.delete(t)}_step(t){return new Xe.y(n=>{let r=(this._now()-t.startTime)/t.duration;r=r>1?1:r;const s=t.easing(r);t.currentX=t.startX+(t.x-t.startX)*s,t.currentY=t.startY+(t.y-t.startY)*s,this._scrollElement(t.scrollable,t.currentX,t.currentY),On.Z.schedule(()=>n.next(t))})}_applyScrollToOptions(t,n){if(!n.duration)return this._scrollElement(t,n.left,n.top),Promise.resolve();const r=this._initSmoothScroll(t),s={scrollable:t,startTime:this._now(),startX:t.scrollLeft,startY:t.scrollTop,x:null==n.left?t.scrollLeft:~~n.left,y:null==n.top?t.scrollTop:~~n.top,duration:n.duration,easing:Ko(n.easing.x1,n.easing.y1,n.easing.x2,n.easing.y2)};return new Promise(d=>{(0,ct.of)(null).pipe(function dc(a,c=1/0,t){return c=(c||0)<1?1/0:c,(0,Qe.e)((n,r)=>(0,jo.p)(n,r,a,c,void 0,!0,t))}(()=>this._step(s).pipe((0,uc.o)(u=>this._isFinished(u,r,d)))),(0,J.R)(this._interrupted(t,r)),(0,hc.x)(()=>this._destroy(t,r))).subscribe()})}scrollTo(t,n){if((0,f.NF)(this._platform)){const r=this._getElement(t),s="rtl"===getComputedStyle(r).direction,d=(0,he._i)(),u={...this._defaultOptions,...n,left:null==n.left?s?n.end:n.start:n.left,right:null==n.right?s?n.start:n.end:n.right};return null!=u.bottom&&(u.top=r.scrollHeight-r.clientHeight-u.bottom),s&&0!==d?(null!=u.left&&(u.right=r.scrollWidth-r.clientWidth-u.left),2===d?u.left=u.right:1===d&&(u.left=u.right?-u.right:u.right)):null!=u.right&&(u.left=r.scrollWidth-r.clientWidth-u.right),this._applyScrollToOptions(r,u)}return Promise.resolve()}scrollToElement(t,n,r={}){const s=this._getElement(t),d=this._getElement(n,s),u={...r,left:d.offsetLeft+(r.left||0),top:d.offsetTop+(r.top||0)};return d?this.scrollTo(s,u):Promise.resolve()}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(f.K0),e.LFG(e.Lbi),e.LFG(mc,8))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),fc=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({}),a})();var _c=k(60515),Jn=k(78372),Wo=k(71884);function no(...a){const c=a.length;if(0===c)throw new Error("list of properties cannot be empty.");return(0,te.U)(t=>{let n=t;for(let r=0;r<c;r++){const s=n?.[a[r]];if(!(typeof s<"u"))return;n=s}return n})}var $o=k(86099),Sa=k(11520),vc=k(39300),bc=k(23601);const Cc=["scrollbarY"],Ia=["scrollbarX"];function Xo(a,c){if(1&a&&e._UZ(0,"scrollbar-x",null,4),2&a){const t=e.oxw(2);e.uIk("scrollable",t.state.isHorizontallyScrollable)("fit",t.state.verticalUsed)}}function Mc(a,c){if(1&a&&e._UZ(0,"scrollbar-y",null,5),2&a){const t=e.oxw(2);e.uIk("scrollable",t.state.isVerticallyScrollable)("fit",t.state.horizontalUsed)}}function er(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Xo,2,2,"scrollbar-x",3),e.YNc(2,Mc,2,2,"scrollbar-y",3),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.state.horizontalUsed),e.xp6(1),e.Q6J("ngIf",t.state.verticalUsed)}}const ka=["*"];function tr(a){return(0,H.b)(()=>{a.onselectstart=()=>!1})}function nr(a){return(0,H.b)(()=>{a.onselectstart=null})}function Ot(){return(0,H.b)(a=>a.stopPropagation())}function ir(a,c){return a.clientX>=c.left&&a.clientX<=c.left+c.width&&a.clientY>=c.top&&a.clientY<=c.top+c.height}let io=(()=>{class a{get clientHeight(){return this.nativeElement.clientHeight}get clientWidth(){return this.nativeElement.clientWidth}get scrollHeight(){return this.nativeElement.scrollHeight}get scrollWidth(){return this.nativeElement.scrollWidth}get scrollTop(){return this.nativeElement.scrollTop}get scrollLeft(){return this.nativeElement.scrollLeft}get scrollMaxX(){return this.scrollWidth-this.clientWidth}get scrollMaxY(){return this.scrollHeight-this.clientHeight}get contentHeight(){return this.contentWrapperElement?.clientHeight||0}get contentWidth(){return this.contentWrapperElement?.clientWidth||0}constructor(t){this.viewPort=t,this.nativeElement=t.nativeElement}activatePointerEvents(t,n){this.hovered=new Xe.y(r=>{const s=(0,Je.R)(this.nativeElement,"mousemove",{passive:!0}),d=t?s:s.pipe(Ot()),u=(0,Je.R)(this.nativeElement,"mouseleave",{passive:!0}).pipe((0,te.U)(()=>!1));(0,W.T)(d,u).pipe((0,H.b)(v=>r.next(v)),(0,J.R)(n)).subscribe()}),this.clicked=new Xe.y(r=>{const s=(0,Je.R)(this.nativeElement,"mousedown",{passive:!0}).pipe((0,H.b)(u=>r.next(u))),d=(0,Je.R)(this.nativeElement,"mouseup",{passive:!0}).pipe((0,H.b)(()=>r.next(!1)));s.pipe((0,ge.w)(()=>d),(0,J.R)(n)).subscribe()})}setAsWrapper(){this.nativeElement.className="ng-native-scrollbar-hider ng-scroll-layer",this.nativeElement.firstElementChild&&(this.nativeElement.firstElementChild.className="ng-scroll-layer")}setAsViewport(t){this.nativeElement.className=`ng-native-scrollbar-hider ng-scroll-viewport ${t}`,this.nativeElement.firstElementChild&&(this.contentWrapperElement=this.nativeElement.firstElementChild,this.contentWrapperElement.classList.add("ng-scroll-content"))}scrollYTo(t){this.nativeElement.scrollTop=t}scrollXTo(t){this.nativeElement.scrollLeft=t}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollViewport",""]]}),a})(),ut=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275dir=e.lG2({type:a}),a})();const Aa=new e.OlP("NG_SCROLLBAR_OPTIONS"),or={viewClass:"",trackClass:"",thumbClass:"",track:"vertical",appearance:"compact",visibility:"native",position:"native",pointerEventsMethod:"viewport",trackClickScrollDuration:300,minThumbSize:20,windowResizeDebounce:0,sensorDebounce:0,scrollAuditTime:0,viewportPropagateMouseMove:!0,autoHeightDisabled:!0,autoWidthDisabled:!0,sensorDisabled:!1,pointerEventsDisabled:!1};let Ra=(()=>{class a{constructor(t){this.globalOptions=t?{...or,...t}:or,this.rtlScrollAxisType=(0,he._i)()}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(Aa,8))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),rr=(()=>{class a{constructor(t,n,r){this.document=t,this.manager=n,this.platform=r,this._scrollbarSize=new Ct.X(this.getNativeScrollbarSize()),this.scrollbarSize=this._scrollbarSize.asObservable(),r.isBrowser&&(0,Je.R)(this.document.defaultView,"resize",{passive:!0}).pipe((0,Jn.b)(this.manager.globalOptions.windowResizeDebounce),(0,te.U)(()=>this.getNativeScrollbarSize()),(0,Wo.x)(),(0,H.b)(s=>this._scrollbarSize.next(s))).subscribe()}getNativeScrollbarSize(){if(!this.platform.isBrowser)return 0;if(this.platform.IOS)return 6;const t=this.document.createElement("div");t.className="ng-scrollbar-measure",t.style.left="0px",t.style.overflow="scroll",t.style.position="fixed",t.style.top="-9999px",this.document.body.appendChild(t);const n=t.getBoundingClientRect().right;return this.document.body.removeChild(t),n}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(f.K0),e.LFG(Ra),e.LFG(he.t4))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),La=(()=>{class a{constructor(t,n,r){this.renderer=n,this.hideNativeScrollbar=r,this._subscriber=_t.w0.EMPTY,this._subscriber=r.scrollbarSize.subscribe(s=>{this.renderer.setStyle(t.nativeElement,"--native-scrollbar-size",`-${s}px`,e.JOm.DashCase)})}ngOnDestroy(){this._subscriber.unsubscribe()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(rr))},a.\u0275dir=e.lG2({type:a,selectors:[["","hideNativeScrollbar",""]]}),a})(),ar=(()=>{class a{constructor(t){this.el=t}set ngAttr(t){for(const[n,r]of Object.entries(t))this.el.nativeElement.setAttribute(n,r)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq))},a.\u0275dir=e.lG2({type:a,selectors:[["","ngAttr",""]],inputs:{ngAttr:"ngAttr"}}),a})(),Pc=(()=>{class a{get debounce(){return this._debounce}set debounce(t){this._debounce=(0,j.su)(t),this._subscribe()}get disabled(){return this._disabled}set disabled(t){this._disabled=(0,j.Ig)(t),this._disabled?this._unsubscribe():this._subscribe()}constructor(t,n,r){if(this.zone=t,this.platform=n,this.scrollbar=r,this._disabled=!1,this._currentSubscription=null,this.event=new e.vpe,!r)throw new Error("[NgScrollbar Resize Sensor Directive]: Host element must be an NgScrollbar component.")}ngAfterContentInit(){!this._currentSubscription&&!this._disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){if(this._unsubscribe(),this.platform.isBrowser){const t=new Xe.y(n=>{this._resizeObserver=new ResizeObserver(r=>n.next(r)),this._resizeObserver.observe(this.scrollbar.viewport.nativeElement),this.scrollbar.viewport.contentWrapperElement&&this._resizeObserver.observe(this.scrollbar.viewport.contentWrapperElement)});this.zone.runOutsideAngular(()=>{this._currentSubscription=(this._debounce?t.pipe((0,Jn.b)(this._debounce)):t).subscribe(this.event)})}}_unsubscribe(){this._resizeObserver?.disconnect(),this._currentSubscription?.unsubscribe()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.R0b),e.Y36(he.t4),e.Y36(ut))},a.\u0275dir=e.lG2({type:a,selectors:[["","resizeSensor",""]],inputs:{debounce:["sensorDebounce","debounce"],disabled:["sensorDisabled","disabled"]},outputs:{event:"resizeSensor"}}),a})(),mi=(()=>{class a{get clicked(){const t=(0,Je.R)(this.trackElement,"mousedown",{passive:!0}).pipe(Ot(),tr(this.document)),n=(0,Je.R)(this.document,"mouseup",{passive:!0}).pipe(Ot(),nr(this.document),(0,ge.w)(()=>_c.E));return(0,W.T)(t,n)}get clientRect(){return this.trackElement.getBoundingClientRect()}constructor(t,n,r){this.cmp=t,this.trackElement=n,this.document=r}onTrackClicked(t,n,r){return(0,ct.of)(t).pipe(no(this.pageProperty),(0,te.U)(s=>(s-this.offset-n/2)/this.size*r),(0,H.b)(s=>{this.cmp.scrollTo({...this.mapToScrollToOption(s),duration:(0,j.su)(this.cmp.trackClickScrollDuration)})}))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ut),e.Y36(HTMLElement),e.Y36(Document))},a.\u0275dir=e.lG2({type:a}),a})(),B=(()=>{class a extends mi{get pageProperty(){return"pageX"}get offset(){return this.clientRect.left}get size(){return this.trackElement.clientWidth}constructor(t,n,r){super(t,n.nativeElement,r),this.cmp=t,this.document=r}mapToScrollToOption(t){return{left:t}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ut),e.Y36(e.SBq),e.Y36(f.K0))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollbarTrackX",""]],features:[e.qOj]}),a})(),sr=(()=>{class a extends mi{get pageProperty(){return"pageY"}get offset(){return this.clientRect.top}get size(){return this.trackElement.clientHeight}constructor(t,n,r){super(t,n.nativeElement,r),this.cmp=t,this.document=r}mapToScrollToOption(t){return{top:t}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ut),e.Y36(e.SBq),e.Y36(f.K0))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollbarTrackY",""]],features:[e.qOj]}),a})(),Ea=(()=>{class a{get trackMax(){return this.track.size-this.size}get clientRect(){return this.thumbElement.getBoundingClientRect()}get clicked(){return(0,Je.R)(this.thumbElement,"mousedown",{passive:!0}).pipe(Ot())}constructor(t,n,r,s){this.cmp=t,this.track=n,this.thumbElement=r,this.document=s,this._dragging=new ne.x,this.dragging=this._dragging.pipe((0,Wo.x)())}update(){const t=function gi(a,c,t){return Math.max(~~(a/c*a),t)}(this.track.size,this.viewportScrollSize,this.cmp.minThumbSize),n=function qa(a,c,t){return a*t/c}(this.viewportScrollOffset,this.viewportScrollMax,this.trackMax);On.Z.schedule(()=>this.updateStyles(this.handleDirection(n,this.trackMax),t))}dragged(t){let n,r;const s=(0,ct.of)(t).pipe(tr(this.document),(0,H.b)(()=>{n=this.trackMax,r=this.viewportScrollMax,this.setDragging(!0)})),d=(0,Je.R)(this.document,"mousemove",{capture:!0,passive:!0}).pipe(Ot()),u=(0,Je.R)(this.document,"mouseup",{capture:!0}).pipe(Ot(),nr(this.document),(0,H.b)(()=>this.setDragging(!1)));return s.pipe(no(this.pageProperty),(0,te.U)(v=>v-this.dragStartOffset),(0,$o.z)(v=>d.pipe(no(this.clientProperty),(0,te.U)(P=>P-this.track.offset),(0,te.U)(P=>r*(P-v)/n),(0,te.U)(P=>this.handleDrag(P,r)),(0,H.b)(P=>this.scrollTo(P)),(0,J.R)(u))))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ut),e.Y36(mi),e.Y36(HTMLElement),e.Y36(Document))},a.\u0275dir=e.lG2({type:a,outputs:{dragging:"dragging"}}),a})(),Za=(()=>{class a extends Ea{get clientProperty(){return"clientX"}get pageProperty(){return"pageX"}get viewportScrollSize(){return this.cmp.viewport.scrollWidth}get viewportScrollOffset(){return this.cmp.viewport.scrollLeft}get viewportScrollMax(){return this.cmp.viewport.scrollMaxX}get dragStartOffset(){return this.clientRect.left+this.document.defaultView.pageXOffset||0}get size(){return this.thumbElement.clientWidth}constructor(t,n,r,s,d){super(t,n,r.nativeElement,s),this.cmp=t,this.track=n,this.element=r,this.document=s,this.dir=d}updateStyles(t,n){this.thumbElement.style.width=`${n}px`,this.thumbElement.style.transform=`translate3d(${t}px, 0, 0)`}handleDrag(t,n){if("rtl"===this.dir.value){if(1===this.cmp.manager.rtlScrollAxisType)return t-n;if(2===this.cmp.manager.rtlScrollAxisType)return n-t}return t}handleDirection(t,n){if("rtl"===this.dir.value){if(2===this.cmp.manager.rtlScrollAxisType)return-t;if(0===this.cmp.manager.rtlScrollAxisType)return t-n}return t}setDragging(t){this.cmp.setDragging({horizontalDragging:t})}scrollTo(t){this.cmp.viewport.scrollXTo(t)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ut),e.Y36(B),e.Y36(e.SBq),e.Y36(f.K0),e.Y36(ke.Is))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollbarThumbX",""]],features:[e.qOj]}),a})(),Fa=(()=>{class a extends Ea{get pageProperty(){return"pageY"}get viewportScrollSize(){return this.cmp.viewport.scrollHeight}get viewportScrollOffset(){return this.cmp.viewport.scrollTop}get viewportScrollMax(){return this.cmp.viewport.scrollMaxY}get clientProperty(){return"clientY"}get dragStartOffset(){return this.clientRect.top+this.document.defaultView.pageYOffset||0}get size(){return this.thumbElement.clientHeight}constructor(t,n,r,s){super(t,n,r.nativeElement,s),this.cmp=t,this.track=n,this.element=r,this.document=s}updateStyles(t,n){this.thumbElement.style.height=`${n}px`,this.thumbElement.style.transform=`translate3d(0px, ${t}px, 0)`}handleDrag(t){return t}handleDirection(t){return t}setDragging(t){this.cmp.setDragging({verticalDragging:t})}scrollTo(t){this.cmp.viewport.scrollYTo(t)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(ut),e.Y36(sr),e.Y36(e.SBq),e.Y36(f.K0))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollbarThumbY",""]],features:[e.qOj]}),a})(),it=(()=>{class a{constructor(t,n,r,s,d){this.el=t,this.cmp=n,this.platform=r,this.document=s,this.zone=d,this.destroyed=new ne.x}activatePointerEvents(){let t,n,r;return"viewport"===this.cmp.pointerEventsMethod?(this.viewportTrackClicked=new ne.x,this.viewportThumbClicked=new ne.x,this.cmp.viewport.activatePointerEvents(this.cmp.viewportPropagateMouseMove,this.destroyed),t=this.viewportThumbClicked,n=this.viewportTrackClicked,r=this.cmp.viewport.hovered.pipe((0,te.U)(s=>!!s&&ir(s,this.el.getBoundingClientRect())),(0,Wo.x)(),(0,H.b)(s=>this.document.onselectstart=s?()=>!1:null)),this.cmp.viewport.clicked.pipe((0,H.b)(s=>{s?ir(s,this.thumb.clientRect)?this.viewportThumbClicked.next(s):ir(s,this.track.clientRect)&&(this.cmp.setClicked(!0),this.viewportTrackClicked.next(s)):this.cmp.setClicked(!1)}),(0,J.R)(this.destroyed)).subscribe()):(t=this.thumb.clicked,n=this.track.clicked,r=this.hovered),(0,W.T)(r.pipe((0,H.b)(s=>this.setHovered(s))),t.pipe((0,ge.w)(s=>this.thumb.dragged(s))),n.pipe((0,ge.w)(s=>this.track.onTrackClicked(s,this.thumb.size,this.viewportScrollSize))))}get hovered(){const t=(0,Je.R)(this.el,"mouseenter",{passive:!0}).pipe(Ot(),(0,te.U)(()=>!0)),n=(0,Je.R)(this.el,"mouseleave",{passive:!0}).pipe(Ot(),(0,te.U)(()=>!1));return(0,W.T)(t,n)}ngOnInit(){this.zone.runOutsideAngular(()=>{!(this.platform.IOS||this.platform.ANDROID)&&!this.cmp.pointerEventsDisabled&&this.activatePointerEvents().pipe((0,J.R)(this.destroyed)).subscribe(),(0,W.T)(this.cmp.scrolled,this.cmp.updated).pipe((0,H.b)(()=>this.thumb?.update()),(0,J.R)(this.destroyed)).subscribe()})}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete(),this.viewportThumbClicked&&this.viewportTrackClicked&&(this.viewportTrackClicked.complete(),this.viewportThumbClicked.complete())}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(HTMLElement),e.Y36(ut),e.Y36(he.t4),e.Y36(Document),e.Y36(e.R0b))},a.\u0275dir=e.lG2({type:a}),a})(),Oc=(()=>{class a extends it{get viewportScrollSize(){return this.cmp.viewport.scrollHeight}constructor(t,n,r,s,d){super(t.nativeElement,n,r,s,d),this.cmp=n,this.platform=r,this.document=s,this.zone=d}setHovered(t){this.cmp.setHovered({verticalHovered:t})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(ut),e.Y36(he.t4),e.Y36(f.K0),e.Y36(e.R0b))},a.\u0275cmp=e.Xpm({type:a,selectors:[["scrollbar-y"]],viewQuery:function(t,n){if(1&t&&(e.Gf(sr,7),e.Gf(Fa,7)),2&t){let r;e.iGM(r=e.CRH())&&(n.track=r.first),e.iGM(r=e.CRH())&&(n.thumb=r.first)}},hostVars:2,hostBindings:function(t,n){2&t&&e.ekj("scrollbar-control",!0)},features:[e.qOj],decls:2,vars:6,consts:[["scrollbarTrackY",""],["scrollbarThumbY",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.qZA()),2&t&&(e.Gre("ng-scrollbar-track ",n.cmp.trackClass,""),e.xp6(1),e.Gre("ng-scrollbar-thumb ",n.cmp.thumbClass,""))},dependencies:[Fa,sr],styles:[".ng-scrollbar-wrapper>scrollbar-y.scrollbar-control{width:var(--vertical-scrollbar-total-size)}  .ng-scrollbar-wrapper>scrollbar-y.scrollbar-control>.ng-scrollbar-track{width:var(--vertical-scrollbar-size);height:calc(100% - var(--scrollbar-padding) * 2)}  .ng-scrollbar-wrapper>scrollbar-y.scrollbar-control>.ng-scrollbar-track>.ng-scrollbar-thumb{height:0;width:100%}  .ng-scrollbar-wrapper[verticalHovered=true]>scrollbar-y.scrollbar-control .ng-scrollbar-thumb,   .ng-scrollbar-wrapper[verticalDragging=true]>scrollbar-y.scrollbar-control .ng-scrollbar-thumb{background-color:var(--scrollbar-thumb-hover-color)}  .ng-scrollbar-wrapper[deactivated=false]>scrollbar-y.scrollbar-control{top:0;bottom:0}  .ng-scrollbar-wrapper[deactivated=false][dir=ltr]>scrollbar-y.scrollbar-control{right:0;left:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=ltr][position=invertY]>scrollbar-y.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][dir=ltr][position=invertAll]>scrollbar-y.scrollbar-control{left:0;right:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=rtl]>scrollbar-y.scrollbar-control{left:0;right:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=rtl][position=invertY]>scrollbar-y.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][dir=rtl][position=invertAll]>scrollbar-y.scrollbar-control{left:unset;right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all]>scrollbar-y.scrollbar-control[fit=true]{bottom:var(--scrollbar-total-size);top:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][position=invertX]>scrollbar-y.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][position=invertAll]>scrollbar-y.scrollbar-control[fit=true]{top:var(--scrollbar-total-size);bottom:0}"],changeDetection:0}),a})(),oo=(()=>{class a extends it{get viewportScrollSize(){return this.cmp.viewport.scrollWidth}constructor(t,n,r,s,d){super(t.nativeElement,n,r,s,d),this.cmp=n,this.platform=r,this.document=s,this.zone=d}setHovered(t){this.cmp.setHovered({horizontalHovered:t})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(ut),e.Y36(he.t4),e.Y36(f.K0),e.Y36(e.R0b))},a.\u0275cmp=e.Xpm({type:a,selectors:[["scrollbar-x"]],viewQuery:function(t,n){if(1&t&&(e.Gf(B,7),e.Gf(Za,7)),2&t){let r;e.iGM(r=e.CRH())&&(n.track=r.first),e.iGM(r=e.CRH())&&(n.thumb=r.first)}},hostVars:2,hostBindings:function(t,n){2&t&&e.ekj("scrollbar-control",!0)},features:[e.qOj],decls:2,vars:6,consts:[["scrollbarTrackX",""],["scrollbarThumbX",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.qZA()),2&t&&(e.Gre("ng-scrollbar-track ",n.cmp.trackClass,""),e.xp6(1),e.Gre("ng-scrollbar-thumb ",n.cmp.thumbClass,""))},dependencies:[Za,B],styles:[".ng-scrollbar-wrapper>scrollbar-x.scrollbar-control{height:var(--horizontal-scrollbar-total-size)}  .ng-scrollbar-wrapper>scrollbar-x.scrollbar-control>.ng-scrollbar-track{height:var(--horizontal-scrollbar-size);width:calc(100% - var(--scrollbar-padding) * 2)}  .ng-scrollbar-wrapper>scrollbar-x.scrollbar-control>.ng-scrollbar-track>.ng-scrollbar-thumb{width:0;height:100%}  .ng-scrollbar-wrapper[horizontalHovered=true]>scrollbar-x.scrollbar-control .ng-scrollbar-thumb,   .ng-scrollbar-wrapper[horizontalDragging=true]>scrollbar-x.scrollbar-control .ng-scrollbar-thumb{background-color:var(--scrollbar-thumb-hover-color)}  .ng-scrollbar-wrapper[position=invertX]>scrollbar-x.scrollbar-control,   .ng-scrollbar-wrapper[position=invertAll]>scrollbar-x.scrollbar-control{top:0;bottom:unset}  .ng-scrollbar-wrapper[deactivated=false]>scrollbar-x.scrollbar-control{left:0;right:0;bottom:0;top:unset}  .ng-scrollbar-wrapper[deactivated=false][position=invertX]>scrollbar-x.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][position=invertAll]>scrollbar-x.scrollbar-control{top:0;bottom:unset}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr]>scrollbar-x.scrollbar-control[fit=true]{right:var(--scrollbar-total-size);left:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr][position=invertY]>scrollbar-x.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr][position=invertAll]>scrollbar-x.scrollbar-control[fit=true]{left:var(--scrollbar-total-size);right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl]>scrollbar-x.scrollbar-control[fit=true]{left:var(--scrollbar-total-size);right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl][position=invertY]>scrollbar-x.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl][position=invertAll]>scrollbar-x.scrollbar-control[fit=true]{right:var(--scrollbar-total-size);left:0}"],changeDetection:0}),a})(),lr=(()=>{class a{get disabled(){return this._disabled}set disabled(t){this._disabled=(0,j.Ig)(t)}get sensorDisabled(){return this._sensorDisabled}set sensorDisabled(t){this._sensorDisabled=(0,j.Ig)(t)}get pointerEventsDisabled(){return this._pointerEventsDisabled}set pointerEventsDisabled(t){this._pointerEventsDisabled=(0,j.Ig)(t)}get viewportPropagateMouseMove(){return this._viewportPropagateMouseMove}set viewportPropagateMouseMove(t){this._viewportPropagateMouseMove=(0,j.Ig)(t)}get autoHeightDisabled(){return this._autoHeightDisabled}set autoHeightDisabled(t){this._autoHeightDisabled=(0,j.Ig)(t)}get autoWidthDisabled(){return this._autoWidthDisabled}set autoWidthDisabled(t){this._autoWidthDisabled=(0,j.Ig)(t)}get nativeElement(){return this.el.nativeElement}constructor(t,n,r,s,d,u){this.el=t,this.zone=n,this.changeDetectorRef=r,this.dir=s,this.smoothScroll=d,this.manager=u,this._disabled=!1,this._sensorDisabled=this.manager.globalOptions.sensorDisabled,this._pointerEventsDisabled=this.manager.globalOptions.pointerEventsDisabled,this._autoHeightDisabled=this.manager.globalOptions.autoHeightDisabled,this._autoWidthDisabled=this.manager.globalOptions.autoWidthDisabled,this._viewportPropagateMouseMove=this.manager.globalOptions.viewportPropagateMouseMove,this.viewClass=this.manager.globalOptions.viewClass,this.trackClass=this.manager.globalOptions.trackClass,this.thumbClass=this.manager.globalOptions.thumbClass,this.minThumbSize=this.manager.globalOptions.minThumbSize,this.trackClickScrollDuration=this.manager.globalOptions.trackClickScrollDuration,this.pointerEventsMethod=this.manager.globalOptions.pointerEventsMethod,this.track=this.manager.globalOptions.track,this.visibility=this.manager.globalOptions.visibility,this.appearance=this.manager.globalOptions.appearance,this.position=this.manager.globalOptions.position,this.sensorDebounce=this.manager.globalOptions.sensorDebounce,this.scrollAuditTime=this.manager.globalOptions.scrollAuditTime,this.updated=new e.vpe,this.state={},this.destroyed=new ne.x}updateState(){let t=!1,n=!1,r=!1,s=!1;("all"===this.track||"vertical"===this.track)&&(r=this.viewport.scrollHeight>this.viewport.clientHeight,t="always"===this.visibility||r),("all"===this.track||"horizontal"===this.track)&&(s=this.viewport.scrollWidth>this.viewport.clientWidth,n="always"===this.visibility||s),this.setState({position:this.position,track:this.track,appearance:this.appearance,visibility:this.visibility,deactivated:this.disabled,dir:this.dir.value,pointerEventsMethod:this.pointerEventsMethod,verticalUsed:t,horizontalUsed:n,isVerticallyScrollable:r,isHorizontallyScrollable:s})}setState(t){this.state={...this.state,...t},this.changeDetectorRef.detectChanges()}getScrolledByDirection(t){let n;return this.scrolled.pipe((0,H.b)(r=>n=r),no("target",t),(0,Sa.G)(),(0,vc.h)(([r,s])=>r!==s),(0,te.U)(()=>n))}setHovered(t){this.zone.run(()=>this.setState({...t}))}setDragging(t){this.zone.run(()=>this.setState({...t}))}setClicked(t){this.zone.run(()=>this.setState({scrollbarClicked:t}))}ngOnInit(){this.zone.runOutsideAngular(()=>{this.customViewPort?(this.viewport=this.customViewPort,this.defaultViewPort.setAsWrapper()):this.viewport=this.defaultViewPort,this.viewport.setAsViewport(this.viewClass);let t=(0,Je.R)(this.viewport.nativeElement,"scroll",{passive:!0});t=this.scrollAuditTime?t.pipe((0,bc.e)(this.scrollAuditTime)):t,this.scrolled=t.pipe((0,J.R)(this.destroyed)),this.verticalScrolled=this.getScrolledByDirection("scrollTop"),this.horizontalScrolled=this.getScrolledByDirection("scrollLeft")})}ngOnChanges(t){this.viewport&&this.update()}ngAfterViewInit(){this.update(),this.dir.change.pipe((0,H.b)(()=>this.update()),(0,J.R)(this.destroyed)).subscribe()}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}update(){this.autoHeightDisabled||this.updateHeight(),this.autoWidthDisabled||this.updateWidth(),this.updateState(),this.updated.next()}scrollTo(t){return this.smoothScroll.scrollTo(this.viewport.nativeElement,t)}scrollToElement(t,n){return this.smoothScroll.scrollToElement(this.viewport.nativeElement,t,n)}updateHeight(){this.nativeElement.style.height="standard"===this.appearance&&this.scrollbarX?`${this.viewport.contentHeight+this.scrollbarX.nativeElement.clientHeight}px`:`${this.viewport.contentHeight}px`}updateWidth(){this.nativeElement.style.width="standard"===this.appearance&&this.scrollbarY?`${this.viewport.contentWidth+this.scrollbarY.nativeElement.clientWidth}px`:`${this.viewport.contentWidth}px`}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(e.R0b),e.Y36(e.sBO),e.Y36(ke.Is),e.Y36(hi),e.Y36(Ra))},a.\u0275cmp=e.Xpm({type:a,selectors:[["ng-scrollbar"]],contentQueries:function(t,n,r){if(1&t&&e.Suo(r,io,7),2&t){let s;e.iGM(s=e.CRH())&&(n.customViewPort=s.first)}},viewQuery:function(t,n){if(1&t&&(e.Gf(Cc,5,e.SBq),e.Gf(Ia,5,e.SBq),e.Gf(io,7)),2&t){let r;e.iGM(r=e.CRH())&&(n.scrollbarY=r.first),e.iGM(r=e.CRH())&&(n.scrollbarX=r.first),e.iGM(r=e.CRH())&&(n.defaultViewPort=r.first)}},hostVars:2,hostBindings:function(t,n){2&t&&e.ekj("ng-scrollbar",!0)},inputs:{disabled:"disabled",sensorDisabled:"sensorDisabled",pointerEventsDisabled:"pointerEventsDisabled",viewportPropagateMouseMove:"viewportPropagateMouseMove",autoHeightDisabled:"autoHeightDisabled",autoWidthDisabled:"autoWidthDisabled",viewClass:"viewClass",trackClass:"trackClass",thumbClass:"thumbClass",minThumbSize:"minThumbSize",trackClickScrollDuration:"trackClickScrollDuration",pointerEventsMethod:"pointerEventsMethod",track:"track",visibility:"visibility",appearance:"appearance",position:"position",sensorDebounce:"sensorDebounce",scrollAuditTime:"scrollAuditTime"},outputs:{updated:"updated"},exportAs:["ngScrollbar"],features:[e._Bn([{provide:ut,useExisting:a}]),e.TTD],ngContentSelectors:ka,decls:6,vars:4,consts:[[1,"ng-scrollbar-wrapper",3,"ngAttr"],[1,"ng-scroll-viewport-wrapper",3,"sensorDebounce","sensorDisabled","resizeSensor"],["scrollViewport","","hideNativeScrollbar",""],[4,"ngIf"],["scrollbarX",""],["scrollbarY",""]],template:function(t,n){1&t&&(e.F$t(),e.TgZ(0,"div",0)(1,"div",1),e.NdJ("resizeSensor",function(){return n.update()}),e.TgZ(2,"div",2)(3,"div"),e.Hsn(4),e.qZA()()(),e.YNc(5,er,3,2,"ng-container",3),e.qZA()),2&t&&(e.Q6J("ngAttr",n.state),e.xp6(1),e.Q6J("sensorDebounce",n.sensorDebounce)("sensorDisabled",n.sensorDisabled),e.xp6(4),e.Q6J("ngIf",!n.disabled))},dependencies:[f.O5,io,La,ar,Pc,Oc,oo],styles:[".ng-scrollbar-measure{scrollbar-width:none;-ms-overflow-style:none}  .ng-scrollbar-measure::-webkit-scrollbar{display:none}[_nghost-%COMP%]{--scrollbar-border-radius: 7px;--scrollbar-padding: 4px;--scrollbar-track-color: transparent;--scrollbar-thumb-color: rgba(0, 0, 0, .2);--scrollbar-thumb-hover-color: var(--scrollbar-thumb-color);--scrollbar-size: 5px;--scrollbar-hover-size: var(--scrollbar-size);--scrollbar-overscroll-behavior: initial;--scrollbar-transition-duration: .4s;--scrollbar-transition-delay: .8s;--scrollbar-thumb-transition: height ease-out .15s, width ease-out .15s;--scrollbar-track-transition: height ease-out .15s, width ease-out .15s;display:block;position:relative;height:100%;max-height:100%;max-width:100%;box-sizing:content-box!important}[_nghost-%COMP%] > .ng-scrollbar-wrapper[_ngcontent-%COMP%]{--scrollbar-total-size: calc(var(--scrollbar-size) + var(--scrollbar-padding) * 2);--vertical-scrollbar-size: var(--scrollbar-size);--horizontal-scrollbar-size: var(--scrollbar-size);--vertical-scrollbar-total-size: calc(var(--vertical-scrollbar-size) + var(--scrollbar-padding) * 2);--horizontal-scrollbar-total-size: calc(var(--horizontal-scrollbar-size) + var(--scrollbar-padding) * 2)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalHovered=true][_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalDragging=true][_ngcontent-%COMP%]{--vertical-scrollbar-size: var(--scrollbar-hover-size);--vertical-scrollbar-total-size: calc(var(--vertical-scrollbar-size) + var(--scrollbar-padding) * 2);cursor:default}[_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalHovered=true][_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalDragging=true][_ngcontent-%COMP%]{--horizontal-scrollbar-size: var(--scrollbar-hover-size);--horizontal-scrollbar-total-size: calc(var(--horizontal-scrollbar-size) + var(--scrollbar-padding) * 2);cursor:default}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:0;right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{padding-right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content{padding-right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:var(--scrollbar-total-size);right:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{padding-left:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content{padding-left:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:var(--scrollbar-total-size);right:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{padding-left:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content{padding-left:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:0;right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{padding-right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content{padding-right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{top:0;bottom:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{padding-bottom:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content{padding-bottom:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{top:var(--scrollbar-total-size);bottom:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{padding-top:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%] > .ng-scroll-content[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport>.ng-scroll-content{padding-top:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{scrollbar-width:none;-ms-overflow-style:none}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]::-webkit-scrollbar, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport::-webkit-scrollbar{display:none}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-native-scrollbar-hider{bottom:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-native-scrollbar-hider{left:0;right:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][dir=rtl][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][dir=rtl][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-native-scrollbar-hider{right:0;left:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%] > .scrollbar-control[_ngcontent-%COMP%]{opacity:0;transition-property:opacity;transition-duration:var(--scrollbar-transition-duration);transition-delay:var(--scrollbar-transition-delay)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:hover > .scrollbar-control[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:active > .scrollbar-control[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:focus > .scrollbar-control[_ngcontent-%COMP%]{opacity:1;transition-duration:var(--scrollbar-transition-duration);transition-delay:0ms}[_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{overflow-x:auto;overflow-y:hidden}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >   .ng-scroll-viewport{overflow:auto}.ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{overflow:hidden}.ng-scroll-viewport[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch;contain:strict;will-change:scroll-position;overscroll-behavior:var(--scrollbar-overscroll-behavior)}  .ng-scroll-content{display:inline-block;min-width:100%}.ng-scrollbar-wrapper[_ngcontent-%COMP%], .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], .ng-scroll-layer[_ngcontent-%COMP%],   .ng-scroll-viewport{position:absolute;inset:0}",".ng-scrollbar-wrapper[pointerEventsMethod=viewport]>.scrollbar-control{pointer-events:none}  .ng-scrollbar-wrapper[horizontalDragging=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport,   .ng-scrollbar-wrapper[horizontalDragging=true]>.ng-scroll-viewport-wrapper>*>*>  .ng-scroll-viewport,   .ng-scrollbar-wrapper[verticalDragging=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport,   .ng-scrollbar-wrapper[verticalDragging=true]>.ng-scroll-viewport-wrapper>*>*>  .ng-scroll-viewport,   .ng-scrollbar-wrapper[scrollbarClicked=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport,   .ng-scrollbar-wrapper[scrollbarClicked=true]>.ng-scroll-viewport-wrapper>*>*>  .ng-scroll-viewport{-webkit-user-select:none;-moz-user-select:none;user-select:none}  .ng-scrollbar-wrapper>.scrollbar-control{position:absolute;display:flex;justify-content:center;align-items:center;transition:var(--scrollbar-track-transition)}  .ng-scrollbar-wrapper>.scrollbar-control[scrollable=false] .ng-scrollbar-thumb{display:none}  .ng-scrollbar-track{height:100%;width:100%;z-index:1;border-radius:var(--scrollbar-border-radius);background-color:var(--scrollbar-track-color);overflow:hidden;transition:var(--scrollbar-track-transition);cursor:default}  .ng-scrollbar-thumb{box-sizing:border-box;position:relative;border-radius:inherit;background-color:var(--scrollbar-thumb-color);transform:translateZ(0);transition:var(--scrollbar-thumb-transition)}"],changeDetection:0}),a})(),cr=(()=>{class a{static withConfig(t){return{ngModule:a,providers:[{provide:Aa,useValue:t}]}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[f.ez,ke.vT,_n.eL,he.ud,fc]}),a})();function Na(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw(2);e.Gre("status-pill status-",null==t.paymentStatus?null:t.paymentStatus.replace(" ","").toLowerCase(),""),e.xp6(1),e.Oqu(e.lcZ(2,4,t.paymentStatusMapper[null==t.paymentStatus?null:t.paymentStatus.toLowerCase()]))}}function ot(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"img",26),e.NdJ("load",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.orgImageLoading=!1)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("src",t.orgLogoUrl,e.LSH)}}function rn(a,c){if(1&a&&(e.TgZ(0,"label",28),e._uU(1),e.qZA()),2&a){const t=e.oxw(3);e.xp6(1),e.Oqu(t.orgName)}}function pr(a,c){if(1&a&&e.YNc(0,rn,2,1,"label",27),2&a){const t=e.oxw(2);e.Q6J("ngIf",t.orgName)}}function Ua(a,c){if(1&a&&(e.TgZ(0,"tr")(1,"td",44)(2,"h6",31),e._uU(3),e.qZA()()()),2&a){const t=e.oxw().$implicit;e.xp6(3),e.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}function ro(a,c){if(1&a&&(e.TgZ(0,"span",45),e._uU(1),e.qZA()),2&a){const t=e.oxw(5);e.xp6(1),e.hij(" ","person"===(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase())?t.customerValue:t.workProviderValue," ")}}function Ja(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",46),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw().$implicit,d=e.oxw(4);return s.recipient=r.value===d.workProviderValue?1:2,e.KtG(d.isAllocationChanged())}),e.qZA()}if(2&a){const t=e.oxw().index,n=e.oxw(2).$implicit,r=e.oxw(2);e.Q6J("inputModel",r.radioList[n.key][t])}}const fi=function(a,c,t,n,r){return[a,c,t,n,r]},Ga=function(a){return{"provide-td":a}};function dr(a,c){if(1&a&&(e.TgZ(0,"tbody"),e.YNc(1,Ua,4,1,"tr",39),e.TgZ(2,"tr")(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",40),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"xaCurrency"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"xaCurrency"),e.qZA(),e.TgZ(15,"td",41),e.YNc(16,ro,2,1,"span",42),e.YNc(17,Ja,1,1,"chq-input",43),e.qZA()()()),2&a){const t=c.$implicit,n=c.index,r=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(1),e.Q6J("ngIf","Paint"===r.key&&(0===n||n>0&&t.serviceSubType!==s.invoiceList[r.key][n-1].serviceSubType)),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.hij(" ",e.G7q(11,9,e.qbA(21,fi,t.cost,s.i18n.currencySymbol,s.i18n.digitsInfo,s.i18n.locale,s.i18n.position))," "),e.xp6(3),e.hij(" ",e.G7q(14,15,e.qbA(27,fi,t.total,s.i18n.currencySymbol,s.i18n.digitsInfo,s.i18n.locale,s.i18n.position))," "),e.xp6(2),e.Q6J("ngClass",e.VKq(33,Ga,"retail"===(null==s.currentWorkProvider?null:s.currentWorkProvider.toLowerCase()))),e.xp6(1),e.Q6J("ngIf","retail"===(null==s.currentWorkProvider?null:s.currentWorkProvider.toLowerCase())),e.xp6(1),e.Q6J("ngIf","retail"!==(null==s.currentWorkProvider?null:s.currentWorkProvider.toLowerCase()))}}function ur(a,c){if(1&a&&(e.TgZ(0,"ng-scrollbar",33)(1,"table",34)(2,"thead")(3,"tr")(4,"td"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"td",35),e._uU(20),e.ALo(21,"translate"),e.qZA()()(),e.YNc(22,dr,18,35,"tbody",36),e.ALo(23,"orderBy"),e.TgZ(24,"tfoot")(25,"tr")(26,"td",37),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"td",38),e._uU(30),e.ALo(31,"xaCurrency"),e.ALo(32,"sum"),e.qZA()()()()()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.Q6J("disabled",!n.isiOS)("track","horizontal")("autoHeightDisabled",!1),e.xp6(5),e.Oqu(e.lcZ(6,14,"description")),e.xp6(3),e.Oqu(e.lcZ(9,16,"code")),e.xp6(3),e.Oqu(e.lcZ(12,18,"units")),e.xp6(3),e.AsE("",e.lcZ(15,20,"price_unit"),"(",n.currencySymbol,")"),e.xp6(3),e.AsE("",e.lcZ(18,22,"total_price"),"(",n.currencySymbol,")"),e.xp6(3),e.Oqu(e.lcZ(21,24,"payer")),e.xp6(2),e.Q6J("ngForOf",e.Dn7(23,26,n.invoiceList[t.key],"serviceSubtype","asc")),e.xp6(5),e.Oqu(e.lcZ(28,30,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),e.xp6(3),e.hij(" ",e.G7q(31,32,e.qbA(41,fi,e.xi3(32,38,n.invoiceList[t.key],"total"),n.i18n.currencySymbol,n.i18n.digitsInfo,n.i18n.locale,n.i18n.position))," ")}}function an(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",29)(1,"span",30),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.hideShowSection(s.key))}),e.TgZ(2,"mat-icon"),e._uU(3),e.qZA(),e.TgZ(4,"h6",31),e._uU(5),e.ALo(6,"translate"),e.qZA()(),e.YNc(7,ur,33,47,"ng-scrollbar",32),e.qZA()}if(2&a){const t=c.$implicit,n=e.oxw(2);e.xp6(3),e.Oqu(n.getSection(t.key)?"keyboard_arrow_up":"keyboard_arrow_down"),e.xp6(2),e.Oqu(e.lcZ(6,3,null==t.key?null:t.key.toLowerCase())),e.xp6(2),e.Q6J("ngIf",n.getSection(t.key))}}function yc(a,c){if(1&a&&e._UZ(0,"chq-button",47),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.previewButtonModel)}}function sn(a,c){if(1&a&&e._UZ(0,"chq-button",47),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.saveButtonModel)}}function Ba(a,c){if(1&a&&e._UZ(0,"chq-button",47),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.generateInvoiceButtonModel)}}function Ya(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e.YNc(2,Na,3,6,"span",3),e.ALo(3,"sum"),e.qZA(),e.TgZ(4,"div",4)(5,"section",5)(6,"div",6)(7,"div",7),e.YNc(8,ot,1,1,"img",8),e.YNc(9,pr,1,1,"ng-template",null,9,e.W1O),e._UZ(11,"chq-customloader",10),e.qZA(),e.TgZ(12,"div",11)(13,"h4"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"h5"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"h5"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"h5"),e._uU(23),e.ALo(24,"translate"),e.qZA()()(),e.TgZ(25,"div",12)(26,"chq-input",13,14),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.invoiceIssuedDate.value=r.value||null,e.KtG(s.isAllocationChanged())}),e.qZA()()(),e.TgZ(28,"section",15)(29,"div",16)(30,"span",17),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.expandCollapse(!0))}),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"span",17),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.expandCollapse(!1))}),e._uU(34),e.ALo(35,"translate"),e.qZA()(),e.TgZ(36,"div",18),e.YNc(37,an,8,5,"div",19),e.ALo(38,"keyvalue"),e.qZA()()(),e.TgZ(39,"div",20)(40,"div",21)(41,"div",22),e._UZ(42,"img",23),e.qZA()(),e.TgZ(43,"div",24),e.YNc(44,yc,1,1,"chq-button",25),e.YNc(45,sn,1,1,"chq-button",25),e.YNc(46,Ba,1,1,"chq-button",25),e.qZA()()()}if(2&a){const t=e.MAs(10),n=e.oxw();e.xp6(2),e.Q6J("ngIf",e.xi3(3,23,n.charges,"total")>0),e.xp6(6),e.Q6J("ngIf",n.orgLogoUrl)("ngIfElse",t),e.xp6(3),e.Q6J("showLoading",n.orgImageLoading),e.xp6(3),e.AsE("",e.lcZ(15,26,"repair_id"),": ",n.repairId,""),e.xp6(3),e.AsE("",e.lcZ(18,28,"make"),": ",n.make,""),e.xp6(3),e.AsE("",e.lcZ(21,30,"model"),": ",n.model,""),e.xp6(3),e.AsE("",e.lcZ(24,32,"license_plate"),": ",n.licensePlate,""),e.xp6(3),e.Q6J("inputModel",n.invoiceIssuedDate),e.xp6(4),e.ekj("secondary-color",n.isAllExpanded),e.xp6(1),e.Oqu(e.lcZ(32,34,"expand_all")),e.xp6(2),e.ekj("secondary-color",!n.isAllExpanded),e.xp6(1),e.hij("",e.lcZ(35,36,"collapse_all")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(38,38,n.invoiceList,n.valueAscOrder)),e.xp6(7),e.Q6J("ngIf","retail"!==(null==n.currentWorkProvider?null:n.currentWorkProvider.toLowerCase())),e.xp6(1),e.Q6J("ngIf","readytoinvoice"!==n.status.toLowerCase()&&!n.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf","readytoinvoice"===n.status.toLowerCase()||!n.commonService.isViewOnly)}}let hr=(()=>{class a{constructor(t,n,r,s,d,u,v){this.commonService=t,this.invoiceService=n,this.bookingService=r,this.monitorServie=s,this.dialog=d,this.router=u,this.route=v,this.digitInfo="",this.locale="",this.repairId="",this.make="",this.maxPoint=1e7,this.model="",this.status="",this.licensePlate="",this.currencySymbol="",this.caseGuid="",this.orgImageLoading=!0,this.orgLogoUrl="",this.orgName="",this.paymentStatus="",this.isAllExpanded=!0,this.isPartsExpanded=!0,this.isLabourExpanded=!0,this.isPaintExpanded=!0,this.workProviderValue="",this.customerValue="",this.partsCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",units:"2",cost:"500",total:"1500"}],this.totalPartsCost=0,this.currentChangesString="",this.totalPaintCost=0,this.hasPaint=!1,this.hasParts=!1,this.hasLabour=!1,this.repairStatus="",this.paintCost=[],this.invoiceList={},this.isDataLoading=!0,this.radioList={},this.summary={},this.charges=[],this.currentWorkProvider="",this.currentWorkProviderType="",this.currentDate=new Date,this.invoiceIssuedDate={placeHolder:"Select Date",label:"INVOICE DATE",name:"issuedDate",value:this.currentDate,maxDate:this.currentDate,minDate:E().subtract(1,"year").toDate(),type:"date",required:!1,disabled:!1,mode:"date"},this.radioButtonList=[],this.previewButtonModel={label:"Preview",type:"outline",onclick:()=>this.previewInvoiceSummary()},this.saveButtonModel={label:"Save",type:"disabled-outline",onclick:()=>{this.updateEstimateCharge()}},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.hashPropTable={},this.generateInvoiceButtonModel={label:"Generate Invoice",icon:"invoices",type:"primary",onclick:()=>{this.goToGenerateInvoice()}},this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}goToGenerateInvoice(){if("readytoinvoice"===this.status?.toLowerCase()||"invoiced"===this.status?.toLowerCase()){let t=1;return"retail"===this.currentWorkProvider?.toLowerCase()&&"person"===this.currentWorkProviderType?.toLowerCase()&&(t=2),void this.router.navigate(["../invoicesEdit"],{relativeTo:this.route,queryParams:{formType:t}})}"repair in progress"===this.repairStatus?.toLowerCase()||"approved"===this.repairStatus?.toLowerCase()?this.commonService.openConfirmYesNoDialog("Confirm to Continue","Once the invoice is generated, you won\u2019t be able to edit the estimate again. Are you sure you want to continue?").afterClosed().subscribe(n=>{n&&this.updateEstimateCharge(!0)}):this.updateEstimateCharge(!0)}parseFloatingPoint(t,n){return this.hashPropTable[n]?t:(n&&(this.hashPropTable[n]=!0),t*this.maxPoint)}get isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}valueAscOrder(t,n){const r={part:"1",labour:"2",paint:"3"};return r[t.key?.toLowerCase()].localeCompare(r[n.key?.toLowerCase()])}validateLabourTypes(t,n,r,s){return n===un.UW.Paint?(this.hasPaint=!0,"PaintLabour"===r.serviceSubType?(t.paintLabourHourSubTotal=this.parseFloatingPoint(t.paintLabourHourSubTotal,`paintLabourHourSubTotal_${s}`)+this.parseFloatingPoint(r.quantity),t.paintLabourAmountSubTotal=this.parseFloatingPoint(t.paintLabourAmountSubTotal,`paintLabourAmountSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintLabourSubTotal=this.parseFloatingPoint(t.paintLabourSubTotal,`paintLabourSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintLabourTotal=this.parseFloatingPoint(t.paintLabourTotal,`paintLabourSubTotal+${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.paintLabourDiscountPercentage))/100)):(t.paintMaterialSubTotal=this.parseFloatingPoint(t.paintMaterialSubTotal,`paintMaterialSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintMaterialTotal=this.parseFloatingPoint(t.paintMaterialTotal,`paintMaterialTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.paintMateriaDiscountPercentage))/100))):n===un.UW.Labour?(this.hasLabour=!0,t.labourTotalBeforeDiscount=this.parseFloatingPoint(t.labourTotalBeforeDiscount,`labourTotalBeforeDiscount_${s}`)+this.parseFloatingPoint(r.total),t.labourAmountSubTotal=this.parseFloatingPoint(t.labourAmountSubTotal,`labourAmountSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.labourTotal=this.parseFloatingPoint(t.labourTotal,`labourTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.labourTotalDiscountPercentage))/100),t.labourHourSubTotal=this.parseFloatingPoint(t.labourHourSubTotal,`labourHourSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.labourTimeHours=this.parseFloatingPoint(t.labourTimeHours,`labourTimeHours_${s}`)+this.parseFloatingPoint(r.quantity)):(this.hasParts=!0,t.partsTotalBeforeDiscount=this.parseFloatingPoint(t.partsTotalBeforeDiscount,`partsTotalBeforeDiscount_${s}`)+this.parseFloatingPoint(r.total),t.partsTotal=this.parseFloatingPoint(t.partsTotal,`partsTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.partsTotalDiscountPercentage))/100),t.partsSubTotal=this.parseFloatingPoint(t.partsSubTotal,`partsSubTotal_${s}`)+this.parseFloatingPoint(r.total)),t}calculateSummary(t){this.hashPropTable={};const n=Object.keys(t);t.paintLabourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.paintLabourSubTotal=0,t.labourTotal=0,t.paintLabourTotal=0,t.labourTimeHours=0,t.labourTotalBeforeDiscount=0,t.paintMaterialTotal=0,t.paintMaterialSubTotal=0,t.labourAmountSubTotal=0,t.labourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.partsSubTotal=0,t.partsTotal=0,t.partsTotalBeforeDiscount=0,n.forEach(D=>{t[D]=t[D]||"0"===t[D]?parseFloat(t[D]):0});let r=!1,s=!1;const d=JSON.parse(JSON.stringify(t)),u=[];d.title="work_provider_invoice";const v={};this.charges?.forEach(D=>{1===D.recipient&&(r=!0,v[D.serviceType]||(v[D.serviceType]=[]),v[D.serviceType].push(D))}),r&&(d.invoiceList=v,u[0]=d);const y=JSON.parse(JSON.stringify(t));y.title="driver_owner_invoice";const w={};return this.charges?.forEach(D=>{2===D.recipient&&(s=!0,w[D.serviceType]||(w[D.serviceType]=[]),w[D.serviceType].push(D))}),s&&(y.invoiceList=w,u[1]=y),this.charges.forEach(D=>{const q=D.serviceType;(D.cost||"0"===D.cost)&&(D.cost=parseFloat(D.cost)),(D.quantity||"0"===D.quantity)&&(D.quantity=parseFloat(D.quantity)),(D.total||"0"===D.total)&&(D.total=parseFloat(D.total)),1===D.recipient?u[0]=this.validateLabourTypes(u[0],q,D,D.recipient):u[1]=this.validateLabourTypes(u[1],q,D,D.recipient)}),r&&(u[0].paintLabourHourSubTotal=u[0].paintLabourHourSubTotal/this.maxPoint,u[0].paintLabourSubTotal=u[0].paintLabourSubTotal/this.maxPoint,u[0].labourTotal=u[0].labourTotal/this.maxPoint,u[0].paintLabourTotal=u[0].paintLabourTotal/this.maxPoint,u[0].labourTimeHours=u[0].labourTimeHours/this.maxPoint,u[0].labourTotalBeforeDiscount=u[0].labourTotalBeforeDiscount/this.maxPoint,u[0].paintMaterialTotal=u[0].paintMaterialTotal/this.maxPoint,u[0].paintMaterialSubTotal=u[0].paintMaterialSubTotal/this.maxPoint,u[0].labourAmountSubTotal=u[0].labourAmountSubTotal/this.maxPoint,u[0].labourHourSubTotal=u[0].labourHourSubTotal/this.maxPoint,u[0].paintLabourAmountSubTotal=u[0].paintLabourAmountSubTotal/this.maxPoint,u[0].partsSubTotal=u[0].partsSubTotal/this.maxPoint,u[0].partsTotal=u[0].partsTotal/this.maxPoint,u[0].partsTotalBeforeDiscount=u[0].partsTotalBeforeDiscount/this.maxPoint),s&&(u[1].paintLabourHourSubTotal=u[1].paintLabourHourSubTotal/this.maxPoint,u[1].paintLabourSubTotal=u[1].paintLabourSubTotal/this.maxPoint,u[1].labourTotal=u[1].labourTotal/this.maxPoint,u[1].paintLabourTotal=u[1].paintLabourTotal/this.maxPoint,u[1].labourTimeHours=u[1].labourTimeHours/this.maxPoint,u[1].labourTotalBeforeDiscount=u[1].labourTotalBeforeDiscount/this.maxPoint,u[1].paintMaterialTotal=u[1].paintMaterialTotal/this.maxPoint,u[1].paintMaterialSubTotal=u[1].paintMaterialSubTotal/this.maxPoint,u[1].labourAmountSubTotal=u[1].labourAmountSubTotal/this.maxPoint,u[1].labourHourSubTotal=u[1].labourHourSubTotal/this.maxPoint,u[1].paintLabourAmountSubTotal=u[1].paintLabourAmountSubTotal/this.maxPoint,u[1].partsSubTotal=u[1].partsSubTotal/this.maxPoint,u[1].partsTotal=u[1].partsTotal/this.maxPoint,u[1].partsTotalBeforeDiscount=u[1].partsTotalBeforeDiscount/this.maxPoint),"retail"===this.currentWorkProvider?.toLowerCase()?"person"===this.currentWorkProviderType?.toLowerCase()?[u[1]]:[u[0]]:u}isAllocationChanged(){const t=JSON.stringify(this.invoiceList);this.saveButtonModel=this.invoiceIssuedDate.disabled||t===this.currentChangesString&&E(this.invoiceIssuedDate.value).format("DD/MM/YYYY")==E(this.currentDate).format("DD/MM/YYYY")?{...this.saveButtonModel,type:"disabled-outline"}:{...this.saveButtonModel,type:"outline"}}hideShowSection(t){"part"===t?.toLowerCase()?this.isPartsExpanded=!this.isPartsExpanded:"labour"===t?.toLowerCase()?this.isLabourExpanded=!this.isLabourExpanded:this.isPaintExpanded=!this.isPaintExpanded}getSection(t){return"part"===t?.toLowerCase()?this.isPartsExpanded:"labour"===t?.toLowerCase()?this.isLabourExpanded:this.isPaintExpanded}getBookingRepairDetails(){var t=this;this.commonService.showLoading();const n=this.route.parent?.snapshot.paramMap.get("id");var r;this.monitorServie.logEvent("getBookingRepairDetails",["InvoicesComponent","addenda-repair"],{repairGuid:n}),this.bookingService.getRepairDetailByGuid(n).subscribe({next:(r=(0,ue.Z)(function*(s){if(s?.data){t.caseGuid=s.data.quoteId,t.repairStatus=s.data.status,t.status=s.data.invoiceStatus||"";const d=s.data.createdDate,u=E(new Date).diff(E(d),"minutes");if(t.invoiceIssuedDate={...t.invoiceIssuedDate,minDate:E(d).toDate(),disabled:u<0,maxDate:u<0?E(d).toDate():new Date},["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(t.repairStatus.toLowerCase())||(t.generateInvoiceButtonModel={...t.generateInvoiceButtonModel,type:"disabled"}),t.currentWorkProvider=s.data.customer.companyOrgType,t.currentWorkProviderType=s.data.customer.customerTypeName,t.orgName=s.data?.organizationDetail?.nameOfOrganization,t.orgLogoUrl=s.data?.organizationDetail?.logoOfOrg,t.customerValue=`${s.data?.customer?.firstName} ${s.data?.customer?.lastName}`,t.workProviderValue=s.data?.customer?.companyName||s.data?.customer?.customerTypeName,t.orgLogoUrl||(t.orgImageLoading=!1),"technician"===t.commonService.roleName?.toLowerCase())return;t.invoiceService.invoicePerDetail(n).subscribe({next:P=>{const{chargesDTO:y,chargeSummary:w,repairEstimateId:D,repairId:q,repairNumber:se,status:Be,paymentStatus:Me,vehicle:ln,invoiceDate:K}=P.data;if(t.repairId=se,t.repairIntId=q,t.estimateIntId=D,t.paymentStatus=Me,t.summary=w,t.make=ln.vehicleMake,t.model=ln.vehicleModel,t.licensePlate=ln.licensePlateNumber,t.charges=y,K&&(t.invoiceIssuedDate={...t.invoiceIssuedDate,value:K}),("readytoinvoice"===t.status?.toLowerCase()||"invoiced"===t.status?.toLowerCase()||"paid"===t.paymentStatus?.toLowerCase())&&(t.generateInvoiceButtonModel={...t.generateInvoiceButtonModel,label:"view_invoices"},t.invoiceIssuedDate={...t.invoiceIssuedDate,mode:"text"}),t.commonService.isViewOnly&&(t.invoiceIssuedDate={...t.invoiceIssuedDate,mode:"text"}),!t.charges||0===t.charges.length)return t.commonService.showToast(0,"no_charges"),void t.commonService.hideLoading();t.isDataLoading=!1,y.forEach(Pe=>{t.invoiceList[Pe.serviceType]||(t.invoiceList[Pe.serviceType]=[],t.radioList[Pe.serviceType]=[]),Pe.serviceType===un.UW.Paint?t.hasPaint=!0:Pe.serviceType===un.UW.Labour?t.hasLabour=!0:t.hasParts=!0;let Bt={placeHolder:"",label:"",name:"payer",idField:"payer",value:1===Pe.recipient?t.workProviderValue:t.customerValue,type:"radio",disabled:"readytoinvoice"===Be.toLowerCase(),options:[{label:t.workProviderValue,id:1},{label:t.customerValue,id:2}]};if("retail"===t.currentWorkProvider?.toLowerCase()){const ho="person"===t.currentWorkProviderType?.toLowerCase()?t.customerValue:t.workProviderValue,Vc="person"===t.currentWorkProviderType?.toLowerCase()?2:1;Bt={...Bt,options:[{label:ho,id:Vc}],mode:"text"}}t.radioList[Pe.serviceType].push(Bt),t.invoiceList[Pe.serviceType].push(Pe)}),t.currentChangesString=JSON.stringify(t.invoiceList),t.commonService.hideLoading(),t.commonService.repairDetails.next(s.data),t.commonService.bookingId.next(s.data.repairNumber)}})}else t.commonService.hideLoading()}),function(d){return r.apply(this,arguments)}),error:r=>{this.commonService.hideLoading(),this.isDataLoading=!1,this.monitorServie.logException(r,_e._.Error)}})}updateEstimateCharge(t){const n={repairId:this.repairIntId,estimateId:this.estimateIntId,status:t?3:1,invoiceDate:E(this.invoiceIssuedDate.value).format("YYYY-MM-DD")+"T00:00:00Z",estimateCharges:[]};Object.keys(this.invoiceList).forEach(s=>{this.invoiceList[s].forEach(u=>{n.estimateCharges.push({estimateChargeId:u.chargeId,RecipientId:u.recipient})})}),this.commonService.showLoading(),this.invoiceService.assignInvoice(n).subscribe({next:s=>{if(s){this.commonService.showInfoToast(1e3,"Invoice saved successfully");let d=1;"retail"===this.currentWorkProvider?.toLowerCase()&&"person"===this.currentWorkProviderType?.toLowerCase()&&(d=2),this.commonService.hideLoading(),t&&this.router.navigate(["../invoicesEdit"],{relativeTo:this.route,queryParams:{formType:d}})}},error:()=>{this.commonService.hideLoading()}})}ngOnInit(){this.getBookingRepairDetails()}expandCollapse(t){this.isAllExpanded=t,this.isPartsExpanded=t,this.isPaintExpanded=t,this.isLabourExpanded=t}previewInvoiceSummary(){const n=this.calculateSummary(this.summary).filter(r=>r?.title);this.dialog.open(to,{width:" 58.5rem",height:"39.625rem",disableClose:!0,data:{title:"delete",message:"delete_confirm",messageEntity:"entity",okText:"yes",cancelText:"no",summaryData:n,showPaint:this.hasPaint,showLabour:this.hasLabour,showParts:this.hasParts},autoFocus:!1})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(be.v),e.Y36(Ki),e.Y36(Dt.q),e.Y36(we.M),e.Y36(xe.uw),e.Y36(ye.F0),e.Y36(ye.gz))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-repair-invoices"]],decls:1,vars:1,consts:[["class","repair-invoice-wrapper",4,"ngIf"],[1,"repair-invoice-wrapper"],[1,"status-pill-wrapper"],[3,"class",4,"ngIf"],[1,"page-container"],[1,"repair-info"],[1,"repair-info-col-1"],[1,"org-image"],["alt","org logo",3,"src","load",4,"ngIf","ngIfElse"],["name",""],[3,"showLoading"],[1,"repair-detail"],[1,"repair-info-col-2"],[1,"col-6","invoice-date-input",3,"inputModel","controlOutput"],["regDate",""],[1,"invoices-table-wrapper"],[1,"expand-collapse-btn"],[3,"click"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["alt","addenda logo","src","assets/img/addenda-repair.png"],[1,"button-container"],[3,"buttonModel",4,"ngIf"],["alt","org logo",3,"src","load"],["class","org-name",4,"ngIf"],[1,"org-name"],[1,"table-parent"],[1,"expand-container",3,"click"],[1,"small-heading"],["class","wrapper-table-scroll",3,"disabled","track","autoHeightDisabled",4,"ngIf"],[1,"wrapper-table-scroll",3,"disabled","track","autoHeightDisabled"],["width","100%"],["align","center"],[4,"ngFor","ngForOf"],["colspan","5"],["align","right"],[4,"ngIf"],[1,"text-light"],[3,"ngClass"],["class","provider-class",4,"ngIf"],["class","payer-radio-btn",3,"inputModel","controlOutput",4,"ngIf"],["colspan","6"],[1,"provider-class"],[1,"payer-radio-btn",3,"inputModel","controlOutput"],[3,"buttonModel"]],template:function(t,n){1&t&&e.YNc(0,Ya,47,41,"div",0),2&t&&e.Q6J("ngIf",!n.isDataLoading)},dependencies:[f.mk,f.sg,f.O5,Mt.D,He.E,We.h,Le.Hw,lr,f.Nd,V,Yo,Xi.j,pe.X$],styles:[".repair-invoice-wrapper[_ngcontent-%COMP%]{background-color:#dbdde2;height:calc(100% - 315px);padding-top:50px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:.625rem;font-style:normal;font-weight:700;padding:.6875rem 2rem;border-radius:.625rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:rgba(255,255,255,.82)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .org-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5.58956rem;height:4.86131rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-direction:column}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2{display:flex;flex-direction:column;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2 chq-input.invoice-date-input{width:16.28494rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2 chq-input.invoice-date-input div.input-wrapper:not(.text-mode) input{outline:2px solid black}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]{margin-top:2.4rem;display:flex;flex-direction:column;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]{display:flex;gap:1.25rem;padding-left:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--colors-gray-40, rgba(26, 34, 51, .4));font-size:.75rem;font-style:normal;font-weight:600;line-height:.875rem;cursor:pointer}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem;margin-bottom:1.5rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0rem 0rem;border-bottom:1px solid var(--colors-gray-10, rgba(26, 34, 51, .1));background:var(--colors-background, #f1f2f6)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:700}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:12px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray);font-size:10px;font-weight:500}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{padding-right:calc(5px + 1.5vw);align-items:center;display:flex;gap:1rem;justify-content:flex-end}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}.provide-td[_ngcontent-%COMP%]{text-align:center}.provider-class[_ngcontent-%COMP%]{height:20px}.wrapper-table-scroll[_ngcontent-%COMP%]{max-width:100%;overflow-x:auto}.wrapper-table-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{display:inherit}.wrapper-table-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}[_ngcontent-%COMP%]::-webkit-scrollbar{-webkit-appearance:none;width:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;background-color:#00000080;box-shadow:0 0 1px #ffffff80}.wrapper-table-scroll[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{border-radius:10px;background:rgba(100,100,100,.8);-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.5)}@media screen and (max-width: 864px){  .payer-radio-btn div.input-wrapper .radio{flex-direction:column;gap:0px}}"]}),a})();function xc(a,c){if(1&a&&(e.TgZ(0,"div",19)(1,"div",20),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",21),e._uU(6),e.qZA()()),2&a){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,e.lcZ(4,4,"status"))),e.xp6(4),e.Oqu(t.partsStatus)}}function wc(a,c){if(1&a&&e._UZ(0,"chq-button",24),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.addPartButtonModel)}}function Tc(a,c){1&a&&(e.TgZ(0,"div",22),e.YNc(1,wc,1,1,"chq-button",23),e.qZA()),2&a&&(e.xp6(1),e.Q6J("chqPermission","repairAddParts"))}function Ha(a,c){if(1&a&&(e.TgZ(0,"div",30),e._UZ(1,"mat-icon",31),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&a){const t=e.oxw().$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("svgIcon",n.partMapper[t.statusId+"_icon"]),e.xp6(2),e.hij("",n.partMapper[t.statusId+"_name"]," ")}}function za(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",32),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(3);return e.KtG(s.onStatusChange(r))}),e.qZA()}if(2&a){const t=e.oxw().index,n=e.oxw(2);e.Q6J("inputModel",n.individualStatusModels[t])}}function Dc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"mat-icon",33),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),s=r.index,d=r.$implicit,u=e.oxw(2);return e.KtG(u.showDropdown(s,d.partId))}),e.qZA()}if(2&a){const t=e.oxw().index,n=e.oxw(2);e.Q6J("svgIcon",n.editMode[t]?"cross":"edit")}}const mr=function(a,c,t,n,r){return[a,c,t,n,r]};function Qa(a,c){if(1&a&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"xaCurrency"),e.qZA(),e.TgZ(10,"td",26),e._uU(11),e.ALo(12,"xaCurrency"),e.qZA(),e.TgZ(13,"td"),e.YNc(14,Ha,4,2,"div",27),e.YNc(15,za,1,1,"chq-input",28),e.qZA(),e.TgZ(16,"td"),e.YNc(17,Dc,1,1,"mat-icon",29),e.qZA()()),2&a){const t=c.$implicit,n=c.index,r=e.oxw(2);e.xp6(2),e.hij(" ",t.description," "),e.xp6(2),e.hij(" ",t.code," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.G7q(9,8,e.qbA(20,mr,t.cost,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," "),e.xp6(3),e.hij(" ",e.G7q(12,14,e.qbA(26,mr,t.total,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," "),e.xp6(3),e.Q6J("ngIf",!r.editMode[n]),e.xp6(1),e.Q6J("ngIf",r.editMode[n]),e.xp6(2),e.Q6J("ngIf",!r.readOnlyMode&&!r.commonService.isViewOnly)}}function $e(a,c){if(1&a&&(e.TgZ(0,"tbody"),e.YNc(1,Qa,18,32,"tr",25),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.parts)}}function It(a,c){1&a&&(e.TgZ(0,"tbody")(1,"tr")(2,"td",34),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&a&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"no_parts_available")))}function Sc(a,c){if(1&a&&e._UZ(0,"chq-button",24),2&a){const t=e.oxw();e.Q6J("buttonModel",t.saveButtonModel)}}let Ic=(()=>{class a{constructor(t,n,r,s,d,u,v,P){this.dialog=t,this.bookingService=n,this.commonService=r,this.route=s,this.monitorService=d,this.repairEstimateService=u,this.repairEstimateOperationService=v,this.router=P,this.notifyServiceButtonModel={label:"Notify Service Advisor",type:"outline",icon:"paperplane",iconColor:"black"},this.addPartButtonModel={label:"Add Part",type:"outline",icon:"plus",onclick:this.openPartPopup.bind(this)},this.saveButtonModel={label:"Save",type:"disabled",onclick:this.saveParts.bind(this)},this.individualStatusModel={placeHolder:"Select Status",name:"indStatus",label:"",type:"select",value:0,displayValue:"name",options:[],showSelectedOption:!1},this.individualStatusModels=[],this.parts=[],this.partsStatus="",this.repairGuid="",this.estimateSource="",this.userPermission={},this.partMapper={},this.editMode=[],this.formData=[],this.repairStatus="",this.readOnlyMode=!1,this.hideButton=!1,this.repairTypesArray=[],this.afterOperation=!1,this.commonService.accessRight.closed&&(this.commonService.accessRight=new Ct.X(!0)),this.commonService.userProfileData.subscribe(y=>{if(y&&y.data){const{userPermission:w}=y.data;this.userPermission=w||{}}}),this.i18n=this.commonService.geti18nInfo(),this.route.parent?.params?.subscribe(y=>{""!=this.repairGuid&&this.repairGuid!==y.id&&(this.repairGuid=y.id,this.getRepairDetails(),this.getParts())})}get disableEdit(){return!!["pendingapproval","readytoinvoice","invoiced","complete"].includes(this.repairStatus?.toLowerCase())}ngOnInit(){this.repairGuid=this.route.parent?.snapshot.paramMap.get("id"),this.commonService.showLoading(),(0,Rn.D)({partStatuses:this.repairEstimateOperationService.getPartStatuses(),part:this.repairEstimateOperationService.getParts(this.repairGuid),repairDetail:this.bookingService.getRepairDetailByGuid(this.repairGuid)}).pipe((0,Ln.K)(n=>(0,ct.of)(n))).subscribe({next:n=>{if(n.partStatuses&&this.getPartStatuses(n.partStatuses?.data),n.part){const r=n.part;r&&(this.parts=r.repairParts,this.parts?.length>0&&this.parts.forEach((s,d)=>{this.individualStatusModels[d]=this.individualStatusModel,this.individualStatusModels[d]={...this.individualStatusModels[d],selectedOption:{name:s.status,id:s.statusId},name:`ind-status-${d}`},this.editMode[d]=!1}),this.partsStatus=this.mapStatus(r.status))}if(n.repairDetail){const r=n.repairDetail;this.repairResponse=n.repairDetail.data,this.commonService.bookingId.next(this.repairResponse.repairNumber),this.commonService.repairGuid.next(this.repairResponse.repairGuid),this.commonService.repairDetails.next(this.repairResponse),this.estimateSource=this.repairResponse.estimateSource||"",this.repairStatus=this.repairResponse.status,this.disableEdit?(this.readOnlyMode=!0,this.hideButton=!0):("GTMotive"!=this.estimateSource&&this.checkGTEstimatePermission()||"GTMotive"==this.estimateSource&&!this.checkGTEstimatePermission())&&(this.readOnlyMode=!0),"repair"==r.data.repairType?.toLowerCase()&&(this.afterOperation||this.getInitialRepairTypes(r.data.repairServiceTypes))}},error:n=>{this.commonService.hideLoading()}})}getPartStatuses(t){if(t){this.individualStatusModel={...this.individualStatusModel,options:t};const n={};this.individualStatusModel.options.forEach((r,s)=>{this.individualStatusModel.options[s]={...this.individualStatusModel.options[s],dropdownItemIcon:this.getIcon(r.name)},n[r.id+"_name"]=r.description,n[r.id+"_icon"]=this.getIcon(r.name)}),this.partMapper=n}}getIcon(t){switch(t){case"NotOrdered":return"parts-not-ordered";case"Ordered":return"parts-ordered";case"Arrived":return"parts-arrived";default:return""}}mapStatus(t){switch(t){case"NotOrdered":return"Not Ordered";case"OrderedPartially":return"Ordered Partially";case"ArrivedPartially":return"Arrived Partially";default:return t}}getParts(){this.commonService.showLoading(),this.repairEstimateOperationService.getParts(this.repairGuid).subscribe({next:t=>{t&&(this.parts=t.repairParts,this.parts?.length>0&&this.parts.forEach((n,r)=>{this.individualStatusModels[r]=this.individualStatusModel,this.individualStatusModels[r]={...this.individualStatusModels[r],selectedOption:{name:n.status,id:n.statusId},name:`ind-status-${r}`},this.editMode[r]=!1}),this.partsStatus=this.mapStatus(t.status))},complete:()=>{this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}saveParts(){this.commonService.showLoading(),this.repairEstimateOperationService.editPartStatuses(this.formData,this.repairGuid).subscribe({next:t=>{t&&(this.getParts(),this.formData=[],this.saveButtonModel.type="disabled")},complete:()=>{this.commonService.hideLoading()}})}getRepairDetails(){this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairGuid).subscribe({next:t=>{this.repairResponse=t.data,this.commonService.bookingId.next(this.repairResponse.repairNumber),this.commonService.repairGuid.next(this.repairResponse.repairGuid),this.commonService.repairDetails.next(this.repairResponse),this.estimateSource=this.repairResponse.estimateSource||"",this.repairStatus=this.repairResponse.status,this.disableEdit?(this.readOnlyMode=!0,this.hideButton=!0):("GTMotive"!=this.estimateSource&&this.checkGTEstimatePermission()||"GTMotive"==this.estimateSource&&!this.checkGTEstimatePermission())&&(this.readOnlyMode=!0),"repair"==t.data.repairType?.toLowerCase()&&(this.afterOperation?"GTMotive"!=this.estimateSource&&(this.showRepairTypeUpdateMessage(t.data.repairServiceTypes,this.repairTypesArray),-1!==location.search.indexOf("?mode=edit")?this.router.navigate([`/repair/booking/${this.repairGuid}/estimate`],{queryParams:{mode:"edit"}}):this.router.navigate([`/repair/booking/${this.repairGuid}/estimate`])):this.getInitialRepairTypes(t.data.repairServiceTypes)),this.commonService.hideLoading()},complete:()=>{this.commonService.hideLoading()}})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,n=t.filter(r=>"Repair Estimate"===r.automotiveServiceName);if(n&&n.length>0){const{permissions:r}=n[0],s=r.filter(d=>"gt.estimate"===d.permissionName||"gt.estimate.vinquery"===d.permissionName);if(s&&s.length>0)return!0}return!1}redirectToGtEstimate(){this.commonService.showLoading(),this.monitorService.logEvent("redirectToGtEstimate",["RepairPartsComponent","addenda-repair",{repairId:this.repairGuid}]),this.repairEstimateService.createEstimateFromRepair(this.repairGuid).subscribe({next:t=>{t&&(location.href=t.data.url,sessionStorage.setItem("update","1"),sessionStorage.setItem("current-url",this.router.url.toString()),sessionStorage.setItem("initial-repair-types",JSON.stringify(this.repairTypesArray)))},complete:()=>{this.commonService.hideLoading()}})}onStatusChange(t){const n=t.name?.replace("ind-status-","");this.individualStatusModels[n]={...this.individualStatusModels[n],selectedOption:t.value};const r=this.formData.find(s=>s.partGuid==this.parts[n]?.partGuidId);r?r.status=t.value?.name:this.formData.push({status:t.value?.name,partGuid:this.parts[n]?.partGuidId}),this.saveButtonModel.type="primary"}showDropdown(t,n=""){if(this.editMode[t]=!this.editMode[t],this.saveButtonModel.type=this.editMode.some(r=>!0===r)?"primary":"disabled",0==this.editMode[t]){const r=this.parts.find(s=>s.partId==n);r&&(this.individualStatusModels[t]={...this.individualStatusModels[t],selectedOption:{name:r.status,id:r.statusId}}),this.formData=this.formData?.filter(s=>s.partGuid!=r.partGuidId)}}openPartPopup(){if("GTMotive"==this.estimateSource)this.redirectToGtEstimate();else{if(this.checkGTEstimatePermission())return void this.commonService.showToast(0,"msg_gt_permission");this.dialog.open(Ao,{data:{repairId:this.repairGuid},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:n=>{n&&(this.afterOperation=!0,this.getRepairDetails())}})}}getInitialRepairTypes(t){t.forEach(n=>{this.repairTypesArray.push(n.repairServiceType)})}showRepairTypeUpdateMessage(t,n){const s=[];if(t?.forEach(d=>{s.push("object"==typeof d?d.repairServiceType:d)}),s.length>0){const d=s.filter(u=>!n.includes(u));d.length>0&&(this.commonService.showInfoToast(1e3,`Repair Type was updated: Added ${d.join(",")}`),this.repairTypesArray=[...this.repairTypesArray,...d])}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(xe.uw),e.Y36(Dt.q),e.Y36(be.v),e.Y36(ye.gz),e.Y36(we.M),e.Y36(Ai.H),e.Y36(Ii),e.Y36(ye.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-repair-parts"]],decls:39,vars:28,consts:[[1,"repair-part-wrapper"],[1,"page-container"],[1,"toolbar-container"],[1,"toolbar-wrapper","row"],["class","part-status col-6",4,"ngIf"],[1,"col-6","button-section-wrapper"],["class","button-section",4,"ngIf"],[1,"table-container"],[1,"main-table"],["width","40%"],[1,"price"],[1,"total-price"],[4,"ngIf"],[1,"button-container"],[3,"buttonModel",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[1,"part-status","col-6"],[1,"part-status-label"],[1,"part-status-text"],[1,"button-section"],[3,"buttonModel",4,"chqPermission"],[3,"buttonModel"],[4,"ngFor","ngForOf"],[1,"total"],["class","dropdown-parts",4,"ngIf"],[3,"inputModel","controlOutput",4,"ngIf"],[3,"svgIcon","click",4,"ngIf"],[1,"dropdown-parts"],[3,"svgIcon"],[3,"inputModel","controlOutput"],[3,"svgIcon","click"],["colspan","7",1,"no-parts"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,xc,7,6,"div",4),e.TgZ(5,"div",5),e.YNc(6,Tc,2,1,"div",6),e.qZA()()(),e.TgZ(7,"div",7)(8,"table",8)(9,"thead")(10,"th",9),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th",10),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th",11),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"th"),e._uU(29),e.ALo(30,"translate"),e.qZA()(),e.YNc(31,$e,2,1,"tbody",12),e.YNc(32,It,5,3,"tbody",12),e.qZA()(),e.TgZ(33,"div",13),e.YNc(34,Sc,1,1,"chq-button",14),e.qZA()(),e.TgZ(35,"div",15)(36,"div",16)(37,"div",17),e._UZ(38,"img",18),e.qZA()()()()),2&t&&(e.xp6(4),e.Q6J("ngIf",(null==n.parts?null:n.parts.length)>0),e.xp6(2),e.Q6J("ngIf",!n.hideButton&&!n.commonService.isViewOnly),e.xp6(5),e.Oqu(e.lcZ(12,14,"parts_description")),e.xp6(3),e.Oqu(e.lcZ(15,16,"code")),e.xp6(3),e.Oqu(e.lcZ(18,18,"units")),e.xp6(3),e.AsE("",e.lcZ(21,20,"price_unit"),"(",n.i18n.currencySymbol,")"),e.xp6(3),e.AsE("",e.lcZ(24,22,"total_price"),"(",n.i18n.currencySymbol,")"),e.xp6(3),e.Oqu(e.lcZ(27,24,"status")),e.xp6(3),e.hij("",e.lcZ(30,26,"actions")," "),e.xp6(2),e.Q6J("ngIf",(null==n.parts?null:n.parts.length)>0),e.xp6(1),e.Q6J("ngIf",0===(null==n.parts?null:n.parts.length)),e.xp6(2),e.Q6J("ngIf",!n.hideButton&&!n.commonService.isViewOnly))},dependencies:[f.sg,f.O5,Mt.D,He.E,Le.Hw,kn.A,f.gd,Xi.j,pe.X$],styles:[".repair-part-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-tab-background);padding-top:calc(5px + 1.5vw)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:rgba(255,255,255,.82)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]{justify-content:flex-end}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:53px;padding-top:.5px;justify-content:center}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]   .part-status-label[_ngcontent-%COMP%]{font-size:14px;font-style:normal;font-weight:400;line-height:14px;color:var(--xa-dark-gray)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]   .part-status-text[_ngcontent-%COMP%]{font-size:16px;line-height:20px;display:flex;height:48px;flex-direction:column;justify-content:center;align-items:flex-start;align-self:stretch}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]     chq-dropdown{width:50%}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .button-section-wrapper[_ngcontent-%COMP%]   .button-section[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;gap:10px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{margin-bottom:30px;overflow:scroll;margin-top:30px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-light-gray);background:white}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:12px;line-height:14px;color:var(--xa-black);text-align:left;padding:10px;gap:10px;height:34px;-moz-appearance:none}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:500;background:rgba(26,34,51,.1)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:400;font-size:14px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]     chq-input a, .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]     chq-input a{background-color:var(--xa-popup-light-gray)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .dropdown-parts[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .dropdown-parts[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:5px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td.no-parts[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.no-parts[_ngcontent-%COMP%]{text-align:center}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}"]}),a})();var Re=(()=>{return(a=Re||(Re={})).Start="Start",a.Pause="Pause",a.Stop="Stop",Re;var a})(),ht=(()=>{return(a=ht||(ht={})).NotStarted="NotStarted",a.Completed="Completed",ht;var a})();const Va=function(a){return{selected:a}};function ja(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("click",function(){const s=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.triggerMenuItemClick(s))}),e.TgZ(1,"div",4)(2,"span",5),e._uU(3),e.qZA(),e.TgZ(4,"span",6),e._uU(5),e.qZA()()()}if(2&a){const t=c.$implicit;e.Q6J("ngClass",e.VKq(5,Va,t.active)),e.xp6(1),e.Udp("background",t.color),e.xp6(2),e.hij("",t.displayName,"%"),e.xp6(2),e.Oqu(t.name)}}let kc=(()=>{class a{constructor(t,n){this.monitorService=t,this.router=n,this.menuItemClick=new e.vpe,this.router.events.subscribe(()=>{this.setCurrentActiveMenu()})}triggerMenuItemClick(t){this.menuItemClick.emit(t)}splitter(t){const n=t?.split("/");if(n?.length>0){const r=n[n.length-1];return r.includes("?")?r.split("?")[0]:r}return""}setCurrentActiveMenu(){this.menuItems?.map(r=>r.active=!1);const t=this.splitter(location.href),n=this.menuItems?.filter(r=>this.splitter(r.url)===t||r.childMenuLinks&&r.childMenuLinks?.includes(t));n&&n.length>0?n[0].active=!0:this.menuItems&&this.menuItems[0]&&(this.menuItems[0].active=!0)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(we.M),e.Y36(ye.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["button-tabs"]],inputs:{menuItems:"menuItems"},outputs:{menuItemClick:"menuItemClick"},decls:3,vars:1,consts:[[1,"button-wrapper"],[1,"button-toggle"],["class","menu-wrapper",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"menu-wrapper",3,"ngClass","click"],[1,"menu-block"],[1,"head"],[1,"label-name"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,ja,6,7,"div",2),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngForOf",n.menuItems))},dependencies:[f.mk,f.sg],styles:[".button-wrapper[_ngcontent-%COMP%]{display:inline-flex;padding:7.31px 29px 0;justify-content:flex-start;align-items:center;flex:1;width:100%;overflow-x:auto}.menu-block[_ngcontent-%COMP%]{display:flex;height:59px;padding:10px 11px;align-items:center;gap:22px;justify-content:space-between;border-radius:10px;min-width:135px;color:var(--xa-white);border:1px solid var(--xa-white);margin-top:13px}.menu-block[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:400;line-height:14px}.menu-block[_ngcontent-%COMP%]   .label-name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;text-transform:uppercase}.menu-block[_ngcontent-%COMP%]   span.head[_ngcontent-%COMP%]{font-size:16px;font-weight:700;line-height:20px}.menu-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:flex-start;gap:20px;border-radius:14px 14px 0 0}.selected[_ngcontent-%COMP%]{background:var(--xa-popup-light-gray);padding:13px 20px}.selected[_ngcontent-%COMP%]   .menu-block[_ngcontent-%COMP%]{margin-top:0}.button-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;padding-top:10px;gap:10px}"]}),a})();var Ka=k(8358),Gn=k(15058),Bn=k(51572);function Ac(a,c){1&a&&(e.TgZ(0,"div",18)(1,"span",19),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&a&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"label_mandatory")))}function Wa(a,c){1&a&&(e.TgZ(0,"span",31),e._uU(1,"*"),e.qZA())}function $a(a,c){if(1&a&&(e.TgZ(0,"span",32),e._uU(1),e.ALo(2,"date"),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,t.updatedDate,"dd/MM/yyyy hh:mm:ss"))}}function ao(a,c){1&a&&e._UZ(0,"div",33)}function Xa(a,c){1&a&&(e.TgZ(0,"div",34),e._UZ(1,"div",35),e.TgZ(2,"div",36),e._UZ(3,"mat-spinner",37),e.qZA()()),2&a&&(e.xp6(3),e.Q6J("strokeWidth",2)("diameter",20))}const so=function(a){return{"not-allowed":a}};function gr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"span",38),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw();return e.KtG(s.updateTaskStatus(r))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(1,so,t.commonService.isViewOnly))}}function lo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"span",39),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw();return e.KtG(s.updateTaskStatus(r))}),e.qZA()}}function Rc(a,c){1&a&&(e.TgZ(0,"div",34),e._UZ(1,"div",35),e.TgZ(2,"div",36),e._UZ(3,"mat-spinner",37),e.qZA()()),2&a&&(e.xp6(3),e.Q6J("strokeWidth",2)("diameter",20))}function es(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",8),e._uU(2),e.YNc(3,Wa,2,0,"span",21),e.qZA(),e.TgZ(4,"div",9),e._uU(5),e.qZA(),e.TgZ(6,"div",9)(7,"div",22)(8,"span"),e._uU(9),e.qZA(),e.YNc(10,$a,3,4,"span",23),e.qZA()(),e.TgZ(11,"div",9)(12,"div",24)(13,"mat-icon",25),e.NdJ("click",function(r){const d=e.CHM(t).$implicit,u=e.oxw();return r.stopPropagation(),e.KtG(u.showCommentDialog(null==d?null:d.notes,d))}),e.qZA(),e.YNc(14,ao,1,0,"div",26),e.qZA(),e.YNc(15,Xa,4,2,"div",27),e.qZA(),e.TgZ(16,"div",28),e.YNc(17,gr,1,3,"span",29),e.YNc(18,lo,1,0,"span",30),e.YNc(19,Rc,4,2,"div",27),e._uU(20),e.ALo(21,"translate"),e.qZA()()}if(2&a){const t=c.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.isMandatory),e.xp6(2),e.Oqu(t.repairTypeNames),e.xp6(4),e.Oqu(t.completedDate?t.completedBy:t.modifiedBy),e.xp6(1),e.Q6J("ngIf",t.updatedDate),e.xp6(3),e.Q6J("svgIcon","comment"),e.xp6(1),e.Q6J("ngIf",null==t?null:t.notes),e.xp6(1),e.Q6J("ngIf",t.isNoteLoading),e.xp6(2),e.Q6J("ngIf",t.completedDate&&!t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.completedDate&&!t.isLoading),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.hij(" ",e.lcZ(21,12,t.isLoading?"updating_task":"task_done")," ")}}function co(a,c){1&a&&(e.TgZ(0,"div",40)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&a&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"no_repair_tasks_available")))}function ts(a,c){if(1&a&&e._UZ(0,"chq-button",42),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.notifyButtonModel)}}function fr(a,c){if(1&a&&e._UZ(0,"chq-button",42),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.addPartButtonModel)}}function Lc(a,c){if(1&a&&(e.ynx(0),e.YNc(1,ts,1,1,"chq-button",41),e.YNc(2,fr,1,1,"chq-button",41),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.activateNotifyButton&&!t.commonService.isViewOnly&&t.notifyData.communicationList.length>0),e.xp6(1),e.Q6J("ngIf","go_invoice"===t.addPartButtonModel.label||!t.commonService.isViewOnly)}}let ns=(()=>{class a{constructor(t,n,r,s,d){this.monitorService=t,this.dialog=n,this.bookingService=r,this.translateService=s,this.commonService=d,this.updateJobs=new e.vpe,this.confirmJob=new e.vpe,this.taskList=[],this.mandatoryTasks=0,this.allMandatoryTasks=0,this.notifyButtonModel={label:"notify",type:"outline",icon:"send",onclick:this.openNotify.bind(this)},this.addPartButtonModel={label:"Complete Repair",type:"disabled",onclick:this.completeJob.bind(this)}}openNotify(){this.dialog.open(Gn.b,{data:{repairGuid:this.notifyData.repairGuid,domainId:this.notifyData.domainId,templateId:1,communicationList:this.notifyData.communicationList,communicatedList:this.notifyData.communicatedList,method:"notifier"},backdropClass:"confirmation-popup-backdrop",maxHeight:"693px",maxWidth:"629px"}).afterClosed().subscribe({next:n=>{n?.notifySend&&(console.log(n),n.selectedCommunication&&n.selectedCommunication.forEach(r=>{this.notifyData.communicatedList.push({id:0,eventName:n.templateKey,communicationTypeId:r})}),this.commonService.showInfoToast(1e3,"Message sent"))}})}completeJob(){this.confirmJob.emit()}ngOnChanges(t){this.monitorService.logEvent("ngOnChanges",["ChqEstimateDetailsComponent","addenda-repair"]),t&&(this.activateNotifyButton&&t.repairStatus&&t.repairStatus.currentValue&&(this.activateNotifyButton="repairinprogress"===t.repairStatus.currentValue.toLowerCase()),t.repairDataMappings&&t.repairDataMappings.currentValue&&(this.taskList=[...this.repairDataMappings.repairJobTasks],this.taskList.forEach(r=>{const s=r.repairJobMappings.map(d=>d.repairServiceTypeName);r.repairTypeNames=s.join(", ")}),this.mandatoryTasks=this.taskList.filter(r=>!0===r.isMandatory&&"Completed"!==r.statusName).length,this.allMandatoryTasks=this.taskList.filter(r=>!0===r.isMandatory).length),t.activateRepairButton&&t.activateRepairButton.currentValue&&(this.addPartButtonModel={...this.addPartButtonModel,type:"primary"}),["readytoinvoice","invoiced","paid","complete"].includes(this.repairStatus?.toLowerCase())&&this.activateRepairButton&&(this.addPartButtonModel={...this.addPartButtonModel,label:"go_invoice"}),setTimeout(()=>{this.mandatoryTasks=this.taskList.filter(r=>!0===r.isMandatory&&"Completed"!==r.statusName).length}))}ngOnInit(){this.repairDataMappings&&(this.taskList=[...this.repairDataMappings.repairJobTasks],this.taskList.forEach(t=>{const n=t.repairJobMappings.map(r=>r.repairServiceTypeName);t.repairTypeNames=n.join(", ")}),this.mandatoryTasks=this.taskList.filter(t=>!0===t.isMandatory&&"Completed"!==t.statusName).length,this.allMandatoryTasks=this.taskList.filter(t=>!0===t.isMandatory).length),"readytoinvoice"===this.repairStatus?.toLowerCase()&&this.activateRepairButton&&(this.addPartButtonModel={...this.addPartButtonModel,label:"go_invoice"})}updateTaskStatus(t){if(!this.commonService.isViewOnly){if(!this.repairDataMappings.startDate)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_comment")).afterClosed().subscribe();if(this.repairDataMappings?.timerLog?.statusName===Re.Pause)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_pause_comment")).afterClosed().subscribe();if(!this.repairDataMappings.startDate)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_comment")).afterClosed().subscribe();if(this.repairDataMappings.endDate)return void this.commonService.openAlertDialog(this.translateService.instant("cannot_update_status"),this.translateService.instant("job_completed")).afterClosed().subscribe();if(this.mandatoryTasks<=1&&t.isMandatory&&!t.completedDate)return t.isLoading=!0,void this.commonService.openConfirmationOkDialog(this.translateService.instant("confirm_action"),this.translateService.instant("job_no_mandatory_task")).afterClosed().subscribe(r=>{r?this.bookingService.updateRepairTaskStatus(t.repairTaskGuid,this.repairDataMappings.repairJobGuid,t.completedDate?ht.NotStarted:ht.Completed).subscribe({next:()=>{t.completedDate=t.completedDate?null:new Date,this.mandatoryTasks--,this.updateJobs.emit(),t.isLoading=!1},error:()=>{t.isLoading=!1}}):t.isLoading=!1});t.isLoading=!0,this.bookingService.updateRepairTaskStatus(t.repairTaskGuid,this.repairDataMappings.repairJobGuid,t.completedDate?ht.NotStarted:ht.Completed).subscribe({next:()=>{t.completedDate=t.completedDate?null:new Date,this.updateJobs.emit(),t.isLoading=!1},error:()=>{t.isLoading=!1}})}}showCommentDialog(t,n){let r="";t&&(r=t),this.monitorService.logEvent("showCommentDialog",["CommentDialogComponent","addenda-repair"]),this.dialog.open(Ka.E,{data:{notes:r},panelClass:"comment-modalbox",autoFocus:!1}).afterClosed().subscribe({next:s=>{s&&(s.delete&&(s.comment=""),n.isNoteLoading=!0,this.bookingService.updateRepairTaskNotes(this.repairDataMappings.repairJobGuid,s.comment,n.repairTaskGuid).subscribe({next:()=>{n.notes=s.comment,this.updateJobs.emit(),n.isNoteLoading=!1},error:()=>{n.isNoteLoading=!1}}))}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(we.M),e.Y36(xe.uw),e.Y36(Dt.q),e.Y36(pe.sK),e.Y36(be.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["repair-stages-table"]],inputs:{repairDataMappings:"repairDataMappings",notifyData:"notifyData",activateRepairButton:"activateRepairButton",activateNotifyButton:"activateNotifyButton",repairStatus:"repairStatus"},outputs:{updateJobs:"updateJobs",confirmJob:"confirmJob"},features:[e.TTD],decls:33,vars:20,consts:[[1,"card"],[1,"card-header"],[1,"title"],[1,"card-body"],[1,"wrapper"],[1,"header-wrapper"],["class","mandatory-div",4,"ngIf"],[1,"header","row","header-repair"],[1,"col-4"],[1,"col-2"],[1,"data-wrapper"],["class","data-row row",4,"ngFor","ngForOf"],["class","wrapper error-wrapper",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[4,"chqPermission"],[1,"mandatory-div"],[1,"mandatory-text","text-danger"],[1,"data-row","row"],["class","text-danger",4,"ngIf"],[1,"wrapper-span"],["class","span-date",4,"ngIf"],[1,"comment-div"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon","click"],["class","red-icon",4,"ngIf"],["class","loading",4,"ngIf"],[1,"col-2","relate-spinner"],["class","checked",3,"ngClass","click",4,"ngIf"],["class","circle",3,"click",4,"ngIf"],[1,"text-danger"],[1,"span-date"],[1,"red-icon"],[1,"loading"],[1,"overlay"],[1,"spinner"],[3,"strokeWidth","diameter"],[1,"checked",3,"ngClass","click"],[1,"circle",3,"click"],[1,"wrapper","error-wrapper"],["class","submit-button",3,"buttonModel",4,"ngIf"],[1,"submit-button",3,"buttonModel"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"div",5),e.YNc(7,Ac,4,3,"div",6),e.TgZ(8,"div",7)(9,"div",8),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",9),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",9),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",9),e._uU(22),e.ALo(23,"translate"),e.qZA()()(),e.TgZ(24,"div",10),e.YNc(25,es,22,14,"div",11),e.YNc(26,co,4,3,"div",12),e.qZA()()(),e.TgZ(27,"div",13)(28,"div",14)(29,"div",15),e._UZ(30,"img",16),e.qZA()(),e.TgZ(31,"div",14),e.YNc(32,Lc,3,2,"ng-container",17),e.qZA()()()),2&t&&(e.xp6(3),e.Oqu(null==n.repairDataMappings?null:n.repairDataMappings.name),e.xp6(4),e.Q6J("ngIf",n.allMandatoryTasks>0),e.xp6(3),e.Oqu(e.lcZ(11,10,"item_name")),e.xp6(3),e.Oqu(e.lcZ(14,12,"repair_type")),e.xp6(3),e.Oqu(e.lcZ(17,14,"modified_by")),e.xp6(3),e.Oqu(e.lcZ(20,16,"notes")),e.xp6(3),e.Oqu(e.lcZ(23,18,"status")),e.xp6(3),e.Q6J("ngForOf",n.taskList),e.xp6(1),e.Q6J("ngIf",n.taskList&&0===n.taskList.length),e.xp6(6),e.Q6J("chqPermission","newBooking"))},dependencies:[f.mk,f.sg,f.O5,He.E,Le.Hw,kn.A,Bn.Ou,f.uU,pe.X$],styles:['.card[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:10px;flex:none;order:0;align-self:stretch;flex-grow:0}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;justify-content:space-between;align-items:center;padding:calc(5px + .5vw);padding-left:30px;height:35px;background:var(--xa-secondary);border-radius:10px 10px 0 0}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:20px;line-height:25px;color:var(--xa-white)}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-weight:500}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]{min-height:60px!important;display:flex;align-items:center}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:12px;line-height:35px;display:flex;align-items:center;color:var(--xa-black-medium)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{padding-left:40px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;background:var(--xa-table-header-light)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:12px;font-weight:500;line-height:35px;letter-spacing:-.25px;height:36px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--xa-black);font-size:12px;font-weight:400;line-height:14px;align-items:center;display:flex}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]{padding:14px 0}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{padding-left:30px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   .comment-div[_ngcontent-%COMP%]{position:relative}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   .comment-div[_ngcontent-%COMP%]   .red-icon[_ngcontent-%COMP%]{height:7px;width:7px;position:absolute;background:var(--xa-red);top:3px;right:-1px;border-radius:50%;border:2px solid var(--xa-white)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{border:none;font-style:normal;font-weight:700;font-size:11px;line-height:35px;color:var(--xa-black)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .image-text[_ngcontent-%COMP%]{display:flex;align-items:center;gap:calc(5px + .5vw)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .image-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{background:white;padding:0 10px;border-radius:19px;text-transform:capitalize;width:90px;height:20px;font-style:normal;font-size:10px;line-height:10px;display:flex;align-items:center;color:#0b0e15;flex:none;order:0;flex-grow:0;justify-content:center;font-weight:500}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.assigned[_ngcontent-%COMP%]{background:#76D672}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.readyforinvoice[_ngcontent-%COMP%]{background:#B3E573}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.noshow[_ngcontent-%COMP%]{background:#B53E3E;color:#fff}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.pickedup[_ngcontent-%COMP%]{background:#E8DA18}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.likelyouttoday[_ngcontent-%COMP%]{background:#B3E573}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]:nth-child(even){background-color:var(--xa-white-light);margin-right:0;margin-left:0}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--xa-table-light);margin-right:0;margin-left:0}.header-text[_ngcontent-%COMP%]{color:var(--xa-black);font-size:13px;font-weight:700;line-height:35px;letter-spacing:-.25px}.checked[_ngcontent-%COMP%]{border:1px solid var(--xa-repair-header);background-color:var(--xa-repair-header);border-radius:50%;height:20px;width:20px;position:relative;cursor:pointer;margin-right:4px}.circle[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray);background-color:var(--xa-light-radio-gray);border-radius:50%;height:20px;width:20px;position:relative;cursor:pointer;margin-right:4px}.mandatory-div[_ngcontent-%COMP%]{margin-top:10px}.mandatory-text[_ngcontent-%COMP%]{font-size:12px;font-weight:700;padding-left:30px;line-height:20px}.checked[_ngcontent-%COMP%]:after{content:"";position:absolute}.span-date[_ngcontent-%COMP%]{font-size:10px;line-height:14px;font-weight:300}.wrapper-span[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;align-items:flex-start!important;justify-content:center!important;width:100%}.wrapper-span[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;display:block;word-wrap:break-word;width:100%}.checked[_ngcontent-%COMP%]:after{left:7px;top:3px;width:4px;height:10px;border:solid var(--xa-white);border-width:0 3px 3px 0;transform:rotate(45deg)}.submit-button[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:20px}.relate-spinner[_ngcontent-%COMP%]{position:relative}.loading[_ngcontent-%COMP%]{margin-left:4px}.error-wrapper[_ngcontent-%COMP%]{padding:12px;justify-content:center}.error-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-align:center}.not-allowed[_ngcontent-%COMP%]{cursor:not-allowed}']}),a})();var Ut=k(39912),is=k(62119),os=k(9988),Ec=k(54135);const rs=["addPhotos"],qc=["imageUploaders"];function Zc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"add-photos",10,11),e.NdJ("notify",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.notify.emit())})("completeRepair",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.completeRepair.emit())})("mode",function(r){e.CHM(t);const s=e.oxw(3);return e.KtG(s.handleMode(r))}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("caseData",t.caseData)("caseNumber",t.photosHeader.caseNumber)("repairUnapproved",t.isInvalidStatus)("showSPI",t.showSPI)("photosHeader",t.addPhotosHeader)("showComplete",!0)("isRepairComplete",t.isRepairComplete)("showNotify",t.showNotify)("activateRepairButton",t.activateRepairButton)("hideBulk",t.hideBulk)("hidden",t.hideContent)("showEstimate",!1)}}function Jt(a,c){1&a&&(e.TgZ(0,"div",12)(1,"div",13),e._UZ(2,"img",14),e.TgZ(3,"label",15),e._uU(4," No Content Available "),e.qZA()(),e.TgZ(5,"div",16),e._UZ(6,"div",17)(7,"div",17)(8,"div",17)(9,"div",17),e.qZA()())}function _r(a,c){if(1&a&&(e.TgZ(0,"div",18)(1,"div",19)(2,"div",20),e._UZ(3,"img",21),e.qZA()()()),2&a){const t=e.oxw(3);e.xp6(3),e.MGl("src","assets/img/",+t.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",e.LSH)}}function vr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-images-uploader",22,23),e.NdJ("handleDeleteAllEvent",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.handleDeleteAll())})("backToUpload",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.setInitialMode())})("updateMassUpload",function(r){e.CHM(t);const s=e.oxw(3);return e.KtG(s.updateCurrentStatus(r))})("notify",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.notify.emit())})("completeRepair",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.completeRepair.emit())}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("maximumImages",t.minimumImageJob)("hideAI",!t.displayAI)("hidden",t.showDamageAnalysis||!t.showUploading)("currentAdditionalModeMultiple",t.currentAdditionalModeMultiple)("fileUploaderService",t.currentObservable)("footerOptions",t.footer)("isRepairStage",!0)("isMassUpload",t.isMultipleUpload)("showReTakeDelete",!0)("imageStatusSteps",t.imageStatusSteps)("header",t.photosHeader)("inspectionId",t.inspectionId)("inspection","photos")("isRepairComplete",t.isRepairComplete)("showComplete",!0)("showNotify",t.showNotify)("activateRepairButton",t.activateRepairButton)}}function br(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"damage-analysis",24),e.NdJ("backEvent",function(r){e.CHM(t);const s=e.oxw(3);return e.KtG(s.handleBack(r))}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("isBulkUpload",t.isMultipleUpload)("minPhotoRequired",t.minimumPhotosRequired)("caseDetail",t.partialCaseDetail||t.repairDetail)("steps",t.imageStatusSteps)("isRepairStage",!0)("isRepairModule",t.photosHeader.isRepairModule)("jobId",t.objectId)}}function po(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Zc,2,12,"add-photos",5),e.YNc(2,Jt,10,0,"div",6),e.YNc(3,_r,4,1,"div",7),e.YNc(4,vr,2,17,"chq-images-uploader",8),e.YNc(5,br,1,7,"damage-analysis",9),e.BQk()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!1===t.showUploading),e.xp6(1),e.Q6J("ngIf",t.noImagesData),e.xp6(1),e.Q6J("ngIf",t.noImagesData),e.xp6(1),e.Q6J("ngIf",(t.showSPI||!t.hideBulk)&&(!0===t.showUploading||t.isMultipleUpload||t.imageStatusSteps&&t.imageStatusSteps.length>0)),e.xp6(1),e.Q6J("ngIf",t.showDamageAnalysis)}}const Yn=function(a){return{"photo-container":a}};function F(a,c){if(1&a&&(e.TgZ(0,"div",3),e.YNc(1,po,6,5,"ng-container",4),e.qZA()),2&a){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,Yn,t.photosHeader.isRepairModule)),e.xp6(1),e.Q6J("chqPermission","repairStages")}}function uo(a,c){1&a&&e._UZ(0,"no-access-error")}const Cr={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let vn=(()=>{class a{constructor(t,n,r,s,d,u,v,P,y,w){this.cd=t,this.commonService=n,this.route=r,this.router=s,this.caseService=d,this.monitorService=u,this.inspectionService=v,this.bookingService=P,this.translateService=y,this.estimateService=w,this.photosHeader=Cr,this.currentUploadMode=new e.vpe,this.noImagesData=!1,this.imageStatusSteps=[],this.showUploading=!1,this.isMultipleUpload=!1,this.triggerMassUpload=!1,this.caseStatus="",this.caseId="0",this.bookingId="",this.maximumImages=20,this.setStatus=new e.vpe,this.notify=new e.vpe,this.completeRepair=new e.vpe,this.minimumPhotosRequired=0,this.hideContent=!0,this.currentAdditionalModeMultiple=!1,this.hideUploaders=!1,this.repairTypes=[],this.repairType="",this.repairId="",this.currentRepairStatus="",this.originalSteps=[],this.showNoAccess=!1,this.footer={text:"Next create estimate",icon:"boardview",route:"case/gt",status:"UploadPhotos",caseId:"",currentStatus:"",showButton:!0,showUploadOption:!0,section:"repair-stage"},n.pageName.closed&&(n.pageName=new Ct.X(null)),n.pageName.next("photos"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new Ct.X(!0))}handleBack(t){this.showDamageAnalysis=!t.back}get checkRepairTypes(){return-1===location.href.indexOf("repair")||"repair"!==this.repairType||this.repairTypes.filter(t=>"Body"===t.repairServiceType||"Paint"===t.repairServiceType).length>0}updateCurrentStatus(t){this.monitorService.logEvent("updateCurrentStatus",["RepairPhotosComponent","addenda-quote",{caseId:t}]),t.initial?this.setInitialMode():(this.showUploading=!0,this.uploadBulkUploadFile(t.steps))}handleDeleteAll(){this.setInitialMode()}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","photos"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["RepairPhotosComponent","addenda-quote"])}uploadBulkUploadFile(t){for(let n=0;n<t?.length;n++){const r=new Image;r.src=t[n].image,r.onload=()=>{const s={height:r.height,width:r.width,inspectionId:this.inspectionId,templateId:this.inspectionBulkTemplateId,type:this.vehicelType||"",isBulk:!0,isSPI:!1,domainId:3100,objectId:this.objectId},d=t[n];d.uploadInProgress=!0,d.isSkipped=!1,d.isUploadFailed=!1,d.isUploadSuccess=!1,this.monitorService.logEvent("uploadBulkUploadFile",["RepairPhotosComponent","addenda-quote",{uploadObject:s}]),this.inspectionService.uploadImageBulkJob(s,d.imageFile).subscribe({next:u=>{d.url=u.rawImage?.rawAzureBlobUrl,d.inspectionItem=u,d.procedureSteps="Bulk Upload Image",this.imageUploaders.updateUploadStatus("success",d,null,u),this.footer={...this.footer,showUploadOption:!1}},error:u=>{401!=u.status&&(this.imageUploaders.imageStatusSteps=this.imageUploaders.imageStatusSteps.filter(v=>v.index!==d.index||v.stepName!==d.stepName||!0!==v.uploadInProgress),this.imageUploaders.updateUploadStatus("failed",d,u,null,!0)),this.monitorService.logException(u,_e._.Error)}})}}}uploadFile(t){const n={height:t.imageHeight,width:t.imageWidth,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,inspectionitemId:t.inspectionItem.id,type:this.vehicelType||"",isBulk:!1,isSPI:!0,domainId:3100,objectId:this.objectId};this.monitorService.logEvent("uploadFile",["RepairPhotosComponent","addenda-quote",{uploadObject:n}]),t.uploadInProgress=!0,t.isSkipped=!1,t.isUploadFailed=!1,t.isUploadSuccess=!1,this.commonService.inProgressSteps.next(1),this.footer={...this.footer,showUploadOption:!1},this.commonService.showNotification(this.translateService.instant("photos_upload",{value:t.stepName})),this.inspectionService.uploadImageBulkJob(n,t.imageFile).subscribe({next:r=>{this.commonService.showNotification(this.translateService.instant("photos_upload_success",{value:t.stepName}));const d=this.inspectionItemTemplates.find(u=>u.inspectionItem.id==r?.id);d.inspectionItem.rawAzureBlobUrl=r.rawImage?.rawAzureBlobUrl,d&&(t.url=r.rawImage?.rawAzureBlobUrl,this.imageUploaders.updateUploadStatus("success",t,null,r))},error:r=>{401!=r.status&&(this.commonService.showNotification(this.translateService.instant("photo_upload_error",{value:t.stepName})),this.imageUploaders.updateUploadStatus("failed",t,r),this.monitorService.logException(r,_e._.Error))}})}ngOnDestroy(){this.commonService.pageName.unsubscribe(),this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["RepairPhotosComponent","addenda-quote"])}mapInspection(t){if(t)try{this.inspection=t,this.uploadType=this.inspection.uploadType;let n="SPI";this.uploadType&&(this.footer={...this.footer,showUploadOption:!1}),"Bulk"===this.uploadType&&(n="BULK");const r=this.inspectionTemplates.filter(d=>"Bulk Upload Image"===d.name),s=this.inspection.inspectionItems.filter(d=>("Bulk Upload Image"===d.name||d.inspectionItemTemplateID===r[0].id)&&d.rawAzureBlobUrl);if(s?.length>0||"Bulk"===this.uploadType){const d=[];this.currentUploadMode.emit({mode:"multiple"});for(const u in s){const v={...r[0],name:s[u].name||r[0].name,inspectionItem:s[u]};d.push(v)}this.inspectionItemTemplates=d}else this.currentUploadMode.emit({mode:"single"}),this.inspectionTemplates.map(d=>{const u=this.inspection.inspectionItems.find(v=>v.inspectionItemTemplateID==d.id);u&&(d.inspectionItem=u)}),this.inspectionItemTemplates=this.inspectionTemplates.filter(d=>"Bulk Upload Image"!=d.name);r?.length>0&&(this.inspectionBulkTemplateId=r[0].id),this.inspectionItemTemplates.map(d=>{d.inspectionItem?.rawAzureBlobUrl?(d.isUploadSuccess=!0,d.image=d.inspectionItem?.rawAzureBlobUrl):(d.inspectionItem||(d.inspectionItem={rawAzureBlobUrl:""}),d.inspectionItem.rawAzureBlobUrl="",d.isUploadFailed=!1,d.isUploadSuccess=!1,d.uploadInProgress=!1)}),this.uploadType&&("SPI"===n?(this.isMultipleUpload=!1,this.showUploading=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader={...this.photosHeader,title:"back_smart_photo"}),this.minimumPhotosRequired=this.minimumImageJob||this.inspectionItemTemplates.filter(d=>!0!==d.isSkipEnabled).length,this.currentObservable=this.uploadFile.bind(this)):(this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.minimumPhotosRequired=this.minimumImageJob||this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!0,this.isBulkUploaded=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader={...this.photosHeader,title:"bulk_upload"})))}catch(n){console.log(n)}}getInspectionTemplateByObject(){for(let t=0;t<this.inspectionItemTemplates?.length;t++){const n=this.inspectionItemTemplates[t],r=(0,X.A1)(n,t),s=-1!=r.stepName?.toLowerCase().indexOf("additional photo"),d=-1!=r.stepName?.toLowerCase().indexOf("bulk upload image"),u=s&&!r.url;this.imageStatusSteps.push({...r,mandatory:!n.isSkipEnabled,index:t,isAdditionalDocumentFromReviewPageOnly:u,isMassUpload:d,updatedDate:r.url?n?.inspectionItem?.updatedDate:"",uploadedDate:r.url?n?.inspectionItem?.created:"",domainId:this.domainId,objectId:this.objectId,uploadedPartGuid:"",uploadedGuid:""})}}createInspectionForJob(t,n,r){this.inspectionService.createInspectionItemJobDetail({objectId:t,inspectionId:n,templateId:r}).subscribe({next:d=>{const u=d.data;this.uploadType=d.data.uploadType,this.mapInspection(u),setTimeout(()=>{if(this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.isJobLoading=!1,this.uploadType)this.imageUploaders.goToReview();else{if(this.showSPI&&this.hideBulk)return void this.addPhotos.allowSingleUpload();!this.showSPI&&!this.hideBulk&&this.addPhotos.allowMultipleUpload()}}),this.commonService.hideLoading()},error:()=>{this.isJobLoading=!1,this.noImagesData=!0,this.commonService.hideLoading()}})}loadApiData(){const t={};this.isJobLoading=!0,t.jobDetail=this.inspectionService.getInspectionJobDetail(this.inspectionId,this.objectId),(0,Rn.D)(t).pipe((0,Ln.K)(r=>(0,ct.of)(r))).subscribe({next:r=>{const{jobDetail:s}=r;if(204!==s.status)if(s.body){const d=s.body.data;d&&(this.inspectionDetail=d),this.mapInspection(d),this.getInspectionTemplateByObject(),setTimeout(()=>{if(this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.isJobLoading=!1,this.uploadType)this.imageUploaders.goToReview();else{if(this.showSPI&&this.hideBulk)return void this.addPhotos.allowSingleUpload();!this.showSPI&&!this.hideBulk&&this.addPhotos.allowMultipleUpload()}})}else this.noImagesData=!0,this.commonService.hideLoading();else this.createInspectionForJob(this.objectId,this.inspectionId,this.inspectionTemplateId)},error:()=>{this.noImagesData=!0,this.isJobLoading=!1,this.commonService.hideLoading()}})}ngOnInit(){const t=this.route.parent?.snapshot.paramMap.get("id");this.addPhotosHeader={...this.photosHeader,isHeaderOnly:!1},this.monitorService.logEvent("ngOnInit",["RepairPhotosComponent","addenda-quote",{caseId:t,repairId:t}]),this.footer={...this.footer,caseId:this.photosHeader.isRepairModule?"":t,repairId:this.photosHeader.isRepairModule?t:"",handleBack:this.handleBack.bind(this)},this.commonService.accessRight.subscribe({next:r=>{r||(this.showNoAccess=!0)}}),this.showSPI||!this.hideBulk?this.loadApiData():(this.bookingService.getRepairDetailByGuid(t).subscribe({next:r=>{const{vehicle:s,repairNumber:d,status:u}=r.data;this.setStatus.emit(u),this.repairDetail=r.data,this.inspectionId=s.inspectionId,this.footer={...this.footer,isRepairModule:!0,from:Sn.j.repair},this.commonService.repairDetails.next(r.data),this.commonService.bookingId.next(d)}}),this.hideContent=!1);const n=document.querySelector(".addenda-container");n&&(n.scrollTop=0),this.currentObservable=this.uploadFile.bind(this)}reloadInspection(){this.commonService.showLoading(),this.inspectionId&&this.inspectionService.getInspectionJobDetail(this.inspectionId,this.objectId).subscribe({next:t=>{t&&t.body&&t.body.data&&(this.mapInspection(t.body.data),this.getInspectionTemplateByObject(),this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,setTimeout(()=>{this.hideContent=!1,this.showUploading=!0}))},complete:()=>{this.commonService.hideLoading()}})}setInitialMode(){this.showUploading=!1,this.imageStatusSteps=[],this.triggerMassUpload=!1,this.isBulkUploaded=!1,this.imageUploaders.isReviewSection=!1,this.isMultipleUpload=!1,this.currentAdditionalModeMultiple=!1}handleMode(t){this.monitorService.logEvent("handleMode",["RepairPhotosComponent","addenda-quote",{$event:t}]),this.inspectionId?(this.currentUploadMode.emit(t),"single"===t.mode?(0===this.imageStatusSteps?.length?(this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,this.minimumPhotosRequired=this.minimumImageJob||this.inspectionItemTemplates.filter(n=>!0!==n.isSkipEnabled).length,this.reloadInspection()):(this.isMultipleUpload=!1,this.showUploading=!0,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.minimumPhotosRequired=this.minimumImageJob||this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!1),this.currentObservable=this.uploadFile.bind(this)):(this.imageStatusSteps=[],this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.triggerMassUpload=!0,this.showUploading=!0)):this.currentUploadMode.emit({mode:"error",id:this.bookingId})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.sBO),e.Y36(be.v),e.Y36(ye.gz),e.Y36(ye.F0),e.Y36(Zi.n),e.Y36(we.M),e.Y36(Fi.a),e.Y36(Dt.q),e.Y36(pe.sK),e.Y36(Ai.H))},a.\u0275cmp=e.Xpm({type:a,selectors:[["repair-photos"]],viewQuery:function(t,n){if(1&t&&(e.Gf(rs,5),e.Gf(qc,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.addPhotos=r.first),e.iGM(r=e.CRH())&&(n.imageUploaders=r.first)}},inputs:{photosHeader:"photosHeader",showNotify:"showNotify",displayAI:"displayAI",isInvalidStatus:"isInvalidStatus",activateRepairButton:"activateRepairButton",isRepairComplete:"isRepairComplete",objectId:"objectId",showSPI:"showSPI",minimumImageJob:"minimumImageJob",hideBulk:"hideBulk",inspectionId:"inspectionId",currentInspectionTemplate:"currentInspectionTemplate",repairDetail:"repairDetail",inspectionTemplateId:"inspectionTemplateId",inspectionTemplates:"inspectionTemplates"},outputs:{currentUploadMode:"currentUploadMode",setStatus:"setStatus",notify:"notify",completeRepair:"completeRepair"},decls:3,vars:3,consts:[[3,"showLoading"],[3,"ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass"],[4,"chqPermission"],[3,"caseData","caseNumber","repairUnapproved","showSPI","photosHeader","showComplete","isRepairComplete","showNotify","activateRepairButton","hideBulk","hidden","showEstimate","notify","completeRepair","mode",4,"ngIf"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"maximumImages","hideAI","hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isRepairStage","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","isRepairComplete","showComplete","showNotify","activateRepairButton","handleDeleteAllEvent","backToUpload","updateMassUpload","notify","completeRepair",4,"ngIf"],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairStage","isRepairModule","jobId","backEvent",4,"ngIf"],[3,"caseData","caseNumber","repairUnapproved","showSPI","photosHeader","showComplete","isRepairComplete","showNotify","activateRepairButton","hideBulk","hidden","showEstimate","notify","completeRepair","mode"],["addPhotos",""],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[3,"maximumImages","hideAI","hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isRepairStage","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","isRepairComplete","showComplete","showNotify","activateRepairButton","handleDeleteAllEvent","backToUpload","updateMassUpload","notify","completeRepair"],["imageUploaders",""],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairStage","isRepairModule","jobId","backEvent"]],template:function(t,n){1&t&&(e._UZ(0,"chq-customloader",0),e.YNc(1,F,2,4,"div",1),e.YNc(2,uo,1,0,"no-access-error",2)),2&t&&(e.Q6J("showLoading",n.isJobLoading),e.xp6(1),e.Q6J("ngIf",!n.showNoAccess),e.xp6(1),e.Q6J("ngIf",n.showNoAccess))},dependencies:[f.mk,f.O5,Ut.q,We.h,is.b,os.wm,Ec.U,kn.A],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),a})();const Fc=["basicTimer"],Mr=["repairstagetable"],as=function(a){return{selected:a}};function Ge(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",4),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.setTabActive("photos"))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.VKq(4,as,"photos"===t.currentActiveTab)),e.xp6(1),e.Oqu(e.lcZ(2,2,"photos"))}}function Nc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",16),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.currentJobStarted&&!r.currentJobPaused?r.stopJobTimer():r.startJobTimer())}),e._UZ(1,"mat-icon",15),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("svgIcon",t.currentJobStarted&&!t.currentJobPaused?"stop":"start"),e.xp6(1),e.hij(" ",e.lcZ(3,2,t.currentJobStarted&&!t.currentJobPaused?"Stop Job":t.currentJobPaused?"Continue":"Start Job")," ")}}const Uc=function(a){return{"row-reverse":a}};function ss(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",12),e.YNc(1,Nc,4,4,"div",13),e.TgZ(2,"div",14),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.currentJobPaused?r.stopJobTimer():r.pauseJobTimer())}),e._UZ(3,"mat-icon",15),e.qZA()()}if(2&a){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(3,Uc,t.currentJobStarted&&!t.currentJobStopped)),e.xp6(1),e.Q6J("ngIf",!t.currentJobStopped),e.xp6(2),e.Q6J("svgIcon",!t.currentJobStarted||t.currentJobPaused||t.currentJobStopped?"stop":"pause")}}function Jc(a,c){if(1&a&&e._UZ(0,"cd-timer",19,20),2&a){const t=e.oxw(3);e.Q6J("startTime",t.timeDuration)}}function ls(a,c){if(1&a&&(e.TgZ(0,"div",17)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,Jc,2,1,"cd-timer",18),e.qZA()),2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,t.currentJobStopped?"time_spent":"timer")),e.xp6(2),e.Q6J("ngIf",t.currentJobStarted)}}function Gc(a,c){if(1&a&&(e.TgZ(0,"div",9),e.YNc(1,ss,4,5,"div",10),e.YNc(2,ls,5,4,"div",11),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",(null==t.currentJobList?null:t.currentJobList.isTimerEnabled)&&(null==t.currentJobList||null==t.currentJobList.repairJobTasks?null:t.currentJobList.repairJobTasks.length)>0)}}function Bc(a,c){1&a&&(e.TgZ(0,"div",21),e._UZ(1,"mat-icon",22),e.TgZ(2,"p",23),e._uU(3),e.ALo(4,"translate"),e.qZA()()),2&a&&(e.xp6(1),e.Q6J("svgIcon","estimate-no-data"),e.xp6(2),e.hij(" ",e.lcZ(4,2,"no_repair_jobs_defined")," "))}function Yc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"repair-stages-table",27,28),e.NdJ("updateJobs",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.getJobs(!0))})("confirmJob",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.completeJob())}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("repairStatus",t.repairStatus)("activateRepairButton",t.enableCompleteButton)("activateNotifyButton",t.enableNotifyButton)("hidden","photos"===t.currentActiveTab)("repairDataMappings",t.currentJobList)("notifyData",t.notifyData)}}function Gt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"repair-photos",29),e.NdJ("confirmJob",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.completeJob())})("setStatus",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setRepairStatus(r))})("completeRepair",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.completeJob())})("notify",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.repairstagetable.openNotify())})("currentUploadMode",function(r){e.CHM(t);const s=e.oxw(2);return e.KtG(s.handleUpdateMode(r))}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("isInvalidStatus",!t.currentStatus)("inspectionTemplates",t.inspectionTemplates)("currentInspectionTemplate",t.currentInspectionTemplate)("repairDetail",t.repairDetail)("inspectionId",t.inspectionId)("inspectionTemplateId",t.inspectionTemplateId)("minimumImageJob",t.currentJobList.minNumOfPhotos)("showSPI",(null==t.currentJobList?null:t.currentJobList.isUploadPhotosRequired)&&t.currentJobList.isSPIEnabled)("displayAI",t.currentJobList.isAIAnalysisEnabled)("showNotify",t.enableNotifyButton&&!t.commonService.isViewOnly&&(null==t.notifyData||null==t.notifyData.communicationList?null:t.notifyData.communicationList.length)>0)("hideBulk",!(null!=t.currentJobList&&t.currentJobList.isUploadPhotosRequired&&t.currentJobList.isBulkUploadEnabled))("objectId",null==t.currentJobList?null:t.currentJobList.id)("hidden","tasks"===t.currentActiveTab)("activateRepairButton",t.enableCompleteButton)("photosHeader",t.header)("isRepairComplete",t.isRepairComplete)}}function Ve(a,c){if(1&a&&(e.TgZ(0,"div",24),e.YNc(1,Yc,2,6,"repair-stages-table",25),e.YNc(2,Gt,1,16,"repair-photos",26),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.currentJobList),e.xp6(1),e.Q6J("ngIf",t.currentJobList)}}const Pr=function(a,c){return{selected:a,"all-border":c}};let Hc=(()=>{class a{constructor(t,n,r,s,d,u,v){this.bookingService=t,this.commonService=n,this.inspectionService=r,this.router=s,this.translateService=d,this.route=u,this.monitorService=v,this.header={title:"Upload Images",step:0,description:"",stepName:"back_bulk_upload",rightActionText:"delete_all",rightActionIcon:"delete",isRepairModule:!0,showTitle:!0},this.jobList=null,this.currentActiveIndex=0,this.currentJobStarted=!1,this.currentJobStopped=!1,this.currentJobPaused=!1,this.timeDuration=0,this.repairId="",this.currentActiveTab="tasks",this.isJobLoading=!0,this.currentJobList=null,this.menuItems=[],this.repairStatus="",this.isResumed=!1,this.notifyData={},this.outBoundStatus=""}setTabActive(t){this.currentActiveTab=t}startJobTimer(){const t=this.repairDetail?.booking?.startDate;if(E(new Date).diff(E(t),"days")<0)return void this.commonService.showToast(1e3,this.translateService.instant("cannot_start_future_date"));const r=this.currentJobList.repairJobGuid;this.commonService.showLoading(),this.updateJobTimerStatus(r,Re.Start)}get isRepairComplete(){return["readytoinvoice","invoiced","paid","complete"].includes(this.repairStatus?.toLowerCase())}pauseJobTimer(){const t=this.currentJobList.repairJobGuid;this.commonService.showLoading(),this.updateJobTimerStatus(t,Re.Pause)}get currentStatus(){return["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(this.repairStatus?.toLowerCase())}updateJobTimerStatus(t,n){var r=this;if(this.currentJobList?.endDate)return void this.commonService.hideLoading();if(!["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(this.repairStatus?.toLowerCase()))return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("start_job"));const d=this.jobList?.filter(u=>u.startDate&&!u.endDate);if(d&&d?.length>0&&n===Re.Start&&d[0].id!==this.currentJobList.id)return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("job_in_progress",{value:d[0].name}));this.bookingService.updateRepairTimerStatus(t,n).subscribe({next:()=>{let u=!1;if(n===Re.Start)if(this.timeDuration=0,this.currentJobStarted=!0,this.currentJobPaused){this.currentJobPaused=!1;try{this.basicTimer?.resume(),this.isResumed=!0}catch{this.isResumed=!1}}else"repairinprogress"!==this.repairDetail?.status.toLowerCase()&&this.bookingService.getRepairDetailByGuid(this.repairDetail?.repairGuid).subscribe({next:(v=(0,ue.Z)(function*(P){P?.data&&(r.commonService.repairDetails.next(P.data),r.commonService.bookingId.next(P.data.repairNumber))}),function(y){return v.apply(this,arguments)}),error:v=>{this.monitorService.logException(v,_e._.Error)}}),u=!0;else n===Re.Stop?(this.currentJobStopped=!0,this.currentJobPaused&&(this.basicTimer?.stop(),this.currentJobPaused=!1)):(this.basicTimer?.stop(),this.currentJobPaused=!0);var v;this.outBoundStatus="Repair In Progress",this.repairStatus="RepairInProgress",this.getJobs(!0,u)},error:()=>{this.commonService.hideLoading()}})}stopJobTimer(){const t=this.currentJobList.repairJobGuid;if(this.currentJobList.endDate)return;const n=this.currentJobList.repairJobTasks.filter(s=>!1===s.isMandatory&&null===s.completedDate).length;this.currentJobList.repairJobTasks.filter(s=>!0===s.isMandatory&&null===s.completedDate).length>0?this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("cannot_stop_job_date")).afterClosed().subscribe():n>0?this.commonService.openConfirmationOkDialog(this.translateService.instant("confirm_action"),this.translateService.instant("confirm_normal_action")).afterClosed().subscribe(d=>{d?(this.commonService.showLoading(),this.updateJobTimerStatus(t,Re.Stop)):this.commonService.hideLoading()}):(this.commonService.showLoading(),this.updateJobTimerStatus(t,Re.Stop))}loadApiData(t){if(t&&"0"!=t){this.commonService.showLoading();const n={inspectionList:this.inspectionService.getInspectionTemplateList(),repairDetail:this.bookingService.getRepairDetailByGuid(t)};this.isJobLoading=!0,(0,Rn.D)(n).pipe((0,Ln.K)(s=>(0,ct.of)(s))).subscribe({next:s=>{const{inspectionList:d,repairDetail:u}=s;if(u){const{vehicle:w,status:D}=u.data;this.setRepairStatus(D),this.repairDetail=u.data,this.inspectionId=w.inspectionId,this.notifyData={repairGuid:this.repairDetail.repairGuid,domainId:this.repairDetail.domainId,communicationList:this.repairDetail.booking.communicationTypeId,communicatedList:this.repairDetail.communicationEvents}}const v=d?.data;this.outBoundStatus=this.repairDetail.outboundStatus,v?.length>0&&(this.currentInspectionTemplate=v[0],this.inspectionTemplateId=v[0].id);const P={};P.inspectionTemplate=this.inspectionService.getInspectionTemplate(this.inspectionTemplateId),(0,Rn.D)(P).pipe((0,Ln.K)(w=>(0,ct.of)(w))).subscribe({next:w=>{const{inspectionTemplate:D}=w;this.inspectionTemplates=D.inspectionItemTemplates,setTimeout(()=>{this.commonService.repairDetails.next(u.data),this.commonService.bookingId.next(u.data.repairNumber)},100),this.getJobs(),this.isJobLoading=!1},error:()=>{this.commonService.hideLoading(),this.isJobLoading=!1}})},error:()=>{this.isJobLoading=!1}})}}getJobs(t,n){var r=this;const s=this.route.parent?.snapshot.paramMap.get("id");var d;t?this.commonService.hideLoading():this.commonService.showLoading(),this.bookingService.getRepairTask(s).subscribe({next:(d=(0,ue.Z)(function*(u){if(r.jobList=u.data,0===r.jobList?.length)return r.noJobs=!0,void r.commonService.hideLoading();const v=r.jobList.filter(y=>!y.endDate),P=r.jobList.filter(y=>y.startDate);if(r.enableNotifyButton=!1,P?.length>0&&"Repair In Progress"===r.outBoundStatus&&(r.enableNotifyButton=!0),0===v?.length)r.enableCompleteButton=!0;else{let y=!1;v.forEach(w=>{w.repairJobTasks&&w.repairJobTasks.length>0&&w.repairJobTasks.filter(q=>!0===q.isMandatory&&null===q.completedDate).length>0&&(y=!0)}),r.enableCompleteButton=!y}t?r.updateActiveTask(r.currentActiveIndex,n,t):(r.menuItems=r.jobList.map(y=>({name:y.name,icon:"",displayName:y.taskCompletionPercentage,url:"",title:y.name,subTitle:"",color:y.color,permission:!0})),r.setActiveJob(r.menuItems[r.currentActiveIndex])),r.commonService.hideLoading()}),function(v){return d.apply(this,arguments)}),error:()=>{this.noJobs=!0,this.commonService.hideLoading()}})}setRepairStatus(t){this.repairStatus=t}getTime(t){const n=t.split(" ");return 24*parseInt(n[0])*60*60+60*parseInt(n[2])*60+60*parseInt(n[4])+parseInt(n[6])}updateActiveTask(t,n,r){if(this.currentJobList=this.jobList[t],this.currentJobList={...this.currentJobList},this.menuItems[t].displayName=this.currentJobList.taskCompletionPercentage,this.currentJobList?.timerLog){const{startDate:s,endDate:d,statusName:u}=this.currentJobList.timerLog,v=this.currentJobList.totalEffort;let P=0;v&&(P=this.getTime(v));const y=E(new Date),w=E(s);if(this.currentJobStarted=!0,Re.Pause===u)this.currentJobPaused=!0,d&&(this.timeDuration=P,this.isResumed=!1,setTimeout(()=>{this.basicTimer?.stop()}));else if(Re.Stop===u)this.currentJobStopped=!0,d&&(this.timeDuration=P,this.isResumed=!1,setTimeout(()=>{this.basicTimer?.stop()}));else{if(!n&&r||(this.timeDuration=y.diff(w,"seconds")+P,this.timeDuration<0&&(this.timeDuration=0),!n&&this.isResumed))return;setTimeout(()=>{n?this.basicTimer?.start():(r||this.basicTimer?.resume(),this.isResumed=!0)})}}}setActiveJob(t){const n=this.jobList.filter(r=>r.name===t.name);if(n.name!==t.name&&n?.length>0){const r=this.menuItems.findIndex(s=>s.name===t.name);this.menuItems.forEach(s=>{s.active=!1}),t.active=!0,this.currentJobStarted=!1,this.currentJobStopped=!1,this.currentJobPaused=!1,this.timeDuration=0,this.menuItems[r]=t,this.menuItems=[...this.menuItems],this.reinitialize=!0,this.currentJobList=null,this.currentActiveTab="tasks",setTimeout(()=>{if(this.currentActiveIndex=r,this.currentJobList=n[0],this.reinitialize=!1,this.currentJobList?.timerLog){const{startDate:s,endDate:d,statusName:u}=this.currentJobList.timerLog,v=E(new Date),P=E(s),y=this.currentJobList.totalEffort;let w=0;y&&(w=this.getTime(y)),this.currentJobStarted=!0,Re.Pause===u?(this.currentJobPaused=!0,d&&(this.timeDuration=w,this.isResumed=!1,setTimeout(()=>{this.basicTimer.stop()}))):Re.Stop===u?(this.currentJobStopped=!0,d&&(this.timeDuration=w,this.isResumed=!1,setTimeout(()=>{this.basicTimer?.stop()}))):(this.timeDuration=v.diff(P,"seconds")+w,this.timeDuration<0&&(this.timeDuration=0),setTimeout(()=>{this.basicTimer.resume()}))}})}}completeJob(){const t=this.route.parent?.snapshot.paramMap.get("id");this.jobList.filter(s=>s.startDate&&!s.endDate).length>0?this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("stop_job_complete")).afterClosed().subscribe():["readytoinvoice","invoiced","paid","complete"].includes(this.repairStatus?.toLowerCase())?this.router.navigate([`repair/booking/${t}/invoices`]):this.commonService.openConfirmationOkDialog("confirm_completing","complete_repair_process").afterClosed().subscribe({next:s=>{s&&(this.commonService.showLoading(),this.bookingService.updateRepairStatus("ReadytoInvoice",t,"").subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate([`repair/booking/${t}/invoices`])}}))},error:()=>{this.commonService.hideLoading()}})}handleUpdateMode(t){this.header="single"===t.mode?{...this.header,title:"back_smart_photo"}:{...this.header,title:"back_bulk_upload"}}ngOnInit(){const t=this.route.parent?.snapshot.paramMap.get("id");this.loadApiData(t)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Dt.q),e.Y36(be.v),e.Y36(Fi.a),e.Y36(ye.F0),e.Y36(pe.sK),e.Y36(ye.gz),e.Y36(we.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-repair-stages"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Fc,5),e.Gf(Mr,5)),2&t){let r;e.iGM(r=e.CRH())&&(n.basicTimer=r.first),e.iGM(r=e.CRH())&&(n.repairstagetable=r.first)}},decls:11,vars:12,consts:[[3,"menuItems","menuItemClick"],[1,"content-wrapper"],[1,"control-nav"],[1,"switch"],[3,"ngClass","click"],[3,"ngClass","click",4,"ngIf"],["class","time-counter",4,"ngIf"],["class","estimate-details-no-data-found",4,"ngIf"],["class","content",4,"ngIf"],[1,"time-counter"],["class","button-wrapper",3,"ngClass",4,"ngIf"],["class","timer-div",4,"ngIf"],[1,"button-wrapper",3,"ngClass"],["class","start-capsule",3,"click",4,"ngIf"],[1,"stop-capsule",3,"click"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon"],[1,"start-capsule",3,"click"],[1,"timer-div"],[3,"startTime",4,"ngIf"],[3,"startTime"],["basicTimer",""],[1,"estimate-details-no-data-found"],[1,"no-data-svg",3,"svgIcon"],[1,"no-data-text"],[1,"content"],[3,"repairStatus","activateRepairButton","activateNotifyButton","hidden","repairDataMappings","notifyData","updateJobs","confirmJob",4,"ngIf"],[3,"isInvalidStatus","inspectionTemplates","currentInspectionTemplate","repairDetail","inspectionId","inspectionTemplateId","minimumImageJob","showSPI","displayAI","showNotify","hideBulk","objectId","hidden","activateRepairButton","photosHeader","isRepairComplete","confirmJob","setStatus","completeRepair","notify","currentUploadMode",4,"ngIf"],[3,"repairStatus","activateRepairButton","activateNotifyButton","hidden","repairDataMappings","notifyData","updateJobs","confirmJob"],["repairstagetable",""],[3,"isInvalidStatus","inspectionTemplates","currentInspectionTemplate","repairDetail","inspectionId","inspectionTemplateId","minimumImageJob","showSPI","displayAI","showNotify","hideBulk","objectId","hidden","activateRepairButton","photosHeader","isRepairComplete","confirmJob","setStatus","completeRepair","notify","currentUploadMode"]],template:function(t,n){1&t&&(e.TgZ(0,"button-tabs",0),e.NdJ("menuItemClick",function(s){return n.setActiveJob(s)}),e.qZA(),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e.NdJ("click",function(){return n.setTabActive("tasks")}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,Ge,3,6,"div",5),e.qZA(),e.YNc(8,Gc,3,2,"div",6),e.qZA(),e.YNc(9,Bc,5,4,"div",7),e.YNc(10,Ve,3,2,"div",8),e.qZA()),2&t&&(e.Q6J("menuItems",n.menuItems),e.xp6(4),e.Q6J("ngClass",e.WLB(9,Pr,"tasks"===n.currentActiveTab,!(null!=n.currentJobList&&n.currentJobList.isUploadPhotosRequired&&(null!=n.currentJobList&&n.currentJobList.isSPIEnabled||null!=n.currentJobList&&n.currentJobList.isBulkUploadEnabled)))),e.xp6(1),e.Oqu(e.lcZ(6,7,"tasks")),e.xp6(2),e.Q6J("ngIf",(null==n.currentJobList?null:n.currentJobList.isUploadPhotosRequired)&&((null==n.currentJobList?null:n.currentJobList.isSPIEnabled)||(null==n.currentJobList?null:n.currentJobList.isBulkUploadEnabled))),e.xp6(1),e.Q6J("ngIf",(null==n.currentJobList||null==n.currentJobList.repairJobTasks?null:n.currentJobList.repairJobTasks.length)>0),e.xp6(1),e.Q6J("ngIf",n.noJobs&&!n.commonService.isLoading),e.xp6(1),e.Q6J("ngIf",!n.reinitialize))},dependencies:[f.mk,f.O5,kc,Le.Hw,Po,ns,vn,pe.X$],styles:[".content-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray);padding:16px 30px}.control-nav[_ngcontent-%COMP%]{display:flex;gap:46px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]{display:flex;padding:8px 16px;align-items:center;gap:10px;border-radius:10px;margin-bottom:20px;background:var(--xa-bold-gray);color:var(--xa-black-medium);font-size:12px;font-weight:400;line-height:14px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .start-capsule[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer;gap:10px;padding:7px 14px;flex-shrink:0;border-radius:18px;border:1px solid var(--xa-light-gray);background:var(--xa-light-capsule-white)}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .start-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:14px;width:14px;cursor:inherit}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]{border-radius:50%;background:var(--xa-bold-gray);display:flex;align-items:center;justify-content:center;padding:8px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:12px;width:12px;fill:var(--xa-lighter-gray)!important}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray)}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:16px!important;width:16px!important;fill:var(--xa-black)!important}button-tabs[_ngcontent-%COMP%]{display:flex}.button-wrapper[_ngcontent-%COMP%]{display:flex;gap:10px}.timer-div[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.switch[_ngcontent-%COMP%]{display:flex;margin-bottom:18px;align-items:center}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;padding:10px 21px;flex-direction:column;align-items:center;gap:10px;cursor:pointer;color:var(--xa-black);font-size:16px;font-style:normal;font-weight:400;line-height:20px;border:1px solid var(--xa-light-gray);background:var(--xa-popup-light-gray)}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{border-radius:8px 0 0 8px}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{border-radius:0 8px 8px 0}.switch[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:var(--xa-secondary);color:var(--xa-white)}.switch[_ngcontent-%COMP%]   .all-border[_ngcontent-%COMP%]{border-radius:8px!important}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:700}.hide-block[_ngcontent-%COMP%]{display:none!important}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:white;margin:30px;justify-content:center;min-height:calc(100vh - 385px - (53px + 3.1vw));border-radius:12px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:Inter;font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}"]}),a})();var Or=k(20363);const zc=[{path:"",component:ga},{path:"refresh",component:ga},{path:"document",component:Jo,resolve:{version:dn.n}},{path:"photos",component:Vi,resolve:{version:dn.n}},{path:"estimate",component:rl,resolve:{version:dn.n}},{path:"parts",component:Ic,resolve:{version:dn.n}},{path:"repair-stages",component:Hc,resolve:{version:dn.n}},{path:"invoices",component:hr,resolve:{version:dn.n}},{path:"invoicesEdit",component:rc,resolve:{version:dn.n}}];let Qc=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[f.ez,ye.Bz.forChild(zc),Ts.H,ws.m,qr.FA,Le.Ps,Cs,ys.T,Ps,pe.aw,xs.u,Os.K,Di.k,Or.Z,Bn.Cq,cr,ye.Bz,qr.FA,cr]}),a})()},71345:zt=>{var Qt=4,k=.001,e=1e-7,f=10,Rt=11,he=1/(Rt-1),j="function"==typeof Float32Array;function Ne(W,J){return 1-3*J+3*W}function ne(W,J){return 3*J-6*W}function _t(W){return 3*W}function Pn(W,J,oe){return((Ne(J,oe)*W+ne(J,oe))*W+_t(J))*W}function cn(W,J,oe){return 3*Ne(J,oe)*W*W+2*ne(J,oe)*W+_t(J)}function Xe(W){return W}zt.exports=function(J,oe,te,at){if(!(0<=J&&J<=1&&0<=te&&te<=1))throw new Error("bezier x values must be in [0, 1] range");if(J===oe&&te===at)return Xe;for(var H=j?new Float32Array(Rt):new Array(Rt),ge=0;ge<Rt;++ge)H[ge]=Pn(ge*he,J,te);return function(fe){return 0===fe?0:1===fe?1:Pn(function ke(je){for(var fe=0,Ke=1,Vt=Rt-1;Ke!==Vt&&H[Ke]<=je;++Ke)fe+=he;--Ke;var zn=fe+(je-H[Ke])/(H[Ke+1]-H[Ke])*he,yn=cn(zn,J,te);return yn>=k?function On(W,J,oe,te){for(var at=0;at<Qt;++at){var H=cn(J,oe,te);if(0===H)return J;J-=(Pn(J,oe,te)-W)/H}return J}(je,zn,J,te):0===yn?zn:function Tt(W,J,oe,te,at){var H,ge,ke=0;do{(H=Pn(ge=J+(oe-J)/2,te,at)-W)>0?oe=ge:J=ge}while(Math.abs(H)>e&&++ke<f);return ge}(je,fe,fe+he,J,te)}(fe),oe,at)}}},17489:function(zt,Qt,k){var e;zt=k.nmd(zt),function(){var f,he=200,Ne="Expected a function",_t="__lodash_hash_undefined__",cn="__lodash_placeholder__",Tt=1,On=2,Xe=4,W=1,J=2,oe=1,te=2,at=4,H=8,ge=16,ke=32,je=64,fe=128,Ke=256,Vt=512,yn=800,fo=16,jt=1/0,Lt=9007199254740991,wr=17976931348623157e292,Ci=NaN,vt=4294967295,Tr=vt-1,Dr=vt>>>1,Mi=[["ary",fe],["bind",oe],["bindKey",te],["curry",H],["curryRight",ge],["flip",Vt],["partial",ke],["partialRight",je],["rearg",Ke]],xn="[object Arguments]",wn="[object Array]",_s="[object AsyncFunction]",Kt="[object Boolean]",Tn="[object Date]",Vn="[object DOMException]",jn="[object Error]",Kn="[object Function]",_o="[object GeneratorFunction]",bt="[object Map]",Pi="[object Number]",Wn="[object Null]",Et="[object Object]",vo="[object Promise]",Sr="[object Proxy]",$n="[object RegExp]",st="[object Set]",Dn="[object String]",Oi="[object Symbol]",yi="[object Undefined]",Xn="[object WeakMap]",pn="[object ArrayBuffer]",Wt="[object DataView]",ei="[object Float32Array]",bo="[object Float64Array]",xi="[object Int8Array]",Ir="[object Int16Array]",Co="[object Int32Array]",wi="[object Uint8Array]",Ti="[object Uint8ClampedArray]",ti="[object Uint16Array]",Mo="[object Uint32Array]",kr=/\b__p \+= '';/g,bs=/\b(__p \+=) '' \+/g,Ar=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Rr=/&(?:amp|lt|gt|quot|#39);/g,Lr=/[&<>"']/g,Er=RegExp(Rr.source),pp=RegExp(Lr.source),Cs=/<%-([\s\S]+?)%>/g,qr=/<%([\s\S]+?)%>/g,Le=/<%=([\s\S]+?)%>/g,ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pe=/^\w*$/,Ms=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Po=/[\\^$.*+?()[\]{}|]/g,Ps=RegExp(Po.source),Di=/^\s+/,Os=/\s/,dn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ys=/\{\n\/\* \[wrapped with (.+)\] \*/,xs=/,? & /,ws=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ts=/[()=,{}\[\]\/\s]/,ue=/\\(\\)?/g,Ct=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ee=/\w*$/,xe=/^[-+]0x[0-9a-f]+$/i,un=/^0b[01]+$/i,we=/^\[object .+?Constructor\]$/,Zr=/^0o[0-7]+$/i,T=/^(?:0|[1-9]\d*)$/,Ds=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Si=/($^)/,Fr=/['\n\r\u2028\u2029\\]/g,ni="\\ud800-\\udfff",Oo="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",_e="\\u2700-\\u27bf",Sn="a-z\\xdf-\\xf6\\xf8-\\xff",be="A-Z\\xc0-\\xd6\\xd8-\\xde",Mt="\\ufe0e\\ufe0f",He="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ks="["+ni+"]",Nr="["+He+"]",ki="["+Oo+"]",Ur="\\d+",As="["+_e+"]",Jr="["+Sn+"]",Gr="[^"+ni+He+Ur+_e+Sn+be+"]",wo="\\ud83c[\\udffb-\\udfff]",Br="[^"+ni+"]",To="(?:\\ud83c[\\udde6-\\uddff]){2}",Do="[\\ud800-\\udbff][\\udc00-\\udfff]",In="["+be+"]",Hr="(?:"+Jr+"|"+Gr+")",Ls="(?:"+In+"|"+Gr+")",zr="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",So="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Qr="(?:"+ki+"|"+wo+")?",Io="["+Mt+"]?",Vr=Io+Qr+"(?:\\u200d(?:"+[Br,To,Do].join("|")+")"+Io+Qr+")*",Fs="(?:"+[As,To,Do].join("|")+")"+Vr,Ns="(?:"+[Br+ki+"?",ki,To,Do,ks].join("|")+")",Us=RegExp("['\u2019]","g"),Js=RegExp(ki,"g"),ko=RegExp(wo+"(?="+wo+")|"+Ns+Vr,"g"),Gs=RegExp([In+"?"+Jr+"+"+zr+"(?="+[Nr,In,"$"].join("|")+")",Ls+"+"+So+"(?="+[Nr,In+Hr,"$"].join("|")+")",In+"?"+Hr+"+"+zr,In+"+"+So,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ur,Fs].join("|"),"g"),Bs=RegExp("[\\u200d"+ni+Oo+Mt+"]"),Ys=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ao=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Hs=-1,X={};X[ei]=X[bo]=X[xi]=X[Ir]=X[Co]=X[wi]=X[Ti]=X[ti]=X[Mo]=!0,X[xn]=X[wn]=X[pn]=X[Kt]=X[Wt]=X[Tn]=X[jn]=X[Kn]=X[bt]=X[Pi]=X[Et]=X[$n]=X[st]=X[Dn]=X[Xn]=!1;var le={};le[xn]=le[wn]=le[pn]=le[Wt]=le[Kt]=le[Tn]=le[ei]=le[bo]=le[xi]=le[Ir]=le[Co]=le[bt]=le[Pi]=le[Et]=le[$n]=le[st]=le[Dn]=le[Oi]=le[wi]=le[Ti]=le[ti]=le[Mo]=!0,le[jn]=le[Kn]=le[Xn]=!1;var js={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ks=parseFloat,Ws=parseInt,jr="object"==typeof global&&global&&global.Object===Object&&global,$s="object"==typeof self&&self&&self.Object===Object&&self,Ae=jr||$s||Function("return this")(),Kr=Qt&&!Qt.nodeType&&Qt,E=Kr&&zt&&!zt.nodeType&&zt,Ai=E&&E.exports===Kr,Ri=Ai&&jr.process,et=function(){try{return E&&E.require&&E.require("util").types||Ri&&Ri.binding&&Ri.binding("util")}catch{}}(),Wr=et&&et.isArrayBuffer,Ro=et&&et.isDate,$r=et&&et.isMap,kn=et&&et.isRegExp,Xr=et&&et.isSet,ea=et&&et.isTypedArray;function tt(C,x,O){switch(O.length){case 0:return C.call(x);case 1:return C.call(x,O[0]);case 2:return C.call(x,O[0],O[1]);case 3:return C.call(x,O[0],O[1],O[2])}return C.apply(x,O)}function Xs(C,x,O,L){for(var G=-1,ie=null==C?0:C.length;++G<ie;){var De=C[G];x(L,De,O(De),C)}return L}function lt(C,x){for(var O=-1,L=null==C?0:C.length;++O<L&&!1!==x(C[O],O,C););return C}function el(C,x){for(var O=null==C?0:C.length;O--&&!1!==x(C[O],O,C););return C}function ta(C,x){for(var O=-1,L=null==C?0:C.length;++O<L;)if(!x(C[O],O,C))return!1;return!0}function $t(C,x){for(var O=-1,L=null==C?0:C.length,G=0,ie=[];++O<L;){var De=C[O];x(De,O,C)&&(ie[G++]=De)}return ie}function Li(C,x){return!(null==C||!C.length)&&An(C,x,0)>-1}function Lo(C,x,O){for(var L=-1,G=null==C?0:C.length;++L<G;)if(O(x,C[L]))return!0;return!1}function me(C,x){for(var O=-1,L=null==C?0:C.length,G=Array(L);++O<L;)G[O]=x(C[O],O,C);return G}function Xt(C,x){for(var O=-1,L=x.length,G=C.length;++O<L;)C[G+O]=x[O];return C}function Eo(C,x,O,L){var G=-1,ie=null==C?0:C.length;for(L&&ie&&(O=C[++G]);++G<ie;)O=x(O,C[G],G,C);return O}function tl(C,x,O,L){var G=null==C?0:C.length;for(L&&G&&(O=C[--G]);G--;)O=x(O,C[G],G,C);return O}function qo(C,x){for(var O=-1,L=null==C?0:C.length;++O<L;)if(x(C[O],O,C))return!0;return!1}var nl=ct("length");function na(C,x,O){var L;return O(C,function(G,ie,De){if(x(G,ie,De))return L=ie,!1}),L}function Ei(C,x,O,L){for(var G=C.length,ie=O+(L?1:-1);L?ie--:++ie<G;)if(x(C[ie],ie,C))return ie;return-1}function An(C,x,O){return x==x?function fl(C,x,O){for(var L=O-1,G=C.length;++L<G;)if(C[L]===x)return L;return-1}(C,x,O):Ei(C,Rn,O)}function rl(C,x,O,L){for(var G=O-1,ie=C.length;++G<ie;)if(L(C[G],x))return G;return-1}function Rn(C){return C!=C}function Ln(C,x){var O=null==C?0:C.length;return O?Fo(C,x)/O:Ci}function ct(C){return function(x){return null==x?f:x[C]}}function Zo(C){return function(x){return null==C?f:C[x]}}function ia(C,x,O,L,G){return G(C,function(ie,De,de){O=L?(L=!1,ie):x(O,ie,De,de)}),O}function Fo(C,x){for(var O,L=-1,G=C.length;++L<G;){var ie=x(C[L]);ie!==f&&(O=O===f?ie:O+ie)}return O}function oa(C,x){for(var O=-1,L=Array(C);++O<C;)L[O]=x(O);return L}function qi(C){return C&&C.slice(0,sa(C)+1).replace(Di,"")}function nt(C){return function(x){return C(x)}}function Zi(C,x){return me(x,function(O){return C[O]})}function ii(C,x){return C.has(x)}function Fi(C,x){for(var O=-1,L=C.length;++O<L&&An(x,C[O],0)>-1;);return O}function ra(C,x){for(var O=C.length;O--&&An(x,C[O],0)>-1;);return O}var cl=Zo({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),pl=Zo({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function dl(C){return"\\"+js[C]}function En(C){return Bs.test(C)}function No(C){var x=-1,O=Array(C.size);return C.forEach(function(L,G){O[++x]=[G,L]}),O}function aa(C,x){return function(O){return C(x(O))}}function en(C,x){for(var O=-1,L=C.length,G=0,ie=[];++O<L;){var De=C[O];(De===x||De===cn)&&(C[O]=cn,ie[G++]=O)}return ie}function Ni(C){var x=-1,O=Array(C.size);return C.forEach(function(L){O[++x]=L}),O}function qn(C){return En(C)?function bl(C){for(var x=ko.lastIndex=0;ko.test(C);)++x;return x}(C):nl(C)}function Pt(C){return En(C)?function Cl(C){return C.match(ko)||[]}(C):function il(C){return C.split("")}(C)}function sa(C){for(var x=C.length;x--&&Os.test(C.charAt(x)););return x}var vl=Zo({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),qt=function C(x){var i,O=(x=null==x?Ae:qt.defaults(Ae.Object(),x,qt.pick(Ae,Ao))).Array,L=x.Date,G=x.Error,ie=x.Function,De=x.Math,de=x.Object,Uo=x.RegExp,Pl=x.String,pt=x.TypeError,Ui=O.prototype,Zn=de.prototype,Ji=x["__core-js_shared__"],Gi=ie.prototype.toString,ae=Zn.hasOwnProperty,yl=0,la=(i=/[^.]+$/.exec(Ji&&Ji.keys&&Ji.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",Bi=Zn.toString,xl=Gi.call(de),ca=Ae._,pa=Uo("^"+Gi.call(ae).replace(Po,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Yi=Ai?x.Buffer:f,nn=x.Symbol,Hi=x.Uint8Array,da=Yi?Yi.allocUnsafe:f,zi=aa(de.getPrototypeOf,de),ua=de.create,ha=Zn.propertyIsEnumerable,oi=Ui.splice,ma=nn?nn.isConcatSpreadable:f,ri=nn?nn.iterator:f,hn=nn?nn.toStringTag:f,Qi=function(){try{var i=vn(de,"defineProperty");return i({},"",{}),i}catch{}}(),wl=x.clearTimeout!==Ae.clearTimeout&&x.clearTimeout,ga=L&&L.now!==Ae.Date.now&&L.now,Tl=x.setTimeout!==Ae.setTimeout&&x.setTimeout,Vi=De.ceil,ji=De.floor,Jo=de.getOwnPropertySymbols,Dl=Yi?Yi.isBuffer:f,fa=x.isFinite,Ki=Ui.join,Sl=aa(de.keys,de),Ce=De.max,Ue=De.min,_a=L.now,Il=x.parseInt,va=De.random,kl=Ui.reverse,Go=vn(x,"DataView"),ai=vn(x,"Map"),Bo=vn(x,"Promise"),Fn=vn(x,"Set"),si=vn(x,"WeakMap"),li=vn(de,"create"),Wi=si&&new si,Nn={},Al=Pe(Go),Rl=Pe(ai),Ll=Pe(Bo),El=Pe(Fn),ql=Pe(si),$i=nn?nn.prototype:f,ci=$i?$i.valueOf:f,ba=$i?$i.toString:f;function m(i){if(Te(i)&&!Y(i)&&!(i instanceof V)){if(i instanceof We)return i;if(ae.call(i,"__wrapped__"))return ho(i)}return new We(i)}var Un=function(){function i(){}return function(o){if(!Oe(o))return{};if(ua)return ua(o);i.prototype=o;var l=new i;return i.prototype=f,l}}();function pi(){}function We(i,o){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=f}function V(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=vt,this.__views__=[]}function mn(i){var o=-1,l=null==i?0:i.length;for(this.clear();++o<l;){var p=i[o];this.set(p[0],p[1])}}function Zt(i){var o=-1,l=null==i?0:i.length;for(this.clear();++o<l;){var p=i[o];this.set(p[0],p[1])}}function Ft(i){var o=-1,l=null==i?0:i.length;for(this.clear();++o<l;){var p=i[o];this.set(p[0],p[1])}}function gn(i){var o=-1,l=null==i?0:i.length;for(this.__data__=new Ft;++o<l;)this.add(i[o])}function Ze(i){var o=this.__data__=new Zt(i);this.size=o.size}function Ma(i,o){var l=Y(i),p=!l&&_i(i),h=!l&&!p&&Hn(i),g=!l&&!p&&!h&&mo(i),_=l||p||h||g,b=_?oa(i.length,Pl):[],M=b.length;for(var S in i)(o||ae.call(i,S))&&(!_||!("length"==S||h&&("offset"==S||"parent"==S)||g&&("buffer"==S||"byteLength"==S||"byteOffset"==S)||Gt(S,M)))&&b.push(S);return b}function Pa(i){var o=i.length;return o?i[ar(0,o-1)]:f}function oc(i,o){return Me($e(i),fn(o,0,i.length))}function rc(i){return Me($e(i))}function Ho(i,o,l){(l!==f&&!Yt(i[o],l)||l===f&&!(o in i))&&Nt(i,o,l)}function di(i,o,l){var p=i[o];(!ae.call(i,o)||!Yt(p,l)||l===f&&!(o in i))&&Nt(i,o,l)}function ze(i,o){for(var l=i.length;l--;)if(Yt(i[l][0],o))return l;return-1}function ac(i,o,l,p){return on(i,function(h,g,_){o(p,h,l(h),_)}),p}function Oa(i,o){return i&&It(o,Ye(o),i)}function Nt(i,o,l){"__proto__"==o&&Qi?Qi(i,o,{configurable:!0,enumerable:!0,value:l,writable:!0}):i[o]=l}function zo(i,o){for(var l=-1,p=o.length,h=O(p),g=null==i;++l<p;)h[l]=g?f:tp(i,o[l]);return h}function fn(i,o,l){return i==i&&(l!==f&&(i=i<=l?i:l),o!==f&&(i=i>=o?i:o)),i}function dt(i,o,l,p,h,g){var _,b=o&Tt,M=o&On,S=o&Xe;if(l&&(_=h?l(i,p,h,g):l(i)),_!==f)return _;if(!Oe(i))return i;var I=Y(i);if(I){if(_=function Jc(i){var o=i.length,l=new i.constructor(o);return o&&"string"==typeof i[0]&&ae.call(i,"index")&&(l.index=i.index,l.input=i.input),l}(i),!b)return $e(i,_)}else{var A=Ge(i),R=A==Kn||A==_o;if(Hn(i))return Ya(i,b);if(A==Et||A==xn||R&&!h){if(_=M||R?{}:ls(i),!b)return M?function Ic(i,o){return It(i,as(i),o)}(i,function sc(i,o){return i&&It(o,gt(o),i)}(_,i)):function Sc(i,o){return It(i,Mr(i),o)}(i,Oa(_,i))}else{if(!le[A])return h?i:{};_=function Gc(i,o,l){var p=i.constructor;switch(o){case pn:return hr(i);case Kt:case Tn:return new p(+i);case Wt:return function xc(i,o){var l=o?hr(i.buffer):i.buffer;return new i.constructor(l,i.byteOffset,i.byteLength)}(i,l);case ei:case bo:case xi:case Ir:case Co:case wi:case Ti:case ti:case Mo:return Ha(i,l);case bt:return new p;case Pi:case Dn:return new p(i);case $n:return function wc(i){var o=new i.constructor(i.source,Ee.exec(i));return o.lastIndex=i.lastIndex,o}(i);case st:return new p;case Oi:return function Tc(i){return ci?de(ci.call(i)):{}}(i)}}(i,A,b)}}g||(g=new Ze);var Z=g.get(i);if(Z)return Z;g.set(i,_),Ip(i)?i.forEach(function(U){_.add(dt(U,o,l,U,i,g))}):Dp(i)&&i.forEach(function(U,$){_.set($,dt(U,o,l,$,i,g))});var Q=I?f:(S?M?vr:_r:M?gt:Ye)(i);return lt(Q||i,function(U,$){Q&&(U=i[$=U]),di(_,$,dt(U,o,l,$,i,g))}),_}function ya(i,o,l){var p=l.length;if(null==i)return!p;for(i=de(i);p--;){var h=l[p],_=i[h];if(_===f&&!(h in i)||!(0,o[h])(_))return!1}return!0}function xa(i,o,l){if("function"!=typeof i)throw new pt(Ne);return D(function(){i.apply(f,l)},o)}function ui(i,o,l,p){var h=-1,g=Li,_=!0,b=i.length,M=[],S=o.length;if(!b)return M;l&&(o=me(o,nt(l))),p?(g=Lo,_=!1):o.length>=he&&(g=ii,_=!1,o=new gn(o));e:for(;++h<b;){var I=i[h],A=null==l?I:l(I);if(I=p||0!==I?I:0,_&&A==A){for(var R=S;R--;)if(o[R]===A)continue e;M.push(I)}else g(o,A,p)||M.push(I)}return M}m.templateSettings={escape:Cs,evaluate:qr,interpolate:Le,variable:"",imports:{_:m}},(m.prototype=pi.prototype).constructor=m,(We.prototype=Un(pi.prototype)).constructor=We,(V.prototype=Un(pi.prototype)).constructor=V,mn.prototype.clear=function Fl(){this.__data__=li?li(null):{},this.size=0},mn.prototype.delete=function Ca(i){var o=this.has(i)&&delete this.__data__[i];return this.size-=o?1:0,o},mn.prototype.get=function Nl(i){var o=this.__data__;if(li){var l=o[i];return l===_t?f:l}return ae.call(o,i)?o[i]:f},mn.prototype.has=function Ul(i){var o=this.__data__;return li?o[i]!==f:ae.call(o,i)},mn.prototype.set=function Jl(i,o){var l=this.__data__;return this.size+=this.has(i)?0:1,l[i]=li&&o===f?_t:o,this},Zt.prototype.clear=function Gl(){this.__data__=[],this.size=0},Zt.prototype.delete=function Bl(i){var o=this.__data__,l=ze(o,i);return!(l<0||(l==o.length-1?o.pop():oi.call(o,l,1),--this.size,0))},Zt.prototype.get=function Yl(i){var o=this.__data__,l=ze(o,i);return l<0?f:o[l][1]},Zt.prototype.has=function Hl(i){return ze(this.__data__,i)>-1},Zt.prototype.set=function zl(i,o){var l=this.__data__,p=ze(l,i);return p<0?(++this.size,l.push([i,o])):l[p][1]=o,this},Ft.prototype.clear=function Ql(){this.size=0,this.__data__={hash:new mn,map:new(ai||Zt),string:new mn}},Ft.prototype.delete=function qe(i){var o=uo(this,i).delete(i);return this.size-=o?1:0,o},Ft.prototype.get=function Vl(i){return uo(this,i).get(i)},Ft.prototype.has=function jl(i){return uo(this,i).has(i)},Ft.prototype.set=function Kl(i,o){var l=uo(this,i),p=l.size;return l.set(i,o),this.size+=l.size==p?0:1,this},gn.prototype.add=gn.prototype.push=function Wl(i){return this.__data__.set(i,_t),this},gn.prototype.has=function $l(i){return this.__data__.has(i)},Ze.prototype.clear=function Xl(){this.__data__=new Zt,this.size=0},Ze.prototype.delete=function ec(i){var o=this.__data__,l=o.delete(i);return this.size=o.size,l},Ze.prototype.get=function tc(i){return this.__data__.get(i)},Ze.prototype.has=function nc(i){return this.__data__.has(i)},Ze.prototype.set=function ic(i,o){var l=this.__data__;if(l instanceof Zt){var p=l.__data__;if(!ai||p.length<he-1)return p.push([i,o]),this.size=++l.size,this;l=this.__data__=new Ft(p)}return l.set(i,o),this.size=l.size,this};var on=Va(St),wa=Va(Vo,!0);function cc(i,o){var l=!0;return on(i,function(p,h,g){return l=!!o(p,h,g)}),l}function eo(i,o,l){for(var p=-1,h=i.length;++p<h;){var g=i[p],_=o(g);if(null!=_&&(b===f?_==_&&!yt(_):l(_,b)))var b=_,M=g}return M}function Ta(i,o){var l=[];return on(i,function(p,h,g){o(p,h,g)&&l.push(p)}),l}function Fe(i,o,l,p,h){var g=-1,_=i.length;for(l||(l=Yc),h||(h=[]);++g<_;){var b=i[g];o>0&&l(b)?o>1?Fe(b,o-1,l,p,h):Xt(h,b):p||(h[h.length]=b)}return h}var Qo=ja(),Da=ja(!0);function St(i,o){return i&&Qo(i,o,Ye)}function Vo(i,o){return i&&Da(i,o,Ye)}function to(i,o){return $t(o,function(l){return bn(i[l])})}function _n(i,o){for(var l=0,p=(o=an(o,i)).length;null!=i&&l<p;)i=i[K(o[l++])];return l&&l==p?i:f}function Je(i,o,l){var p=o(i);return Y(i)?p:Xt(p,l(i))}function Qe(i){return null==i?i===f?yi:Wn:hn&&hn in de(i)?function Fc(i){var o=ae.call(i,hn),l=i[hn];try{i[hn]=f;var p=!0}catch{}var h=Bi.call(i);return p&&(o?i[hn]=l:delete i[hn]),h}(i):function d(i){return Bi.call(i)}(i)}function jo(i,o){return i>o}function dc(i,o){return null!=i&&ae.call(i,o)}function uc(i,o){return null!=i&&o in de(i)}function Ko(i,o,l){for(var p=l?Lo:Li,h=i[0].length,g=i.length,_=g,b=O(g),M=1/0,S=[];_--;){var I=i[_];_&&o&&(I=me(I,nt(o))),M=Ue(I.length,M),b[_]=!l&&(o||h>=120&&I.length>=120)?new gn(_&&I):f}I=i[0];var A=-1,R=b[0];e:for(;++A<h&&S.length<M;){var Z=I[A],N=o?o(Z):Z;if(Z=l||0!==Z?Z:0,!(R?ii(R,N):p(S,N,l))){for(_=g;--_;){var Q=b[_];if(!(Q?ii(Q,N):p(i[_],N,l)))continue e}R&&R.push(N),S.push(Z)}}return S}function hi(i,o,l){var p=null==(i=v(i,o=an(o,i)))?i:i[K(kt(o))];return null==p?f:tt(p,i,l)}function gc(i){return Te(i)&&Qe(i)==xn}function Jn(i,o,l,p,h){return i===o||(null==i||null==o||!Te(i)&&!Te(o)?i!=i&&o!=o:function Wo(i,o,l,p,h,g){var _=Y(i),b=Y(o),M=_?wn:Ge(i),S=b?wn:Ge(o),I=(M=M==xn?Et:M)==Et,A=(S=S==xn?Et:S)==Et,R=M==S;if(R&&Hn(i)){if(!Hn(o))return!1;_=!0,I=!1}if(R&&!I)return g||(g=new Ze),_||mo(i)?rs(i,o,l,p,h,g):function qc(i,o,l,p,h,g,_){switch(l){case Wt:if(i.byteLength!=o.byteLength||i.byteOffset!=o.byteOffset)return!1;i=i.buffer,o=o.buffer;case pn:return!(i.byteLength!=o.byteLength||!g(new Hi(i),new Hi(o)));case Kt:case Tn:case Pi:return Yt(+i,+o);case jn:return i.name==o.name&&i.message==o.message;case $n:case Dn:return i==o+"";case bt:var b=No;case st:if(b||(b=Ni),i.size!=o.size&&!(p&W))return!1;var S=_.get(i);if(S)return S==o;p|=J,_.set(i,o);var I=rs(b(i),b(o),p,h,g,_);return _.delete(i),I;case Oi:if(ci)return ci.call(i)==ci.call(o)}return!1}(i,o,M,l,p,h,g);if(!(l&W)){var Z=I&&ae.call(i,"__wrapped__"),N=A&&ae.call(o,"__wrapped__");if(Z||N){var Q=Z?i.value():i,U=N?o.value():o;return g||(g=new Ze),h(Q,U,l,p,g)}}return!!R&&(g||(g=new Ze),function Zc(i,o,l,p,h,g){var _=l&W,b=_r(i),M=b.length;if(M!=_r(o).length&&!_)return!1;for(var A=M;A--;){var R=b[A];if(!(_?R in o:ae.call(o,R)))return!1}var Z=g.get(i),N=g.get(o);if(Z&&N)return Z==o&&N==i;var Q=!0;g.set(i,o),g.set(o,i);for(var U=_;++A<M;){var $=i[R=b[A]],ee=o[R];if(p)var xt=_?p(ee,$,R,o,i,g):p($,ee,R,i,o,g);if(!(xt===f?$===ee||h($,ee,l,p,g):xt)){Q=!1;break}U||(U="constructor"==R)}if(Q&&!U){var rt=i.constructor,wt=o.constructor;rt!=wt&&"constructor"in i&&"constructor"in o&&!("function"==typeof rt&&rt instanceof rt&&"function"==typeof wt&&wt instanceof wt)&&(Q=!1)}return g.delete(i),g.delete(o),Q}(i,o,l,p,h,g))}(i,o,l,p,Jn,h))}function $o(i,o,l,p){var h=l.length,g=h,_=!p;if(null==i)return!g;for(i=de(i);h--;){var b=l[h];if(_&&b[2]?b[1]!==i[b[0]]:!(b[0]in i))return!1}for(;++h<g;){var M=(b=l[h])[0],S=i[M],I=b[1];if(_&&b[2]){if(S===f&&!(M in i))return!1}else{var A=new Ze;if(p)var R=p(S,I,M,i,o,A);if(!(R===f?Jn(I,S,W|J,p,A):R))return!1}}return!0}function Sa(i){return!(!Oe(i)||function zc(i){return!!la&&la in i}(i))&&(bn(i)?pa:we).test(Pe(i))}function Ia(i){return"function"==typeof i?i:null==i?ft:"object"==typeof i?Y(i)?nr(i[0],i[1]):tr(i):Bp(i)}function Xo(i){if(!a(i))return Sl(i);var o=[];for(var l in de(i))ae.call(i,l)&&"constructor"!=l&&o.push(l);return o}function er(i,o){return i<o}function ka(i,o){var l=-1,p=mt(i)?O(i.length):[];return on(i,function(h,g,_){p[++l]=o(h,g,_)}),p}function tr(i){var o=Cr(i);return 1==o.length&&o[0][2]?t(o[0][0],o[0][1]):function(l){return l===i||$o(l,i,o)}}function nr(i,o){return Pr(i)&&c(o)?t(K(i),o):function(l){var p=tp(l,i);return p===f&&p===o?np(l,i):Jn(o,p,W|J)}}function Ot(i,o,l,p,h){i!==o&&Qo(o,function(g,_){if(h||(h=new Ze),Oe(g))!function ir(i,o,l,p,h,g,_){var b=y(i,l),M=y(o,l),S=_.get(M);if(S)Ho(i,l,S);else{var I=g?g(b,M,l+"",i,o,_):f,A=I===f;if(A){var R=Y(M),Z=!R&&Hn(M),N=!R&&!Z&&mo(M);I=M,R||Z||N?Y(b)?I=b:Se(b)?I=$e(b):Z?(A=!1,I=Ya(M,!0)):N?(A=!1,I=Ha(M,!0)):I=[]:yr(M)||_i(M)?(I=b,_i(b)?I=Rp(b):(!Oe(b)||bn(b))&&(I=ls(M))):A=!1}A&&(_.set(M,I),h(I,M,p,g,_),_.delete(M)),Ho(i,l,I)}}(i,o,_,l,Ot,p,h);else{var b=p?p(y(i,_),g,_+"",i,o,h):f;b===f&&(b=g),Ho(i,_,b)}},gt)}function io(i,o){var l=i.length;if(l)return Gt(o+=o<0?l:0,l)?i[o]:f}function ut(i,o,l){o=o.length?me(o,function(g){return Y(g)?function(_){return _n(_,1===g.length?g[0]:g)}:g}):[ft];var p=-1;return o=me(o,nt(F())),function al(C,x){var O=C.length;for(C.sort(x);O--;)C[O]=C[O].value;return C}(ka(i,function(g,_,b){return{criteria:me(o,function(S){return S(g)}),index:++p,value:g}}),function(g,_){return function Dc(i,o,l){for(var p=-1,h=i.criteria,g=o.criteria,_=h.length,b=l.length;++p<_;){var M=za(h[p],g[p]);if(M)return p>=b?M:M*("desc"==l[p]?-1:1)}return i.index-o.index}(g,_,l)})}function or(i,o,l){for(var p=-1,h=o.length,g={};++p<h;){var _=o[p],b=_n(i,_);l(b,_)&&gi(g,an(_,i),b)}return g}function rr(i,o,l,p){var h=p?rl:An,g=-1,_=o.length,b=i;for(i===o&&(o=$e(o)),l&&(b=me(i,nt(l)));++g<_;)for(var M=0,S=o[g],I=l?l(S):S;(M=h(b,I,M,p))>-1;)b!==i&&oi.call(b,M,1),oi.call(i,M,1);return i}function La(i,o){for(var l=i?o.length:0,p=l-1;l--;){var h=o[l];if(l==p||h!==g){var g=h;Gt(h)?oi.call(i,h,1):pr(i,h)}}return i}function ar(i,o){return i+ji(va()*(o-i+1))}function mi(i,o){var l="";if(!i||o<1||o>Lt)return l;do{o%2&&(l+=i),(o=ji(o/2))&&(i+=i)}while(o);return l}function B(i,o){return q(u(i,o,ft),i+"")}function sr(i){return Pa(go(i))}function Ea(i,o){var l=go(i);return Me(l,fn(o,0,l.length))}function gi(i,o,l,p){if(!Oe(i))return i;for(var h=-1,g=(o=an(o,i)).length,_=g-1,b=i;null!=b&&++h<g;){var M=K(o[h]),S=l;if("__proto__"===M||"constructor"===M||"prototype"===M)return i;if(h!=_){var I=b[M];(S=p?p(I,M,b):f)===f&&(S=Oe(I)?I:Gt(o[h+1])?[]:{})}di(b,M,S),b=b[M]}return i}var qa=Wi?function(i,o){return Wi.set(i,o),i}:ft,Za=Qi?function(i,o){return Qi(i,"toString",{configurable:!0,enumerable:!1,value:op(o),writable:!0})}:ft;function Fa(i){return Me(go(i))}function it(i,o,l){var p=-1,h=i.length;o<0&&(o=-o>h?0:h+o),(l=l>h?h:l)<0&&(l+=h),h=o>l?0:l-o>>>0,o>>>=0;for(var g=O(h);++p<h;)g[p]=i[p+o];return g}function Oc(i,o){var l;return on(i,function(p,h,g){return!(l=o(p,h,g))}),!!l}function oo(i,o,l){var p=0,h=null==i?p:i.length;if("number"==typeof o&&o==o&&h<=Dr){for(;p<h;){var g=p+h>>>1,_=i[g];null!==_&&!yt(_)&&(l?_<=o:_<o)?p=g+1:h=g}return h}return lr(i,o,ft,l)}function lr(i,o,l,p){var h=0,g=null==i?0:i.length;if(0===g)return 0;for(var _=(o=l(o))!=o,b=null===o,M=yt(o),S=o===f;h<g;){var I=ji((h+g)/2),A=l(i[I]),R=A!==f,Z=null===A,N=A==A,Q=yt(A);if(_)var U=p||N;else U=S?N&&(p||R):b?N&&R&&(p||!Z):M?N&&R&&!Z&&(p||!Q):!Z&&!Q&&(p?A<=o:A<o);U?h=I+1:g=I}return Ue(g,Tr)}function cr(i,o){for(var l=-1,p=i.length,h=0,g=[];++l<p;){var _=i[l],b=o?o(_):_;if(!l||!Yt(b,M)){var M=b;g[h++]=0===_?0:_}}return g}function Na(i){return"number"==typeof i?i:yt(i)?Ci:+i}function ot(i){if("string"==typeof i)return i;if(Y(i))return me(i,ot)+"";if(yt(i))return ba?ba.call(i):"";var o=i+"";return"0"==o&&1/i==-jt?"-0":o}function rn(i,o,l){var p=-1,h=Li,g=i.length,_=!0,b=[],M=b;if(l)_=!1,h=Lo;else if(g>=he){var S=o?null:Lc(i);if(S)return Ni(S);_=!1,h=ii,M=new gn}else M=o?[]:b;e:for(;++p<g;){var I=i[p],A=o?o(I):I;if(I=l||0!==I?I:0,_&&A==A){for(var R=M.length;R--;)if(M[R]===A)continue e;o&&M.push(A),b.push(I)}else h(M,A,l)||(M!==b&&M.push(A),b.push(I))}return b}function pr(i,o){return null==(i=v(i,o=an(o,i)))||delete i[K(kt(o))]}function Ua(i,o,l,p){return gi(i,o,l(_n(i,o)),p)}function ro(i,o,l,p){for(var h=i.length,g=p?h:-1;(p?g--:++g<h)&&o(i[g],g,i););return l?it(i,p?0:g,p?g+1:h):it(i,p?g+1:0,p?h:g)}function Ja(i,o){var l=i;return l instanceof V&&(l=l.value()),Eo(o,function(p,h){return h.func.apply(h.thisArg,Xt([p],h.args))},l)}function fi(i,o,l){var p=i.length;if(p<2)return p?rn(i[0]):[];for(var h=-1,g=O(p);++h<p;)for(var _=i[h],b=-1;++b<p;)b!=h&&(g[h]=ui(g[h]||_,i[b],o,l));return rn(Fe(g,1),o,l)}function Ga(i,o,l){for(var p=-1,h=i.length,g=o.length,_={};++p<h;)l(_,i[p],p<g?o[p]:f);return _}function dr(i){return Se(i)?i:[]}function ur(i){return"function"==typeof i?i:ft}function an(i,o){return Y(i)?i:Pr(i,o)?[i]:ln(ce(i))}var yc=B;function sn(i,o,l){var p=i.length;return l=l===f?p:l,!o&&l>=p?i:it(i,o,l)}var Ba=wl||function(i){return Ae.clearTimeout(i)};function Ya(i,o){if(o)return i.slice();var l=i.length,p=da?da(l):new i.constructor(l);return i.copy(p),p}function hr(i){var o=new i.constructor(i.byteLength);return new Hi(o).set(new Hi(i)),o}function Ha(i,o){var l=o?hr(i.buffer):i.buffer;return new i.constructor(l,i.byteOffset,i.length)}function za(i,o){if(i!==o){var l=i!==f,p=null===i,h=i==i,g=yt(i),_=o!==f,b=null===o,M=o==o,S=yt(o);if(!b&&!S&&!g&&i>o||g&&_&&M&&!b&&!S||p&&_&&M||!l&&M||!h)return 1;if(!p&&!g&&!S&&i<o||S&&l&&h&&!p&&!g||b&&l&&h||!_&&h||!M)return-1}return 0}function mr(i,o,l,p){for(var h=-1,g=i.length,_=l.length,b=-1,M=o.length,S=Ce(g-_,0),I=O(M+S),A=!p;++b<M;)I[b]=o[b];for(;++h<_;)(A||h<g)&&(I[l[h]]=i[h]);for(;S--;)I[b++]=i[h++];return I}function Qa(i,o,l,p){for(var h=-1,g=i.length,_=-1,b=l.length,M=-1,S=o.length,I=Ce(g-b,0),A=O(I+S),R=!p;++h<I;)A[h]=i[h];for(var Z=h;++M<S;)A[Z+M]=o[M];for(;++_<b;)(R||h<g)&&(A[Z+l[_]]=i[h++]);return A}function $e(i,o){var l=-1,p=i.length;for(o||(o=O(p));++l<p;)o[l]=i[l];return o}function It(i,o,l,p){var h=!l;l||(l={});for(var g=-1,_=o.length;++g<_;){var b=o[g],M=p?p(l[b],i[b],b,l,i):f;M===f&&(M=i[b]),h?Nt(l,b,M):di(l,b,M)}return l}function Re(i,o){return function(l,p){var h=Y(l)?Xs:ac,g=o?o():{};return h(l,i,F(p,2),g)}}function ht(i){return B(function(o,l){var p=-1,h=l.length,g=h>1?l[h-1]:f,_=h>2?l[2]:f;for(g=i.length>3&&"function"==typeof g?(h--,g):f,_&&Ve(l[0],l[1],_)&&(g=h<3?f:g,h=1),o=de(o);++p<h;){var b=l[p];b&&i(o,b,p,g)}return o})}function Va(i,o){return function(l,p){if(null==l)return l;if(!mt(l))return i(l,p);for(var h=l.length,g=o?h:-1,_=de(l);(o?g--:++g<h)&&!1!==p(_[g],g,_););return l}}function ja(i){return function(o,l,p){for(var h=-1,g=de(o),_=p(o),b=_.length;b--;){var M=_[i?b:++h];if(!1===l(g[M],M,g))break}return o}}function Ka(i){return function(o){var l=En(o=ce(o))?Pt(o):f,p=l?l[0]:o.charAt(0),h=l?sn(l,1).join(""):o.slice(1);return p[i]()+h}}function Gn(i){return function(o){return Eo(Jp(Up(o).replace(Us,"")),i,"")}}function Bn(i){return function(){var o=arguments;switch(o.length){case 0:return new i;case 1:return new i(o[0]);case 2:return new i(o[0],o[1]);case 3:return new i(o[0],o[1],o[2]);case 4:return new i(o[0],o[1],o[2],o[3]);case 5:return new i(o[0],o[1],o[2],o[3],o[4]);case 6:return new i(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new i(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var l=Un(i.prototype),p=i.apply(l,o);return Oe(p)?p:l}}function Wa(i){return function(o,l,p){var h=de(o);if(!mt(o)){var g=F(l,3);o=Ye(o),l=function(b){return g(h[b],b,h)}}var _=i(o,l,p);return _>-1?h[g?o[_]:_]:f}}function $a(i){return Jt(function(o){var l=o.length,p=l,h=We.prototype.thru;for(i&&o.reverse();p--;){var g=o[p];if("function"!=typeof g)throw new pt(Ne);if(h&&!_&&"wrapper"==po(g))var _=new We([],!0)}for(p=_?p:l;++p<l;){var b=po(g=o[p]),M="wrapper"==b?br(g):f;_=M&&Or(M[0])&&M[1]==(fe|H|ke|Ke)&&!M[4].length&&1==M[9]?_[po(M[0])].apply(_,M[3]):1==g.length&&Or(g)?_[b]():_.thru(g)}return function(){var S=arguments,I=S[0];if(_&&1==S.length&&Y(I))return _.plant(I).value();for(var A=0,R=l?o[A].apply(this,S):I;++A<l;)R=o[A].call(this,R);return R}})}function ao(i,o,l,p,h,g,_,b,M,S){var I=o&fe,A=o&oe,R=o&te,Z=o&(H|ge),N=o&Vt,Q=R?f:Bn(i);return function U(){for(var $=arguments.length,ee=O($),xt=$;xt--;)ee[xt]=arguments[xt];if(Z)var rt=Yn(U),wt=function ll(C,x){for(var O=C.length,L=0;O--;)C[O]===x&&++L;return L}(ee,rt);if(p&&(ee=mr(ee,p,h,Z)),g&&(ee=Qa(ee,g,_,Z)),$-=wt,Z&&$<S){var Ie=en(ee,rt);return ts(i,o,ao,U.placeholder,l,ee,Ie,b,M,S-$)}var Ht=A?l:this,Mn=R?Ht[i]:i;return $=ee.length,b?ee=function P(i,o){for(var l=i.length,p=Ue(o.length,l),h=$e(i);p--;){var g=o[p];i[p]=Gt(g,l)?h[g]:f}return i}(ee,b):N&&$>1&&ee.reverse(),I&&M<$&&(ee.length=M),this&&this!==Ae&&this instanceof U&&(Mn=Q||Bn(Mn)),Mn.apply(Ht,ee)}}function Xa(i,o){return function(l,p){return function mc(i,o,l,p){return St(i,function(h,g,_){o(p,l(h),g,_)}),p}(l,i,o(p),{})}}function so(i,o){return function(l,p){var h;if(l===f&&p===f)return o;if(l!==f&&(h=l),p!==f){if(h===f)return p;"string"==typeof l||"string"==typeof p?(l=ot(l),p=ot(p)):(l=Na(l),p=Na(p)),h=i(l,p)}return h}}function gr(i){return Jt(function(o){return o=me(o,nt(F())),B(function(l){var p=this;return i(o,function(h){return tt(h,p,l)})})})}function lo(i,o){var l=(o=o===f?" ":ot(o)).length;if(l<2)return l?mi(o,i):o;var p=mi(o,Vi(i/qn(o)));return En(o)?sn(Pt(p),0,i).join(""):p.slice(0,i)}function es(i){return function(o,l,p){return p&&"number"!=typeof p&&Ve(o,l,p)&&(l=p=f),o=Cn(o),l===f?(l=o,o=0):l=Cn(l),function Pc(i,o,l,p){for(var h=-1,g=Ce(Vi((o-i)/(l||1)),0),_=O(g);g--;)_[p?g:++h]=i,i+=l;return _}(o,l,p=p===f?o<l?1:-1:Cn(p),i)}}function co(i){return function(o,l){return"string"==typeof o&&"string"==typeof l||(o=At(o),l=At(l)),i(o,l)}}function ts(i,o,l,p,h,g,_,b,M,S){var I=o&H;o|=I?ke:je,(o&=~(I?je:ke))&at||(o&=~(oe|te));var Q=[i,o,h,I?g:f,I?_:f,I?f:g,I?f:_,b,M,S],U=l.apply(f,Q);return Or(i)&&w(U,Q),U.placeholder=p,se(U,i,o)}function fr(i){var o=De[i];return function(l,p){if(l=At(l),(p=null==p?0:Ue(z(p),292))&&fa(l)){var h=(ce(l)+"e").split("e");return+((h=(ce(o(h[0]+"e"+(+h[1]+p)))+"e").split("e"))[0]+"e"+(+h[1]-p))}return o(l)}}var Lc=Fn&&1/Ni(new Fn([,-0]))[1]==jt?function(i){return new Fn(i)}:sp;function ns(i){return function(o){var l=Ge(o);return l==bt?No(o):l==st?function gl(C){var x=-1,O=Array(C.size);return C.forEach(function(L){O[++x]=[L,L]}),O}(o):function sl(C,x){return me(x,function(O){return[O,C[O]]})}(o,i(o))}}function Ut(i,o,l,p,h,g,_,b){var M=o&te;if(!M&&"function"!=typeof i)throw new pt(Ne);var S=p?p.length:0;if(S||(o&=~(ke|je),p=h=f),_=_===f?_:Ce(z(_),0),b=b===f?b:z(b),S-=h?h.length:0,o&je){var I=p,A=h;p=h=f}var R=M?f:br(i),Z=[i,o,l,p,h,I,A,g,_,b];if(R&&function r(i,o){var l=i[1],p=o[1],h=l|p;if(!(h<(oe|te|fe))&&!(p==fe&&l==H||p==fe&&l==Ke&&i[7].length<=o[8]||p==(fe|Ke)&&o[7].length<=o[8]&&l==H))return i;p&oe&&(i[2]=o[2],h|=l&oe?0:at);var b=o[3];if(b){var M=i[3];i[3]=M?mr(M,b,o[4]):b,i[4]=M?en(i[3],cn):o[4]}(b=o[5])&&(i[5]=(M=i[5])?Qa(M,b,o[6]):b,i[6]=M?en(i[5],cn):o[6]),(b=o[7])&&(i[7]=b),p&fe&&(i[8]=null==i[8]?o[8]:Ue(i[8],o[8])),null==i[9]&&(i[9]=o[9]),i[0]=o[0],i[1]=h}(Z,R),i=Z[0],o=Z[1],l=Z[2],p=Z[3],h=Z[4],!(b=Z[9]=Z[9]===f?M?0:i.length:Ce(Z[9]-S,0))&&o&(H|ge)&&(o&=~(H|ge)),o&&o!=oe)N=o==H||o==ge?function Ac(i,o,l){var p=Bn(i);return function h(){for(var g=arguments.length,_=O(g),b=g,M=Yn(h);b--;)_[b]=arguments[b];var S=g<3&&_[0]!==M&&_[g-1]!==M?[]:en(_,M);return(g-=S.length)<l?ts(i,o,ao,h.placeholder,f,_,S,f,f,l-g):tt(this&&this!==Ae&&this instanceof h?p:i,this,_)}}(i,o,b):o!=ke&&o!=(oe|ke)||h.length?ao.apply(f,Z):function Rc(i,o,l,p){var h=o&oe,g=Bn(i);return function _(){for(var b=-1,M=arguments.length,S=-1,I=p.length,A=O(I+M),R=this&&this!==Ae&&this instanceof _?g:i;++S<I;)A[S]=p[S];for(;M--;)A[S++]=arguments[++b];return tt(R,h?l:this,A)}}(i,o,l,p);else var N=function kc(i,o,l){var p=o&oe,h=Bn(i);return function g(){return(this&&this!==Ae&&this instanceof g?h:i).apply(p?l:this,arguments)}}(i,o,l);return se((R?qa:w)(N,Z),i,o)}function is(i,o,l,p){return i===f||Yt(i,Zn[l])&&!ae.call(p,l)?o:i}function os(i,o,l,p,h,g){return Oe(i)&&Oe(o)&&(g.set(o,i),Ot(i,o,f,os,g),g.delete(o)),i}function Ec(i){return yr(i)?f:i}function rs(i,o,l,p,h,g){var _=l&W,b=i.length,M=o.length;if(b!=M&&!(_&&M>b))return!1;var S=g.get(i),I=g.get(o);if(S&&I)return S==o&&I==i;var A=-1,R=!0,Z=l&J?new gn:f;for(g.set(i,o),g.set(o,i);++A<b;){var N=i[A],Q=o[A];if(p)var U=_?p(Q,N,A,o,i,g):p(N,Q,A,i,o,g);if(U!==f){if(U)continue;R=!1;break}if(Z){if(!qo(o,function($,ee){if(!ii(Z,ee)&&(N===$||h(N,$,l,p,g)))return Z.push(ee)})){R=!1;break}}else if(N!==Q&&!h(N,Q,l,p,g)){R=!1;break}}return g.delete(i),g.delete(o),R}function Jt(i){return q(u(i,f,hp),i+"")}function _r(i){return Je(i,Ye,Mr)}function vr(i){return Je(i,gt,as)}var br=Wi?function(i){return Wi.get(i)}:sp;function po(i){for(var o=i.name+"",l=Nn[o],p=ae.call(Nn,o)?l.length:0;p--;){var h=l[p],g=h.func;if(null==g||g==i)return h.name}return o}function Yn(i){return(ae.call(m,"placeholder")?m:i).placeholder}function F(){var i=m.iteratee||rp;return i=i===rp?Ia:i,arguments.length?i(arguments[0],arguments[1]):i}function uo(i,o){var l=i.__data__;return function Hc(i){var o=typeof i;return"string"==o||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==i:null===i}(o)?l["string"==typeof o?"string":"hash"]:l.map}function Cr(i){for(var o=Ye(i),l=o.length;l--;){var p=o[l],h=i[p];o[l]=[p,h,c(h)]}return o}function vn(i,o){var l=function ul(C,x){return null==C?f:C[x]}(i,o);return Sa(l)?l:f}var Mr=Jo?function(i){return null==i?[]:(i=de(i),$t(Jo(i),function(o){return ha.call(i,o)}))}:lp,as=Jo?function(i){for(var o=[];i;)Xt(o,Mr(i)),i=zi(i);return o}:lp,Ge=Qe;function ss(i,o,l){for(var p=-1,h=(o=an(o,i)).length,g=!1;++p<h;){var _=K(o[p]);if(!(g=null!=i&&l(i,_)))break;i=i[_]}return g||++p!=h?g:!!(h=null==i?0:i.length)&&ms(h)&&Gt(_,h)&&(Y(i)||_i(i))}function ls(i){return"function"!=typeof i.constructor||a(i)?{}:Un(zi(i))}function Yc(i){return Y(i)||_i(i)||!!(ma&&i&&i[ma])}function Gt(i,o){var l=typeof i;return!!(o=o??Lt)&&("number"==l||"symbol"!=l&&T.test(i))&&i>-1&&i%1==0&&i<o}function Ve(i,o,l){if(!Oe(l))return!1;var p=typeof o;return!!("number"==p?mt(l)&&Gt(o,l.length):"string"==p&&o in l)&&Yt(l[o],i)}function Pr(i,o){if(Y(i))return!1;var l=typeof i;return!("number"!=l&&"symbol"!=l&&"boolean"!=l&&null!=i&&!yt(i))||pe.test(i)||!ye.test(i)||null!=o&&i in de(o)}function Or(i){var o=po(i),l=m[o];if("function"!=typeof l||!(o in V.prototype))return!1;if(i===l)return!0;var p=br(l);return!!p&&i===p[0]}(Go&&Ge(new Go(new ArrayBuffer(1)))!=Wt||ai&&Ge(new ai)!=bt||Bo&&Ge(Bo.resolve())!=vo||Fn&&Ge(new Fn)!=st||si&&Ge(new si)!=Xn)&&(Ge=function(i){var o=Qe(i),l=o==Et?i.constructor:f,p=l?Pe(l):"";if(p)switch(p){case Al:return Wt;case Rl:return bt;case Ll:return vo;case El:return st;case ql:return Xn}return o});var Qc=Ji?bn:cp;function a(i){var o=i&&i.constructor;return i===("function"==typeof o&&o.prototype||Zn)}function c(i){return i==i&&!Oe(i)}function t(i,o){return function(l){return null!=l&&l[i]===o&&(o!==f||i in de(l))}}function u(i,o,l){return o=Ce(o===f?i.length-1:o,0),function(){for(var p=arguments,h=-1,g=Ce(p.length-o,0),_=O(g);++h<g;)_[h]=p[o+h];h=-1;for(var b=O(o+1);++h<o;)b[h]=p[h];return b[o]=l(_),tt(i,this,b)}}function v(i,o){return o.length<2?i:_n(i,it(o,0,-1))}function y(i,o){if(("constructor"!==o||"function"!=typeof i[o])&&"__proto__"!=o)return i[o]}var w=Be(qa),D=Tl||function(i,o){return Ae.setTimeout(i,o)},q=Be(Za);function se(i,o,l){var p=o+"";return q(i,function Bc(i,o){var l=o.length;if(!l)return i;var p=l-1;return o[p]=(l>1?"& ":"")+o[p],o=o.join(l>2?", ":" "),i.replace(dn,"{\n/* [wrapped with "+o+"] */\n")}(p,function Bt(i,o){return lt(Mi,function(l){var p="_."+l[0];o&l[1]&&!Li(i,p)&&i.push(p)}),i.sort()}(function Uc(i){var o=i.match(ys);return o?o[1].split(xs):[]}(p),l)))}function Be(i){var o=0,l=0;return function(){var p=_a(),h=fo-(p-l);if(l=p,h>0){if(++o>=yn)return arguments[0]}else o=0;return i.apply(f,arguments)}}function Me(i,o){var l=-1,p=i.length,h=p-1;for(o=o===f?p:o;++l<o;){var g=ar(l,h),_=i[g];i[g]=i[l],i[l]=_}return i.length=o,i}var ln=function n(i){var o=us(i,function(p){return 500===l.size&&l.clear(),p}),l=o.cache;return o}(function(i){var o=[];return 46===i.charCodeAt(0)&&o.push(""),i.replace(Ms,function(l,p,h,g){o.push(h?g.replace(ue,"$1"):p||l)}),o});function K(i){if("string"==typeof i||yt(i))return i;var o=i+"";return"0"==o&&1/i==-jt?"-0":o}function Pe(i){if(null!=i){try{return Gi.call(i)}catch{}try{return i+""}catch{}}return""}function ho(i){if(i instanceof V)return i.clone();var o=new We(i.__wrapped__,i.__chain__);return o.__actions__=$e(i.__actions__),o.__index__=i.__index__,o.__values__=i.__values__,o}var Qp=B(function(i,o){return Se(i)?ui(i,Fe(o,1,Se,!0)):[]}),Vp=B(function(i,o){var l=kt(o);return Se(l)&&(l=f),Se(i)?ui(i,Fe(o,1,Se,!0),F(l,2)):[]}),jp=B(function(i,o){var l=kt(o);return Se(l)&&(l=f),Se(i)?ui(i,Fe(o,1,Se,!0),f,l):[]});function dp(i,o,l){var p=null==i?0:i.length;if(!p)return-1;var h=null==l?0:z(l);return h<0&&(h=Ce(p+h,0)),Ei(i,F(o,3),h)}function up(i,o,l){var p=null==i?0:i.length;if(!p)return-1;var h=p-1;return l!==f&&(h=z(l),h=l<0?Ce(p+h,0):Ue(h,p-1)),Ei(i,F(o,3),h,!0)}function hp(i){return null!=i&&i.length?Fe(i,1):[]}function mp(i){return i&&i.length?i[0]:f}var ad=B(function(i){var o=me(i,dr);return o.length&&o[0]===i[0]?Ko(o):[]}),sd=B(function(i){var o=kt(i),l=me(i,dr);return o===kt(l)?o=f:l.pop(),l.length&&l[0]===i[0]?Ko(l,F(o,2)):[]}),ld=B(function(i){var o=kt(i),l=me(i,dr);return(o="function"==typeof o?o:f)&&l.pop(),l.length&&l[0]===i[0]?Ko(l,f,o):[]});function kt(i){var o=null==i?0:i.length;return o?i[o-1]:f}var ud=B(gp);function gp(i,o){return i&&i.length&&o&&o.length?rr(i,o):i}var gd=Jt(function(i,o){var l=null==i?0:i.length,p=zo(i,o);return La(i,me(o,function(h){return Gt(h,l)?+h:h}).sort(za)),p});function jc(i){return null==i?i:kl.call(i)}var kd=B(function(i){return rn(Fe(i,1,Se,!0))}),Ad=B(function(i){var o=kt(i);return Se(o)&&(o=f),rn(Fe(i,1,Se,!0),F(o,2))}),Rd=B(function(i){var o=kt(i);return o="function"==typeof o?o:f,rn(Fe(i,1,Se,!0),f,o)});function Kc(i){if(!i||!i.length)return[];var o=0;return i=$t(i,function(l){if(Se(l))return o=Ce(l.length,o),!0}),oa(o,function(l){return me(i,ct(l))})}function fp(i,o){if(!i||!i.length)return[];var l=Kc(i);return null==o?l:me(l,function(p){return tt(o,f,p)})}var Zd=B(function(i,o){return Se(i)?ui(i,o):[]}),Fd=B(function(i){return fi($t(i,Se))}),Nd=B(function(i){var o=kt(i);return Se(o)&&(o=f),fi($t(i,Se),F(o,2))}),Ud=B(function(i){var o=kt(i);return o="function"==typeof o?o:f,fi($t(i,Se),f,o)}),Jd=B(Kc),Yd=B(function(i){var o=i.length,l=o>1?i[o-1]:f;return l="function"==typeof l?(i.pop(),l):f,fp(i,l)});function _p(i){var o=m(i);return o.__chain__=!0,o}function cs(i,o){return o(i)}var zd=Jt(function(i){var o=i.length,l=o?i[0]:0,p=this.__wrapped__,h=function(g){return zo(g,i)};return!(o>1||this.__actions__.length)&&p instanceof V&&Gt(l)?((p=p.slice(l,+l+(o?1:0))).__actions__.push({func:cs,args:[h],thisArg:f}),new We(p,this.__chain__).thru(function(g){return o&&!g.length&&g.push(f),g})):this.thru(h)}),eu=Re(function(i,o,l){ae.call(i,l)?++i[l]:Nt(i,l,1)}),iu=Wa(dp),ou=Wa(up);function vp(i,o){return(Y(i)?lt:on)(i,F(o,3))}function bp(i,o){return(Y(i)?el:wa)(i,F(o,3))}var lu=Re(function(i,o,l){ae.call(i,l)?i[l].push(o):Nt(i,l,[o])}),pu=B(function(i,o,l){var p=-1,h="function"==typeof o,g=mt(i)?O(i.length):[];return on(i,function(_){g[++p]=h?tt(o,_,l):hi(_,o,l)}),g}),du=Re(function(i,o,l){Nt(i,l,o)});function ps(i,o){return(Y(i)?me:ka)(i,F(o,3))}var hu=Re(function(i,o,l){i[l?0:1].push(o)},function(){return[[],[]]}),Pu=B(function(i,o){if(null==i)return[];var l=o.length;return l>1&&Ve(i,o[0],o[1])?o=[]:l>2&&Ve(o[0],o[1],o[2])&&(o=[o[0]]),ut(i,Fe(o,1),[])}),ds=ga||function(){return Ae.Date.now()};function Cp(i,o,l){return o=l?f:o,Ut(i,fe,f,f,f,f,o=i&&null==o?i.length:o)}function Mp(i,o){var l;if("function"!=typeof o)throw new pt(Ne);return i=z(i),function(){return--i>0&&(l=o.apply(this,arguments)),i<=1&&(o=f),l}}var Wc=B(function(i,o,l){var p=oe;if(l.length){var h=en(l,Yn(Wc));p|=ke}return Ut(i,p,o,l,h)}),Pp=B(function(i,o,l){var p=oe|te;if(l.length){var h=en(l,Yn(Pp));p|=ke}return Ut(o,p,i,l,h)});function xp(i,o,l){var p,h,g,_,b,M,S=0,I=!1,A=!1,R=!0;if("function"!=typeof i)throw new pt(Ne);function Z(Ie){var Ht=p,Mn=h;return p=h=f,S=Ie,_=i.apply(Mn,Ht)}function U(Ie){var Ht=Ie-M;return M===f||Ht>=o||Ht<0||A&&Ie-S>=g}function $(){var Ie=ds();if(U(Ie))return ee(Ie);b=D($,function Q(Ie){var Yp=o-(Ie-M);return A?Ue(Yp,g-(Ie-S)):Yp}(Ie))}function ee(Ie){return b=f,R&&p?Z(Ie):(p=h=f,_)}function wt(){var Ie=ds(),Ht=U(Ie);if(p=arguments,h=this,M=Ie,Ht){if(b===f)return function N(Ie){return S=Ie,b=D($,o),I?Z(Ie):_}(M);if(A)return Ba(b),b=D($,o),Z(M)}return b===f&&(b=D($,o)),_}return o=At(o)||0,Oe(l)&&(I=!!l.leading,g=(A="maxWait"in l)?Ce(At(l.maxWait)||0,o):g,R="trailing"in l?!!l.trailing:R),wt.cancel=function xt(){b!==f&&Ba(b),S=0,p=M=h=b=f},wt.flush=function rt(){return b===f?_:ee(ds())},wt}var yu=B(function(i,o){return xa(i,1,o)}),xu=B(function(i,o,l){return xa(i,At(o)||0,l)});function us(i,o){if("function"!=typeof i||null!=o&&"function"!=typeof o)throw new pt(Ne);var l=function(){var p=arguments,h=o?o.apply(this,p):p[0],g=l.cache;if(g.has(h))return g.get(h);var _=i.apply(this,p);return l.cache=g.set(h,_)||g,_};return l.cache=new(us.Cache||Ft),l}function hs(i){if("function"!=typeof i)throw new pt(Ne);return function(){var o=arguments;switch(o.length){case 0:return!i.call(this);case 1:return!i.call(this,o[0]);case 2:return!i.call(this,o[0],o[1]);case 3:return!i.call(this,o[0],o[1],o[2])}return!i.apply(this,o)}}us.Cache=Ft;var Du=yc(function(i,o){var l=(o=1==o.length&&Y(o[0])?me(o[0],nt(F())):me(Fe(o,1),nt(F()))).length;return B(function(p){for(var h=-1,g=Ue(p.length,l);++h<g;)p[h]=o[h].call(this,p[h]);return tt(i,this,p)})}),$c=B(function(i,o){var l=en(o,Yn($c));return Ut(i,ke,f,o,l)}),wp=B(function(i,o){var l=en(o,Yn(wp));return Ut(i,je,f,o,l)}),Su=Jt(function(i,o){return Ut(i,Ke,f,f,f,o)});function Yt(i,o){return i===o||i!=i&&o!=o}var Ju=co(jo),Gu=co(function(i,o){return i>=o}),_i=gc(function(){return arguments}())?gc:function(i){return Te(i)&&ae.call(i,"callee")&&!ha.call(i,"callee")},Y=O.isArray,Bu=Wr?nt(Wr):function fc(i){return Te(i)&&Qe(i)==pn};function mt(i){return null!=i&&ms(i.length)&&!bn(i)}function Se(i){return Te(i)&&mt(i)}var Hn=Dl||cp,Hu=Ro?nt(Ro):function _c(i){return Te(i)&&Qe(i)==Tn};function Xc(i){if(!Te(i))return!1;var o=Qe(i);return o==jn||o==Vn||"string"==typeof i.message&&"string"==typeof i.name&&!yr(i)}function bn(i){if(!Oe(i))return!1;var o=Qe(i);return o==Kn||o==_o||o==_s||o==Sr}function Tp(i){return"number"==typeof i&&i==z(i)}function ms(i){return"number"==typeof i&&i>-1&&i%1==0&&i<=Lt}function Oe(i){var o=typeof i;return null!=i&&("object"==o||"function"==o)}function Te(i){return null!=i&&"object"==typeof i}var Dp=$r?nt($r):function no(i){return Te(i)&&Ge(i)==bt};function Sp(i){return"number"==typeof i||Te(i)&&Qe(i)==Pi}function yr(i){if(!Te(i)||Qe(i)!=Et)return!1;var o=zi(i);if(null===o)return!0;var l=ae.call(o,"constructor")&&o.constructor;return"function"==typeof l&&l instanceof l&&Gi.call(l)==xl}var ep=kn?nt(kn):function vc(i){return Te(i)&&Qe(i)==$n},Ip=Xr?nt(Xr):function bc(i){return Te(i)&&Ge(i)==st};function gs(i){return"string"==typeof i||!Y(i)&&Te(i)&&Qe(i)==Dn}function yt(i){return"symbol"==typeof i||Te(i)&&Qe(i)==Oi}var mo=ea?nt(ea):function Cc(i){return Te(i)&&ms(i.length)&&!!X[Qe(i)]},sh=co(er),lh=co(function(i,o){return i<=o});function kp(i){if(!i)return[];if(mt(i))return gs(i)?Pt(i):$e(i);if(ri&&i[ri])return function ml(C){for(var x,O=[];!(x=C.next()).done;)O.push(x.value);return O}(i[ri]());var o=Ge(i);return(o==bt?No:o==st?Ni:go)(i)}function Cn(i){return i?(i=At(i))===jt||i===-jt?(i<0?-1:1)*wr:i==i?i:0:0===i?i:0}function z(i){var o=Cn(i),l=o%1;return o==o?l?o-l:o:0}function Ap(i){return i?fn(z(i),0,vt):0}function At(i){if("number"==typeof i)return i;if(yt(i))return Ci;if(Oe(i)){var o="function"==typeof i.valueOf?i.valueOf():i;i=Oe(o)?o+"":o}if("string"!=typeof i)return 0===i?i:+i;i=qi(i);var l=un.test(i);return l||Zr.test(i)?Ws(i.slice(2),l?2:8):xe.test(i)?Ci:+i}function Rp(i){return It(i,gt(i))}function ce(i){return null==i?"":ot(i)}var ph=ht(function(i,o){if(a(o)||mt(o))It(o,Ye(o),i);else for(var l in o)ae.call(o,l)&&di(i,l,o[l])}),Lp=ht(function(i,o){It(o,gt(o),i)}),fs=ht(function(i,o,l,p){It(o,gt(o),i,p)}),dh=ht(function(i,o,l,p){It(o,Ye(o),i,p)}),uh=Jt(zo),mh=B(function(i,o){i=de(i);var l=-1,p=o.length,h=p>2?o[2]:f;for(h&&Ve(o[0],o[1],h)&&(p=1);++l<p;)for(var g=o[l],_=gt(g),b=-1,M=_.length;++b<M;){var S=_[b],I=i[S];(I===f||Yt(I,Zn[S])&&!ae.call(i,S))&&(i[S]=g[S])}return i}),gh=B(function(i){return i.push(f,os),tt(Ep,f,i)});function tp(i,o,l){var p=null==i?f:_n(i,o);return p===f?l:p}function np(i,o){return null!=i&&ss(i,o,uc)}var xh=Xa(function(i,o,l){null!=o&&"function"!=typeof o.toString&&(o=Bi.call(o)),i[o]=l},op(ft)),wh=Xa(function(i,o,l){null!=o&&"function"!=typeof o.toString&&(o=Bi.call(o)),ae.call(i,o)?i[o].push(l):i[o]=[l]},F),Th=B(hi);function Ye(i){return mt(i)?Ma(i):Xo(i)}function gt(i){return mt(i)?Ma(i,!0):function Mc(i){if(!Oe(i))return function s(i){var o=[];if(null!=i)for(var l in de(i))o.push(l);return o}(i);var o=a(i),l=[];for(var p in i)"constructor"==p&&(o||!ae.call(i,p))||l.push(p);return l}(i)}var Ih=ht(function(i,o,l){Ot(i,o,l)}),Ep=ht(function(i,o,l,p){Ot(i,o,l,p)}),kh=Jt(function(i,o){var l={};if(null==i)return l;var p=!1;o=me(o,function(g){return g=an(g,i),p||(p=g.length>1),g}),It(i,vr(i),l),p&&(l=dt(l,Tt|On|Xe,Ec));for(var h=o.length;h--;)pr(l,o[h]);return l}),Rh=Jt(function(i,o){return null==i?{}:function Aa(i,o){return or(i,o,function(l,p){return np(i,p)})}(i,o)});function qp(i,o){if(null==i)return{};var l=me(vr(i),function(p){return[p]});return o=F(o),or(i,l,function(p,h){return o(p,h[0])})}var Zp=ns(Ye),Fp=ns(gt);function go(i){return null==i?[]:Zi(i,Ye(i))}var Hh=Gn(function(i,o,l){return o=o.toLowerCase(),i+(l?Np(o):o)});function Np(i){return ip(ce(i).toLowerCase())}function Up(i){return(i=ce(i))&&i.replace(Ds,cl).replace(Js,"")}var jh=Gn(function(i,o,l){return i+(l?"-":"")+o.toLowerCase()}),Kh=Gn(function(i,o,l){return i+(l?" ":"")+o.toLowerCase()}),Wh=Ka("toLowerCase"),om=Gn(function(i,o,l){return i+(l?"_":"")+o.toLowerCase()}),am=Gn(function(i,o,l){return i+(l?" ":"")+ip(o)}),fm=Gn(function(i,o,l){return i+(l?" ":"")+o.toUpperCase()}),ip=Ka("toUpperCase");function Jp(i,o,l){return i=ce(i),(o=l?f:o)===f?function hl(C){return Ys.test(C)}(i)?function tn(C){return C.match(Gs)||[]}(i):function ol(C){return C.match(ws)||[]}(i):i.match(o)||[]}var Gp=B(function(i,o){try{return tt(i,f,o)}catch(l){return Xc(l)?l:new G(l)}}),_m=Jt(function(i,o){return lt(o,function(l){l=K(l),Nt(i,l,Wc(i[l],i))}),i});function op(i){return function(){return i}}var Mm=$a(),Pm=$a(!0);function ft(i){return i}function rp(i){return Ia("function"==typeof i?i:dt(i,Tt))}var xm=B(function(i,o){return function(l){return hi(l,i,o)}}),wm=B(function(i,o){return function(l){return hi(i,l,o)}});function ap(i,o,l){var p=Ye(o),h=to(o,p);null==l&&(!Oe(o)||!h.length&&p.length)&&(l=o,o=i,i=this,h=to(o,Ye(o)));var g=!(Oe(l)&&"chain"in l&&!l.chain),_=bn(i);return lt(h,function(b){var M=o[b];i[b]=M,_&&(i.prototype[b]=function(){var S=this.__chain__;if(g||S){var I=i(this.__wrapped__);return(I.__actions__=$e(this.__actions__)).push({func:M,args:arguments,thisArg:i}),I.__chain__=S,I}return M.apply(i,Xt([this.value()],arguments))})}),i}function sp(){}var Sm=gr(me),Im=gr(ta),km=gr(qo);function Bp(i){return Pr(i)?ct(K(i)):function Ra(i){return function(o){return _n(o,i)}}(i)}var Rm=es(),Lm=es(!0);function lp(){return[]}function cp(){return!1}var Jm=so(function(i,o){return i+o},0),Gm=fr("ceil"),Bm=so(function(i,o){return i/o},1),Ym=fr("floor"),Wm=so(function(i,o){return i*o},1),$m=fr("round"),Xm=so(function(i,o){return i-o},0);return m.after=function Ou(i,o){if("function"!=typeof o)throw new pt(Ne);return i=z(i),function(){if(--i<1)return o.apply(this,arguments)}},m.ary=Cp,m.assign=ph,m.assignIn=Lp,m.assignInWith=fs,m.assignWith=dh,m.at=uh,m.before=Mp,m.bind=Wc,m.bindAll=_m,m.bindKey=Pp,m.castArray=function Eu(){if(!arguments.length)return[];var i=arguments[0];return Y(i)?i:[i]},m.chain=_p,m.chunk=function Vc(i,o,l){o=(l?Ve(i,o,l):o===f)?1:Ce(z(o),0);var p=null==i?0:i.length;if(!p||o<1)return[];for(var h=0,g=0,_=O(Vi(p/o));h<p;)_[g++]=it(i,h,h+=o);return _},m.compact=function Hp(i){for(var o=-1,l=null==i?0:i.length,p=0,h=[];++o<l;){var g=i[o];g&&(h[p++]=g)}return h},m.concat=function zp(){var i=arguments.length;if(!i)return[];for(var o=O(i-1),l=arguments[0],p=i;p--;)o[p-1]=arguments[p];return Xt(Y(l)?$e(l):[l],Fe(o,1))},m.cond=function vm(i){var o=null==i?0:i.length,l=F();return i=o?me(i,function(p){if("function"!=typeof p[1])throw new pt(Ne);return[l(p[0]),p[1]]}):[],B(function(p){for(var h=-1;++h<o;){var g=i[h];if(tt(g[0],this,p))return tt(g[1],this,p)}})},m.conforms=function bm(i){return function lc(i){var o=Ye(i);return function(l){return ya(l,i,o)}}(dt(i,Tt))},m.constant=op,m.countBy=eu,m.create=function hh(i,o){var l=Un(i);return null==o?l:Oa(l,o)},m.curry=function Op(i,o,l){var p=Ut(i,H,f,f,f,f,f,o=l?f:o);return p.placeholder=Op.placeholder,p},m.curryRight=function yp(i,o,l){var p=Ut(i,ge,f,f,f,f,f,o=l?f:o);return p.placeholder=yp.placeholder,p},m.debounce=xp,m.defaults=mh,m.defaultsDeep=gh,m.defer=yu,m.delay=xu,m.difference=Qp,m.differenceBy=Vp,m.differenceWith=jp,m.drop=function Kp(i,o,l){var p=null==i?0:i.length;return p?it(i,(o=l||o===f?1:z(o))<0?0:o,p):[]},m.dropRight=function Wp(i,o,l){var p=null==i?0:i.length;return p?it(i,0,(o=p-(o=l||o===f?1:z(o)))<0?0:o):[]},m.dropRightWhile=function $p(i,o){return i&&i.length?ro(i,F(o,3),!0,!0):[]},m.dropWhile=function Xp(i,o){return i&&i.length?ro(i,F(o,3),!0):[]},m.fill=function ed(i,o,l,p){var h=null==i?0:i.length;return h?(l&&"number"!=typeof l&&Ve(i,o,l)&&(l=0,p=h),function pc(i,o,l,p){var h=i.length;for((l=z(l))<0&&(l=-l>h?0:h+l),(p=p===f||p>h?h:z(p))<0&&(p+=h),p=l>p?0:Ap(p);l<p;)i[l++]=o;return i}(i,o,l,p)):[]},m.filter=function nu(i,o){return(Y(i)?$t:Ta)(i,F(o,3))},m.flatMap=function ru(i,o){return Fe(ps(i,o),1)},m.flatMapDeep=function au(i,o){return Fe(ps(i,o),jt)},m.flatMapDepth=function su(i,o,l){return l=l===f?1:z(l),Fe(ps(i,o),l)},m.flatten=hp,m.flattenDeep=function td(i){return null!=i&&i.length?Fe(i,jt):[]},m.flattenDepth=function nd(i,o){return null!=i&&i.length?Fe(i,o=o===f?1:z(o)):[]},m.flip=function wu(i){return Ut(i,Vt)},m.flow=Mm,m.flowRight=Pm,m.fromPairs=function id(i){for(var o=-1,l=null==i?0:i.length,p={};++o<l;){var h=i[o];p[h[0]]=h[1]}return p},m.functions=function Ph(i){return null==i?[]:to(i,Ye(i))},m.functionsIn=function Oh(i){return null==i?[]:to(i,gt(i))},m.groupBy=lu,m.initial=function rd(i){return null!=i&&i.length?it(i,0,-1):[]},m.intersection=ad,m.intersectionBy=sd,m.intersectionWith=ld,m.invert=xh,m.invertBy=wh,m.invokeMap=pu,m.iteratee=rp,m.keyBy=du,m.keys=Ye,m.keysIn=gt,m.map=ps,m.mapKeys=function Dh(i,o){var l={};return o=F(o,3),St(i,function(p,h,g){Nt(l,o(p,h,g),p)}),l},m.mapValues=function Sh(i,o){var l={};return o=F(o,3),St(i,function(p,h,g){Nt(l,h,o(p,h,g))}),l},m.matches=function Om(i){return tr(dt(i,Tt))},m.matchesProperty=function ym(i,o){return nr(i,dt(o,Tt))},m.memoize=us,m.merge=Ih,m.mergeWith=Ep,m.method=xm,m.methodOf=wm,m.mixin=ap,m.negate=hs,m.nthArg=function Dm(i){return i=z(i),B(function(o){return io(o,i)})},m.omit=kh,m.omitBy=function Ah(i,o){return qp(i,hs(F(o)))},m.once=function Tu(i){return Mp(2,i)},m.orderBy=function uu(i,o,l,p){return null==i?[]:(Y(o)||(o=null==o?[]:[o]),Y(l=p?f:l)||(l=null==l?[]:[l]),ut(i,o,l))},m.over=Sm,m.overArgs=Du,m.overEvery=Im,m.overSome=km,m.partial=$c,m.partialRight=wp,m.partition=hu,m.pick=Rh,m.pickBy=qp,m.property=Bp,m.propertyOf=function Am(i){return function(o){return null==i?f:_n(i,o)}},m.pull=ud,m.pullAll=gp,m.pullAllBy=function hd(i,o,l){return i&&i.length&&o&&o.length?rr(i,o,F(l,2)):i},m.pullAllWith=function md(i,o,l){return i&&i.length&&o&&o.length?rr(i,o,f,l):i},m.pullAt=gd,m.range=Rm,m.rangeRight=Lm,m.rearg=Su,m.reject=function fu(i,o){return(Y(i)?$t:Ta)(i,hs(F(o,3)))},m.remove=function fd(i,o){var l=[];if(!i||!i.length)return l;var p=-1,h=[],g=i.length;for(o=F(o,3);++p<g;){var _=i[p];o(_,p,i)&&(l.push(_),h.push(p))}return La(i,h),l},m.rest=function Iu(i,o){if("function"!=typeof i)throw new pt(Ne);return B(i,o=o===f?o:z(o))},m.reverse=jc,m.sampleSize=function vu(i,o,l){return o=(l?Ve(i,o,l):o===f)?1:z(o),(Y(i)?oc:Ea)(i,o)},m.set=function Eh(i,o,l){return null==i?i:gi(i,o,l)},m.setWith=function qh(i,o,l,p){return p="function"==typeof p?p:f,null==i?i:gi(i,o,l,p)},m.shuffle=function bu(i){return(Y(i)?rc:Fa)(i)},m.slice=function _d(i,o,l){var p=null==i?0:i.length;return p?(l&&"number"!=typeof l&&Ve(i,o,l)?(o=0,l=p):(o=null==o?0:z(o),l=l===f?p:z(l)),it(i,o,l)):[]},m.sortBy=Pu,m.sortedUniq=function yd(i){return i&&i.length?cr(i):[]},m.sortedUniqBy=function xd(i,o){return i&&i.length?cr(i,F(o,2)):[]},m.split=function rm(i,o,l){return l&&"number"!=typeof l&&Ve(i,o,l)&&(o=l=f),(l=l===f?vt:l>>>0)?(i=ce(i))&&("string"==typeof o||null!=o&&!ep(o))&&!(o=ot(o))&&En(i)?sn(Pt(i),0,l):i.split(o,l):[]},m.spread=function ku(i,o){if("function"!=typeof i)throw new pt(Ne);return o=null==o?0:Ce(z(o),0),B(function(l){var p=l[o],h=sn(l,0,o);return p&&Xt(h,p),tt(i,this,h)})},m.tail=function wd(i){var o=null==i?0:i.length;return o?it(i,1,o):[]},m.take=function Td(i,o,l){return i&&i.length?it(i,0,(o=l||o===f?1:z(o))<0?0:o):[]},m.takeRight=function Dd(i,o,l){var p=null==i?0:i.length;return p?it(i,(o=p-(o=l||o===f?1:z(o)))<0?0:o,p):[]},m.takeRightWhile=function Sd(i,o){return i&&i.length?ro(i,F(o,3),!1,!0):[]},m.takeWhile=function Id(i,o){return i&&i.length?ro(i,F(o,3)):[]},m.tap=function Hd(i,o){return o(i),i},m.throttle=function Au(i,o,l){var p=!0,h=!0;if("function"!=typeof i)throw new pt(Ne);return Oe(l)&&(p="leading"in l?!!l.leading:p,h="trailing"in l?!!l.trailing:h),xp(i,o,{leading:p,maxWait:o,trailing:h})},m.thru=cs,m.toArray=kp,m.toPairs=Zp,m.toPairsIn=Fp,m.toPath=function Nm(i){return Y(i)?me(i,K):yt(i)?[i]:$e(ln(ce(i)))},m.toPlainObject=Rp,m.transform=function Zh(i,o,l){var p=Y(i),h=p||Hn(i)||mo(i);if(o=F(o,4),null==l){var g=i&&i.constructor;l=h?p?new g:[]:Oe(i)&&bn(g)?Un(zi(i)):{}}return(h?lt:St)(i,function(_,b,M){return o(l,_,b,M)}),l},m.unary=function Ru(i){return Cp(i,1)},m.union=kd,m.unionBy=Ad,m.unionWith=Rd,m.uniq=function Ld(i){return i&&i.length?rn(i):[]},m.uniqBy=function Ed(i,o){return i&&i.length?rn(i,F(o,2)):[]},m.uniqWith=function qd(i,o){return o="function"==typeof o?o:f,i&&i.length?rn(i,f,o):[]},m.unset=function Fh(i,o){return null==i||pr(i,o)},m.unzip=Kc,m.unzipWith=fp,m.update=function Nh(i,o,l){return null==i?i:Ua(i,o,ur(l))},m.updateWith=function Uh(i,o,l,p){return p="function"==typeof p?p:f,null==i?i:Ua(i,o,ur(l),p)},m.values=go,m.valuesIn=function Jh(i){return null==i?[]:Zi(i,gt(i))},m.without=Zd,m.words=Jp,m.wrap=function Lu(i,o){return $c(ur(o),i)},m.xor=Fd,m.xorBy=Nd,m.xorWith=Ud,m.zip=Jd,m.zipObject=function Gd(i,o){return Ga(i||[],o||[],di)},m.zipObjectDeep=function Bd(i,o){return Ga(i||[],o||[],gi)},m.zipWith=Yd,m.entries=Zp,m.entriesIn=Fp,m.extend=Lp,m.extendWith=fs,ap(m,m),m.add=Jm,m.attempt=Gp,m.camelCase=Hh,m.capitalize=Np,m.ceil=Gm,m.clamp=function Gh(i,o,l){return l===f&&(l=o,o=f),l!==f&&(l=(l=At(l))==l?l:0),o!==f&&(o=(o=At(o))==o?o:0),fn(At(i),o,l)},m.clone=function qu(i){return dt(i,Xe)},m.cloneDeep=function Fu(i){return dt(i,Tt|Xe)},m.cloneDeepWith=function Nu(i,o){return dt(i,Tt|Xe,o="function"==typeof o?o:f)},m.cloneWith=function Zu(i,o){return dt(i,Xe,o="function"==typeof o?o:f)},m.conformsTo=function Uu(i,o){return null==o||ya(i,o,Ye(o))},m.deburr=Up,m.defaultTo=function Cm(i,o){return null==i||i!=i?o:i},m.divide=Bm,m.endsWith=function zh(i,o,l){i=ce(i),o=ot(o);var p=i.length,h=l=l===f?p:fn(z(l),0,p);return(l-=o.length)>=0&&i.slice(l,h)==o},m.eq=Yt,m.escape=function Qh(i){return(i=ce(i))&&pp.test(i)?i.replace(Lr,pl):i},m.escapeRegExp=function Vh(i){return(i=ce(i))&&Ps.test(i)?i.replace(Po,"\\$&"):i},m.every=function tu(i,o,l){var p=Y(i)?ta:cc;return l&&Ve(i,o,l)&&(o=f),p(i,F(o,3))},m.find=iu,m.findIndex=dp,m.findKey=function fh(i,o){return na(i,F(o,3),St)},m.findLast=ou,m.findLastIndex=up,m.findLastKey=function _h(i,o){return na(i,F(o,3),Vo)},m.floor=Ym,m.forEach=vp,m.forEachRight=bp,m.forIn=function vh(i,o){return null==i?i:Qo(i,F(o,3),gt)},m.forInRight=function bh(i,o){return null==i?i:Da(i,F(o,3),gt)},m.forOwn=function Ch(i,o){return i&&St(i,F(o,3))},m.forOwnRight=function Mh(i,o){return i&&Vo(i,F(o,3))},m.get=tp,m.gt=Ju,m.gte=Gu,m.has=function yh(i,o){return null!=i&&ss(i,o,dc)},m.hasIn=np,m.head=mp,m.identity=ft,m.includes=function cu(i,o,l,p){i=mt(i)?i:go(i),l=l&&!p?z(l):0;var h=i.length;return l<0&&(l=Ce(h+l,0)),gs(i)?l<=h&&i.indexOf(o,l)>-1:!!h&&An(i,o,l)>-1},m.indexOf=function od(i,o,l){var p=null==i?0:i.length;if(!p)return-1;var h=null==l?0:z(l);return h<0&&(h=Ce(p+h,0)),An(i,o,h)},m.inRange=function Bh(i,o,l){return o=Cn(o),l===f?(l=o,o=0):l=Cn(l),function hc(i,o,l){return i>=Ue(o,l)&&i<Ce(o,l)}(i=At(i),o,l)},m.invoke=Th,m.isArguments=_i,m.isArray=Y,m.isArrayBuffer=Bu,m.isArrayLike=mt,m.isArrayLikeObject=Se,m.isBoolean=function Yu(i){return!0===i||!1===i||Te(i)&&Qe(i)==Kt},m.isBuffer=Hn,m.isDate=Hu,m.isElement=function zu(i){return Te(i)&&1===i.nodeType&&!yr(i)},m.isEmpty=function Qu(i){if(null==i)return!0;if(mt(i)&&(Y(i)||"string"==typeof i||"function"==typeof i.splice||Hn(i)||mo(i)||_i(i)))return!i.length;var o=Ge(i);if(o==bt||o==st)return!i.size;if(a(i))return!Xo(i).length;for(var l in i)if(ae.call(i,l))return!1;return!0},m.isEqual=function Vu(i,o){return Jn(i,o)},m.isEqualWith=function ju(i,o,l){var p=(l="function"==typeof l?l:f)?l(i,o):f;return p===f?Jn(i,o,f,l):!!p},m.isError=Xc,m.isFinite=function Ku(i){return"number"==typeof i&&fa(i)},m.isFunction=bn,m.isInteger=Tp,m.isLength=ms,m.isMap=Dp,m.isMatch=function Wu(i,o){return i===o||$o(i,o,Cr(o))},m.isMatchWith=function $u(i,o,l){return l="function"==typeof l?l:f,$o(i,o,Cr(o),l)},m.isNaN=function Xu(i){return Sp(i)&&i!=+i},m.isNative=function eh(i){if(Qc(i))throw new G("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Sa(i)},m.isNil=function nh(i){return null==i},m.isNull=function th(i){return null===i},m.isNumber=Sp,m.isObject=Oe,m.isObjectLike=Te,m.isPlainObject=yr,m.isRegExp=ep,m.isSafeInteger=function ih(i){return Tp(i)&&i>=-Lt&&i<=Lt},m.isSet=Ip,m.isString=gs,m.isSymbol=yt,m.isTypedArray=mo,m.isUndefined=function oh(i){return i===f},m.isWeakMap=function rh(i){return Te(i)&&Ge(i)==Xn},m.isWeakSet=function ah(i){return Te(i)&&"[object WeakSet]"==Qe(i)},m.join=function cd(i,o){return null==i?"":Ki.call(i,o)},m.kebabCase=jh,m.last=kt,m.lastIndexOf=function pd(i,o,l){var p=null==i?0:i.length;if(!p)return-1;var h=p;return l!==f&&(h=(h=z(l))<0?Ce(p+h,0):Ue(h,p-1)),o==o?function _l(C,x,O){for(var L=O+1;L--;)if(C[L]===x)return L;return L}(i,o,h):Ei(i,Rn,h,!0)},m.lowerCase=Kh,m.lowerFirst=Wh,m.lt=sh,m.lte=lh,m.max=function Hm(i){return i&&i.length?eo(i,ft,jo):f},m.maxBy=function zm(i,o){return i&&i.length?eo(i,F(o,2),jo):f},m.mean=function Qm(i){return Ln(i,ft)},m.meanBy=function Vm(i,o){return Ln(i,F(o,2))},m.min=function jm(i){return i&&i.length?eo(i,ft,er):f},m.minBy=function Km(i,o){return i&&i.length?eo(i,F(o,2),er):f},m.stubArray=lp,m.stubFalse=cp,m.stubObject=function Em(){return{}},m.stubString=function qm(){return""},m.stubTrue=function Zm(){return!0},m.multiply=Wm,m.nth=function dd(i,o){return i&&i.length?io(i,z(o)):f},m.noConflict=function Tm(){return Ae._===this&&(Ae._=ca),this},m.noop=sp,m.now=ds,m.pad=function $h(i,o,l){i=ce(i);var p=(o=z(o))?qn(i):0;if(!o||p>=o)return i;var h=(o-p)/2;return lo(ji(h),l)+i+lo(Vi(h),l)},m.padEnd=function Xh(i,o,l){i=ce(i);var p=(o=z(o))?qn(i):0;return o&&p<o?i+lo(o-p,l):i},m.padStart=function em(i,o,l){i=ce(i);var p=(o=z(o))?qn(i):0;return o&&p<o?lo(o-p,l)+i:i},m.parseInt=function tm(i,o,l){return l||null==o?o=0:o&&(o=+o),Il(ce(i).replace(Di,""),o||0)},m.random=function Yh(i,o,l){if(l&&"boolean"!=typeof l&&Ve(i,o,l)&&(o=l=f),l===f&&("boolean"==typeof o?(l=o,o=f):"boolean"==typeof i&&(l=i,i=f)),i===f&&o===f?(i=0,o=1):(i=Cn(i),o===f?(o=i,i=0):o=Cn(o)),i>o){var p=i;i=o,o=p}if(l||i%1||o%1){var h=va();return Ue(i+h*(o-i+Ks("1e-"+((h+"").length-1))),o)}return ar(i,o)},m.reduce=function mu(i,o,l){var p=Y(i)?Eo:ia,h=arguments.length<3;return p(i,F(o,4),l,h,on)},m.reduceRight=function gu(i,o,l){var p=Y(i)?tl:ia,h=arguments.length<3;return p(i,F(o,4),l,h,wa)},m.repeat=function nm(i,o,l){return o=(l?Ve(i,o,l):o===f)?1:z(o),mi(ce(i),o)},m.replace=function im(){var i=arguments,o=ce(i[0]);return i.length<3?o:o.replace(i[1],i[2])},m.result=function Lh(i,o,l){var p=-1,h=(o=an(o,i)).length;for(h||(h=1,i=f);++p<h;){var g=null==i?f:i[K(o[p])];g===f&&(p=h,g=l),i=bn(g)?g.call(i):g}return i},m.round=$m,m.runInContext=C,m.sample=function _u(i){return(Y(i)?Pa:sr)(i)},m.size=function Cu(i){if(null==i)return 0;if(mt(i))return gs(i)?qn(i):i.length;var o=Ge(i);return o==bt||o==st?i.size:Xo(i).length},m.snakeCase=om,m.some=function Mu(i,o,l){var p=Y(i)?qo:Oc;return l&&Ve(i,o,l)&&(o=f),p(i,F(o,3))},m.sortedIndex=function vd(i,o){return oo(i,o)},m.sortedIndexBy=function bd(i,o,l){return lr(i,o,F(l,2))},m.sortedIndexOf=function Cd(i,o){var l=null==i?0:i.length;if(l){var p=oo(i,o);if(p<l&&Yt(i[p],o))return p}return-1},m.sortedLastIndex=function Md(i,o){return oo(i,o,!0)},m.sortedLastIndexBy=function Pd(i,o,l){return lr(i,o,F(l,2),!0)},m.sortedLastIndexOf=function Od(i,o){if(null!=i&&i.length){var p=oo(i,o,!0)-1;if(Yt(i[p],o))return p}return-1},m.startCase=am,m.startsWith=function sm(i,o,l){return i=ce(i),l=null==l?0:fn(z(l),0,i.length),o=ot(o),i.slice(l,l+o.length)==o},m.subtract=Xm,m.sum=function eg(i){return i&&i.length?Fo(i,ft):0},m.sumBy=function tg(i,o){return i&&i.length?Fo(i,F(o,2)):0},m.template=function lm(i,o,l){var p=m.templateSettings;l&&Ve(i,o,l)&&(o=f),i=ce(i),o=fs({},o,p,is);var b,M,h=fs({},o.imports,p.imports,is),g=Ye(h),_=Zi(h,g),S=0,I=o.interpolate||Si,A="__p += '",R=Uo((o.escape||Si).source+"|"+I.source+"|"+(I===Le?Ct:Si).source+"|"+(o.evaluate||Si).source+"|$","g"),Z="//# sourceURL="+(ae.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Hs+"]")+"\n";i.replace(R,function(U,$,ee,xt,rt,wt){return ee||(ee=xt),A+=i.slice(S,wt).replace(Fr,dl),$&&(b=!0,A+="' +\n__e("+$+") +\n'"),rt&&(M=!0,A+="';\n"+rt+";\n__p += '"),ee&&(A+="' +\n((__t = ("+ee+")) == null ? '' : __t) +\n'"),S=wt+U.length,U}),A+="';\n";var N=ae.call(o,"variable")&&o.variable;if(N){if(Ts.test(N))throw new G("Invalid `variable` option passed into `_.template`")}else A="with (obj) {\n"+A+"\n}\n";A=(M?A.replace(kr,""):A).replace(bs,"$1").replace(Ar,"$1;"),A="function("+(N||"obj")+") {\n"+(N?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(b?", __e = _.escape":"")+(M?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+A+"return __p\n}";var Q=Gp(function(){return ie(g,Z+"return "+A).apply(f,_)});if(Q.source=A,Xc(Q))throw Q;return Q},m.times=function Fm(i,o){if((i=z(i))<1||i>Lt)return[];var l=vt,p=Ue(i,vt);o=F(o),i-=vt;for(var h=oa(p,o);++l<i;)o(l);return h},m.toFinite=Cn,m.toInteger=z,m.toLength=Ap,m.toLower=function cm(i){return ce(i).toLowerCase()},m.toNumber=At,m.toSafeInteger=function ch(i){return i?fn(z(i),-Lt,Lt):0===i?i:0},m.toString=ce,m.toUpper=function pm(i){return ce(i).toUpperCase()},m.trim=function dm(i,o,l){if((i=ce(i))&&(l||o===f))return qi(i);if(!i||!(o=ot(o)))return i;var p=Pt(i),h=Pt(o);return sn(p,Fi(p,h),ra(p,h)+1).join("")},m.trimEnd=function um(i,o,l){if((i=ce(i))&&(l||o===f))return i.slice(0,sa(i)+1);if(!i||!(o=ot(o)))return i;var p=Pt(i);return sn(p,0,ra(p,Pt(o))+1).join("")},m.trimStart=function hm(i,o,l){if((i=ce(i))&&(l||o===f))return i.replace(Di,"");if(!i||!(o=ot(o)))return i;var p=Pt(i);return sn(p,Fi(p,Pt(o))).join("")},m.truncate=function mm(i,o){var l=30,p="...";if(Oe(o)){var h="separator"in o?o.separator:h;l="length"in o?z(o.length):l,p="omission"in o?ot(o.omission):p}var g=(i=ce(i)).length;if(En(i)){var _=Pt(i);g=_.length}if(l>=g)return i;var b=l-qn(p);if(b<1)return p;var M=_?sn(_,0,b).join(""):i.slice(0,b);if(h===f)return M+p;if(_&&(b+=M.length-b),ep(h)){if(i.slice(b).search(h)){var S,I=M;for(h.global||(h=Uo(h.source,ce(Ee.exec(h))+"g")),h.lastIndex=0;S=h.exec(I);)var A=S.index;M=M.slice(0,A===f?b:A)}}else if(i.indexOf(ot(h),b)!=b){var R=M.lastIndexOf(h);R>-1&&(M=M.slice(0,R))}return M+p},m.unescape=function gm(i){return(i=ce(i))&&Er.test(i)?i.replace(Rr,vl):i},m.uniqueId=function Um(i){var o=++yl;return ce(i)+o},m.upperCase=fm,m.upperFirst=ip,m.each=vp,m.eachRight=bp,m.first=mp,ap(m,function(){var i={};return St(m,function(o,l){ae.call(m.prototype,l)||(i[l]=o)}),i}(),{chain:!1}),m.VERSION="4.17.21",lt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){m[i].placeholder=m}),lt(["drop","take"],function(i,o){V.prototype[i]=function(l){l=l===f?1:Ce(z(l),0);var p=this.__filtered__&&!o?new V(this):this.clone();return p.__filtered__?p.__takeCount__=Ue(l,p.__takeCount__):p.__views__.push({size:Ue(l,vt),type:i+(p.__dir__<0?"Right":"")}),p},V.prototype[i+"Right"]=function(l){return this.reverse()[i](l).reverse()}}),lt(["filter","map","takeWhile"],function(i,o){var l=o+1,p=1==l||3==l;V.prototype[i]=function(h){var g=this.clone();return g.__iteratees__.push({iteratee:F(h,3),type:l}),g.__filtered__=g.__filtered__||p,g}}),lt(["head","last"],function(i,o){var l="take"+(o?"Right":"");V.prototype[i]=function(){return this[l](1).value()[0]}}),lt(["initial","tail"],function(i,o){var l="drop"+(o?"":"Right");V.prototype[i]=function(){return this.__filtered__?new V(this):this[l](1)}}),V.prototype.compact=function(){return this.filter(ft)},V.prototype.find=function(i){return this.filter(i).head()},V.prototype.findLast=function(i){return this.reverse().find(i)},V.prototype.invokeMap=B(function(i,o){return"function"==typeof i?new V(this):this.map(function(l){return hi(l,i,o)})}),V.prototype.reject=function(i){return this.filter(hs(F(i)))},V.prototype.slice=function(i,o){i=z(i);var l=this;return l.__filtered__&&(i>0||o<0)?new V(l):(i<0?l=l.takeRight(-i):i&&(l=l.drop(i)),o!==f&&(l=(o=z(o))<0?l.dropRight(-o):l.take(o-i)),l)},V.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},V.prototype.toArray=function(){return this.take(vt)},St(V.prototype,function(i,o){var l=/^(?:filter|find|map|reject)|While$/.test(o),p=/^(?:head|last)$/.test(o),h=m[p?"take"+("last"==o?"Right":""):o],g=p||/^find/.test(o);h&&(m.prototype[o]=function(){var _=this.__wrapped__,b=p?[1]:arguments,M=_ instanceof V,S=b[0],I=M||Y(_),A=function($){var ee=h.apply(m,Xt([$],b));return p&&R?ee[0]:ee};I&&l&&"function"==typeof S&&1!=S.length&&(M=I=!1);var R=this.__chain__,N=g&&!R,Q=M&&!this.__actions__.length;if(!g&&I){_=Q?_:new V(this);var U=i.apply(_,b);return U.__actions__.push({func:cs,args:[A],thisArg:f}),new We(U,R)}return N&&Q?i.apply(this,b):(U=this.thru(A),N?p?U.value()[0]:U.value():U)})}),lt(["pop","push","shift","sort","splice","unshift"],function(i){var o=Ui[i],l=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",p=/^(?:pop|shift)$/.test(i);m.prototype[i]=function(){var h=arguments;if(p&&!this.__chain__){var g=this.value();return o.apply(Y(g)?g:[],h)}return this[l](function(_){return o.apply(Y(_)?_:[],h)})}}),St(V.prototype,function(i,o){var l=m[o];if(l){var p=l.name+"";ae.call(Nn,p)||(Nn[p]=[]),Nn[p].push({name:o,func:l})}}),Nn[ao(f,te).name]=[{name:"wrapper",func:f}],V.prototype.clone=function Zl(){var i=new V(this.__wrapped__);return i.__actions__=$e(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=$e(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=$e(this.__views__),i},V.prototype.reverse=function Yo(){if(this.__filtered__){var i=new V(this);i.__dir__=-1,i.__filtered__=!0}else(i=this.clone()).__dir__*=-1;return i},V.prototype.value=function Xi(){var i=this.__wrapped__.value(),o=this.__dir__,l=Y(i),p=o<0,h=l?i.length:0,g=function Nc(i,o,l){for(var p=-1,h=l.length;++p<h;){var g=l[p],_=g.size;switch(g.type){case"drop":i+=_;break;case"dropRight":o-=_;break;case"take":o=Ue(o,i+_);break;case"takeRight":i=Ce(i,o-_)}}return{start:i,end:o}}(0,h,this.__views__),_=g.start,b=g.end,M=b-_,S=p?b:_-1,I=this.__iteratees__,A=I.length,R=0,Z=Ue(M,this.__takeCount__);if(!l||!p&&h==M&&Z==M)return Ja(i,this.__actions__);var N=[];e:for(;M--&&R<Z;){for(var Q=-1,U=i[S+=o];++Q<A;){var $=I[Q],xt=$.type,rt=(0,$.iteratee)(U);if(2==xt)U=rt;else if(!rt){if(1==xt)continue e;break e}}N[R++]=U}return N},m.prototype.at=zd,m.prototype.chain=function Qd(){return _p(this)},m.prototype.commit=function Vd(){return new We(this.value(),this.__chain__)},m.prototype.next=function jd(){this.__values__===f&&(this.__values__=kp(this.value()));var i=this.__index__>=this.__values__.length;return{done:i,value:i?f:this.__values__[this.__index__++]}},m.prototype.plant=function Wd(i){for(var o,l=this;l instanceof pi;){var p=ho(l);p.__index__=0,p.__values__=f,o?h.__wrapped__=p:o=p;var h=p;l=l.__wrapped__}return h.__wrapped__=i,o},m.prototype.reverse=function $d(){var i=this.__wrapped__;if(i instanceof V){var o=i;return this.__actions__.length&&(o=new V(this)),(o=o.reverse()).__actions__.push({func:cs,args:[jc],thisArg:f}),new We(o,this.__chain__)}return this.thru(jc)},m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=function Xd(){return Ja(this.__wrapped__,this.__actions__)},m.prototype.first=m.prototype.head,ri&&(m.prototype[ri]=function Kd(){return this}),m}();Ae._=qt,(e=function(){return qt}.call(Qt,k,Qt,zt))!==f&&(zt.exports=e)}.call(this)}}]);