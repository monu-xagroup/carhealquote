!function(){"use strict";function e(e,o){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,i,a,r,s=[],c=!0,l=!1;try{if(a=(o=o.call(e)).next,0===t){if(Object(o)!==o)return;c=!1}else for(;!(c=(n=a.call(o)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=o.return&&(r=o.return(),Object(r)!==r))return}finally{if(l)throw i}}return s}}(e,o)||function(e,o){if(!e)return;if("string"==typeof e)return t(e,o);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,o)}(e,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(e,t,o){e[t]=o.value},r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function d(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,o){return e[t]=o}}function m(e,t,o,n){var i=t&&t.prototype instanceof v?t:v,r=Object.create(i.prototype),s=new S(n||[]);return a(r,"_invoke",{value:D(e,o,s)}),r}function u(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}t.wrap=m;var p="suspendedStart",h="executing",g="completed",f={};function v(){}function b(){}function y(){}var M={};d(M,s,function(){return this});var C=Object.getPrototypeOf,w=C&&C(C(_([])));w&&w!==n&&i.call(w,s)&&(M=w);var O=y.prototype=v.prototype=Object.create(M);function x(e){["next","throw","return"].forEach(function(t){d(e,t,function(e){return this._invoke(t,e)})})}function I(e,t){function o(n,a,r,s){var c=u(e[n],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==typeof d&&i.call(d,"__await")?t.resolve(d.__await).then(function(e){o("next",e,r,s)},function(e){o("throw",e,r,s)}):t.resolve(d).then(function(e){l.value=e,r(l)},function(e){return o("throw",e,r,s)})}s(c.arg)}var n;a(this,"_invoke",{value:function(e,i){function a(){return new t(function(t,n){o(e,i,t,n)})}return n=n?n.then(a,a):a()}})}function D(t,o,n){var i=p;return function(a,r){if(i===h)throw new Error("Generator is already running");if(i===g){if("throw"===a)throw r;return{value:e,done:!0}}for(n.method=a,n.arg=r;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=h;var l=u(t,o,n);if("normal"===l.type){if(i=n.done?g:"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=g,n.method="throw",n.arg=l.arg)}}}function P(t,o){var n=o.method,i=t.iterator[n];if(i===e)return o.delegate=null,"throw"===n&&t.iterator.return&&(o.method="return",o.arg=e,P(t,o),"throw"===o.method)||"return"!==n&&(o.method="throw",o.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var a=u(i,t.iterator,o.arg);if("throw"===a.type)return o.method="throw",o.arg=a.arg,o.delegate=null,f;var r=a.arg;return r?r.done?(o[t.resultName]=r.value,o.next=t.nextLoc,"return"!==o.method&&(o.method="next",o.arg=e),o.delegate=null,f):r:(o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,f)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function q(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function _(t){if(t||""===t){var o=t[s];if(o)return o.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function o(){for(;++n<t.length;)if(i.call(t,n))return o.value=t[n],o.done=!1,o;return o.value=e,o.done=!0,o};return a.next=a}}throw new TypeError(typeof t+" is not iterable")}return b.prototype=y,a(O,"constructor",{value:y,configurable:!0}),a(y,"constructor",{value:b,configurable:!0}),b.displayName=d(y,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},x(I.prototype),d(I.prototype,c,function(){return this}),t.AsyncIterator=I,t.async=function(e,o,n,i,a){void 0===a&&(a=Promise);var r=new I(m(e,o,n,i),a);return t.isGeneratorFunction(o)?r:r.next().then(function(e){return e.done?e.value:r.next()})},x(O),d(O,l,"Generator"),d(O,s,function(){return this}),d(O,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),o=[];for(var n in t)o.push(n);return o.reverse(),function e(){for(;o.length;){var n=o.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=_,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(q),!t)for(var o in this)"t"===o.charAt(0)&&i.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var o=this;function n(n,i){return s.type="throw",s.arg=t,o.next=n,i&&(o.method="next",o.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],s=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var c=i.call(r,"catchLoc"),l=i.call(r,"finallyLoc");if(c&&l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var r=a?a.completion:{};return r.type=e,r.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),q(o),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var n=o.completion;if("throw"===n.type){var i=n.arg;q(o)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,o,n){return this.delegate={iterator:_(t),resultName:o,nextLoc:n},"next"===this.method&&(this.arg=e),f}},t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var o,n=s(e);if(t){var i=s(this).constructor;o=Reflect.construct(n,arguments,i)}else o=n.apply(this,arguments);return r(this,o)}}function r(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function c(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=n.key,a=void 0,"symbol"==typeof(a=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"))?a:String(a)),n)}var i,a}function l(e,t,o){return t&&c(e.prototype,t),o&&c(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkcar_heal_quote=self.webpackChunkcar_heal_quote||[]).push([[937],{40937:function(t,i,r){r.r(i),r.d(i,{ChqNewCaseModule:function(){return vt},MyHammerConfig:function(){return gt}});var s=r(38583),c=r(55278),m=r(89993),u=r(76627),p=r(25852),h=r(7408),g=r(54121),f=r(37716),v=function(){var e=l(function e(){d(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=f.Xpm({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),b=function(e){n(o,e);var t=a(o);function o(){return d(this,o),t.apply(this,arguments)}return l(o,[{key:"canDeactivate",value:function(){return!this.checkDataChanged()}}]),o}(v),y=r(83853),M=r(4893),C=r(95016),w=r(38709),O=r(85567),x=r(35782),I=r(67017),D=r(36978),P=r(54135),k=r(29790),q=["companyOrg"],S=["licenseId"],_=["driverPhone"],Z=["driverCode"],T=["orgType"];function F(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-input",33),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw(2).onFormUpdate(e)}),f.qZA()}if(2&e){var n=f.oxw(2);f.Q6J("inputModel",n.formModel.claimNumber)}}var N=function(e){return{hide:e}};function j(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",34),f.TgZ(1,"div",35),f.TgZ(2,"div",36),f.TgZ(3,"label",10),f._uU(4),f.ALo(5,"translate"),f.qZA(),f.TgZ(6,"chq-input",37),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw(2).onFormUpdate(e)}),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&e){var n=f.oxw(2);f.Q6J("ngClass",f.VKq(5,N,n.isFormConfirmed)),f.xp6(4),f.Oqu(f.lcZ(5,3,"car_owner_details")),f.xp6(2),f.Q6J("inputModel",n.formModel.carOwnerSelector)}}var A=function(e){return{"disable-input disable-controls":e}};function E(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",5),f.TgZ(1,"div",35),f.TgZ(2,"div",36),f.TgZ(3,"label",10),f._uU(4),f.ALo(5,"translate"),f.qZA(),f.TgZ(6,"chq-input",38,39),f.NdJ("clicked",function(e){return f.CHM(o),f.oxw(2).hideDropdown(e)})("controlOutput",function(e){return f.CHM(o),f.oxw(2).onFormUpdate(e)}),f.qZA(),f.TgZ(8,"chq-input",40,41),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw(2).onFormUpdate(e)}),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&e){var n=f.oxw(2);f.xp6(4),f.Oqu(n.isRetailProvider&&n.isFormConfirmed?"car_owner_details":f.lcZ(5,4,"company_details")),f.xp6(2),f.Q6J("inputModel",n.formModel.companyName),f.xp6(2),f.Q6J("ngClass",f.VKq(6,A,"select"===n.formModel.companyName.type))("inputModel",n.formModel.licenseId)}}function J(e,t){if(1&e&&f._UZ(0,"chq-button",42),2&e){var o=f.oxw(2);f.Q6J("buttonModel",o.confirmButtonModel)}}function L(e,t){if(1&e&&f._UZ(0,"chq-button",42),2&e){var o=f.oxw(2);f.Q6J("buttonModel",o.nextButtonModel)}}var R=function(e){return{"text-mode":e}};function V(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",2),f._UZ(1,"chq-step-header",3),f.TgZ(2,"form",4),f.TgZ(3,"div",5),f.TgZ(4,"div",6),f.TgZ(5,"chq-input",7),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(6,"div",5),f.TgZ(7,"div",8),f.TgZ(8,"div",9),f.TgZ(9,"label",10),f._uU(10),f.ALo(11,"translate"),f.qZA(),f.TgZ(12,"chq-input",11,12),f.NdJ("clicked",function(e){return f.CHM(o),f.oxw().hideDropdown(e)})("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.YNc(14,F,1,1,"chq-input",13),f.qZA(),f.qZA(),f.qZA(),f.YNc(15,j,7,7,"div",14),f.YNc(16,E,10,8,"div",15),f.TgZ(17,"div",5),f.TgZ(18,"div",16),f.TgZ(19,"div",17),f.TgZ(20,"label",10),f._uU(21),f.ALo(22,"translate"),f.qZA(),f.TgZ(23,"div",18),f.TgZ(24,"chq-input",19),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.TgZ(25,"chq-input",19),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(26,"div",20),f.TgZ(27,"div",18),f.TgZ(28,"chq-input",21),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.TgZ(29,"div",22),f.TgZ(30,"div",18),f.TgZ(31,"chq-input",23,24),f.NdJ("clicked",function(e){return f.CHM(o),f.oxw().hideDropdown(e)})("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.TgZ(33,"chq-input",25,26),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(35,"div",27),f.TgZ(36,"div",28),f.TgZ(37,"div",29),f._UZ(38,"img",30),f.qZA(),f.qZA(),f.TgZ(39,"div",31),f.YNc(40,J,1,1,"chq-button",32),f.YNc(41,L,1,1,"chq-button",32),f.qZA(),f.qZA(),f.qZA()}if(2&e){var n=f.oxw();f.Q6J("ngClass",f.VKq(20,R,n.isFormConfirmed)),f.xp6(1),f.Q6J("chqModel",n.header),f.xp6(4),f.Q6J("inputModel",n.formModel.jobNumber),f.xp6(5),f.Oqu(f.lcZ(11,16,"work_provider_details")),f.xp6(2),f.Q6J("inputModel",n.formModel.companyOrgType),f.xp6(2),f.Q6J("ngIf","Insurance Company"===n.customerFormData.companyOrgType),f.xp6(1),f.Q6J("ngIf",n.isRetailProvider),f.xp6(1),f.Q6J("ngIf",!n.isRetailProvider||n.customerFormData[n.formModel.carOwnerSelector.name]&&"Person"!==n.customerFormData[n.formModel.carOwnerSelector.name]),f.xp6(5),f.Oqu(n.isRetailProvider&&n.isFormConfirmed&&n.customerFormData[n.formModel.carOwnerSelector.name]&&"Person"===n.customerFormData[n.formModel.carOwnerSelector.name]?"car_owner_details":f.lcZ(22,18,"drivers_details")),f.xp6(3),f.Q6J("inputModel",n.formModel.firstName),f.xp6(1),f.Q6J("inputModel",n.formModel.lastName),f.xp6(3),f.Q6J("inputModel",n.formModel.email),f.xp6(3),f.Q6J("inputModel",n.formModel.driverCode),f.xp6(2),f.Q6J("inputModel",n.formModel.driverPhone),f.xp6(7),f.Q6J("ngIf",n.currentCaseStatus),f.xp6(1),f.Q6J("ngIf",n.isFormConfirmed&&!n.commonService.isViewOnly)}}function Y(e,t){1&e&&f._UZ(0,"no-access-error")}var Q=function(){var e=function(e){n(o,e);var t=a(o);function o(e,n,i,a,r,s){var c;return d(this,o),(c=t.call(this)).router=e,c.commonService=n,c.monitorService=i,c.caseService=a,c.coreService=r,c.route=s,c.header=y.XJ,c.isApiLoading=!0,c.confirmButtonModel={label:"",type:"primary"},c.nextButtonModel={label:"",type:"primary"},c.isFormConfirmed=!1,c.isRetail=!0,c.customerFormData={jobNumber:"",companyOrgType:"",claimNumber:"",companyName:"",tariffId:0,isTariffEditable:!0,licenseId:"",firstName:"",lastName:"",companyId:0,partnershipId:0,customerTypeID:1,driverCode:"",driverPhone:0,carOwnerSelector:"",email:""},c.caseId="0",c.caseObjectId=0,c.showNoAccess=!1,c.commonService.accessRight.closed&&(c.commonService.accessRight=new g.X(!0)),c.commonService.userProfileData.subscribe(function(e){if(e&&e.data){var t=e.data.organizationDetail;t&&(c.currentOrgId=t.id)}}),c}return l(o,[{key:"checkDataChanged",value:function(){return!this.isFormConfirmed&&(this.originalData?this.compareObjects(this.originalData,this.customerFormData):!!this.checkDataDirty())}},{key:"compareObjects",value:function(e,t){var o=Object.keys(e);for(var n in o){var i=o[n];if(e[i]!==t[i])return!0}return!1}},{key:"isRetailProvider",get:function(){return!!this.customerFormData.companyOrgType&&"Retail"===this.customerFormData.companyOrgType}},{key:"ngAfterViewInit",value:function(){this.commonService.updatePage("/quote/case/0"),this.monitorService.logEvent("ngAfterViewInit",["ChqNewCustomerComponent","addenda-quote",{caseId:this.caseId}])}},{key:"isRetailAndCompanyProvider",get:function(){return!!this.customerFormData.companyOrgType&&("Retail"!==this.customerFormData.companyOrgType||"Retail"===this.customerFormData.companyOrgType&&this.customerFormData.carOwnerSelector&&"Person"!==this.customerFormData.carOwnerSelector)}},{key:"retail",get:function(){return this.customerFormData.companyOrgType?this.formModel.companyOrgType.selectedOption[this.formModel.companyOrgType.displayValue]:""}},{key:"updateButton",value:function(){var e=Object.keys(this.formModel);for(var t in e){var o=e[t];this.formModel[o]=Object.assign(Object.assign({},this.formModel[o]),{mode:this.isFormConfirmed?"value":"text"})}this.isFormConfirmed=!this.isFormConfirmed,this.confirmButtonModel=Object.assign(Object.assign({},this.confirmButtonModel),{label:this.isFormConfirmed?"Change details":"Confirm",type:this.isFormConfirmed?"outline":"primary",icon:this.isFormConfirmed?"gobackward":"check"}),this.monitorService.logEvent("updateButton",["ChqNewCustomerComponent","addenda-quote",{caseId:this.caseId}])}},{key:"setTextMode",value:function(){var e=Object.keys(this.formModel);for(var t in e){var o=e[t];if("companyOrgType"===o){var n={},i=this.formModel[o],a=i.displayValue;n[i.fieldValue]=this.customerFormData[o],n[a]="",n[a]=this.customerFormData[o],this.formModel[o]=Object.assign(Object.assign({},this.formModel[o]),{mode:"text",selectedOption:n})}else this.formModel[o]=Object.assign(Object.assign({},this.formModel[o]),{mode:"text"})}this.confirmButtonModel=Object.assign(Object.assign({},this.confirmButtonModel),{label:"Change details",type:"outline",icon:"gobackward"}),this.monitorService.logEvent("setTextMode",["ChqNewCustomerComponent","addenda-quote",{caseId:this.caseId}])}},{key:"confirmData",value:function(){var e=this;if(this.monitorService.logEvent("confirmData",["ChqNewCustomerComponent","addenda-quote",{caseId:this.caseId}]),this.isFormConfirmed)return this.formModel.companyOrgType.observable||(this.formModel.companyOrgType.selectedOption.name="",this.formModel.companyOrgType.observable=this.caseService.getProviders(),setTimeout(function(){e.orgType.triggerObservable()})),void this.updateButton();this.commonService.showLoading();var t={companyOrgType:this.customerFormData.companyOrgType,caseTypeID:1,customerTypeID:"Retail"===this.customerFormData.companyOrgType?this.customerFormData.customerTypeID:null,domainID:2100,tariffId:this.customerFormData.tariffId,isTariffEditable:this.customerFormData.isTariffEditable,firstName:this.customerFormData.firstName,lastName:this.customerFormData.lastName,countryCode:this.customerFormData.driverCode,mobileNumber:this.customerFormData.driverPhone.toString(),email:this.customerFormData.email,companyId:this.customerFormData.companyId,partnershipId:this.customerFormData.partnershipId,claimNumber:"Insurance Company"===this.customerFormData.companyOrgType?this.customerFormData.claimNumber:"",companyName:this.isRetailAndCompanyProvider?this.customerFormData.companyName:"",companyLicenseNumber:this.isRetailAndCompanyProvider?this.customerFormData.licenseId:""};this.commonService.repairPermission||(t.externalID=this.customerFormData.jobNumber),"0"!=this.caseId?(t.caseId=this.caseObjectId,t.caseGuid=this.caseId,this.caseService.updateCase(t).subscribe({next:function(t){t&&(e.updateButton(),e.router.navigate(["/quote/case/".concat(e.caseId,"/vehicle")])),e.commonService.hideLoading()},error:function(t){e.commonService.hideLoading(),e.monitorService.logException(t,h._.Error)}})):this.caseService.saveNewCase(t).subscribe({next:function(t){t&&(e.caseId=t.data.caseGuid,e.commonService.caseId.next(e.caseId),e.caseObjectId=t.data.id,e.header.caseNumber=t.data.caseNumber,e.updateButton(),e.router.navigate(["/quote/case/".concat(e.caseId)],{replaceUrl:!0}),e.router.navigate(["/quote/case/".concat(e.caseId,"/vehicle")])),e.commonService.hideLoading()},error:function(t){e.commonService.hideLoading(),e.monitorService.logException(t,h._.Error)}})}},{key:"hideDropdown",value:function(e){var t,o,n,i;e===this.formModel.companyOrgType.name?(this.driverCode.closeDropdown(),null===(t=this.companyOrg)||void 0===t||t.closeDropdown()):e===this.formModel.companyName.name?(this.driverCode.closeDropdown(),null===(o=this.orgType)||void 0===o||o.closeDropdown()):(null===(n=this.orgType)||void 0===n||n.closeDropdown(),null===(i=this.companyOrg)||void 0===i||i.closeDropdown())}},{key:"onObservableLoad",value:function(e){var t,o=this;if(this.commonService.hideLoading(),e&&e&&e.length>0){var n=e.filter(function(e){var t;return e.phoneCountryCode===(null===(t=o.formModel.driverCode.selectedOption)||void 0===t?void 0:t.phoneCountryCode)});if(n.length>0){var i=n[0],a=i.regExpression;this.formModel.driverCode=Object.assign(Object.assign({},this.formModel.driverCode),{selectedOption:i}),this.driverPhone.updateCurrentValidation(a,!0)}var r=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");(!r||"0"===r)&&this.setPrefillData(e)}}},{key:"onFormUpdate",value:function(e){var t,o,n,i,a=this;if(this.monitorService.logEvent("onFormUpdate",["ChqNewCustomerComponent","addenda-quote",{caseId:this.caseId,output:e}]),"driverCode"===e.name&&this.driverPhone.updateCurrentValidation(e.value.regExpression),"select"===e.type){var r=this.customerFormData[e.name],s=this.formModel[e.name].fieldValue||this.formModel[e.name].displayValue;if((null===(t=this.formModel[e.name])||void 0===t?void 0:t.selectedOption)&&(null===(o=this.formModel[e.name])||void 0===o?void 0:o.selectedOption[s])===(null==e?void 0:e.value[s]))return;this.formModel[e.name]=Object.assign(Object.assign({},this.formModel[e.name]),{selectedOption:e.value}),this.customerFormData[e.name]=e.value[s],"companyOrgType"===e.name&&(r!==this.customerFormData[e.name]&&setTimeout(function(){var e,t;null===(e=a.companyOrg)||void 0===e||e.setUnTouched(),null===(t=a.licenseId)||void 0===t||t.setUnTouched()}),e.value[s]&&"Insurance Company"!==e.value[this.formModel[e.name].displayValue]&&(this.formModel.claimNumber=Object.assign(Object.assign({},this.formModel.claimNumber),{value:""})),e.value[s]&&"Retail"!==e.value[this.formModel[e.name].displayValue]?(this.formModel.companyName=Object.assign(Object.assign({},this.formModel.companyName),{displayValue:"companyName",fieldValue:"companyName",onObservableLoad:this.updateCaseData.bind(this),placeHolder:"Select...",value:"",type:"select",observable:this.caseService.getCompanyData(e.value[s],"")}),this.formModel.companyName.selectedOption&&(null===(n=this.formModel.companyName.selectedOption)||void 0===n?void 0:n.tariffId)&&(this.customerFormData.companyId=null,this.customerFormData.companyName=null,this.formModel.companyName.selectedOption={}),this.customerFormData.licenseId="",this.formModel.licenseId=Object.assign(Object.assign({},this.formModel.licenseId),{value:""}),setTimeout(function(){var e;r&&"Retail"!==r&&a.currentStatus&&(null===(e=a.companyOrg)||void 0===e||e.triggerObservable())})):(e.value[s]&&"Retail"===e.value[this.formModel[e.name].displayValue]&&(this.formModel.claimNumber=Object.assign(Object.assign({},this.formModel.claimNumber),{value:""}),this.formModel.companyName=Object.assign(Object.assign({},this.formModel.companyName),{placeHolder:"Company Name"}),this.customerFormData.claimNumber="",this.currentStatus&&this.caseService.getCompanyData(e.value[s],"").subscribe({next:function(e){var t,o,n;if(e&&(null===(t=e.data)||void 0===t?void 0:t.length)>0){var i=e.data[0];a.customerFormData.companyId=i.companyId,a.customerFormData.tariffId=i.tariffId,a.formModel.companyName.selectedOption&&(null===(o=a.formModel.companyName.selectedOption)||void 0===o?void 0:o.tariffId)&&(a.customerFormData.licenseId="",a.formModel.licenseId=Object.assign(Object.assign({},null===(n=a.formModel)||void 0===n?void 0:n.licenseId),{value:""})),"Person"===a.customerFormData[a.formModel.carOwnerSelector.name]&&(a.customerFormData.companyName=null,a.formModel.companyName.value=""),a.customerFormData.isTariffEditable=i.isEditable,a.customerFormData.partnershipId=i.partnershipId,a.formModel.companyName.selectedOption=i[0],a.checkForFormValidation()}},error:function(){a.customerFormData.tariffId=0,a.customerFormData.isTariffEditable=!1}})),this.formModel.companyName=Object.assign(Object.assign({},this.formModel.companyName),{type:"text"}))),"companyName"===e.name&&e.value&&(this.customerFormData.companyId=e.value.companyId,this.customerFormData.tariffId=e.value.tariffId,this.customerFormData.isTariffEditable=e.value.isEditable,this.customerFormData.licenseId=e.value.licenseId.toString(),this.formModel.licenseId=Object.assign(Object.assign({},null===(i=this.formModel)||void 0===i?void 0:i.licenseId),{value:e.value.licenseId.toString()}),this.customerFormData.partnershipId=e.value.partnershipId),this.customerFormData[this.formModel[e.name].idField]=e.value[this.formModel[e.name].displayValue]}else"carOwnerSelector"===e.name&&e.keyFieldValue&&this.formModel[e.name].idField&&(this.customerFormData[this.formModel[e.name].idField]=e.keyFieldValue),e.isValid?(this.formModel[e.name].value=e.value,this.customerFormData[e.name]=e.value):(this.formModel[e.name].value="",this.customerFormData[e.name]="driverPhone"!==e.name?"":0);this.customerFormData=Object.assign({},this.customerFormData),this.checkForFormValidation()}},{key:"navigateToVehicle",value:function(){this.monitorService.logEvent("navigateToVehicle",["ChqNewCustomerComponent","addenda-quote",{caseId:this.caseId}]),this.router.navigate(["/quote/case/".concat(this.caseId,"/vehicle")])}},{key:"updateCaseData",value:function(e){var t,o=this;if(e&&this.customerFormData.companyId&&!this.customerFormData.tariffId){var n=e.filter(function(e){return e.companyId===o.customerFormData.companyId});n.length>0&&(this.customerFormData.tariffId=n[0].tariffId,this.customerFormData.isTariffEditable=n[0].isEditable,this.formModel.licenseId=Object.assign(Object.assign({},null===(t=this.formModel)||void 0===t?void 0:t.licenseId),{value:n[0].licenseId.toString()}),this.customerFormData.partnershipId=n[0].partnershipId,this.formModel.companyName.selectedOption=n[0])}}},{key:"currentStatus",get:function(){var e,t,o;return!(null===(e=this.caseResponse)||void 0===e?void 0:e.status)&&!this.isFormConfirmed||-1===["reject","rejected","approved","closed","repairestimation"].indexOf(null===(o=null===(t=this.caseResponse)||void 0===t?void 0:t.status)||void 0===o?void 0:o.toLowerCase())&&!this.isFormConfirmed}},{key:"currentCaseStatus",get:function(){var e,t,o,n,i;return!(null===(e=this.caseResponse)||void 0===e?void 0:e.status)&&this.currentOrgId===(null===(o=null===(t=this.caseResponse)||void 0===t?void 0:t.organizationDetail)||void 0===o?void 0:o.organizationId)||!this.commonService.isViewOnly&&-1===["reject","rejected","approved","closed","repairestimation","complete"].indexOf(null===(i=null===(n=this.caseResponse)||void 0===n?void 0:n.status)||void 0===i?void 0:i.toLowerCase())}},{key:"loadCaseDetails",value:function(){var e,t=this,o=Object.keys(this.formModel),n=null===(e=this.route.parent)||void 0===e?void 0:e.snapshot.paramMap.get("id");if(n&&"0"!=n)this.caseId=n,this.isApiLoading=!0,this.commonService.caseId.next(this.caseId),this.commonService.showLoading(),this.caseService.getCaseDetail(this.caseId).subscribe({next:function(e){var n,i;for(var a in t.caseResponse=e.data,t.caseObjectId=t.caseResponse.id,t.commonService.caseStatus.next(t.caseResponse.status),t.caseResponse.inspections.length>0&&t.commonService.inspectionId.next(t.caseResponse.inspections[0].inspectionId),t.commonService.isViewOnly=t.currentOrgId!=(null===(i=null===(n=t.caseResponse)||void 0===n?void 0:n.organizationDetail)||void 0===i?void 0:i.organizationId),(!t.currentStatus||t.commonService.isViewOnly)&&(t.setTextMode(),t.isFormConfirmed=!0),t.header.caseNumber=t.caseResponse.caseNumber,t.formDataFromResponse=(0,y.Wk)(t.caseResponse),t.customerFormData=(0,y.Qb)(t.formDataFromResponse),t.originalData=JSON.parse(JSON.stringify(t.customerFormData)),o){var r=t.formModel[o[a]],s=r.type,c=r.displayValue,l=r.fieldValue;if(t.customerFormData[o[a]])if("select"===s){var d={};d[c]="",d[l]=t.customerFormData[o[a]],!t.currentStatus&&"companyOrgType"===o[a]&&(d[c]=t.customerFormData[o[a]]),t.formModel[o[a]]=Object.assign(Object.assign({},t.formModel[o[a]]),{value:"",selectedOption:d})}else{var m={};"companyName"===o[a]&&(m={companyName:t.customerFormData[o[a]]}),t.formModel[o[a]]=Object.assign(Object.assign({},t.formModel[o[a]]),{value:t.customerFormData[o[a]],selectedOption:m})}}t.checkRouteParams(),t.commonService.hideLoading()},error:function(){t.commonService.hideLoading()},complete:function(){t.isApiLoading=!1}});else for(var i in this.isApiLoading=!1,this.formModel.companyOrgType.observable||(this.formModel.companyOrgType.observable=this.caseService.getProviders()),o){var a=o[i];"driverCode"!==a?this.formModel[a]=Object.assign(Object.assign({},this.formModel[a]),{value:"",selectedOption:{}}):(this.formModel[a]=Object.assign(Object.assign({},this.formModel[a]),{value:"",selectedOption:{phoneCountryCode:"+91"}}),this.customerFormData.driverCode="+91")}}},{key:"setPrefillData",value:function(e){var t,o,n,i,a,r,s,c=this.commonService.getSessionStorage("selectedSearchItem");if(c){var l=JSON.parse(c);if(this.formModel.email=Object.assign(Object.assign({},this.formModel.email),{value:l.email,selectedOption:{}}),this.customerFormData.email=l.email,l.firstName&&(this.customerFormData.firstName=l.firstName,this.formModel.firstName=Object.assign(Object.assign({},this.formModel.firstName),{value:this.customerFormData.firstName,selectedOption:{}})),l.lastName&&(this.customerFormData.lastName=l.lastName,this.formModel.lastName=Object.assign(Object.assign({},this.formModel.lastName),{value:this.customerFormData.lastName,selectedOption:{}})),l.phoneNumber){var d=null===(t=l.phoneNumber)||void 0===t?void 0:t.substring(0,3),m=null===(o=l.phoneNumber)||void 0===o?void 0:o.substring(0,4),u="",p=e.filter(function(e){return e.phoneCountryCode===d});if(0===p.length?(u=null===(n=l.phoneNumber)||void 0===n?void 0:n.substring(4,null===(i=l.phoneNumber)||void 0===i?void 0:i.length),p=e.filter(function(e){return e.phoneCountryCode===m})):u=null===(a=l.phoneNumber)||void 0===a?void 0:a.substring(3,null===(r=l.phoneNumber)||void 0===r?void 0:r.length),p.length>0){var h=p[0],g=h.regExpression;this.customerFormData.driverCode=null==h?void 0:h.phoneCountryCode,this.formModel.driverCode=Object.assign(Object.assign({},this.formModel.driverCode),{selectedOption:h}),null===(s=this.driverPhone)||void 0===s||s.updateCurrentValidation(g,!0)}this.formModel.driverPhone=Object.assign(Object.assign({},this.formModel.driverPhone),{value:u,selectedOption:{}}),this.customerFormData.driverPhone=parseInt(u)}if(l.email||l.phoneNumber||l.firstName){if(l.make||l.model||l.vin||l.plate)return;this.commonService.setSessionStorage("selectedSearchItem","")}}}},{key:"checkDataDirty",value:function(){return Object.keys(this.customerFormData),this.compareObjects(this.customerFormData,{jobNumber:"",companyOrgType:"",claimNumber:"",companyName:"",tariffId:0,isTariffEditable:!0,licenseId:"",firstName:"",lastName:"",companyId:0,partnershipId:0,customerTypeID:1,driverCode:"+91",driverPhone:0,carOwnerSelector:"",email:""})}},{key:"checkForFormValidation",value:function(){var e=Object.keys(this.customerFormData),t=[];"Retail"===this.retail?"Person"===this.customerFormData.carOwnerSelector?t=["companyName","claimNumber","licenseId","companyId"]:"Company"===this.customerFormData.carOwnerSelector&&(t=["claimNumber","companyId"]):"Insurance Company"!=this.customerFormData.companyOrgType&&(t=["claimNumber"]),this.commonService.repairPermission&&t.push("jobNumber");var o=!0;for(var n in e){var i=e[n];"carOwnerSelector"===i||"isTariffEditable"===i||-1!==t.indexOf(i)||this.customerFormData[i]||(o=!1)}if(this.isFormConfirmed)this.confirmButtonModel.type="outline";else if(o){if(this.isFormConfirmed)return void(this.confirmButtonModel.type="outline");this.confirmButtonModel.type="primary"}else this.confirmButtonModel.type="disabled";this.monitorService.logEvent("checkForFormValidation",["ChqNewCustomerComponent","addenda-quote",{validationStatus:o?"Form is valid":"Form is invalid"}])}},{key:"checkRouteParams",value:function(){var e=this;this.route.queryParams.subscribe(function(t){var o=t.isBack;"true"===o||!0===o?(e.isFormConfirmed=!0,e.setTextMode()):e.currentStatus&&(e.formModel.companyOrgType.observable||(e.formModel.companyOrgType.observable=e.caseService.getProviders()))})}},{key:"ngOnInit",value:function(){var e=this;this.monitorService.logEvent("ngOnInit",["ChqNewCustomerComponent","addenda-quote"]),this.formModel=(0,y.U6)(),this.commonService.repairPermission&&(this.formModel.jobNumber=Object.assign(Object.assign({},this.formModel.jobNumber),{disabled:!0,validation:null})),this.confirmButtonModel={label:"Confirm",type:"primary",icon:"check",onclick:this.confirmData.bind(this)},this.nextButtonModel={label:"Next add vehicle",type:"primary",icon:"plus-filled",onclick:this.navigateToVehicle.bind(this)},this.formModel.driverCode.observable||(this.formModel.driverCode.observable=this.coreService.getPhoneNumber(),this.formModel.driverCode.onObservableLoad=this.onObservableLoad.bind(this)),this.header.caseNumber="",this.checkForFormValidation(),this.loadCaseDetails(),this.commonService.accessRight.subscribe({next:function(t){t||(e.showNoAccess=!0)}});var t=document.querySelector(".addenda-container");t&&(t.scrollTop=0)}},{key:"ngOnDestroy",value:function(){this.monitorService.logEvent("ngOnDestroy",["ChqNewCustomerComponent","addenda-quote"]),this.commonService.accessRight.unsubscribe(),this.commonService.isViewOnly=!1}}]),o}(b);return e.\u0275fac=function(t){return new(t||e)(f.Y36(c.F0),f.Y36(M.v),f.Y36(C.M),f.Y36(w.n),f.Y36(O.p),f.Y36(c.gz))},e.\u0275cmp=f.Xpm({type:e,selectors:[["chq-new-case"]],viewQuery:function(e,t){var o;(1&e&&(f.Gf(q,5),f.Gf(S,5),f.Gf(_,5),f.Gf(Z,5),f.Gf(T,5)),2&e)&&(f.iGM(o=f.CRH())&&(t.companyOrg=o.first),f.iGM(o=f.CRH())&&(t.licenseId=o.first),f.iGM(o=f.CRH())&&(t.driverPhone=o.first),f.iGM(o=f.CRH())&&(t.driverCode=o.first),f.iGM(o=f.CRH())&&(t.orgType=o.first))},features:[f.qOj],decls:2,vars:2,consts:[["class","new-case-container mh-0",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"new-case-container","mh-0",3,"ngClass"],[3,"chqModel"],[1,"form-container"],[1,"row"],[1,"job-number","col-3"],[3,"inputModel","controlOutput"],[1,"work-provider","col-6"],[1,"work-input-wrapper","row"],[1,"col-12","sub-heading"],[1,"col-6",3,"inputModel","clicked","controlOutput"],["orgType",""],["class","col-6",3,"inputModel","controlOutput",4,"ngIf"],["class","row",3,"ngClass",4,"ngIf"],["class","row",4,"ngIf"],[1,"driver-details","col-12"],[1,"driver-input-wrapper","row"],[1,"driver-fields-wrapper"],[1,"driver-field",3,"inputModel","controlOutput"],[1,"driver-address-wrapper","row"],[1,"driver-field","basis-272",3,"inputModel","controlOutput"],[1,"driver-field","basis-272"],[1,"driver-field","driver-code-field","no-padding",3,"inputModel","clicked","controlOutput"],["driverCode",""],[1,"driver-field","no-padding",3,"inputModel","controlOutput"],["driverPhone",""],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-quote.png"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"],[1,"col-6",3,"inputModel","controlOutput"],[1,"row",3,"ngClass"],[1,"insurer-details","col-12"],[1,"insurance-input-wrapper","row"],[1,"company-input","col-3",3,"inputModel","controlOutput"],[1,"company-input","col-6",3,"inputModel","clicked","controlOutput"],["companyOrg",""],[1,"col-6",3,"ngClass","inputModel","controlOutput"],["licenseId",""],[3,"buttonModel"]],template:function(e,t){1&e&&(f.YNc(0,V,42,22,"div",0),f.YNc(1,Y,1,0,"no-access-error",1)),2&e&&(f.Q6J("ngIf",!t.isApiLoading&&!t.showNoAccess),f.xp6(1),f.Q6J("ngIf",t.showNoAccess))},directives:[s.O5,s.mk,x._,I.D,D.E,P.U],pipes:[k.X$],styles:[".new-case-container[_ngcontent-%COMP%]{height:calc(100vh - 76px - calc(5px + 1.5vw + 58px + 1.6vw + 1.5vw));overflow:hidden;overflow-y:auto;padding:0 calc(5px + 1.5vw);padding-bottom:1.5vw}.new-case-container[_ngcontent-%COMP%]   .sub-heading[_ngcontent-%COMP%]{font-weight:700;font-size:14px;line-height:20px;color:var(--xa-black)}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;flex:1}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .job-number[_ngcontent-%COMP%]{margin-bottom:15px}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider[_ngcontent-%COMP%]{flex-direction:column;margin-bottom:15px}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:15px}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider[_ngcontent-%COMP%]   .work-input-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider[_ngcontent-%COMP%]   .car-owner-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .insurer-details[_ngcontent-%COMP%]{margin-bottom:10px;flex-direction:column}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .insurer-details[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .insurer-details[_ngcontent-%COMP%]   .insurance-input-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]{flex:4;display:flex;flex-direction:column}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-input-wrapper[_ngcontent-%COMP%], .new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-address-wrapper[_ngcontent-%COMP%]{margin-bottom:10px}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-input-wrapper[_ngcontent-%COMP%], .new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-address-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{flex:1 1 120px;padding:10px;width:120px}@media (max-width: 850px){.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{padding:6px}}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.no-padding[_ngcontent-%COMP%]{padding:0}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.driver-code-field[_ngcontent-%COMP%]{min-width:120px;max-width:120px;padding-right:20px}.new-case-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.basis-272[_ngcontent-%COMP%]{flex-basis:272px}.new-case-container[_ngcontent-%COMP%]   .hide[_ngcontent-%COMP%]{display:none}.new-case-container[_ngcontent-%COMP%]   .disable-input[_ngcontent-%COMP%], .new-case-container[_ngcontent-%COMP%]   .partial-disable-info[_ngcontent-%COMP%]{pointer-events:none}.text-mode[_ngcontent-%COMP%]   .job-number[_ngcontent-%COMP%]{padding-left:9px}  .disable-controls input{opacity:.6!important}"]}),e}(),G=r(97582),H=r(57445),U=r(49517),B=r(60562),z=r(48873),X=r(4093),K=r(13975),$=r(50356),W=r(74178),ee=["make"],te=["model"],oe=["year"];function ne(e,t){if(1&e&&f._UZ(0,"chq-button",25),2&e){var o=f.oxw(2);f.Q6J("buttonModel",o.confirmButtonModel)}}function ie(e,t){if(1&e&&f._UZ(0,"chq-button",25),2&e){var o=f.oxw(2);f.Q6J("buttonModel",o.nextButtonModel)}}var ae=function(e){return{"text-mode":e}},re=function(e){return{"partial-disable-info":e}},se=function(e){return{"disable-input disable-controls":e}},ce=function(e){return{"partial-disable-info disable-controls":e}};function le(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",2),f._UZ(1,"chq-step-header",3),f.TgZ(2,"label",4),f._uU(3),f.ALo(4,"translate"),f.qZA(),f.TgZ(5,"div",5),f.TgZ(6,"chq-input",6),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.qZA(),f.TgZ(7,"form",7),f.TgZ(8,"div",8),f.TgZ(9,"chq-input",9,10),f.NdJ("clicked",function(e){return f.CHM(o),f.oxw().hideDropdown(e)})("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.TgZ(11,"chq-input",11,12),f.NdJ("clicked",function(e){return f.CHM(o),f.oxw().hideDropdown(e)})("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.TgZ(13,"chq-input",13,14),f.NdJ("clicked",function(e){return f.CHM(o),f.oxw().hideDropdown(e)})("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.qZA(),f.TgZ(15,"div",15),f.TgZ(16,"chq-input",6),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.TgZ(17,"chq-input",6),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.TgZ(18,"chq-input",16),f.NdJ("controlOutput",function(e){return f.CHM(o),f.oxw().onFormUpdate(e)}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(19,"div",17),f._UZ(20,"img",18),f.qZA(),f.TgZ(21,"div",19),f.TgZ(22,"div",20),f.TgZ(23,"div",21),f._UZ(24,"img",22),f.qZA(),f.qZA(),f.TgZ(25,"div",23),f.YNc(26,ne,1,1,"chq-button",24),f.YNc(27,ie,1,1,"chq-button",24),f.qZA(),f.qZA(),f.qZA()}if(2&e){var n=f.oxw();f.Q6J("ngClass",f.VKq(20,ae,n.isFormConfirmed)),f.xp6(1),f.Q6J("chqModel",n.vehicleHeader),f.xp6(2),f.Oqu(f.lcZ(4,18,"vehicle_detail")),f.xp6(2),f.Q6J("ngClass",f.VKq(22,re,n.searchDisabled)),f.xp6(1),f.Q6J("inputModel",n.formModel.vin),f.xp6(2),f.Q6J("ngClass",f.VKq(24,se,n.inputDisabled)),f.xp6(1),f.Q6J("inputModel",n.formModel.make)("ngClass",f.VKq(26,se,n.makeDisabled)),f.xp6(2),f.Q6J("inputModel",n.formModel.model)("ngClass",f.VKq(28,se,n.modelDisabled)),f.xp6(2),f.Q6J("inputModel",n.formModel.year)("ngClass",f.VKq(30,se,n.yearDisabled)),f.xp6(2),f.Q6J("ngClass",f.VKq(32,ce,n.infoDisabled)),f.xp6(1),f.Q6J("inputModel",n.formModel.licensePlate),f.xp6(1),f.Q6J("inputModel",n.formModel.carMilege),f.xp6(1),f.Q6J("inputModel",n.formModel.registrationDate),f.xp6(8),f.Q6J("ngIf",n.currentStatus),f.xp6(1),f.Q6J("ngIf",n.isFormConfirmed&&!n.commonService.isViewOnly)}}function de(e,t){1&e&&f._UZ(0,"no-access-error")}var me=function(){var e=function(){function e(t,o,n,i,a,r,s,c,l,m){var u=this;d(this,e),this.router=t,this.commonService=o,this.route=n,this.caseService=i,this.vehicleService=a,this.inspectionService=r,this.monitorService=s,this.labourService=c,this.mediaCollectionService=l,this.cd=m,this.vehicleHeader=B.mo,this.caseId="0",this.status="",this.tariffId=0,this.vehicleFormData={vin:"",make:"",model:"",year:"",carMilege:"",licensePlate:"",registrationDate:""},this.isFormConfirmed=!1,this.serviceName="vin",this.inputDisabled=!0,this.infoDisabled=!0,this.searchDisabled=!1,this.importTerms=[],this.vehicleId=0,this.inspections={},this.domainID=0,this.partnershipId=0,this.labourData=null,this.makeDisabled=!1,this.preventVinCall=!1,this.caseCreatedDate="",this.umc="",this.originalVin="",this.modelDisabled=!1,this.yearDisabled=!1,this.inspectionTemplateId=0,this.showNoAccess=!1,this.customerName="",this.email="",this.originalTariffObject={},this.userPermission={},this.commonService.eventfromToastComponent$.subscribe(function(e){e&&(u.monitorService.logEvent("eventfromToastComponent",["ChqNewVehicleComponent","addenda-quote",{caseId:u.caseId}]),u.router.navigate(["/quote/case/".concat(u.caseId,"/document")]))}),this.commonService.accessRight.closed&&(this.commonService.accessRight=new g.X(!0)),this.commonService.userProfileData.subscribe(function(e){if(e&&e.data){var t=e.data,o=t.userPermission,n=t.vehicleSourceType,i=t.organizationDetail;u.userPermission=o||{},u.estimateId=n,i&&(u.currentOrgId=i.id)}})}return l(e,[{key:"checkGTEstimatePermission",value:function(){var e=this.userPermission.orgPackages,t=(void 0===e?[]:e).filter(function(e){return"Repair Estimate"===e.automotiveServiceName});if(t&&t.length>0){var o=t[0].permissions.filter(function(e){return"gt.estimate"===e.permissionName||"gt.estimate.vinquery"===e.permissionName});if(o&&o.length>0)return!0}return!1}},{key:"process",value:function(e){return(0,G.mG)(this,void 0,void 0,o().mark(function t(){var n=this;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.caseId=e,this.commonService.showLoading(),t.next=4,this.populateReadonlyFields(e).then(function(e){var t,o,i,a,r,s;if(null!=e.data){n.vehicleId=e.data.vehicleId||0,n.vehicleHeader.caseNumber=e.data.caseNumber;var c=e.data,l=c.vinNumber,d=c.licensePlateNumber,m=c.vehicleMileage,u=c.registrationDate,p=c.vehicleMake,h=c.vehicleModel,g=c.modelYear,f=c.status,v=c.tariffs,b=c.domainID,y=c.umc,M=c.id;n.id=M,0!=n.vehicleId&&(n.infoDisabled=!1,n.searchDisabled=!1,n.inputDisabled=!1,n.preventVinCall=!0,n.originalVin=l,n.labourData=v.length>0?v[0]:[]),n.customerName=null===(t=e.data.caseDetail)||void 0===t?void 0:t.firstName,n.email=null===(o=e.data.caseDetail)||void 0===o?void 0:o.email,n.vehicleHeader.caseNumber=e.data.caseNumber,n.caseCreatedDate=e.data.createdDate,n.formModel.vin=Object.assign(Object.assign({},n.formModel.vin),{value:l}),n.status=f,n.commonService.caseStatus.next(f),n.formModel.licensePlate=Object.assign(Object.assign({},n.formModel.licensePlate),{value:d}),n.formModel.carMilege=Object.assign(Object.assign({},n.formModel.carMilege),{value:m}),n.formModel.registrationDate=Object.assign(Object.assign({},n.formModel.registrationDate),{value:u}),n.formModel.make=Object.assign(Object.assign({},n.formModel.make),{selectedOption:{name:p}}),n.formModel.year=Object.assign(Object.assign({},n.formModel.year),{selectedOption:{name:g||e.data.modelYearRange}}),n.formModel.model=Object.assign(Object.assign({},n.formModel.model),{selectedOption:{modelDescription:h}}),n.umc=y,n.tariffId=null===(i=v[0])||void 0===i?void 0:i.tariffId,n.isTariffEditable=null===(a=v[0])||void 0===a?void 0:a.isEditable,n.partnershipId=null===(r=v[0])||void 0===r?void 0:r.partnershipId,n.domainID=b,n.inspections=e.data.inspections[0],n.inspections&&n.commonService.inspectionId.next(n.inspections.inspectionId),n.originalTariffObject={make:p,partnershipId:n.partnershipId,registrationDate:z(u).format("YYYY-MM-DDT00:00:00")},n.vehicleFormData=Object.assign(Object.assign({},n.vehicleFormData),{vin:l,make:p,model:h,year:g||e.data.modelYearRange,carMilege:m,licensePlate:d,registrationDate:u}),n.commonService.isViewOnly=n.currentOrgId!=(null===(s=e.data.organizationDetail)||void 0===s?void 0:s.organizationId),n.validate(),n.commonService.hideLoading()}else n.commonService.hideLoading()}).catch(function(){n.commonService.hideLoading()});case 4:if(this.prefillVehicleData(),0==this.vehicleId&&!this.commonService.isViewOnly){t.next=7;break}return t.abrupt("return",(this.setTextMode(),void(this.isFormConfirmed=!0)));case 7:return t.next=9,this.populateDropdowns();case 9:case"end":return t.stop()}},t,this)}))}},{key:"prefillVehicleData",value:function(){var e=this.commonService.getSessionStorage("selectedSearchItem");if(e){var t=JSON.parse(e);t.vin&&!this.vehicleFormData.vin&&(this.preventVinCall=!0,this.vehicleFormData.vin=t.vin,this.formModel.vin=Object.assign(Object.assign({},this.formModel.vin),{value:t.vin})),t.make&&!this.vehicleFormData.make&&(this.vehicleFormData.make=t.make,this.formModel.make=Object.assign(Object.assign({},this.formModel.make),{selectedOption:{name:t.make}})),t.model&&!this.vehicleFormData.model&&(this.vehicleFormData.model=t.model,this.formModel.model=Object.assign(Object.assign({},this.formModel.model),{selectedOption:{modelDescription:t.model}})),t.importInterval&&!this.vehicleFormData.year&&(this.vehicleFormData.year=t.importInterval,this.formModel.year=Object.assign(Object.assign({},this.formModel.year),{value:t.importInterval,selectedOption:{name:t.importInterval}})),t.plate&&!this.vehicleFormData.licensePlate&&(this.vehicleFormData.licensePlate=t.plate,this.formModel.licensePlate=Object.assign(Object.assign({},this.formModel.licensePlate),{value:t.plate})),(t.make||t.model||t.vin||t.plate)&&(this.commonService.setSessionStorage("selectedSearchItem",""),this.inputDisabled=!1,this.infoDisabled=!1,this.makeDisabled=!0,this.enableDropdowns())}}},{key:"populateDropdowns",value:function(){return(0,G.mG)(this,void 0,void 0,o().mark(function e(){var t,n,i=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,H.z)(this.vehicleService.getVehicleMake());case 2:t=e.sent,this.formModel.make=Object.assign(Object.assign({},this.formModel.make),{options:t.sort(function(e,t){return e.name.localeCompare(t.name)})}),n=this.formModel.make.options.filter(function(e){return e.name===i.vehicleFormData.make}),n.length>0&&this.vehicleService.getVehicleModel(n[0].id,this.estimateId).subscribe(function(e){var t,o;i.formModel.model=Object.assign(Object.assign({},i.formModel.model),{options:e});var n=null===(t=i.formModel.model.options)||void 0===t?void 0:t.filter(function(e){return e.umc==i.umc});n.length>0&&(null===(o=i.vehicleService.getVehicleYearByModel(n[0].id,i.estimateId))||void 0===o||o.subscribe(function(e){i.formModel.year=Object.assign(Object.assign({},i.formModel.year),{options:e})}))});case 6:case"end":return e.stop()}},e,this)}))}},{key:"populateReadonlyFields",value:function(e){return(0,G.mG)(this,void 0,void 0,o().mark(function t(){return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e||"0"==e){t.next=2;break}return t.abrupt("return",(this.caseId=e,this.commonService.showLoading(),(0,H.z)(this.caseService.getCaseDetail(e))));case 2:case"end":return t.stop()}},t,this)}))}},{key:"navigateToDocument",value:function(){this.monitorService.logEvent("navigateToDocument",["ChqNewVehicleComponent","addenda-quote",{caseId:this.caseId}]),this.router.navigate(["/quote/case/".concat(this.caseId,"/document")])}},{key:"ngOnInit",value:function(){var e,t,n,i;return(0,G.mG)(this,void 0,void 0,o().mark(function a(){var r,s,c=this;return o().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.formModel=(0,B.br)(),this.confirmButtonModel={label:"Confirm",type:"primary",icon:"check",onclick:this.confirmData.bind(this)},this.nextButtonModel={label:"Next add documents",type:"primary",icon:"plus-filled",onclick:this.navigateToDocument.bind(this)},r=null===(i=null===(n=null===(t=null===(e=this.route)||void 0===e?void 0:e.parent)||void 0===t?void 0:t.snapshot)||void 0===n?void 0:n.paramMap)||void 0===i?void 0:i.get("id"),this.monitorService.logEvent("ngOnInit",["ChqNewVehicleComponent","addenda-quote",{caseId:r}]),this.commonService.accessRight.subscribe({next:function(e){e||(c.showNoAccess=!0)}}),this.inspectionService.getInspectionTemplateList().subscribe({next:function(e){var t=null==e?void 0:e.data;t.length>0&&(c.inspectionTemplateId=t[0].id)}}),o.next=7,this.process(r);case 7:(s=document.querySelector(".addenda-container"))&&(s.scrollTop=0);case 9:case"end":return o.stop()}},a,this)}))}},{key:"ngAfterViewInit",value:function(){this.commonService.updatePage("/quote/case/0","vehicle"),this.monitorService.logEvent("ngAfterViewInit",["ChqNewVehicleComponent","addenda-quote",{caseId:this.caseId}])}},{key:"setTextMode",value:function(){this.inputDisabled=!1,this.makeDisabled=!1;var e=Object.keys(this.formModel);for(var t in e){var o=e[t];this.formModel[o]=Object.assign(Object.assign({},this.formModel[o]),{mode:"text"})}this.confirmButtonModel=Object.assign(Object.assign({},this.confirmButtonModel),{label:"Change car",type:"outline",icon:"gobackward"})}},{key:"updateButton",value:function(){return(0,G.mG)(this,void 0,void 0,o().mark(function e(){var t,n,i,a=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in t=Object.keys(this.formModel))i=t[n],this.formModel[i]=Object.assign(Object.assign({},this.formModel[i]),{mode:this.isFormConfirmed?"value":"text"});if(e.t0="Change car"==this.confirmButtonModel.label,!e.t0){e.next=10;break}return this.preventVinCall=!0,this.vehicleService.getVinDecoder(this.vehicleFormData.vin).subscribe({next:function(e){a.makeDisabled=!!(null==e?void 0:e.success)}}),this.commonService.showLoading(),e.next=9,this.populateDropdowns();case 9:this.commonService.hideLoading();case 10:this.isFormConfirmed=!this.isFormConfirmed,this.confirmButtonModel=Object.assign(Object.assign({},this.confirmButtonModel),{label:this.isFormConfirmed?"Change car":"Confirm",type:this.isFormConfirmed?"outline":"primary",icon:this.isFormConfirmed?"refresh":"check"});case 12:case"end":return e.stop()}},e,this)}))}},{key:"confirmData",value:function(){var e=this;if(this.isFormConfirmed)this.updateButton();else if(this.commonService.showLoading(),this.vehicleId&&this.vehicleFormData.vin===this.originalVin)this.updateVehicle();else{var t={vin:this.vehicleFormData.vin,vehicleCountryId:1,umc:this.umc,make:this.vehicleFormData.make,model:this.vehicleFormData.model,mileage:Number(this.vehicleFormData.carMilege),firstRegistrationDate:z(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"),registrationNumber:this.vehicleFormData.licensePlate,condition:1,ModelYearRange:this.vehicleFormData.year,InspectionTemplateId:this.inspectionTemplateId,CustomerName:this.customerName,CustomerEmail:this.email};this.vehicleService.addVehicle(t,this.domainID,this.id).subscribe({next:function(t){t&&(e.vehicleId=t.id,e.inspections={},e.inspections.inspectionId=t.inspectionId,e.inspections.inspectionGuid=t.inspectionGuid,e.updateVehicle())},error:function(t){e.commonService.hideLoading()}})}}},{key:"updateVehicle",value:function(){var e,t,n;return(0,G.mG)(this,void 0,void 0,o().mark(function i(){var a,r,s,c=this;return o().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.monitorService.logEvent("updateVehicle",["ChqNewVehicleComponent","addenda-quote",{caseId:this.caseId}]),this.commonService.showLoading(),a={vin:this.vehicleFormData.vin,umc:this.umc,vehicleMake:this.vehicleFormData.make,vehicleModel:this.vehicleFormData.model,modelYearRange:(null===(e=this.vinGTMotive)||void 0===e?void 0:e.modelYearRange)||this.vehicleFormData.year,vehicleID:this.vehicleId,licensePlateNumber:this.vehicleFormData.licensePlate,vehicleMileage:Number(this.vehicleFormData.carMilege),registrationDate:z(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00")},r={inspectionID:this.inspections.inspectionId,inspectionGuid:this.inspections.inspectionGuid},s=z(this.vehicleFormData.registrationDate).year().toString(),o.t0=this.originalTariffObject.make!=this.vehicleFormData.make||this.partnershipId!=this.originalTariffObject.partnershipId||z(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00")!=this.originalTariffObject.registrationDate||!(null===(n=null===(t=this.labourData)||void 0===t?void 0:t.tariffLabourRates)||void 0===n?void 0:n.length),!o.t0){o.next=6;break}return o.next=6,this.getLabourData(this.tariffId,this.isTariffEditable,this.partnershipId,this.vehicleFormData.make,s);case 6:this.vehicleService.updateVehicleCase({vehicle:a,inspection:r,tariff:this.labourData},this.caseId).subscribe({next:function(e){if(e){if(c.labourData.isEditable){var t=!0;if(c.labourData.tariffLabourRates.forEach(function(e){e.amount>0&&(t=!1)}),t){var o={objectId:c.caseId,link:"here",labourData:c.labourData};return c.commonService.hideLoading(),void c.commonService.showInfoToast(5e5,"labour_value_update",o)}}c.router.navigate(["/quote/case/".concat(c.caseId,"/document")])}c.commonService.hideLoading()},error:function(e){c.commonService.hideLoading()}});case 7:case"end":return o.stop()}},i,this)}))}},{key:"onFormUpdate",value:function(e){var t=this;this.monitorService.logEvent("onFormUpdate",["ChqNewVehicleComponent","addenda-quote",{caseId:this.caseId,output:e}]),"select"===e.type?(this.formModel[e.name]=Object.assign(Object.assign({},this.formModel[e.name]),{selectedOption:e.value}),this.vehicleFormData[e.name]=e.value[this.formModel[e.name].fieldValue],"make"==e.name?(this.vehicleFormData.model="",this.vehicleFormData.year=null,this.modelDisabled=!0,this.yearDisabled=!0,this.formModel.year=Object.assign(Object.assign({},this.formModel.year),{selectedOption:{},options:[],observable:null}),this.formModel.model=Object.assign(Object.assign({},this.formModel.model),{selectedOption:{}}),e.value&&(this.formModel.model=Object.assign(Object.assign({},this.formModel.model),{observable:this.vehicleService.getVehicleModel(e.value.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)}),setTimeout(function(){t.model.triggerObservable()}))):"model"==e.name&&(this.yearDisabled=!0,this.formModel.year=Object.assign(Object.assign({},this.formModel.year),{selectedOption:{},observable:null,options:[]}),this.vehicleFormData.year=null,e.value&&(this.umc=e.value.umc,this.formModel.year=Object.assign(Object.assign({},this.formModel.year),{observable:this.vehicleService.getVehicleYearByModel(e.value.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)}),setTimeout(function(){t.year.triggerObservable()})))):e.isValid?(this.formModel[e.name].value=e.value,this.vehicleFormData[e.name]=e.value):(this.formModel[e.name].value="",this.vehicleFormData[e.name]=""),this.vehicleFormData=Object.assign({},this.vehicleFormData),"vin"==e.name&&e.isValid&&this.populateForm(),this.validate()}},{key:"enableDropdowns",value:function(){this.modelDisabled=!1,this.yearDisabled=!1}},{key:"hideDropdown",value:function(e){e===this.formModel.make.name?(this.model.closeDropdown(),this.year.closeDropdown()):e===this.formModel.model.name?(this.make.closeDropdown(),this.year.closeDropdown()):(this.model.closeDropdown(),this.make.closeDropdown())}},{key:"validate",value:function(){var e=Object.keys(this.vehicleFormData);this.monitorService.logEvent("validate",["ChqNewVehicleComponent","addenda-quote",{caseId:this.caseId}]);var t=!0;for(var o in e)if(!this.vehicleFormData[e[o]]){t=!1;break}this.confirmButtonModel.type=this.isFormConfirmed?"outline":t?"primary":"disabled"}},{key:"populateForm",value:function(){var e,t=this,o=null===(e=this.formModel.vin.value)||void 0===e?void 0:e.toLocaleString();this.monitorService.logEvent("populateForm",["ChqNewVehicleComponent","addenda-quote",{caseId:this.caseId}]),(0,U.D)(o).pipe().subscribe({complete:function(){17==o.length&&!t.isFormConfirmed&&!t.preventVinCall&&(t.commonService.showLoading(),t.vehicleService.getVinDecoder(o).subscribe({error:function(){t.commonService.hideLoading(),t.vinGTMotive=null,t.resetDropdown()},next:function(e){var o;if(null==e?void 0:e.success){t.vinGTMotive=e.data,t.umc=null===(o=t.vinGTMotive)||void 0===o?void 0:o.umc,t.formModel.make=Object.assign(Object.assign({},t.formModel.make),{selectedOption:{name:e.data.vehicleMake}}),t.formModel.model=Object.assign(Object.assign({},t.formModel.model),{selectedOption:{modelDescription:e.data.vehicleModel}});var n=t.formModel.make.options.filter(function(t){return t.name===e.data.vehicleMake});n.length>0&&(t.formModel.model=Object.assign(Object.assign({},t.formModel.model),{observable:t.vehicleService.getVehicleModel(n[0].id,t.estimateId)}),setTimeout(function(){t.model.triggerObservable()})),t.formModel.year=Object.assign(Object.assign({},t.formModel.year),{selectedOption:{name:e.data.modelYearRange}}),t.vehicleFormData.make=e.data.vehicleMake,t.vehicleFormData.model=e.data.vehicleModel,t.vehicleFormData.year=e.data.modelYearRange,t.inputDisabled=!1,t.infoDisabled=!1,t.makeDisabled=!0,t.enableDropdowns()}else t.vinGTMotive=null,t.commonService.showInfoToast(5e3,"show-info | "+(null==e?void 0:e.message)),t.resetDropdown();setTimeout(function(){t.make.dropdownValidationMessage="",t.make.dropdownContainer.dropdownConfig.isTouched=!1,t.make.dropdownContainer.dropdownConfig.isDirty=!1,t.model.dropdownValidationMessage="",t.model.dropdownContainer.dropdownConfig.isTouched=!1,t.model.dropdownContainer.dropdownConfig.isDirty=!1,t.year.dropdownValidationMessage="",t.year.dropdownContainer.dropdownConfig.isTouched=!1,t.year.dropdownContainer.dropdownConfig.isDirty=!1},0),t.validate()},complete:function(){t.commonService.hideLoading()}})),t.preventVinCall&&17==o.length&&(t.preventVinCall=!1)}})}},{key:"resetDropdown",value:function(){this.inputDisabled=!1,this.infoDisabled=!1,this.makeDisabled=!1,this.vehicleFormData.make="",this.vehicleFormData.model="",this.vehicleFormData.year=null,this.formModel.model.options=[],this.formModel.year.options=[],this.formModel.make=Object.assign(Object.assign({},this.formModel.make),{selectedOption:{}}),this.formModel.model=Object.assign(Object.assign({},this.formModel.model),{selectedOption:{}}),this.formModel.year=Object.assign(Object.assign({},this.formModel.year),{selectedOption:{}})}},{key:"currentStatus",get:function(){var e;return!this.status&&!this.commonService.isViewOnly||!this.commonService.isViewOnly&&-1===["reject","rejected","approved","closed","repairestimation","complete"].indexOf(null===(e=this.status)||void 0===e?void 0:e.toLowerCase())}},{key:"getLabourData",value:function(e,t,n,i,a){return(0,G.mG)(this,void 0,void 0,o().mark(function a(){var r=this;return o().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(this.monitorService.logEvent("getLabourData",["ChqNewVehicleComponent","addenda-quote",{caseId:this.caseId}]),(0,H.z)(this.labourService.getLabourData(e,i,z(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"),this.caseCreatedDate)).then(function(e){e.data&&(r.labourData={tariffId:e.data.id,tariffDiscountRates:e.data.tariffDiscountRates,tariffLabourRates:e.data.tariffLaborRates,isEditable:t,partnershipId:n})})));case 1:case"end":return o.stop()}},a,this)}))}},{key:"getDomainId",value:function(){var e=this;this.mediaCollectionService.getMediaTemplate().subscribe({next:function(t){(null==t?void 0:t.data.length)>0&&(e.domainID=t.data[0].domainID)}})}},{key:"ngOnDestroy",value:function(){this.monitorService.logEvent("ngOnDestroy",["ChqNewVehicleComponent","addenda-quote",{caseId:this.caseId}]),this.formModel=(0,B.br)(),this.commonService.accessRight.unsubscribe(),this.commonService.isViewOnly=!1}}]),e}();return e.\u0275fac=function(t){return new(t||e)(f.Y36(c.F0),f.Y36(M.v),f.Y36(c.gz),f.Y36(w.n),f.Y36(X.f),f.Y36(K.a),f.Y36(C.M),f.Y36($.T),f.Y36(W.m),f.Y36(f.sBO))},e.\u0275cmp=f.Xpm({type:e,selectors:[["chq-new-vehicle"]],viewQuery:function(e,t){var o;(1&e&&(f.Gf(ee,5),f.Gf(te,5),f.Gf(oe,5)),2&e)&&(f.iGM(o=f.CRH())&&(t.make=o.first),f.iGM(o=f.CRH())&&(t.model=o.first),f.iGM(o=f.CRH())&&(t.year=o.first))},decls:2,vars:2,consts:[["class","new-vehicle-container",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"new-vehicle-container",3,"ngClass"],[3,"chqModel"],[1,"label"],[1,"search-box",3,"ngClass"],[1,"col-4",3,"inputModel","controlOutput"],[1,"form-container"],[1,"vehicle-brand-wrapper","row",3,"ngClass"],["id","input-make",1,"col-4",3,"inputModel","ngClass","clicked","controlOutput"],["make",""],["id","input-model",1,"col-4",3,"inputModel","ngClass","clicked","controlOutput"],["model",""],["id","input-year",1,"col-4",3,"inputModel","ngClass","clicked","controlOutput"],["year",""],[1,"vehicle-info-wrapper","row",3,"ngClass"],[1,"col-4","registration-date",3,"inputModel","controlOutput"],[1,"image-car"],["src","assets/img/half-car.png"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-quote.png"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel"]],template:function(e,t){1&e&&(f.YNc(0,le,28,34,"div",0),f.YNc(1,de,1,0,"no-access-error",1)),2&e&&(f.Q6J("ngIf",!t.showNoAccess),f.xp6(1),f.Q6J("ngIf",t.showNoAccess))},directives:[s.O5,s.mk,x._,I.D,D.E,P.U],pipes:[k.X$],styles:[".new-vehicle-container[_ngcontent-%COMP%]{padding-bottom:1.5vw}.new-vehicle-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-bottom:10px;display:block;font-weight:600}.new-vehicle-container[_ngcontent-%COMP%]     .disable-controls input{opacity:.6!important}.new-vehicle-container[_ngcontent-%COMP%]   .disable-input[_ngcontent-%COMP%], .new-vehicle-container[_ngcontent-%COMP%]   .partial-disable-info[_ngcontent-%COMP%]{pointer-events:none}.new-vehicle-container[_ngcontent-%COMP%]   .registration-date[_ngcontent-%COMP%]     .input-wrapper input{pointer-events:none}.new-vehicle-container[_ngcontent-%COMP%]   .registration-date[_ngcontent-%COMP%]     .input-wrapper input[readonly]{opacity:1}.new-vehicle-container[_ngcontent-%COMP%]   .vehicle-brand-wrapper[_ngcontent-%COMP%], .new-vehicle-container[_ngcontent-%COMP%]   .vehicle-info-wrapper[_ngcontent-%COMP%]{margin-bottom:20px}.new-vehicle-container[_ngcontent-%COMP%]   .vehicle-brand-wrapper[_ngcontent-%COMP%]   .extra-position[_ngcontent-%COMP%], .new-vehicle-container[_ngcontent-%COMP%]   .vehicle-info-wrapper[_ngcontent-%COMP%]   .extra-position[_ngcontent-%COMP%]{top:5px;position:relative}.new-vehicle-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;flex:1}.new-vehicle-container[_ngcontent-%COMP%]   .image-car[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:654px;position:fixed;bottom:76px}.new-vehicle-container[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;margin-bottom:20px}.new-vehicle-container[_ngcontent-%COMP%]   .search-box[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]{width:242px}@media (max-height: 640px){.image-car[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:none!important}}@media (orientation: portrait){.search-box[_ngcontent-%COMP%]{margin-top:20px}.search-box[_ngcontent-%COMP%]   .col-4[_ngcontent-%COMP%]{flex-basis:auto;max-width:none;width:375px!important}.form-container[_ngcontent-%COMP%]{margin-left:5px}.form-container[_ngcontent-%COMP%]   .vehicle-brand-wrapper[_ngcontent-%COMP%], .form-container[_ngcontent-%COMP%]   .vehicle-info-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:0!important}.form-container[_ngcontent-%COMP%]   .vehicle-brand-wrapper[_ngcontent-%COMP%]   .col-4[_ngcontent-%COMP%], .form-container[_ngcontent-%COMP%]   .vehicle-info-wrapper[_ngcontent-%COMP%]   .col-4[_ngcontent-%COMP%]{flex-basis:auto;max-width:none;width:375px!important;margin-bottom:20px;padding-left:0;padding-right:0}}"]}),e}(),ue={approve:{status:"Approve Case",info:"Please fill out a reason why you are approving this case.",buttonModel:{label:"Approve Case",type:"success",icon:"check"},imageGallery:!1,gallery:[]},reject:{status:"Reject Case",info:"Please fill out a reason why you are rejecting this case.",buttonModel:{label:"Reject Case",type:"red",icon:"cross"},imageGallery:!1,gallery:[]},close:{status:"Close Case",info:"Please fill out a reason why you are closing this case.",buttonModel:{label:"Close Case",type:"primary",icon:"folder-plus"},imageGallery:!1,gallery:[]},complete:{status:"Complete Case",info:"Please fill out a reason why you are completing this case.",buttonModel:{label:"Complete Case",type:"primary",icon:"folder-plus"},imageGallery:!1,gallery:[]}},pe=r(3679),he=r(22238),ge=r(51927),fe=r(79034),ve=r(48262),be=r(6690),ye=["nav"];function Me(e,t){1&e&&(f.TgZ(0,"div",17),f._uU(1," Please enter comment "),f.qZA())}var Ce=function(e){return{"invalid-label":e}};function we(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",4),f.TgZ(1,"div",5),f.TgZ(2,"div",6),f._uU(3),f.qZA(),f.TgZ(4,"div",7),f.TgZ(5,"mat-icon",8),f.NdJ("click",function(){return f.CHM(o),f.oxw().cancelDialog()}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(6,"div",9),f._uU(7),f.qZA(),f.TgZ(8,"div",10),f.TgZ(9,"form",11),f.TgZ(10,"label",12),f._uU(11,"Comments"),f.qZA(),f._UZ(12,"textarea",13),f.YNc(13,Me,2,0,"div",14),f.qZA(),f.qZA(),f.TgZ(14,"div",15),f.TgZ(15,"chq-button",16),f.NdJ("click",function(){return f.CHM(o),f.oxw().processCase()}),f.qZA(),f.qZA(),f.qZA()}if(2&e){var n=f.oxw();f.xp6(3),f.hij(" ",n.data.status," "),f.xp6(2),f.Q6J("svgIcon","cross"),f.xp6(2),f.hij(" ",n.data.info," "),f.xp6(2),f.Q6J("formGroup",n.commentForm),f.xp6(1),f.Q6J("ngClass",f.VKq(7,Ce,(n.formControl.dirty||n.formControl.touched)&&n.formControl.errors)),f.xp6(3),f.Q6J("ngIf",(n.formControl.dirty||n.formControl.touched)&&n.formControl.errors),f.xp6(2),f.Q6J("buttonModel",n.data.buttonModel)}}function Oe(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",30),f.TgZ(1,"mat-icon",31),f.NdJ("click",function(){return f.CHM(o),f.oxw(2).prevImageClick()}),f.qZA(),f.qZA()}}function xe(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",32),f.TgZ(1,"mat-icon",33),f.NdJ("click",function(){return f.CHM(o),f.oxw(2).nextImageClick()}),f.qZA(),f.qZA()}}function Ie(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",34),f.TgZ(1,"mat-icon",31),f.NdJ("click",function(){return f.CHM(o),f.oxw(2).prevImageClick()}),f.qZA(),f.qZA()}}function De(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",35),f.TgZ(1,"mat-icon",33),f.NdJ("click",function(){return f.CHM(o),f.oxw(2).nextImageClick()}),f.qZA(),f.qZA()}}var Pe=function(){return{width:"75px",height:"75px"}};function ke(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",18),f.TgZ(1,"div",5),f.TgZ(2,"div",7),f.TgZ(3,"mat-icon",8),f.NdJ("click",function(){return f.CHM(o),f.oxw().cancelDialog()}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(4,"div",19),f.YNc(5,Oe,2,0,"div",20),f.TgZ(6,"img",21),f.NdJ("error",function(){return f.CHM(o),f.oxw().updateLoading()})("load",function(){return f.CHM(o),f.oxw().updateLoading()}),f.qZA(),f._UZ(7,"chq-customloader",22),f.YNc(8,xe,2,0,"div",23),f.qZA(),f.TgZ(9,"div",24),f.YNc(10,Ie,2,0,"div",25),f.TgZ(11,"ng-image-slider",26,27),f.NdJ("imageClick",function(e){return f.CHM(o),f.oxw().showImage(e)}),f.qZA(),f.YNc(13,De,2,0,"div",28),f.qZA(),f.TgZ(14,"div",29),f.TgZ(15,"span"),f._uU(16),f.qZA(),f.qZA(),f.qZA()}if(2&e){var n=f.oxw();f.xp6(3),f.Q6J("svgIcon","cross"),f.xp6(2),f.Q6J("ngIf",n.thumbnails.length>1),f.xp6(1),f.Q6J("src",n.currentImage,f.LSH),f.xp6(1),f.Q6J("showLoading",n.showLoading),f.xp6(1),f.Q6J("ngIf",n.thumbnails.length>1),f.xp6(2),f.Q6J("ngIf",n.thumbnails.length>1),f.xp6(1),f.Q6J("images",n.thumbnails)("infinite",!1)("autoSlide",1)("imageSize",f.DdM(15,Pe))("imagePopup",!1)("showArrow",!1),f.xp6(2),f.Q6J("ngIf",n.thumbnails.length>1),f.xp6(3),f.AsE("",n.index,"/",n.totalImages,"")}}function qe(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",36),f.TgZ(1,"div",37),f.TgZ(2,"div",7),f.TgZ(3,"mat-icon",8),f.NdJ("click",function(){return f.CHM(o),f.oxw().cancelDialog()}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(4,"div",38),f.TgZ(5,"div",39),f._uU(6),f.qZA(),f.TgZ(7,"div",40),f._uU(8),f.qZA(),f.qZA(),f.qZA()}if(2&e){var n=f.oxw();f.xp6(3),f.Q6J("svgIcon","cross"),f.xp6(3),f.hij(" ",n.data.status," "),f.xp6(2),f.hij(" ",n.comments," ")}}function Se(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",41),f.TgZ(1,"div",37),f.TgZ(2,"div",7),f.TgZ(3,"mat-icon",8),f.NdJ("click",function(){return f.CHM(o),f.oxw().cancelDialog()}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(4,"div",42),f._uU(5),f.qZA(),f.TgZ(6,"div",43),f.TgZ(7,"p"),f.TgZ(8,"strong"),f._uU(9),f.ALo(10,"translate"),f.qZA(),f._uU(11),f.qZA(),f.TgZ(12,"p"),f.TgZ(13,"strong"),f._uU(14),f.ALo(15,"translate"),f.qZA(),f._uU(16),f.qZA(),f._UZ(17,"div",44),f.qZA(),f.qZA()}if(2&e){var n=f.oxw();f.xp6(3),f.Q6J("svgIcon","cross"),f.xp6(2),f.Oqu(null==n.data?null:n.data.status),f.xp6(4),f.hij("",f.lcZ(10,7,"to"),":"),f.xp6(2),f.hij(" ",n.emailContent.To,""),f.xp6(3),f.hij("",f.lcZ(15,9,"subject"),":"),f.xp6(2),f.hij(" ",n.emailContent.Subject,""),f.xp6(1),f.Q6J("innerHTML",n.emailContent.Content,f.oJD)}}var _e=function(){var t=function(){function t(e,o,n,i,a){d(this,t),this.dialogRef=e,this.data=o,this.changeDedectionRef=n,this.monitorService=i,this.formBuilder=a,this.thumbnails=[],this.index=1,this.showComment=!1,this.showLoading=!0,this.showEmail=!1}return l(t,[{key:"ngOnInit",value:function(){var t,o,n,i,a,r=this;this.monitorService.logEvent("ngOnInit",["ChqRepairDialogComponent","addenda-quote"]),(null===(t=this.data)||void 0===t?void 0:t.email)&&(this.showEmail=!0,this.emailContent=JSON.parse(null===(o=this.data)||void 0===o?void 0:o.email)),(null===(n=this.data)||void 0===n?void 0:n.imageGallery)?this.getImages():(null===(i=this.data)||void 0===i?void 0:i.comment)?(this.showComment=!0,this.comments=null===(a=this.data)||void 0===a?void 0:a.comment):(this.commentForm=this.formBuilder.group({comment:["",[pe.kI.required,function(e){return e.value&&""===e.value.trim()?{noEmptySpaces:!0}:null}]]}),this.data&&this.data.buttonModel&&(this.data.buttonModel.type=this.commentForm.invalid?"disabled":"Approve Case"===this.data.buttonModel.label?"success":"Reject Case"===this.data.buttonModel.label?"red":"primary"),this.commentForm.get("comment").valueChanges.pipe((0,ge.O)(null),(0,fe.G)()).subscribe(function(t){var o=e(t,2),n=(o[0],o[1]);r.data.buttonModel.type=(null==n?void 0:n.trim())?"Approve Case"===r.data.buttonModel.label?"success":"Reject Case"===r.data.buttonModel.label?"red":"primary":"disabled"}))}},{key:"ngAfterContentChecked",value:function(){this.changeDedectionRef.detectChanges()}},{key:"cancelDialog",value:function(){this.monitorService.logEvent("cancelDialog",["ChqRepairDialogComponent","addenda-quote"]),this.dialogRef.close()}},{key:"processCase",value:function(){this.commentForm.invalid||this.dialogRef.close({data:this.commentForm.controls.comment.value})}},{key:"getImages",value:function(){this.thumbnails=this.data.gallery,this.totalImages=this.thumbnails.length,this.showLoading=!0,this.currentImage=this.thumbnails[0].thumbImage}},{key:"showImage",value:function(e){this.index=e+1,this.showLoading=!0,this.currentImage=this.thumbnails[e].thumbImage}},{key:"prevImageClick",value:function(){this.index>1&&(this.index=this.index-1,this.slider.prev(),this.showLoading=!0,this.currentImage=this.thumbnails[this.index-1].thumbImage)}},{key:"nextImageClick",value:function(){this.index<this.slider.totalImages&&(this.index=this.index+1,this.slider.next(),this.showLoading=!0,this.currentImage=this.thumbnails[this.index-1].thumbImage)}},{key:"formControl",get:function(){return this.commentForm.controls.comment}},{key:"updateLoading",value:function(){this.showLoading=!this.showLoading}}]),t}();return t.\u0275fac=function(e){return new(e||t)(f.Y36(he.so),f.Y36(he.WI),f.Y36(f.sBO),f.Y36(C.M),f.Y36(pe.qu))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-chq-repair-dialog"]],viewQuery:function(e,t){var o;(1&e&&f.Gf(ye,5),2&e)&&(f.iGM(o=f.CRH())&&(t.slider=o.first))},decls:4,vars:4,consts:[["class","repair dialog-container",4,"ngIf"],["class","dialog-container-image",4,"ngIf"],["class","dialog-container dialog-container-comment",4,"ngIf"],["class","dialog-container dialog-container-email",4,"ngIf"],[1,"repair","dialog-container"],[1,"heading"],[1,"heading-content"],[1,"close-icon"],[3,"svgIcon","click"],[1,"info"],[1,"content"],[3,"formGroup"],[3,"ngClass"],["rows","8","formControlName","comment","maxlength","500","placeholder","",1,"input-wrapper"],["class","invalid",4,"ngIf"],[1,"button"],[3,"buttonModel","click"],[1,"invalid"],[1,"dialog-container-image"],[1,"image-content"],["class","navigation prev-button",4,"ngIf"],[3,"src","error","load"],[3,"showLoading"],["class","navigation next-button",4,"ngIf"],[1,"slider"],["class","prev-button",4,"ngIf"],["slideImage","1",3,"images","infinite","autoSlide","imageSize","imagePopup","showArrow","imageClick"],["nav",""],["class","next-button",4,"ngIf"],[1,"footer"],[1,"navigation","prev-button"],["aria-hidden","false","aria-label","Example chevron left icon","fontIcon","chevron_left",3,"click"],[1,"navigation","next-button"],["aria-hidden","false","aria-label","Example chevron right icon","fontIcon","chevron_right",3,"click"],[1,"prev-button"],[1,"next-button"],[1,"dialog-container","dialog-container-comment"],[1,"heading","heading-comment"],[1,"comment-content"],[1,"comment-status"],[1,"comment"],[1,"dialog-container","dialog-container-email"],[1,"email-status"],[1,"email-content"],[3,"innerHTML"]],template:function(e,t){1&e&&(f.YNc(0,we,16,9,"div",0),f.YNc(1,ke,17,16,"div",1),f.YNc(2,qe,9,3,"div",2),f.YNc(3,Se,18,11,"div",3)),2&e&&(f.Q6J("ngIf",!(null!=t.data&&t.data.imageGallery||t.showComment||t.showEmail)),f.xp6(1),f.Q6J("ngIf",null==t.data?null:t.data.imageGallery),f.xp6(1),f.Q6J("ngIf",t.showComment),f.xp6(1),f.Q6J("ngIf",t.showEmail))},directives:[s.O5,u.Hw,pe._Y,pe.JL,pe.sg,s.mk,pe.Fj,pe.JJ,pe.u,pe.nD,D.E,ve.h,be.sN],pipes:[k.X$],styles:[".repair.dialog-container{display:flex;flex-direction:column;justify-content:flex-start;padding:30px;grid-gap:36px;gap:36px}.repair.dialog-container .heading{display:flex;flex-direction:row;justify-content:space-between}.repair.dialog-container .heading .heading-content{display:flex;font-weight:700;font-size:20px;line-height:25px;align-items:center}.repair.dialog-container .heading-comment{justify-content:flex-end}.repair.dialog-container .info{font-weight:500;font-size:12px;line-height:14px;color:#000}.repair.dialog-container .content{position:relative}.repair.dialog-container .content label{height:14px;font-weight:400;font-size:10px;line-height:14px;text-transform:uppercase;color:var(--xa-dark-gray);flex:none;order:0;flex-grow:0;position:absolute;top:-8px;z-index:2;top:-6px;left:12px;padding:0 4px;background:var(--xa-white)}.repair.dialog-container .button{display:flex;justify-content:flex-end}.repair.dialog-container textarea{border-radius:8px;width:100%;box-sizing:border-box;padding:10px}.dialog-container-image{padding:20px;min-width:724px;max-width:724px;height:558px}.dialog-container-image .image-content{padding:20px;height:345px;display:flex;justify-content:center;align-items:center}.dialog-container-image .image-content img{height:100%}.dialog-container-image .slider{margin-top:19px;display:flex;flex-direction:row;justify-content:space-evenly}.dialog-container-image .slider .prev-button,.dialog-container-image .slider .next-button{display:flex;flex-direction:column;justify-content:space-around}.dialog-container-image .slider .prev-button img,.dialog-container-image .slider .next-button img{height:25px}.dialog-container-image .slider ng-image-slider{width:100%;margin:0 20px}.dialog-container-image .slider .ng-image-slider .ng-image-slider-container .main .main-inner .img-div{width:75px!important;margin-left:5px!important;margin-right:0!important}.dialog-container-image .slider .selected-image{border:1px solid #EAB308}.dialog-container-image .footer{margin-top:20px;display:flex;justify-content:center}.dialog-container-image .footer span{text-align:center}.dialog-container-comment{min-width:450px;max-width:450px;padding:32px 20px;overflow-x:hidden}.dialog-container-comment .comment-content{font-weight:500;font-size:14px;max-height:200px}.dialog-container-comment .comment-content .comment-status{margin-bottom:10px;font-size:16px}.dialog-container-comment .comment-content .comment{overflow-y:auto;overflow-x:hidden;white-space:pre-line}.dialog-container-email{min-width:450px;max-width:450px;padding:32px 20px;overflow-x:hidden}.dialog-container-email .email-status{margin-bottom:10px;font-size:1rem;font-weight:700;padding:.625rem 1.375rem;border-bottom:1px solid var(--xa-dp-light-gray)}.dialog-container-email .email-content{font-weight:500;font-size:.75rem;max-height:500px;border-radius:.625rem;padding:.625rem 1.375rem;background-color:rgba(27,3,163,.05)}.dialog-container .heading .close-icon,.dialog-container-image .heading .close-icon{justify-content:flex-end;display:flex}.dialog-container .heading .close-icon mat-icon,.dialog-container-image .heading .close-icon mat-icon{height:36px!important;width:36px!important;background:black;border-radius:50%;text-align:center}.dialog-container .heading .close-icon mat-icon svg,.dialog-container-image .heading .close-icon mat-icon svg{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.dialog-container .heading .close-icon mat-icon svg path,.dialog-container-image .heading .close-icon mat-icon svg path{fill:#fff}@media (orientation: portrait){.dialog-container-image{min-width:570px;max-width:570px}}.invalid{margin-top:6px;font-style:normal;font-weight:400;font-size:12px;line-height:18px;color:var(--xa-red);flex:none;order:2;align-self:stretch;flex-grow:0}.invalid-label{color:var(--xa-red)!important}.input-wrapper.ng-touched.ng-invalid{border:1px solid var(--xa-red);color:var(--xa-red);outline:0}.navigation{position:absolute;top:calc(50% - 55px)}.navigation.prev-button{left:0}.navigation.next-button{right:0}.navigation .mat-icon{font-size:50px!important;height:50px!important;width:50px!important}.ng-image-slider .ng-image-slider-container .main .main-inner .img-div .caption{padding:2px!important;background-image:linear-gradient(to right,rgba(0,0,0,.5),rgba(0,0,0,.6),rgba(0,0,0,.7),rgba(0,0,0,.8),rgba(0,0,0,.9))!important;font-size:10px}.email-content td{border-radius:5px!important;padding:5px!important}.email-content a{color:#fff!important;text-decoration:none!important;pointer-events:none!important}\n"],encapsulation:2}),t}(),Ze=r(50617),Te=r(84967),Fe=r(33568),Ne=r(84945),je=r(14368),Ae=r(75983),Ee=r(87855),Je=r(72076),Le=r(8851),Re=r(9988),Ve=["anchor"];function Ye(e,t){if(1&e&&(f.TgZ(0,"div",17),f.TgZ(1,"div",18),f.TgZ(2,"div",19),f.TgZ(3,"label"),f._uU(4),f.qZA(),f.qZA(),f.TgZ(5,"div",20),f.TgZ(6,"label"),f._uU(7),f.qZA(),f.TgZ(8,"span"),f._uU(9),f.qZA(),f.qZA(),f.qZA(),f.TgZ(10,"div",21),f._UZ(11,"img",22),f.TgZ(12,"div",20),f._UZ(13,"a",23,24),f.TgZ(15,"label"),f._uU(16),f.qZA(),f.TgZ(17,"span"),f._uU(18),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&e){var o=f.oxw(2);f.xp6(4),f.Oqu(o.customerData.initial),f.xp6(3),f.Oqu(o.customerData.firstName+" "+o.customerData.lastName),f.xp6(2),f.Oqu(o.customerData.countryCode+" "+o.customerData.mobileNumber),f.xp6(4),f.Q6J("href",o.downloadUrl,f.LSH)("hidden",!0)("download",o.pdfName),f.xp6(3),f.Oqu(null==o.caseData?null:o.caseData.vehicleMake),f.xp6(2),f.Oqu(null==o.caseData?null:o.caseData.vehicleModel)}}function Qe(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-estimate-details",25),f.NdJ("downloadPdf",function(){return f.CHM(o),f.oxw(2).downloadPdf()}),f.qZA()}if(2&e){var n=f.oxw(2);f.Q6J("estimateResponse",n.estimateResponse)("editEstimate",n.editEstimate)("estimateSource",n.estimateSource)("i18n",n.i18n)}}function Ge(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-button",29),f.NdJ("click",function(){return f.CHM(o),f.oxw(3).booking("create","")}),f.qZA()}if(2&e){var n=f.oxw(3);f.Q6J("buttonModel",n.createBooking)}}function He(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-button",29),f.NdJ("click",function(){f.CHM(o);var e=f.oxw(3);return e.booking("view",e.repairId)}),f.qZA()}if(2&e){var n=f.oxw(3);f.Q6J("buttonModel",n.viewBooking)}}function Ue(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-button",29),f.NdJ("click",function(){f.CHM(o);var e=f.oxw(3);return e.changeCaseStatusDialog(e.closeCaseButton)}),f.qZA()}if(2&e){var n=f.oxw(3);f.Q6J("buttonModel",n.closeCaseButton)}}function Be(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-button",29),f.NdJ("click",function(){f.CHM(o);var e=f.oxw(3);return e.changeCaseStatusDialog(e.approveCaseButton)}),f.qZA()}if(2&e){var n=f.oxw(3);f.Q6J("buttonModel",n.approveCaseButton)}}function ze(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-button",29),f.NdJ("click",function(){f.CHM(o);var e=f.oxw(3);return e.changeCaseStatusDialog(e.rejectButton)}),f.qZA()}if(2&e){var n=f.oxw(3);f.Q6J("buttonModel",n.rejectButton)}}function Xe(e,t){if(1&e&&f._UZ(0,"chq-button",30),2&e){var o=f.oxw(3);f.Q6J("buttonModel",o.calculationButton)}}function Ke(e,t){if(1&e&&(f.TgZ(0,"div",26),f.YNc(1,Ge,1,1,"chq-button",27),f.YNc(2,He,1,1,"chq-button",27),f.YNc(3,Ue,1,1,"chq-button",27),f.YNc(4,Be,1,1,"chq-button",27),f.YNc(5,ze,1,1,"chq-button",27),f.YNc(6,Xe,1,1,"chq-button",28),f.qZA()),2&e){var o=f.oxw(2);f.xp6(1),f.Q6J("ngIf",o.commonService.repairPermission&&!o.repairId&&"rejected"!==(null==o.caseStatus?null:o.caseStatus.toLowerCase())),f.xp6(1),f.Q6J("ngIf",o.commonService.repairPermission&&o.repairId),f.xp6(1),f.Q6J("ngIf",!o.isPendingApproval()&&o.isGTEstimate()&&"complete"!==(null==o.caseStatus?null:o.caseStatus.toLowerCase())),f.xp6(1),f.Q6J("ngIf",!o.isPendingApproval()&&o.isGTEstimate()&&o.currentRejStatus&&"complete"!==(null==o.caseStatus?null:o.caseStatus.toLowerCase())),f.xp6(1),f.Q6J("ngIf",!o.isPendingApproval()&&o.isGTEstimate()&&o.currentStatus&&"complete"!==(null==o.caseStatus?null:o.caseStatus.toLowerCase())),f.xp6(1),f.Q6J("ngIf",!o.isPendingApproval()&&o.isGTEstimate()&&o.currentRejStatus&&"complete"!==(null==o.caseStatus?null:o.caseStatus.toLowerCase()))}}function $e(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-dropdown",33),f.NdJ("selected",function(e){return f.CHM(o),f.oxw(3).changeCaseStatusDialog(e)}),f.qZA()}if(2&e){var n=f.oxw(3);f.Q6J("dropdownModel",n.dropdownModelFilter)}}function We(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-button",29),f.NdJ("click",function(){return f.CHM(o),f.oxw(3).booking("create","")}),f.qZA()}if(2&e){var n=f.oxw(3);f.Q6J("buttonModel",n.createBooking)}}function et(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"chq-button",29),f.NdJ("click",function(){f.CHM(o);var e=f.oxw(3);return e.booking("view",e.repairId)}),f.qZA()}if(2&e){var n=f.oxw(3);f.Q6J("buttonModel",n.viewBooking)}}function tt(e,t){if(1&e&&(f.TgZ(0,"div",31),f.YNc(1,$e,1,1,"chq-dropdown",32),f.YNc(2,We,1,1,"chq-button",27),f.YNc(3,et,1,1,"chq-button",27),f.qZA()),2&e){var o=f.oxw(2);f.xp6(1),f.Q6J("ngIf",!o.isPendingApproval()&&o.isGTEstimate()&&(o.commonService.repairPermission||"complete"!==(null==o.caseStatus?null:o.caseStatus.toLowerCase())&&!o.commonService.repairPermission)),f.xp6(1),f.Q6J("ngIf",o.commonService.repairPermission&&!o.repairId&&"rejected"!==(null==o.caseStatus?null:o.caseStatus.toLowerCase())),f.xp6(1),f.Q6J("ngIf",o.commonService.repairPermission&&o.repairId)}}var ot=function(e){return{hidden:e}};function nt(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"div",3),f.TgZ(1,"chq-step-header",4),f.NdJ("back",function(e){return f.CHM(o),f.oxw().handleBack(e)}),f.qZA(),f.YNc(2,Ye,19,8,"div",5),f.TgZ(3,"div",6),f.TgZ(4,"div",7),f.YNc(5,Qe,1,4,"chq-estimate-details",8),f._UZ(6,"chq-customloader",9),f.qZA(),f.qZA(),f.TgZ(7,"div",10),f.TgZ(8,"div",11),f.TgZ(9,"div",12),f._UZ(10,"img",13),f.qZA(),f.qZA(),f.YNc(11,Ke,7,6,"div",14),f.YNc(12,tt,4,3,"div",15),f.qZA(),f.TgZ(13,"history",16),f.NdJ("toggleExpand",function(){return f.CHM(o),f.oxw().getCaseHistory()}),f.qZA(),f.qZA()}if(2&e){var n=f.oxw();f.Q6J("ngClass",f.VKq(10,ot,n.showDamageAnalysis)),f.xp6(1),f.Q6J("chqModel",n.header)("showButton",!0),f.xp6(1),f.Q6J("ngIf",n.pageReady),f.xp6(3),f.Q6J("ngIf",n.showData),f.xp6(1),f.Q6J("showLoading",!n.showData),f.xp6(5),f.Q6J("ngIf",n.estimateResponse&&!n.commonService.isViewOnly),f.xp6(1),f.Q6J("ngIf",n.estimateResponse&&!n.commonService.isViewOnly),f.xp6(1),f.Q6J("history",n.history)("isLoading",n.isHistoryLoading)}}function it(e,t){if(1&e){var o=f.EpF();f.TgZ(0,"damage-analysis",34),f.NdJ("backEvent",function(e){return f.CHM(o),f.oxw().handleBack(e)}),f.qZA()}if(2&e){var n=f.oxw();f.Q6J("hideNext",!0)("caseDetail",n.caseResult)}}function at(e,t){1&e&&f._UZ(0,"no-access-error")}var rt={title:"create_estimate",step:5,description:"create_estimate_msg",stepName:"step_five"},st=function(){var e=function(){function e(t,o,n,i,a,r,s,c,l){var m=this;d(this,e),this.cd=t,this.commonService=o,this.caseService=n,this.repairEstimateService=i,this.route=a,this.monitorService=r,this.inspectionService=s,this.dialog=c,this.router=l,this.header=rt,this.customerFormData={jobNumber:"1212",companyOrgType:"",claimNumber:"",companyName:"",tariffId:0,isTariffEditable:!0,licenseId:"",companyId:0,partnershipId:0,firstName:"John",lastName:"Doe",driverCode:"+971",driverPhone:502302030,carOwnerSelector:"Person",email:""},this.isInitCalled=!1,this.dialogData=ue,this.showGen=!0,this.pageReady=!1,this.showData=!1,this.showInspection=!1,this.pdfName="",this.showNoAccess=!1,this.editEstimate=!1,this.estimateSource="",this.dropdownModelFilter={options:[{label:"Edit Calculations",dropdownItemIcon:"edit"},{label:"Reject",dropdownItemIcon:"cross",color:"var(--xa-red) !important"},{label:"Approve",dropdownItemIcon:"check"},{label:"Complete",dropdownItemIcon:"folderplus"}],placeHolder:"Options",label:"",appearance:"button",placeHolderIcon:"settings",name:"option",displayValue:"label",selectedOption:{}},this.history=[],this.isHistoryLoading=!1,this.commonService.accessRight.closed&&(this.commonService.accessRight=new g.X(!0)),this.commonService.userProfileData.subscribe(function(e){if(e&&e.data){var t=e.data.organizationDetail;t&&(m.currentOrgId=t.id)}}),this.i18n=this.commonService.geti18nInfo()}return l(e,[{key:"isiOS",get:function(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}},{key:"handleVisibilityChange",value:function(e){var t,o;!this.isInitCalled||!this.isiOS||!this.orgName||0==(null===(o=null===(t=this.estimateResponse)||void 0===t?void 0:t.estimateCharges)||void 0===o?void 0:o.length)&&this.getEstimationDetail(this.orgName)}},{key:"onPopState",value:function(e){sessionStorage.setItem("update","0")}},{key:"ngAfterViewInit",value:function(){this.commonService.updatePage("/quote/case/0","estimate"),this.cd.detectChanges(),this.showGen=!1,this.monitorService.logEvent("ngAfterViewInit",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid}])}},{key:"handleBack",value:function(e){this.showDamageAnalysis=!e.back,this.monitorService.logEvent("handleBack",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid}])}},{key:"ngOnInit",value:function(){var e,t=this;this.caseGuid=null===(e=this.route.parent)||void 0===e?void 0:e.snapshot.paramMap.get("id"),this.getCaseDetail(),this.isInitCalled=!0,this.closeCaseButton={label:"Complete",type:"primary",icon:"folderplus"},this.approveCaseButton={label:"Approve",type:"success",icon:"check"},this.rejectButton={label:"Reject",type:"outline-danger",icon:"cross"},this.calculationButton={label:"Edit Calculations",type:"outline",icon:"edit",onclick:this.editGtMotive.bind(this)},this.createBooking={label:"Create Booking",type:"outline",icon:"calendar"},this.viewBooking={label:"View Booking",type:"outline",icon:"view"},this.commonService.accessRight.subscribe({next:function(e){e||(t.showNoAccess=!0)}});var o=document.querySelector(".addenda-container");o&&(o.scrollTop=0),this.monitorService.logEvent("ngOnInit",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid}])}},{key:"editGtMotive",value:function(){this.repairId?this.commonService.showChangeWarningMessage(this.redirectToGtEstimate.bind(this),Ae.j.repair):this.redirectToGtEstimate()}},{key:"changeCaseStatusDialog",value:function(e){var t,o,n,i,a,r,s=this,c=null,l="";if("Edit Calculations"!=(null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.label)&&"Edit Calculations"!=(null==e?void 0:e.label)){if("Approve"==(null===(o=null==e?void 0:e.value)||void 0===o?void 0:o.label)||"Approve"==(null==e?void 0:e.label))c=this.dialogData.approve,l="Approved";else if("Complete"==(null===(n=null==e?void 0:e.value)||void 0===n?void 0:n.label)||"Complete"==(null==e?void 0:e.label))c=this.dialogData.complete,l="Complete";else if("Reject"==(null===(i=null==e?void 0:e.value)||void 0===i?void 0:i.label)||"Reject"==(null==e?void 0:e.label))c=this.dialogData.reject,l="Rejected";else{if("View Booking"==(null===(a=null==e?void 0:e.value)||void 0===a?void 0:a.label)||"View Booking"==(null==e?void 0:e.label))return void this.booking("view",this.repairId);if("Create Booking"==(null===(r=null==e?void 0:e.value)||void 0===r?void 0:r.label)||"Create Booking"==(null==e?void 0:e.label))return void this.booking("create","")}this.monitorService.logEvent("changeCaseStatusDialog",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid,status:l}]),this.dialog.open(_e,{autoFocus:!1,data:c}).afterClosed().subscribe({next:function(e){s.commonService.showLoading(),e?s.caseService.updateCaseStatus(s.caseGuid,l,e.data).subscribe({next:function(){s.monitorService.logEvent("updateCaseStatus",["ChqRepairEstimateComponent","addenda-quote",{caseId:s.caseGuid,status:l}]),s.caseStatus=l,s.toggleOption(l)},complete:function(){s.commonService.hideLoading()},error:function(){s.commonService.hideLoading()}}):s.commonService.hideLoading()}})}else this.repairId?this.commonService.showChangeWarningMessage(this.redirectToGtEstimate.bind(this),Ae.j.repair):this.redirectToGtEstimate()}},{key:"redirectToGtEstimate",value:function(){var e=this;this.commonService.showLoading(),this.monitorService.logEvent("redirectToGtEstimate",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid,status:status}]),this.route.snapshot.queryParams.send&&"true"==this.route.snapshot.queryParams.send&&this.router.navigate([],{relativeTo:this.route,queryParams:{send:"false"},queryParamsHandling:"merge"}),this.repairEstimateService.createEstimate(this.caseGuid,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:function(e){e&&(location.href=e.data.url,sessionStorage.setItem("update","1"))},complete:function(){e.commonService.hideLoading()}})}},{key:"downloadPdf",value:function(){var e=this;this.commonService.showLoading(),this.monitorService.logEvent("downloadPdf",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid}]),this.repairEstimateService.getXADownloadUrl(this.caseGuid).subscribe({next:function(t){window.open(t.data.url,"_top"),e.commonService.hideLoading()},error:function(){e.commonService.hideLoading()}})}},{key:"currentRejStatus",get:function(){var e;return!!this.caseStatus&&-1===["approved","closed","complete"].indexOf(null===(e=this.caseStatus)||void 0===e?void 0:e.toLowerCase())}},{key:"currentStatus",get:function(){var e;return!!this.caseStatus&&-1===["approved","closed","complete"].indexOf(null===(e=this.caseStatus)||void 0===e?void 0:e.toLowerCase())}},{key:"getCaseHistory",value:function(){var e=this;this.history=[],this.isHistoryLoading=!0,this.caseService.getCaseHistory(this.caseGuid,this.domainId).subscribe({next:function(t){e.history=t},complete:function(){e.isHistoryLoading=!1}})}},{key:"getCaseDetail",value:function(){var e=this;this.caseService.getCaseDetail(this.caseGuid).subscribe({next:function(t){var o,n,i,a;if(null==t?void 0:t.data){var r=t.data,s=r.inspections,c=r.vehicleId,l=r.status,d=r.orgName,m=r.repairGuid,u=r.domainID;if(e.commonService.caseStatus.next(l),e.inspectionId=s?null===(o=s[0])||void 0===o?void 0:o.inspectionId:"",-1===["uploadphotos","repairestimation","closed","rejected","approved","complete","pendingapproval","readytoinvoice","invoiceready"].indexOf(l.toLowerCase()))return;e.vehicleId=c,e.repairId=m,e.caseStatus=l,e.domainId=u,e.toggleOption(l),e.header.caseNumber=t.data.caseNumber,e.caseResult=t.data,e.customerData=t.data.caseDetail,e.orgName=d,e.customerData=Object.assign(Object.assign({},e.customerData),{initial:(null===(n=e.customerData.firstName)||void 0===n?void 0:n.substring(0,1).toUpperCase())+(null===(i=e.customerData.lastName)||void 0===i?void 0:i.substring(0,1).toUpperCase())}),e.pageReady=!0,e.commonService.isViewOnly=e.currentOrgId!=(null===(a=t.data.organizationDetail)||void 0===a?void 0:a.organizationId);var p=sessionStorage.getItem("update")||"0";"0"===p?(e.getEstimationDetail(d),e.commonService.updatePage("/quote/case/0","estimate")):"1"===p&&e.route.snapshot.queryParams.send&&"true"==e.route.snapshot.queryParams.send?e.repairEstimateService.readUpdateEstimate(e.caseGuid,t.data.inspections[0].inspectionId,t.data.vehicleId,"put",e.domainId).subscribe({next:function(){sessionStorage.setItem("update","0"),e.getEstimationDetail(d),e.router.navigate([],{relativeTo:e.route,queryParams:{send:"false"},queryParamsHandling:"merge"}),e.commonService.hideLoading(),setTimeout(function(){e.commonService.updatePage("/quote/case/0","estimate")})}}):e.getEstimationDetail(d)}},error:function(){e.commonService.hideLoading()}})}},{key:"getEstimationDetail",value:function(e){var t=this;this.repairEstimateService.getEstimate(this.caseGuid,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:function(o){var n,i,a;t.estimateResponse=o.data,t.caseData={vehicleMake:t.estimateResponse.make,vehicleModel:t.estimateResponse.modelCode},t.estimateResponse.orgName=e,t.estimateSource=null===(n=o.data)||void 0===n?void 0:n.externalSource,t.estimateResponse.currencyCode||(t.estimateResponse.currencyCode=t.i18n.currencySymbol),0==(null===(a=null===(i=t.estimateResponse)||void 0===i?void 0:i.estimateCharges)||void 0===a?void 0:a.length)?(t.commonService.hideLoading(),t.showConfirmationPopup()):(t.getInspection(),t.showData=!0),t.commonService.hideLoading()},error:function(){t.commonService.hideLoading()}})}},{key:"getInspection",value:function(){var e=this;this.inspectionService.getInspectionTemplateList().subscribe({next:function(t){var o=null==t?void 0:t.data;(null==o?void 0:o.length)>0&&(e.commonService.repairInspectionTemplate=o[0],(0,Te.D)({inspectionTemplate:e.inspectionService.getInspectionTemplate(o[0].id),inspectionDetail:e.inspectionService.getInspection(e.inspectionId)}).pipe((0,Fe.K)(function(e){return(0,Ne.of)(e)})).subscribe(function(t){var o,n,i,a,r=null===(o=t.inspectionTemplate)||void 0===o?void 0:o.inspectionItemTemplates,s=t.inspectionDetail,c=null==r?void 0:r.filter(function(e){return"Bulk Upload Image"===e.name});e.images=null===(n=null==s?void 0:s.inspectionItems)||void 0===n?void 0:n.filter(function(e){return("Bulk Upload Image"==e.name||e.inspectionItemTemplateID===c[0].id)&&""!=e.rawAzureBlobUrl}).map(function(e){return e.rawAzureBlobUrl}),0==(null===(i=e.images)||void 0===i?void 0:i.length)&&(e.images=null===(a=null==s?void 0:s.inspectionItems)||void 0===a?void 0:a.filter(function(e){return"Bulk Upload Image"!=e.name&&""!=e.rawAzureBlobUrl}).map(function(e){return e.rawAzureBlobUrl})),e.showInspection=!0}))}})}},{key:"showConfirmationPopup",value:function(){var e=this;this.dialog.open(je.I,{disableClose:!0,data:{message:"The estimate values are 0. Press continue to navigate to gtmotive."},backdropClass:"confirmation-popup-backdrop"}).afterClosed().subscribe({next:function(t){console.log(t),t&&e.redirectToGtEstimate()}})}},{key:"toggleOption",value:function(e){this.dropdownModelFilter="reject"===e.toLowerCase()||"rejected"===e.toLowerCase()?Object.assign(Object.assign({},this.dropdownModelFilter),{options:[{label:"Edit Calculations",dropdownItemIcon:"edit"},{label:"Reject",dropdownItemIcon:"cross",color:"var(--xa-red) !important"},{label:"Approve",dropdownItemIcon:"check"},{label:"Complete",dropdownItemIcon:"folderplus"}]}):"approved"===e.toLowerCase()?Object.assign(Object.assign({},this.dropdownModelFilter),{options:[{label:"Complete",dropdownItemIcon:"folderplus"}]}):"complete"===e.toLowerCase()?Object.assign(Object.assign({},this.dropdownModelFilter),{options:[]}):Object.assign(Object.assign({},this.dropdownModelFilter),{options:[{label:"Edit Calculations",dropdownItemIcon:"edit"},{label:"Reject",dropdownItemIcon:"cross",color:"var(--xa-red) !important"},{label:"Approve",dropdownItemIcon:"check"},{label:"Complete",dropdownItemIcon:"folderplus"}]})}},{key:"booking",value:function(e,t){"create"===e?this.router.navigate(["repair/booking/0"],{queryParams:{caseId:this.caseGuid}}):this.router.navigate(["repair/booking/".concat(t)])}},{key:"ngOnDestroy",value:function(){this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["ChqRepairEstimateComponent","addenda-quote"]),this.commonService.isViewOnly=!1}},{key:"isGTEstimate",value:function(){return"GTMotive"===this.estimateSource}},{key:"isPendingApproval",value:function(){var e;return"pendingapproval"===(null===(e=this.caseStatus)||void 0===e?void 0:e.toLowerCase())}}]),e}();return e.\u0275fac=function(t){return new(t||e)(f.Y36(f.sBO),f.Y36(M.v),f.Y36(w.n),f.Y36(Ee.H),f.Y36(c.gz),f.Y36(C.M),f.Y36(K.a),f.Y36(he.uw),f.Y36(c.F0))},e.\u0275cmp=f.Xpm({type:e,selectors:[["chq-repair-estimate"]],viewQuery:function(e,t){var o;(1&e&&(f.Gf(Ze.y,5),f.Gf(Ve,5)),2&e)&&(f.iGM(o=f.CRH())&&(t.elementRef=o.first),f.iGM(o=f.CRH())&&(t.anchor=o.first))},hostBindings:function(e,t){1&e&&f.NdJ("visibilitychange",function(e){return t.handleVisibilityChange(e)},!1,f.evT)("popstate",function(e){return t.onPopState(e)},!1,f.Jf7)},inputs:{customerFormData:"customerFormData"},decls:3,vars:3,consts:[["class","estimate-container",3,"ngClass",4,"ngIf"],[3,"hideNext","caseDetail","backEvent",4,"ngIf"],[4,"ngIf"],[1,"estimate-container",3,"ngClass"],[1,"header",3,"chqModel","showButton","back"],["class","info-container",4,"ngIf"],[1,"estimate-block","row"],[1,"quote-estimate-step","col-12"],["serviceType","repair",3,"estimateResponse","editEstimate","estimateSource","i18n","downloadPdf",4,"ngIf"],[3,"showLoading"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-quote.png"],["class","footer-button-wrapper show-md",4,"ngIf"],["class","footer-button-wrapper show-sm",4,"ngIf"],["serviceType","quote",3,"history","isLoading","toggleExpand"],[1,"info-container"],[1,"info-block"],[1,"avatar"],[1,"text-block"],[1,"vehicle-block"],["src","assets/img/default_car.png"],[3,"href","hidden","download"],["anchor",""],["serviceType","repair",3,"estimateResponse","editEstimate","estimateSource","i18n","downloadPdf"],[1,"footer-button-wrapper","show-md"],[3,"buttonModel","click",4,"ngIf"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel","click"],[3,"buttonModel"],[1,"footer-button-wrapper","show-sm"],["class","option-dropdown",3,"dropdownModel","selected",4,"ngIf"],[1,"option-dropdown",3,"dropdownModel","selected"],[3,"hideNext","caseDetail","backEvent"]],template:function(e,t){1&e&&(f.YNc(0,nt,14,12,"div",0),f.YNc(1,it,1,2,"damage-analysis",1),f.YNc(2,at,1,0,"no-access-error",2)),2&e&&(f.Q6J("ngIf",!t.showNoAccess),f.xp6(1),f.Q6J("ngIf",t.showDamageAnalysis),f.xp6(1),f.Q6J("ngIf",t.showNoAccess))},directives:[s.O5,s.mk,x._,ve.h,Je.r,D.E,Le.I,Re.wm,P.U],styles:[".estimate-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .info-block[_ngcontent-%COMP%], .estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .vehicle-block[_ngcontent-%COMP%]{padding:10px 32px;display:flex;flex-direction:row;align-items:center;border:1px solid var(--xa-light-gray);flex:1}.estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .info-block[_ngcontent-%COMP%]   .text-block[_ngcontent-%COMP%], .estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .vehicle-block[_ngcontent-%COMP%]   .text-block[_ngcontent-%COMP%]{margin-left:12px;display:flex;flex-direction:column}.estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .info-block[_ngcontent-%COMP%]   .text-block[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .vehicle-block[_ngcontent-%COMP%]   .text-block[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;font-size:20px;line-height:25px;display:flex;align-items:center;letter-spacing:-.25px}.estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .info-block[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .vehicle-block[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:auto;width:auto;max-height:45px;max-width:102px}.estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .info-block[_ngcontent-%COMP%]{border-left:none}.estimate-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .vehicle-block[_ngcontent-%COMP%]{border-left:none;border-right:none}.estimate-container[_ngcontent-%COMP%]   .estimate-block[_ngcontent-%COMP%]{display:flex;margin:0}.estimate-container[_ngcontent-%COMP%]   .estimate-block[_ngcontent-%COMP%]   .estimate-tables[_ngcontent-%COMP%]{padding:20px 20px 0 0;position:relative}.estimate-container[_ngcontent-%COMP%]   .estimate-block[_ngcontent-%COMP%]   .image-slider[_ngcontent-%COMP%]{padding:20px 0 0 10px;position:relative}.estimate-container[_ngcontent-%COMP%]   .estimate-block[_ngcontent-%COMP%]   .estimate-tables[_ngcontent-%COMP%]{border-right:1px solid var(--xa-light-gray)}.estimate-container[_ngcontent-%COMP%]   .estimate-block[_ngcontent-%COMP%]   .estimate-tables[_ngcontent-%COMP%]   chq-customloader[_ngcontent-%COMP%]{margin:auto}.hidden[_ngcontent-%COMP%]{display:none!important}.avatar[_ngcontent-%COMP%]{width:60px;height:61px;background:rgba(26,34,51,.2);border-radius:100px;display:flex;flex-direction:row;justify-content:center;align-items:center}.avatar[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;font-size:20px;line-height:25px}.show-sm[_ngcontent-%COMP%]{display:none!important}@media (max-width: 985px){.show-md[_ngcontent-%COMP%]{display:none!important}.show-sm[_ngcontent-%COMP%]{display:flex!important}}.quote-estimate-step[_ngcontent-%COMP%]     .estimate-main-container{border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-white);margin-top:25px;margin-bottom:25px;padding:0 32px 32px}.quote-estimate-step[_ngcontent-%COMP%]     .estimate-main-container chq-customloader{margin:auto}.quote-estimate-step[_ngcontent-%COMP%]     .estimate-label{margin-top:25px}.quote-estimate-step[_ngcontent-%COMP%]     .estimate-label, .quote-estimate-step[_ngcontent-%COMP%]     .estimate-main-container{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.option-dropdown[_ngcontent-%COMP%]{width:180px}"]}),e}(),ct=r(42895),lt=r(39075),dt=r(74743),mt=r(88784),ut=r(44466),pt=r(4704),ht=r(64307),gt=function(){var e=function(e){n(o,e);var t=a(o);function o(){return d(this,o),t.apply(this,arguments)}return l(o)}(lt.hm);return e.\u0275fac=function(){var t;return function(o){return(t||(t=f.n5z(e)))(o||e)}}(),e.\u0275prov=f.Yz7({token:e,factory:e.\u0275fac}),e}(),ft=[{path:"",component:Q,canDeactivate:[ct.I],resolve:{version:dt.n}},{path:"vehicle",component:me,resolve:{version:dt.n}},{path:"document",component:ht.O,resolve:{version:dt.n}},{path:"photos",component:pt.X,resolve:{version:dt.n}},{path:"estimate",component:st,resolve:{version:dt.n}},{path:"refresh",component:Q}],vt=function(){var e=l(function e(){d(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f.oAB({type:e}),e.\u0275inj=f.cJS({providers:[ct.I,{provide:lt.ok,useClass:gt}],imports:[[lt.t6,s.ez,u.Ps,p.p,ut.m,c.Bz.forChild(ft),m.H,mt.T,k.aw]]}),e}()}}])}();