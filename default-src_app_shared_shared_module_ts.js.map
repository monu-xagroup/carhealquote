{"version":3,"file":"default-src_app_shared_shared_module_ts.js","mappings":"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","sources":["./src/app/shared/add-photos/add-photos.component.ts","./src/app/shared/add-photos/add-photos.component.html","./src/app/shared/error-page/error.module.ts","./src/app/shared/error-page/no-access-error/no-access-error.component.ts","./src/app/shared/error-page/no-access-error/no-access-error.component.html","./src/app/shared/new-documents/new-documents.component.ts","./src/app/shared/new-documents/new-documents.component.html","./src/app/shared/new-photos/new-photos.component.ts","./src/app/shared/new-photos/new-photos.component.html","./src/app/shared/shared.module.ts"],"sourcesContent":["import { Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges } from '@angular/core';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { ChqWidgetsHeaderModel } from 'src/app/model/chq-widgets-header-model';\r\nimport { CalendarService } from 'src/app/services/calendar/calendar.service';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\nimport { InspectionService } from 'src/app/services/inspection-service/inspection.service';\r\nimport { MonitorService } from 'src/app/services/monitor-service/monitor.service';\r\nimport { RepairEstimateService } from 'src/app/services/repair-estimate/repair-estimate.service';\r\n\r\nconst photosHeader: ChqWidgetsHeaderModel = {\r\n  title: 'add_damage_photos',\r\n  step: 4,\r\n  description: 'damage_photos_msg',\r\n  stepName: 'step_four',\r\n};\r\n@Component({\r\n  selector: 'add-photos',\r\n  templateUrl: './add-photos.component.html',\r\n  styleUrls: [ './add-photos.component.scss' ]\r\n})\r\nexport class AddPhotosComponent implements OnChanges {\r\n  @Output() mode: EventEmitter<{ 'mode': string }> = new EventEmitter();  \r\n  @Input() caseNumber: string;\r\n  @Input() caseData:any;\r\n  @Input() showNotify:boolean;\r\n  @Input() showComplete:boolean;\r\n  @Input() showEstimate:boolean = false;\r\n  @Input() repairUnapproved:boolean;\r\n  @Input() repairData: any;\r\n  @Output() notify: EventEmitter<any> = new EventEmitter();  \r\n  @Output() completeRepair: EventEmitter<any> = new EventEmitter();  \r\n\r\n  public nextButton: ChqWidgetsButtonModel = {\r\n    label: 'Next create estimate',\r\n    type: 'primary',\r\n    color: 'primary',\r\n    icon: 'boardview'\r\n  }\r\n  @Input() photosHeader: ChqWidgetsHeaderModel = photosHeader;\r\n\r\n  @Input() activateRepairButton:boolean;\r\n  @Input() showSPI:boolean;\r\n  @Input() hideBulk:boolean;\r\n  @Input() isRepairComplete:boolean;\r\n\r\n  public notifyButtonModel: ChqWidgetsButtonModel = {\r\n    label: 'notify',\r\n    type: 'outline',\r\n    icon: 'send',\r\n    onclick: ()=>{\r\n      this.notify.emit()\r\n    }\r\n  }\r\n\r\n  public addPartButtonModel: ChqWidgetsButtonModel = {\r\n    label: 'Complete Repair',\r\n    type: 'disabled',\r\n    onclick: ()=>{\r\n      this.completeRepair.emit()\r\n    }\r\n  }\r\n\r\n  /**\r\n   * initialize single Upload\r\n   */\r\n  allowSingleUpload():void {\r\n    this.mode.emit({ 'mode': 'single' })\r\n  }\r\n\r\n  /**\r\n   * show delete\r\n   */\r\n  get showDelete(): boolean {\r\n    if (this.repairData?.repairGuid && this.repairData?.status?.toLowerCase() === 'draft') {\r\n      return true;\r\n    } else if (this.repairData?.repairGuid && this.repairData?.repairGuidisRepairCreatedFromCase == true && this.repairData?.status?.toLowerCase() == 'repairestimation') {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * constructor\r\n   */\r\n  constructor( private monitorService: MonitorService,\r\n    public commonService: CommonService,\r\n    private route: ActivatedRoute,\r\n    private dialog: MatDialog,\r\n    private caseService: CaseService,\r\n    private router: Router,\r\n    private inspectionService: InspectionService,\r\n    private estimateService: RepairEstimateService,\r\n    private calendarService: CalendarService) {}\r\n\r\n  /**\r\n   * detects changes in input attributes\r\n   * @param changes \r\n   */\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    this.monitorService.logEvent('allowMultipleUpload', [ 'ChqAddPhotosComponent', 'addenda-quote', {\r\n      changes\r\n    } ]);\r\n    if (changes) {\r\n      if (changes['caseNumber'] && changes['caseNumber'].currentValue) {\r\n        this.photosHeader = { ...this.photosHeader, caseNumber: this.caseNumber };    \r\n      }\r\n\r\n      if (changes['activateRepairButton'] && changes['activateRepairButton'].currentValue) {\r\n        this.addPartButtonModel = { ...this.addPartButtonModel, type: 'primary' };\r\n      }\r\n      \r\n      if (changes['isRepairComplete'] && changes['isRepairComplete'].currentValue) {\r\n        this.addPartButtonModel = { ...this.addPartButtonModel, label: 'go_invoice' }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * initialize multiple Upload\r\n   */\r\n  allowMultipleUpload():void {\r\n    this.monitorService.logEvent('allowMultipleUpload', [ 'ChqAddPhotosComponent', 'addenda-quote' ]);\r\n    this.mode.emit({ 'mode': 'multiple' })\r\n  }\r\n\r\n  public cameraButtonModel: ChqWidgetsButtonModel = {\r\n    label: 'camera_upload',\r\n    type: 'primary',\r\n    icon: 'camera',\r\n    color: 'primary',\r\n    onclick: this.allowSingleUpload.bind(this)\r\n  }\r\n  public bulkUploadButtonModel: ChqWidgetsButtonModel = {\r\n    label: 'btn_bulk_upload',\r\n    type: 'primary',\r\n    icon: 'upload',\r\n    color: 'primary',\r\n    onclick: this.allowMultipleUpload.bind(this)\r\n  }\r\n\r\n  public cancelButtonModel: ChqWidgetsButtonModel = {\r\n    label: 'Cancel Booking',\r\n    type: 'outline-danger',\r\n    onclick: this.cancelBooking.bind(this)\r\n  }\r\n\r\n  /**\r\n   * go to gtEstimate\r\n   */\r\n  redirectToGtEstimate():void {\r\n    \r\n    this.commonService.showLoading();\r\n    const { status, caseGuid, inspections, vehicleId, domainID } = this.caseData;\r\n    let inspectionId = 0;\r\n    if (inspections?.length > 0) {\r\n      inspectionId = inspections[0].inspectionId;\r\n    }\r\n    if (status?.toLowerCase() === 'uploaddocuments') {\r\n      this.monitorService.logEvent('redirectToGtEstimate', [ 'ChqDamageAnalysisComponent', 'addenda-quote', {\r\n        caseId: caseGuid\r\n      } ]);\r\n      this.caseService.updateCaseStatus(caseGuid, 'UploadPhotos').subscribe({\r\n        next: (resp: any): void => {\r\n          this.estimateService.createEstimate(caseGuid, inspectionId, vehicleId, domainID).subscribe({\r\n            next: (resp: any) => {\r\n              if (resp) {\r\n                if(resp?.data?.url){\r\n                  location.href = resp?.data?.url;\r\n                  sessionStorage.setItem('update', '1');\r\n                }\r\n              }\r\n            },\r\n            complete: () => {\r\n              this.commonService.hideLoading();\r\n            }\r\n          });\r\n        }, error: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      })\r\n    }else if(status?.toLowerCase() === 'uploadphotos'){\r\n      this.monitorService.logEvent('redirectToGtEstimate', [ 'ChqDamageAnalysisComponent', 'addenda-quote', {\r\n        caseId: caseGuid\r\n      } ]);\r\n      this.estimateService.createEstimate(caseGuid, inspectionId, vehicleId, domainID).subscribe({\r\n        next: (resp: any) => {\r\n          if (resp) {\r\n            if(resp?.data){\r\n              location.href = resp.data.url;\r\n              sessionStorage.setItem('update', '1');\r\n            } \r\n          }\r\n        },\r\n        complete: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      });\r\n    } else {\r\n      this.monitorService.logEvent('skipped_redirectToGtEstimate', [ 'ChqDamageAnalysisComponent', 'addenda-quote', {\r\n        caseId: caseGuid\r\n      } ]);\r\n      this.router.navigate([ `/case/${caseGuid}/estimate` ]);\r\n    }\r\n   \r\n  }\r\n\r\n  /**\r\n   * oninit\r\n   */\r\n  ngOnInit(): void {\r\n    const repairData = this.repairData;\r\n    this.nextButton.onclick = this.redirectToGtEstimate.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Cancel booking\r\n   */\r\n  cancelBooking(): void {\r\n    this.commonService.openDeleteDialog()\r\n      .afterClosed().subscribe((data) => {\r\n        if (data) {\r\n          this.commonService.showLoading();\r\n          this.calendarService.deleteBooking(this.repairData?.booking?.bookingGuid).subscribe({\r\n            next: () => {\r\n              this.commonService.hideLoading();\r\n              this.router.navigate([ '/repair/booking-journal' ]);\r\n            }\r\n          });\r\n        }\r\n      });\r\n  }\r\n}\r\n","<div class=\"add-photo-container\">\r\n    <chq-step-header [chqModel]=\"photosHeader\"\r\n        *ngIf=\"photosHeader.isRepairModule !== true  || photosHeader.isHeaderOnly === true\"></chq-step-header>\r\n    <div class=\"photo-container\" *ngIf=\"(showSPI || !hideBulk) && !repairUnapproved && !commonService.isViewOnly\">\r\n        <div class=\"card-container\">\r\n            <div class=\"card\" *ngIf=\"showSPI\">\r\n                <label class=\"card-title\">{{ 'smart_photo_inspection' | translate }}</label>\r\n                <p class=\"card-action\">{{ 'open_your_camera' | translate }}</p>\r\n                <p class=\"card-description\">\r\n                    {{ 'add_photo_msg' | translate }}\r\n                </p>\r\n                <chq-button [buttonModel]=\"cameraButtonModel\"></chq-button>\r\n            </div>\r\n            <div class=\"card\" *ngIf=\"!hideBulk\">\r\n                <label class=\"card-title\">{{ 'bulk_upload' | translate }}</label>\r\n                <p class=\"card-action\">{{ 'upload_device' | translate }}</p>\r\n                <p class=\"card-description\">\r\n                    {{ 'bulk_msg' | translate }}\r\n                </p>\r\n                <chq-button [buttonModel]=\"bulkUploadButtonModel\"></chq-button>\r\n            </div>\r\n        </div>\r\n        <!-- <div class=\"card-container\" *chqPermission=\"'technician'\">\r\n            <div class=\"no-document-div\">\r\n                <img src=\"assets/icons/no-document.svg\">    \r\n                <label class=\"no-vehicle-content\">\r\n                    {{ 'bulk_spi_disabled' | translate}}\r\n                </label>\r\n            </div>\r\n        </div> -->\r\n    </div>\r\n    <div class=\"wrapper\" *ngIf=\"(!showSPI && hideBulk) || repairUnapproved || commonService.isViewOnly\">\r\n        <div class=\"no-document-div\">\r\n            <img src=\"assets/icons/no-document.svg\">\r\n            <label class=\"no-vehicle-content\">\r\n                {{ (repairUnapproved ? 'start_job' : 'bulk_spi_disabled') | translate}}\r\n            </label>\r\n\r\n        </div>\r\n    </div>\r\n    <div class=\"footer-full-wrapper\">\r\n        <div class=\"footer-image-wrapper wrapper-flex\">\r\n            <div class=\"image-wrapper\">\r\n                <img src=\"assets/img/{{ + photosHeader.isRepairModule ?'addenda-repair.png':'addenda-quote.png'}}\" />\r\n            </div>\r\n            <div class=\"footer-button-wrapper\">\r\n                <chq-button [buttonModel]=\"cancelButtonModel\"\r\n                    *ngIf=\"showDelete && photosHeader?.isRepairModule\"></chq-button>\r\n                <chq-button *ngIf=\"showEstimate && !photosHeader.isRepairModule \" class=\"margin-right\"\r\n                    [buttonModel]=\"nextButton\"></chq-button>\r\n                <chq-button [buttonModel]=\"notifyButtonModel\" *ngIf=\"showNotify\"></chq-button>\r\n                <chq-button *ngIf=\"showComplete\" class=\"margin-right\" [buttonModel]=\"addPartButtonModel\"></chq-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RouterModule } from '@angular/router';\r\n\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatSidenavModule } from '@angular/material/sidenav';\r\nimport { MatTabsModule } from '@angular/material/tabs';\r\nimport { MatToolbarModule } from '@angular/material/toolbar';\r\nimport { WidgetsModule } from 'src/app/widgets/chq-widgets.module';\r\nimport { NoAccessErrorComponent } from './no-access-error/no-access-error.component';\r\n\r\n@NgModule({\r\n  declarations: [  \r\n    NoAccessErrorComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatInputModule,\r\n    WidgetsModule,\r\n    MatSidenavModule,\r\n    MatTabsModule,\r\n    MatToolbarModule,\r\n  ],\r\n  exports: [ RouterModule, NoAccessErrorComponent ],\r\n})\r\nexport class ErrorModule {}\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'no-access-error',\r\n  templateUrl: './no-access-error.component.html',\r\n  styleUrls: [ './no-access-error.component.scss' ]\r\n})\r\nexport class NoAccessErrorComponent {\r\n\r\n}\r\n","<div class=\"main-container\">\r\n    <div class=\"\" style=\"\">\r\n        <img src=\"assets/img/no-access.png\"/>\r\n    </div>\r\n</div>\r\n","import { AfterViewInit, ChangeDetectorRef, Component, Input, OnInit, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { SeverityLevel } from '@microsoft/applicationinsights-web';\r\nimport { BehaviorSubject, catchError, forkJoin, of } from 'rxjs';\r\nimport { FooterModel, UploadStepModel } from 'src/app/model/chq-upload-model';\r\nimport { ChqWidgetsButtonModel } from 'src/app/model/chq-widgets-button-model';\r\nimport { ChqWidgetsHeaderModel } from 'src/app/model/chq-widgets-header-model';\r\nimport { documentPartMapper } from 'src/app/modules/quote/chq-new-cases/chq-new-customer/chq-new-customer-form-data-helper';\r\nimport { BookingService } from 'src/app/services/booking/booking.service';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\nimport { MediacollectionService } from 'src/app/services/mediacollection-service/mediacollection.service';\r\nimport { MonitorService } from 'src/app/services/monitor-service/monitor.service';\r\nimport { ChqImagesUploaderComponent } from 'src/app/widgets/chq-images-uploader/chq-images-uploader.component';\r\n\r\nconst newDocumentHeader: ChqWidgetsHeaderModel = {\r\n  title: 'add_documents',\r\n  step: 3,\r\n  description: 'add_documents_msg',\r\n  stepName: 'step_three',\r\n};\r\n\r\n@Component({\r\n  selector: 'new-documents',\r\n  templateUrl: './new-documents.component.html',\r\n  styleUrls: [ './new-documents.component.scss' ]\r\n})\r\nexport class NewDocumentsComponent implements OnInit, AfterViewInit {\r\n  @Input() documentHeader: ChqWidgetsHeaderModel = newDocumentHeader;\r\n  public imageStatusSteps: UploadStepModel[] = [];\r\n  public allowExtension = [ 'jpg', 'jpeg', 'png' ];\r\n  @ViewChild('imageUploaders') imageUploaders:ChqImagesUploaderComponent;\r\n  public skipButtonModel: ChqWidgetsButtonModel = {\r\n    label: 'Skip',\r\n    type: 'primary'\r\n  }\r\n\r\n  public footer: FooterModel = {\r\n    text: 'Next add photos',\r\n    icon: 'review',\r\n    route: 'quote/case/photos',\r\n    currentStatus: '',\r\n    status: 'UploadDocuments',\r\n    caseId: ''\r\n  }\r\n\r\n  public documentSizeLimit = 5242880;\r\n  public mediaTemplate: any;\r\n  public mediaTemplateId: number;\r\n  public collectionGuid: string;\r\n  public domainId: number;\r\n  public noDocumentData = false;\r\n  private repairId:string = '';\r\n  private currentRepairStatus = '';\r\n  public objectId: number;\r\n  public mediaPartTemplates: any[];\r\n  public currentObservable:(currentStep:UploadStepModel)=>void;\r\n  public currentUploadingStep: UploadStepModel;\r\n  public showNoAccess: boolean = false;\r\n  private currentOrgId: number;\r\n\r\n  statusUpdated: boolean = false;\r\n \r\n  /**\r\n   * constructor\r\n   * @param fb ChangeDetectorRef \r\n   */\r\n  constructor(private cd: ChangeDetectorRef, private commonService: CommonService, private route: ActivatedRoute,\r\n    private caseService: CaseService,\r\n    private monitorService: MonitorService,\r\n    private bookingService:BookingService,\r\n    private mediaCollectionService: MediacollectionService) {\r\n    if (commonService.pageName.closed) {\r\n      commonService.pageName = new BehaviorSubject<string>(null);\r\n    }\r\n    commonService.pageName.next('document');\r\n\r\n    if(this.commonService.accessRight.closed) {\r\n      this.commonService.accessRight = new BehaviorSubject<boolean>(true);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ngAfterViewInit hook\r\n   * @param fb FormBuilder \r\n   */\r\n  ngAfterViewInit(): void {\r\n    this.commonService.updatePage('/quote/case/0', 'document');\r\n    this.cd.detectChanges();\r\n    this.monitorService.logEvent('ngAfterViewInit', [ 'ChqNewDocumentsComponent', 'addenda-quote' ]);\r\n  }\r\n\r\n  /**\r\n   * check route params\r\n   */\r\n  checkRouteParams():void {\r\n    this.route.queryParams?.subscribe((params)=>{\r\n      const codeParam = params['fromPersonal']  \r\n      if (codeParam === 'true' || codeParam === true){\r\n        this.imageStatusSteps = this.imageStatusSteps.filter((step:UploadStepModel)=>{\r\n          return step.stepName.indexOf('Vehicle Registration') != -1;\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * set current Observable\r\n   */\r\n  setObservable($event:UploadStepModel): void{\r\n    if ($event.uploadedGuid && $event.uploadedPartGuid) {\r\n      this.currentObservable = this.updateFile.bind(this);\r\n    } else {\r\n      this.currentObservable = this.uploadFile.bind(this);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * media template by id\r\n   */\r\n  getMediaTemplateByObject():void {\r\n    this.mediaPartTemplates = this.commonService.getAllChild(this.mediaTemplate?.mediaTemplates, 'mediaPartTemplates', 'mediaTemplateGuid',\r\n      { 'parentProp': 'name', 'childProp': 'parentName' });\r\n    for (let i = 0; i < this.mediaPartTemplates.length; i++){\r\n      const mediaPart = this.mediaPartTemplates[i];\r\n      const documentStep = documentPartMapper(mediaPart, i);\r\n      const isAdditionalImage = documentStep.stepName.toLowerCase().indexOf('additional document') != -1;\r\n      const isAdditionalDocumentFromReviewPageOnly = isAdditionalImage && !documentStep.url;\r\n      this.imageStatusSteps.push({\r\n        ...documentStep, mandatory: mediaPart.mandatory, index: i,\r\n        isAdditionalDocumentFromReviewPageOnly,\r\n        parentName: mediaPart.parentName,\r\n        isFront: mediaPart.frontSide,\r\n        updatedDate: mediaPart.mediaPartGuid != '00000000-0000-0000-0000-000000000000' ? mediaPart.updatedDate: '',\r\n        uploadedDate: mediaPart.mediaPartGuid != '00000000-0000-0000-0000-000000000000' ? mediaPart.createdDate: '',\r\n        domainId: this.domainId, objectId: this.objectId,\r\n        sizeLimit: mediaPart.sizeLimit, allowExtension: mediaPart.allowExtension,\r\n        uploadedPartGuid: mediaPart.mediaPartGuid != '00000000-0000-0000-0000-000000000000' ? mediaPart.mediaPartGuid : '',\r\n        uploadedGuid: mediaPart.mediaGuid != '00000000-0000-0000-0000-000000000000' ? mediaPart.mediaGuid:'',\r\n        partTemplateGuid: mediaPart.mediaPartTemplateGuid, templateGuid: mediaPart['mediaTemplateGuid']\r\n      });\r\n      this.checkRouteParams();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * update repair status\r\n   */\r\n  updateRepairStatus(repairId:string):void{\r\n    if(!this.statusUpdated) {      \r\n      this.statusUpdated = true;\r\n      this.bookingService.updateRepairStatus('UploadDocuments', repairId, '').subscribe({\r\n        next: ()=>{\r\n          this.currentRepairStatus = 'UploadDocuments';\r\n          this.footer.currentStatus = this.currentRepairStatus;\r\n          this.commonService.showLoading();\r\n          this.bookingService.getRepairDetailByGuid(this.repairId).subscribe({\r\n            next: async (result: any) => {\r\n              if (result?.data) {\r\n                this.commonService.repairDetails.next(result.data);\r\n                this.commonService.bookingId.next(result.data.repairNumber);                          \r\n                this.commonService.hideLoading();\r\n              }\r\n            },\r\n            error: (err: any) => {\r\n              this.monitorService.logException(err, SeverityLevel.Error);\r\n              this.commonService.hideLoading();\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * upload file\r\n   */\r\n  uploadFile(currentStep:UploadStepModel):void {\r\n\r\n    const obj = {\r\n      mediaCollectionId: this.mediaTemplate.collectionGuid,\r\n      domainId: this.domainId,\r\n      objectId: this.objectId,\r\n      mediaTemplateId: currentStep.templateGuid,\r\n      mediaPartTemplateId: currentStep.partTemplateGuid\r\n    }\r\n    this.monitorService.logEvent('uploadFile', [ 'ChqNewDocumentsComponent', 'addenda-quote', {\r\n      obj\r\n    } ]);\r\n    currentStep.uploadInProgress = true;\r\n    currentStep.isSkipped = false;\r\n    currentStep.isUploadFailed = false;\r\n    currentStep.isUploadSuccess = false;\r\n    const messageForUploading = `Your photo is currently uploading won’t be long and we’ll \r\n    notify you when its uploaded, you can continue to take your photos.`;\r\n    this.commonService.showNotification(messageForUploading);\r\n    this.mediaCollectionService.uploadDocument(currentStep.imageFile, obj).subscribe( {\r\n      next: (res: any):void => {\r\n        const responseData = res?.data;\r\n        const mediaPartTemplate = this.mediaPartTemplates?.find((x: any) => x.mediaPartTemplateGuid == responseData?.mediaPartTemplateId);\r\n        if(mediaPartTemplate) {              \r\n          mediaPartTemplate.mediaGuid = responseData.mediaGuid;\r\n          mediaPartTemplate.mediaPartGuid = responseData.mediaPartGuid;\r\n          if(location.href.includes('repair') && this.currentRepairStatus?.toLowerCase() === 'draft'){\r\n            this.updateRepairStatus(this.repairId);\r\n          }\r\n          if(location.href.includes('quote') && this.footer.currentStatus?.toLowerCase() === 'vehicledetails'){\r\n            this.updateStatus();\r\n          }\r\n          this.imageUploaders.updateUploadStatus('success', currentStep, null, responseData);\r\n        }\r\n      },\r\n      error: (err: any):void => {\r\n        if(err.status != 401) {\r\n          try{\r\n            this.imageUploaders.updateUploadStatus( 'failed', currentStep, err);\r\n          }catch(e){\r\n            this.imageUploaders.updateUploadStatus('failed', currentStep);\r\n          }\r\n        }\r\n        this.monitorService.logException(err, SeverityLevel.Error);\r\n      },\r\n      complete: ():void => this.commonService.hideLoading(),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * update existing document\r\n   */\r\n  updateFile(currentStep:UploadStepModel):void {\r\n    const obj = {\r\n      objectId: this.objectId,\r\n      mediaGuid: currentStep.uploadedGuid,\r\n      mediaPartGuid: currentStep.uploadedPartGuid\r\n    }\r\n\r\n    this.monitorService.logEvent('updateFile', [ 'ChqNewDocumentsComponent', 'addenda-quote', {\r\n      obj\r\n    } ]);\r\n\r\n    currentStep.uploadInProgress = true;\r\n    currentStep.isSkipped = false;\r\n    currentStep.isUploadFailed = false;\r\n    currentStep.isUploadSuccess = false;\r\n    this.mediaCollectionService.updateDocument(currentStep.imageFile, obj).subscribe({\r\n      next: (res: any): void => {\r\n        this.imageUploaders.updateUploadStatus('success', currentStep);\r\n      },\r\n      error: (err: any):void => {\r\n        if(err.status != 401) {\r\n          try{\r\n            this.imageUploaders.updateUploadStatus( 'failed', currentStep, err);\r\n          }catch(e){\r\n            this.imageUploaders.updateUploadStatus('failed', currentStep);\r\n          }\r\n        }\r\n        this.monitorService.logException(err, SeverityLevel.Error);\r\n      },\r\n      complete: ():void =>this.commonService.hideLoading(),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * update status\r\n   */\r\n  updateStatus():void{\r\n    if(!this.statusUpdated) {  \r\n      this.statusUpdated = true;\r\n      this.monitorService.logEvent('updateStatus', [ 'ChqNewDocumentsComponent', 'addenda-quote', {\r\n        caseId: this.footer.caseId\r\n      } ]);\r\n      this.caseService.updateCaseStatus(this.footer.caseId, 'UploadDocuments').subscribe({\r\n        next: ()=>{\r\n          this.footer = { ...this.footer, status: '' };\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * map media template Data\r\n   * @param mediaData \r\n   */\r\n  mapMediaTemplate(mediaData: any):void {\r\n    if(this.mediaTemplate) {\r\n      try {\r\n        for(let i=0;i<this.mediaTemplate.mediaTemplates.length;i++) {\r\n          const media = this.mediaTemplate.mediaTemplates[i];\r\n          const mediaDataTemplate = mediaData.find((x:any)=> x.mediaTemplateGuid == media.mediaTemplateGuid);\r\n          if(mediaDataTemplate) {\r\n            for(let j=0;j<media.mediaPartTemplates.length;j++) {\r\n              const mediaPart = media.mediaPartTemplates[j];\r\n              const mediaDataPart = mediaDataTemplate.mediaParts.find((x: any)=> x.mediaPartTemplateGuid == mediaPart.mediaPartTemplateGuid);\r\n              mediaPart.mediaGuid = mediaDataTemplate.mediaGuid;\r\n              mediaPart.mediaPartGuid = mediaDataPart.mediaPartGuid;\r\n              mediaPart.createdDate = mediaDataPart.createdDate;\r\n              mediaPart.updatedDate = mediaDataPart.updatedDate;\r\n              mediaPart.image = mediaDataPart.getURL;\r\n              mediaPart.isUploadSuccess = false;\r\n              if(mediaPart.mediaPartGuid && mediaPart.mediaPartGuid != '00000000-0000-0000-0000-000000000000') {\r\n                mediaPart.isUploadSuccess = true;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        this.mediaTemplate = { ...this.mediaTemplate };\r\n        \r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ngOnInit hook\r\n   */\r\n  ngOnInit(): void {\r\n    this.commonService.showLoading();\r\n    const id = this.route.parent?.snapshot.paramMap.get('id');\r\n    this.monitorService.logEvent('ngOnInit', [ 'ChqNewDocumentsComponent', 'addenda-quote', {\r\n      caseId: id\r\n    } ]);\r\n    this.footer = { ...this.footer, route: `quote/case/${id}/photos`, caseId: id };\r\n\r\n    this.commonService.accessRight.subscribe({\r\n      next: (res: boolean) => {\r\n        if (!res) {\r\n          this.showNoAccess = true;\r\n        } \r\n      }\r\n    });\r\n    const promiseApi:any = {\r\n      mediaTemplate: this.mediaCollectionService.getMediaTemplate()\r\n    }\r\n    let isRepair = false;\r\n    if(location.href.includes('repair')){\r\n      promiseApi.bookingDetail = this.bookingService.getRepairDetailByGuid(id);\r\n      isRepair = true;\r\n    }else{\r\n      this.commonService.userProfileData.subscribe((res) => {\r\n        if (res && res.data) {\r\n          const { organizationDetail } = res.data;\r\n          this.currentOrgId = organizationDetail.id;\r\n        }\r\n      });\r\n      promiseApi.caseDetail = this.caseService.getCaseDetail(id);\r\n    }\r\n\r\n    const result = forkJoin(promiseApi).pipe(\r\n      catchError(error => of(error))\r\n    )\r\n    result.subscribe((dict: any) => {\r\n      if (dict) {\r\n        const mediaTemplate = dict.mediaTemplate;\r\n        if (mediaTemplate) {\r\n          const mediaTemplateSelected = mediaTemplate.data;\r\n          if (dict.caseDetail) {\r\n            const { caseNumber, id, status, inspections, repairGuid, organizationDetail } = dict.caseDetail.data;\r\n\r\n            if (this.currentOrgId != organizationDetail?.organizationId) {\r\n              this.commonService.isViewOnly = true;\r\n            } else {\r\n              this.commonService.isViewOnly = false;\r\n            }\r\n\r\n            if (inspections.length > 0) {\r\n              this.commonService.inspectionId.next(inspections[0].inspectionId);\r\n            }\r\n            this.commonService.caseStatus.next(status);\r\n            if (status.toLowerCase() === 'vehicledetails') {\r\n            //   this.updateStatus();\r\n            }else{\r\n              this.footer = { ...this.footer, status: '' };\r\n            }\r\n            this.footer.currentStatus = status;\r\n            this.documentHeader.caseNumber = caseNumber;\r\n            this.objectId = id;\r\n            if (repairGuid) {\r\n              this.footer.repairId = repairGuid;\r\n              this.footer.from = 'Quote';\r\n            }\r\n          }\r\n          if(dict.bookingDetail){\r\n            const { id, status, repairGuid, quoteId, repairNumber, isRepairCreatedFromCase, booking } = dict.bookingDetail.data;\r\n            this.objectId = id;\r\n            this.repairId = repairGuid;\r\n\r\n            //adding \r\n            if(quoteId) {\r\n              this.footer.caseId = quoteId;\r\n              this.footer.from = 'Repair';\r\n            }\r\n\r\n            this.footer.isRepairCreatedFromCase = isRepairCreatedFromCase;\r\n            this.footer.repairId = repairGuid;\r\n            this.footer.bookingId = booking?.bookingGuid;\r\n            this.footer.currentStatus = status;\r\n\r\n            this.commonService.repairStatus.next(status);\r\n            //\r\n            \r\n            this.currentRepairStatus = status;\r\n            // Send booking data in observable\r\n            this.commonService.repairDetails.next(dict.bookingDetail.data);\r\n            this.commonService.bookingId.next(repairNumber);\r\n          }\r\n          if (mediaTemplateSelected.length > 0) {\r\n            const { id, collectionGuid } = mediaTemplateSelected[0];\r\n            this.mediaTemplateId = id;\r\n            this.domainId = 2100;\r\n            if(isRepair){\r\n              this.domainId = 3100;\r\n            }\r\n            this.collectionGuid = collectionGuid;\r\n            const detailResult = forkJoin({\r\n              mediaTemplateDetail: this.mediaCollectionService.getMediaTemplateById(collectionGuid),\r\n              mediaDetail: this.mediaCollectionService.getMediaDocumentData(id, this.objectId, this.domainId)\r\n            }).pipe(\r\n              catchError(error => of(error))\r\n            )\r\n            detailResult.subscribe((detailDict: any) => {\r\n              if (detailDict) {\r\n                const { mediaTemplateDetail, mediaDetail } = detailDict;\r\n                this.mediaTemplate = mediaTemplateDetail.data;\r\n                this.mediaTemplate.mediaTemplates = mediaTemplateDetail.data.mediaTemplates.sort((media: any, mediab: any) => {\r\n                  return media.orderNumber - mediab.orderNumber;\r\n                })\r\n                if (mediaDetail.data) {\r\n                  this.mapMediaTemplate(mediaDetail.data.medias);\r\n                }\r\n                this.getMediaTemplateByObject();\r\n              }\r\n              this.commonService.hideLoading();\r\n            }, (err) => {\r\n              this.commonService.hideLoading();\r\n              this.monitorService.logException(err, SeverityLevel.Error);\r\n            });\r\n           \r\n          } else {\r\n            this.commonService.hideLoading();\r\n          }\r\n        }else {\r\n          this.noDocumentData = true;\r\n          this.commonService.hideLoading();\r\n        }\r\n        \r\n      } else {\r\n        this.noDocumentData = true;\r\n        this.commonService.hideLoading();\r\n      }\r\n    });\r\n    const container: any = document.querySelector('.addenda-container');\r\n    if(container){\r\n      container.scrollTop = 0;\r\n    }\r\n    \r\n  }\r\n\r\n  /**\r\n   * handled if step is skipped\r\n   */\r\n  stepSkipped(): void {\r\n    if(location.href.includes('repair') && this.currentRepairStatus?.toLowerCase() === 'draft'){\r\n      this.updateRepairStatus(this.repairId);\r\n    }\r\n    if(location.href.includes('quote') && this.footer.currentStatus?.toLowerCase() === 'vehicledetails'){\r\n      this.updateStatus();\r\n    }\r\n  }\r\n \r\n  /**\r\n   * on destroy\r\n  */\r\n  ngOnDestroy(): void {\r\n    this.monitorService.logEvent('ngOnDestroy', [ 'ChqNewDocumentComponent', 'addenda-quote' ]);\r\n    this.commonService.accessRight.unsubscribe();\r\n\r\n    if(location.href.includes('quote')){\r\n      this.commonService.isViewOnly = false;\r\n    }\r\n  }\r\n}\r\n","<div *ngIf=\"!showNoAccess\">\r\n    <chq-images-uploader #imageUploaders *ngIf=\"imageStatusSteps && imageStatusSteps.length > 0\"\r\n        [fileUploaderService]=\"currentObservable\" (cardSelection)=\"setObservable($event)\" [footerOptions]=\"footer\"\r\n        [imageStatusSteps]=\"imageStatusSteps\" [header]=\"documentHeader\" (stepSkipped)=\"stepSkipped()\"></chq-images-uploader>\r\n    <div class=\"wrapper\" *ngIf=\"noDocumentData\">\r\n        <div class=\"no-document-div\">\r\n            <img src=\"assets/icons/no-document.svg\">\r\n            <label class=\"no-vehicle-content\">\r\n                No Content Available\r\n            </label>\r\n\r\n        </div>\r\n        <div class=\"empty-wrapper\">\r\n            <div class=\"step-container\"></div>\r\n            <div class=\"step-container\"></div>\r\n            <div class=\"step-container\"></div>\r\n            <div class=\"step-container\"></div>\r\n        </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"noDocumentData\" class=\"footer-full-wrapper\">\r\n        <div class=\"footer-image-wrapper\">\r\n            <div class=\"image-wrapper\">\r\n                <img src=\"assets/img/{{ + documentHeader.isRepairModule ?'addenda-repair.png':'addenda-quote.png'}}\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<no-access-error *ngIf=\"showNoAccess\"></no-access-error>","import { AfterViewInit, ChangeDetectorRef, Component, EventEmitter, Input, OnDestroy, OnInit, Output, ViewChild } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { SeverityLevel } from '@microsoft/applicationinsights-web';\r\nimport { BehaviorSubject, catchError, forkJoin, of, Subject } from 'rxjs';\r\nimport { PartialCaseDetail } from 'src/app/model/chq-cases-model';\r\nimport { ChqInspectionStep } from 'src/app/model/chq-inspection-step';\r\nimport { FooterModel, Modules, UploadStepModel } from 'src/app/model/chq-upload-model';\r\nimport { ChqWidgetsHeaderModel } from 'src/app/model/chq-widgets-header-model';\r\nimport { inspectionpartPartMapper } from 'src/app/modules/quote/chq-new-cases/chq-new-customer/chq-new-customer-form-data-helper';\r\nimport { BookingService } from 'src/app/services/booking/booking.service';\r\nimport { CaseService } from 'src/app/services/case/case.service';\r\nimport { CommonService } from 'src/app/services/common/common.service';\r\nimport { InspectionService } from 'src/app/services/inspection-service/inspection.service';\r\nimport { MonitorService } from 'src/app/services/monitor-service/monitor.service';\r\nimport { RepairEstimateService } from 'src/app/services/repair-estimate/repair-estimate.service';\r\nimport { ChqImagesUploaderComponent } from 'src/app/widgets/chq-images-uploader/chq-images-uploader.component';\r\n\r\n\r\nconst photosHeader: ChqWidgetsHeaderModel = {\r\n  title: 'add_damage_photos',\r\n  step: 4,\r\n  description: 'damage_photos_msg',\r\n  stepName: 'step_four',\r\n};\r\n\r\n@Component({\r\n  selector: 'new-photos',\r\n  templateUrl: './new-photos.component.html',\r\n  styleUrls: [ './new-photos.component.scss' ]\r\n})\r\nexport class NewPhotosComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  @Input() photosHeader: ChqWidgetsHeaderModel = photosHeader;\r\n  @Output() currentUploadMode: EventEmitter<{ 'mode': string, 'id'?: string }> = new EventEmitter();\r\n  addPhotosHeader: ChqWidgetsHeaderModel;\r\n  public imageStatusSteps: UploadStepModel[] = [];\r\n  public showUploading: boolean = false;\r\n  public isMultipleUpload: boolean = false;\r\n  public triggerMassUpload: boolean = false;\r\n  public caseStatus = '';\r\n  public caseId: string = '0';\r\n  public inspection: any;\r\n  public bookingId: string = '';\r\n  public vehicleId: number;\r\n  public domainId: number;\r\n  public uploadType: string;\r\n  public showDamageAnalysis: boolean;\r\n  public objectId: number;\r\n  public minimumPhotosRequired: number = 0;\r\n  public hideContent: boolean = true;\r\n  public currentAdditionalModeMultiple = false;\r\n  public vehicelType: string;\r\n  public isBulkUploaded: boolean;\r\n  public caseData: any;\r\n  public inspectionId: number;\r\n  private currentInspectionTemplate: any;\r\n  public hideUploaders = false;\r\n  private repairTypes: any = [];\r\n  private repairType = '';\r\n  public noImagesData:boolean = false;\r\n  private repairId: string = '';\r\n  public inspectionTemplatesJSONString = '';\r\n  private currentRepairStatus = '';\r\n  public partialCaseDetail: PartialCaseDetail;\r\n  public repairDetail: any;\r\n  @ViewChild('imageUploaders') imageUploaders: ChqImagesUploaderComponent;\r\n  public inspectionTemplateId: number;\r\n  public currentObservable: (currentStep: UploadStepModel) => void;\r\n  public inspectionTemplates: ChqInspectionStep[];\r\n  public inspectionItemTemplates: ChqInspectionStep[];\r\n  public inspectionTemplateList: any[];\r\n  public inspectionDetail: any;\r\n  public originalSteps: UploadStepModel[] = [];\r\n  public showNoAccess: boolean = false;\r\n  public footer: FooterModel = {\r\n    text: 'Next create estimate',\r\n    icon: 'boardview',\r\n    route: 'case/gt',\r\n    status: 'UploadPhotos',\r\n    caseId: '',\r\n    currentStatus: '',\r\n    showButton: true,\r\n    showUploadOption: true\r\n  }\r\n\r\n  statusUpdated: boolean = false;\r\n  private currentOrgId: number;\r\n\r\n  /**\r\n   * handle back\r\n   */\r\n  handleBack($event: { back: boolean }): void {\r\n    this.showDamageAnalysis = !$event.back;\r\n  }\r\n\r\n  /**\r\n   * check repair types\r\n   */\r\n  get checkRepairTypes(): boolean {\r\n    if (location.href.indexOf('repair') === -1) {\r\n      return true;\r\n    }\r\n\r\n    if (this.repairType !== 'repair') {\r\n      return true;\r\n    }\r\n\r\n    return this.repairTypes.filter((v) => {\r\n      return v.repairServiceType === 'Body' || v.repairServiceType === 'Paint';\r\n    }).length > 0;\r\n  }\r\n\r\n  /**\r\n   * go to gtEstimate\r\n   */\r\n  redirectToGtEstimate(): void {\r\n    this.commonService.showLoading();\r\n    if (this.caseStatus?.toLowerCase() === 'uploaddocuments' || this.caseStatus?.toLowerCase() === 'uploadphotos') {\r\n      this.estimateService.createEstimate(this.caseId, this.inspectionId, this.vehicleId, this.domainId).subscribe({\r\n        next: (resp: any) => {\r\n          if (resp) {\r\n            if (resp?.data?.url) {\r\n              location.href = resp.data.url;\r\n              sessionStorage.setItem('update', '1');\r\n            }\r\n          }\r\n        },\r\n        complete: () => {\r\n          this.commonService.hideLoading();\r\n        }\r\n      });\r\n    } else {\r\n      this.router.navigate([ `/quote/case/${this.caseId}/estimate` ]);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * constructor\r\n   * @param fb ChangeDetectorRef \r\n   */\r\n  constructor(private cd: ChangeDetectorRef, private commonService: CommonService,\r\n    private route: ActivatedRoute,\r\n    private router: Router, private caseService: CaseService,\r\n    private monitorService: MonitorService,\r\n    private inspectionService: InspectionService,\r\n    private bookingService: BookingService,\r\n    private estimateService: RepairEstimateService) {\r\n    if (commonService.pageName.closed) {\r\n      commonService.pageName = new BehaviorSubject<string>(null);\r\n    }\r\n    commonService.pageName.next('photos');\r\n\r\n    if (this.commonService.accessRight.closed) {\r\n      this.commonService.accessRight = new BehaviorSubject<boolean>(true);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * update page status\r\n   */\r\n  updateCurrentStatus($event): void {\r\n    this.monitorService.logEvent('updateCurrentStatus', [ 'ChqNewPhotosComponent', 'addenda-quote', {\r\n      caseId: $event\r\n    } ]);\r\n    if ($event.initial) {\r\n      this.setInitialMode();\r\n      return;\r\n    }\r\n    this.showUploading = true;\r\n\r\n    // if ((this.footer.repairId && this.footer.from == Modules.quote)\r\n    // || (this.footer.caseId && this.footer.from == Modules.repair)) {\r\n\r\n    //   this.commonService.showChangeWarningMessage(this.uploadBulkUploadFile.bind(this, $event.steps),\r\n    //     this.footer.from == Modules.quote ? 'Repair' : 'Quote');\r\n    // } else {\r\n    //   this.uploadBulkUploadFile($event.steps);\r\n    // }\r\n    this.uploadBulkUploadFile($event.steps);\r\n  }\r\n\r\n  /**\r\n   * handle delete all\r\n   */\r\n  handleDeleteAll(): void {\r\n    this.setInitialMode();\r\n  }\r\n\r\n  /**\r\n   * ngAfterViewInit hook\r\n   */\r\n  ngAfterViewInit(): void {\r\n    this.commonService.updatePage('/quote/case/0', 'photos');\r\n    this.cd.detectChanges();\r\n    this.monitorService.logEvent('ngAfterViewInit', [ 'ChqNewPhotosComponent', 'addenda-quote' ]);\r\n  }\r\n\r\n  /**\r\n * upload bulk file\r\n * @param uploads \r\n */\r\n  uploadBulkUploadFile(uploads: UploadStepModel[]): void {\r\n    for (let i = 0; i < uploads?.length; i++) {\r\n\r\n      const img = new Image();\r\n      img.src = uploads[i].image as string;\r\n      img.onload = (): void => {\r\n        const uploadObject = {\r\n          'height': img.height,\r\n          'width': img.width,\r\n          'inspectionId': this.inspectionId,\r\n          'templateId': this.inspectionTemplateId,\r\n          'type': this.vehicelType || '',\r\n          'isBulk': true\r\n        }\r\n        const step = uploads[i];\r\n        step.uploadInProgress = true;\r\n        step.isSkipped = false;\r\n        step.isUploadFailed = false;\r\n        step.isUploadSuccess = false;\r\n        this.monitorService.logEvent('uploadBulkUploadFile', [ 'ChqNewPhotosComponent', 'addenda-quote', {\r\n          uploadObject\r\n        } ]);\r\n        this.inspectionService.uploadImageBulk(uploadObject, step.imageFile).subscribe({\r\n          next: (data: any) => {\r\n            step.url = data.rawImage?.rawAzureBlobUrl;\r\n            step.inspectionItem = data;\r\n            step.procedureSteps = 'Bulk Upload Image';\r\n            this.imageUploaders.updateUploadStatus('success', step, null, data);\r\n            this.footer = { ...this.footer, showUploadOption: false };\r\n            if (location.href.includes('repair') && (this.currentRepairStatus?.toLowerCase() === 'draft' || this.currentRepairStatus?.toLowerCase() === 'uploaddocuments')) {\r\n              this.updateRepairStatus(this.repairId);\r\n            }\r\n            if (location.href.includes('quote') && (this.footer.currentStatus?.toLowerCase() === 'uploaddocuments')) {\r\n              this.updateStatus();\r\n            }\r\n          },\r\n          error: (err: any) => {\r\n            if (err.status != 401) {\r\n              this.imageUploaders.imageStatusSteps = this.imageUploaders.imageStatusSteps.filter((ig: UploadStepModel) => {\r\n                return (ig.index !== step.index || ig.stepName !== step.stepName || ig.uploadInProgress !== true);\r\n              })\r\n              this.imageUploaders.updateUploadStatus('failed', step, err, null, true);\r\n            }\r\n            this.monitorService.logException(err, SeverityLevel.Error);\r\n          },\r\n        })\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * update repair status\r\n   */\r\n  updateRepairStatus(repairId: string): void {\r\n    if(!this.statusUpdated) {  \r\n      this.statusUpdated = true;\r\n      this.bookingService.updateRepairStatus('UploadPhotos', repairId, '').subscribe({\r\n        next: () => {\r\n          this.currentRepairStatus = 'UploadPhotos';\r\n          this.footer.currentStatus = this.currentRepairStatus;\r\n          this.commonService.showLoading();\r\n          this.bookingService.getRepairDetailByGuid(this.repairId).subscribe({\r\n            next: async (result: any) => {\r\n              if (result?.data) {\r\n                this.commonService.repairDetails.next(result.data);\r\n                this.commonService.bookingId.next(result.data.repairNumber);                          \r\n                this.commonService.hideLoading();\r\n              }\r\n            },\r\n            error: (err: any) => {\r\n              this.monitorService.logException(err, SeverityLevel.Error);\r\n              this.commonService.hideLoading();\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n    \r\n  }\r\n\r\n  /**\r\n   * upload photos\r\n   */\r\n  uploadFile(currentStep: UploadStepModel): void {\r\n    const uploadObject = {\r\n      'height': currentStep.imageHeight,\r\n      'width': currentStep.imageWidth,\r\n      'inspectionId': this.inspectionId,\r\n      'templateId': this.inspectionTemplateId,\r\n      'inspectionitemId': currentStep.inspectionItem.id,\r\n      'type': this.vehicelType || '',\r\n      'isBulk': false\r\n    }\r\n\r\n    this.monitorService.logEvent('uploadFile', [ 'ChqNewPhotosComponent', 'addenda-quote', {\r\n      uploadObject\r\n    } ]);\r\n\r\n    currentStep.uploadInProgress = true;\r\n    currentStep.isSkipped = false;\r\n    currentStep.isUploadFailed = false;\r\n    currentStep.isUploadSuccess = false;\r\n    this.commonService.inProgressSteps.next(1);\r\n    this.footer = { ...this.footer, showUploadOption: false };\r\n    this.commonService.showNotification(`Your photo ‘${currentStep.stepName}’ is currently uploading won’t be long and we’ll notify \r\n       you when its uploaded, you can continue to take your photos.`);\r\n    this.inspectionService.uploadImageBulk(uploadObject, currentStep.imageFile).subscribe({\r\n      next: (data: any) => {\r\n        const msg = `Your photo ‘${currentStep.stepName}’ is uploaded successfully.`;\r\n        this.commonService.showNotification(msg);\r\n        const inspectionItem = this.inspectionItemTemplates?.find((x: any) => x.inspectionItem.id == data?.id);\r\n        inspectionItem.inspectionItem.rawAzureBlobUrl = data.rawImage?.rawAzureBlobUrl;\r\n        if (inspectionItem) {\r\n          currentStep.url = data.rawImage?.rawAzureBlobUrl;\r\n          this.imageUploaders.updateUploadStatus('success', currentStep, null, data);\r\n        }\r\n        if (location.href.includes('repair') && (this.currentRepairStatus == 'Draft' || this.currentRepairStatus === 'UploadDocuments')) {\r\n          this.updateRepairStatus(this.repairId);\r\n        }\r\n        if (location.href.includes('quote') && (this.footer.currentStatus?.toLowerCase() === 'uploaddocuments')) {\r\n          this.updateStatus();\r\n        }\r\n      },\r\n      error: (err: any) => {\r\n        if (err.status != 401) {\r\n          const msg = `Your photo ‘${currentStep.stepName}’ failed to upload. Please try to upload again.`;\r\n          this.commonService.showNotification(msg);\r\n          this.imageUploaders.updateUploadStatus('failed', currentStep, err);\r\n          this.monitorService.logException(err, SeverityLevel.Error);\r\n        }\r\n      },\r\n    })\r\n  }\r\n\r\n  /**\r\n   * on destroy\r\n   */\r\n  ngOnDestroy(): void {\r\n    this.commonService.pageName.unsubscribe();\r\n    this.commonService.accessRight.unsubscribe();\r\n    if(location.href.includes('quote')){\r\n      this.commonService.isViewOnly = false;\r\n    }\r\n    this.monitorService.logEvent('ngOnDestroy', [ 'ChqNewPhotosComponent', 'addenda-quote' ]);\r\n  }\r\n\r\n  /**\r\n   * showRepairButton\r\n   */\r\n  get showEstimateButton(): boolean {\r\n    return this.currentInspectionTemplate?.minImageLimit === 0 && this.inspectionItemTemplates?.filter((value: ChqInspectionStep) => {\r\n      return value.isSkipEnabled !== true;\r\n    }).length === 0;\r\n  }\r\n\r\n  /**\r\n   * map inspection from api\r\n   * @param inspectionData \r\n   */\r\n  mapInspection(inspectionData: any): void {\r\n    if (inspectionData) {\r\n      try {\r\n        this.inspection = inspectionData;\r\n        this.uploadType = this.inspection.uploadType;\r\n        let currentMode = 'SPI';\r\n        if (this.uploadType) {\r\n          this.footer = { ...this.footer, showUploadOption: false };\r\n        }\r\n        if (this.uploadType === 'Bulk') {\r\n          currentMode = 'BULK';\r\n        }\r\n        const bulkUploadTemplateItem = this.inspectionTemplates?.filter(step => step.name === 'Bulk Upload Image');\r\n        const bulkUploadedItemsWithImages = this.inspection.inspectionItems?.filter((step) => {\r\n          return (step.name === 'Bulk Upload Image' || step.inspectionItemTemplateID === bulkUploadTemplateItem[0].id)\r\n              && step.rawAzureBlobUrl\r\n        });\r\n        if (bulkUploadedItemsWithImages?.length > 0 || this.uploadType === 'Bulk') {\r\n          const massUploadItems = [];\r\n          this.currentUploadMode.emit({ 'mode': 'multiple' });\r\n          for (const i in bulkUploadedItemsWithImages) {\r\n            const currentObj = {\r\n              ...bulkUploadTemplateItem[0], name: bulkUploadedItemsWithImages[i].name || bulkUploadTemplateItem[0].name,\r\n              inspectionItem: bulkUploadedItemsWithImages[i]\r\n            }\r\n            massUploadItems.push(currentObj);\r\n          }\r\n          this.inspectionItemTemplates = massUploadItems;\r\n        } else {\r\n\r\n          this.currentUploadMode.emit({ 'mode': 'single' });\r\n          this.inspectionTemplates?.map((chqInspectionStep: ChqInspectionStep) => {\r\n            const item = this.inspection.inspectionItems?.find((el: any) => el.inspectionItemTemplateID == chqInspectionStep.id);\r\n            if (item) {\r\n              chqInspectionStep['inspectionItem'] = item;\r\n            }\r\n          });\r\n          this.inspectionItemTemplates = this.inspectionTemplates?.filter(step => step.name != 'Bulk Upload Image');\r\n        }\r\n        if(bulkUploadTemplateItem?.length > 0) this.inspectionTemplateId = bulkUploadTemplateItem[0].id;\r\n\r\n        this.inspectionItemTemplates?.map((x: ChqInspectionStep) => {\r\n          if (x.inspectionItem?.rawAzureBlobUrl) {\r\n            x.isUploadSuccess = true;\r\n            x.image = x.inspectionItem?.rawAzureBlobUrl;\r\n          } else {\r\n            if (!x.inspectionItem) {\r\n              x.inspectionItem = { rawAzureBlobUrl: '' };\r\n            }\r\n            x.inspectionItem.rawAzureBlobUrl = '';\r\n            x.isUploadFailed = false;\r\n            x.isUploadSuccess = false;\r\n            x.uploadInProgress = false;\r\n          }\r\n        })\r\n        if (this.uploadType) {\r\n          if (currentMode === 'SPI') {\r\n            this.isMultipleUpload = false;\r\n            this.showUploading = true;\r\n            if (this.addPhotosHeader.isRepairModule) {\r\n              this.photosHeader = { ...this.photosHeader, title: 'back_smart_photo' };\r\n            }\r\n            this.minimumPhotosRequired = this.inspectionItemTemplates?.filter((value: ChqInspectionStep) => {\r\n              return value.isSkipEnabled !== true;\r\n            }).length;\r\n            this.currentObservable = this.uploadFile.bind(this);\r\n          } else {\r\n            this.currentObservable = this.uploadBulkUploadFile.bind(this);\r\n            this.isMultipleUpload = true;\r\n            this.minimumPhotosRequired = this.currentInspectionTemplate.minImageLimit;\r\n            this.triggerMassUpload = true;\r\n            this.isBulkUploaded = true;\r\n            if (this.addPhotosHeader.isRepairModule) {\r\n              this.photosHeader = { ...this.photosHeader, title: 'bulk_upload' };\r\n            }\r\n          }\r\n        }\r\n      } catch (error: any) {\r\n        console.log(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * inspection detail by id\r\n   */\r\n  getInspectionTemplateByObject(): void {\r\n    for (let i = 0; i < this.inspectionItemTemplates?.length; i++) {\r\n      const templatePart = this.inspectionItemTemplates[i];\r\n      const inspectionStep = inspectionpartPartMapper(templatePart, i);\r\n      const isAdditionalImage = inspectionStep.stepName?.toLowerCase().indexOf('additional photo') != -1;\r\n      const isMassUpload = inspectionStep.stepName?.toLowerCase().indexOf('bulk upload image') != -1;\r\n      const isAdditionalDocumentFromReviewPageOnly = isAdditionalImage && !inspectionStep.url;\r\n      this.imageStatusSteps.push({\r\n        ...inspectionStep, mandatory: !templatePart.isSkipEnabled, index: i,\r\n        isAdditionalDocumentFromReviewPageOnly,\r\n        isMassUpload,\r\n        updatedDate: inspectionStep.url ? templatePart?.inspectionItem?.updatedDate : '',\r\n        uploadedDate: inspectionStep.url ? templatePart?.inspectionItem?.created : '',\r\n        domainId: this.domainId, objectId: this.objectId,\r\n        uploadedPartGuid: '',\r\n        uploadedGuid: ''\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * update status\r\n   */\r\n  updateStatus(): void {\r\n    if(!this.statusUpdated) {  \r\n      this.statusUpdated = true;\r\n      this.monitorService.logEvent('updateStatus', [ 'ChqNewPhotosComponent', 'addenda-quote' ]);\r\n      this.caseService.updateCaseStatus(this.caseId, 'UploadPhotos').subscribe({\r\n        next: () => {\r\n          this.footer = { ...this.footer, status: '' };\r\n          this.partialCaseDetail.status = 'UploadPhotos';\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * handled if step is skipped\r\n   */\r\n  stepSkipped(): void {\r\n    if (location.href.includes('repair') && (this.currentRepairStatus?.toLowerCase() === 'draft' || this.currentRepairStatus?.toLowerCase() === 'uploaddocuments')) {\r\n      this.updateRepairStatus(this.repairId);\r\n    }\r\n    if (location.href.includes('quote') && (this.footer.currentStatus?.toLowerCase() === 'uploaddocuments')) {\r\n      this.updateStatus();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * load server details\r\n   */\r\n  loadApiData(id: string): void {\r\n    if (id && id != '0') {\r\n      this.caseId = id;\r\n      this.bookingId = id;\r\n      this.commonService.showLoading();\r\n      this.inspectionService.getInspectionTemplateList().subscribe({\r\n        next: (inspectionList: any) => {\r\n          let isRepair = false;\r\n          let inspectionTemplateId = 0;\r\n          if (location.href.includes('repair')) {\r\n            isRepair = true;\r\n          }\r\n          const repairInspectionTemplate = inspectionList?.data;\r\n\r\n          if (repairInspectionTemplate?.length > 0) {\r\n            this.commonService.repairInspectionTemplate = repairInspectionTemplate[0];\r\n            inspectionTemplateId = repairInspectionTemplate[0].id\r\n          }\r\n          const promiseApi: any = {};\r\n          promiseApi.inspectionTemplate = this.inspectionService.getInspectionTemplate(inspectionTemplateId);\r\n          if (isRepair) {\r\n            promiseApi.bookingDetail = this.bookingService.getRepairDetailByGuid(id);\r\n\r\n          } else {\r\n            this.commonService.userProfileData.subscribe((res) => {\r\n              if (res && res.data) {\r\n                const { organizationDetail } = res.data;\r\n                this.currentOrgId = organizationDetail.id;\r\n              }\r\n            });\r\n            promiseApi.caseDetail = this.caseService.getCaseDetail(id);\r\n          }\r\n          const serverDetails = forkJoin(promiseApi).pipe(\r\n            catchError(error => of(error))\r\n          )\r\n          serverDetails.subscribe({\r\n            next: (resultMap: any) => {\r\n              if (resultMap.inspectionTemplate) {\r\n\r\n                const inspectionTemplateDetail = resultMap.inspectionTemplate.inspectionItemTemplates;\r\n                this.currentInspectionTemplate = resultMap.inspectionTemplate;\r\n                if (resultMap.inspectionDetail) {\r\n                  this.inspectionDetail = resultMap.inspectionDetail;\r\n                }\r\n                this.inspectionTemplates = inspectionTemplateDetail;\r\n                this.inspectionTemplatesJSONString = JSON.stringify(this.inspectionTemplates);\r\n                if (resultMap.caseDetail) {\r\n                  const { caseNumber, id, status, statusId, domainID, inspections, vehicleModel, vehicleId, organizationDetail } = resultMap.caseDetail.data;\r\n                  this.caseData = resultMap.caseDetail.data;\r\n                  this.partialCaseDetail = resultMap.caseDetail.data;\r\n\r\n                  if (this.currentOrgId != organizationDetail?.organizationId) {\r\n                    this.commonService.isViewOnly = true;\r\n                  } else {\r\n                    this.commonService.isViewOnly = false;\r\n                  }\r\n\r\n                  this.vehicelType = vehicleModel;\r\n                  this.vehicleId = vehicleId;\r\n                  this.domainId = domainID;\r\n                  this.commonService.caseStatus.next(status);\r\n                  this.caseStatus = status;\r\n                  if (status?.toLowerCase() === 'uploaddocuments') {\r\n                    //this.updateStatus();\r\n                  } else {\r\n                    this.footer = { ...this.footer, status: '', caseId: id }\r\n                  }\r\n                  this.footer.currentStatus = status;\r\n                  if (inspections?.length > 0) {\r\n                    this.inspectionId = inspections[0].inspectionId;\r\n                    this.commonService.inspectionId.next(this.inspectionId);\r\n                  }\r\n                  this.photosHeader.caseNumber = caseNumber;\r\n\r\n                  if (this.caseData.repairGuid) {\r\n                    this.footer.repairId = this.caseData.repairGuid;\r\n                    this.footer.from = Modules.quote;\r\n                  }\r\n\r\n                  this.objectId = id;\r\n                }\r\n                if (resultMap.bookingDetail) {\r\n                  const { id, vehicle, repairServiceTypes, repairGuid, domainId, status, quoteId, repairType, repairNumber, booking, isRepairCreatedFromCase } = resultMap.bookingDetail.data;\r\n                  this.repairDetail = resultMap.bookingDetail.data;\r\n                  const { vehicleModel, vehicleId } = vehicle;\r\n\r\n                  this.objectId = id;\r\n                  this.domainId = domainId;\r\n                  this.repairId = repairGuid;\r\n                  this.currentRepairStatus = status;\r\n                  this.repairTypes = repairServiceTypes;\r\n                  this.repairType = repairType;\r\n                  this.inspectionId = vehicle.inspectionId;\r\n                  this.vehicelType = vehicleModel;\r\n                  this.vehicleId = vehicleId;\r\n\r\n                  this.footer = { ...this.footer, currentStatus: status, isRepairModule: true, caseId: quoteId, \r\n                    from: Modules.repair, repairTypes: repairServiceTypes, isRepairCreatedFromCase: isRepairCreatedFromCase, bookingId: booking?.bookingGuid };\r\n                  // Send booking data in observable\r\n                  this.commonService.repairDetails.next(resultMap.bookingDetail.data)\r\n                  this.commonService.bookingId.next(repairNumber);\r\n                  this.commonService.repairStatus.next(status);\r\n                }\r\n\r\n                if (this.inspectionId) {\r\n                  this.inspectionService.getInspection(this.inspectionId).subscribe({\r\n                    next: (inspectionDetailResponse: any) => {\r\n                      if (inspectionDetailResponse) {\r\n                        this.mapInspection(inspectionDetailResponse);\r\n                        this.noImagesData = false;\r\n                        this.getInspectionTemplateByObject();\r\n                        setTimeout(() => {\r\n                          this.hideContent = false;\r\n                          if (this.isBulkUploaded) {\r\n                            this.showUploading = true;\r\n                            this.isMultipleUpload = true;\r\n                            this.currentAdditionalModeMultiple = true;\r\n                          }\r\n                          if (this.uploadType) {\r\n                            this.imageUploaders.goToReview();\r\n                          }\r\n                        })\r\n                      }\r\n                    },\r\n                    error: ()=>{\r\n                      this.noImagesData = true;\r\n                    },\r\n                    complete: () => {\r\n                      this.commonService.hideLoading();\r\n                    },\r\n                  });\r\n                } else {\r\n                  this.noImagesData = true;\r\n                  this.hideContent = false;\r\n                  this.commonService.hideLoading();\r\n                }\r\n              }else{\r\n                this.noImagesData = true;\r\n                this.commonService.hideLoading();\r\n              }\r\n            }\r\n          });\r\n        }, error: ()=>{\r\n          this.noImagesData = true;\r\n          this.commonService.hideLoading();\r\n        }\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * oninit\r\n   */\r\n  ngOnInit(): void {\r\n    const currentObjectId = this.route.parent?.snapshot.paramMap.get('id');\r\n    this.addPhotosHeader = { ...this.photosHeader, isHeaderOnly: false };\r\n    this.monitorService.logEvent('ngOnInit', [ 'ChqNewPhotosComponent', 'addenda-quote', {\r\n      caseId: currentObjectId,\r\n      repairId: currentObjectId\r\n    } ]);\r\n\r\n    this.footer = {\r\n      ...this.footer, caseId: this.photosHeader.isRepairModule? '': currentObjectId,\r\n      repairId: this.photosHeader.isRepairModule? currentObjectId: '', \r\n      handleBack: this.handleBack.bind(this)\r\n      , finalRedirection: this.redirectToGtEstimate.bind(this) }\r\n\r\n    this.commonService.accessRight.subscribe({\r\n      next: (res: boolean) => {\r\n        if (!res) {\r\n          this.showNoAccess = true;\r\n        }\r\n      }\r\n    });\r\n    \r\n    this.loadApiData(currentObjectId);\r\n    const container: any = document.querySelector('.addenda-container');\r\n    if (container) {\r\n      container.scrollTop = 0;\r\n    }\r\n\r\n    this.currentObservable = this.uploadFile.bind(this);\r\n  }\r\n\r\n  /**\r\n   * reload inspection and map\r\n   */\r\n  public reloadInspection(): void {\r\n    this.commonService.showLoading();\r\n    this.inspectionTemplates = JSON.parse(this.inspectionTemplatesJSONString);\r\n    if (this.inspectionId) {\r\n      this.inspectionService.getInspection(this.inspectionId).subscribe({\r\n        next: (inspectionDetailResponse: any) => {\r\n          if (inspectionDetailResponse) {\r\n            this.mapInspection(inspectionDetailResponse);\r\n            this.getInspectionTemplateByObject();\r\n            this.isMultipleUpload = false;\r\n\r\n            this.isBulkUploaded = false;\r\n            this.currentAdditionalModeMultiple = false;\r\n            this.triggerMassUpload = false;\r\n            setTimeout(() => {\r\n              this.hideContent = false;\r\n              this.showUploading = true;\r\n            })\r\n\r\n          }\r\n        },\r\n        complete: () => {\r\n          this.commonService.hideLoading();\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * set to initial mode\r\n   */\r\n  setInitialMode(): void {\r\n    this.showUploading = false;\r\n    this.imageStatusSteps = [];\r\n    this.triggerMassUpload = false;\r\n    this.isBulkUploaded = false;\r\n    this.imageUploaders.isReviewSection = false;\r\n    this.isMultipleUpload = false;\r\n    this.currentAdditionalModeMultiple = false;\r\n  }\r\n\r\n  /**\r\n   *handle mode selection\r\n   * @param $event \r\n   */\r\n  handleMode($event: any): void {\r\n    this.monitorService.logEvent('handleMode', [ 'ChqNewPhotosComponent', 'addenda-quote', {\r\n      $event\r\n    } ]);\r\n    if (!this.inspectionId) {\r\n      this.currentUploadMode.emit({ 'mode': 'error', 'id': this.bookingId });\r\n      return;\r\n    }\r\n    this.currentUploadMode.emit($event);\r\n\r\n    if ($event.mode === 'single') {\r\n\r\n      if (this.imageStatusSteps?.length === 0) {\r\n        this.isMultipleUpload = false;\r\n        this.isBulkUploaded = false;\r\n        this.currentAdditionalModeMultiple = false;\r\n        this.triggerMassUpload = false;\r\n        this.minimumPhotosRequired = this.inspectionItemTemplates.filter((value: ChqInspectionStep) => {\r\n          return value.isSkipEnabled !== true;\r\n        }).length;\r\n        this.reloadInspection();\r\n      } else {\r\n        this.isMultipleUpload = false;\r\n        this.showUploading = true;\r\n        this.isBulkUploaded = false;\r\n        this.currentAdditionalModeMultiple = false;\r\n        this.minimumPhotosRequired = this.currentInspectionTemplate.minImageLimit;\r\n        this.triggerMassUpload = false;\r\n      }\r\n\r\n      this.currentObservable = this.uploadFile.bind(this);\r\n    } else {\r\n      this.imageStatusSteps = [];\r\n      this.currentObservable = this.uploadBulkUploadFile.bind(this);\r\n      this.isMultipleUpload = true;\r\n      this.triggerMassUpload = true;\r\n      this.showUploading = true;\r\n    }\r\n  }\r\n}\r\n","<div *ngIf=\"!showNoAccess\" [ngClass]=\"{'photo-container': photosHeader.isRepairModule}\">\r\n    <ng-container *chqPermission=\"'newBooking'\">\r\n        <add-photos [caseData]=\"caseData\" [caseNumber]=\"photosHeader.caseNumber\" [showSPI]=\"checkRepairTypes\"\r\n            [photosHeader]=\"addPhotosHeader\" (mode)=\"handleMode($event)\" *ngIf=\"showUploading === false\"\r\n            [hidden]=\"hideContent\" [showEstimate]=\"showEstimateButton\" [repairData]=\"repairDetail\"></add-photos>\r\n    </ng-container>\r\n\r\n    <div class=\"wrapper\" *ngIf=\"noImagesData\">\r\n        <div class=\"no-document-div\">\r\n            <img src=\"assets/icons/no-document.svg\">\r\n            <label class=\"no-vehicle-content\">\r\n                {{'no_photos_configured' | translate }}\r\n            </label>\r\n\r\n        </div>\r\n        <div class=\"empty-wrapper\">\r\n            <div class=\"step-container\"></div>\r\n            <div class=\"step-container\"></div>\r\n            <div class=\"step-container\"></div>\r\n            <div class=\"step-container\"></div>\r\n        </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"noImagesData\" class=\"footer-full-wrapper\">\r\n        <div class=\"footer-image-wrapper\">\r\n            <div class=\"image-wrapper\">\r\n                <img src=\"assets/img/{{ + photosHeader.isRepairModule ?'addenda-repair.png':'addenda-quote.png'}}\" />\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <chq-images-uploader [hidden]=\"showDamageAnalysis || !showUploading\" (handleDeleteAllEvent)=\"handleDeleteAll()\"\r\n        (backToUpload)=\"this.setInitialMode();\" [currentAdditionalModeMultiple]=\"currentAdditionalModeMultiple\"\r\n        [fileUploaderService]=\"currentObservable\" #imageUploaders [footerOptions]=\"footer\"\r\n        (updateMassUpload)=\"updateCurrentStatus($event);\"\r\n        *ngIf=\"(showUploading === true || isMultipleUpload) || (imageStatusSteps && imageStatusSteps.length > 0)\"\r\n        [isMassUpload]=\"isMultipleUpload\" [showReTakeDelete]=\"true\" [imageStatusSteps]=\"imageStatusSteps\"\r\n        [header]=\"photosHeader\" [inspectionId]=\"inspectionId\" [inspection]=\"'photos'\" (stepSkipped)=\"stepSkipped()\"></chq-images-uploader>\r\n    <damage-analysis *ngIf=\"showDamageAnalysis\" [isBulkUpload]=\"isMultipleUpload\"\r\n        [minPhotoRequired]=\"minimumPhotosRequired\" [caseDetail]=\"partialCaseDetail || repairDetail\"\r\n        [steps]=\"imageStatusSteps\" [isRepairModule]=\"photosHeader.isRepairModule\"\r\n        (backEvent)=\"handleBack($event)\"></damage-analysis>\r\n</div>\r\n<no-access-error *ngIf=\"showNoAccess\"></no-access-error>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { WidgetsModule } from 'src/app/widgets/chq-widgets.module';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { CanDeactivateGuard } from 'src/app/guards/deactivate-gaurd/deactivate-gaurd.guard';\r\nimport { ErrorModule } from 'src/app/shared/error-page/error.module';\r\nimport { NewDocumentsComponent } from './new-documents/new-documents.component';\r\nimport { NewPhotosComponent } from './new-photos/new-photos.component';\r\nimport { AddPhotosComponent } from './add-photos/add-photos.component';\r\nimport { IconsModule } from '../icons.module';\r\nimport { DamageAnalysisComponent } from './damage-analysis/damage-analysis.component';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { HasPermissionDirective } from '../helper/directive/has-permission.directive';\r\nimport { DirectiveModule } from '../helper/directive.module';\r\nimport { NgxPrintModule } from 'ngx-print';\r\n\r\n\r\n\r\n@NgModule({\r\n  declarations: [ \r\n    NewDocumentsComponent,\r\n    NewPhotosComponent, \r\n    AddPhotosComponent, \r\n    DamageAnalysisComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    MatIconModule,\r\n    IconsModule,\r\n    WidgetsModule,\r\n    ErrorModule,\r\n    TranslateModule,\r\n    DirectiveModule\r\n  ],\r\n  exports: [ \r\n    NewDocumentsComponent, \r\n    NewPhotosComponent, \r\n    AddPhotosComponent, \r\n    DamageAnalysisComponent\r\n    \r\n  ],\r\n  providers: [ \r\n    CanDeactivateGuard\r\n  ]\r\n})\r\nexport class SharedModule { }\r\n"],"names":["EventEmitter","i0","photosHeader","title","step","description","stepName","AddPhotosComponent","constructor","monitorService","commonService","route","dialog","caseService","router","inspectionService","estimateService","calendarService","label","type","color","icon","onclick","notify","emit","completeRepair","allowSingleUpload","bind","allowMultipleUpload","cancelBooking","mode","showDelete","repairData","repairGuid","status","toLowerCase","repairGuidisRepairCreatedFromCase","ngOnChanges","changes","logEvent","currentValue","caseNumber","addPartButtonModel","redirectToGtEstimate","showLoading","caseGuid","inspections","vehicleId","domainID","caseData","inspectionId","length","caseId","updateCaseStatus","subscribe","next","resp","createEstimate","data","url","location","href","sessionStorage","setItem","complete","hideLoading","error","navigate","ngOnInit","nextButton","openDeleteDialog","afterClosed","deleteBooking","booking","bookingGuid","selectors","inputs","showNotify","showComplete","showEstimate","repairUnapproved","activateRepairButton","showSPI","hideBulk","isRepairComplete","outputs","features","decls","vars","consts","template","CommonModule","RouterModule","MatButtonModule","MatIconModule","MatInputModule","MatSidenavModule","MatTabsModule","MatToolbarModule","WidgetsModule","NoAccessErrorComponent","ErrorModule","declarations","imports","exports","SeverityLevel","BehaviorSubject","catchError","forkJoin","of","documentPartMapper","newDocumentHeader","NewDocumentsComponent","cd","bookingService","mediaCollectionService","text","currentStatus","pageName","closed","accessRight","ngAfterViewInit","updatePage","detectChanges","checkRouteParams","queryParams","params","codeParam","imageStatusSteps","filter","indexOf","setObservable","$event","uploadedGuid","uploadedPartGuid","currentObservable","updateFile","uploadFile","getMediaTemplateByObject","mediaPartTemplates","getAllChild","mediaTemplate","mediaTemplates","i","mediaPart","documentStep","isAdditionalImage","isAdditionalDocumentFromReviewPageOnly","push","mandatory","index","parentName","isFront","frontSide","updatedDate","mediaPartGuid","uploadedDate","createdDate","domainId","objectId","sizeLimit","allowExtension","mediaGuid","partTemplateGuid","mediaPartTemplateGuid","templateGuid","updateRepairStatus","repairId","statusUpdated","currentRepairStatus","footer","getRepairDetailByGuid","result","repairDetails","bookingId","repairNumber","err","logException","Error","currentStep","obj","mediaCollectionId","collectionGuid","mediaTemplateId","mediaPartTemplateId","uploadInProgress","isSkipped","isUploadFailed","isUploadSuccess","messageForUploading","showNotification","uploadDocument","imageFile","res","responseData","mediaPartTemplate","find","x","includes","updateStatus","imageUploaders","updateUploadStatus","e","updateDocument","mapMediaTemplate","mediaData","media","mediaDataTemplate","mediaTemplateGuid","j","mediaDataPart","mediaParts","image","getURL","console","log","id","parent","snapshot","paramMap","get","showNoAccess","promiseApi","getMediaTemplate","isRepair","bookingDetail","userProfileData","organizationDetail","currentOrgId","caseDetail","getCaseDetail","pipe","dict","mediaTemplateSelected","organizationId","isViewOnly","caseStatus","documentHeader","from","quoteId","isRepairCreatedFromCase","repairStatus","detailResult","mediaTemplateDetail","getMediaTemplateById","mediaDetail","getMediaDocumentData","detailDict","sort","mediab","orderNumber","medias","noDocumentData","container","document","querySelector","scrollTop","stepSkipped","ngOnDestroy","unsubscribe","viewQuery","Modules","inspectionpartPartMapper","NewPhotosComponent","showButton","showUploadOption","handleBack","showDamageAnalysis","back","checkRepairTypes","repairType","repairTypes","v","repairServiceType","updateCurrentStatus","initial","setInitialMode","showUploading","uploadBulkUploadFile","steps","handleDeleteAll","uploads","img","Image","src","onload","uploadObject","height","width","inspectionTemplateId","vehicelType","uploadImageBulk","rawImage","rawAzureBlobUrl","inspectionItem","procedureSteps","ig","imageHeight","imageWidth","inProgressSteps","msg","inspectionItemTemplates","showEstimateButton","currentInspectionTemplate","minImageLimit","value","isSkipEnabled","mapInspection","inspectionData","inspection","uploadType","currentMode","bulkUploadTemplateItem","inspectionTemplates","name","bulkUploadedItemsWithImages","inspectionItems","inspectionItemTemplateID","massUploadItems","currentUploadMode","currentObj","map","chqInspectionStep","item","el","isMultipleUpload","addPhotosHeader","isRepairModule","minimumPhotosRequired","triggerMassUpload","isBulkUploaded","getInspectionTemplateByObject","templatePart","inspectionStep","isMassUpload","created","partialCaseDetail","loadApiData","getInspectionTemplateList","inspectionList","repairInspectionTemplate","inspectionTemplate","getInspectionTemplate","serverDetails","resultMap","inspectionTemplateDetail","inspectionDetail","inspectionTemplatesJSONString","JSON","stringify","statusId","vehicleModel","quote","vehicle","repairServiceTypes","repairDetail","repair","getInspection","inspectionDetailResponse","noImagesData","setTimeout","hideContent","currentAdditionalModeMultiple","goToReview","currentObjectId","isHeaderOnly","finalRedirection","reloadInspection","parse","isReviewSection","handleMode","CanDeactivateGuard","IconsModule","DamageAnalysisComponent","TranslateModule","DirectiveModule","SharedModule"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}