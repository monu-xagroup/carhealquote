(self.webpackChunkcar_heal_quote=self.webpackChunkcar_heal_quote||[]).push([[392],{22241:Ht=>{var ce="function"==typeof Float32Array;function Ne(V,W){return 1-3*W+3*V}function le(V,W){return 3*W-6*V}function Mt(V){return 3*V}function zt(V,W,Oe){return((Ne(W,Oe)*V+le(W,Oe))*V+Mt(W))*V}function ge(V,W,Oe){return 3*Ne(W,Oe)*V*V+2*le(W,Oe)*V+Mt(W)}function pe(V){return V}Ht.exports=function(W,Oe,fe,mt){if(!(0<=W&&W<=1&&0<=fe&&fe<=1))throw new Error("bezier x values must be in [0, 1] range");if(W===Oe&&fe===mt)return pe;for(var ie=ce?new Float32Array(11):new Array(11),ye=0;ye<11;++ye)ie[ye]=zt(.1*ye,W,fe);return function(Ee){return 0===Ee?0:1===Ee?1:zt(function(xt){for(var Ee=0,Pt=1;10!==Pt&&ie[Pt]<=xt;++Pt)Ee+=.1;--Pt;var Si=Ee+(xt-ie[Pt])/(ie[Pt+1]-ie[Pt])*.1,ai=ge(Si,W,fe);return ai>=.001?function(V,W,Oe,fe){for(var mt=0;mt<4;++mt){var ie=ge(W,Oe,fe);if(0===ie)return W;W-=(zt(W,Oe,fe)-V)/ie}return W}(xt,Si,W,fe):0===ai?Si:function(V,W,Oe,fe,mt){var ie,ye,Ke=0;do{(ie=zt(ye=W+(Oe-W)/2,fe,mt)-V)>0?Oe=ye:W=ye}while(Math.abs(ie)>1e-7&&++Ke<10);return ye}(xt,Ee,Ee+.1,W,fe)}(Ee),Oe,mt)}}},49457:function(Ht,tn){var _;void 0!==(_=function(){"use strict";function Ce(ge,de,ot){var pe=new XMLHttpRequest;pe.open("GET",ge),pe.responseType="blob",pe.onload=function(){zt(pe.response,de,ot)},pe.onerror=function(){console.error("could not download file")},pe.send()}function ce(ge){var de=new XMLHttpRequest;de.open("HEAD",ge,!1);try{de.send()}catch(ot){}return 200<=de.status&&299>=de.status}function Ne(ge){try{ge.dispatchEvent(new MouseEvent("click"))}catch(ot){var de=document.createEvent("MouseEvents");de.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),ge.dispatchEvent(de)}}var le="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,Mt=le.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),zt=le.saveAs||("object"!=typeof window||window!==le?function(){}:"download"in HTMLAnchorElement.prototype&&!Mt?function(ge,de,ot){var pe=le.URL||le.webkitURL,V=document.createElement("a");V.download=de=de||ge.name||"download",V.rel="noopener","string"==typeof ge?(V.href=ge,V.origin===location.origin?Ne(V):ce(V.href)?Ce(ge,de,ot):Ne(V,V.target="_blank")):(V.href=pe.createObjectURL(ge),setTimeout(function(){pe.revokeObjectURL(V.href)},4e4),setTimeout(function(){Ne(V)},0))}:"msSaveOrOpenBlob"in navigator?function(ge,de,ot){if(de=de||ge.name||"download","string"!=typeof ge)navigator.msSaveOrOpenBlob(function(ge,de){return void 0===de?de={autoBom:!1}:"object"!=typeof de&&(console.warn("Deprecated: Expected third argument to be a object"),de={autoBom:!de}),de.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(ge.type)?new Blob(["\ufeff",ge],{type:ge.type}):ge}(ge,ot),de);else if(ce(ge))Ce(ge,de,ot);else{var pe=document.createElement("a");pe.href=ge,pe.target="_blank",setTimeout(function(){Ne(pe)})}}:function(ge,de,ot,pe){if((pe=pe||open("","_blank"))&&(pe.document.title=pe.document.body.innerText="downloading..."),"string"==typeof ge)return Ce(ge,de,ot);var V="application/octet-stream"===ge.type,W=/constructor/i.test(le.HTMLElement)||le.safari,Oe=/CriOS\/[\d]+/.test(navigator.userAgent);if((Oe||V&&W||Mt)&&"undefined"!=typeof FileReader){var fe=new FileReader;fe.onloadend=function(){var ye=fe.result;ye=Oe?ye:ye.replace(/^data:[^;]*;/,"data:attachment/file;"),pe?pe.location.href=ye:location=ye,pe=null},fe.readAsDataURL(ge)}else{var mt=le.URL||le.webkitURL,ie=mt.createObjectURL(ge);pe?pe.location=ie:location.href=ie,pe=null,setTimeout(function(){mt.revokeObjectURL(ie)},4e4)}});le.saveAs=zt.saveAs=zt,Ht.exports=zt}.apply(tn,[]))&&(Ht.exports=_)},23815:function(Ht,tn,Z){var e;Ht=Z.nmd(Ht),function(){var _,Ne="Expected a function",Mt="__lodash_hash_undefined__",ge="__lodash_placeholder__",On=1/0,ln=9007199254740991,Qt=4294967295,aa=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],si="[object Arguments]",li="[object Array]",Mn="[object Boolean]",ci="[object Date]",xn="[object Error]",Ai="[object Function]",Yo="[object GeneratorFunction]",Ft="[object Map]",Zi="[object Number]",It="[object Object]",Go="[object Promise]",ki="[object RegExp]",At="[object Set]",di="[object String]",qi="[object Symbol]",pi="[object WeakMap]",Pn="[object ArrayBuffer]",En="[object DataView]",Ho="[object Float32Array]",Ri="[object Float64Array]",Li="[object Int8Array]",Ei="[object Int16Array]",ca="[object Int32Array]",oo="[object Uint8Array]",da="[object Uint8ClampedArray]",zo="[object Uint16Array]",ro="[object Uint32Array]",nl=/\b__p \+= '';/g,il=/\b(__p \+=) '' \+/g,Qo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ol=/&(?:amp|lt|gt|quot|#39);/g,Vo=/[&<>"']/g,Nd=RegExp(ol.source),pa=RegExp(Vo.source),jd=/<%-([\s\S]+?)%>/g,rl=/<%([\s\S]+?)%>/g,ua=/<%=([\s\S]+?)%>/g,ha=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,al=/^\w*$/,ga=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xe=/[\\^$.*+?()[\]{}|]/g,Be=RegExp(Xe.source),we=/^\s+/,sl=/\s/,ll=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,cl=/\{\n\/\* \[wrapped with (.+)\] \*/,ma=/,? & /,Fn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,dl=/[()=,{}\[\]\/\s]/,pl=/\\(\\)?/g,ul=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ze=/\w*$/,Vt=/^[-+]0x[0-9a-f]+$/i,dt=/^0b[01]+$/i,Ye=/^\[object .+?Constructor\]$/,Nn=/^0o[0-7]+$/i,Ge=/^(?:0|[1-9]\d*)$/,fa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,A=/($^)/,hl=/['\n\r\u2028\u2029\\]/g,ao="\\ud800-\\udfff",_a="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",va="\\u2700-\\u27bf",ba="a-z\\xdf-\\xf6\\xf8-\\xff",Pe="A-Z\\xc0-\\xd6\\xd8-\\xde",Wo="\\ufe0e\\ufe0f",je="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",on="["+ao+"]",Fe="["+je+"]",ui="["+_a+"]",Fi="\\d+",He="["+va+"]",Ma="["+ba+"]",xa="[^"+ao+je+Fi+va+ba+Pe+"]",$o="\\ud83c[\\udffb-\\udfff]",Pa="[^"+ao+"]",Ko="(?:\\ud83c[\\udde6-\\uddff]){2}",Xo="[\\ud800-\\udbff][\\udc00-\\udfff]",hi="["+Pe+"]",wa="(?:"+Ma+"|"+xa+")",vl="(?:"+hi+"|"+xa+")",Ta="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Da="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Sa="(?:"+ui+"|"+$o+")?",Ia="["+Wo+"]?",er=Ia+Sa+"(?:\\u200d(?:"+[Pa,Ko,Xo].join("|")+")"+Ia+Sa+")*",Ml="(?:"+[He,Ko,Xo].join("|")+")"+er,Aa="(?:"+[Pa+ui+"?",ui,Ko,Xo,on].join("|")+")",xl=RegExp("['\u2019]","g"),Pl=RegExp(ui,"g"),tr=RegExp($o+"(?="+$o+")|"+Aa+er,"g"),yl=RegExp([hi+"?"+Ma+"+"+Ta+"(?="+[Fe,hi,"$"].join("|")+")",vl+"+"+Da+"(?="+[Fe,hi+wa,"$"].join("|")+")",hi+"?"+wa+"+"+Ta,hi+"+"+Da,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fi,Ml].join("|"),"g"),wl=RegExp("[\\u200d"+ao+_a+Wo+"]"),Tl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Dl=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Sl=-1,Ie={};Ie[Ho]=Ie[Ri]=Ie[Li]=Ie[Ei]=Ie[ca]=Ie[oo]=Ie[da]=Ie[zo]=Ie[ro]=!0,Ie[si]=Ie[li]=Ie[Pn]=Ie[Mn]=Ie[En]=Ie[ci]=Ie[xn]=Ie[Ai]=Ie[Ft]=Ie[Zi]=Ie[It]=Ie[ki]=Ie[At]=Ie[di]=Ie[pi]=!1;var ke={};ke[si]=ke[li]=ke[Pn]=ke[En]=ke[Mn]=ke[ci]=ke[Ho]=ke[Ri]=ke[Li]=ke[Ei]=ke[ca]=ke[Ft]=ke[Zi]=ke[It]=ke[ki]=ke[At]=ke[di]=ke[qi]=ke[oo]=ke[da]=ke[zo]=ke[ro]=!0,ke[xn]=ke[Ai]=ke[pi]=!1;var Al={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Zl=parseFloat,kl=parseInt,Za="object"==typeof global&&global&&global.Object===Object&&global,ql="object"==typeof self&&self&&self.Object===Object&&self,rt=Za||ql||Function("return this")(),ka=tn&&!tn.nodeType&&tn,gi=ka&&Ht&&!Ht.nodeType&&Ht,qa=gi&&gi.exports===ka,J=qa&&Za.process,wt=function(){try{return gi&&gi.require&&gi.require("util").types||J&&J.binding&&J.binding("util")}catch(S){}}(),ir=wt&&wt.isArrayBuffer,or=wt&&wt.isDate,Ra=wt&&wt.isMap,La=wt&&wt.isRegExp,mi=wt&&wt.isSet,rr=wt&&wt.isTypedArray;function Zt(x,S,y){switch(y.length){case 0:return x.call(S);case 1:return x.call(S,y[0]);case 2:return x.call(S,y[0],y[1]);case 3:return x.call(S,y[0],y[1],y[2])}return x.apply(S,y)}function Rl(x,S,y,U){for(var oe=-1,xe=null==x?0:x.length;++oe<xe;){var Qe=x[oe];S(U,Qe,y(Qe),x)}return U}function Nt(x,S){for(var y=-1,U=null==x?0:x.length;++y<U&&!1!==S(x[y],y,x););return x}function Ll(x,S){for(var y=null==x?0:x.length;y--&&!1!==S(x[y],y,x););return x}function Ea(x,S){for(var y=-1,U=null==x?0:x.length;++y<U;)if(!S(x[y],y,x))return!1;return!0}function yn(x,S){for(var y=-1,U=null==x?0:x.length,oe=0,xe=[];++y<U;){var Qe=x[y];S(Qe,y,x)&&(xe[oe++]=Qe)}return xe}function so(x,S){return!(null==x||!x.length)&&fi(x,S,0)>-1}function ar(x,S,y){for(var U=-1,oe=null==x?0:x.length;++U<oe;)if(y(S,x[U]))return!0;return!1}function Re(x,S){for(var y=-1,U=null==x?0:x.length,oe=Array(U);++y<U;)oe[y]=S(x[y],y,x);return oe}function wn(x,S){for(var y=-1,U=S.length,oe=x.length;++y<U;)x[oe+y]=S[y];return x}function sr(x,S,y,U){var oe=-1,xe=null==x?0:x.length;for(U&&xe&&(y=x[++oe]);++oe<xe;)y=S(y,x[oe],oe,x);return y}function El(x,S,y,U){var oe=null==x?0:x.length;for(U&&oe&&(y=x[--oe]);oe--;)y=S(y,x[oe],oe,x);return y}function lr(x,S){for(var y=-1,U=null==x?0:x.length;++y<U;)if(S(x[y],y,x))return!0;return!1}var Fl=Un("length");function Fa(x,S,y){var U;return y(x,function(oe,xe,Qe){if(S(oe,xe,Qe))return U=xe,!1}),U}function lo(x,S,y,U){for(var oe=x.length,xe=y+(U?1:-1);U?xe--:++xe<oe;)if(S(x[xe],xe,x))return xe;return-1}function fi(x,S,y){return S==S?function(x,S,y){for(var U=y-1,oe=x.length;++U<oe;)if(x[U]===S)return U;return-1}(x,S,y):lo(x,Na,y)}function Ul(x,S,y,U){for(var oe=y-1,xe=x.length;++oe<xe;)if(U(x[oe],S))return oe;return-1}function Na(x){return x!=x}function ja(x,S){var y=null==x?0:x.length;return y?cr(x,S)/y:NaN}function Un(x){return function(S){return null==S?_:S[x]}}function Jn(x){return function(S){return null==x?_:x[S]}}function Wt(x,S,y,U,oe){return oe(x,function(xe,Qe,Ae){y=U?(U=!1,xe):S(y,xe,Qe,Ae)}),y}function cr(x,S){for(var y,U=-1,oe=x.length;++U<oe;){var xe=S(x[U]);xe!==_&&(y=y===_?xe:y+xe)}return y}function dr(x,S){for(var y=-1,U=Array(x);++y<x;)U[y]=S(y);return U}function Ua(x){return x&&x.slice(0,Ya(x)+1).replace(we,"")}function ft(x){return function(S){return x(S)}}function pr(x,S){return Re(S,function(y){return x[y]})}function _i(x,S){return x.has(S)}function Ja(x,S){for(var y=-1,U=x.length;++y<U&&fi(S,x[y],0)>-1;);return y}function co(x,S){for(var y=x.length;y--&&fi(S,x[y],0)>-1;);return y}function Yl(x,S){for(var y=x.length,U=0;y--;)x[y]===S&&++U;return U}var Gl=Jn({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Hl=Jn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function zl(x){return"\\"+Al[x]}function vi(x){return wl.test(x)}function ur(x){var S=-1,y=Array(x.size);return x.forEach(function(U,oe){y[++S]=[oe,U]}),y}function Ba(x,S){return function(y){return x(S(y))}}function Tn(x,S){for(var y=-1,U=x.length,oe=0,xe=[];++y<U;){var Qe=x[y];(Qe===S||Qe===ge)&&(x[y]=ge,xe[oe++]=y)}return xe}function po(x){var S=-1,y=Array(x.size);return x.forEach(function(U){y[++S]=U}),y}function bi(x){return vi(x)?function(x){for(var S=tr.lastIndex=0;tr.test(x);)++S;return S}(x):Fl(x)}function $t(x){return vi(x)?function(x){return x.match(tr)||[]}(x):function(x){return x.split("")}(x)}function Ya(x){for(var S=x.length;S--&&sl.test(x.charAt(S)););return S}var ec=Jn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),dn=function x(S){var n,y=(S=null==S?rt:dn.defaults(rt.Object(),S,dn.pick(rt,Dl))).Array,U=S.Date,oe=S.Error,xe=S.Function,Qe=S.Math,Ae=S.Object,hr=S.RegExp,oc=S.String,jt=S.TypeError,uo=y.prototype,Ci=Ae.prototype,ho=S["__core-js_shared__"],go=xe.prototype.toString,Te=Ci.hasOwnProperty,ac=0,Ga=(n=/[^.]+$/.exec(ho&&ho.keys&&ho.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",mo=Ci.toString,sc=go.call(Ae),Ha=rt._,za=hr("^"+go.call(Te).replace(Xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fo=qa?S.Buffer:_,Sn=S.Symbol,_o=S.Uint8Array,Qa=fo?fo.allocUnsafe:_,vo=Ba(Ae.getPrototypeOf,Ae),Va=Ae.create,Wa=Ci.propertyIsEnumerable,Ni=uo.splice,$a=Sn?Sn.isConcatSpreadable:_,ji=Sn?Sn.iterator:_,Bn=Sn?Sn.toStringTag:_,bo=function(){try{var n=Vn(Ae,"defineProperty");return n({},"",{}),n}catch(o){}}(),lc=S.clearTimeout!==rt.clearTimeout&&S.clearTimeout,Ka=U&&U.now!==rt.Date.now&&U.now,cc=S.setTimeout!==rt.setTimeout&&S.setTimeout,Co=Qe.ceil,Oo=Qe.floor,gr=Ae.getOwnPropertySymbols,dc=fo?fo.isBuffer:_,Xa=S.isFinite,Mo=uo.join,pc=Ba(Ae.keys,Ae),Ve=Qe.max,pt=Qe.min,es=U.now,uc=S.parseInt,ts=Qe.random,hc=uo.reverse,mr=Vn(S,"DataView"),Yn=Vn(S,"Map"),fr=Vn(S,"Promise"),Oi=Vn(S,"Set"),Ui=Vn(S,"WeakMap"),Ji=Vn(Ae,"create"),xo=Ui&&new Ui,Mi={},gc=ne(mr),mc=ne(Yn),fc=ne(fr),_c=ne(Oi),vc=ne(Ui),Po=Sn?Sn.prototype:_,Bi=Po?Po.valueOf:_,ns=Po?Po.toString:_;function g(n){if(ze(n)&&!se(n)&&!(n instanceof _e)){if(n instanceof Tt)return n;if(Te.call(n,"__wrapped__"))return X(n)}return new Tt(n)}var xi=function(){function n(){}return function(o){if(!Je(o))return{};if(Va)return Va(o);n.prototype=o;var l=new n;return n.prototype=_,l}}();function Yi(){}function Tt(n,o){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=_}function _e(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Qt,this.__views__=[]}function Gn(n){var o=-1,l=null==n?0:n.length;for(this.clear();++o<l;){var d=n[o];this.set(d[0],d[1])}}function pn(n){var o=-1,l=null==n?0:n.length;for(this.clear();++o<l;){var d=n[o];this.set(d[0],d[1])}}function un(n){var o=-1,l=null==n?0:n.length;for(this.clear();++o<l;){var d=n[o];this.set(d[0],d[1])}}function Hn(n){var o=-1,l=null==n?0:n.length;for(this.__data__=new un;++o<l;)this.add(n[o])}function st(n){var o=this.__data__=new pn(n);this.size=o.size}function rs(n,o){var l=se(n),d=!l&&Xi(n),h=!l&&!d&&Di(n),f=!l&&!d&&!h&&Uo(n),b=l||d||h||f,M=b?dr(n.length,oc):[],P=M.length;for(var k in n)(o||Te.call(n,k))&&(!b||!("length"==k||h&&("offset"==k||"parent"==k)||f&&("buffer"==k||"byteLength"==k||"byteOffset"==k)||fn(k,P)))&&M.push(k);return M}function as(n){var o=n.length;return o?n[kr(0,o-1)]:_}function Nc(n,o){return G(Dt(n),zn(o,0,n.length))}function jc(n){return G(Dt(n))}function vr(n,o,l){(l!==_&&!vn(n[o],l)||l===_&&!(o in n))&&hn(n,o,l)}function Gi(n,o,l){var d=n[o];(!Te.call(n,o)||!vn(d,l)||l===_&&!(o in n))&&hn(n,o,l)}function _t(n,o){for(var l=n.length;l--;)if(vn(n[l][0],o))return l;return-1}function Uc(n,o,l,d){return In(n,function(h,f,b){o(d,h,l(h),b)}),d}function ss(n,o){return n&&an(o,gt(o),n)}function hn(n,o,l){"__proto__"==o&&bo?bo(n,o,{configurable:!0,enumerable:!0,value:l,writable:!0}):n[o]=l}function br(n,o){for(var l=-1,d=o.length,h=y(d),f=null==n;++l<d;)h[l]=f?_:Sd(n,o[l]);return h}function zn(n,o,l){return n==n&&(l!==_&&(n=n<=l?n:l),o!==_&&(n=n>=o?n:o)),n}function Ut(n,o,l,d,h,f){var b,M=1&o,P=2&o,k=4&o;if(l&&(b=h?l(n,d,h,f):l(n)),b!==_)return b;if(!Je(n))return n;var q=se(n);if(q){if(b=function(n){var o=n.length,l=new n.constructor(o);return o&&"string"==typeof n[0]&&Te.call(n,"index")&&(l.index=n.index,l.input=n.input),l}(n),!M)return Dt(n,b)}else{var L=ht(n),j=L==Ai||L==Yo;if(Di(n))return Ts(n,M);if(L==It||L==si||j&&!h){if(b=P||j?{}:Gs(n),!M)return P?function(n,o){return an(n,Bs(n),o)}(n,function(n,o){return n&&an(o,Yt(o),n)}(b,n)):function(n,o){return an(n,Vr(n),o)}(n,ss(b,n))}else{if(!ke[L])return h?n:{};b=function(n,o,l){var d=n.constructor;switch(o){case Pn:return Ur(n);case Mn:case ci:return new d(+n);case En:return function(n,o){var l=o?Ur(n.buffer):n.buffer;return new n.constructor(l,n.byteOffset,n.byteLength)}(n,l);case Ho:case Ri:case Li:case Ei:case ca:case oo:case da:case zo:case ro:return Ds(n,l);case Ft:return new d;case Zi:case di:return new d(n);case ki:return function(n){var o=new n.constructor(n.source,Ze.exec(n));return o.lastIndex=n.lastIndex,o}(n);case At:return new d;case qi:return function(n){return Bi?Ae(Bi.call(n)):{}}(n)}}(n,L,M)}}f||(f=new st);var Y=f.get(n);if(Y)return Y;f.set(n,b),np(n)?n.forEach(function(K){b.add(Ut(K,o,l,K,n,f))}):ep(n)&&n.forEach(function(K,ve){b.set(ve,Ut(K,o,l,ve,n,f))});var me=q?_:(k?P?Hr:Gr:P?Yt:gt)(n);return Nt(me||n,function(K,ve){me&&(K=n[ve=K]),Gi(b,ve,Ut(K,o,l,ve,n,f))}),b}function ls(n,o,l){var d=l.length;if(null==n)return!d;for(n=Ae(n);d--;){var h=l[d],b=n[h];if(b===_&&!(h in n)||!(0,o[h])(b))return!1}return!0}function cs(n,o,l){if("function"!=typeof n)throw new jt(Ne);return R(function(){n.apply(_,l)},o)}function Hi(n,o,l,d){var h=-1,f=so,b=!0,M=n.length,P=[],k=o.length;if(!M)return P;l&&(o=Re(o,ft(l))),d?(f=ar,b=!1):o.length>=200&&(f=_i,b=!1,o=new Hn(o));e:for(;++h<M;){var q=n[h],L=null==l?q:l(q);if(q=d||0!==q?q:0,b&&L==L){for(var j=k;j--;)if(o[j]===L)continue e;P.push(q)}else f(o,L,d)||P.push(q)}return P}g.templateSettings={escape:jd,evaluate:rl,interpolate:ua,variable:"",imports:{_:g}},(g.prototype=Yi.prototype).constructor=g,(Tt.prototype=xi(Yi.prototype)).constructor=Tt,(_e.prototype=xi(Yi.prototype)).constructor=_e,Gn.prototype.clear=function(){this.__data__=Ji?Ji(null):{},this.size=0},Gn.prototype.delete=function(n){var o=this.has(n)&&delete this.__data__[n];return this.size-=o?1:0,o},Gn.prototype.get=function(n){var o=this.__data__;if(Ji){var l=o[n];return l===Mt?_:l}return Te.call(o,n)?o[n]:_},Gn.prototype.has=function(n){var o=this.__data__;return Ji?o[n]!==_:Te.call(o,n)},Gn.prototype.set=function(n,o){var l=this.__data__;return this.size+=this.has(n)?0:1,l[n]=Ji&&o===_?Mt:o,this},pn.prototype.clear=function(){this.__data__=[],this.size=0},pn.prototype.delete=function(n){var o=this.__data__,l=_t(o,n);return!(l<0||(l==o.length-1?o.pop():Ni.call(o,l,1),--this.size,0))},pn.prototype.get=function(n){var o=this.__data__,l=_t(o,n);return l<0?_:o[l][1]},pn.prototype.has=function(n){return _t(this.__data__,n)>-1},pn.prototype.set=function(n,o){var l=this.__data__,d=_t(l,n);return d<0?(++this.size,l.push([n,o])):l[d][1]=o,this},un.prototype.clear=function(){this.size=0,this.__data__={hash:new Gn,map:new(Yn||pn),string:new Gn}},un.prototype.delete=function(n){var o=No(this,n).delete(n);return this.size-=o?1:0,o},un.prototype.get=function(n){return No(this,n).get(n)},un.prototype.has=function(n){return No(this,n).has(n)},un.prototype.set=function(n,o){var l=No(this,n),d=l.size;return l.set(n,o),this.size+=l.size==d?0:1,this},Hn.prototype.add=Hn.prototype.push=function(n){return this.__data__.set(n,Mt),this},Hn.prototype.has=function(n){return this.__data__.has(n)},st.prototype.clear=function(){this.__data__=new pn,this.size=0},st.prototype.delete=function(n){var o=this.__data__,l=o.delete(n);return this.size=o.size,l},st.prototype.get=function(n){return this.__data__.get(n)},st.prototype.has=function(n){return this.__data__.has(n)},st.prototype.set=function(n,o){var l=this.__data__;if(l instanceof pn){var d=l.__data__;if(!Yn||d.length<199)return d.push([n,o]),this.size=++l.size,this;l=this.__data__=new un(d)}return l.set(n,o),this.size=l.size,this};var In=As(rn),ds=As(Or,!0);function Yc(n,o){var l=!0;return In(n,function(d,h,f){return l=!!o(d,h,f)}),l}function wo(n,o,l){for(var d=-1,h=n.length;++d<h;){var f=n[d],b=o(f);if(null!=b&&(M===_?b==b&&!Kt(b):l(b,M)))var M=b,P=f}return P}function ps(n,o){var l=[];return In(n,function(d,h,f){o(d,h,f)&&l.push(d)}),l}function lt(n,o,l,d,h){var f=-1,b=n.length;for(l||(l=Md),h||(h=[]);++f<b;){var M=n[f];o>0&&l(M)?o>1?lt(M,o-1,l,d,h):wn(h,M):d||(h[h.length]=M)}return h}var Cr=Zs(),us=Zs(!0);function rn(n,o){return n&&Cr(n,o,gt)}function Or(n,o){return n&&us(n,o,gt)}function To(n,o){return yn(o,function(l){return ii(n[l])})}function Qn(n,o){for(var l=0,d=(o=kn(o,n)).length;null!=n&&l<d;)n=n[z(o[l++])];return l&&l==d?n:_}function ut(n,o,l){var d=o(n);return se(n)?d:wn(d,l(n))}function vt(n){return null==n?n===_?"[object Undefined]":"[object Null]":Bn&&Bn in Ae(n)?function(n){var o=Te.call(n,Bn),l=n[Bn];try{n[Bn]=_;var d=!0}catch(f){}var h=mo.call(n);return d&&(o?n[Bn]=l:delete n[Bn]),h}(n):function(n){return mo.call(n)}(n)}function Mr(n,o){return n>o}function Hc(n,o){return null!=n&&Te.call(n,o)}function zc(n,o){return null!=n&&o in Ae(n)}function xr(n,o,l){for(var d=l?ar:so,h=n[0].length,f=n.length,b=f,M=y(f),P=1/0,k=[];b--;){var q=n[b];b&&o&&(q=Re(q,ft(o))),P=pt(q.length,P),M[b]=!l&&(o||h>=120&&q.length>=120)?new Hn(b&&q):_}q=n[0];var L=-1,j=M[0];e:for(;++L<h&&k.length<P;){var Y=q[L],$=o?o(Y):Y;if(Y=l||0!==Y?Y:0,!(j?_i(j,$):d(k,$,l))){for(b=f;--b;){var me=M[b];if(!(me?_i(me,$):d(n[b],$,l)))continue e}j&&j.push($),k.push(Y)}}return k}function Pi(n,o,l){var d=null==(n=v(n,o=kn(o,n)))?n:n[z(it(o))];return null==d?_:Zt(d,n,l)}function Pr(n){return ze(n)&&vt(n)==si}function zi(n,o,l,d,h){return n===o||(null==n||null==o||!ze(n)&&!ze(o)?n!=n&&o!=o:function(n,o,l,d,h,f){var b=se(n),M=se(o),P=b?li:ht(n),k=M?li:ht(o),q=(P=P==si?It:P)==It,L=(k=k==si?It:k)==It,j=P==k;if(j&&Di(n)){if(!Di(o))return!1;b=!0,q=!1}if(j&&!q)return f||(f=new st),b||Uo(n)?Js(n,o,l,d,h,f):function(n,o,l,d,h,f,b){switch(l){case En:if(n.byteLength!=o.byteLength||n.byteOffset!=o.byteOffset)return!1;n=n.buffer,o=o.buffer;case Pn:return!(n.byteLength!=o.byteLength||!f(new _o(n),new _o(o)));case Mn:case ci:case Zi:return vn(+n,+o);case xn:return n.name==o.name&&n.message==o.message;case ki:case di:return n==o+"";case Ft:var M=ur;case At:if(M||(M=po),n.size!=o.size&&!(1&d))return!1;var k=b.get(n);if(k)return k==o;d|=2,b.set(n,o);var q=Js(M(n),M(o),d,h,f,b);return b.delete(n),q;case qi:if(Bi)return Bi.call(n)==Bi.call(o)}return!1}(n,o,P,l,d,h,f);if(!(1&l)){var Y=q&&Te.call(n,"__wrapped__"),$=L&&Te.call(o,"__wrapped__");if(Y||$){var me=Y?n.value():n,K=$?o.value():o;return f||(f=new st),h(me,K,l,d,f)}}return!!j&&(f||(f=new st),function(n,o,l,d,h,f){var b=1&l,M=Gr(n),P=M.length;if(P!=Gr(o).length&&!b)return!1;for(var L=P;L--;){var j=M[L];if(!(b?j in o:Te.call(o,j)))return!1}var Y=f.get(n),$=f.get(o);if(Y&&$)return Y==o&&$==n;var me=!0;f.set(n,o),f.set(o,n);for(var K=b;++L<P;){var ve=n[j=M[L]],be=o[j];if(d)var Xt=b?d(be,ve,j,o,n,f):d(ve,be,j,n,o,f);if(!(Xt===_?ve===be||h(ve,be,l,d,f):Xt)){me=!1;break}K||(K="constructor"==j)}if(me&&!K){var Et=n.constructor,en=o.constructor;Et!=en&&"constructor"in n&&"constructor"in o&&!("function"==typeof Et&&Et instanceof Et&&"function"==typeof en&&en instanceof en)&&(me=!1)}return f.delete(n),f.delete(o),me}(n,o,l,d,h,f))}(n,o,l,d,zi,h))}function yr(n,o,l,d){var h=l.length,f=h,b=!d;if(null==n)return!f;for(n=Ae(n);h--;){var M=l[h];if(b&&M[2]?M[1]!==n[M[0]]:!(M[0]in n))return!1}for(;++h<f;){var P=(M=l[h])[0],k=n[P],q=M[1];if(b&&M[2]){if(k===_&&!(P in n))return!1}else{var L=new st;if(d)var j=d(k,q,P,n,o,L);if(!(j===_?zi(q,k,3,d,L):j))return!1}}return!0}function hs(n){return!(!Je(n)||function(n){return!!Ga&&Ga in n}(n))&&(ii(n)?za:Ye).test(ne(n))}function ms(n){return"function"==typeof n?n:null==n?Gt:"object"==typeof n?se(n)?Sr(n[0],n[1]):_s(n):mp(n)}function Tr(n){if(!i(n))return pc(n);var o=[];for(var l in Ae(n))Te.call(n,l)&&"constructor"!=l&&o.push(l);return o}function Dr(n,o){return n<o}function fs(n,o){var l=-1,d=Bt(n)?y(n.length):[];return In(n,function(h,f,b){d[++l]=o(h,f,b)}),d}function _s(n){var o=Qr(n);return 1==o.length&&o[0][2]?s(o[0][0],o[0][1]):function(l){return l===n||yr(l,n,o)}}function Sr(n,o){return Wr(n)&&r(o)?s(z(n),o):function(l){var d=Sd(l,n);return d===_&&d===o?Id(l,n):zi(o,d,3)}}function Qi(n,o,l,d,h){n!==o&&Cr(o,function(f,b){if(h||(h=new st),Je(f))!function(n,o,l,d,h,f,b){var M=D(n,l),P=D(o,l),k=b.get(P);if(k)vr(n,l,k);else{var q=f?f(M,P,l+"",n,o,b):_,L=q===_;if(L){var j=se(P),Y=!j&&Di(P),$=!j&&!Y&&Uo(P);q=P,j||Y||$?se(M)?q=M:We(M)?q=Dt(M):Y?(L=!1,q=Ts(P,!0)):$?(L=!1,q=Ds(P,!0)):q=[]:ta(P)||Xi(P)?(q=M,Xi(M)?q=rp(M):(!Je(M)||ii(M))&&(q=Gs(P))):L=!1}L&&(b.set(P,q),h(q,P,d,f,b),b.delete(P)),vr(n,l,q)}}(n,o,b,l,Qi,d,h);else{var M=d?d(D(n,b),f,b+"",n,o,h):_;M===_&&(M=f),vr(n,b,M)}},Yt)}function So(n,o){var l=n.length;if(l)return fn(o+=o<0?l:0,l)?n[o]:_}function Io(n,o,l){o=o.length?Re(o,function(f){return se(f)?function(b){return Qn(b,1===f.length?f[0]:f)}:f}):[Gt];var d=-1;return o=Re(o,ft(H())),function(x,S){var y=x.length;for(x.sort(function(f,b){return function(n,o,l){for(var d=-1,h=n.criteria,f=o.criteria,b=h.length,M=l.length;++d<b;){var P=Ss(h[d],f[d]);if(P)return d>=M?P:P*("desc"==l[d]?-1:1)}return n.index-o.index}(f,b,l)});y--;)x[y]=x[y].value;return x}(fs(n,function(f,b,M){return{criteria:Re(o,function(k){return k(f)}),index:++d,value:f}}))}function Ar(n,o,l){for(var d=-1,h=o.length,f={};++d<h;){var b=o[d],M=Qn(n,b);l(M,b)&&Vi(f,kn(b,n),M)}return f}function kt(n,o,l,d){var h=d?Ul:fi,f=-1,b=o.length,M=n;for(n===o&&(o=Dt(o)),l&&(M=Re(n,ft(l)));++f<b;)for(var P=0,k=o[f],q=l?l(k):k;(P=h(M,q,P,d))>-1;)M!==n&&Ni.call(M,P,1),Ni.call(n,P,1);return n}function vs(n,o){for(var l=n?o.length:0,d=l-1;l--;){var h=o[l];if(l==d||h!==f){var f=h;fn(h)?Ni.call(n,h,1):Fr(n,h)}}return n}function kr(n,o){return n+Oo(ts()*(o-n+1))}function qr(n,o){var l="";if(!n||o<1||o>ln)return l;do{o%2&&(l+=n),(o=Oo(o/2))&&(n+=n)}while(o);return l}function ae(n,o){return I(O(n,o,Gt),n+"")}function bs(n){return as(Jo(n))}function td(n,o){var l=Jo(n);return G(l,zn(o,0,l.length))}function Vi(n,o,l,d){if(!Je(n))return n;for(var h=-1,f=(o=kn(o,n)).length,b=f-1,M=n;null!=M&&++h<f;){var P=z(o[h]),k=l;if("__proto__"===P||"constructor"===P||"prototype"===P)return n;if(h!=b){var q=M[P];(k=d?d(q,P,M):_)===_&&(k=Je(q)?q:fn(o[h+1])?[]:{})}Gi(M,P,k),M=M[P]}return n}var Ao=xo?function(n,o){return xo.set(n,o),n}:Gt,Rr=bo?function(n,o){return bo(n,"toString",{configurable:!0,enumerable:!1,value:Zd(o),writable:!0})}:Gt;function Cs(n){return G(Jo(n))}function qt(n,o,l){var d=-1,h=n.length;o<0&&(o=-o>h?0:h+o),(l=l>h?h:l)<0&&(l+=h),h=o>l?0:l-o>>>0,o>>>=0;for(var f=y(h);++d<h;)f[d]=n[d+o];return f}function Os(n,o){var l;return In(n,function(d,h,f){return!(l=o(d,h,f))}),!!l}function Zo(n,o,l){var d=0,h=null==n?d:n.length;if("number"==typeof o&&o==o&&h<=2147483647){for(;d<h;){var f=d+h>>>1,b=n[f];null!==b&&!Kt(b)&&(l?b<=o:b<o)?d=f+1:h=f}return h}return Lr(n,o,Gt,l)}function Lr(n,o,l,d){var h=0,f=null==n?0:n.length;if(0===f)return 0;for(var b=(o=l(o))!=o,M=null===o,P=Kt(o),k=o===_;h<f;){var q=Oo((h+f)/2),L=l(n[q]),j=L!==_,Y=null===L,$=L==L,me=Kt(L);if(b)var K=d||$;else K=k?$&&(d||j):M?$&&j&&(d||!Y):P?$&&j&&!Y&&(d||!me):!Y&&!me&&(d?L<=o:L<o);K?h=q+1:f=q}return pt(f,4294967294)}function Er(n,o){for(var l=-1,d=n.length,h=0,f=[];++l<d;){var b=n[l],M=o?o(b):b;if(!l||!vn(M,P)){var P=M;f[h++]=0===b?0:b}}return f}function Ms(n){return"number"==typeof n?n:Kt(n)?NaN:+n}function Rt(n){if("string"==typeof n)return n;if(se(n))return Re(n,Rt)+"";if(Kt(n))return ns?ns.call(n):"";var o=n+"";return"0"==o&&1/n==-On?"-0":o}function Zn(n,o,l){var d=-1,h=so,f=n.length,b=!0,M=[],P=M;if(l)b=!1,h=ar;else if(f>=200){var k=o?null:ud(n);if(k)return po(k);b=!1,h=_i,P=new Hn}else P=o?[]:M;e:for(;++d<f;){var q=n[d],L=o?o(q):q;if(q=l||0!==q?q:0,b&&L==L){for(var j=P.length;j--;)if(P[j]===L)continue e;o&&P.push(L),M.push(q)}else h(P,L,l)||(P!==M&&P.push(L),M.push(q))}return M}function Fr(n,o){return null==(n=v(n,o=kn(o,n)))||delete n[z(it(o))]}function xs(n,o,l,d){return Vi(n,o,l(Qn(n,o)),d)}function ko(n,o,l,d){for(var h=n.length,f=d?h:-1;(d?f--:++f<h)&&o(n[f],f,n););return l?qt(n,d?0:f,d?f+1:h):qt(n,d?f+1:0,d?h:f)}function Ps(n,o){var l=n;return l instanceof _e&&(l=l.value()),sr(o,function(d,h){return h.func.apply(h.thisArg,wn([d],h.args))},l)}function Wi(n,o,l){var d=n.length;if(d<2)return d?Zn(n[0]):[];for(var h=-1,f=y(d);++h<d;)for(var b=n[h],M=-1;++M<d;)M!=h&&(f[h]=Hi(f[h]||b,n[M],o,l));return Zn(lt(f,1),o,l)}function ys(n,o,l){for(var d=-1,h=n.length,f=o.length,b={};++d<h;)l(b,n[d],d<f?o[d]:_);return b}function Nr(n){return We(n)?n:[]}function jr(n){return"function"==typeof n?n:Gt}function kn(n,o){return se(n)?n:Wr(n,o)?[n]:re(Se(n))}var nd=ae;function qn(n,o,l){var d=n.length;return l=l===_?d:l,!o&&l>=d?n:qt(n,o,l)}var ws=lc||function(n){return rt.clearTimeout(n)};function Ts(n,o){if(o)return n.slice();var l=n.length,d=Qa?Qa(l):new n.constructor(l);return n.copy(d),d}function Ur(n){var o=new n.constructor(n.byteLength);return new _o(o).set(new _o(n)),o}function Ds(n,o){var l=o?Ur(n.buffer):n.buffer;return new n.constructor(l,n.byteOffset,n.length)}function Ss(n,o){if(n!==o){var l=n!==_,d=null===n,h=n==n,f=Kt(n),b=o!==_,M=null===o,P=o==o,k=Kt(o);if(!M&&!k&&!f&&n>o||f&&b&&P&&!M&&!k||d&&b&&P||!l&&P||!h)return 1;if(!d&&!f&&!k&&n<o||k&&l&&h&&!d&&!f||M&&l&&h||!b&&h||!P)return-1}return 0}function Jr(n,o,l,d){for(var h=-1,f=n.length,b=l.length,M=-1,P=o.length,k=Ve(f-b,0),q=y(P+k),L=!d;++M<P;)q[M]=o[M];for(;++h<b;)(L||h<f)&&(q[l[h]]=n[h]);for(;k--;)q[M++]=n[h++];return q}function Is(n,o,l,d){for(var h=-1,f=n.length,b=-1,M=l.length,P=-1,k=o.length,q=Ve(f-M,0),L=y(q+k),j=!d;++h<q;)L[h]=n[h];for(var Y=h;++P<k;)L[Y+P]=o[P];for(;++b<M;)(j||h<f)&&(L[Y+l[b]]=n[h++]);return L}function Dt(n,o){var l=-1,d=n.length;for(o||(o=y(d));++l<d;)o[l]=n[l];return o}function an(n,o,l,d){var h=!l;l||(l={});for(var f=-1,b=o.length;++f<b;){var M=o[f],P=d?d(l[M],n[M],M,l,n):_;P===_&&(P=n[M]),h?hn(l,M,P):Gi(l,M,P)}return l}function et(n,o){return function(l,d){var h=se(l)?Rl:Uc,f=o?o():{};return h(l,n,H(d,2),f)}}function Jt(n){return ae(function(o,l){var d=-1,h=l.length,f=h>1?l[h-1]:_,b=h>2?l[2]:_;for(f=n.length>3&&"function"==typeof f?(h--,f):_,b&&bt(l[0],l[1],b)&&(f=h<3?_:f,h=1),o=Ae(o);++d<h;){var M=l[d];M&&n(o,M,d,f)}return o})}function As(n,o){return function(l,d){if(null==l)return l;if(!Bt(l))return n(l,d);for(var h=l.length,f=o?h:-1,b=Ae(l);(o?f--:++f<h)&&!1!==d(b[f],f,b););return l}}function Zs(n){return function(o,l,d){for(var h=-1,f=Ae(o),b=d(o),M=b.length;M--;){var P=b[n?M:++h];if(!1===l(f[P],P,f))break}return o}}function ks(n){return function(o){var l=vi(o=Se(o))?$t(o):_,d=l?l[0]:o.charAt(0),h=l?qn(l,1).join(""):o.slice(1);return d[n]()+h}}function yi(n){return function(o){return sr(hp(up(o).replace(xl,"")),n,"")}}function wi(n){return function(){var o=arguments;switch(o.length){case 0:return new n;case 1:return new n(o[0]);case 2:return new n(o[0],o[1]);case 3:return new n(o[0],o[1],o[2]);case 4:return new n(o[0],o[1],o[2],o[3]);case 5:return new n(o[0],o[1],o[2],o[3],o[4]);case 6:return new n(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new n(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var l=xi(n.prototype),d=n.apply(l,o);return Je(d)?d:l}}function qs(n){return function(o,l,d){var h=Ae(o);if(!Bt(o)){var f=H(l,3);o=gt(o),l=function(M){return f(h[M],M,h)}}var b=n(o,l,d);return b>-1?h[f?o[b]:b]:_}}function Rs(n){return mn(function(o){var l=o.length,d=l,h=Tt.prototype.thru;for(n&&o.reverse();d--;){var f=o[d];if("function"!=typeof f)throw new jt(Ne);if(h&&!b&&"wrapper"==Fo(f))var b=new Tt([],!0)}for(d=b?d:l;++d<l;){var M=Fo(f=o[d]),P="wrapper"==M?zr(f):_;b=P&&a(P[0])&&424==P[1]&&!P[4].length&&1==P[9]?b[Fo(P[0])].apply(b,P[3]):1==f.length&&a(f)?b[M]():b.thru(f)}return function(){var k=arguments,q=k[0];if(b&&1==k.length&&se(q))return b.plant(q).value();for(var L=0,j=l?o[L].apply(this,k):q;++L<l;)j=o[L].call(this,j);return j}})}function qo(n,o,l,d,h,f,b,M,P,k){var q=128&o,L=1&o,j=2&o,Y=24&o,$=512&o,me=j?_:wi(n);return function K(){for(var ve=arguments.length,be=y(ve),Xt=ve;Xt--;)be[Xt]=arguments[Xt];if(Y)var Et=Ti(K),en=Yl(be,Et);if(d&&(be=Jr(be,d,h,Y)),f&&(be=Is(be,f,b,Y)),ve-=en,Y&&ve<k){var $e=Tn(be,Et);return Fs(n,o,qo,K.placeholder,l,be,$e,M,P,k-ve)}var bn=L?l:this,ri=j?bn[n]:n;return ve=be.length,M?be=w(be,M):$&&ve>1&&be.reverse(),q&&P<ve&&(be.length=P),this&&this!==rt&&this instanceof K&&(ri=me||wi(ri)),ri.apply(bn,be)}}function Ls(n,o){return function(l,d){return function(n,o,l,d){return rn(n,function(h,f,b){o(d,l(h),f,b)}),d}(l,n,o(d),{})}}function Ro(n,o){return function(l,d){var h;if(l===_&&d===_)return o;if(l!==_&&(h=l),d!==_){if(h===_)return d;"string"==typeof l||"string"==typeof d?(l=Rt(l),d=Rt(d)):(l=Ms(l),d=Ms(d)),h=n(l,d)}return h}}function Br(n){return mn(function(o){return o=Re(o,ft(H())),ae(function(l){var d=this;return n(o,function(h){return Zt(h,d,l)})})})}function Lo(n,o){var l=(o=o===_?" ":Rt(o)).length;if(l<2)return l?qr(o,n):o;var d=qr(o,Co(n/bi(o)));return vi(o)?qn($t(d),0,n).join(""):d.slice(0,n)}function Es(n){return function(o,l,d){return d&&"number"!=typeof d&&bt(o,l,d)&&(l=d=_),o=oi(o),l===_?(l=o,o=0):l=oi(l),function(n,o,l,d){for(var h=-1,f=Ve(Co((o-n)/(l||1)),0),b=y(f);f--;)b[d?f:++h]=n,n+=l;return b}(o,l,d=d===_?o<l?1:-1:oi(d),n)}}function Eo(n){return function(o,l){return"string"==typeof o&&"string"==typeof l||(o=sn(o),l=sn(l)),n(o,l)}}function Fs(n,o,l,d,h,f,b,M,P,k){var q=8&o;o|=q?32:64,4&(o&=~(q?64:32))||(o&=-4);var me=[n,o,h,q?f:_,q?b:_,q?_:f,q?_:b,M,P,k],K=l.apply(_,me);return a(n)&&T(K,me),K.placeholder=d,E(K,n,o)}function Yr(n){var o=Qe[n];return function(l,d){if(l=sn(l),(d=null==d?0:pt(he(d),292))&&Xa(l)){var h=(Se(l)+"e").split("e");return+((h=(Se(o(h[0]+"e"+(+h[1]+d)))+"e").split("e"))[0]+"e"+(+h[1]-d))}return o(l)}}var ud=Oi&&1/po(new Oi([,-0]))[1]==On?function(n){return new Oi(n)}:Rd;function Ns(n){return function(o){var l=ht(o);return l==Ft?ur(o):l==At?function(x){var S=-1,y=Array(x.size);return x.forEach(function(U){y[++S]=[U,U]}),y}(o):function(x,S){return Re(S,function(y){return[y,x[y]]})}(o,n(o))}}function gn(n,o,l,d,h,f,b,M){var P=2&o;if(!P&&"function"!=typeof n)throw new jt(Ne);var k=d?d.length:0;if(k||(o&=-97,d=h=_),b=b===_?b:Ve(he(b),0),M=M===_?M:he(M),k-=h?h.length:0,64&o){var q=d,L=h;d=h=_}var j=P?_:zr(n),Y=[n,o,l,d,h,q,L,f,b,M];if(j&&function(n,o){var l=n[1],d=o[1],h=l|d;if(!(h<131||(128==d&&8==l||128==d&&256==l&&n[7].length<=o[8]||384==d&&o[7].length<=o[8]&&8==l)))return n;1&d&&(n[2]=o[2],h|=1&l?0:4);var M=o[3];if(M){var P=n[3];n[3]=P?Jr(P,M,o[4]):M,n[4]=P?Tn(n[3],ge):o[4]}(M=o[5])&&(n[5]=(P=n[5])?Is(P,M,o[6]):M,n[6]=P?Tn(n[5],ge):o[6]),(M=o[7])&&(n[7]=M),128&d&&(n[8]=null==n[8]?o[8]:pt(n[8],o[8])),null==n[9]&&(n[9]=o[9]),n[0]=o[0],n[1]=h}(Y,j),n=Y[0],o=Y[1],l=Y[2],d=Y[3],h=Y[4],!(M=Y[9]=Y[9]===_?P?0:n.length:Ve(Y[9]-k,0))&&24&o&&(o&=-25),o&&1!=o)$=8==o||16==o?function(n,o,l){var d=wi(n);return function h(){for(var f=arguments.length,b=y(f),M=f,P=Ti(h);M--;)b[M]=arguments[M];var k=f<3&&b[0]!==P&&b[f-1]!==P?[]:Tn(b,P);return(f-=k.length)<l?Fs(n,o,qo,h.placeholder,_,b,k,_,_,l-f):Zt(this&&this!==rt&&this instanceof h?d:n,this,b)}}(n,o,M):32!=o&&33!=o||h.length?qo.apply(_,Y):function(n,o,l,d){var h=1&o,f=wi(n);return function b(){for(var M=-1,P=arguments.length,k=-1,q=d.length,L=y(q+P),j=this&&this!==rt&&this instanceof b?f:n;++k<q;)L[k]=d[k];for(;P--;)L[k++]=arguments[++M];return Zt(j,h?l:this,L)}}(n,o,l,d);else var $=function(n,o,l){var d=1&o,h=wi(n);return function f(){return(this&&this!==rt&&this instanceof f?h:n).apply(d?l:this,arguments)}}(n,o,l);return E((j?Ao:T)($,Y),n,o)}function js(n,o,l,d){return n===_||vn(n,Ci[l])&&!Te.call(d,l)?o:n}function Us(n,o,l,d,h,f){return Je(n)&&Je(o)&&(f.set(o,n),Qi(n,o,_,Us,f),f.delete(o)),n}function hd(n){return ta(n)?_:n}function Js(n,o,l,d,h,f){var b=1&l,M=n.length,P=o.length;if(M!=P&&!(b&&P>M))return!1;var k=f.get(n),q=f.get(o);if(k&&q)return k==o&&q==n;var L=-1,j=!0,Y=2&l?new Hn:_;for(f.set(n,o),f.set(o,n);++L<M;){var $=n[L],me=o[L];if(d)var K=b?d(me,$,L,o,n,f):d($,me,L,n,o,f);if(K!==_){if(K)continue;j=!1;break}if(Y){if(!lr(o,function(ve,be){if(!_i(Y,be)&&($===ve||h($,ve,l,d,f)))return Y.push(be)})){j=!1;break}}else if($!==me&&!h($,me,l,d,f)){j=!1;break}}return f.delete(n),f.delete(o),j}function mn(n){return I(O(n,_,qe),n+"")}function Gr(n){return ut(n,gt,Vr)}function Hr(n){return ut(n,Yt,Bs)}var zr=xo?function(n){return xo.get(n)}:Rd;function Fo(n){for(var o=n.name+"",l=Mi[o],d=Te.call(Mi,o)?l.length:0;d--;){var h=l[d],f=h.func;if(null==f||f==n)return h.name}return o}function Ti(n){return(Te.call(g,"placeholder")?g:n).placeholder}function H(){var n=g.iteratee||kd;return n=n===kd?ms:n,arguments.length?n(arguments[0],arguments[1]):n}function No(n,o){var l=n.__data__;return function(n){var o=typeof n;return"string"==o||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n}(o)?l["string"==typeof o?"string":"hash"]:l.map}function Qr(n){for(var o=gt(n),l=o.length;l--;){var d=o[l],h=n[d];o[l]=[d,h,r(h)]}return o}function Vn(n,o){var l=function(x,S){return null==x?_:x[S]}(n,o);return hs(l)?l:_}var Vr=gr?function(n){return null==n?[]:(n=Ae(n),yn(gr(n),function(o){return Wa.call(n,o)}))}:Ld,Bs=gr?function(n){for(var o=[];n;)wn(o,Vr(n)),n=vo(n);return o}:Ld,ht=vt;function Ys(n,o,l){for(var d=-1,h=(o=kn(o,n)).length,f=!1;++d<h;){var b=z(o[d]);if(!(f=null!=n&&l(n,b)))break;n=n[b]}return f||++d!=h?f:!!(h=null==n?0:n.length)&&$s(h)&&fn(b,h)&&(se(n)||Xi(n))}function Gs(n){return"function"!=typeof n.constructor||i(n)?{}:xi(vo(n))}function Md(n){return se(n)||Xi(n)||!!($a&&n&&n[$a])}function fn(n,o){var l=typeof n;return!!(o=null==o?ln:o)&&("number"==l||"symbol"!=l&&Ge.test(n))&&n>-1&&n%1==0&&n<o}function bt(n,o,l){if(!Je(l))return!1;var d=typeof o;return!!("number"==d?Bt(l)&&fn(o,l.length):"string"==d&&o in l)&&vn(l[o],n)}function Wr(n,o){if(se(n))return!1;var l=typeof n;return!("number"!=l&&"symbol"!=l&&"boolean"!=l&&null!=n&&!Kt(n))||al.test(n)||!ha.test(n)||null!=o&&n in Ae(o)}function a(n){var o=Fo(n),l=g[o];if("function"!=typeof l||!(o in _e.prototype))return!1;if(n===l)return!0;var d=zr(l);return!!d&&n===d[0]}(mr&&ht(new mr(new ArrayBuffer(1)))!=En||Yn&&ht(new Yn)!=Ft||fr&&ht(fr.resolve())!=Go||Oi&&ht(new Oi)!=At||Ui&&ht(new Ui)!=pi)&&(ht=function(n){var o=vt(n),l=o==It?n.constructor:_,d=l?ne(l):"";if(d)switch(d){case gc:return En;case mc:return Ft;case fc:return Go;case _c:return At;case vc:return pi}return o});var t=ho?ii:Ed;function i(n){var o=n&&n.constructor;return n===("function"==typeof o&&o.prototype||Ci)}function r(n){return n==n&&!Je(n)}function s(n,o){return function(l){return null!=l&&l[n]===o&&(o!==_||n in Ae(l))}}function O(n,o,l){return o=Ve(o===_?n.length-1:o,0),function(){for(var d=arguments,h=-1,f=Ve(d.length-o,0),b=y(f);++h<f;)b[h]=d[o+h];h=-1;for(var M=y(o+1);++h<o;)M[h]=d[h];return M[o]=l(b),Zt(n,this,M)}}function v(n,o){return o.length<2?n:Qn(n,qt(o,0,-1))}function w(n,o){for(var l=n.length,d=pt(o.length,l),h=Dt(n);d--;){var f=o[d];n[d]=fn(f,l)?h[f]:_}return n}function D(n,o){if(("constructor"!==o||"function"!=typeof n[o])&&"__proto__"!=o)return n[o]}var T=F(Ao),R=cc||function(n,o){return rt.setTimeout(n,o)},I=F(Rr);function E(n,o,l){var d=o+"";return I(n,function(n,o){var l=o.length;if(!l)return n;var d=l-1;return o[d]=(l>1?"& ":"")+o[d],o=o.join(l>2?", ":" "),n.replace(ll,"{\n/* [wrapped with "+o+"] */\n")}(d,function(n,o){return Nt(aa,function(l){var d="_."+l[0];o&l[1]&&!so(n,d)&&n.push(d)}),n.sort()}(function(n){var o=n.match(cl);return o?o[1].split(ma):[]}(d),l)))}function F(n){var o=0,l=0;return function(){var d=es(),h=16-(d-l);if(l=d,h>0){if(++o>=800)return arguments[0]}else o=0;return n.apply(_,arguments)}}function G(n,o){var l=-1,d=n.length,h=d-1;for(o=o===_?d:o;++l<o;){var f=kr(l,h),b=n[f];n[f]=n[l],n[l]=b}return n.length=o,n}var o,l,re=(o=Vs(function(n){var o=[];return 46===n.charCodeAt(0)&&o.push(""),n.replace(ga,function(l,d,h,f){o.push(h?f.replace(pl,"$1"):d||l)}),o},function(d){return 500===l.size&&l.clear(),d}),l=o.cache,o);function z(n){if("string"==typeof n||Kt(n))return n;var o=n+"";return"0"==o&&1/n==-On?"-0":o}function ne(n){if(null!=n){try{return go.call(n)}catch(o){}try{return n+""}catch(o){}}return""}function X(n){if(n instanceof _e)return n.clone();var o=new Tt(n.__wrapped__,n.__chain__);return o.__actions__=Dt(n.__actions__),o.__index__=n.__index__,o.__values__=n.__values__,o}var ee=ae(function(n,o){return We(n)?Hi(n,lt(o,1,We,!0)):[]}),Me=ae(function(n,o){var l=it(o);return We(l)&&(l=_),We(n)?Hi(n,lt(o,1,We,!0),H(l,2)):[]}),Le=ae(function(n,o){var l=it(o);return We(l)&&(l=_),We(n)?Hi(n,lt(o,1,We,!0),_,l):[]});function De(n,o,l){var d=null==n?0:n.length;if(!d)return-1;var h=null==l?0:he(l);return h<0&&(h=Ve(d+h,0)),lo(n,H(o,3),h)}function te(n,o,l){var d=null==n?0:n.length;if(!d)return-1;var h=d-1;return l!==_&&(h=he(l),h=l<0?Ve(d+h,0):pt(h,d-1)),lo(n,H(o,3),h,!0)}function qe(n){return null!=n&&n.length?lt(n,1):[]}function Rn(n){return n&&n.length?n[0]:_}var Kn=ae(function(n){var o=Re(n,Nr);return o.length&&o[0]===n[0]?xr(o):[]}),Xn=ae(function(n){var o=it(n),l=Re(n,Nr);return o===it(l)?o=_:l.pop(),l.length&&l[0]===n[0]?xr(l,H(o,2)):[]}),ei=ae(function(n){var o=it(n),l=Re(n,Nr);return(o="function"==typeof o?o:_)&&l.pop(),l.length&&l[0]===n[0]?xr(l,_,o):[]});function it(n){var o=null==n?0:n.length;return o?n[o-1]:_}var $i=ae(jo);function jo(n,o){return n&&n.length&&o&&o.length?kt(n,o):n}var Xr=mn(function(n,o){var l=null==n?0:n.length,d=br(n,o);return vs(n,Re(o,function(h){return fn(h,l)?+h:h}).sort(Ss)),d});function Ki(n){return null==n?n:hc.call(n)}var Ap=ae(function(n){return Zn(lt(n,1,We,!0))}),Zp=ae(function(n){var o=it(n);return We(o)&&(o=_),Zn(lt(n,1,We,!0),H(o,2))}),kp=ae(function(n){var o=it(n);return o="function"==typeof o?o:_,Zn(lt(n,1,We,!0),_,o)});function Pd(n){if(!n||!n.length)return[];var o=0;return n=yn(n,function(l){if(We(l))return o=Ve(l.length,o),!0}),dr(o,function(l){return Re(n,Un(l))})}function Jd(n,o){if(!n||!n.length)return[];var l=Pd(n);return null==o?l:Re(l,function(d){return Zt(o,_,d)})}var Ep=ae(function(n,o){return We(n)?Hi(n,o):[]}),Fp=ae(function(n){return Wi(yn(n,We))}),Np=ae(function(n){var o=it(n);return We(o)&&(o=_),Wi(yn(n,We),H(o,2))}),jp=ae(function(n){var o=it(n);return o="function"==typeof o?o:_,Wi(yn(n,We),_,o)}),Up=ae(Pd),Yp=ae(function(n){var o=n.length,l=o>1?n[o-1]:_;return l="function"==typeof l?(n.pop(),l):_,Jd(n,l)});function Bd(n){var o=g(n);return o.__chain__=!0,o}function Hs(n,o){return o(n)}var Hp=mn(function(n){var o=n.length,l=o?n[0]:0,d=this.__wrapped__,h=function(f){return br(f,n)};return!(o>1||this.__actions__.length)&&d instanceof _e&&fn(l)?((d=d.slice(l,+l+(o?1:0))).__actions__.push({func:Hs,args:[h],thisArg:_}),new Tt(d,this.__chain__).thru(function(f){return o&&!f.length&&f.push(_),f})):this.thru(h)}),eu=et(function(n,o,l){Te.call(n,l)?++n[l]:hn(n,l,1)}),iu=qs(De),ou=qs(te);function Yd(n,o){return(se(n)?Nt:In)(n,H(o,3))}function Gd(n,o){return(se(n)?Ll:ds)(n,H(o,3))}var lu=et(function(n,o,l){Te.call(n,l)?n[l].push(o):hn(n,l,[o])}),du=ae(function(n,o,l){var d=-1,h="function"==typeof o,f=Bt(n)?y(n.length):[];return In(n,function(b){f[++d]=h?Zt(o,b,l):Pi(b,o,l)}),f}),pu=et(function(n,o,l){hn(n,l,o)});function zs(n,o){return(se(n)?Re:fs)(n,H(o,3))}var hu=et(function(n,o,l){n[l?0:1].push(o)},function(){return[[],[]]}),Mu=ae(function(n,o){if(null==n)return[];var l=o.length;return l>1&&bt(n,o[0],o[1])?o=[]:l>2&&bt(o[0],o[1],o[2])&&(o=[o[0]]),Io(n,lt(o,1),[])}),Qs=Ka||function(){return rt.Date.now()};function Hd(n,o,l){return o=l?_:o,gn(n,128,_,_,_,_,o=n&&null==o?n.length:o)}function zd(n,o){var l;if("function"!=typeof o)throw new jt(Ne);return n=he(n),function(){return--n>0&&(l=o.apply(this,arguments)),n<=1&&(o=_),l}}var yd=ae(function(n,o,l){var d=1;if(l.length){var h=Tn(l,Ti(yd));d|=32}return gn(n,d,o,l,h)}),Qd=ae(function(n,o,l){var d=3;if(l.length){var h=Tn(l,Ti(Qd));d|=32}return gn(o,d,n,l,h)});function $d(n,o,l){var d,h,f,b,M,P,k=0,q=!1,L=!1,j=!0;if("function"!=typeof n)throw new jt(Ne);function Y($e){var bn=d,ri=h;return d=h=_,k=$e,b=n.apply(ri,bn)}function $($e){return k=$e,M=R(ve,o),q?Y($e):b}function K($e){var bn=$e-P;return P===_||bn>=o||bn<0||L&&$e-k>=f}function ve(){var $e=Qs();if(K($e))return be($e);M=R(ve,function($e){var fp=o-($e-P);return L?pt(fp,f-($e-k)):fp}($e))}function be($e){return M=_,j&&d?Y($e):(d=h=_,b)}function en(){var $e=Qs(),bn=K($e);if(d=arguments,h=this,P=$e,bn){if(M===_)return $(P);if(L)return ws(M),M=R(ve,o),Y(P)}return M===_&&(M=R(ve,o)),b}return o=sn(o)||0,Je(l)&&(q=!!l.leading,f=(L="maxWait"in l)?Ve(sn(l.maxWait)||0,o):f,j="trailing"in l?!!l.trailing:j),en.cancel=function(){M!==_&&ws(M),k=0,d=P=h=M=_},en.flush=function(){return M===_?b:be(Qs())},en}var Pu=ae(function(n,o){return cs(n,1,o)}),yu=ae(function(n,o,l){return cs(n,sn(o)||0,l)});function Vs(n,o){if("function"!=typeof n||null!=o&&"function"!=typeof o)throw new jt(Ne);var l=function(){var d=arguments,h=o?o.apply(this,d):d[0],f=l.cache;if(f.has(h))return f.get(h);var b=n.apply(this,d);return l.cache=f.set(h,b)||f,b};return l.cache=new(Vs.Cache||un),l}function Ws(n){if("function"!=typeof n)throw new jt(Ne);return function(){var o=arguments;switch(o.length){case 0:return!n.call(this);case 1:return!n.call(this,o[0]);case 2:return!n.call(this,o[0],o[1]);case 3:return!n.call(this,o[0],o[1],o[2])}return!n.apply(this,o)}}Vs.Cache=un;var Du=nd(function(n,o){var l=(o=1==o.length&&se(o[0])?Re(o[0],ft(H())):Re(lt(o,1),ft(H()))).length;return ae(function(d){for(var h=-1,f=pt(d.length,l);++h<f;)d[h]=o[h].call(this,d[h]);return Zt(n,this,d)})}),wd=ae(function(n,o){var l=Tn(o,Ti(wd));return gn(n,32,_,o,l)}),Kd=ae(function(n,o){var l=Tn(o,Ti(Kd));return gn(n,64,_,o,l)}),Su=mn(function(n,o){return gn(n,256,_,_,_,o)});function vn(n,o){return n===o||n!=n&&o!=o}var Uu=Eo(Mr),Ju=Eo(function(n,o){return n>=o}),Xi=Pr(function(){return arguments}())?Pr:function(n){return ze(n)&&Te.call(n,"callee")&&!Wa.call(n,"callee")},se=y.isArray,Bu=ir?ft(ir):function(n){return ze(n)&&vt(n)==Pn};function Bt(n){return null!=n&&$s(n.length)&&!ii(n)}function We(n){return ze(n)&&Bt(n)}var Di=dc||Ed,Gu=or?ft(or):function(n){return ze(n)&&vt(n)==ci};function Td(n){if(!ze(n))return!1;var o=vt(n);return o==xn||"[object DOMException]"==o||"string"==typeof n.message&&"string"==typeof n.name&&!ta(n)}function ii(n){if(!Je(n))return!1;var o=vt(n);return o==Ai||o==Yo||"[object AsyncFunction]"==o||"[object Proxy]"==o}function Xd(n){return"number"==typeof n&&n==he(n)}function $s(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=ln}function Je(n){var o=typeof n;return null!=n&&("object"==o||"function"==o)}function ze(n){return null!=n&&"object"==typeof n}var ep=Ra?ft(Ra):function(n){return ze(n)&&ht(n)==Ft};function tp(n){return"number"==typeof n||ze(n)&&vt(n)==Zi}function ta(n){if(!ze(n)||vt(n)!=It)return!1;var o=vo(n);if(null===o)return!0;var l=Te.call(o,"constructor")&&o.constructor;return"function"==typeof l&&l instanceof l&&go.call(l)==sc}var Dd=La?ft(La):function(n){return ze(n)&&vt(n)==ki},np=mi?ft(mi):function(n){return ze(n)&&ht(n)==At};function Ks(n){return"string"==typeof n||!se(n)&&ze(n)&&vt(n)==di}function Kt(n){return"symbol"==typeof n||ze(n)&&vt(n)==qi}var Uo=rr?ft(rr):function(n){return ze(n)&&$s(n.length)&&!!Ie[vt(n)]},sh=Eo(Dr),lh=Eo(function(n,o){return n<=o});function ip(n){if(!n)return[];if(Bt(n))return Ks(n)?$t(n):Dt(n);if(ji&&n[ji])return function(x){for(var S,y=[];!(S=x.next()).done;)y.push(S.value);return y}(n[ji]());var o=ht(n);return(o==Ft?ur:o==At?po:Jo)(n)}function oi(n){return n?(n=sn(n))===On||n===-On?17976931348623157e292*(n<0?-1:1):n==n?n:0:0===n?n:0}function he(n){var o=oi(n),l=o%1;return o==o?l?o-l:o:0}function op(n){return n?zn(he(n),0,Qt):0}function sn(n){if("number"==typeof n)return n;if(Kt(n))return NaN;if(Je(n)){var o="function"==typeof n.valueOf?n.valueOf():n;n=Je(o)?o+"":o}if("string"!=typeof n)return 0===n?n:+n;n=Ua(n);var l=dt.test(n);return l||Nn.test(n)?kl(n.slice(2),l?2:8):Vt.test(n)?NaN:+n}function rp(n){return an(n,Yt(n))}function Se(n){return null==n?"":Rt(n)}var dh=Jt(function(n,o){if(i(o)||Bt(o))an(o,gt(o),n);else for(var l in o)Te.call(o,l)&&Gi(n,l,o[l])}),ap=Jt(function(n,o){an(o,Yt(o),n)}),Xs=Jt(function(n,o,l,d){an(o,Yt(o),n,d)}),ph=Jt(function(n,o,l,d){an(o,gt(o),n,d)}),uh=mn(br),gh=ae(function(n,o){n=Ae(n);var l=-1,d=o.length,h=d>2?o[2]:_;for(h&&bt(o[0],o[1],h)&&(d=1);++l<d;)for(var f=o[l],b=Yt(f),M=-1,P=b.length;++M<P;){var k=b[M],q=n[k];(q===_||vn(q,Ci[k])&&!Te.call(n,k))&&(n[k]=f[k])}return n}),mh=ae(function(n){return n.push(_,Us),Zt(sp,_,n)});function Sd(n,o,l){var d=null==n?_:Qn(n,o);return d===_?l:d}function Id(n,o){return null!=n&&Ys(n,o,zc)}var yh=Ls(function(n,o,l){null!=o&&"function"!=typeof o.toString&&(o=mo.call(o)),n[o]=l},Zd(Gt)),wh=Ls(function(n,o,l){null!=o&&"function"!=typeof o.toString&&(o=mo.call(o)),Te.call(n,o)?n[o].push(l):n[o]=[l]},H),Th=ae(Pi);function gt(n){return Bt(n)?rs(n):Tr(n)}function Yt(n){return Bt(n)?rs(n,!0):function(n){if(!Je(n))return function(n){var o=[];if(null!=n)for(var l in Ae(n))o.push(l);return o}(n);var o=i(n),l=[];for(var d in n)"constructor"==d&&(o||!Te.call(n,d))||l.push(d);return l}(n)}var Ih=Jt(function(n,o,l){Qi(n,o,l)}),sp=Jt(function(n,o,l,d){Qi(n,o,l,d)}),Ah=mn(function(n,o){var l={};if(null==n)return l;var d=!1;o=Re(o,function(f){return f=kn(f,n),d||(d=f.length>1),f}),an(n,Hr(n),l),d&&(l=Ut(l,7,hd));for(var h=o.length;h--;)Fr(l,o[h]);return l}),kh=mn(function(n,o){return null==n?{}:function(n,o){return Ar(n,o,function(l,d){return Id(n,d)})}(n,o)});function lp(n,o){if(null==n)return{};var l=Re(Hr(n),function(d){return[d]});return o=H(o),Ar(n,l,function(d,h){return o(d,h[0])})}var cp=Ns(gt),dp=Ns(Yt);function Jo(n){return null==n?[]:pr(n,gt(n))}var Gh=yi(function(n,o,l){return o=o.toLowerCase(),n+(l?pp(o):o)});function pp(n){return Ad(Se(n).toLowerCase())}function up(n){return(n=Se(n))&&n.replace(fa,Gl).replace(Pl,"")}var Vh=yi(function(n,o,l){return n+(l?"-":"")+o.toLowerCase()}),Wh=yi(function(n,o,l){return n+(l?" ":"")+o.toLowerCase()}),$h=ks("toLowerCase"),og=yi(function(n,o,l){return n+(l?"_":"")+o.toLowerCase()}),ag=yi(function(n,o,l){return n+(l?" ":"")+Ad(o)}),fg=yi(function(n,o,l){return n+(l?" ":"")+o.toUpperCase()}),Ad=ks("toUpperCase");function hp(n,o,l){return n=Se(n),(o=l?_:o)===_?function(x){return Tl.test(x)}(n)?function(x){return x.match(yl)||[]}(n):function(x){return x.match(Fn)||[]}(n):n.match(o)||[]}var gp=ae(function(n,o){try{return Zt(n,_,o)}catch(l){return Td(l)?l:new oe(l)}}),_g=mn(function(n,o){return Nt(o,function(l){l=z(l),hn(n,l,yd(n[l],n))}),n});function Zd(n){return function(){return n}}var Og=Rs(),Mg=Rs(!0);function Gt(n){return n}function kd(n){return ms("function"==typeof n?n:Ut(n,1))}var yg=ae(function(n,o){return function(l){return Pi(l,n,o)}}),wg=ae(function(n,o){return function(l){return Pi(n,l,o)}});function qd(n,o,l){var d=gt(o),h=To(o,d);null==l&&(!Je(o)||!h.length&&d.length)&&(l=o,o=n,n=this,h=To(o,gt(o)));var f=!(Je(l)&&"chain"in l&&!l.chain),b=ii(n);return Nt(h,function(M){var P=o[M];n[M]=P,b&&(n.prototype[M]=function(){var k=this.__chain__;if(f||k){var q=n(this.__wrapped__),L=q.__actions__=Dt(this.__actions__);return L.push({func:P,args:arguments,thisArg:n}),q.__chain__=k,q}return P.apply(n,wn([this.value()],arguments))})}),n}function Rd(){}var Sg=Br(Re),Ig=Br(Ea),Ag=Br(lr);function mp(n){return Wr(n)?Un(z(n)):function(n){return function(o){return Qn(o,n)}}(n)}var kg=Es(),qg=Es(!0);function Ld(){return[]}function Ed(){return!1}var Ug=Ro(function(n,o){return n+o},0),Jg=Yr("ceil"),Bg=Ro(function(n,o){return n/o},1),Yg=Yr("floor"),$g=Ro(function(n,o){return n*o},1),Kg=Yr("round"),Xg=Ro(function(n,o){return n-o},0);return g.after=function(n,o){if("function"!=typeof o)throw new jt(Ne);return n=he(n),function(){if(--n<1)return o.apply(this,arguments)}},g.ary=Hd,g.assign=dh,g.assignIn=ap,g.assignInWith=Xs,g.assignWith=ph,g.at=uh,g.before=zd,g.bind=yd,g.bindAll=_g,g.bindKey=Qd,g.castArray=function(){if(!arguments.length)return[];var n=arguments[0];return se(n)?n:[n]},g.chain=Bd,g.chunk=function(n,o,l){o=(l?bt(n,o,l):o===_)?1:Ve(he(o),0);var d=null==n?0:n.length;if(!d||o<1)return[];for(var h=0,f=0,b=y(Co(d/o));h<d;)b[f++]=qt(n,h,h+=o);return b},g.compact=function(n){for(var o=-1,l=null==n?0:n.length,d=0,h=[];++o<l;){var f=n[o];f&&(h[d++]=f)}return h},g.concat=function(){var n=arguments.length;if(!n)return[];for(var o=y(n-1),l=arguments[0],d=n;d--;)o[d-1]=arguments[d];return wn(se(l)?Dt(l):[l],lt(o,1))},g.cond=function(n){var o=null==n?0:n.length,l=H();return n=o?Re(n,function(d){if("function"!=typeof d[1])throw new jt(Ne);return[l(d[0]),d[1]]}):[],ae(function(d){for(var h=-1;++h<o;){var f=n[h];if(Zt(f[0],this,d))return Zt(f[1],this,d)}})},g.conforms=function(n){return function(n){var o=gt(n);return function(l){return ls(l,n,o)}}(Ut(n,1))},g.constant=Zd,g.countBy=eu,g.create=function(n,o){var l=xi(n);return null==o?l:ss(l,o)},g.curry=function Vd(n,o,l){var d=gn(n,8,_,_,_,_,_,o=l?_:o);return d.placeholder=Vd.placeholder,d},g.curryRight=function Wd(n,o,l){var d=gn(n,16,_,_,_,_,_,o=l?_:o);return d.placeholder=Wd.placeholder,d},g.debounce=$d,g.defaults=gh,g.defaultsDeep=mh,g.defer=Pu,g.delay=yu,g.difference=ee,g.differenceBy=Me,g.differenceWith=Le,g.drop=function(n,o,l){var d=null==n?0:n.length;return d?qt(n,(o=l||o===_?1:he(o))<0?0:o,d):[]},g.dropRight=function(n,o,l){var d=null==n?0:n.length;return d?qt(n,0,(o=d-(o=l||o===_?1:he(o)))<0?0:o):[]},g.dropRightWhile=function(n,o){return n&&n.length?ko(n,H(o,3),!0,!0):[]},g.dropWhile=function(n,o){return n&&n.length?ko(n,H(o,3),!0):[]},g.fill=function(n,o,l,d){var h=null==n?0:n.length;return h?(l&&"number"!=typeof l&&bt(n,o,l)&&(l=0,d=h),function(n,o,l,d){var h=n.length;for((l=he(l))<0&&(l=-l>h?0:h+l),(d=d===_||d>h?h:he(d))<0&&(d+=h),d=l>d?0:op(d);l<d;)n[l++]=o;return n}(n,o,l,d)):[]},g.filter=function(n,o){return(se(n)?yn:ps)(n,H(o,3))},g.flatMap=function(n,o){return lt(zs(n,o),1)},g.flatMapDeep=function(n,o){return lt(zs(n,o),On)},g.flatMapDepth=function(n,o,l){return l=l===_?1:he(l),lt(zs(n,o),l)},g.flatten=qe,g.flattenDeep=function(n){return null!=n&&n.length?lt(n,On):[]},g.flattenDepth=function(n,o){return null!=n&&n.length?lt(n,o=o===_?1:he(o)):[]},g.flip=function(n){return gn(n,512)},g.flow=Og,g.flowRight=Mg,g.fromPairs=function(n){for(var o=-1,l=null==n?0:n.length,d={};++o<l;){var h=n[o];d[h[0]]=h[1]}return d},g.functions=function(n){return null==n?[]:To(n,gt(n))},g.functionsIn=function(n){return null==n?[]:To(n,Yt(n))},g.groupBy=lu,g.initial=function(n){return null!=n&&n.length?qt(n,0,-1):[]},g.intersection=Kn,g.intersectionBy=Xn,g.intersectionWith=ei,g.invert=yh,g.invertBy=wh,g.invokeMap=du,g.iteratee=kd,g.keyBy=pu,g.keys=gt,g.keysIn=Yt,g.map=zs,g.mapKeys=function(n,o){var l={};return o=H(o,3),rn(n,function(d,h,f){hn(l,o(d,h,f),d)}),l},g.mapValues=function(n,o){var l={};return o=H(o,3),rn(n,function(d,h,f){hn(l,h,o(d,h,f))}),l},g.matches=function(n){return _s(Ut(n,1))},g.matchesProperty=function(n,o){return Sr(n,Ut(o,1))},g.memoize=Vs,g.merge=Ih,g.mergeWith=sp,g.method=yg,g.methodOf=wg,g.mixin=qd,g.negate=Ws,g.nthArg=function(n){return n=he(n),ae(function(o){return So(o,n)})},g.omit=Ah,g.omitBy=function(n,o){return lp(n,Ws(H(o)))},g.once=function(n){return zd(2,n)},g.orderBy=function(n,o,l,d){return null==n?[]:(se(o)||(o=null==o?[]:[o]),se(l=d?_:l)||(l=null==l?[]:[l]),Io(n,o,l))},g.over=Sg,g.overArgs=Du,g.overEvery=Ig,g.overSome=Ag,g.partial=wd,g.partialRight=Kd,g.partition=hu,g.pick=kh,g.pickBy=lp,g.property=mp,g.propertyOf=function(n){return function(o){return null==n?_:Qn(n,o)}},g.pull=$i,g.pullAll=jo,g.pullAllBy=function(n,o,l){return n&&n.length&&o&&o.length?kt(n,o,H(l,2)):n},g.pullAllWith=function(n,o,l){return n&&n.length&&o&&o.length?kt(n,o,_,l):n},g.pullAt=Xr,g.range=kg,g.rangeRight=qg,g.rearg=Su,g.reject=function(n,o){return(se(n)?yn:ps)(n,Ws(H(o,3)))},g.remove=function(n,o){var l=[];if(!n||!n.length)return l;var d=-1,h=[],f=n.length;for(o=H(o,3);++d<f;){var b=n[d];o(b,d,n)&&(l.push(b),h.push(d))}return vs(n,h),l},g.rest=function(n,o){if("function"!=typeof n)throw new jt(Ne);return ae(n,o=o===_?o:he(o))},g.reverse=Ki,g.sampleSize=function(n,o,l){return o=(l?bt(n,o,l):o===_)?1:he(o),(se(n)?Nc:td)(n,o)},g.set=function(n,o,l){return null==n?n:Vi(n,o,l)},g.setWith=function(n,o,l,d){return d="function"==typeof d?d:_,null==n?n:Vi(n,o,l,d)},g.shuffle=function(n){return(se(n)?jc:Cs)(n)},g.slice=function(n,o,l){var d=null==n?0:n.length;return d?(l&&"number"!=typeof l&&bt(n,o,l)?(o=0,l=d):(o=null==o?0:he(o),l=l===_?d:he(l)),qt(n,o,l)):[]},g.sortBy=Mu,g.sortedUniq=function(n){return n&&n.length?Er(n):[]},g.sortedUniqBy=function(n,o){return n&&n.length?Er(n,H(o,2)):[]},g.split=function(n,o,l){return l&&"number"!=typeof l&&bt(n,o,l)&&(o=l=_),(l=l===_?Qt:l>>>0)?(n=Se(n))&&("string"==typeof o||null!=o&&!Dd(o))&&!(o=Rt(o))&&vi(n)?qn($t(n),0,l):n.split(o,l):[]},g.spread=function(n,o){if("function"!=typeof n)throw new jt(Ne);return o=null==o?0:Ve(he(o),0),ae(function(l){var d=l[o],h=qn(l,0,o);return d&&wn(h,d),Zt(n,this,h)})},g.tail=function(n){var o=null==n?0:n.length;return o?qt(n,1,o):[]},g.take=function(n,o,l){return n&&n.length?qt(n,0,(o=l||o===_?1:he(o))<0?0:o):[]},g.takeRight=function(n,o,l){var d=null==n?0:n.length;return d?qt(n,(o=d-(o=l||o===_?1:he(o)))<0?0:o,d):[]},g.takeRightWhile=function(n,o){return n&&n.length?ko(n,H(o,3),!1,!0):[]},g.takeWhile=function(n,o){return n&&n.length?ko(n,H(o,3)):[]},g.tap=function(n,o){return o(n),n},g.throttle=function(n,o,l){var d=!0,h=!0;if("function"!=typeof n)throw new jt(Ne);return Je(l)&&(d="leading"in l?!!l.leading:d,h="trailing"in l?!!l.trailing:h),$d(n,o,{leading:d,maxWait:o,trailing:h})},g.thru=Hs,g.toArray=ip,g.toPairs=cp,g.toPairsIn=dp,g.toPath=function(n){return se(n)?Re(n,z):Kt(n)?[n]:Dt(re(Se(n)))},g.toPlainObject=rp,g.transform=function(n,o,l){var d=se(n),h=d||Di(n)||Uo(n);if(o=H(o,4),null==l){var f=n&&n.constructor;l=h?d?new f:[]:Je(n)&&ii(f)?xi(vo(n)):{}}return(h?Nt:rn)(n,function(b,M,P){return o(l,b,M,P)}),l},g.unary=function(n){return Hd(n,1)},g.union=Ap,g.unionBy=Zp,g.unionWith=kp,g.uniq=function(n){return n&&n.length?Zn(n):[]},g.uniqBy=function(n,o){return n&&n.length?Zn(n,H(o,2)):[]},g.uniqWith=function(n,o){return o="function"==typeof o?o:_,n&&n.length?Zn(n,_,o):[]},g.unset=function(n,o){return null==n||Fr(n,o)},g.unzip=Pd,g.unzipWith=Jd,g.update=function(n,o,l){return null==n?n:xs(n,o,jr(l))},g.updateWith=function(n,o,l,d){return d="function"==typeof d?d:_,null==n?n:xs(n,o,jr(l),d)},g.values=Jo,g.valuesIn=function(n){return null==n?[]:pr(n,Yt(n))},g.without=Ep,g.words=hp,g.wrap=function(n,o){return wd(jr(o),n)},g.xor=Fp,g.xorBy=Np,g.xorWith=jp,g.zip=Up,g.zipObject=function(n,o){return ys(n||[],o||[],Gi)},g.zipObjectDeep=function(n,o){return ys(n||[],o||[],Vi)},g.zipWith=Yp,g.entries=cp,g.entriesIn=dp,g.extend=ap,g.extendWith=Xs,qd(g,g),g.add=Ug,g.attempt=gp,g.camelCase=Gh,g.capitalize=pp,g.ceil=Jg,g.clamp=function(n,o,l){return l===_&&(l=o,o=_),l!==_&&(l=(l=sn(l))==l?l:0),o!==_&&(o=(o=sn(o))==o?o:0),zn(sn(n),o,l)},g.clone=function(n){return Ut(n,4)},g.cloneDeep=function(n){return Ut(n,5)},g.cloneDeepWith=function(n,o){return Ut(n,5,o="function"==typeof o?o:_)},g.cloneWith=function(n,o){return Ut(n,4,o="function"==typeof o?o:_)},g.conformsTo=function(n,o){return null==o||ls(n,o,gt(o))},g.deburr=up,g.defaultTo=function(n,o){return null==n||n!=n?o:n},g.divide=Bg,g.endsWith=function(n,o,l){n=Se(n),o=Rt(o);var d=n.length,h=l=l===_?d:zn(he(l),0,d);return(l-=o.length)>=0&&n.slice(l,h)==o},g.eq=vn,g.escape=function(n){return(n=Se(n))&&pa.test(n)?n.replace(Vo,Hl):n},g.escapeRegExp=function(n){return(n=Se(n))&&Be.test(n)?n.replace(Xe,"\\$&"):n},g.every=function(n,o,l){var d=se(n)?Ea:Yc;return l&&bt(n,o,l)&&(o=_),d(n,H(o,3))},g.find=iu,g.findIndex=De,g.findKey=function(n,o){return Fa(n,H(o,3),rn)},g.findLast=ou,g.findLastIndex=te,g.findLastKey=function(n,o){return Fa(n,H(o,3),Or)},g.floor=Yg,g.forEach=Yd,g.forEachRight=Gd,g.forIn=function(n,o){return null==n?n:Cr(n,H(o,3),Yt)},g.forInRight=function(n,o){return null==n?n:us(n,H(o,3),Yt)},g.forOwn=function(n,o){return n&&rn(n,H(o,3))},g.forOwnRight=function(n,o){return n&&Or(n,H(o,3))},g.get=Sd,g.gt=Uu,g.gte=Ju,g.has=function(n,o){return null!=n&&Ys(n,o,Hc)},g.hasIn=Id,g.head=Rn,g.identity=Gt,g.includes=function(n,o,l,d){n=Bt(n)?n:Jo(n),l=l&&!d?he(l):0;var h=n.length;return l<0&&(l=Ve(h+l,0)),Ks(n)?l<=h&&n.indexOf(o,l)>-1:!!h&&fi(n,o,l)>-1},g.indexOf=function(n,o,l){var d=null==n?0:n.length;if(!d)return-1;var h=null==l?0:he(l);return h<0&&(h=Ve(d+h,0)),fi(n,o,h)},g.inRange=function(n,o,l){return o=oi(o),l===_?(l=o,o=0):l=oi(l),function(n,o,l){return n>=pt(o,l)&&n<Ve(o,l)}(n=sn(n),o,l)},g.invoke=Th,g.isArguments=Xi,g.isArray=se,g.isArrayBuffer=Bu,g.isArrayLike=Bt,g.isArrayLikeObject=We,g.isBoolean=function(n){return!0===n||!1===n||ze(n)&&vt(n)==Mn},g.isBuffer=Di,g.isDate=Gu,g.isElement=function(n){return ze(n)&&1===n.nodeType&&!ta(n)},g.isEmpty=function(n){if(null==n)return!0;if(Bt(n)&&(se(n)||"string"==typeof n||"function"==typeof n.splice||Di(n)||Uo(n)||Xi(n)))return!n.length;var o=ht(n);if(o==Ft||o==At)return!n.size;if(i(n))return!Tr(n).length;for(var l in n)if(Te.call(n,l))return!1;return!0},g.isEqual=function(n,o){return zi(n,o)},g.isEqualWith=function(n,o,l){var d=(l="function"==typeof l?l:_)?l(n,o):_;return d===_?zi(n,o,_,l):!!d},g.isError=Td,g.isFinite=function(n){return"number"==typeof n&&Xa(n)},g.isFunction=ii,g.isInteger=Xd,g.isLength=$s,g.isMap=ep,g.isMatch=function(n,o){return n===o||yr(n,o,Qr(o))},g.isMatchWith=function(n,o,l){return l="function"==typeof l?l:_,yr(n,o,Qr(o),l)},g.isNaN=function(n){return tp(n)&&n!=+n},g.isNative=function(n){if(t(n))throw new oe("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return hs(n)},g.isNil=function(n){return null==n},g.isNull=function(n){return null===n},g.isNumber=tp,g.isObject=Je,g.isObjectLike=ze,g.isPlainObject=ta,g.isRegExp=Dd,g.isSafeInteger=function(n){return Xd(n)&&n>=-ln&&n<=ln},g.isSet=np,g.isString=Ks,g.isSymbol=Kt,g.isTypedArray=Uo,g.isUndefined=function(n){return n===_},g.isWeakMap=function(n){return ze(n)&&ht(n)==pi},g.isWeakSet=function(n){return ze(n)&&"[object WeakSet]"==vt(n)},g.join=function(n,o){return null==n?"":Mo.call(n,o)},g.kebabCase=Vh,g.last=it,g.lastIndexOf=function(n,o,l){var d=null==n?0:n.length;if(!d)return-1;var h=d;return l!==_&&(h=(h=he(l))<0?Ve(d+h,0):pt(h,d-1)),o==o?function(x,S,y){for(var U=y+1;U--;)if(x[U]===S)return U;return U}(n,o,h):lo(n,Na,h,!0)},g.lowerCase=Wh,g.lowerFirst=$h,g.lt=sh,g.lte=lh,g.max=function(n){return n&&n.length?wo(n,Gt,Mr):_},g.maxBy=function(n,o){return n&&n.length?wo(n,H(o,2),Mr):_},g.mean=function(n){return ja(n,Gt)},g.meanBy=function(n,o){return ja(n,H(o,2))},g.min=function(n){return n&&n.length?wo(n,Gt,Dr):_},g.minBy=function(n,o){return n&&n.length?wo(n,H(o,2),Dr):_},g.stubArray=Ld,g.stubFalse=Ed,g.stubObject=function(){return{}},g.stubString=function(){return""},g.stubTrue=function(){return!0},g.multiply=$g,g.nth=function(n,o){return n&&n.length?So(n,he(o)):_},g.noConflict=function(){return rt._===this&&(rt._=Ha),this},g.noop=Rd,g.now=Qs,g.pad=function(n,o,l){n=Se(n);var d=(o=he(o))?bi(n):0;if(!o||d>=o)return n;var h=(o-d)/2;return Lo(Oo(h),l)+n+Lo(Co(h),l)},g.padEnd=function(n,o,l){n=Se(n);var d=(o=he(o))?bi(n):0;return o&&d<o?n+Lo(o-d,l):n},g.padStart=function(n,o,l){n=Se(n);var d=(o=he(o))?bi(n):0;return o&&d<o?Lo(o-d,l)+n:n},g.parseInt=function(n,o,l){return l||null==o?o=0:o&&(o=+o),uc(Se(n).replace(we,""),o||0)},g.random=function(n,o,l){if(l&&"boolean"!=typeof l&&bt(n,o,l)&&(o=l=_),l===_&&("boolean"==typeof o?(l=o,o=_):"boolean"==typeof n&&(l=n,n=_)),n===_&&o===_?(n=0,o=1):(n=oi(n),o===_?(o=n,n=0):o=oi(o)),n>o){var d=n;n=o,o=d}if(l||n%1||o%1){var h=ts();return pt(n+h*(o-n+Zl("1e-"+((h+"").length-1))),o)}return kr(n,o)},g.reduce=function(n,o,l){var d=se(n)?sr:Wt,h=arguments.length<3;return d(n,H(o,4),l,h,In)},g.reduceRight=function(n,o,l){var d=se(n)?El:Wt,h=arguments.length<3;return d(n,H(o,4),l,h,ds)},g.repeat=function(n,o,l){return o=(l?bt(n,o,l):o===_)?1:he(o),qr(Se(n),o)},g.replace=function(){var n=arguments,o=Se(n[0]);return n.length<3?o:o.replace(n[1],n[2])},g.result=function(n,o,l){var d=-1,h=(o=kn(o,n)).length;for(h||(h=1,n=_);++d<h;){var f=null==n?_:n[z(o[d])];f===_&&(d=h,f=l),n=ii(f)?f.call(n):f}return n},g.round=Kg,g.runInContext=x,g.sample=function(n){return(se(n)?as:bs)(n)},g.size=function(n){if(null==n)return 0;if(Bt(n))return Ks(n)?bi(n):n.length;var o=ht(n);return o==Ft||o==At?n.size:Tr(n).length},g.snakeCase=og,g.some=function(n,o,l){var d=se(n)?lr:Os;return l&&bt(n,o,l)&&(o=_),d(n,H(o,3))},g.sortedIndex=function(n,o){return Zo(n,o)},g.sortedIndexBy=function(n,o,l){return Lr(n,o,H(l,2))},g.sortedIndexOf=function(n,o){var l=null==n?0:n.length;if(l){var d=Zo(n,o);if(d<l&&vn(n[d],o))return d}return-1},g.sortedLastIndex=function(n,o){return Zo(n,o,!0)},g.sortedLastIndexBy=function(n,o,l){return Lr(n,o,H(l,2),!0)},g.sortedLastIndexOf=function(n,o){if(null!=n&&n.length){var d=Zo(n,o,!0)-1;if(vn(n[d],o))return d}return-1},g.startCase=ag,g.startsWith=function(n,o,l){return n=Se(n),l=null==l?0:zn(he(l),0,n.length),o=Rt(o),n.slice(l,l+o.length)==o},g.subtract=Xg,g.sum=function(n){return n&&n.length?cr(n,Gt):0},g.sumBy=function(n,o){return n&&n.length?cr(n,H(o,2)):0},g.template=function(n,o,l){var d=g.templateSettings;l&&bt(n,o,l)&&(o=_),n=Se(n),o=Xs({},o,d,js);var M,P,h=Xs({},o.imports,d.imports,js),f=gt(h),b=pr(h,f),k=0,q=o.interpolate||A,L="__p += '",j=hr((o.escape||A).source+"|"+q.source+"|"+(q===ua?ul:A).source+"|"+(o.evaluate||A).source+"|$","g"),Y="//# sourceURL="+(Te.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Sl+"]")+"\n";n.replace(j,function(K,ve,be,Xt,Et,en){return be||(be=Xt),L+=n.slice(k,en).replace(hl,zl),ve&&(M=!0,L+="' +\n__e("+ve+") +\n'"),Et&&(P=!0,L+="';\n"+Et+";\n__p += '"),be&&(L+="' +\n((__t = ("+be+")) == null ? '' : __t) +\n'"),k=en+K.length,K}),L+="';\n";var $=Te.call(o,"variable")&&o.variable;if($){if(dl.test($))throw new oe("Invalid `variable` option passed into `_.template`")}else L="with (obj) {\n"+L+"\n}\n";L=(P?L.replace(nl,""):L).replace(il,"$1").replace(Qo,"$1;"),L="function("+($||"obj")+") {\n"+($?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(M?", __e = _.escape":"")+(P?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+L+"return __p\n}";var me=gp(function(){return xe(f,Y+"return "+L).apply(_,b)});if(me.source=L,Td(me))throw me;return me},g.times=function(n,o){if((n=he(n))<1||n>ln)return[];var l=Qt,d=pt(n,Qt);o=H(o),n-=Qt;for(var h=dr(d,o);++l<n;)o(l);return h},g.toFinite=oi,g.toInteger=he,g.toLength=op,g.toLower=function(n){return Se(n).toLowerCase()},g.toNumber=sn,g.toSafeInteger=function(n){return n?zn(he(n),-ln,ln):0===n?n:0},g.toString=Se,g.toUpper=function(n){return Se(n).toUpperCase()},g.trim=function(n,o,l){if((n=Se(n))&&(l||o===_))return Ua(n);if(!n||!(o=Rt(o)))return n;var d=$t(n),h=$t(o);return qn(d,Ja(d,h),co(d,h)+1).join("")},g.trimEnd=function(n,o,l){if((n=Se(n))&&(l||o===_))return n.slice(0,Ya(n)+1);if(!n||!(o=Rt(o)))return n;var d=$t(n);return qn(d,0,co(d,$t(o))+1).join("")},g.trimStart=function(n,o,l){if((n=Se(n))&&(l||o===_))return n.replace(we,"");if(!n||!(o=Rt(o)))return n;var d=$t(n);return qn(d,Ja(d,$t(o))).join("")},g.truncate=function(n,o){var l=30,d="...";if(Je(o)){var h="separator"in o?o.separator:h;l="length"in o?he(o.length):l,d="omission"in o?Rt(o.omission):d}var f=(n=Se(n)).length;if(vi(n)){var b=$t(n);f=b.length}if(l>=f)return n;var M=l-bi(d);if(M<1)return d;var P=b?qn(b,0,M).join(""):n.slice(0,M);if(h===_)return P+d;if(b&&(M+=P.length-M),Dd(h)){if(n.slice(M).search(h)){var k,q=P;for(h.global||(h=hr(h.source,Se(Ze.exec(h))+"g")),h.lastIndex=0;k=h.exec(q);)var L=k.index;P=P.slice(0,L===_?M:L)}}else if(n.indexOf(Rt(h),M)!=M){var j=P.lastIndexOf(h);j>-1&&(P=P.slice(0,j))}return P+d},g.unescape=function(n){return(n=Se(n))&&Nd.test(n)?n.replace(ol,ec):n},g.uniqueId=function(n){var o=++ac;return Se(n)+o},g.upperCase=fg,g.upperFirst=Ad,g.each=Yd,g.eachRight=Gd,g.first=Rn,qd(g,function(){var n={};return rn(g,function(o,l){Te.call(g.prototype,l)||(n[l]=o)}),n}(),{chain:!1}),g.VERSION="4.17.21",Nt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){g[n].placeholder=g}),Nt(["drop","take"],function(n,o){_e.prototype[n]=function(l){l=l===_?1:Ve(he(l),0);var d=this.__filtered__&&!o?new _e(this):this.clone();return d.__filtered__?d.__takeCount__=pt(l,d.__takeCount__):d.__views__.push({size:pt(l,Qt),type:n+(d.__dir__<0?"Right":"")}),d},_e.prototype[n+"Right"]=function(l){return this.reverse()[n](l).reverse()}}),Nt(["filter","map","takeWhile"],function(n,o){var l=o+1,d=1==l||3==l;_e.prototype[n]=function(h){var f=this.clone();return f.__iteratees__.push({iteratee:H(h,3),type:l}),f.__filtered__=f.__filtered__||d,f}}),Nt(["head","last"],function(n,o){var l="take"+(o?"Right":"");_e.prototype[n]=function(){return this[l](1).value()[0]}}),Nt(["initial","tail"],function(n,o){var l="drop"+(o?"":"Right");_e.prototype[n]=function(){return this.__filtered__?new _e(this):this[l](1)}}),_e.prototype.compact=function(){return this.filter(Gt)},_e.prototype.find=function(n){return this.filter(n).head()},_e.prototype.findLast=function(n){return this.reverse().find(n)},_e.prototype.invokeMap=ae(function(n,o){return"function"==typeof n?new _e(this):this.map(function(l){return Pi(l,n,o)})}),_e.prototype.reject=function(n){return this.filter(Ws(H(n)))},_e.prototype.slice=function(n,o){n=he(n);var l=this;return l.__filtered__&&(n>0||o<0)?new _e(l):(n<0?l=l.takeRight(-n):n&&(l=l.drop(n)),o!==_&&(l=(o=he(o))<0?l.dropRight(-o):l.take(o-n)),l)},_e.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},_e.prototype.toArray=function(){return this.take(Qt)},rn(_e.prototype,function(n,o){var l=/^(?:filter|find|map|reject)|While$/.test(o),d=/^(?:head|last)$/.test(o),h=g[d?"take"+("last"==o?"Right":""):o],f=d||/^find/.test(o);!h||(g.prototype[o]=function(){var b=this.__wrapped__,M=d?[1]:arguments,P=b instanceof _e,k=M[0],q=P||se(b),L=function(ve){var be=h.apply(g,wn([ve],M));return d&&j?be[0]:be};q&&l&&"function"==typeof k&&1!=k.length&&(P=q=!1);var j=this.__chain__,Y=!!this.__actions__.length,$=f&&!j,me=P&&!Y;if(!f&&q){b=me?b:new _e(this);var K=n.apply(b,M);return K.__actions__.push({func:Hs,args:[L],thisArg:_}),new Tt(K,j)}return $&&me?n.apply(this,M):(K=this.thru(L),$?d?K.value()[0]:K.value():K)})}),Nt(["pop","push","shift","sort","splice","unshift"],function(n){var o=uo[n],l=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",d=/^(?:pop|shift)$/.test(n);g.prototype[n]=function(){var h=arguments;if(d&&!this.__chain__){var f=this.value();return o.apply(se(f)?f:[],h)}return this[l](function(b){return o.apply(se(b)?b:[],h)})}}),rn(_e.prototype,function(n,o){var l=g[o];if(l){var d=l.name+"";Te.call(Mi,d)||(Mi[d]=[]),Mi[d].push({name:o,func:l})}}),Mi[qo(_,2).name]=[{name:"wrapper",func:_}],_e.prototype.clone=function(){var n=new _e(this.__wrapped__);return n.__actions__=Dt(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=Dt(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=Dt(this.__views__),n},_e.prototype.reverse=function(){if(this.__filtered__){var n=new _e(this);n.__dir__=-1,n.__filtered__=!0}else(n=this.clone()).__dir__*=-1;return n},_e.prototype.value=function(){var n=this.__wrapped__.value(),o=this.__dir__,l=se(n),d=o<0,h=l?n.length:0,f=function(n,o,l){for(var d=-1,h=l.length;++d<h;){var f=l[d],b=f.size;switch(f.type){case"drop":n+=b;break;case"dropRight":o-=b;break;case"take":o=pt(o,n+b);break;case"takeRight":n=Ve(n,o-b)}}return{start:n,end:o}}(0,h,this.__views__),b=f.start,M=f.end,P=M-b,k=d?M:b-1,q=this.__iteratees__,L=q.length,j=0,Y=pt(P,this.__takeCount__);if(!l||!d&&h==P&&Y==P)return Ps(n,this.__actions__);var $=[];e:for(;P--&&j<Y;){for(var me=-1,K=n[k+=o];++me<L;){var ve=q[me],Xt=ve.type,Et=(0,ve.iteratee)(K);if(2==Xt)K=Et;else if(!Et){if(1==Xt)continue e;break e}}$[j++]=K}return $},g.prototype.at=Hp,g.prototype.chain=function(){return Bd(this)},g.prototype.commit=function(){return new Tt(this.value(),this.__chain__)},g.prototype.next=function(){this.__values__===_&&(this.__values__=ip(this.value()));var n=this.__index__>=this.__values__.length;return{done:n,value:n?_:this.__values__[this.__index__++]}},g.prototype.plant=function(n){for(var o,l=this;l instanceof Yi;){var d=X(l);d.__index__=0,d.__values__=_,o?h.__wrapped__=d:o=d;var h=d;l=l.__wrapped__}return h.__wrapped__=n,o},g.prototype.reverse=function(){var n=this.__wrapped__;if(n instanceof _e){var o=n;return this.__actions__.length&&(o=new _e(this)),(o=o.reverse()).__actions__.push({func:Hs,args:[Ki],thisArg:_}),new Tt(o,this.__chain__)}return this.thru(Ki)},g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=function(){return Ps(this.__wrapped__,this.__actions__)},g.prototype.first=g.prototype.head,ji&&(g.prototype[ji]=function(){return this}),g}();rt._=dn,(e=function(){return dn}.call(tn,Z,tn,Ht))!==_&&(Ht.exports=e)}.call(this)},6392:(Ht,tn,Z)=>{"use strict";Z.r(tn),Z.d(tn,{AddRepairCustomersModule:()=>xd});var e=Z(37716),_=Z(38583),St=Z(71386),Ce=Z(80521),ce=Z(39490),Ne=Z(19238),le=Z(9359),Mt=Z(79593),zt=Z(46523),ge=Z(91786),ot=Z(14054),pe=Z(67980),V=Z(21860),W=Z(13528),Oe=Z(51927),fe=Z(27969),mt=Z(65598),ie=Z(98168),ye=Z(61528),Ke=Z(70946);function xt(a,c,t){for(let i in c)if(c.hasOwnProperty(i)){const r=c[i];r?a.setProperty(i,r,(null==t?void 0:t.has(i))?"important":""):a.removeProperty(i)}return a}function Ee(a,c){const t=c?"":"none";xt(a.style,{"touch-action":c?"":"none","-webkit-user-drag":c?"":"none","-webkit-tap-highlight-color":c?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function Pt(a,c,t){xt(a.style,{position:c?"":"fixed",top:c?"":"0",opacity:c?"":"0",left:c?"":"-999em"},t)}function Cn(a,c){return c&&"none"!=c?a+" "+c:a}function eo(a){const c=a.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(a)*c}function ai(a,c){return a.getPropertyValue(c).split(",").map(i=>i.trim())}function Bo(a){const c=a.getBoundingClientRect();return{top:c.top,right:c.right,bottom:c.bottom,left:c.left,width:c.width,height:c.height}}function to(a,c,t){const{top:i,bottom:r,left:s,right:p}=a;return t>=i&&t<=r&&c>=s&&c<=p}function Ii(a,c,t){a.top+=c,a.bottom=a.top+a.height,a.left+=t,a.right=a.left+a.width}function na(a,c,t,i){const{top:r,right:s,bottom:p,left:u,width:m,height:C}=a,O=m*c,v=C*c;return i>r-v&&i<p+v&&t>u-O&&t<s+O}class On{constructor(c,t){this._document=c,this._viewportRuler=t,this.positions=new Map}clear(){this.positions.clear()}cache(c){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),c.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:Bo(t)})})}handleScroll(c){const t=(0,Ce.sA)(c),i=this.positions.get(t);if(!i)return null;const r=t===this._document?t.documentElement:t,s=i.scrollPosition;let p,u;if(t===this._document){const O=this._viewportRuler.getViewportScrollPosition();p=O.top,u=O.left}else p=t.scrollTop,u=t.scrollLeft;const m=s.top-p,C=s.left-u;return this.positions.forEach((O,v)=>{O.clientRect&&t!==v&&r.contains(v)&&Ii(O.clientRect,m,C)}),s.top=p,s.left=u,{top:m,left:C}}}function ln(a){const c=a.cloneNode(!0),t=c.querySelectorAll("[id]"),i=a.nodeName.toLowerCase();c.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return"canvas"===i?oa(a,c):("input"===i||"select"===i||"textarea"===i)&&Qt(a,c),ia("canvas",a,c,oa),ia("input, textarea, select",a,c,Qt),c}function ia(a,c,t,i){const r=c.querySelectorAll(a);if(r.length){const s=t.querySelectorAll(a);for(let p=0;p<r.length;p++)i(r[p],s[p])}}let no=0;function Qt(a,c){"file"!==c.type&&(c.value=a.value),"radio"===c.type&&c.name&&(c.name=`mat-clone-${c.name}-${no++}`)}function oa(a,c){const t=c.getContext("2d");if(t)try{t.drawImage(a,0,0)}catch(i){}}const ra=(0,Ce.i$)({passive:!0}),aa=(0,Ce.i$)({passive:!1}),li=new Set(["position"]);class el{constructor(c,t,i,r,s,p){this._config=t,this._document=i,this._ngZone=r,this._viewportRuler=s,this._dragDropRegistry=p,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new le.x,this._pointerMoveSubscription=Mt.w0.EMPTY,this._pointerUpSubscription=Mt.w0.EMPTY,this._scrollSubscription=Mt.w0.EMPTY,this._resizeSubscription=Mt.w0.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new le.x,this.started=new le.x,this.released=new le.x,this.ended=new le.x,this.entered=new le.x,this.exited=new le.x,this.dropped=new le.x,this.moved=this._moveEvents,this._pointerDown=u=>{if(this.beforeStarted.next(),this._handles.length){const m=this._handles.find(C=>{const O=(0,Ce.sA)(u);return!!O&&(O===C||C.contains(O))});m&&!this._disabledHandles.has(m)&&!this.disabled&&this._initializeDragSequence(m,u)}else this.disabled||this._initializeDragSequence(this._rootElement,u)},this._pointerMove=u=>{const m=this._getPointerPositionOnPage(u);if(!this._hasStartedDragging){if(Math.abs(m.x-this._pickupPositionOnPage.x)+Math.abs(m.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const D=Date.now()>=this._dragStartTime+this._getDragStartDelay(u),T=this._dropContainer;if(!D)return void this._endDragSequence(u);(!T||!T.isDragging()&&!T.isReceiving())&&(u.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(u)))}return}this._boundaryElement&&(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()),u.preventDefault();const C=this._getConstrainedPointerPosition(m);if(this._hasMoved=!0,this._lastKnownPointerPosition=m,this._updatePointerDirectionDelta(C),this._dropContainer)this._updateActiveDropContainer(C,m);else{const O=this._activeTransform;O.x=C.x-this._pickupPositionOnPage.x+this._passiveTransform.x,O.y=C.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(O.x,O.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${O.x} ${O.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:C,event:u,distance:this._getDragDistance(C),delta:this._pointerDirectionDelta})})},this._pointerUp=u=>{this._endDragSequence(u)},this.withRootElement(c).withParent(t.parentDragRef||null),this._parentPositions=new On(i,s),p.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(c){const t=(0,ce.Ig)(c);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(i=>Ee(i,t)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(c){this._handles=c.map(i=>(0,ce.fI)(i)),this._handles.forEach(i=>Ee(i,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&t.add(i)}),this._disabledHandles=t,this}withPreviewTemplate(c){return this._previewTemplate=c,this}withPlaceholderTemplate(c){return this._placeholderTemplate=c,this}withRootElement(c){const t=(0,ce.fI)(c);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,aa),t.addEventListener("touchstart",this._pointerDown,ra)}),this._initialTransform=void 0,this._rootElement=t),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(c){return this._boundaryElement=c?(0,ce.fI)(c):null,this._resizeSubscription.unsubscribe(),c&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(c){return this._parentDragRef=c,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&io(this._rootElement),io(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(c){!this._disabledHandles.has(c)&&this._handles.indexOf(c)>-1&&(this._disabledHandles.add(c),Ee(c,!0))}enableHandle(c){this._disabledHandles.has(c)&&(this._disabledHandles.delete(c),Ee(c,this.disabled))}withDirection(c){return this._direction=c,this}_withDropContainer(c){this._dropContainer=c}getFreeDragPosition(){const c=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:c.x,y:c.y}}setFreeDragPosition(c){return this._activeTransform={x:0,y:0},this._passiveTransform.x=c.x,this._passiveTransform.y=c.y,this._dropContainer||this._applyRootElementTransform(c.x,c.y),this}withPreviewContainer(c){return this._previewContainer=c,this}_sortFromLastPointerPosition(){const c=this._lastKnownPointerPosition;c&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(c),c)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&io(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&io(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(c){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(c),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(c);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(c){xn(c)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const i=this._rootElement,r=i.parentNode,s=this._placeholder=this._createPlaceholderElement(),p=this._anchor=this._anchor||this._document.createComment(""),u=this._getShadowRoot();r.insertBefore(p,i),this._initialTransform=i.style.transform||"",this._preview=this._createPreviewElement(),Pt(i,!1,li),this._document.body.appendChild(r.replaceChild(s,i)),this._getPreviewInsertionPoint(r,u).appendChild(this._preview),this.started.next({source:this}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(c,t){this._parentDragRef&&t.stopPropagation();const i=this.isDragging(),r=xn(t),s=!r&&0!==t.button,p=this._rootElement,u=(0,Ce.sA)(t),m=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),C=r?(0,Ne.yG)(t):(0,Ne.X6)(t);if(u&&u.draggable&&"mousedown"===t.type&&t.preventDefault(),i||s||m||C)return;this._handles.length&&(this._rootElementTapHighlight=p.style.webkitTapHighlightColor||"",p.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(w=>this._updateOnScroll(w)),this._boundaryElement&&(this._boundaryRect=Bo(this._boundaryElement));const O=this._previewTemplate;this._pickupPositionInElement=O&&O.template&&!O.matchSize?{x:0,y:0}:this._getPointerPositionInElement(c,t);const v=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:v.x,y:v.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(c){Pt(this._rootElement,!0,li),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,i=t.getItemIndex(this),r=this._getPointerPositionOnPage(c),s=this._getDragDistance(r),p=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:s,dropPoint:r}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:p,distance:s,dropPoint:r}),t.drop(this,i,this._initialIndex,this._initialContainer,p,s,r),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:c,y:t},{x:i,y:r}){let s=this._initialContainer._getSiblingContainerFromPosition(this,c,t);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(c,t)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=s,this._dropContainer.enter(this,c,t,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,c,t,this._pointerDirectionDelta),this._applyPreviewTransform(c-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){const c=this._previewTemplate,t=this.previewClass,i=c?c.template:null;let r;if(i&&c){const s=c.matchSize?this._rootElement.getBoundingClientRect():null,p=c.viewContainer.createEmbeddedView(i,c.context);p.detectChanges(),r=Ai(p,this._document),this._previewRef=p,c.matchSize?Yo(r,s):r.style.transform=Mn(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const s=this._rootElement;r=ln(s),Yo(r,s.getBoundingClientRect()),this._initialTransform&&(r.style.transform=this._initialTransform)}return xt(r.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},li),Ee(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(s=>r.classList.add(s)):r.classList.add(t)),r}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const c=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(c.left,c.top);const t=function(a){const c=getComputedStyle(a),t=ai(c,"transition-property"),i=t.find(u=>"transform"===u||"all"===u);if(!i)return 0;const r=t.indexOf(i),s=ai(c,"transition-duration"),p=ai(c,"transition-delay");return eo(s[r])+eo(p[r])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{const r=p=>{var u;(!p||(0,Ce.sA)(p)===this._preview&&"transform"===p.propertyName)&&(null===(u=this._preview)||void 0===u||u.removeEventListener("transitionend",r),i(),clearTimeout(s))},s=setTimeout(r,1.5*t);this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const c=this._placeholderTemplate,t=c?c.template:null;let i;return t?(this._placeholderRef=c.viewContainer.createEmbeddedView(t,c.context),this._placeholderRef.detectChanges(),i=Ai(this._placeholderRef,this._document)):i=ln(this._rootElement),i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(c,t){const i=this._rootElement.getBoundingClientRect(),r=c===this._rootElement?null:c,s=r?r.getBoundingClientRect():i,p=xn(t)?t.targetTouches[0]:t,u=this._getViewportScrollPosition();return{x:s.left-i.left+(p.pageX-s.left-u.left),y:s.top-i.top+(p.pageY-s.top-u.top)}}_getPointerPositionOnPage(c){const t=this._getViewportScrollPosition(),i=xn(c)?c.touches[0]||c.changedTouches[0]||{pageX:0,pageY:0}:c,r=i.pageX-t.left,s=i.pageY-t.top;if(this._ownerSVGElement){const p=this._ownerSVGElement.getScreenCTM();if(p){const u=this._ownerSVGElement.createSVGPoint();return u.x=r,u.y=s,u.matrixTransform(p.inverse())}}return{x:r,y:s}}_getConstrainedPointerPosition(c){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:r}=this.constrainPosition?this.constrainPosition(c,this):c;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(i=this._pickupPositionOnPage.x),this._boundaryRect){const{x:s,y:p}=this._pickupPositionInElement,u=this._boundaryRect,m=this._previewRect,C=u.top+p,O=u.bottom-(m.height-p);i=ci(i,u.left+s,u.right-(m.width-s)),r=ci(r,C,O)}return{x:i,y:r}}_updatePointerDirectionDelta(c){const{x:t,y:i}=c,r=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,p=Math.abs(t-s.x),u=Math.abs(i-s.y);return p>this._config.pointerDirectionChangeThreshold&&(r.x=t>s.x?1:-1,s.x=t),u>this._config.pointerDirectionChangeThreshold&&(r.y=i>s.y?1:-1,s.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const c=this._handles.length>0||!this.isDragging();c!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=c,Ee(this._rootElement,c))}_removeRootElementListeners(c){c.removeEventListener("mousedown",this._pointerDown,aa),c.removeEventListener("touchstart",this._pointerDown,ra)}_applyRootElementTransform(c,t){const i=Mn(c,t);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform&&"none"!=this._rootElement.style.transform?this._rootElement.style.transform:""),this._rootElement.style.transform=Cn(i,this._initialTransform)}_applyPreviewTransform(c,t){var i;const r=(null===(i=this._previewTemplate)||void 0===i?void 0:i.template)?void 0:this._initialTransform,s=Mn(c,t);this._preview.style.transform=Cn(s,r)}_getDragDistance(c){const t=this._pickupPositionOnPage;return t?{x:c.x-t.x,y:c.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:c,y:t}=this._passiveTransform;if(0===c&&0===t||this.isDragging()||!this._boundaryElement)return;const i=this._boundaryElement.getBoundingClientRect(),r=this._rootElement.getBoundingClientRect();if(0===i.width&&0===i.height||0===r.width&&0===r.height)return;const s=i.left-r.left,p=r.right-i.right,u=i.top-r.top,m=r.bottom-i.bottom;i.width>r.width?(s>0&&(c+=s),p>0&&(c-=p)):c=0,i.height>r.height?(u>0&&(t+=u),m>0&&(t-=m)):t=0,(c!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:c})}_getDragStartDelay(c){const t=this.dragStartDelay;return"number"==typeof t?t:xn(c)?t.touch:t?t.mouse:0}_updateOnScroll(c){const t=this._parentPositions.handleScroll(c);if(t){const i=(0,Ce.sA)(c);this._boundaryRect&&(i===this._document||i!==this._boundaryElement&&i.contains(this._boundaryElement))&&Ii(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const c=this._parentPositions.positions.get(this._document);return c?c.scrollPosition:this._viewportRuler.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,Ce.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(c,t){const i=this._previewContainer||"global";if("parent"===i)return c;if("global"===i){const r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return(0,ce.fI)(i)}}function Mn(a,c){return`translate3d(${Math.round(a)}px, ${Math.round(c)}px, 0)`}function ci(a,c,t){return Math.max(c,Math.min(t,a))}function io(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function xn(a){return"t"===a.type[0]}function Ai(a,c){const t=a.rootNodes;if(1===t.length&&t[0].nodeType===c.ELEMENT_NODE)return t[0];const i=c.createElement("div");return t.forEach(r=>i.appendChild(r)),i}function Yo(a,c){a.style.width=`${c.width}px`,a.style.height=`${c.height}px`,a.style.transform=Mn(c.left,c.top)}function Ft(a,c,t){const i=It(c,a.length-1),r=It(t,a.length-1);if(i===r)return;const s=a[i],p=r<i?-1:1;for(let u=i;u!==r;u+=p)a[u]=a[u+p];a[r]=s}function It(a,c){return Math.max(0,Math.min(c,a))}class ki{constructor(c,t,i,r,s){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=s,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new le.x,this.entered=new le.x,this.exited=new le.x,this.dropped=new le.x,this.sorted=new le.x,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=Mt.w0.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new le.x,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(a=0,c=zt.z){return a<0&&(a=0),(0,ge.H)(a,a,c)}(0,ot.Z).pipe((0,W.R)(this._stopScrollTimers)).subscribe(()=>{const p=this._scrollNode,u=this.autoScrollStep;1===this._verticalScrollDirection?di(p,-u):2===this._verticalScrollDirection&&di(p,u),1===this._horizontalScrollDirection?qi(p,-u):2===this._horizontalScrollDirection&&qi(p,u)})},this.element=(0,ce.fI)(c),this._document=i,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new On(i,s)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(c,t,i,r){let s;this._draggingStarted(),null==r?(s=this.sortingDisabled?this._draggables.indexOf(c):-1,-1===s&&(s=this._getItemIndexFromPointerPosition(c,t,i))):s=r;const p=this._activeDraggables,u=p.indexOf(c),m=c.getPlaceholderElement();let C=p[s];if(C===c&&(C=p[s+1]),u>-1&&p.splice(u,1),C&&!this._dragDropRegistry.isDragging(C)){const O=C.getRootElement();O.parentElement.insertBefore(m,O),p.splice(s,0,c)}else if(this._shouldEnterAsFirstChild(t,i)){const O=p[0].getRootElement();O.parentNode.insertBefore(m,O),p.unshift(c)}else(0,ce.fI)(this.element).appendChild(m),p.push(c);m.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:c,container:this,currentIndex:this.getItemIndex(c)})}exit(c){this._reset(),this.exited.next({item:c,container:this})}drop(c,t,i,r,s,p,u){this._reset(),this.dropped.next({item:c,currentIndex:t,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:s,distance:p,dropPoint:u})}withItems(c){const t=this._draggables;return this._draggables=c,c.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>-1===c.indexOf(r))?this._reset():this._cacheItems()),this}withDirection(c){return this._direction=c,this}connectedTo(c){return this._siblings=c.slice(),this}withOrientation(c){return this._orientation=c,this}withScrollableParents(c){const t=(0,ce.fI)(this.element);return this._scrollableElements=-1===c.indexOf(t)?[t,...c]:c.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(c){return this._isDragging?At("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,i=>i.drag===c):this._draggables.indexOf(c)}isReceiving(){return this._activeSiblings.size>0}_sortItem(c,t,i,r){if(this.sortingDisabled||!this._clientRect||!na(this._clientRect,.05,t,i))return;const s=this._itemPositions,p=this._getItemIndexFromPointerPosition(c,t,i,r);if(-1===p&&s.length>0)return;const u="horizontal"===this._orientation,m=At(s,I=>I.drag===c),C=s[p],v=C.clientRect,w=m>p?1:-1,D=this._getItemOffsetPx(s[m].clientRect,v,w),T=this._getSiblingOffsetPx(m,s,w),R=s.slice();Ft(s,m,p),this.sorted.next({previousIndex:m,currentIndex:p,container:this,item:c}),s.forEach((I,E)=>{if(R[E]===I)return;const F=I.drag===c,G=F?D:T,re=F?c.getPlaceholderElement():I.drag.getRootElement();I.offset+=G,u?(re.style.transform=Cn(`translate3d(${Math.round(I.offset)}px, 0, 0)`,I.initialTransform),Ii(I.clientRect,0,G)):(re.style.transform=Cn(`translate3d(0, ${Math.round(I.offset)}px, 0)`,I.initialTransform),Ii(I.clientRect,G,0))}),this._previousSwap.overlaps=to(v,t,i),this._previousSwap.drag=C.drag,this._previousSwap.delta=u?r.x:r.y}_startScrollingIfNecessary(c,t){if(this.autoScrollDisabled)return;let i,r=0,s=0;if(this._parentPositions.positions.forEach((p,u)=>{u===this._document||!p.clientRect||i||na(p.clientRect,.05,c,t)&&([r,s]=function(a,c,t,i){const r=la(c,i),s=pi(c,t);let p=0,u=0;if(r){const m=a.scrollTop;1===r?m>0&&(p=1):a.scrollHeight-m>a.clientHeight&&(p=2)}if(s){const m=a.scrollLeft;1===s?m>0&&(u=1):a.scrollWidth-m>a.clientWidth&&(u=2)}return[p,u]}(u,p.clientRect,c,t),(r||s)&&(i=u))}),!r&&!s){const{width:p,height:u}=this._viewportRuler.getViewportSize(),m={width:p,height:u,top:0,right:p,bottom:u,left:0};r=la(m,t),s=pi(m,c),i=window}i&&(r!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=s,this._scrollNode=i,(r||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const c=(0,ce.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=c.msScrollSnapType||c.scrollSnapType||"",c.scrollSnapType=c.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const c=(0,ce.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(c).clientRect}_cacheItemPositions(){const c="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const i=t.getVisibleElement();return{drag:t,offset:0,initialTransform:i.style.transform||"",clientRect:Bo(i)}}).sort((t,i)=>c?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_reset(){this._isDragging=!1;const c=(0,ce.fI)(this.element).style;c.scrollSnapType=c.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{var i;const r=t.getRootElement();if(r){const s=null===(i=this._itemPositions.find(p=>p.drag===t))||void 0===i?void 0:i.initialTransform;r.style.transform=s||""}}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(c,t,i){const r="horizontal"===this._orientation,s=t[c].clientRect,p=t[c+-1*i];let u=s[r?"width":"height"]*i;if(p){const m=r?"left":"top",C=r?"right":"bottom";-1===i?u-=p.clientRect[m]-s[C]:u+=s[m]-p.clientRect[C]}return u}_getItemOffsetPx(c,t,i){const r="horizontal"===this._orientation;let s=r?t.left-c.left:t.top-c.top;return-1===i&&(s+=r?t.width-c.width:t.height-c.height),s}_shouldEnterAsFirstChild(c,t){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,r="horizontal"===this._orientation;if(i[0].drag!==this._activeDraggables[0]){const p=i[i.length-1].clientRect;return r?c>=p.right:t>=p.bottom}{const p=i[0].clientRect;return r?c<=p.left:t<=p.top}}_getItemIndexFromPointerPosition(c,t,i,r){const s="horizontal"===this._orientation,p=At(this._itemPositions,({drag:u,clientRect:m},C,O)=>{if(u===c)return O.length<2;if(r){const v=s?r.x:r.y;if(u===this._previousSwap.drag&&this._previousSwap.overlaps&&v===this._previousSwap.delta)return!1}return s?t>=Math.floor(m.left)&&t<Math.floor(m.right):i>=Math.floor(m.top)&&i<Math.floor(m.bottom)});return-1!==p&&this.sortPredicate(p,c,this)?p:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(c,t){return null!=this._clientRect&&to(this._clientRect,c,t)}_getSiblingContainerFromPosition(c,t,i){return this._siblings.find(r=>r._canReceive(c,t,i))}_canReceive(c,t,i){if(!this._clientRect||!to(this._clientRect,t,i)||!this.enterPredicate(c,this))return!1;const r=this._getShadowRoot().elementFromPoint(t,i);if(!r)return!1;const s=(0,ce.fI)(this.element);return r===s||s.contains(r)}_startReceiving(c,t){const i=this._activeSiblings;!i.has(c)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(i.add(c),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(c){this._activeSiblings.delete(c),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(c=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(c);t&&(this._itemPositions.forEach(({clientRect:i})=>{Ii(i,t.top,t.left)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const c=(0,Ce.kV)((0,ce.fI)(this.element));this._cachedShadowRoot=c||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const c=this._activeDraggables.filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,c))}}function At(a,c){for(let t=0;t<a.length;t++)if(c(a[t],t,a))return t;return-1}function di(a,c){a===window?a.scrollBy(0,c):a.scrollTop+=c}function qi(a,c){a===window?a.scrollBy(c,0):a.scrollLeft+=c}function la(a,c){const{top:t,bottom:i,height:r}=a,s=.05*r;return c>=t-s&&c<=t+s?1:c>=i-s&&c<=i+s?2:0}function pi(a,c){const{left:t,right:i,width:r}=a,s=.05*r;return c>=t-s&&c<=t+s?1:c>=i-s&&c<=i+s?2:0}const Pn=(0,Ce.i$)({passive:!1,capture:!0});let En=(()=>{class a{constructor(t,i){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=r=>r.isDragging(),this.pointerMove=new le.x,this.pointerUp=new le.x,this.scroll=new le.x,this._preventDefaultWhileDragging=r=>{this._activeDragInstances.length>0&&r.preventDefault()},this._persistentTouchmoveListener=r=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&r.preventDefault(),this.pointerMove.next(r))},this._document=i}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,Pn)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,Pn)}startDragging(t,i){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const r=i.type.startsWith("touch");this._globalListeners.set(r?"touchend":"mouseup",{handler:s=>this.pointerUp.next(s),options:!0}).set("scroll",{handler:s=>this.scroll.next(s),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Pn}),r||this._globalListeners.set("mousemove",{handler:s=>this.pointerMove.next(s),options:Pn}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((s,p)=>{this._document.addEventListener(p,s.handler,s.options)})})}}stopDragging(t){const i=this._activeDragInstances.indexOf(t);i>-1&&(this._activeDragInstances.splice(i,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const i=[this.scroll];return t&&t!==this._document&&i.push(new pe.y(r=>this._ngZone.runOutsideAngular(()=>{const p=u=>{this._activeDragInstances.length&&r.next(u)};return t.addEventListener("scroll",p,!0),()=>{t.removeEventListener("scroll",p,!0)}}))),(0,V.T)(...i)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,i)=>{this._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(e.R0b),e.LFG(_.K0))},a.\u0275prov=e.Yz7({factory:function(){return new a(e.LFG(e.R0b),e.LFG(_.K0))},token:a,providedIn:"root"}),a})();const Ho={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let Ri=(()=>{class a{constructor(t,i,r,s){this._document=t,this._ngZone=i,this._viewportRuler=r,this._dragDropRegistry=s}createDrag(t,i=Ho){return new el(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new ki(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(_.K0),e.LFG(e.R0b),e.LFG(St.rL),e.LFG(En))},a.\u0275prov=e.Yz7({factory:function(){return new a(e.LFG(_.K0),e.LFG(e.R0b),e.LFG(St.rL),e.LFG(En))},token:a,providedIn:"root"}),a})();const Li=new e.OlP("CDK_DRAG_PARENT"),Ei=new e.OlP("CdkDropListGroup"),oo=new e.OlP("CDK_DRAG_CONFIG");let zo=0;const ro=new e.OlP("CdkDropList");let il=(()=>{class a{constructor(t,i,r,s,p,u,m){this.element=t,this._changeDetectorRef=r,this._scrollDispatcher=s,this._dir=p,this._group=u,this._destroyed=new le.x,this.connectedTo=[],this.id="cdk-drop-list-"+zo++,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.dropped=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.sorted=new e.vpe,this._unsortedItems=new Set,this._dropListRef=i.createDropList(t),this._dropListRef.data=this,m&&this._assignDefaults(m),this._dropListRef.enterPredicate=(C,O)=>this.enterPredicate(C.data,O.data),this._dropListRef.sortPredicate=(C,O,v)=>this.sortPredicate(C,O.data,v.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),a._dropLists.push(this),u&&u._items.add(this)}get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=(0,ce.Ig)(t)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,i)=>t._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=a._dropLists.indexOf(this);t>-1&&a._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe((0,Oe.O)(this._dir.value),(0,W.R)(this._destroyed)).subscribe(i=>t.withDirection(i)),t.beforeStarted.subscribe(()=>{const i=(0,ce.Eq)(this.connectedTo).map(r=>"string"==typeof r?a._dropLists.find(p=>p.id===r):r);if(this._group&&this._group._items.forEach(r=>{-1===i.indexOf(r)&&i.push(r)}),!this._scrollableParentsResolved){const r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(s=>s.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=(0,ce.Ig)(this.sortingDisabled),t.autoScrollDisabled=(0,ce.Ig)(this.autoScrollDisabled),t.autoScrollStep=(0,ce.su)(this.autoScrollStep,2),t.connectedTo(i.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint}),this._changeDetectorRef.markForCheck()})}_assignDefaults(t){const{lockAxis:i,draggingDisabled:r,sortingDisabled:s,listAutoScrollDisabled:p,listOrientation:u}=t;this.disabled=null!=r&&r,this.sortingDisabled=null!=s&&s,this.autoScrollDisabled=null!=p&&p,this.orientation=u||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(Ri),e.Y36(e.sBO),e.Y36(St.mF),e.Y36(Ke.Is,8),e.Y36(Ei,12),e.Y36(oo,8))},a.\u0275dir=e.lG2({type:a,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(t,i){2&t&&(e.uIk("id",i.id),e.ekj("cdk-drop-list-disabled",i.disabled)("cdk-drop-list-dragging",i._dropListRef.isDragging())("cdk-drop-list-receiving",i._dropListRef.isReceiving()))},inputs:{connectedTo:["cdkDropListConnectedTo","connectedTo"],id:"id",enterPredicate:["cdkDropListEnterPredicate","enterPredicate"],sortPredicate:["cdkDropListSortPredicate","sortPredicate"],disabled:["cdkDropListDisabled","disabled"],sortingDisabled:["cdkDropListSortingDisabled","sortingDisabled"],autoScrollDisabled:["cdkDropListAutoScrollDisabled","autoScrollDisabled"],orientation:["cdkDropListOrientation","orientation"],lockAxis:["cdkDropListLockAxis","lockAxis"],data:["cdkDropListData","data"],autoScrollStep:["cdkDropListAutoScrollStep","autoScrollStep"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[e._Bn([{provide:Ei,useValue:void 0},{provide:ro,useExisting:a}])]}),a._dropLists=[],a})();const Qo=new e.OlP("CdkDragHandle"),Vo=new e.OlP("CdkDragPlaceholder"),pa=new e.OlP("CdkDragPreview");let ua=(()=>{class a{constructor(t,i,r,s,p,u,m,C,O,v,w){this.element=t,this.dropContainer=i,this._ngZone=s,this._viewContainerRef=p,this._dir=m,this._changeDetectorRef=O,this._selfHandle=v,this._parentDrag=w,this._destroyed=new le.x,this.started=new e.vpe,this.released=new e.vpe,this.ended=new e.vpe,this.entered=new e.vpe,this.exited=new e.vpe,this.dropped=new e.vpe,this.moved=new pe.y(D=>{const T=this._dragRef.moved.pipe((0,fe.U)(R=>({source:this,pointerPosition:R.pointerPosition,event:R.event,delta:R.delta,distance:R.distance}))).subscribe(D);return()=>{T.unsubscribe()}}),this._dragRef=C.createDrag(t,{dragStartThreshold:u&&null!=u.dragStartThreshold?u.dragStartThreshold:5,pointerDirectionChangeThreshold:u&&null!=u.pointerDirectionChangeThreshold?u.pointerDirectionChangeThreshold:5,zIndex:null==u?void 0:u.zIndex}),this._dragRef.data=this,a._dragInstances.push(this),u&&this._assignDefaults(u),i&&(this._dragRef._withDropContainer(i._dropListRef),i.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=(0,ce.Ig)(t),this._dragRef.disabled=this._disabled}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,mt.q)(1),(0,W.R)(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._setupHandlesListener(),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})})}ngOnChanges(t){const i=t.rootElementSelector,r=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this);const t=a._dragInstances.indexOf(this);t>-1&&a._dragInstances.splice(t,1),this._ngZone.runOutsideAngular(()=>{this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_updateRootElement(){const t=this.element.nativeElement,i=this.rootElementSelector?ha(t,this.rootElementSelector):t;this._dragRef.withRootElement(i||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?ha(this.element.nativeElement,t):(0,ce.fI)(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const i=this._dir,r=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,p=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof r&&r?r:(0,ce.su)(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(p).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe((0,mt.q)(1)).subscribe(()=>{var i,r;if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let s=this.element.nativeElement.parentElement;for(;s;){if(null===(i=s.classList)||void 0===i?void 0:i.contains("cdk-drag")){t.withParent((null===(r=a._dragInstances.find(p=>p.element.nativeElement===s))||void 0===r?void 0:r._dragRef)||null);break}s=s.parentElement}})}_handleEvents(t){t.started.subscribe(()=>{this.started.emit({source:this}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(()=>{this.released.emit({source:this})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint})})}_assignDefaults(t){const{lockAxis:i,dragStartDelay:r,constrainPosition:s,previewClass:p,boundaryElement:u,draggingDisabled:m,rootElementSelector:C,previewContainer:O}=t;this.disabled=null!=m&&m,this.dragStartDelay=r||0,i&&(this.lockAxis=i),s&&(this.constrainPosition=s),p&&(this.previewClass=p),u&&(this.boundaryElement=u),C&&(this.rootElementSelector=C),O&&(this.previewContainer=O)}_setupHandlesListener(){this._handles.changes.pipe((0,Oe.O)(this._handles),(0,ie.b)(t=>{const i=t.filter(r=>r._parentDrag===this).map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),(0,ye.w)(t=>(0,V.T)(...t.map(i=>i._stateChanges.pipe((0,Oe.O)(i))))),(0,W.R)(this._destroyed)).subscribe(t=>{const i=this._dragRef,r=t.element.nativeElement;t.disabled?i.disableHandle(r):i.enableHandle(r)})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(ro,12),e.Y36(_.K0),e.Y36(e.R0b),e.Y36(e.s_b),e.Y36(oo,8),e.Y36(Ke.Is,8),e.Y36(Ri),e.Y36(e.sBO),e.Y36(Qo,10),e.Y36(Li,12))},a.\u0275dir=e.lG2({type:a,selectors:[["","cdkDrag",""]],contentQueries:function(t,i,r){if(1&t&&(e.Suo(r,pa,5),e.Suo(r,Vo,5),e.Suo(r,Qo,5)),2&t){let s;e.iGM(s=e.CRH())&&(i._previewTemplate=s.first),e.iGM(s=e.CRH())&&(i._placeholderTemplate=s.first),e.iGM(s=e.CRH())&&(i._handles=s)}},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,i){2&t&&e.ekj("cdk-drag-disabled",i.disabled)("cdk-drag-dragging",i._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],previewContainer:["cdkDragPreviewContainer","previewContainer"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[e._Bn([{provide:Li,useExisting:a}]),e.TTD]}),a._dragInstances=[],a})();function ha(a,c){let t=a.parentElement;for(;t;){if(t.matches?t.matches(c):t.msMatchesSelector(c))return t;t=t.parentElement}return null}let al=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[Ri],imports:[St.ZD]}),a})();var ga=Z(43220),Xe=Z(76627),Be=Z(55278),we=Z(29790);const sl=["*"];let ll=(()=>{class a{constructor(t,i){this.elt=t,this.renderer=i,this.onStart=new e.vpe,this.onStop=new e.vpe,this.onTick=new e.vpe,this.onComplete=new e.vpe,this.autoStart=!0,this.startTime=0,this.endTime=0,this.timeoutId=null,this.countdown=!1,this.format="default"}ngAfterViewInit(){const t=this.elt.nativeElement.lastChild;this.ngContentSchema=t?t.nodeValue:"",(void 0===this.autoStart||!0===this.autoStart)&&this.start()}ngOnDestroy(){this.resetTimeout()}start(){this.initVar(),this.resetTimeout(),this.computeTimeUnits(),this.startTickCount(),this.onStart.emit(this)}resume(){this.resetTimeout(),this.startTickCount()}stop(){this.clear(),this.onStop.emit(this)}reset(){this.initVar(),this.resetTimeout(),this.clear(),this.computeTimeUnits(),this.renderText()}get(){return{seconds:this.seconds,minutes:this.minutes,hours:this.hours,days:this.days,timer:this.timeoutId,tick_count:this.tickCounter}}initVar(){this.startTime=this.startTime||0,this.endTime=this.endTime||0,this.countdown=this.countdown||!1,this.tickCounter=this.startTime,this.countdown&&0===this.startTime&&(this.countdown=!1),this.format||(this.format=this.ngContentSchema.length>5?"user":"default")}resetTimeout(){this.timeoutId&&clearInterval(this.timeoutId)}renderText(){let t;if("user"===this.format){const i={seconds:this.seconds,minutes:this.minutes,hours:this.hours,days:this.days};t=this.ngContentSchema;for(const r of Object.keys(i))t=t.replace("["+r+"]",i[r].toString())}else"intelli"===this.format?(t="",this.days>0&&(t+=this.days.toString()+"day"+(this.days>1?"s":"")+" "),(this.hours>0||this.days>0)&&(t+=this.hours.toString()+"h "),(this.minutes>0||this.hours>0)&&0===this.days&&(t+=this.minutes.toString().padStart(2,"0")+"min "),0===this.hours&&0===this.days&&(t+=this.seconds.toString().padStart(2,"0")+"s")):"hms"===this.format?(t=this.hours.toString().padStart(2,"0")+":",t+=this.minutes.toString().padStart(2,"0")+":",t+=this.seconds.toString().padStart(2,"0")):"ms"===this.format?(t="",this.hours>0&&(t=this.hours.toString().padStart(2,"0")+":"),t+=this.minutes.toString().padStart(2,"0")+":",t+=this.seconds.toString().padStart(2,"0")):(t=this.days.toString()+"d ",t+=this.hours.toString()+"h ",t+=this.minutes.toString()+"m ",t+=this.seconds.toString()+"s");this.renderer.setProperty(this.elt.nativeElement,"innerHTML",t)}clear(){this.resetTimeout(),this.timeoutId=null}computeTimeUnits(){this.maxTimeUnit&&"day"!==this.maxTimeUnit?"second"===this.maxTimeUnit?(this.seconds=this.tickCounter,this.minutes=0,this.hours=0,this.days=0):"minute"===this.maxTimeUnit?(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60),this.hours=0,this.days=0):"hour"===this.maxTimeUnit&&(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60%60),this.hours=Math.floor(this.tickCounter/3600),this.days=0):(this.seconds=Math.floor(this.tickCounter%60),this.minutes=Math.floor(this.tickCounter/60%60),this.hours=Math.floor(this.tickCounter/3600%24),this.days=Math.floor(this.tickCounter/3600/24)),this.renderText()}startTickCount(){const t=this;t.timeoutId=setInterval(function(){let i;if(t.countdown?(i=t.tickCounter,t.startTime>t.endTime&&(i=t.tickCounter-t.endTime-1)):(i=t.tickCounter-t.startTime,t.endTime>t.startTime&&(i=t.endTime-t.tickCounter-1)),t.computeTimeUnits(),t.onTick.emit({seconds:t.seconds,minutes:t.minutes,hours:t.hours,days:t.days,timer:t.timeoutId,tick_count:t.tickCounter}),i<0)return t.stop(),void t.onComplete.emit(t);t.countdown?t.tickCounter--:t.tickCounter++},1e3)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(e.Qsj))},a.\u0275cmp=e.Xpm({type:a,selectors:[["cd-timer"]],inputs:{startTime:"startTime",endTime:"endTime",countdown:"countdown",autoStart:"autoStart",maxTimeUnit:"maxTimeUnit",format:"format"},outputs:{onStart:"onStart",onStop:"onStop",onTick:"onTick",onComplete:"onComplete"},ngContentSelectors:sl,decls:1,vars:0,template:function(t,i){1&t&&(e.F$t(),e.Hsn(0))},encapsulation:2}),a})(),cl=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[]]}),a})();var ma=Z(30132),Fn=Z(74743),dl=Z(88784),pl=Z(44466),ul=Z(89993),Ze=Z(97582),Vt=Z(54121),dt=Z(57445),Ye=Z(22238),Nn=Z(38588),Ge=Z(95016),fa=Z(77782),A=Z(3679);const hl=[{name:"Front",displayName:"Front",image:"assets/img/part-front.png",title:"",subTitle:"",active:!0},{name:"Right Side",displayName:"Right Side",image:"assets/img/part-right.png",title:"",subTitle:""},{name:"Left Side",displayName:"Left Side",image:"assets/img/part-left.png",title:"",subTitle:""},{name:"Above",displayName:"Above",image:"assets/img/part-above.png",title:"",subTitle:""},{name:"Rear",displayName:"Rear",image:"assets/img/part-rear.png",title:"",subTitle:""},{name:"Interior",displayName:"Interior",image:"assets/img/part-interior.png",title:"",subTitle:""},{name:"Mechanical",displayName:"Mechanical",image:"assets/img/part-mechanical.png",title:"",subTitle:""}];var nn=Z(67017),yt=Z(36978);const gl=["operationType"];let _a=(()=>{class a{constructor(){this.formData={operationType:"",operation:"",code:"",repairType:"",quantity:0,price:0,labourTime:0,labourAmount:0},this.addButtonModel={label:"Add",type:"disabled",icon:"",onclick:this.submitForm.bind(this)},this.resetButtonModel={label:"Reset",type:"outline",icon:"",onclick:this.resetForm.bind(this)},this.menuItems=hl}ngOnInit(){this.formModel={operationType:{placeHolder:"Select Operation Type",name:"operationType",label:"Operation Type",options:[{id:1,name:"Check"}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"operationType",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"Please select operation type":""}},operation:{placeHolder:"Part/Operation",label:"part/operation",name:"operation",options:[{id:1,name:"Top-Section M"}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"operation",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"Please enter part/operation":""}},code:{placeHolder:"Code",label:"Code",name:"code",value:"",type:"text",maxLength:50,validation:{name:"code",validationFunction:()=>A.kI.compose([A.kI.maxLength(50),A.kI.pattern(/^[a-z\d\s]+$/i)]),validationMessage:a=>a.maxlength?"Code should have not more than 50 characters":a.pattern?"Only alphanumberic characters are allowed":""}},repairType:{placeHolder:"Select Repair type",name:"repairType",label:"REPAIR TYPE",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:""},quantity:{placeHolder:"Quantity",label:"Quantity",name:"quantity",value:"",type:"number",validation:{name:"quantity",validationFunction:()=>A.kI.compose([]),validationMessage:a=>""}},price:{placeHolder:"Price",label:"Price",name:"price",value:"",type:"number",validation:{name:"price",validationFunction:()=>A.kI.compose([]),validationMessage:a=>""}},labourTime:{placeHolder:"Labour Time",name:"labourTime",label:"Labour time(HOURs)",value:0,type:"number",validation:{name:"time",validationFunction:()=>A.kI.compose([]),validationMessage:a=>""}}}}submitForm(){}resetForm(t=!0){}hideDropdown(t){var i;t===this.formModel.operationType.name&&(null===(i=this.operationType)||void 0===i||i.closeDropdown())}onFormUpdate(t){}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-part-add"]],viewQuery:function(t,i){if(1&t&&e.Gf(gl,5),2&t){let r;e.iGM(r=e.CRH())&&(i.operationType=r.first)}},decls:32,vars:11,consts:[[1,"estimate-add-part","fx-col","h-100"],[1,"toolbar"],[3,"mode","menuItems"],["tabs",""],[1,"fx-1"],[1,"row"],[1,"col-6"],[3,"inputModel","clicked","controlOutput"],["operationType",""],["operationControl",""],["codeControl",""],[1,"col-6",3,"inputModel","clicked","controlOutput"],[1,"col-6","repair-type"],[1,"footer-button","fx-row","justify-end"],[1,"reset-button",3,"buttonModel"],[3,"buttonModel"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"chq-tabs",2,3),e.qZA(),e.TgZ(4,"form",4),e.TgZ(5,"div",5),e.TgZ(6,"div",6),e.TgZ(7,"chq-input",7,8),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.TgZ(9,"div",6),e.TgZ(10,"chq-input",7,9),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",5),e.TgZ(13,"div",6),e.TgZ(14,"chq-input",7,10),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.TgZ(16,"div",6),e.TgZ(17,"div",5),e.TgZ(18,"chq-input",11),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.TgZ(19,"chq-input",11),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",5),e.TgZ(21,"div",12),e.TgZ(22,"chq-input",7),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.TgZ(23,"div",6),e.TgZ(24,"div",5),e.TgZ(25,"chq-input",11),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(26,"div",5),e._UZ(27,"div",6),e.TgZ(28,"div",6),e.TgZ(29,"div",13),e._UZ(30,"chq-button",14),e._UZ(31,"chq-button",15),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("mode","default")("menuItems",i.menuItems),e.xp6(5),e.Q6J("inputModel",i.formModel.operationType),e.xp6(3),e.Q6J("inputModel",i.formModel.operation),e.xp6(4),e.Q6J("inputModel",i.formModel.code),e.xp6(4),e.Q6J("inputModel",i.formModel.quantity),e.xp6(1),e.Q6J("inputModel",i.formModel.price),e.xp6(3),e.Q6J("inputModel",i.formModel.repairType),e.xp6(3),e.Q6J("inputModel",i.formModel.labourTime),e.xp6(5),e.Q6J("buttonModel",i.resetButtonModel),e.xp6(1),e.Q6J("buttonModel",i.addButtonModel))},directives:[fa.K,A._Y,A.JL,A.F,nn.D,yt.E],styles:[".estimate-add-part[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{margin-bottom:20px}.estimate-add-part[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   chq-tabs[_ngcontent-%COMP%]     button{flex-direction:column;height:45px;grid-gap:0px;gap:0px;font-size:12px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{grid-gap:15px;gap:15px}.estimate-add-part[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:195px}"]}),a})();const Ca=()=>({placeHolder:"labour_time",name:"labourTime",label:"labour_time_hours",value:0,type:"number",maxLength:4,validation:{name:"labourTime",validationFunction:()=>A.kI.compose([A.kI.maxLength(4)]),validationMessage:a=>a.maxlength?"labour_time_not_be_more_than_4_characters":""}}),Oa=(a,c)=>{var t;return{placeHolder:"labour_amount",name:"labourAmount",label:(null===(t=a.instant("labour_amount_currency"))||void 0===t?void 0:t.replace("{{currency}}",c))||"",value:0,type:"number",maxLength:7,validation:{name:"labourTime",validationFunction:()=>A.kI.compose([A.kI.maxLength(7)]),validationMessage:i=>i.maxlength?"labour_amount_not_be_more_than_7_characters":""}}};function fl(){const a={invalidPrice:!1};return c=>c.value>9999999.99?(a.invalidPrice=!0,a):null}const Pe={replace:"Replace",repair:"Repair",removeAndRefit:"Remove & Refit",painting:"Painting",polish:"Polish",checkFields:"Check",performFields:"Perform"};var je=Z(7408),jn=Z(75983),on=Z(8985),Fe=Z(92340),ui=Z(91841);let Fi=(()=>{class a{constructor(t){this.http=t,this.apiUrl="operation",this.repairOperationType=[]}getOperations(t,i=null){const r=(t.currentPage-1)*t.pageSize;return this.http.get(`${Fe.N.caseMgmtUrl}/odata/${this.apiUrl}?${i=i?`$top=${t.pageSize}&$skip=${r}&${i}`:`$top=${t.pageSize}&$skip=${r}`}&$orderby=${t.orderBy} ${t.sortDirection}&count=true`)}getRepairOperationType(){return this.http.get(`${Fe.N.caseMgmtUrl}/api/lookup?type=RepairOperationType`)}addRepairOperation(t,i){return this.http.post(`${Fe.N.caseMgmtUrl}/api/operation/${t}`,i)}editRepairOperation(t){return this.http.put(`${Fe.N.caseMgmtUrl}/api/operation`,t)}deleteOperation(t){return this.http.delete(`${Fe.N.caseMgmtUrl}/api/operation/${t}`)}editRepairEstimateOperation(t,i){return this.http.put(`${Fe.N.caseMgmtUrl}/api/operation/repairoperation/${t}`,i)}getRepairEstimateOperationDetails(t){return this.http.get(`${Fe.N.caseMgmtUrl}/api/operation/repairoperation/${t}`)}deleteRepairEstimateOperation(t,i){return this.http.delete(`${Fe.N.caseMgmtUrl}/api/operation/repairoperation/${t}/${i}`)}addOperationsToReapir(t,i){return this.http.post(`${Fe.N.caseMgmtUrl}/api/operation/repairoperation/${t}`,i)}getParts(t){return this.http.get(`${Fe.N.caseMgmtUrl}/api/repair/${t}/parts`)}getPartStatuses(){return this.http.get(`${Fe.N.caseMgmtUrl}/api/lookup?type=PartStatus`)}editPartStatuses(t,i){return this.http.put(`${Fe.N.caseMgmtUrl}/api/repair/${i}/partStatus`,t)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(ui.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var He=Z(4893);const Ma=["operationTypeControl"],xa=["repairTypeControl"],$o=["operationControl"],_l=["codeControl"],Pa=["informationControl"],Ko=["labourAmountControl"],Xo=["labourTimeControl"],hi=["quantityControl"],ya=["priceControl"];function wa(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"chq-input",19,20),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.TgZ(3,"chq-input",19,21),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("inputModel",t.formModel.quantity),e.xp6(2),e.Q6J("inputModel",t.formModel.price)}}function vl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",2),e.TgZ(1,"chq-input",19,22),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.TgZ(3,"chq-input",19,23),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("inputModel",t.formModel.labourAmount),e.xp6(2),e.Q6J("inputModel",t.formModel.labourTime)}}function Ta(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",19,22),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw(2).hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw(2).onFormUpdate(r)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("inputModel",t.formModel.labourAmount)}}function Da(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",2),e.YNc(1,Ta,2,1,"chq-input",24),e.TgZ(2,"chq-input",19,23),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.formData.operationType===t.OPERATION_TYPE.replace),e.xp6(1),e.Q6J("inputModel",t.formModel.labourTime)}}function Sa(a,c){1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"div",26),e._UZ(2,"mat-icon",27),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.qZA()),2&a&&(e.xp6(2),e.Q6J("svgIcon","information-operation"),e.xp6(2),e.Oqu(e.lcZ(5,2,"operation_replace_information_popup")))}function Ia(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",28),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("inputModel",t.formModel.saveOperation)}}let Ol=(()=>{class a{constructor(t,i,r,s,p,u){this.bookingService=t,this.repairEstimateOperationService=i,this.commonService=r,this.monitorService=s,this.changeDetectorRef=p,this.translateService=u,this.switchToOperationLIst=new e.vpe,this.cancelDialog=new e.vpe,this.OPERATION_TYPE=Pe,this.formData={operationType:"",operation:"",code:"",repairType:"",information:"",quantity:0,price:0,labourTime:0,labourAmount:0,saveOperation:!1},this.currencySymbol="",this.addButtonModel={label:"add",type:"disabled",icon:"",onclick:this.beforeSubmit.bind(this)},this.resetButtonModel={label:"reset",type:"outline",icon:"",onclick:this.resetForm.bind(this)},this.i18n=this.commonService.geti18nInfo(),this.currencySymbol=this.i18n.currencySymbol}ngOnInit(){var t,i;this.monitorService.logEvent("ngOnInit",["OperationAddComponent","addenda-repair"]),this.formModel={operationType:{placeHolder:"select_operation_type",name:"operationType",label:"operation_type",options:[{}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,showSelectedOption:!1,validation:{name:"operationType",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"please_select_operation_type":""}},operation:{placeHolder:"part_operation",label:"part_operation",name:"operation",value:0,type:"text",maxLength:50,required:!0,validation:{name:"operation",validationFunction:()=>A.kI.compose([A.kI.required,A.kI.maxLength(50),A.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:a=>a.required?"please_enter_part_operation":a.maxlength?"part_operation_should_have_not_more_than_50_characters":a.pattern?"part_operation_only_alphanumberic_characters":""}},code:{placeHolder:"code",label:"code",name:"code",value:"",type:"text",maxLength:50,validation:{name:"code",validationFunction:()=>A.kI.compose([A.kI.maxLength(50),A.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:a=>a.maxlength?"code_should_have_not_more_than_50_characters":a.pattern?"part_operation_only_alphanumberic_characters":""}},repairType:{placeHolder:"select_repair_type",name:"repairType",label:"repair_type",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:"",required:!0,validation:{name:"repairType",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"please_select_repair_type":""}},information:{placeHolder:"information",label:"information",name:"information",value:"",type:"textarea",maxLength:150,validation:{name:"information",validationFunction:()=>A.kI.compose([A.kI.maxLength(150),A.kI.pattern(/^[a-z\d\s-_\\/]+$/i)]),validationMessage:a=>a.maxlength?"information_should_have_not_more_than_150_characters":a.pattern?"part_operation_only_alphanumberic_characters":""}},saveOperation:{placeHolder:"",label:"",name:"saveOperation",idField:"saveOperation",value:1,type:"checkbox",options:[{label:"save_operation",id:1,value:1,checked:!1}]}},!this.formModel.operationType.observable&&!(null===(t=this.repairEstimateOperationService.repairOperationType)||void 0===t?void 0:t.length)&&(this.formModel.operationType.observable=this.repairEstimateOperationService.getRepairOperationType(),this.formModel.operationType.onObservableLoad=this.onObservableLoadOperationType.bind(this)),!this.formModel.repairType.observable&&!(null===(i=this.bookingService.repairTypes)||void 0===i?void 0:i.length)&&(this.formModel.repairType.observable=this.bookingService.getRepairTypes(),this.formModel.repairType.onObservableLoad=this.onObservableLoadRepairTypes.bind(this))}ngAfterViewInit(){var t,i;this.monitorService.logEvent("ngAfterViewInit",["OperationAddComponent","addenda-repair"]),this.populateFormData(),(null===(t=this.repairEstimateOperationService.repairOperationType)||void 0===t?void 0:t.length)&&this.onObservableLoadOperationType(this.repairEstimateOperationService.repairOperationType),(null===(i=this.bookingService.repairTypes)||void 0===i?void 0:i.length)&&this.onObservableLoadRepairTypes(this.bookingService.repairTypes),this.checkForFormValidation()}populateFormData(){this.operationToEdit&&(Object.keys(this.operationToEdit).length>0&&(this.addButtonModel.label="save"),this.operationToEdit.Code&&(this.formModel.code=Object.assign(Object.assign({},this.formModel.code),{value:this.operationToEdit.Code}),this.formData.code=this.operationToEdit.Code),this.operationToEdit.Information&&(this.formModel.information.value=this.operationToEdit.Information,this.formData.information=this.operationToEdit.Information),this.operationToEdit.OperationName&&(this.formModel.operation=Object.assign(Object.assign({},this.formModel.operation),{value:this.operationToEdit.OperationName}),this.formData.operation=this.operationToEdit.OperationName))}populateConditionalFieldsData(){var t,i;this.operationToEdit&&(this.operationToEdit.Price&&this.formModel.price&&(this.formModel.price.value=this.operationToEdit.Price,this.formData.price=this.operationToEdit.Price),this.operationToEdit.LabourTime&&this.formModel.labourTime&&(this.formModel.labourTime.value=this.operationToEdit.LabourTime,this.formData.labourTime=this.operationToEdit.LabourTime),this.operationToEdit.LabourAmount&&this.formModel.labourAmount&&(this.formModel.labourAmount.value=this.operationToEdit.LabourAmount,this.formData.labourAmount=this.operationToEdit.LabourAmount),this.operationToEdit.Quantity&&this.formModel.quantity&&(this.formModel.quantity.value=this.operationToEdit.Quantity,this.formData.quantity=this.operationToEdit.Quantity),(this.operationToEdit.LabourAmount||this.operationToEdit.LabourTime)&&this.formData.operationType!==Pe.replace&&this.formData.operationType!==Pe.painting&&(this.operationToEdit.LabourAmount?(null===(t=this.formModel)||void 0===t?void 0:t.labourTime)&&(this.formModel.labourTime.disabled=!0):(null===(i=this.formModel)||void 0===i?void 0:i.labourAmount)&&(this.formModel.labourAmount.disabled=!0)),this.checkForFormValidation(),this.triggerValidation())}triggerValidation(){Object.keys(this.formModel).forEach(t=>{var i,r;"saveOperation"!==t&&(null===(r=null===(i=this.formModel[t])||void 0===i?void 0:i.formControl)||void 0===r?void 0:r.markAsTouched)&&this.formModel[t].formControl.markAsTouched()})}setInitialStateOfForm(){var t;if(null===(t=this.operationToEdit)||void 0===t?void 0:t.RepairOperationTypeId){const i=this.formModel.operationType.options.find(r=>r.id===this.operationToEdit.RepairOperationTypeId);i&&(this.formModel.operationType=Object.assign(Object.assign({},this.formModel.operationType),{selectedOption:i}),this.showHideFieldsBasedOnOperationType({name:this.formModel.operationType.name,type:this.formModel.operationType.type,value:i}),this.populateConditionalFieldsData())}else{const i=this.formModel.operationType.options.find(r=>r.name===Pe.replace);i&&(this.formModel.operationType=Object.assign(Object.assign({},this.formModel.operationType),{selectedOption:i}),this.showHideFieldsBasedOnOperationType({name:this.formModel.operationType.name,type:this.formModel.operationType.type,value:i}))}}hideDropdown(t){t===this.formModel.operationType.name?this.repairTypeControl.closeDropdown():t===this.formModel.repairType.name&&this.operationTypeControl.closeDropdown()}onFormUpdate(t){var i,r,s,p;if("select"===t.type)if(this.formModel[t.name]=Object.assign(Object.assign({},this.formModel[t.name]),{selectedOption:t.value}),"operationType"===t.name)if(this.formData[t.name]=(null===(i=null==t?void 0:t.value)||void 0===i?void 0:i.name)||"",this.showHideFieldsBasedOnOperationType(t),(null===(r=null==t?void 0:t.value)||void 0===r?void 0:r.name)===Pe.painting||(null===(s=null==t?void 0:t.value)||void 0===s?void 0:s.name)===Pe.polish){const u=null===(p=this.formModel.repairType.options)||void 0===p?void 0:p.find(m=>"paint"===m.name.toLowerCase());u&&(this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:u}),this.formData.repairType=u.name,this.repairTypeControl.getDropdownOutput({name:this.formModel.repairType.name,type:this.formModel.repairType.type,value:u}))}else this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:{}}),this.formData.repairType="";else this.formData[t.name]="repairType"===t.name?t.value.name:t.value;else this.formModel[t.name].value=t.value,this.formData[t.name]=t.value,this.formData.operationType!==Pe.painting&&("labourAmount"===t.name?this.formModel.labourTime.disabled=!!t.value:"labourTime"===t.name&&(this.formModel.labourAmount.disabled=!!t.value));this.checkForFormValidation()}showHideFieldsBasedOnOperationType(t){var i,r,s,p,u,m,C,O,v;this.formData[t.name]=(null===(i=null==t?void 0:t.value)||void 0===i?void 0:i.name)||"",(null===(r=null==t?void 0:t.value)||void 0===r?void 0:r.name)===Pe.replace||(null===(s=null==t?void 0:t.value)||void 0===s?void 0:s.name)===Pe.painting?(delete this.formModel.labourTime,delete this.formModel.labourAmount,this.formModel.quantity={placeHolder:"quantity",name:"quantity",label:"quantity",value:0,type:"number",maxLength:3,validation:{name:"quantity",validationFunction:()=>A.kI.compose([A.kI.maxLength(3)]),validationMessage:a=>a.maxlength?"quantity_should_not_be_more_than_3_characters":""}},this.formModel.price=((a,c)=>{var t;return{placeHolder:"price",name:"price",label:(null===(t=this.translateService.instant("price_currency"))||void 0===t?void 0:t.replace("{{currency}}",c))||"",value:0,type:"number",maxLength:10,validation:{name:"price",validationFunction:()=>A.kI.compose([fl()]),validationMessage:i=>i.invalidPrice?"price_max_length_validation":""}}})(0,this.currencySymbol),this.formModel.labourTime=Ca(),(null===(p=null==t?void 0:t.value)||void 0===p?void 0:p.name)===Pe.replace&&(this.formModel.labourAmount=Oa(this.translateService,this.currencySymbol)),this.resetFormData()):(null===(u=null==t?void 0:t.value)||void 0===u?void 0:u.name)===Pe.repair||(null===(m=null==t?void 0:t.value)||void 0===m?void 0:m.name)===Pe.removeAndRefit||(null===(C=null==t?void 0:t.value)||void 0===C?void 0:C.name)===Pe.polish||(null===(O=null==t?void 0:t.value)||void 0===O?void 0:O.name)===Pe.checkFields||(null===(v=null==t?void 0:t.value)||void 0===v?void 0:v.name)===Pe.performFields?(delete this.formModel.quantity,delete this.formModel.price,delete this.formModel.labourTime,this.formModel.labourAmount=Oa(this.translateService,this.currencySymbol),this.formModel.labourTime=Ca(),this.resetFormData()):(delete this.formModel.quantity,delete this.formModel.price,delete this.formModel.labourTime,delete this.formModel.labourAmount,delete this.formModel.labourTime,this.resetFormData())}resetFormData(){var t;this.formData.labourTime=0,this.formData.labourAmount=0,this.formData.price=0,this.formData.quantity=0,(null===(t=this.operationToEdit)||void 0===t?void 0:t.Quantity)||this.formModel.quantity&&(this.formModel.quantity.value=1,this.formData.quantity=1)}checkForFormValidation(){this.addButtonModel.type=this.isOperationFormValid()?"primary":"disabled"}isOperationFormValid(){this.changeDetectorRef.detectChanges();let t=!0;return this.formData.operationType&&this.formData.repairType&&this.formData.operation&&this.operationControl.formControl.valid&&this.codeControl.formControl.valid&&this.informationControl.formControl.valid||(t=!1),this.formData.operationType===Pe.replace||this.formData.operationType===Pe.painting?(this.quantityControl.formControl.valid&&this.priceControl.formControl.valid&&this.labourTimeControl.formControl.valid||(t=!1),this.formData.operationType===Pe.replace&&!this.labourAmountControl.formControl.valid&&(t=!1),this.formData.operationType===Pe.replace&&!this.formData.labourTime&&!this.formData.labourAmount&&(t=!1)):this.formData.operationType!==Pe.repair&&this.formData.operationType!==Pe.removeAndRefit&&this.formData.operationType!==Pe.polish&&this.formData.operationType!==Pe.checkFields&&this.formData.operationType!==Pe.performFields||this.labourAmountControl.formControl.valid&&this.labourTimeControl.formControl.valid||(t=!1),t}onObservableLoadRepairTypes(t){var i,r,s,p;if(t&&t.length>0&&t.forEach((u,m)=>{t[m]=Object.assign(Object.assign({},t[m]),{dropdownItemIcon:this.getIcon(u.name)})}),this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{options:t}),(null===(i=this.bookingService.repairTypes)||void 0===i?void 0:i.length)||(this.bookingService.repairTypes=t),null===(r=this.operationToEdit)||void 0===r?void 0:r.RepairServiceTypeId){const u=null===(s=this.formModel.repairType.options)||void 0===s?void 0:s.find(m=>m.id===this.operationToEdit.RepairServiceTypeId);u&&(this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:u}),this.formData.repairType=u.name,this.checkForFormValidation())}else if(this.formData.operationType===Pe.painting||this.formData.operationType===Pe.polish){const u=null===(p=this.formModel.repairType.options)||void 0===p?void 0:p.find(m=>"Paint"===m.name);u&&(this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:u}),this.formData.repairType=u.name)}}getIcon(t){switch(t){case"Body":return"car";case"Maintenance":return"house";case"Tires":return"tire";case"Paint":return"paintbrush";case"Others":return"gears";case"Electrical":return"bolt-car";case"Diagnosis":return"diagnosis";case"Mechanical":return"mechanical";default:return""}}beforeSubmit(){var t,i;((null===(t=this.operationToEdit)||void 0===t?void 0:t.RepairOperationGuid)||(null===(i=this.operationToEdit)||void 0===i?void 0:i.OperationGuid))&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.submitForm.bind(this),jn.j.quote):this.submitForm()}submitForm(){var t,i;if(!this.isOperationFormValid())return;this.monitorService.logEvent("submitForm",["OperationAddComponent","addenda-repair"]);const r=this.formModel.operationType.options.find(u=>u.name===this.formData.operationType);if(!r)return;let s;this.formData.repairType&&(s=this.formModel.repairType.options.find(u=>u.name===this.formData.repairType));const p={operationName:this.formData.operation,repairOperationTypeId:null==r?void 0:r.id};this.formData.code&&(p.code=this.formData.code),this.formData.information&&(p.information=this.formData.information),s&&(p.repairServiceTypeId=s.id),this.formData.operationType===Pe.replace||this.formData.operationType===Pe.painting?(this.formData.quantity&&(p.quantity=this.formData.quantity),this.formData.price&&(p.price=this.formData.price),this.formData.labourTime&&(p.labourTime=this.formData.labourTime),this.formData.operationType===Pe.replace&&this.formData.labourAmount&&(p.labourAmount=this.formData.labourAmount)):(this.formData.labourTime&&(p.labourTime=this.formData.labourTime),this.formData.labourAmount&&(p.labourAmount=this.formData.labourAmount)),p.labourTime&&"string"==typeof p.labourTime&&(p.labourTime=parseFloat(p.labourTime)),p.labourAmount&&"string"==typeof p.labourAmount&&(p.labourAmount=parseFloat(p.labourAmount)),p.quantity&&"string"==typeof p.quantity&&(p.quantity=parseFloat(p.quantity)),p.price&&"string"==typeof p.price&&(p.price=parseFloat(p.price)),this.commonService.showLoading(),(null===(t=this.operationToEdit)||void 0===t?void 0:t.RepairOperationGuid)?(p.repairOperationGuid=this.operationToEdit.RepairOperationGuid,this.monitorService.logEvent("editRepairEstimateOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:p}),this.repairEstimateOperationService.editRepairEstimateOperation(this.repairId,p).subscribe({next:u=>{u&&(this.commonService.hideLoading(),this.cancelDialog.emit(!0))},error:u=>{this.commonService.hideLoading(),this.monitorService.logException(u,je._.Error)}})):(null===(i=this.operationToEdit)||void 0===i?void 0:i.OperationGuid)?(p.operationGuid=this.operationToEdit.OperationGuid,this.monitorService.logEvent("editRepairOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:p}),this.repairEstimateOperationService.editRepairOperation(p).subscribe({next:u=>{u&&(this.commonService.hideLoading(),this.switchToOperationLIst.emit())},error:u=>{this.commonService.hideLoading(),this.monitorService.logException(u,je._.Error)}})):(p.saveOperation=this.formData.saveOperation,this.monitorService.logEvent("addRepairOperation",["OperationAddComponent","addenda-repair"],{repairId:this.repairId,data:p}),this.repairEstimateOperationService.addRepairOperation(this.repairId,p).subscribe({next:u=>{u&&(this.commonService.hideLoading(),this.cancelDialog.emit(!0))},error:u=>{this.commonService.hideLoading(),this.monitorService.logException(u,je._.Error)}}))}resetForm(t=!0){var i;if(null===(i=this.operationToEdit)||void 0===i?void 0:i.Id)this.populateFormData(),this.setInitialStateOfForm(),this.onObservableLoadRepairTypes(this.formModel.repairType.options);else if(t&&this.setInitialStateOfForm(),this.formModel.code=Object.assign(Object.assign({},this.formModel.code),{value:""}),this.formData.code="",this.formModel.operation=Object.assign(Object.assign({},this.formModel.operation),{value:""}),this.formData.operation="",this.formModel.operation.formControl.reset(),this.formModel.repairType=Object.assign(Object.assign({},this.formModel.repairType),{selectedOption:[]}),this.formData.repairType="",this.formModel.information=Object.assign(Object.assign({},this.formModel.information),{value:""}),this.formData.information="",this.formModel.quantity&&(this.formModel.quantity=Object.assign(Object.assign({},this.formModel.quantity),{value:0}),this.formData.quantity=0),this.formModel.price&&(this.formModel.price=Object.assign(Object.assign({},this.formModel.price),{value:0}),this.formData.price=0),this.formModel.labourTime&&(this.formModel.labourTime=Object.assign(Object.assign({},this.formModel.labourTime),{value:0}),this.formData.labourTime=0),this.formModel.labourAmount&&(this.formModel.labourAmount=Object.assign(Object.assign({},this.formModel.labourAmount),{value:0}),this.formData.labourAmount=0),this.formModel.saveOperation){const r=this.formModel.saveOperation.options;r[0].checked=!1,this.formModel.saveOperation=Object.assign(Object.assign({},this.formModel.saveOperation),{options:[...r]}),this.formData.saveOperation=!1}}onObservableLoadOperationType(t){this.formModel.operationType=Object.assign(Object.assign({},this.formModel.operationType),{options:t}),this.repairEstimateOperationService.repairOperationType=t,this.setInitialStateOfForm()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(on.q),e.Y36(Fi),e.Y36(He.v),e.Y36(Ge.M),e.Y36(e.sBO),e.Y36(we.sK))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-operation-add"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Ma,5),e.Gf(xa,5),e.Gf($o,5),e.Gf(_l,5),e.Gf(Pa,5),e.Gf(Ko,5),e.Gf(Xo,5),e.Gf(hi,5),e.Gf(ya,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.operationTypeControl=r.first),e.iGM(r=e.CRH())&&(i.repairTypeControl=r.first),e.iGM(r=e.CRH())&&(i.operationControl=r.first),e.iGM(r=e.CRH())&&(i.codeControl=r.first),e.iGM(r=e.CRH())&&(i.informationControl=r.first),e.iGM(r=e.CRH())&&(i.labourAmountControl=r.first),e.iGM(r=e.CRH())&&(i.labourTimeControl=r.first),e.iGM(r=e.CRH())&&(i.quantityControl=r.first),e.iGM(r=e.CRH())&&(i.priceControl=r.first)}},inputs:{operationToEdit:"operationToEdit",repairId:"repairId"},outputs:{switchToOperationLIst:"switchToOperationLIst",cancelDialog:"cancelDialog"},decls:35,vars:12,consts:[[1,"estimate-add-operation","fx-col","h-100"],[1,"fx-1"],[1,"row"],[1,"col-6"],[3,"inputModel","clicked","controlOutput"],["operationTypeControl",""],["operationControl",""],["codeControl",""],["class","row",4,"ngIf"],[1,"col-6","repair-type"],["repairTypeControl",""],["informationControl",""],["class","information",4,"ngIf"],[1,"fx-0","justify-space-between","d-flex"],[1,"col-6","save-operation"],[3,"inputModel","controlOutput",4,"ngIf"],[1,"footer-button"],[1,"reset-button",3,"buttonModel"],[3,"buttonModel"],[1,"col-6",3,"inputModel","clicked","controlOutput"],["quantityControl",""],["priceControl",""],["labourAmountControl",""],["labourTimeControl",""],["class","col-6",3,"inputModel","clicked","controlOutput",4,"ngIf"],[1,"information"],[1,"icon-wrapper"],[1,"cross",3,"svgIcon"],[3,"inputModel","controlOutput"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"form",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"chq-input",4,5),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.TgZ(6,"div",3),e.TgZ(7,"chq-input",4,6),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",2),e.TgZ(10,"div",3),e.TgZ(11,"chq-input",4,7),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.TgZ(13,"div",3),e.YNc(14,wa,5,2,"div",8),e.YNc(15,vl,5,2,"div",8),e.qZA(),e.qZA(),e.TgZ(16,"div",2),e.TgZ(17,"div",9),e.TgZ(18,"chq-input",4,10),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.TgZ(20,"div",3),e.YNc(21,Da,4,2,"div",8),e.qZA(),e.qZA(),e.TgZ(22,"div",2),e.TgZ(23,"div",3),e.TgZ(24,"chq-input",4,11),e.NdJ("clicked",function(s){return i.hideDropdown(s)})("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.TgZ(26,"div",3),e.YNc(27,Sa,6,4,"div",12),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"div",13),e.TgZ(29,"div",14),e.YNc(30,Ia,1,1,"chq-input",15),e.qZA(),e.TgZ(31,"div",3),e.TgZ(32,"div",16),e._UZ(33,"chq-button",17),e._UZ(34,"chq-button",18),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("inputModel",i.formModel.operationType),e.xp6(3),e.Q6J("inputModel",i.formModel.operation),e.xp6(4),e.Q6J("inputModel",i.formModel.code),e.xp6(3),e.Q6J("ngIf",i.formData.operationType===i.OPERATION_TYPE.replace||i.formData.operationType===i.OPERATION_TYPE.painting),e.xp6(1),e.Q6J("ngIf",i.formData.operationType===i.OPERATION_TYPE.repair||i.formData.operationType===i.OPERATION_TYPE.removeAndRefit||i.formData.operationType===i.OPERATION_TYPE.polish||i.formData.operationType===i.OPERATION_TYPE.checkFields||i.formData.operationType===i.OPERATION_TYPE.performFields),e.xp6(3),e.Q6J("inputModel",i.formModel.repairType),e.xp6(3),e.Q6J("ngIf",i.formData.operationType===i.OPERATION_TYPE.replace||i.formData.operationType===i.OPERATION_TYPE.painting),e.xp6(3),e.Q6J("inputModel",i.formModel.information),e.xp6(3),e.Q6J("ngIf",i.formData.operationType===i.OPERATION_TYPE.replace),e.xp6(3),e.Q6J("ngIf",!(null!=i.operationToEdit&&i.operationToEdit.Id)),e.xp6(3),e.Q6J("buttonModel",i.resetButtonModel),e.xp6(1),e.Q6J("buttonModel",i.addButtonModel))},directives:[A._Y,A.JL,A.F,nn.D,_.O5,yt.E,Xe.Hw],pipes:[we.X$],styles:['.estimate-add-operation[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{display:flex;justify-content:end}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]     button{width:195px}.estimate-add-operation[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{margin-right:15px}.estimate-add-operation[_ngcontent-%COMP%]   .save-operation[_ngcontent-%COMP%]{display:flex;align-items:center}.estimate-add-operation[_ngcontent-%COMP%]   .repair-type[_ngcontent-%COMP%]     .dropdown-wrapper   mat-icon{height:15px;width:15px}.estimate-add-operation[_ngcontent-%COMP%]     textarea{font-family:"Inter",sans-serif;font-size:14px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .checkmark{height:20px;width:20px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .span-label{font-size:12px;color:#0b0e15;padding-left:10px}.estimate-add-operation[_ngcontent-%COMP%]     .checkbox-wrapper .checkbox .checkmark:after{left:7px;top:2px;width:5px;height:9px}.estimate-add-operation[_ngcontent-%COMP%]   .information[_ngcontent-%COMP%]{border-radius:8px;border:1px solid var(--xa-blue);background:rgba(59,130,246,.35);box-shadow:0 2px 4px rgba(0,0,0,.05);padding:7px 20px;display:flex;align-items:center}.estimate-add-operation[_ngcontent-%COMP%]   .information[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--xa-secondary);font-family:Inter;font-size:14px;font-style:normal;font-weight:400;line-height:18px;margin-left:20px}@media (orientation: portrait){.estimate-add-operation[_ngcontent-%COMP%]     .input-wrapper   label{max-width:100%}}.operation-content.edit-estimate[_ngcontent-%COMP%]{flex:1}.operation-content[_ngcontent-%COMP%]:not(.edit-estimate){height:calc(80vh - 186px);overflow:hidden;overflow-y:auto}']}),a})();var er=Z(7772);const Ml={columns:[{id:"Selection",width:"60px",header:{text:"",tooltip:"",style:"visibility: hidden"},selector:{field:"OperationGuid"},cellStyle:"justify-content:center;padding:0",widget:{type:"checkbox"}},{id:"Part",sortable:!1,header:{text:"part_operation",tooltip:""},selector:{field:"OperationName"},widget:{type:"text"}},{id:"Code",sortable:!1,selector:{field:"Code"},header:{text:"code",tooltip:""},widget:{type:"text"}},{id:"Information",sortable:!1,selector:{field:"Information"},header:{text:"information",tooltip:""},widget:{type:"text"}},{id:"RepairType",sortable:!1,selector:{field:"RepairServiceType"},header:{text:"repair_type",tooltip:""},widget:{type:"text"}},{id:"Price",sortable:!1,selector:{field:"Price"},header:{text:"Price",tooltip:""},widget:{type:"number"}},{id:"LabourTime",sortable:!1,selector:{field:"LabourTime"},header:{text:"labour_time",tooltip:"",style:""},cellStyle:"",widget:{type:"text"}},{id:"EditAction",width:"30px",sortable:!1,style:"border-right: 0",selector:{field:"OperationGuid"},header:{text:"",tooltip:"",style:"visibility: hidden"},cellStyle:"justify-content: center; border-right: 0",widget:{type:"icon",config:{svgIcon:"edit",style:"width: 18px; height: 18px;"}}},{id:"DeleteAction",width:"30px",sortable:!1,selector:{field:"OperationGuid"},header:{text:"",tooltip:"",style:"visibility: hidden"},cellStyle:"justify-content: center",widget:{type:"icon",config:{svgIcon:"delete",style:"fill: var(--xa-dark-red2) !important; width: 15px; height: 15px;"}}}]};var Aa=Z(63298);const xl=["operationTable"];function Pl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"chq-paginator",11,12),e.NdJ("paginationChange",function(r){return e.CHM(t),e.oxw(2).handlePaginationChange(r)}),e.qZA(),e.qZA()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("pagination",t.pagination)}}function tr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"div",2),e.TgZ(2,"div"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.TgZ(5,"div",3),e.ynx(6),e.TgZ(7,"div",4),e._UZ(8,"chq-mat-table",5,6),e.qZA(),e.YNc(10,Pl,3,1,"div",7),e.BQk(),e.qZA(),e.TgZ(11,"div",8),e.TgZ(12,"chq-button",9),e.NdJ("click",function(r){return e.CHM(t),e.oxw().handleRefreshOperationList(r)}),e.qZA(),e.TgZ(13,"chq-button",9),e.NdJ("click",function(r){return e.CHM(t),e.oxw().handleAddClick(r)}),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(3),e.AsE("",e.lcZ(4,11,"selected_operations"),": ",t.selectedRows.length,""),e.xp6(4),e.Q6J("ngClass",(null==t.tableData?null:t.tableData.length)>0&&t.pagination.count>t.pagination.pageSize?"height-with-pagination":"height-without-pagination"),e.xp6(1),e.Q6J("config",t.tableConfig)("tableData",t.tableData)("cellClicked",t.handleCellClick)("pageChanged",t.pageChanged)("i18n",t.i18n),e.xp6(2),e.Q6J("ngIf",(null==t.tableData?null:t.tableData.length)>0&&t.pagination.count>t.pagination.pageSize),e.xp6(2),e.Q6J("buttonModel",t.refreshButtonModel),e.xp6(1),e.Q6J("buttonModel",t.addButtonModel)}}let yl=(()=>{class a{constructor(t,i,r){this.repairEstimateOperationService=t,this.monitorService=i,this.commonService=r,this.tableData=[],this.pageChanged=!1,this.selectedRows=[],this.pagination=er.G,this.showData=!1,this.configData=Ml,this.handleEditRow=new e.vpe,this.cancelDialog=new e.vpe,this.refreshButtonModel={label:"refresh",type:"outline",icon:""},this.addButtonModel={label:"add",type:"disabled",icon:""},this.handleCellClick=(s,p)=>{var u,m,C,O,v,w,D,T,R,I;"Selection"===p.id?(-1!==this.selectedRows.indexOf(null===(m=null===(u=s[0])||void 0===u?void 0:u.result)||void 0===m?void 0:m.value)?this.selectedRows.splice(this.selectedRows.indexOf(null===(O=null===(C=s[0])||void 0===C?void 0:C.result)||void 0===O?void 0:O.value),1):this.selectedRows.push(null===(w=null===(v=s[0])||void 0===v?void 0:v.result)||void 0===w?void 0:w.value),this.monitorService.logEvent("handleCellClick",["OperationListComponent","addenda-repair"],{selectedRows:this.selectedRows}),this.changeAddButtonState()):"DeleteAction"===p.id?this.deleteRow(null===(T=null===(D=s[0])||void 0===D?void 0:D.result)||void 0===T?void 0:T.value):"EditAction"===p.id&&this.editRow(null===(I=null===(R=s[0])||void 0===R?void 0:R.result)||void 0===I?void 0:I.value)},this.changeAddButtonState=()=>{this.addButtonModel.type=this.selectedRows.length>0?"primary":"disabled"},this.handleRefreshOperationList=s=>{var p,u;this.selectedRows=[],null===(u=null===(p=this.operationTable)||void 0===p?void 0:p.selection)||void 0===u||u.clear(),this.getOperations()},this.handleAddClick=s=>{0!==this.selectedRows.length&&(this.monitorService.logEvent("handleAddClick",["OperationListComponent","addenda-repair"],{repairId:this.repairId,operationds:this.selectedRows}),this.commonService.showLoading(),this.repairEstimateOperationService.addOperationsToReapir(this.repairId,this.selectedRows).subscribe({next:p=>{p&&this.cancelDialog.emit(!0),this.commonService.hideLoading()},error:p=>{this.commonService.hideLoading(),this.monitorService.logException(p,je._.Error)}}))},this.i18n=this.commonService.geti18nInfo()}ngOnInit(){this.monitorService.logEvent("ngOnInit",["OperationListComponent","addenda-repair"]),this.tableConfig=this.configData,this.showData=!1,this.pagination=Object.assign(Object.assign({},this.pagination),{pageSize:10,count:0,currentPage:a.currentPage,orderBy:"Id",sortDirection:"desc"}),this.getOperations()}getOperations(){return(0,Ze.mG)(this,void 0,void 0,function*(){return this.commonService.showLoading(),this.monitorService.logEvent("getOperations",["OperationListComponent","addenda-repair"]),(0,dt.z)(this.repairEstimateOperationService.getOperations(this.pagination)).then(t=>{t.value&&(this.tableData=t.value,this.showData=!0,this.pagination=Object.assign(Object.assign({},this.pagination),{count:t["@odata.count"]}),this.changeAddButtonState(),setTimeout(()=>{const i=[];this.selectedRows.forEach(r=>{t.value.find(p=>p.OperationGuid==r)&&i.push({id:"Selection",result:{value:r}})}),i.length>0&&this.operationTable.selectMultiple(i)})),this.commonService.hideLoading()}).catch(t=>{this.commonService.hideLoading(),this.monitorService.logException(t,je._.Error)})})}handlePaginationChange(t){const i={pageSize:t.pageSize,offset:t.offset,currentPage:t.currentPage};this.pagination.currentPage=t.currentPage,this.pagination=Object.assign(Object.assign({},this.pagination),i),this.pageChanged=!0,this.getOperations()}deleteRow(t){this.commonService.openDeleteDialog().afterClosed().subscribe(i=>{i&&(this.commonService.showLoading(),this.monitorService.logEvent("deleteRow",["OperationListComponent","addenda-repair"],{selectedRows:this.selectedRows}),(0,dt.z)(this.repairEstimateOperationService.deleteOperation(t)).then(r=>{(null==r?void 0:r.message)&&this.commonService.showInfoToast(5e3,r.message),-1!==this.selectedRows.indexOf(t)&&this.selectedRows.splice(this.selectedRows.indexOf(t),1),this.getOperations()}).catch(r=>{this.commonService.hideLoading(),this.monitorService.logException(r,je._.Error)}))})}editRow(t){if(t){const i=this.tableData.find(r=>r.OperationGuid==t);i&&this.handleEditRow.emit(i)}}}return a.currentPage=1,a.\u0275fac=function(t){return new(t||a)(e.Y36(Fi),e.Y36(Ge.M),e.Y36(He.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-operation-list"]],viewQuery:function(t,i){if(1&t&&e.Gf(xl,5),2&t){let r;e.iGM(r=e.CRH())&&(i.operationTable=r.first)}},inputs:{repairId:"repairId"},outputs:{handleEditRow:"handleEditRow",cancelDialog:"cancelDialog"},decls:1,vars:1,consts:[["class","h-100 fx-col",4,"ngIf"],[1,"h-100","fx-col"],[1,"selected-operations"],[1,"table-container"],[1,"table-wrapper",3,"ngClass"],[3,"config","tableData","cellClicked","pageChanged","i18n"],["operationTable",""],["class","pagination-wrapper",4,"ngIf"],[1,"footer-button"],[3,"buttonModel","click"],[1,"pagination-wrapper"],[3,"pagination","paginationChange"],["paginator",""]],template:function(t,i){1&t&&e.YNc(0,tr,14,13,"div",0),2&t&&e.Q6J("ngIf",i.showData)},directives:[_.O5,_.mk,Aa.B,yt.E,er.l],pipes:[we.X$],styles:[".table-container[_ngcontent-%COMP%]   .height-with-pagination[_ngcontent-%COMP%]{height:calc(90vh - 244px - 39px);overflow:auto}.table-container[_ngcontent-%COMP%]   .height-without-pagination[_ngcontent-%COMP%]{height:calc(90vh - 244px);overflow:auto}.table-container[_ngcontent-%COMP%]     thead{position:sticky;top:0;z-index:1}.table-container[_ngcontent-%COMP%]     mat-cell:first-of-type, .table-container[_ngcontent-%COMP%]     mat-header-cell:first-of-type, .table-container[_ngcontent-%COMP%]     mat-footer-cell:first-of-type{padding-left:0!important}.footer-button[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px}.footer-button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{margin-right:20px}.selected-operations[_ngcontent-%COMP%]{font-size:14px;line-height:20px;color:var(--xa-dark-gray);padding-bottom:11px;text-align:end}"]}),a})();function wl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",8),e.TgZ(1,"chq-tabs",9),e.NdJ("menuItemClick",function(r){return e.CHM(t),e.oxw().onMenuItemClick(r)}),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("mode","button")("menuItems",t.menuItems)}}function Tl(a,c){1&a&&(e.ynx(0),e._UZ(1,"app-part-add"),e.BQk())}function Dl(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-operation-add",10),e.NdJ("cancelDialog",function(r){return e.CHM(t),e.oxw().cancelDialog(r)})("switchToOperationLIst",function(){return e.CHM(t),e.oxw().switchToOperationList()}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("operationToEdit",t.operationToEdit)("repairId",t.data.repairId)}}function Sl(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-operation-list",11),e.NdJ("handleEditRow",function(r){return e.CHM(t),e.oxw().switchToEditOperation(r)})("cancelDialog",function(r){return e.CHM(t),e.oxw().cancelDialog(r)}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("repairId",t.data.repairId)}}let Ie=(()=>{class a{constructor(t,i,r){this.data=t,this.dialogRef=i,this.monitorService=r,this.menuItems=[...Nn.HT],this.operationToEdit={},this.editrepairEstimateOperation=!1}cancelDialog(t){this.dialogRef.close(t)}ngOnInit(){var t;this.monitorService.logEvent("ngOnInit",["RepairEstimateOperationComponent","addenda-repair"]),this.menuItems[0].active=!0,this.activeMenu=this.menuItems[0].name,(null===(t=this.data)||void 0===t?void 0:t.operationDetails)&&(this.operationToEdit=this.data.operationDetails,this.editrepairEstimateOperation=!0,this.onMenuItemClick(this.menuItems[0]))}onMenuItemClick(t){this.menuItems.forEach(r=>r.active=!1);const i=this.menuItems.findIndex(r=>r.name==t.name);this.menuItems[i].active=!0,this.activeMenu=this.menuItems[i].name,"create-parts-operations"!==this.activeMenu&&(this.operationToEdit={})}switchToEditOperation(t){this.operationToEdit=t,this.onMenuItemClick(this.menuItems[0])}switchToOperationList(){this.onMenuItemClick(this.menuItems[1])}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ye.WI),e.Y36(Ye.so),e.Y36(Ge.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-repair-estimate-operation"]],decls:13,vars:8,consts:[[1,"operation-container","fx-col"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content","fx-col","fx-1"],["class","content-header",4,"ngIf"],[1,"content-body","fx-1"],[4,"ngIf"],[1,"content-header"],[3,"mode","menuItems","menuItemClick"],[3,"operationToEdit","repairId","cancelDialog","switchToOperationLIst"],[3,"repairId","handleEditRow","cancelDialog"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2),e.TgZ(6,"mat-icon",3),e.NdJ("click",function(){return i.cancelDialog(!1)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",4),e.YNc(8,wl,2,2,"div",5),e.TgZ(9,"div",6),e.YNc(10,Tl,2,0,"ng-container",7),e.YNc(11,Dl,2,2,"ng-container",7),e.YNc(12,Sl,2,1,"ng-container",7),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,6,"operation")),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(2),e.Q6J("ngIf",!i.editrepairEstimateOperation),e.xp6(2),e.Q6J("ngIf","add-parts"===i.activeMenu),e.xp6(1),e.Q6J("ngIf","create-parts-operations"===i.activeMenu),e.xp6(1),e.Q6J("ngIf","operation-list"===i.activeMenu))},directives:[Xe.Hw,_.O5,fa.K,_a,Ol,yl],pipes:[we.X$],styles:['.operation-container[_ngcontent-%COMP%]{height:calc(90vh - 40px);overflow:auto;padding:20px}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:flex-end;display:flex;cursor:pointer}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:36px!important;width:36px!important;background:var(--xa-black);border-radius:50%;text-align:center}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.operation-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg   path{fill:var(--xa-white)}.operation-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:15px}.operation-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]{margin-bottom:15px}.operation-container[_ngcontent-%COMP%]     button{font-family:"Inter",sans-serif}']}),a})();var ke=Z(14368),cn=Z(83853),nr=Z(85567);const Il=["code"],Al=["phone"];function Zl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"div",15),e.TgZ(2,"chq-input",16),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(2),e.Q6J("inputModel",t.emailForm.email)}}function kl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",14),e.TgZ(1,"div",17),e.TgZ(2,"chq-input",18,19),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.TgZ(4,"chq-input",16,20),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(2),e.Q6J("inputModel",t.emailForm.code),e.xp6(2),e.Q6J("inputModel",t.emailForm.phone)}}function Za(a,c){if(1&a&&(e.TgZ(0,"div",8),e.TgZ(1,"label",9),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"label",21),e.qZA()),2&a){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,2,"subject")," "),e.xp6(2),e.Q6J("innerHTML",t.data.emailSubject,e.oJD)}}function ql(a,c){1&a&&(e.TgZ(0,"div",22),e.TgZ(1,"label",23),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",24),e.TgZ(6,"label"),e._uU(7,"Repair Estimate"),e.qZA(),e.TgZ(8,"div",25),e._UZ(9,"mat-icon",3),e.qZA(),e.qZA(),e.qZA()),2&a&&(e.xp6(2),e.hij(" ",e.lcZ(3,2,e.lcZ(4,4,"attachments"))," "),e.xp6(7),e.Q6J("svgIcon","pdf-file"))}let rt=(()=>{class a{constructor(t,i,r,s,p){this.dialogRef=t,this.monitorService=i,this.coreService=r,this.commonService=s,this.data=p,this.emailRequest={subject:"",email:[],message:"",phone:"",code:""},this.step={},this.emailForm={subject:{placeHolder:"subject",label:"subject",name:"subject",value:0,type:"text",validation:{name:"subject",validationFunction:()=>A.kI.compose([A.kI.required,A.kI.maxLength(100)]),validationMessage:u=>u.required?"send_message":u.maxlength?"subject_length":""}},email:{label:"email_address",name:"email",placeHolder:"email_address",value:"",type:"text",required:!0,validation:{name:"email",validationFunction:()=>A.kI.compose([A.kI.required,(0,cn.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:u=>u.required?"email_required":u.invalidEmailNumber?"email_invalid_number":u.invalidEmail?"email_valid":""}},code:{placeHolder:"select_dot",label:"code",name:"code",value:91,showImageFlag:!0,type:"select",selectedOption:{phoneCountryCode:"+91"},displayValue:"phoneCountryCode",fieldValue:"phoneCountryCode",options:[{label:"+90"},{label:"+971"},{label:"+977"}],required:!0,validation:{name:"driverCode",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:u=>u.required?"required_code":""}},phone:{placeHolder:"mobile_number",label:"mobile_number",name:"phone",value:0,type:"number",required:!0,validation:{name:"driverPhone",validationFunction:()=>A.kI.compose([A.kI.required,A.kI.pattern("^[0-9]+[0-9 ,.'-]+$")]),validationMessage:u=>u.required?"required_mobile_number":u.pattern?"valid_mobile_number":""}}},this.selectedCode=""}onFormUpdate(t){var i,r;if(this.emailRequest[t.name]=!!t.isValid&&("email"===t.name?(null===(i=t.value)||void 0===i?void 0:i.split(","))||[]:t.value),"code"===t.name&&this.selectedCode!==t.value.phoneCountryCode){const s=t.value.regExpression;null===(r=this.phone)||void 0===r||r.updateCurrentValidation(s),this.selectedCode=t.value.phoneCountryCode,this.emailForm.code=Object.assign(Object.assign({},this.emailForm.code),{selectedOption:t.value}),this.emailForm.phone.value=""}this.sendButton=Object.assign(Object.assign({},this.sendButton),"email"===this.data.channel?this.emailRequest.email?{type:"primary"}:{type:"disabled"}:this.emailRequest.phone&&this.emailForm.code.selectedOption?{type:"primary"}:{type:"disabled"})}cancel(){this.monitorService.logEvent("send",["EmailDialogComponent","addenda"]),this.dialogRef.close()}send(){let t;this.monitorService.logEvent("send",["EmailDialogComponent","addenda"]),t="email"===this.data.channel?{toEmails:this.emailRequest.email,communicationTypeIds:[2],templateKey:"EstimateApprovalRequest"}:"whatsapp"===this.data.channel?{messageContent:btoa(this.data.body),PhoneNumber:`${this.emailForm.code.selectedOption.phoneCountryCode}${this.emailRequest.phone}`,communicationTypeIds:[1],templateKey:"EstimateApprovalRequest"}:{messageContent:btoa(this.data.body),PhoneNumber:`${this.emailForm.code.selectedOption.phoneCountryCode}${this.emailRequest.phone}`,communicationTypeIds:[3],templateKey:"EstimateApprovalRequest"},this.dialogRef.close(t)}setMessageHTML(t){this.emailRequest.message=btoa(t)}ngOnInit(){var t;this.monitorService.logEvent("ngOnInit",["EmailDialogComponent","addenda"]),(null===(t=this.emailForm.code)||void 0===t?void 0:t.observable)||(this.emailForm.code.observable=this.coreService.getPhoneNumber(),this.emailForm.code.onObservableLoad=this.onObservableLoad.bind(this)),this.data.email&&(this.emailForm.email=Object.assign(Object.assign({},this.emailForm.email),{value:this.data.email}),this.emailRequest=Object.assign(Object.assign({},this.emailRequest),{email:[this.data.email]})),this.sendButton={label:"send",type:"disabled",icon:"send",onclick:this.send.bind(this)},this.emailForm.code.selectedOption[this.emailForm.code.displayValue]=this.data.code,this.emailForm.phone=Object.assign(Object.assign({},this.emailForm.phone),{value:this.data.phone}),this.sendButton=Object.assign(Object.assign({},this.sendButton),"email"===this.data.channel?this.emailRequest.email?{type:"primary"}:{type:"disabled"}:this.emailRequest.phone&&this.emailForm.code.selectedOption?{type:"primary"}:{type:"disabled"})}onObservableLoad(t){if(this.commonService.hideLoading(),t&&t&&t.length>0){const i=t.filter(r=>{var s;return r.phoneCountryCode===(null===(s=this.emailForm.code.selectedOption)||void 0===s?void 0:s.phoneCountryCode)});if(i.length>0){const r=i[0],s=r.regExpression;this.emailForm.code=Object.assign(Object.assign({},this.emailForm.code),{selectedOption:r}),this.phone&&this.phone.updateCurrentValidation(s,!0)}}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ye.so),e.Y36(Ge.M),e.Y36(nr.p),e.Y36(He.v),e.Y36(Ye.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["request-approval-dialog"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Il,5),e.Gf(Al,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.code=r.first),e.iGM(r=e.CRH())&&(i.phone=r.first)}},decls:20,vars:13,consts:[[1,"dialog-container"],[1,"header"],[1,"close-icon",3,"click"],[3,"svgIcon"],["mat-dialog-content","",1,"email-dialog-body"],[1,"form-container"],["class","input-wrapper",4,"ngIf"],["class","input-wrapper label-wrapper",4,"ngIf"],[1,"input-wrapper","label-wrapper"],[1,"title"],[1,"message-content",3,"innerHTML"],["class","attachment-list",4,"ngIf"],[1,"btn-container"],[1,"right",3,"buttonModel"],[1,"input-wrapper"],[1,"div-wrapper"],[3,"inputModel","controlOutput"],[1,"div-wrapper","fx-row",2,"gap","10px"],[2,"width","115px",3,"inputModel","controlOutput"],["code",""],["phone",""],[3,"innerHTML"],[1,"attachment-list"],[1,"attachment-header"],[1,"files"],[1,"attachment-icon"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2),e.NdJ("click",function(){return i.cancel()}),e._UZ(6,"mat-icon",3),e.qZA(),e.qZA(),e.TgZ(7,"div",4),e.TgZ(8,"div",5),e.YNc(9,Zl,3,1,"div",6),e.YNc(10,kl,6,2,"div",6),e.YNc(11,Za,5,4,"div",7),e.TgZ(12,"div",8),e.TgZ(13,"label",9),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"label",10),e.qZA(),e.qZA(),e.YNc(17,ql,10,6,"div",11),e.qZA(),e.TgZ(18,"div",12),e._UZ(19,"chq-button",13),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,9,i.data.title)),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(3),e.Q6J("ngIf","email"===(null==i.data?null:i.data.channel)),e.xp6(1),e.Q6J("ngIf","email"!==(null==i.data?null:i.data.channel)),e.xp6(1),e.Q6J("ngIf","email"===(null==i.data?null:i.data.channel)&&i.data.emailSubject),e.xp6(3),e.hij("",e.lcZ(15,11,"message")," "),e.xp6(2),e.Q6J("innerHTML",i.data.body,e.oJD),e.xp6(1),e.Q6J("ngIf","email"===(null==i.data?null:i.data.channel)),e.xp6(2),e.Q6J("buttonModel",i.sendButton))},directives:[Xe.Hw,Ye.xY,_.O5,yt.E,nn.D],pipes:[we.X$,_.gd],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--xa-popup-light-gray)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:30px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{margin-bottom:24px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:first-child{text-transform:uppercase;font-size:12px;line-height:14px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{display:flex;grid-gap:8px;gap:8px;flex-direction:column}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;line-height:14px;font-weight:400}.dialog-container[_ngcontent-%COMP%]   .email-dialog-body[_ngcontent-%COMP%]{max-height:calc(90vh - 174px)!important;padding:0 30px!important}.dialog-container[_ngcontent-%COMP%]   .attachment-list[_ngcontent-%COMP%]{margin-bottom:24px}.toggle-wrapper[_ngcontent-%COMP%]{margin-top:22px;font-weight:400;font-size:12px;color:var(--xa-neutral-black);display:flex;grid-gap:10px;gap:10px;align-items:center;line-height:14px}.files[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:5px 0;align-items:center}.files[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-black);font-size:14px;font-weight:500;line-height:14px}.files[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-red)!important}.attachment-icon[_ngcontent-%COMP%]{grid-gap:26px;gap:26px;display:flex}.attachment-header[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:12px}.cc-span[_ngcontent-%COMP%]{position:absolute;right:10px;font-size:16px;line-height:14px;top:44px;color:var(--xa-black-medium);cursor:pointer}.message[_ngcontent-%COMP%]{font-weight:500;color:var(--xa-black-dark);font-size:14px;line-height:14px;margin-bottom:18px;display:flex}.div-wrapper[_ngcontent-%COMP%]{position:relative}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;grid-gap:10px;gap:10px;padding:0 30px 30px;background:var(--xa-popup-light-gray)}.cc-email[_ngcontent-%COMP%]     input{padding-right:36px!important}.message-content[_ngcontent-%COMP%]{font-size:16px!important;font-weight:400;line-height:20px!important;color:var(--xa-black)}  .message-content td{border-radius:5px!important;padding:5px!important}  .message-content a{color:#fff!important;text-decoration:none!important;pointer-events:none!important}"]}),a})();function ka(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"chq-input",11),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("inputModel",t.notesModel)}}const gi=function(a){return{selected:a}};let qa=(()=>{class a{constructor(t,i,r,s,p){this.commonService=t,this.bookingService=i,this.route=r,this.data=s,this.dialogRef=p,this.approveRadio={placeHolder:"approve",label:"approve",name:"approve",idField:"",value:"1",type:"radio",hideLabel:!0,options:[{label:"approve",id:1}]},this.notesModel={placeHolder:"let_us_know_issue",label:"notes",name:"notes",value:"",type:"textarea",maxLength:300,rows:4},this.repairId="",this.urlToken="",this.checkedStatus="",this.reason="",this.declineRadio={placeHolder:"decline",label:"decline",name:"decline",idField:"",value:"2",type:"radio",hideLabel:!0,options:[{label:"decline",id:2}]},this.cancelButtonModel={label:"cancel",type:"outline"},this.nextButtonModel={label:"confirm",type:"disabled"}}cancel(){this.dialogRef.close(!1)}updateRepairStatus(){const t="Approved"===this.checkedStatus?"Approved":"Rejected";this.commonService.showLoading(),this.bookingService.updateRepairStatus(t,this.repairId,this.reason.trim()).subscribe({next:()=>{this.dialogRef.close(!0),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}ngOnInit(){this.repairId=this.data,console.log(this.repairId),this.nextButtonModel=Object.assign(Object.assign({},this.nextButtonModel),{onclick:this.updateRepairStatus.bind(this)}),this.cancelButtonModel=Object.assign(Object.assign({},this.cancelButtonModel),{onclick:this.cancel.bind(this)})}onFormUpdate(t){const{name:i,value:r}=t;"approve"===i?2!==this.declineRadio.value&&r&&(this.checkedStatus="Approved",this.nextButtonModel=Object.assign(Object.assign({},this.nextButtonModel),{type:"primary"}),this.declineRadio=Object.assign(Object.assign({},this.declineRadio),{value:""})):"decline"===i?1!==this.approveRadio.value&&r&&(this.checkedStatus="declined",this.reason.trim()&&(this.nextButtonModel=Object.assign(Object.assign({},this.nextButtonModel),{type:"primary"})),this.approveRadio=Object.assign(Object.assign({},this.approveRadio),{value:""})):"notes"===i&&(this.reason=r,this.nextButtonModel=this.checkedStatus&&"declined"===this.checkedStatus&&this.reason.trim()?Object.assign(Object.assign({},this.nextButtonModel),{type:"primary"}):Object.assign(Object.assign({},this.nextButtonModel),{type:"disabled"}))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(He.v),e.Y36(on.q),e.Y36(Be.gz),e.Y36(Ye.WI),e.Y36(Ye.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-estimate-approval"]],decls:26,vars:25,consts:[[1,"approval-form"],[1,"wrapper"],[1,"wrapper-header"],[1,"radio-container"],[1,"radio-wrapper",3,"ngClass"],["aria-hidden","false","aria-label","edit icon",3,"svgIcon"],[1,"company-input","col-3",3,"inputModel","controlOutput"],["class","content",4,"ngIf"],[1,"button-container"],[3,"buttonModel"],[1,"content"],["tabindex","-1",3,"inputModel","controlOutput"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"h3"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.qZA(),e.TgZ(9,"div",3),e.TgZ(10,"div",4),e._UZ(11,"mat-icon",5),e.TgZ(12,"label"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"chq-input",6),e.NdJ("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.TgZ(16,"div",4),e._UZ(17,"mat-icon",5),e.TgZ(18,"label"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"chq-input",6),e.NdJ("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.qZA(),e.YNc(22,ka,2,1,"div",7),e.TgZ(23,"div",8),e._UZ(24,"chq-button",9),e._UZ(25,"chq-button",9),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,13,"approve_or_decline_the_request")),e.xp6(3),e.Oqu(e.lcZ(8,15,"select_approve/reject_option")),e.xp6(3),e.Q6J("ngClass",e.VKq(21,gi,"Approved"===i.checkedStatus)),e.xp6(1),e.Q6J("svgIcon","check"),e.xp6(2),e.Oqu(e.lcZ(14,17,"approve")),e.xp6(2),e.Q6J("inputModel",i.approveRadio),e.xp6(1),e.Q6J("ngClass",e.VKq(23,gi,"declined"===i.checkedStatus)),e.xp6(1),e.Q6J("svgIcon","cross"),e.xp6(2),e.Oqu(e.lcZ(20,19,"decline")),e.xp6(2),e.Q6J("inputModel",i.declineRadio),e.xp6(1),e.Q6J("ngIf","declined"===i.checkedStatus),e.xp6(2),e.Q6J("buttonModel",i.cancelButtonModel),e.xp6(1),e.Q6J("buttonModel",i.nextButtonModel))},directives:[_.mk,Xe.Hw,nn.D,_.O5,yt.E],pipes:[we.X$],styles:[".approval-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;background:var(--xa-popup-light-gray)}.approval-form[_ngcontent-%COMP%]   .approval-header[_ngcontent-%COMP%]{display:flex;grid-gap:40px;gap:40px;justify-content:flex-start;position:fixed;top:0px;align-items:center}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]{align-self:center;display:flex;grid-gap:28px;gap:28px;flex-direction:column;align-items:center;padding:30px;border-radius:10px;width:calc(100% - 60px)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:28px;gap:28px;width:100%}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .wrapper-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;font-weight:400;line-height:18px}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]{display:flex;grid-gap:20px;gap:20px;width:100%;justify-content:center}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]{display:flex;padding:17px 33px;flex-direction:column;justify-content:center;align-items:center;grid-gap:4px;gap:4px;border-radius:8px;border:1px solid var(--xa-light-gray)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{padding:10px 12px}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .radio-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:18px;font-size:13px;color:var(--xa-black-dark)}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .radio-container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background:var(--xa-white);border:none}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;grid-gap:10px;gap:10px;width:100%}.approval-form[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%], .approval-form[_ngcontent-%COMP%]   .result[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{flex:1}.approval-form[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.approval-form[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}"]}),a})();var J=Z(48873),wt=Z(87855),ir=Z(35493),or=Z(56785),Ra=Z(21937),La=Z(72076),mi=Z(22406),rr=Z(8851);function Zt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",7),e.TgZ(1,"chq-estimate-details",8),e.NdJ("iconClicked",function(r){return e.CHM(t),e.oxw().handleIconClicked(r)})("downloadPdf",function(){return e.CHM(t),e.oxw().downloadPdf()}),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(1),e.Q6J("estimateResponse",t.estimateResponse)("editEstimate",t.editEstimate)("estimateSource",t.estimateSource)("i18n",t.i18n)}}function Rl(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"chq-button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).handleSaveEditedEstimate()}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("buttonModel",t.saveEditedModel)}}function Nt(a,c){if(1&a&&e._UZ(0,"chq-button",17),2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.cancelButtonModel)}}function Ll(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Nt,1,1,"chq-button",16),e.BQk()),2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.showDelete)}}function Ea(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).handleEditEstimate()}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("buttonModel",t.editEstimateModel)}}function yn(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).handleRequestStatus()}),e.qZA()}if(2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.requestStatusModel)}}function so(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-dropdown",19),e.NdJ("selected",function(r){return e.CHM(t),e.oxw(4).handleSelectedOption(r)}),e.qZA()}if(2&a){const t=e.oxw(4);e.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function ar(a,c){if(1&a&&(e.ynx(0),e.YNc(1,yn,1,1,"chq-button",15),e.YNc(2,so,1,1,"chq-dropdown",18),e.BQk()),2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&t.repairNotInvoiced()),e.xp6(1),e.Q6J("ngIf",(null==t.communications?null:t.communications.length)>0&&t.repairNotInvoiced()&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0)}}function Re(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).openOperationPopup()}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("buttonModel",t.addOperationModel)}}function wn(a,c){if(1&a&&(e.ynx(0,13),e.YNc(1,Ll,2,1,"ng-container",14),e.YNc(2,Ea,1,1,"chq-button",15),e.YNc(3,ar,3,2,"ng-container",14),e.YNc(4,Re,1,1,"chq-button",15),e.BQk()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("chqPermission","newBooking"),e.xp6(1),e.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&(null==t.repairStatus?null:t.repairStatus.toLowerCase())!=="PendingApproval".toLowerCase()&&t.repairNotInvoiced()),e.xp6(1),e.Q6J("chqPermission","newBooking"),e.xp6(1),e.Q6J("ngIf","GTMotive"!==t.estimateSource&&(null==t.repairStatus?null:t.repairStatus.toLowerCase())!=="PendingApproval".toLowerCase()&&t.repairNotInvoiced())}}function sr(a,c){if(1&a&&(e.TgZ(0,"div",9),e.YNc(1,Rl,2,1,"ng-container",10),e.YNc(2,wn,5,4,"ng-container",11),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.editEstimate),e.xp6(1),e.Q6J("ngIf",!t.editEstimate)}}function El(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"chq-button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).handleSaveEditedEstimate()}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("buttonModel",t.saveEditedModel)}}function lr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-dropdown",19),e.NdJ("selected",function(r){return e.CHM(t),e.oxw(4).handleSelectedOption(r)}),e.qZA()}if(2&a){const t=e.oxw(4);e.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function Fl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(5).handleRequestStatus()}),e.qZA()}if(2&a){const t=e.oxw(5);e.Q6J("buttonModel",t.requestStatusModel)}}function Nl(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-dropdown",19),e.NdJ("selected",function(r){return e.CHM(t),e.oxw(5).changeCaseStatusDialog(r)}),e.qZA()}if(2&a){const t=e.oxw(5);e.Q6J("dropdownModel",t.dropdownModelFilter)}}function jl(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Fl,1,1,"chq-button",15),e.YNc(2,Nl,1,1,"chq-dropdown",18),e.BQk()),2&a){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf","pendingapproval"===(null==t.repairStatus?null:t.repairStatus.toLowerCase())&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0&&t.repairNotInvoiced()),e.xp6(1),e.Q6J("ngIf","pendingapproval"!==(null==t.repairStatus?null:t.repairStatus.toLowerCase())&&"complete"!==(null==t.repairStatus?null:t.repairStatus.toLowerCase()))}}function Fa(a,c){if(1&a&&(e.ynx(0),e.YNc(1,lr,1,1,"chq-dropdown",18),e.YNc(2,jl,3,2,"ng-container",14),e.BQk()),2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.repairNotInvoiced()&&(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0),e.xp6(1),e.Q6J("chqPermission","newBooking")}}function lo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).openOperationPopup()}),e.qZA()}if(2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.addOperationModel)}}function fi(a,c){if(1&a&&e.YNc(0,lo,1,1,"chq-button",15),2&a){const t=e.oxw(3);e.Q6J("ngIf","GTMotive"!==t.estimateSource)}}function Ul(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Fa,3,2,"ng-container",21),e.YNc(2,fi,1,1,"ng-template",null,22,e.W1O),e.BQk()),2&a){const t=e.MAs(3),i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",(null==i.estimateResponse||null==i.estimateResponse.estimateCharges?null:i.estimateResponse.estimateCharges.length)>0)("ngIfElse",t)}}function Na(a,c){if(1&a&&(e.TgZ(0,"div",20),e.YNc(1,El,2,1,"ng-container",10),e.YNc(2,Ul,4,2,"ng-container",10),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.editEstimate),e.xp6(1),e.Q6J("ngIf",!t.editEstimate)}}let ja=(()=>{class a{constructor(t,i,r,s,p,u,m,C,O,v,w,D){var T,R;this.commonService=t,this.repairEstimateService=i,this.route=r,this.dialog=s,this.bookingService=p,this.translationService=u,this.repairEstimateOperationService=m,this.monitorService=C,this.messageService=O,this.calendarService=v,this.router=w,this.notifyService=D,this.editEstimateModel={label:"edit_estimate",type:"outline",icon:"edit"},this.requestStatusModel={label:"self_approval",type:"outline",icon:"clock-new"},this.addOperationModel={label:"add_operation",type:"outline",icon:"plus"},this.bookInModel={label:"book_in",type:"primary",icon:""},this.saveEditedModel={label:"done",type:"primary",icon:""},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.showData=!1,this.editEstimate=!1,this.caseGuid="",this.repairStatus="",this.communications=[],this.email="",this.repairGuid="",this.repairId="",this.estimateSource="",this.repairNumber="",this.claimNumber="",this.organizationEmail="",this.organizationPhone="",this.organizationCountryCode="",this.organizationName="",this.dropdownModelFilter={options:[],placeHolder:this.translationService.instant("options"),label:"",appearance:"button",placeHolderIcon:"settings",name:"option",displayValue:"label",selectedOption:{}},this.communicationChannels=[{},{dropdownItemIcon:"whatsapp",color:"var(xa-white) !important;",label:this.translationService.instant("whatsapp")},{dropdownItemIcon:"email",color:"var(xa-white) !important;",label:this.translationService.instant("email")},{dropdownItemIcon:"sms",color:"var(xa-white) !important;",label:this.translationService.instant("sms")}],this.dropdownApprovalModelFilter={options:[{dropdownItemIcon:"whatsapp",color:"var(xa-white) !important;",label:this.translationService.instant("whatsapp")},{dropdownItemIcon:"email",color:"var(xa-white) !important;",label:this.translationService.instant("email")},{dropdownItemIcon:"sms",color:"var(xa-white) !important;",label:this.translationService.instant("sms")}],placeHolder:"request_approval",label:"",hideDropdownIcon:!0,appearance:"button",placeHolderIcon:"send",name:"option",displayValue:"label",selectedOption:{}},this.userPermission={},this.repairTypesArray=[],this.afterOperation=!1,this.isRepairCreatedFromCase=!1,this.bookingId="",this.invoiceStatus="",this.commonService.accessRight.closed&&(this.commonService.accessRight=new Vt.X(!0)),this.commonService.activeItem.closed?this.commonService.activeItem=new Vt.X("Booking"):this.commonService.activeItem.next("Booking"),this.commonService.userProfileData.subscribe(I=>{if(I&&I.data){const{userPermission:E,email:F}=I.data;this.email=F,this.userPermission=E||{}}}),this.i18n=this.commonService.geti18nInfo(),null===(R=null===(T=this.route.parent)||void 0===T?void 0:T.params)||void 0===R||R.subscribe(I=>{var E;""!=this.repairGuid&&this.repairGuid!==I.id&&(this.monitorService.logEvent("ngOnInit",["EstimateComponent","addenda-repair"]),this.commonService.updatePage("/repair/customers/0","add-customer"),this.repairGuid=null===(E=this.route.parent)||void 0===E?void 0:E.snapshot.paramMap.get("id"),this.getBookingRepairDetails()),setTimeout(()=>{-1!==this.router.url.indexOf("parts")&&document.querySelector("chq-tabs .active").click()},300)})}get showDelete(){var t,i;return!(!this.repairId||"draft"!==(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase()))||!(!this.repairId||!this.caseGuid||1!=this.isRepairCreatedFromCase||"repairestimation"!=(null===(i=this.repairStatus)||void 0===i?void 0:i.toLowerCase()))}handleSelectedOption(t){var i;this.showRequestApprovalDialog(null===(i=null==t?void 0:t.value)||void 0===i?void 0:i.label)}redirectToGtEstimate(){this.commonService.showLoading(),this.monitorService.logEvent("redirectToGtEstimate",["ChqRepairEstimateComponent","addenda-quote",{caseId:this.caseGuid,status}]),this.route.snapshot.queryParams.send&&"true"==this.route.snapshot.queryParams.send&&this.router.navigate([],{relativeTo:this.route,queryParams:{send:"false"},queryParamsHandling:"merge"}),this.repairEstimateService.createEstimateFromRepair(this.repairGuid).subscribe({next:t=>{t&&(location.href=t.data.url,sessionStorage.setItem("update","1"),sessionStorage.setItem("current-url",this.router.url.toString()),sessionStorage.setItem("initial-repair-types",JSON.stringify(this.repairTypesArray)))},complete:()=>{this.commonService.hideLoading()}})}showRequestApprovalDialog(t){var i,r,s,p,u,m,C,O,v,w,D,T,R,I,E,F,G,re,z,ne;return(0,Ze.mG)(this,void 0,void 0,function*(){this.commonService.showLoading();const N=yield(0,dt.z)(this.notifyService.getNotifyTemplate(this.repairGuid,this.domainId,4));this.commonService.hideLoading();const X=`<strong class='text-black-medium'>Request approval: </strong> <strong class='text-black-medium'>${this.repairNumber} / </strong> <strong class='text-black-medium'>${this.vehicleObj.vehicleMake} / </strong>\n    <strong class='text-black-medium'>${this.vehicleObj.vehicleModel} / </strong> <strong class='text-black-medium'>${this.vehicleObj.licensePlateNumber}</strong> ${this.claimNumber?`<strong class='text-black-medium'> / ${this.claimNumber} </strong>`:""}`;let B="send_message",ue="",Q="";"email"===(null==t?void 0:t.toLowerCase())?(B="send_email",ue=X,Q=N[1].data.body.replace("{{firstname}} {{lastname}}",this.organizationName).replace("{{make}}",null===(i=N[0].data.vehicle)||void 0===i?void 0:i.vehicleMake).replace("{{model}}",null===(r=N[0].data.vehicle)||void 0===r?void 0:r.vehicleModel).replace("{{licensenumber}}",null===(s=N[0].data.vehicle)||void 0===s?void 0:s.licensePlateNumber).replace("{{pickupdate}}",J((null===(p=N[0].data)||void 0===p?void 0:p.pickUpDate)?null===(u=N[0].data)||void 0===u?void 0:u.pickUpDate:null===(C=null===(m=N[0].data)||void 0===m?void 0:m.booking)||void 0===C?void 0:C.endDate).format("DD/MM/YYYY HH:MM a")).replace("{{message}}","").replace("{{orgname}}",null===(O=N[0].data.organizationDetail)||void 0===O?void 0:O.nameOfOrganization).replace("{{orgcontactnumber}}",null===(v=N[0].data.organizationDetail)||void 0===v?void 0:v.phoneNumber).replace("{{claimnumber}}",null===(w=N[0].data.customer)||void 0===w?void 0:w.claimNumber)):"whatsapp"===(null==t?void 0:t.toLowerCase())?(Q=N[1].data.whatsAppBody.replace("{{firstname}} {{lastname}}",this.organizationName).replace("{{make}}",null===(D=N[0].data.vehicle)||void 0===D?void 0:D.vehicleMake).replace("{{model}}",null===(T=N[0].data.vehicle)||void 0===T?void 0:T.vehicleModel).replace("{{licensenumber}}",null===(R=N[0].data.vehicle)||void 0===R?void 0:R.licensePlateNumber).replace("{{pickupdate}}",J((null===(I=N[0].data)||void 0===I?void 0:I.pickUpDate)?null===(E=N[0].data)||void 0===E?void 0:E.pickUpDate:null===(F=N[0].data)||void 0===F?void 0:F.booking.endDate).format("DD/MM/YYYY HH:MM a")).replace("{{message}}","").replace("{{orgname}}",null===(G=N[0].data.organizationDetail)||void 0===G?void 0:G.nameOfOrganization).replace("{{orgcontactnumber}}",null===(re=N[0].data.organizationDetail)||void 0===re?void 0:re.phoneNumber).replace("{{approvalurl}}","Approve/Reject"),Q=(null===(z=N[0].data.customer)||void 0===z?void 0:z.claimNumber)?Q.replace("{{claimnumber}}",null===(ne=N[0].data.customer)||void 0===ne?void 0:ne.claimNumber):Q.replace("/{{claimnumber}}","")):"sms"===(null==t?void 0:t.toLowerCase())&&(Q=N[1].data.smsBody.replace("{{estimateurl}}","").replace("{{approvalurl}}","")),this.dialog.open(rt,{data:{title:B,email:this.organizationEmail,emailSubject:ue,channel:null==t?void 0:t.toLowerCase(),body:Q,code:this.organizationCountryCode,phone:this.organizationPhone},backdropClass:"confirmation-popup-backdrop",maxHeight:"90vh",minWidth:"629px",width:"629px",autoFocus:!1}).afterClosed().subscribe({next:Me=>{Me&&(this.commonService.showLoading(),this.messageService.sendApprovalMessage(Me,this.repairGuid).subscribe({next:()=>{const Le=this.translationService.instant("request_approval_msg");this.commonService.showInfoToast(1e3,Le),this.commonService.hideLoading(),this.getBookingRepairDetails()},error:()=>{this.commonService.hideLoading()}}))}})})}get isValidCurrentStatus(){return["readytoinvoice"].includes(this.repairStatus.toLowerCase())}showConfirmationPopup(){this.dialog.open(ke.I,{disableClose:!0,data:{message:"msg_estimate_zero"},backdropClass:"confirmation-popup-backdrop",autoFocus:!1}).afterClosed().subscribe({next:i=>{console.log(i),i&&this.redirectToGtEstimate()}})}getManualEstimationDetail(t){this.vehicleId&&this.inspectionId?(this.monitorService.logEvent("getManualEstimationDetail",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId}),this.repairEstimateService.getRepairEstimate(this.repairGuid,this.inspectionId,this.vehicleId).subscribe({next:i=>{this.showData=!0,this.estimateResponse=i||{},this.i18n=this.commonService.geti18nInfo(),this.commonService.isRefreshRepairEstimateDetails.next(null),this.editEstimate=!1,this.commonService.hideLoading(),this.toggleOptions(),t&&this.commonService.showInfoToast(5e3,t)},error:i=>{this.commonService.hideLoading(),this.monitorService.logException(i,je._.Error)}})):(this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid))}getEstimationDetail(t){"GTMotive"===this.estimateSource?this.getGTEstimationDetail():this.getManualEstimationDetail()}getGTEstimationDetail(){this.vehicleId&&this.inspectionId?(this.monitorService.logEvent("getGTEstimationDetail",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,caseGuid:this.caseGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId}),this.repairEstimateService.getEstimate(this.caseGuid,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:t=>{var i,r,s;if(this.estimateResponse=(null==t?void 0:t.data)||{},0==(null===(r=null===(i=this.estimateResponse)||void 0===i?void 0:i.estimateCharges)||void 0===r?void 0:r.length))return this.showConfirmationPopup(),void this.commonService.hideLoading();this.showData=!0,this.i18n=this.commonService.getDefaulti18nInfo(),this.estimateResponse.currencyCode=null===(s=this.estimateResponse)||void 0===s?void 0:s.currencyCode,this.editEstimate=!1,this.toggleOptions(),this.commonService.hideLoading()},error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,je._.Error)}})):(this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid))}getEstimateFromCaseAndRepair(t,i){if(this.vehicleId&&this.inspectionId){this.monitorService.logEvent("getEstimateFromCaseAndRepair",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,inspectionId:this.inspectionId,vehicleId:this.vehicleId});const r=sessionStorage.getItem("update")||"0";this.route.snapshot.queryParams.send&&-1!=(sessionStorage.getItem("current-url")||"").indexOf("mode=edit")&&this.router.navigate([],{relativeTo:this.route,queryParams:{mode:"edit"},queryParamsHandling:"merge"}),"0"===r?this.getEstimationDetail(t):"1"===r&&this.route.snapshot.queryParams.send&&"true"==this.route.snapshot.queryParams.send?this.repairEstimateService.readUpdateEstimate(this.caseGuid,this.inspectionId,this.vehicleId,"put",this.domainId).subscribe({next:()=>{sessionStorage.setItem("update","0"),this.getEstimationDetail(t),this.router.navigate([],{relativeTo:this.route,queryParams:{send:"false"},queryParamsHandling:"merge"}),""!=sessionStorage["initial-repair-types"]&&(this.afterOperation=!0,this.getBookingRepairDetails()),this.commonService.hideLoading()}}):this.getEstimationDetail(t)}else this.commonService.hideLoading(),this.displayMissingInspectionMessage(this.repairGuid)}showRepairTypeUpdateMessage(t,i){const s=[];if(null==t||t.forEach(p=>{s.push("object"==typeof p?p.repairServiceType:p)}),s.length>0){const p=s.filter(u=>!i.includes(u));p.length>0&&(this.commonService.showNotification(`Repair Type was updated: Added ${p.join(",")}`),this.repairTypesArray=[...this.repairTypesArray,...p])}}displayMissingInspectionMessage(t){this.commonService.openAlertDialog("Notification","Please add your vehicle in order to add estimate.").afterClosed().subscribe({next:i=>{i&&this.router.navigate([`repair/booking/${t}`])},error:()=>{this.commonService.hideLoading()}})}getBookingRepairDetails(){this.commonService.showLoading(),this.monitorService.logEvent("getBookingRepairDetails",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid}),this.bookingService.getRepairDetailByGuid(this.repairGuid).subscribe({next:t=>(0,Ze.mG)(this,void 0,void 0,function*(){var i,r,s,p,u,m,C,O,v,w,D,T,R,I,E,F,G,re,z,ne,N,X,B,ue,Q,ee,Me,Le,tt,nt,Ue,Ct,Ot,De,te,qe,ct,Lt,_n,Rn,Wn,$n,Kn,Xn,ei,ti,it;if(null==t?void 0:t.data){if(this.commonService.repairDetails.next(t.data),this.commonService.bookingId.next(t.data.repairNumber),this.repairNumber=t.data.repairNumber,this.repairId=t.data.id,this.repairStatus=t.data.status,this.invoiceStatus=t.data.invoiceStatus,this.inspectionId=null===(i=t.data.vehicle)||void 0===i?void 0:i.inspectionId,this.vehicleId=null===(r=t.data.vehicle)||void 0===r?void 0:r.vehicleId,this.caseGuid=t.data.quoteId,this.domainId=t.data.domainId,this.vehicleObj=t.data.vehicle,this.claimNumber=null===(p=null===(s=t.data)||void 0===s?void 0:s.customer)||void 0===p?void 0:p.claimNumber,this.estimateSource=t.data.estimateSource||"",this.organizationEmail=(null===(m=null===(u=t.data)||void 0===u?void 0:u.organizationDetail)||void 0===m?void 0:m.partnerships)?null===(v=null===(O=null===(C=t.data)||void 0===C?void 0:C.organizationDetail)||void 0===O?void 0:O.partnerships[0])||void 0===v?void 0:v.email:"",this.organizationPhone=(null===(D=null===(w=t.data)||void 0===w?void 0:w.organizationDetail)||void 0===D?void 0:D.partnerships)?null===(E=null===(I=null===(R=null===(T=t.data)||void 0===T?void 0:T.organizationDetail)||void 0===R?void 0:R.partnerships[0])||void 0===I?void 0:I.phoneNumber)||void 0===E?void 0:E.replace(null===(re=null===(G=null===(F=t.data)||void 0===F?void 0:F.organizationDetail)||void 0===G?void 0:G.partnerships[0])||void 0===re?void 0:re.countryCode,""):"",this.organizationCountryCode=(null===(ne=null===(z=t.data)||void 0===z?void 0:z.organizationDetail)||void 0===ne?void 0:ne.partnerships)?null===(B=null===(X=null===(N=t.data)||void 0===N?void 0:N.organizationDetail)||void 0===X?void 0:X.partnerships[0])||void 0===B?void 0:B.countryCode:"",this.organizationName=(null===(Q=null===(ue=t.data)||void 0===ue?void 0:ue.organizationDetail)||void 0===Q?void 0:Q.partnerships)?null===(Le=null===(Me=null===(ee=t.data)||void 0===ee?void 0:ee.organizationDetail)||void 0===Me?void 0:Me.partnerships[0])||void 0===Le?void 0:Le.companyName:"",this.isRepairCreatedFromCase=t.data.isRepairCreatedFromCase,this.bookingId=null===(tt=t.data.booking)||void 0===tt?void 0:tt.bookingGuid,!this.vehicleId)return this.commonService.hideLoading(),void this.displayMissingInspectionMessage(this.repairGuid);"repair"==(null===(nt=t.data.repairType)||void 0===nt?void 0:nt.toLowerCase())&&(this.afterOperation?"GTMotive"!=this.estimateSource?this.showRepairTypeUpdateMessage(t.data.repairServiceTypes,this.repairTypesArray):(this.repairTypesArray=[],this.getInitialRepairTypes(t.data.repairServiceTypes),""!=sessionStorage["initial-repair-types"]&&this.showRepairTypeUpdateMessage(this.repairTypesArray,JSON.parse(sessionStorage["initial-repair-types"])),sessionStorage.setItem("initial-repair-types","")):this.getInitialRepairTypes(t.data.repairServiceTypes));const ni=[];(null===(Ct=null===(Ue=t.data)||void 0===Ue?void 0:Ue.booking)||void 0===Ct?void 0:Ct.communicationTypeId)&&(null===(De=null===(Ot=t.data)||void 0===Ot?void 0:Ot.booking)||void 0===De?void 0:De.communicationTypeId.length)>0&&(null===(qe=null===(te=t.data)||void 0===te?void 0:te.booking)||void 0===qe||qe.communicationTypeId.forEach(Ln=>{this.communicationChannels[Ln]&&ni.push(this.communicationChannels[Ln])})),ni.sort((Ln,$i)=>Ln.label.localeCompare($i.label)),this.communications=null===(Lt=null===(ct=t.data)||void 0===ct?void 0:ct.booking)||void 0===Lt?void 0:Lt.communicationTypeId,this.dropdownApprovalModelFilter=Object.assign(Object.assign({},this.dropdownApprovalModelFilter),{options:ni}),t.data.customer&&"Retail"===(null===(_n=t.data.customer)||void 0===_n?void 0:_n.companyOrgType)&&((null===(Rn=t.data.customer)||void 0===Rn?void 0:Rn.isCompany)||(this.organizationEmail=null===(Wn=t.data.customer)||void 0===Wn?void 0:Wn.email,this.organizationPhone=null===($n=t.data.customer)||void 0===$n?void 0:$n.mobileNumber,this.organizationCountryCode=null===(Kn=t.data.customer)||void 0===Kn?void 0:Kn.countryCode,this.organizationName=`${null===(Xn=t.data.customer)||void 0===Xn?void 0:Xn.firstName} ${null===(ei=t.data.customer)||void 0===ei?void 0:ei.lastName}`)),!this.estimateSource&&this.checkGTEstimatePermission()?this.redirectToGtEstimate():this.getEstimateFromCaseAndRepair((null===(it=null===(ti=t.data)||void 0===ti?void 0:ti.organizationDetail)||void 0===it?void 0:it.nameOfOrganization)||"",""),this.toggleOptions()}else this.commonService.hideLoading()}),error:t=>{this.commonService.hideLoading(),this.monitorService.logException(t,je._.Error)}})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,i=t.filter(r=>"Repair Estimate"===r.automotiveServiceName);if(i&&i.length>0){const{permissions:r}=i[0],s=r.filter(p=>"gt.estimate"===p.permissionName||"gt.estimate.vinquery"===p.permissionName);if(s&&s.length>0)return!0}return!1}ngOnInit(){var t;this.monitorService.logEvent("ngOnInit",["EstimateComponent","addenda-repair"]),this.commonService.updatePage("/repair/customers/0","add-customer"),this.repairGuid=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id"),this.getBookingRepairDetails(),this.subscription=this.commonService.isRefreshRepairEstimateDetails.subscribe({next:i=>{i&&"GTMotive"!==this.estimateSource&&this.vehicleId&&this.inspectionId&&this.getManualEstimationDetail()}})}toggleOptions(){var t,i,r,s,p,u,m,C,O,v,w,D,T,R,I;if(this.dropdownModelFilter.options){if("GTMotive"!==this.estimateSource&&(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())!=="PendingApproval".toLowerCase()&&"readytoinvoice"!==(null===(i=this.repairStatus)||void 0===i?void 0:i.toLowerCase()))(null===(r=this.dropdownModelFilter.options)||void 0===r?void 0:r.find(F=>"addOperation"==F.value))||(this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("add_operation"),dropdownItemIcon:"plus",value:"addOperation"}]}));else{const E=null===(s=this.dropdownModelFilter.options)||void 0===s?void 0:s.findIndex(G=>"addOperation"==G.value),F=[...this.dropdownModelFilter.options];-1!==E&&F.splice(E,1),this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...F]})}if((null===(u=null===(p=this.estimateResponse)||void 0===p?void 0:p.estimateCharges)||void 0===u?void 0:u.length)>0&&(null===(m=this.repairStatus)||void 0===m?void 0:m.toLowerCase())!=="PendingApproval".toLowerCase()&&"readytoinvoice"!==(null===(C=this.repairStatus)||void 0===C?void 0:C.toLowerCase()))(null===(O=this.dropdownModelFilter.options)||void 0===O?void 0:O.find(F=>"editOperation"==F.value))||(this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("edit_estimate"),dropdownItemIcon:"edit",value:"editOperation"}]}));else{const E=null===(v=this.dropdownModelFilter.options)||void 0===v?void 0:v.findIndex(G=>"editOperation"==G.value),F=[...this.dropdownModelFilter.options];-1!==E&&F.splice(E,1),this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...F]})}if((null===(D=null===(w=this.estimateResponse)||void 0===w?void 0:w.estimateCharges)||void 0===D?void 0:D.length)>0&&"readytoinvoice"!==(null===(T=this.repairStatus)||void 0===T?void 0:T.toLowerCase()))(null===(R=this.dropdownModelFilter.options)||void 0===R?void 0:R.find(F=>"requestStatus"==F.value))||(this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...this.dropdownModelFilter.options,{label:this.translationService.instant("self_approval"),dropdownItemIcon:"clock-new",value:"requestStatus"}]}));else{const E=null===(I=this.dropdownModelFilter.options)||void 0===I?void 0:I.findIndex(G=>"requestStatus"==G.value),F=[...this.dropdownModelFilter.options];-1!==E&&F.splice(E,1),this.dropdownModelFilter=Object.assign(Object.assign({},this.dropdownModelFilter),{options:[...F]})}}}changeCaseStatusDialog(t){"addOperation"===t.value.value?this.openOperationPopup():"editOperation"===t.value.value?this.handleEditEstimate():"requestStatus"===t.value.value&&this.handleRequestStatus()}openOperationPopup(){this.checkGTEstimatePermission()?this.commonService.showToast(0,"msg_gt_permission"):this.dialog.open(Ie,{data:{repairId:this.repairGuid},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:i=>{var r;i&&(["draft","uploaddocuments","uploadphotos"].includes(null===(r=this.repairStatus)||void 0===r?void 0:r.toLowerCase())&&(this.repairStatus="RepairEstimation"),this.afterOperation=!0,this.getBookingRepairDetails())}})}handleEditEstimate(){"GTMotive"!==this.estimateSource?this.checkGTEstimatePermission()?this.commonService.showToast(0,"msg_gt_permission"):this.editEstimate=!0:this.caseGuid&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.redirectToGtEstimate.bind(this),jn.j.quote):this.redirectToGtEstimate()}handleSaveEditedEstimate(){this.editEstimate=!1}handleEditRepairOperation(t){return(0,Ze.mG)(this,void 0,void 0,function*(){try{this.commonService.showLoading(),this.monitorService.logEvent("getRepairEstimateOperationDetails",["EstimateComponent","addenda-repair"]);const i=yield this.getRepairEstimateOperationDetails(t);if(this.commonService.hideLoading(),null==i?void 0:i.data){const s=Object.entries(i.data).map(m=>[m[0][0].toUpperCase()+m[0].slice(1),m[1]]),p=Object.fromEntries(s);this.dialog.open(Ie,{data:{repairId:this.repairGuid,operationDetails:p},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:m=>{m&&this.getEstimateFromCaseAndRepair("","")}})}}catch(i){this.commonService.hideLoading(),this.monitorService.logException(i,je._.Error)}})}getRepairEstimateOperationDetails(t){return(0,Ze.mG)(this,void 0,void 0,function*(){return(0,dt.z)(this.repairEstimateOperationService.getRepairEstimateOperationDetails(t))})}handleIconClicked(t){const{id:i,action:r}=t;"edit"===r&&this.handleEditRepairOperation(i),"delete"===r&&(this.caseGuid?this.commonService.showChangeWarningMessage(this.handleDeleteRepairOperation.bind(this,i),jn.j.quote):this.handleDeleteRepairOperation(i))}handleDeleteRepairOperation(t){this.commonService.openDeleteDialog().afterClosed().subscribe(i=>{i&&(this.monitorService.logEvent("getBookingRepairDetails",["EstimateComponent","addenda-repair"],{repairGuid:this.repairGuid,id:t}),this.commonService.showLoading(),(0,dt.z)(this.repairEstimateOperationService.deleteRepairEstimateOperation(this.repairGuid,t)).then(r=>{let s="";(null==r?void 0:r.message)&&(s=r.message),this.getManualEstimationDetail(s)}).catch(()=>{this.commonService.hideLoading()}))})}downloadPdf(){this.commonService.showLoading(),this.monitorService.logEvent("downloadPdf",["RepairEstimateComponent","addenda-repair",{caseId:this.caseGuid}]),this.repairEstimateService.getXADownloadUrl(this.caseGuid).subscribe({next:i=>{window.open(i.data.url,"_top"),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}getInitialRepairTypes(t){t.forEach(i=>{this.repairTypesArray.push(i.repairServiceType)})}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(t=>{t&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}handleRequestStatus(){this.dialog.open(qa,{width:"629px",maxWidth:"629px",autoFocus:!1,data:this.repairGuid}).afterClosed().subscribe({next:i=>{i&&this.getBookingRepairDetails()}})}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.subscription.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["EstimateComponent","addenda-repair"])}repairNotInvoiced(){var t,i,r,s,p,u,m;return!("invoiced"===(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())||"paid"===(null===(i=this.repairStatus)||void 0===i?void 0:i.toLowerCase())||"closed"===(null===(r=this.repairStatus)||void 0===r?void 0:r.toLowerCase())||"complete"===(null===(s=this.repairStatus)||void 0===s?void 0:s.toLowerCase())||"readytoinvoice"===(null===(p=this.repairStatus)||void 0===p?void 0:p.toLowerCase())||"readytoinvoice"===(null===(u=this.invoiceStatus)||void 0===u?void 0:u.toLowerCase())||"invoiced"===(null===(m=this.invoiceStatus)||void 0===m?void 0:m.toLowerCase()))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(He.v),e.Y36(wt.H),e.Y36(Be.gz),e.Y36(Ye.uw),e.Y36(on.q),e.Y36(we.sK),e.Y36(Fi),e.Y36(Ge.M),e.Y36(ir.K),e.Y36(or.o),e.Y36(Be.F0),e.Y36(Ra.c))},a.\u0275cmp=e.Xpm({type:a,selectors:[["estimate"]],decls:8,vars:3,consts:[["class","repair-estimate-step",4,"ngIf"],[1,"footer-full-wrapper","estimate-details-footer"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],["class","footer-button-wrapper show-md",4,"ngIf"],["class","footer-button-wrapper show-sm",4,"ngIf"],[1,"repair-estimate-step"],["serviceType","repair",3,"estimateResponse","editEstimate","estimateSource","i18n","iconClicked","downloadPdf"],[1,"footer-button-wrapper","show-md"],[4,"ngIf"],["class","show-md",4,"ngIf"],[3,"buttonModel","click"],[1,"show-md"],[4,"chqPermission"],[3,"buttonModel","click",4,"ngIf"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel"],[3,"dropdownModel","selected",4,"ngIf"],[3,"dropdownModel","selected"],[1,"footer-button-wrapper","show-sm"],[4,"ngIf","ngIfElse"],["elseTemplate",""]],template:function(t,i){1&t&&(e.YNc(0,Zt,2,4,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e._UZ(4,"img",4),e.qZA(),e.qZA(),e.ynx(5),e.YNc(6,sr,3,2,"div",5),e.YNc(7,Na,3,2,"div",6),e.BQk(),e.qZA()),2&t&&(e.Q6J("ngIf",i.showData),e.xp6(6),e.Q6J("ngIf",i.showData&&!i.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",i.showData&&!i.commonService.isViewOnly))},directives:[_.O5,La.r,yt.E,mi.A,rr.I],styles:[".repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container{border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-white);margin-top:25px;margin-bottom:25px;padding:0 32px 32px}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container chq-customloader{margin:auto}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-label{margin-top:25px}.repair-estimate-step[_ngcontent-%COMP%]     .estimate-label, .repair-estimate-step[_ngcontent-%COMP%]     .estimate-main-container{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.estimate-details-footer[_ngcontent-%COMP%]   .show-sm[_ngcontent-%COMP%]{display:none!important}@media (max-width: 985px){.estimate-details-footer[_ngcontent-%COMP%]   .show-md[_ngcontent-%COMP%]{display:none!important}.estimate-details-footer[_ngcontent-%COMP%]   .show-sm[_ngcontent-%COMP%]{display:flex!important}.estimate-details-footer[_ngcontent-%COMP%]     .dropdown-container.dropdown-edit-mode{top:0px}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label .placeHolder{font-size:14px!important}.estimate-details-footer[_ngcontent-%COMP%]     a.dropdown{width:180px!important}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label mat-icon{height:17px;width:17px}.estimate-details-footer[_ngcontent-%COMP%]     .button-mode .dropdown .selected-label .content mat-icon{height:15px;width:15px}.estimate-details-footer[_ngcontent-%COMP%]     .dropdown-container .dropdown .dropdown-wrapper{border-color:var(--xa-light-gray)!important}}"]}),a})();var Un=Z(84967),Jn=Z(33568),Wt=Z(84945),Jl=Z(49517);function Ua(a){let c,t;return i=>(c||(c=i,t=a.formControl,t.valueChanges.subscribe(()=>{c.updateValueAndValidity({onlySelf:!0})})),new Date(t.value)>new Date(c.value)?{invalid:!0}:null)}var ft=Z(60562),pr=Z(96472),_i=Z(38709),Ja=Z(4093),co=Z(13975),Yl=Z(74178),Gl=Z(11145),Hl=Z(50356),zl=Z(8571);const Ql=["companyOrg"],vi=["licenseId"],Vl=["driverPhone"],Wl=["driverCode"],ur=["orgType"],Ba=["make"],Tn=["model"],po=["year"],$l=["mileage"],Kl=["license"],Xl=["regDate"],bi=["repairType"],$t=["bookingout"],Ya=["serviceType"],ec=["communicationChannel"],tc=["chqUpload"];function nc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",40),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).onFormUpdateCustomer(r)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("inputModel",t.formModel.customerData.claimNumber)}}const Dn=function(a){return{hide:a}};function ic(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",81),e.TgZ(1,"div",14),e.TgZ(2,"div",82),e.TgZ(3,"chq-input",83),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).onFormUpdateCustomer(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(2,Dn,t.isFormConfirmed)),e.xp6(3),e.Q6J("inputModel",t.formModel.customerData.carOwnerSelector)}}const dn=function(a){return{"disable-input disable-controls":a}};function x(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",13),e.TgZ(1,"div",14),e.TgZ(2,"div",82),e.TgZ(3,"chq-input",84,85),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw(2).hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw(2).onFormUpdateCustomer(r)}),e.qZA(),e.TgZ(5,"chq-input",86,87),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).onFormUpdateCustomer(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.oxw(2);e.xp6(3),e.Q6J("inputModel",t.formModel.customerData.companyName),e.xp6(2),e.Q6J("ngClass",e.VKq(3,dn,"select"===t.formModel.customerData.companyName.type))("inputModel",t.formModel.customerData.licenseId)}}function S(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",88),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).onFormUpdateCustomer(r)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("inputModel",t.formModel.customerData.email)}}function y(a,c){if(1&a&&(e.TgZ(0,"div",89),e.TgZ(1,"div",90),e.TgZ(2,"div",91),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",92),e.TgZ(6,"span"),e._uU(7),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw(2);e.xp6(3),e.hij("",e.lcZ(4,2,t.formModel.customerData.email.label)," "),e.xp6(4),e.Oqu(t.formModel.customerData.email.value)}}function U(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",93,94),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).onFormUpdateCustomer(r)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("inputModel",t.formModel.customerData.driverPhone)}}function oe(a,c){if(1&a&&(e.TgZ(0,"div",90),e.TgZ(1,"div",91),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",92),e.TgZ(5,"span"),e._uU(6),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,t.formModel.customerData.driverPhone.label)," "),e.xp6(4),e.Oqu(t.formModel.customerData.driverPhone.value)}}function xe(a,c){if(1&a&&(e.TgZ(0,"div",95),e.TgZ(1,"label"),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"label"),e._uU(6),e.qZA(),e.qZA()),2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,e.lcZ(4,4,"type_of_service"))),e.xp6(4),e.Oqu(t.serviceTypeString)}}function Qe(a,c){if(1&a&&(e.TgZ(0,"div",95),e.TgZ(1,"label"),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"label"),e._uU(6),e.qZA(),e.qZA()),2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,e.lcZ(4,4,"types_of_repair"))),e.xp6(4),e.Oqu(t.repairTypesString)}}function Ae(a,c){if(1&a&&(e.TgZ(0,"div",95),e.TgZ(1,"label"),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"label"),e._uU(6),e.qZA(),e.qZA()),2&a){const t=e.oxw(2);e.xp6(2),e.hij("",e.lcZ(3,2,e.lcZ(4,4,"assign_to"))," "),e.xp6(4),e.Oqu(t.assigneeString)}}function hr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",108),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(3).expandCollapseAssignedTo(r)}),e.TgZ(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div"),e._UZ(4,"mat-icon",109),e.qZA(),e.qZA()}if(2&a){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.repair," "),e.xp6(2),e.Q6J("svgIcon",t.active?"dropdown-up":"dropdown")}}function oc(a,c){1&a&&e._UZ(0,"img",113)}function jt(a,c){1&a&&e._UZ(0,"img",114)}function uo(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.firstName," ",t.lastName,"")}}function rc(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.assigneeName)}}function Ci(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",110),e.NdJ("dblclick",function(){const s=e.CHM(t).$implicit,p=e.oxw().$implicit;return e.oxw(3).onDoubleClick(s,p)}),e.YNc(1,oc,1,0,"img",111),e.YNc(2,jt,1,0,"img",112),e.YNc(3,uo,2,2,"span",69),e.YNc(4,rc,2,1,"span",69),e.qZA()}if(2&a){const t=c.$implicit;e.Q6J("cdkDragDisabled",!t.isAvailable),e.xp6(1),e.Q6J("ngIf",t.isAvailable),e.xp6(1),e.Q6J("ngIf",!t.isAvailable),e.xp6(1),e.Q6J("ngIf",!t.assigneeName),e.xp6(1),e.Q6J("ngIf",t.assigneeName)}}function ho(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.firstName," ",t.lastName,"")}}function go(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.assigneeName)}}function Te(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",115),e._UZ(1,"img",113),e.YNc(2,ho,2,2,"span",69),e.YNc(3,go,2,1,"span",69),e.TgZ(4,"mat-icon",116),e.NdJ("click",function(){const s=e.CHM(t).$implicit,p=e.oxw().$implicit;return e.oxw(3).unAssignEmployee(s,p)}),e.qZA(),e.qZA()}if(2&a){const t=c.$implicit;e.xp6(2),e.Q6J("ngIf",!t.assigneeName),e.xp6(1),e.Q6J("ngIf",t.assigneeName),e.xp6(1),e.Q6J("svgIcon","cross")}}const ac=function(a){return[a]};function Ga(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",97),e.YNc(1,hr,5,2,"div",98),e.TgZ(2,"div",81),e.TgZ(3,"div",99),e.TgZ(4,"div",100),e._uU(5),e.ALo(6,"uppercase"),e.ALo(7,"uppercase"),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div",101),e.TgZ(10,"div",102),e.YNc(11,Ci,5,5,"div",103),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",99),e.TgZ(13,"div",100),e._uU(14),e.ALo(15,"uppercase"),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div",104),e.TgZ(18,"div",105,106),e.NdJ("cdkDropListDropped",function(r){const p=e.CHM(t).$implicit;return e.oxw(3).drop(r,p.repairId)}),e.YNc(20,Te,5,3,"div",107),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=c.$implicit,i=e.MAs(19),r=e.oxw(3);e.Q6J("ngClass",r.isTechnician||"complete"===(null==r.status?null:r.status.toLowerCase())?"disable-container":""),e.xp6(1),e.Q6J("ngIf","Repair"===r.personalInfoData.serviceType),e.xp6(1),e.Q6J("ngClass",e.VKq(21,Dn,!t.active&&"Repair"===r.personalInfoData.serviceType)),e.xp6(3),e.AsE(" ",e.lcZ(6,11,null==t.repair?null:t.repair.toString())," ",e.lcZ(7,13,e.lcZ(8,15,"specialists"))," "),e.xp6(5),e.Q6J("cdkDropListConnectedTo",e.VKq(23,ac,i))("cdkDropListData",t.employees),e.xp6(1),e.Q6J("ngForOf",t.employees),e.xp6(3),e.hij(" ",e.lcZ(15,17,e.lcZ(16,19,"specialists_assigned"))," "),e.xp6(4),e.Q6J("cdkDropListData",t.employeesAssigned),e.xp6(2),e.Q6J("ngForOf",t.employeesAssigned)}}function mo(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Ga,21,25,"div",96),e.BQk()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.repairEmployees)}}function sc(a,c){if(1&a&&(e.TgZ(0,"div",117),e.TgZ(1,"label"),e._uU(2),e.qZA(),e.qZA()),2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(t.formModel.towedIn.value)}}const Ha=function(){return{"pointer-events":"none"}},za=function(){return{}};function fo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",56),e.TgZ(1,"div",57),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"span",7),e._uU(5,"*"),e.qZA(),e.qZA(),e.TgZ(6,"div",118),e.TgZ(7,"div",13),e.TgZ(8,"div",14),e.TgZ(9,"chq-input",119,120),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.oxw(2);e.xp6(2),e.hij(" ",e.lcZ(3,3,"preferred_comm")," "),e.xp6(7),e.Q6J("inputModel",t.formModel.communicationChannel)("ngStyle",t.formModel.communicationChannel.disabled?e.DdM(5,Ha):e.DdM(6,za))}}function Sn(a,c){if(1&a&&e._UZ(0,"chq-button",22),2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.cancelButtonModel)}}function _o(a,c){if(1&a&&e._UZ(0,"chq-button",22),2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.bookingButtonModel)}}function Qa(a,c){if(1&a&&e._UZ(0,"chq-button",22),2&a){const t=e.oxw(4);e.Q6J("buttonModel",t.closeButtonModel)}}function vo(a,c){if(1&a&&(e.TgZ(0,"div",122),e.YNc(1,Sn,1,1,"chq-button",123),e.YNc(2,_o,1,1,"chq-button",123),e.YNc(3,Qa,1,1,"chq-button",123),e.qZA()),2&a){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.showDelete),e.xp6(1),e.Q6J("ngIf",!t.repairId||"complete"!==(null==t.status?null:t.status.toLowerCase())),e.xp6(1),e.Q6J("ngIf",t.repairId&&t.isFormConfirmed)}}function Va(a,c){1&a&&(e.ynx(0),e.YNc(1,vo,4,3,"div",121),e.BQk()),2&a&&(e.xp6(1),e.Q6J("chqPermission","newBooking"))}const Wa=function(a,c){return{"text-mode bg-tab-default-content":a,"page-wrapper":c}},Ni=function(a){return{"text-mode":a}},$a=function(a){return{"partial-disable-info":a}},ji=function(a){return{"partial-disable-info disable-controls":a}},Bn=function(a,c){return{"disable-controls disable-input":a,hide:c}};function bo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",6),e.TgZ(5,"span",7),e._uU(6,"*"),e.qZA(),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div",8),e.TgZ(10,"div",9),e.TgZ(11,"form",10),e.TgZ(12,"div",11),e.TgZ(13,"div",12),e.TgZ(14,"div",13),e.TgZ(15,"div",14),e.TgZ(16,"div",13),e.TgZ(17,"chq-input",15,16),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateCustomer(r)}),e.qZA(),e.YNc(19,nc,1,1,"chq-input",17),e.qZA(),e.qZA(),e.qZA(),e.YNc(20,ic,4,4,"div",18),e.YNc(21,x,7,5,"div",19),e.qZA(),e.TgZ(22,"div",20),e.TgZ(23,"div",21),e._UZ(24,"chq-button",22),e.qZA(),e.qZA(),e.TgZ(25,"div",23),e.TgZ(26,"div",13),e.TgZ(27,"div",24),e.TgZ(28,"div",25),e.TgZ(29,"div",26),e.TgZ(30,"chq-input",27),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateCustomer(r)}),e.qZA(),e.TgZ(31,"chq-input",27),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateCustomer(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"div",28),e.TgZ(33,"div",26),e.YNc(34,S,1,1,"chq-input",29),e.YNc(35,y,8,4,"div",30),e.TgZ(36,"div",31),e.TgZ(37,"div",26),e.TgZ(38,"chq-input",32,33),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateCustomer(r)}),e.qZA(),e.YNc(40,U,2,1,"chq-input",34),e.YNc(41,oe,7,4,"div",35),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(42,"div",36),e.TgZ(43,"div",37),e._uU(44),e.ALo(45,"translate"),e.qZA(),e.TgZ(46,"div",38),e.TgZ(47,"div",39),e.TgZ(48,"chq-input",40),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateVehicle(r)}),e.qZA(),e.TgZ(49,"div",41),e._UZ(50,"chq-button",22),e.qZA(),e.qZA(),e.TgZ(51,"div",42),e.TgZ(52,"chq-input",43,44),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateVehicle(r)}),e.qZA(),e.TgZ(54,"chq-input",45,46),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateVehicle(r)}),e.qZA(),e.qZA(),e.TgZ(56,"div",47),e.TgZ(57,"chq-input",48,49),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateVehicle(r)}),e.qZA(),e.TgZ(59,"chq-input",40,50),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateVehicle(r)}),e.qZA(),e.qZA(),e.TgZ(61,"div",51),e.TgZ(62,"chq-input",52,53),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateVehicle(r)}),e.qZA(),e.TgZ(64,"chq-input",54,55),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateVehicle(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(66,"div",56),e.TgZ(67,"div",57),e._uU(68),e.ALo(69,"translate"),e.qZA(),e.TgZ(70,"div",58),e.TgZ(71,"div",13),e.TgZ(72,"chq-input",59,60),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.YNc(74,xe,7,6,"div",61),e.TgZ(75,"chq-input",62,63),e.NdJ("clicked",function(r){return e.CHM(t),e.oxw().hideDropdown(r)})("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.YNc(77,Qe,7,6,"div",61),e.YNc(78,Ae,7,6,"div",61),e.qZA(),e.TgZ(79,"div",13),e.TgZ(80,"chq-input",64),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.TgZ(81,"chq-input",40,65),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(83,"div",66),e.TgZ(84,"div",57),e._uU(85),e.ALo(86,"translate"),e.qZA(),e.TgZ(87,"div",67),e.TgZ(88,"div",13),e.TgZ(89,"div",14),e.TgZ(90,"chq-input",68),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(91,mo,2,1,"ng-container",69),e.qZA(),e.TgZ(92,"div",70),e.TgZ(93,"div",57),e._uU(94),e.ALo(95,"translate"),e.qZA(),e.TgZ(96,"div",71),e.TgZ(97,"div",13),e.TgZ(98,"div",14),e.TgZ(99,"div",72),e.TgZ(100,"chq-input",73),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.YNc(101,sc,3,1,"div",74),e.qZA(),e.qZA(),e.qZA(),e.TgZ(102,"div",75),e.TgZ(103,"div",13),e.TgZ(104,"div",14),e.TgZ(105,"chq-input",73),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(106,fo,11,7,"div",76),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(107,"div",77),e.TgZ(108,"div",78),e.TgZ(109,"div",79),e._UZ(110,"img",80),e.qZA(),e.qZA(),e.YNc(111,Va,2,1,"ng-container",69),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.WLB(71,Wa,t.isFormConfirmed,!t.isFormConfirmed)),e.xp6(1),e.Q6J("ngClass",e.VKq(74,Ni,t.isFormConfirmed)),e.xp6(1),e.hij(" ",e.lcZ(3,59,"customer_details")," "),e.xp6(2),e.Q6J("ngClass",e.VKq(76,Dn,t.isFormConfirmed)),e.xp6(3),e.hij("",e.lcZ(8,61,"mandatory_fields")," "),e.xp6(10),e.Q6J("inputModel",t.formModel.customerData.companyOrgType),e.xp6(2),e.Q6J("ngIf","Insurance Company"===t.customerFormData.companyOrgType),e.xp6(1),e.Q6J("ngIf",t.isRetailProvider),e.xp6(1),e.Q6J("ngIf",!t.isRetailProvider||t.customerFormData[t.formModel.customerData.carOwnerSelector.name]&&"Person"!==t.customerFormData[t.formModel.customerData.carOwnerSelector.name]),e.xp6(1),e.Q6J("ngClass",e.VKq(78,Dn,t.isFormConfirmed||!t.currentStatus||t.isTechnician)),e.xp6(2),e.Q6J("buttonModel",t.chqUploadDrivingLicense),e.xp6(6),e.Q6J("inputModel",t.formModel.customerData.firstName),e.xp6(1),e.Q6J("inputModel",t.formModel.customerData.lastName),e.xp6(3),e.Q6J("ngIf",!t.isFormConfirmed),e.xp6(1),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(3),e.Q6J("inputModel",t.formModel.customerData.driverCode),e.xp6(2),e.Q6J("ngIf",!t.isFormConfirmed),e.xp6(1),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(2),e.Q6J("ngClass",e.VKq(80,Ni,t.isFormConfirmed)),e.xp6(1),e.hij(" ",e.lcZ(45,63,"vehicle_detail")," "),e.xp6(3),e.Q6J("ngClass",e.VKq(82,$a,t.searchDisabled)),e.xp6(1),e.Q6J("inputModel",t.formModel.vehicleData.vin),e.xp6(1),e.Q6J("ngClass",e.VKq(84,Dn,t.isFormConfirmed||!t.currentStatus||t.isTechnician)),e.xp6(1),e.Q6J("buttonModel",t.chqUploadRegistrationCard),e.xp6(1),e.Q6J("ngClass",e.VKq(86,dn,t.inputDisabled)),e.xp6(1),e.Q6J("inputModel",t.formModel.vehicleData.make)("ngClass",e.VKq(88,dn,t.makeDisabled)),e.xp6(2),e.Q6J("inputModel",t.formModel.vehicleData.model)("ngClass",e.VKq(90,dn,t.modelDisabled)),e.xp6(2),e.Q6J("ngClass",e.VKq(92,dn,t.inputDisabled)),e.xp6(1),e.Q6J("inputModel",t.formModel.vehicleData.year)("ngClass",e.VKq(94,dn,t.yearDisabled)),e.xp6(2),e.Q6J("inputModel",t.formModel.vehicleData.licensePlate),e.xp6(2),e.Q6J("ngClass",e.VKq(96,ji,t.infoDisabled)),e.xp6(1),e.Q6J("inputModel",t.formModel.vehicleData.carMilege),e.xp6(2),e.Q6J("inputModel",t.formModel.vehicleData.registrationDate),e.xp6(4),e.hij(" ",e.lcZ(69,65,"booking_details")," "),e.xp6(4),e.Q6J("ngClass",e.VKq(98,Dn,t.isFormConfirmed))("inputModel",t.formModel.serviceType),e.xp6(2),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(1),e.Q6J("inputModel",t.formModel.repairTypes)("ngClass",e.WLB(100,Bn,t.repairTypeDisabled,t.isFormConfirmed)),e.xp6(2),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(1),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(2),e.Q6J("inputModel",t.formModel.bookingInDate)("ngClass",t.isFormConfirmed?"col-4":"col-6"),e.xp6(1),e.Q6J("inputModel",t.formModel.bookingOutDate),e.xp6(2),e.Q6J("ngClass",e.VKq(103,Dn,t.isFormConfirmed)),e.xp6(2),e.hij(" ",e.lcZ(86,67,"job_allocation")," "),e.xp6(5),e.Q6J("inputModel",t.formModel.jobAllocation)("ngStyle",t.formModel.communicationChannel.disabled?e.DdM(105,Ha):e.DdM(106,za)),e.xp6(1),e.Q6J("ngIf",t.personalInfoData.jobAllocation&&"Repair"!==t.personalInfoData.serviceType||t.personalInfoData.jobAllocation&&"Repair"===t.personalInfoData.serviceType&&(null==t.formModel.repairTypes||null==t.formModel.repairTypes.selectedOption?null:t.formModel.repairTypes.selectedOption.length)),e.xp6(3),e.hij(" ",e.lcZ(95,69,"other_details")," "),e.xp6(5),e.Q6J("ngClass",e.VKq(107,Dn,t.isFormConfirmed)),e.xp6(1),e.Q6J("inputModel",t.formModel.towedIn),e.xp6(1),e.Q6J("ngIf",t.isFormConfirmed),e.xp6(4),e.Q6J("inputModel",t.formModel.notes),e.xp6(1),e.Q6J("ngIf",(null==t.formModel.communicationChannel.options?null:t.formModel.communicationChannel.options.length)>0),e.xp6(5),e.Q6J("ngIf",!t.commonService.isViewOnly)}}const lc=function(a){return{disabled:a}};J.extend(pr);let Ka=(()=>{class a{constructor(t,i,r,s,p,u,m,C,O,v,w,D,T,R,I){this.router=t,this.commonService=i,this.monitorService=r,this.caseService=s,this.coreService=p,this.vehicleService=u,this.route=m,this.bookingService=C,this.formBuilder=O,this.inspectionService=v,this.mediaCollectionService=w,this.settingService=D,this.labourService=T,this.translateService=R,this.calendarService=I,this.isFormConfirmed=!1,this.inputDisabled=!0,this.infoDisabled=!0,this.searchDisabled=!1,this.inspectionTemplateId=0,this.makeDisabled=!1,this.preventVinCall=!1,this.modelDisabled=!1,this.yearDisabled=!1,this.caseId="",this.umc="",this.validVehicleFields=[],this.employeeList=[],this.towingDisabled=!0,this.repairTypeDisabled=!0,this.labourData=null,this.inspections=null,this.nextUrl="",this.originalVin="",this.isApiLoading=!0,this.documentSteps=[],this.countryId=6,this.canNavigate=!1,this.repairTypes=[],this.originalTariffObject={},this.vinFromOCR="",this.serviceTypeString="",this.repairTypesString="--",this.assigneeString="--",this.mode="",this.employeeRepairServiceType=[],this.previousCompetencies=[],this.isRepairCreatedFromCase=!1,this.isTechnician=!1,this.subscriptions=[],this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.closeButtonModel={label:"Close",type:"primary",onclick:this.closeForm.bind(this)},this.bookingButtonModel={label:"book_in",type:"primary",onclick:this.submitForm.bind(this)},this.chqUploadDrivingLicense={label:"upload_license",type:"outline",icon:"camera",iconColor:"black"},this.chqUploadRegistrationCard={label:"upload_registration",type:"outline",icon:"camera",iconColor:"black"},this.vehicleFormData={vin:"",make:"",model:"",year:"",carMilege:"",licensePlate:"",registrationDate:"",inspectionID:"",inspectionGuid:"",isVinSpecifiedManualZ:!1},this.customerFormData={jobNumber:"",companyOrgType:"",claimNumber:"",companyName:"",tariffId:0,isTariffEditable:!0,licenseId:"",firstName:"",lastName:"",companyId:0,partnershipId:0,customerTypeID:1,driverCode:"",driverPhone:0,carOwnerSelector:"",email:""},this.personalInfoData={customerData:this.customerFormData,vehicleData:this.vehicleFormData,serviceType:"",serviceTypeId:0,repairTypes:null,bookingInDate:"",bookingOutDate:"",towedIn:"Not towed in",notes:"",communicationChannel:[],assignedTo:"",jobAllocation:!1},this.repairEmployees=[],this.repairAssignedEmployees=[],this.selectedOptionRepairs=[],this.userPermission={},this.communicationForm=this.formBuilder.group({communicationChannel:[[],A.kI.required]}),this.commonService.repairGuid.closed&&(this.commonService.repairGuid=new Vt.X(null)),this.commonService.actionTriggered.closed&&(this.commonService.actionTriggered=new Vt.X(null)),this.commonService.labourData.closed&&(this.commonService.labourData=new Vt.X(null)),this.commonService.actionTriggered.subscribe({next:F=>{F&&(this.checkForFormValidation()?(this.nextUrl=F,this.submitForm(F)):this.isFormConfirmed||this.commonService.showToast(0,"msg_booking_validation"))}}),this.commonService.viewActionTriggeredBooking.closed&&(this.commonService.viewActionTriggeredBooking=new Vt.X(null)),this.commonService.viewActionTriggeredBooking.subscribe({next:F=>{F&&F&&"string"==typeof F&&(-1!=F.indexOf("?mode=edit")?(F=F.replace("?mode=edit",""),this.router.navigate([F.replace("{bookingId}",this.repairId)],{queryParams:{mode:"edit"}})):this.router.navigate([F.replace("{bookingId}",this.repairId)]))}});const E=this.commonService.eventfromToastComponent$.subscribe(F=>{F&&(this.monitorService.logEvent("eventfromToastComponent",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.router.navigate(this.nextUrl&&"string"==typeof this.nextUrl?[this.nextUrl.replace("{bookingId}",this.repairId)]:["/repair/booking-journal"]))});this.subscriptions.push(E),this.commonService.userProfileData.subscribe(F=>{if(F&&F.data){const{userPermission:G,organizationDetail:re,vehicleSourceType:z}=F.data;this.userPermission=G||{},this.currentOrgId=re.id,this.estimateId=z}}),this.commonService.labourData.subscribe(F=>{F&&(this.labourData=F)})}get isRetailProvider(){return!!this.customerFormData.companyOrgType&&"Retail"===this.customerFormData.companyOrgType}get showDelete(){var t,i;return!(this.repairId&&(!this.repairId||"draft"!==(null===(t=this.status)||void 0===t?void 0:t.toLowerCase()))&&(!this.repairId||!this.caseId||1!=this.isRepairCreatedFromCase||"repairestimation"!=(null===(i=this.status)||void 0===i?void 0:i.toLowerCase())))}get isRetailAndCompanyProvider(){return!!this.customerFormData.companyOrgType&&("Retail"!==this.customerFormData.companyOrgType||"Retail"===this.customerFormData.companyOrgType&&this.customerFormData.carOwnerSelector&&"Person"!==this.customerFormData.carOwnerSelector)}get retail(){return this.customerFormData.companyOrgType?this.formModel.customerData.companyOrgType.selectedOption[this.formModel.customerData.companyOrgType.displayValue]:""}get currentStatus(){var t;return!this.status&&!this.isFormConfirmed||-1!==["draft","uploaddocuments","uploadphotos"].indexOf(null===(t=this.status)||void 0===t?void 0:t.toLowerCase())&&!this.isFormConfirmed}setCommunicationMethods(){var t;null===(t=this.commonService.userProfileData)||void 0===t||t.subscribe(i=>{var r,s;const p=null===(s=null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.userPermission.orgPackages.find(m=>"Communication Channel"===m.automotiveServiceName))||void 0===s?void 0:s.permissions;let u="~";null==p||p.forEach(m=>{u+=m.permissionName.toLowerCase()}),this.formModel.communicationChannel.options=this.formModel.communicationChannel.options.filter(m=>u.includes(m.label.toLowerCase()))})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,i=t.filter(r=>"Repair Estimate"===r.automotiveServiceName);if(i&&i.length>0){const{permissions:r}=i[0],s=r.filter(p=>"gt.estimate"===p.permissionName||"gt.estimate.vinquery"===p.permissionName);if(s&&s.length>0)return!0}return!1}checkRouteParams(t){this.route.queryParams.subscribe(i=>{i.caseId&&(this.caseId=i.caseId),i.mode&&(this.mode=i.mode),i.startDate&&i.endDate&&(this.startDate=i.startDate,this.endDate=i.endDate),t()})}handleImageOutput(t){const{file:i}=t;this.commonService.showLoading();const r={mediaCollectionId:this.mediaTemplate.collectionGuid,domainId:this.domainId,objectId:this.objectId,mediaTemplateId:this.currentStep.templateGuid,mediaPartTemplateId:this.currentStep.partTemplateGuid};this.monitorService.logEvent("handleImageOutput",["PersonalInfoComponent","addenda-repair",{obj:r}]),this.currentStep.uploadInProgress=!0,this.currentStep.isSkipped=!1,this.currentStep.isUploadFailed=!1,this.currentStep.isUploadSuccess=!1,this.mediaCollectionService.uploadDocumentOCR(i,r).subscribe({next:s=>{this.prefillDriverDetailsFromOcr(null==s?void 0:s.ocrTags),this.handleRegistrationPrefillOCR(null==s?void 0:s.ocrTags),this.currentStep.stepName.includes("Driving")?this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{label:"Retake",icon:"retake"}):this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{label:"Retake",icon:"retake"})},error:s=>{this.monitorService.logException(s,je._.Error),this.commonService.hideLoading()},complete:()=>this.commonService.hideLoading()})}getMediaTemplateByObject(){var t;this.mediaPartTemplates=this.commonService.getAllChild(null===(t=this.mediaTemplate)||void 0===t?void 0:t.mediaTemplates,"mediaPartTemplates","mediaTemplateGuid",{parentProp:"name",childProp:"parentName"});for(let i=0;i<this.mediaPartTemplates.length;i++){const r=this.mediaPartTemplates[i];if(r.name.includes("Vehicle Registration")&&r.name.includes("Driving License"))continue;const s=(0,cn.sH)(r,i);this.documentSteps.push(Object.assign(Object.assign({},s),{mandatory:r.mandatory,index:i,parentName:r.parentName,isFront:r.frontSide,updatedDate:"00000000-0000-0000-0000-000000000000"!=r.mediaPartGuid?r.updatedDate:"",uploadedDate:"00000000-0000-0000-0000-000000000000"!=r.mediaPartGuid?r.createdDate:"",domainId:this.domainId,objectId:this.objectId,sizeLimit:r.sizeLimit,allowExtension:r.allowExtension,uploadedPartGuid:"00000000-0000-0000-0000-000000000000"!=r.mediaPartGuid?r.mediaPartGuid:"",uploadedGuid:"00000000-0000-0000-0000-000000000000"!=r.mediaGuid?r.mediaGuid:"",partTemplateGuid:r.mediaPartTemplateGuid,templateGuid:r.mediaTemplateGuid}))}}prefillDriverDetailsFromOcr(t){if(t&&t.length>0)for(let i=0;i<t.length;i++){const r=t[i];if(r[r.key]=r.value,r.Name){const s=r.Name.split(" ");this.customerFormData.firstName=s[0],this.formModel.customerData.firstName=Object.assign(Object.assign({},this.formModel.customerData.firstName),{value:s[0],selectedOption:{}}),s.splice(0,1),this.customerFormData.lastName=s.join(" "),this.formModel.customerData.lastName=Object.assign(Object.assign({},this.formModel.customerData.lastName),{value:s.join(" "),selectedOption:{}})}}}handleRegistrationPrefillOCR(t){if(this.resetVehicleDropdown(!0),this.vehicleFormData.vin="",this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:""}),t&&t.length>0)for(let i=0;i<t.length;i++){const r=t[i],s=r.value;if(this.infoDisabled=!1,r.key.includes("Chassis"))this.vehicleFormData.vin=s,this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:s}),this.searchDisabled=!1,this.preventVinCall=!1,this.vinFromOCR=s;else if(r.key.includes("Plate"))this.vehicleFormData.licensePlate=s,this.inputDisabled=!1,this.formModel.vehicleData.licensePlate=Object.assign(Object.assign({},this.formModel.vehicleData.licensePlate),{value:s});else if(r.key.includes("Make")||r.key.includes("Veh."))this.vehicleFormData.make=s,this.inputDisabled=!1,this.makeDisabled=!1,this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:s}});else if(r.key.includes("Manufacturer")){const p=s.split("/"),u=`${p[2]}-${p[1]}-${p[0]}T00:00:00`;this.vehicleFormData.registrationDate=u,this.formModel.vehicleData.registrationDate=Object.assign(Object.assign({},this.formModel.vehicleData.registrationDate),{value:u})}else r.key.includes("Model")&&(this.vehicleFormData.model=s,this.modelDisabled=!1,this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:s}}))}}checkMakeModelExistFromOCR(){var t,i,r,s,p;const u=null===(t=this.formModel.vehicleData.make.selectedOption)||void 0===t?void 0:t.name;if(this.commonService.openAlertDialog("warning_header_ocr","warning_message_ocr"),u)if(this.vehicleFormData.isVinSpecifiedManualZ=!0,null===(i=this.formModel.vehicleData.make.options)||void 0===i?void 0:i.some(C=>C.name==u)){if(!(null===(s=this.formModel.vehicleData.model.selectedOption)||void 0===s?void 0:s.modelDescription)){const C=null===(p=this.formModel.vehicleData.make.options)||void 0===p?void 0:p.find(O=>O.name==u);this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{observable:this.vehicleService.getVehicleModel(C.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)}),setTimeout(()=>{var O;null===(O=this.model)||void 0===O||O.triggerObservable()})}}else(null===(r=this.formModel.vehicleData.model.selectedOption)||void 0===r?void 0:r.modelDescription)&&(this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{id:"",name:"00- "}}),this.vehicleFormData.year="00- ")}handleDrivingLicenseVehicleUpload(t){let i="Driving License";t&&(i="Vehicle Registration"),1===this.countryId&&t&&(i+=" Back");const r=this.documentSteps.filter(s=>s.stepName.includes(i));this.currentStep=r[0],this.repairId||this.objectId?(this.currentStep.objectId=this.objectId,this.vinFromOCR="",this.chqUpload.triggerUpload()):(this.commonService.hideLoading(),this.submitForm("",!0,()=>{this.currentStep.objectId=this.objectId,this.chqUpload.triggerUpload(),this.commonService.hideLoading()}))}handleDrivingLicenseClick(){this.handleDrivingLicenseVehicleUpload()}handleRegistrationCardClick(){this.handleDrivingLicenseVehicleUpload(!0)}ngOnInit(){this.formModel={search:{placeHolder:"Search",name:"search",label:"",type:"search",value:0,icon:"cross",preIcon:"search"},serviceType:{placeHolder:"select_dot",name:"serviceType",label:"type_of_service",value:0,type:"select",displayValue:"name",idField:"serviceType",fieldValue:"id",options:[],errorWhenEmpty:!0,validation:{name:"serviceType",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"warning_service_type":""}},repairTypes:{placeHolder:"select_dot",name:"repairTypes",label:"types_of_repair",value:0,type:"select",displayValue:"name",idField:"repairName",fieldValue:"id",errorWhenEmpty:!0,isMultiSelect:!0,validation:{name:"repairTypes",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"required_repair_type":""},options:[]},bookingInDate:{placeHolder:"booking_in",label:"booking_in",name:"bookingInDate",value:new Date,type:"datetime",maxDate:J().add(10,"year").toDate(),minDate:new Date,validation:{name:"bookingInDate",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"required_date":""}},bookingOutDate:{placeHolder:"booking_out",label:"booking_out",name:"bookingOutDate",value:J().add(30,"minutes").toDate(),type:"datetime",maxDate:J().add(10,"year").toDate(),validation:{name:"bookingOutDate",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"required_date":""}},towedIn:{placeHolder:"",label:"",name:"towedIn",idField:"towedIn",value:"Not Towed In",type:"radio",options:[{label:"Not Towed In",id:1},{label:"Towed In/Non-Drivable",id:2}]},notes:{placeHolder:"notes",label:"notes",name:"notes",value:"",type:"textarea",maxLength:500},communicationChannel:{placeHolder:"",label:"",name:"communicationChannel",idField:"communicationChannel",value:"Whatsapp",type:"checkbox",options:[{label:"Whatsapp",id:1,value:1,checked:!1},{label:"Email",id:2,value:2,checked:!1},{label:"SMS",id:3,value:3,checked:!1}],validation:{name:"communicationChannel",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"required_comm_chan":""}},jobAllocation:{placeHolder:"",label:"",name:"jobAllocation",idField:"jobAllocation",value:"",type:"checkbox",options:[{label:"job_assignation",id:1,value:1,checked:!1}]},assignedTo:{placeHolder:"select_dot",name:"assignedTo",label:"assigned_to",value:0,type:"select",displayValue:"name",idField:"assignedTo",fieldValue:"id",errorWhenEmpty:!0,validation:{name:"assignedTo",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:a=>a.required?"required_assign_to":""},options:[]},estimatedEffortHour:{placeHolder:"total_estimated_effort_hour",label:"total_estimated_effort_hour",name:"estimatedEffortHour",value:0,type:"text",maxLength:4,icon:"clock-new",validation:{name:"estimatedEffortHour",validationFunction:()=>A.kI.compose([a=>{const t=a.value;return!t||/^([01][0-9]|2[0-3])$/.test(t)?null:{invalidTimeFormat:!0}}]),validationMessage:a=>a.required?"Please enter estimated effort hour(s)":a.invalidTimeFormat?"Hours should be between 00 - 23":""}},estimatedEffortMinutes:{placeHolder:"total_estimated_effort_min",label:"total_estimated_effort_min",name:"estimatedEffortMinutes",value:0,type:"text",maxLength:4,icon:"clock-new",validation:{name:"estimatedEffortMinutes",validationFunction:()=>A.kI.compose([a=>{const t=a.value;return!t||/^([0-5][0-9])$/.test(t)?null:{invalidTimeFormat:!0}}]),validationMessage:a=>a.required?"Please enter estimated effort minutes(s)":a.invalidTimeFormat?"Minutes should be between 00 - 59":""}}},this.formModel=Object.assign(Object.assign({},this.formModel),{customerData:(0,cn.U6)(),vehicleData:(0,ft.br)()}),this.formModel.vehicleData.vin.icon="",this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{validation:{name:"bookingOutDate",validationFunction:()=>A.kI.compose([A.kI.required,Ua(this.formModel.bookingInDate)]),validationMessage:t=>t.required?"required_date":"bookingout_greater_msg"}}),this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{validation:{name:"make",validationFunction:()=>A.kI.compose([])}}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{validation:{name:"model",validationFunction:()=>A.kI.compose([])}}),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{validation:{name:"year",validationFunction:()=>A.kI.compose([])}}),this.formModel.communicationChannel=Object.assign(Object.assign({},this.formModel.communicationChannel),{validation:{name:"communicationChannel",validationFunction:()=>A.kI.compose([])}}),this.inspectionService.getInspectionTemplateList().subscribe({next:t=>{const i=null==t?void 0:t.data;i.length>0&&(this.commonService.repairInspectionTemplate=i[0],this.inspectionTemplateId=i[0].id)}}),this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{onclick:this.handleDrivingLicenseClick.bind(this),type:"disabled-outline"}),this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{onclick:this.handleRegistrationCardClick.bind(this),type:"disabled-outline"}),this.formModel.customerData.driverCode.observable||(this.formModel.customerData.driverCode.observable=this.coreService.getPhoneNumber(),this.formModel.customerData.driverCode.onObservableLoad=this.onObservableLoad.bind(this)),this.mediaCollectionService.getMediaTemplate().subscribe({next:t=>{if(t.data&&t.data.length>0){const{id:i,collectionGuid:r}=t.data[0];this.domainId=3100,this.mediaTemplateId=i,(0,Un.D)({mediaTemplateDetail:this.mediaCollectionService.getMediaTemplateById(r)}).pipe((0,Jn.K)(p=>(0,Wt.of)(p))).subscribe({next:p=>{p.mediaTemplateDetail&&(this.mediaTemplate=p.mediaTemplateDetail.data,this.countryId=this.mediaTemplate.countryID,this.mediaTemplate.mediaTemplates=this.mediaTemplate.mediaTemplates.sort((m,C)=>m.orderNumber-C.orderNumber),this.getMediaTemplateByObject())}})}}}),this.checkRouteParams(()=>{var t;const i=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.setRequiredLabel(),this.getBookingRepairDetails(i),this.repairId||(this.caseId?this.caseService.getCaseDetail(this.caseId).subscribe({next:r=>{this.prefillCaseData(r)},error:()=>{this.prefillVehicleData()}}):this.prefillVehicleData())}),this.setCommunicationMethods()}ngAfterViewInit(){this.repairId||this.setValidatorForVehicle()}setValidatorForVehicle(){var t,i,r;null===(t=this.mileage)||void 0===t||t.setValidatorForVehicle([A.kI.maxLength(7),A.kI.pattern("^[0-9]+$"),(0,ft.nG)()]),null===(i=this.license)||void 0===i||i.setValidatorForVehicle([A.kI.maxLength(12),A.kI.pattern("^[a-zA-Z0-9]*$"),(0,ft.Gp)()]),null===(r=this.regDate)||void 0===r||r.setValidatorForVehicle([])}getBookingRepairDetails(t){var i;const r=Object.keys(this.formModel.customerData);if(t&&"0"!=t)this.isApiLoading=!0,this.repairId=t,this.loadRepair();else{this.isApiLoading=!1,this.caseId||this.getProvider();for(const s in r){const p=r[s];"driverCode"!==p?this.formModel.customerData[p]=Object.assign(Object.assign({},this.formModel.customerData[p]),{value:"",selectedOption:{}}):(this.formModel.customerData[p]=Object.assign(Object.assign({},this.formModel.customerData[p]),{value:"",selectedOption:{phoneCountryCode:"+91"}}),this.customerFormData.driverCode="+91")}this.getEmployees(),this.populateDropdowns(),(null===(i=this.formModel.communicationChannel.options)||void 0===i?void 0:i.length)>0&&setTimeout(()=>{var s;null===(s=this.communicationChannelControl)||void 0===s||s.setValidatorForCommunicationChannel([A.kI.required])})}}getEmployees(){this.caseService.getCaseUsers("").subscribe({next:t=>{this.employeeList=t.data}})}loadRepair(){var t,i,r,s,p,u;return(0,Ze.mG)(this,void 0,void 0,function*(){const m=Object.keys(this.formModel.customerData);this.commonService.showLoading(),this.bookingButtonModel.label="save",yield this.populateReadonlyFields().then(C=>{var O,v,w,D,T,R,I,E,F,G,re,z;console.log(C),this.repairResponse=C.data,this.objectId=this.repairResponse.id,this.status=this.repairResponse.status,this.statusId=this.repairResponse.statusId,this.vehicleId=(null===(O=this.repairResponse.vehicle)||void 0===O?void 0:O.vehicleId)||"0",this.isRepairCreatedFromCase=this.repairResponse.isRepairCreatedFromCase,"technician"==(null===(v=this.commonService.roleName)||void 0===v?void 0:v.toLowerCase())&&(this.isTechnician=!0),this.inspections={inspectionGuid:null===(w=this.repairResponse.vehicle)||void 0===w?void 0:w.inspectionGuid,inspectionId:null===(D=this.repairResponse.vehicle)||void 0===D?void 0:D.inspectionId},this.caseId=this.repairResponse.quoteId,(null===(T=this.repairResponse.tariffs)||void 0===T?void 0:T.length)>0&&(this.labourData=this.repairResponse.tariffs[0]),this.originalTariffObject={make:null===(R=this.repairResponse.vehicle)||void 0===R?void 0:R.vehicleMake,partnershipId:null===(I=this.repairResponse.customer)||void 0===I?void 0:I.partnershipId,registrationDate:J(null===(E=this.repairResponse.vehicle)||void 0===E?void 0:E.registrationDate).format("YYYY-MM-DDT00:00:00")};const ne=this.repairResponse.inspections;(null==ne?void 0:ne.length)>0&&this.commonService.inspectionId.next(this.repairResponse.inspections[0].inspectionId),this.commonService.bookingId.next(this.repairResponse.repairNumber),this.commonService.repairGuid.next(this.repairResponse.repairGuid),this.commonService.repairDetails.next(this.repairResponse),this.customerFormData=(0,cn.Qb)(this.repairResponse.customer);for(const N in m){const X=this.formModel.customerData[m[N]],{type:B,displayValue:ue,fieldValue:Q}=X;if(this.customerFormData[m[N]])if("select"===B){const ee={};ee[ue]="",ee[Q]=this.customerFormData[m[N]],"companyOrgType"===m[N]&&(ee[ue]=this.customerFormData[m[N]]),this.formModel.customerData[m[N]]=Object.assign(Object.assign({},this.formModel.customerData[m[N]]),{value:"",selectedOption:ee,disabled:!(!this.caseId&&!this.isTechnician&&this.currentOrgId==(null===(G=null===(F=this.repairResponse)||void 0===F?void 0:F.organizationDetail)||void 0===G?void 0:G.organizationId))})}else{let ee={};"companyName"===m[N]&&(ee={companyName:this.customerFormData[m[N]]}),this.formModel.customerData[m[N]]=Object.assign(Object.assign({},this.formModel.customerData[m[N]]),{value:this.customerFormData[m[N]],selectedOption:ee,disabled:!(!this.caseId&&!this.isTechnician&&this.currentOrgId==(null===(z=null===(re=this.repairResponse)||void 0===re?void 0:re.organizationDetail)||void 0===z?void 0:z.organizationId))})}}this.populateVehicleData(),this.populateBookingData()}).catch(()=>{this.commonService.hideLoading()}),this.isApiLoading=!1,(null===(t=this.formModel.communicationChannel.options)||void 0===t?void 0:t.length)>0&&setTimeout(()=>{var C;null===(C=this.communicationChannelControl)||void 0===C||C.setValidatorForCommunicationChannel([A.kI.required])}),this.currentStatus&&this.currentOrgId===(null===(r=null===(i=this.repairResponse)||void 0===i?void 0:i.organizationDetail)||void 0===r?void 0:r.organizationId)&&this.getProvider(),yield this.populateDropdowns(),this.checkForFormValidation(),this.checkWorkProvider(),this.currentOrgId!=(null===(p=null===(s=this.repairResponse)||void 0===s?void 0:s.organizationDetail)||void 0===p?void 0:p.organizationId)&&this.disableAll(),"complete"==(null===(u=this.status)||void 0===u?void 0:u.toLowerCase())&&(this.bookingButtonModel.type="disabled")})}populateReadonlyFields(){return(0,Ze.mG)(this,void 0,void 0,function*(){if(this.repairId&&"0"!=this.repairId)return this.commonService.showLoading(),(0,dt.z)(this.bookingService.getRepairDetailByGuid(this.repairId))})}populateBookingData(){var t,i,r,s,p,u,m,C,O,v,w,D,T,R;const{startDate:I,endDate:E,bookingGuid:F,notes:re,communicationTypeId:z,assignees:ne}=this.repairResponse.booking;this.bookingId=F,this.formModel.bookingInDate=Object.assign(Object.assign({},this.formModel.bookingInDate),{value:I,disabled:!("complete"!==(null===(t=this.status)||void 0===t?void 0:t.toLowerCase())&&!this.isTechnician&&"readytoinvoice"!==(null===(i=this.status)||void 0===i?void 0:i.toLowerCase())&&"invoiced"!==(null===(r=this.status)||void 0===r?void 0:r.toLowerCase()))}),this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{value:E,disabled:!("complete"!==(null===(s=this.status)||void 0===s?void 0:s.toLowerCase())&&!this.isTechnician)}),this.formModel.serviceType=Object.assign(Object.assign({},this.formModel.serviceType),{selectedOption:{id:this.repairResponse.repairTypeId,name:this.repairResponse.repairType},disabled:!("complete"!==(null===(p=this.status)||void 0===p?void 0:p.toLowerCase())&&!this.isTechnician)}),this.serviceTypeString=this.repairResponse.repairType,this.assigneeString=null==ne?void 0:ne.map(X=>X.assigneeName).join(", "),this.formModel.notes=Object.assign(Object.assign({},this.formModel.notes),{value:re,disabled:!("complete"!==(null===(u=this.status)||void 0===u?void 0:u.toLowerCase())&&!this.isTechnician)}),this.formModel.towedIn=Object.assign(Object.assign({},this.formModel.towedIn),{value:this.repairResponse.isTowingNeeded?"Towed In/Non-Drivable":"Not Towed In",disabled:!("complete"!==(null===(m=this.status)||void 0===m?void 0:m.toLowerCase())&&!this.isTechnician)}),this.formModel.communicationChannel=Object.assign(Object.assign({},this.formModel.communicationChannel),{value:z,disabled:!("complete"!==(null===(C=this.status)||void 0===C?void 0:C.toLowerCase())&&!this.isTechnician)}),this.formModel.communicationChannel.options.forEach(X=>{X.checked=!!this.formModel.communicationChannel.value.some(B=>B==X.value)}),this.communicationForm.get("communicationChannel").setValue(this.formModel.communicationChannel.value);const N=[];if(this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:this.repairResponse.isJobAssignationRequired,disabled:!("complete"!==(null===(O=this.status)||void 0===O?void 0:O.toLowerCase())&&!this.isTechnician)}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=this.repairResponse.isJobAssignationRequired),"repair"==(null===(v=this.repairResponse.repairType)||void 0===v?void 0:v.toLowerCase())){const X=[];this.repairResponse.repairServiceTypes.forEach(B=>{N.push({id:B.repairServiceTypeId,name:B.repairServiceType}),this.repairTypes.push({id:B.repairServiceTypeId,name:B.repairServiceType}),X.push(B.repairServiceType)}),this.repairTypesString=X.join(","),this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{selectedOption:N,disabled:!("complete"!==(null===(w=this.status)||void 0===w?void 0:w.toLowerCase())&&!this.isTechnician)}),this.repairTypeDisabled=!1}else"repair"!=(null===(D=this.repairResponse.repairType)||void 0===D?void 0:D.toLowerCase())&&(null===(T=this.repairResponse.repairServiceTypes)||void 0===T?void 0:T.length)>0&&(this.selectedOptionRepairs=[],this.repairResponse.repairServiceTypes.forEach(X=>{X.repairServiceTypeId&&this.selectedOptionRepairs.push({id:X.repairServiceTypeId,name:X.repairServiceType,dropdownItemIcon:this.getIcon(X.repairServiceType),disabled:!0})}));this.personalInfoData=Object.assign(Object.assign({},this.personalInfoData),{bookingInDate:I,bookingOutDate:E,notes:re,communicationChannel:z,serviceType:this.repairResponse.repairType,jobAllocation:this.repairResponse.isJobAssignationRequired,serviceTypeId:this.repairResponse.repairTypeId,repairTypes:(null===(R=this.repairTypes)||void 0===R?void 0:R.length)>0?this.repairTypes:null})}populateVehicleData(){const{vinNumber:t,licensePlateNumber:i,vehicleMileage:r,registrationDate:s,vehicleMake:p,vehicleModel:u,modelYear:m,inspectionId:C,inspectionGuid:O,umc:v,id:w,modelYearRange:D,isVinSpecifiedManualZ:T}=this.repairResponse.vehicle;0!=w&&(this.infoDisabled=!1,this.searchDisabled=!1,this.inputDisabled=!1,this.originalVin=t),(!this.currentStatus||this.isTechnician)&&(this.infoDisabled=!0),this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:t,disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.licensePlate=Object.assign(Object.assign({},this.formModel.vehicleData.licensePlate),{value:i,disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.carMilege=Object.assign(Object.assign({},this.formModel.vehicleData.carMilege),{value:r,disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.registrationDate=Object.assign(Object.assign({},this.formModel.vehicleData.registrationDate),{value:s,disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:p},disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{name:"0"==D?null:D},disabled:!(!this.caseId&&!this.isTechnician)}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:u},disabled:!(!this.caseId&&!this.isTechnician)}),this.umc=v,C&&this.commonService.inspectionId.next(C),this.vehicleFormData=Object.assign(Object.assign({},this.vehicleFormData),{vin:t,make:p,model:u,year:m||D,carMilege:r,licensePlate:i,registrationDate:s,inspectionGuid:O,inspectionID:C,isVinSpecifiedManualZ:T})}prefillCaseData(t){if(t){const i=(0,cn.Wk)(t.data);this.customerFormData=(0,cn.Qb)(i);const r=Object.keys(this.formModel.customerData);this.customerFormData.tariffId=t.data.tariffs[0].tariffId,this.customerFormData.partnershipId=t.data.tariffs[0].partnershipId,this.labourData=t.data.tariffs[0],this.status=t.data.status;for(const s in r){const p=this.formModel.customerData[r[s]],{type:u,displayValue:m,fieldValue:C}=p;if(this.customerFormData[r[s]])if("select"===u){const O={};O[m]="",O[C]=this.customerFormData[r[s]],"companyOrgType"===r[s]&&(O[m]=this.customerFormData[r[s]]),this.formModel.customerData[r[s]]=Object.assign(Object.assign({},this.formModel.customerData[r[s]]),{value:"",selectedOption:O,disabled:!0})}else{let O={};"companyName"===r[s]&&(O={companyName:this.customerFormData[r[s]]}),this.formModel.customerData[r[s]]=Object.assign(Object.assign({},this.formModel.customerData[r[s]]),{value:this.customerFormData[r[s]],selectedOption:O,disabled:!0})}}this.checkWorkProvider(),this.processVehicleData(t)}}processVehicleData(t){return(0,Ze.mG)(this,void 0,void 0,function*(){if(null==t.data)return void this.commonService.hideLoading();const i=t.data.vehicleId||0,r=t.data.inspections,{inspectionId:s,inspectionGuid:p}=(null==r?void 0:r.length)>0?r[0]:[];this.vehicleId=i;const{vinNumber:u,licensePlateNumber:m,vehicleMileage:C,registrationDate:O,vehicleMake:v,vehicleModel:w,modelYear:D,umc:T}=t.data;0!=i&&(this.infoDisabled=!1,this.searchDisabled=!1,this.inputDisabled=!1,this.preventVinCall=!0),this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:u,disabled:!0}),this.formModel.vehicleData.licensePlate=Object.assign(Object.assign({},this.formModel.vehicleData.licensePlate),{value:m,disabled:!0}),this.formModel.vehicleData.carMilege=Object.assign(Object.assign({},this.formModel.vehicleData.carMilege),{value:C,disabled:!0}),this.formModel.vehicleData.registrationDate=Object.assign(Object.assign({},this.formModel.vehicleData.registrationDate),{value:O,disabled:!0}),this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:v},disabled:!0}),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{disabled:!0,selectedOption:{name:D||t.data.modelYearRange}}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:w},disabled:!0}),this.umc=T,this.vehicleFormData=Object.assign(Object.assign({},this.vehicleFormData),{vin:u,make:v,model:w,year:D||t.data.modelYearRange,carMilege:C,licensePlate:m,registrationDate:O,vehicleId:i,inspectionGuid:p,inspectionID:s}),this.commonService.hideLoading(),yield this.populateDropdowns()})}updateButton(){return(0,Ze.mG)(this,void 0,void 0,function*(){this.monitorService.logEvent("updateButton",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.isFormConfirmed=!this.isFormConfirmed,this.setMode(this.isFormConfirmed?"text":"value"),"edit booking"==this.bookingButtonModel.label.toLowerCase()&&(this.preventVinCall=!0,this.vehicleFormData.vin&&this.vehicleService.getVinDecoder(this.vehicleFormData.vin).subscribe({next:i=>{this.makeDisabled=!!(null==i?void 0:i.success)}}),yield this.populateDropdowns()),this.bookingButtonModel=Object.assign(Object.assign({},this.bookingButtonModel),{label:this.isFormConfirmed?"Edit Booking":"Save",type:this.isFormConfirmed?"outline":"primary",icon:this.isFormConfirmed?"edit":""})})}openDocument(){this.caseService.getCases({offset:0,pageSize:1,maxPageButtons:6,currentPage:1,orderBy:"CreatedDate",sortDirection:"asc"}).subscribe(i=>{if(i&&i.value){const{CaseGuid:r}=i.value[0];this.router.navigate([`repair/booking/${r}/document`],{queryParams:{fromPersonal:!0}})}})}addVehicle(){return(0,Ze.mG)(this,void 0,void 0,function*(){const t={vin:this.vehicleFormData.vin,vehicleCountryId:1,umc:this.umc,make:this.vehicleFormData.make,model:this.vehicleFormData.model,mileage:Number(this.vehicleFormData.carMilege),firstRegistrationDate:J(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"),registrationNumber:this.vehicleFormData.licensePlate,condition:1,ModelYearRange:this.vehicleFormData.year,InspectionTemplateId:this.inspectionTemplateId,CustomerName:this.customerFormData.firstName,CustomerEmail:this.customerFormData.email};return(0,dt.z)(this.vehicleService.addVehicle(t,3100,0)).then(i=>{i&&(this.vehicleId=i.id,this.vehicleFormData.inspectionID=i.inspectionId,this.vehicleFormData.inspectionGuid=i.inspectionGuid)}).catch(i=>{throw this.commonService.hideLoading(),i})})}setPrefillData(t){var i,r,s,p,u,m,C;const O=this.commonService.getSessionStorage("selectedSearchItem");if(!this.caseId&&O){const v=JSON.parse(O);if(this.formModel.customerData.email=Object.assign(Object.assign({},this.formModel.customerData.email),{value:v.email,selectedOption:{}}),this.customerFormData.email=v.email,v.firstName&&(this.customerFormData.firstName=v.firstName,this.formModel.customerData.firstName=Object.assign(Object.assign({},this.formModel.customerData.firstName),{value:this.customerFormData.firstName,selectedOption:{}})),v.lastName&&(this.customerFormData.lastName=v.lastName,this.formModel.customerData.lastName=Object.assign(Object.assign({},this.formModel.customerData.lastName),{value:this.customerFormData.lastName,selectedOption:{}})),v.phoneNumber){const w=null===(i=v.phoneNumber)||void 0===i?void 0:i.substring(0,3),D=null===(r=v.phoneNumber)||void 0===r?void 0:r.substring(0,4);let T="",R=t.filter(I=>I.phoneCountryCode===w);if(0===R.length?(T=null===(s=v.phoneNumber)||void 0===s?void 0:s.substring(4,null===(p=v.phoneNumber)||void 0===p?void 0:p.length),R=t.filter(I=>I.phoneCountryCode===D)):T=null===(u=v.phoneNumber)||void 0===u?void 0:u.substring(3,null===(m=v.phoneNumber)||void 0===m?void 0:m.length),R.length>0){const I=R[0],E=I.regExpression;this.customerFormData.driverCode=null==I?void 0:I.phoneCountryCode,this.formModel.customerData.driverCode=Object.assign(Object.assign({},this.formModel.customerData.driverCode),{selectedOption:I}),null===(C=this.driverPhone)||void 0===C||C.updateCurrentValidation(E,!0)}this.formModel.customerData.driverPhone=Object.assign(Object.assign({},this.formModel.customerData.driverPhone),{value:T,selectedOption:{}}),this.customerFormData.driverPhone=parseInt(T)}(v.email||v.phoneNumber||v.firstName)&&this.commonService.setSessionStorage("selectedSearchItem","")}}setRequiredLabel(){const t=["notes","repairtypes"];Object.keys(this.formModel).forEach(i=>{"customerdata"==i.toLowerCase()||"vehicledata"==i.toLowerCase()?Object.keys(this.formModel[i]).forEach(r=>{"vehicledata"==i.toLowerCase()?this.formModel[i][r].required=!1:t.includes(r.toLowerCase())||(this.formModel[i][r].required=!0)}):t.includes(i.toLowerCase())||(this.formModel[i].required=!0)}),this.startDate&&this.endDate?(this.personalInfoData.bookingInDate=J(this.startDate).local().utc().format(),this.formModel.bookingInDate=Object.assign(Object.assign({},this.formModel.bookingInDate),{value:this.personalInfoData.bookingInDate}),this.personalInfoData.bookingOutDate=J(this.endDate).local().utc().format(),this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{value:this.personalInfoData.bookingOutDate})):(this.personalInfoData.bookingInDate=J.utc(this.formModel.bookingInDate.value.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z",this.personalInfoData.bookingOutDate=J.utc(this.formModel.bookingOutDate.value.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z")}disableAll(){Object.keys(this.formModel).forEach(t=>{"customerdata"==t.toLowerCase()||"vehicledata"==t.toLowerCase()?Object.keys(this.formModel[t]).forEach(i=>{this.formModel[t][i].disabled=!0}):this.formModel[t].disabled=!0})}populateDropdowns(){var t,i,r,s,p,u,m,C,O,v,w,D,T,R,I,E,F,G,re;return(0,Ze.mG)(this,void 0,void 0,function*(){this.formModel.customerData.driverCode.observable||(this.formModel.customerData.driverCode=Object.assign(Object.assign({},this.formModel.customerData.driverCode),{observable:this.coreService.getPhoneNumber(),onObservableLoad:this.onObservableLoad.bind(this)}));const z=yield(0,dt.z)(this.settingService.getBookingRepairType()),ne=null===(t=null==z?void 0:z.data)||void 0===t?void 0:t.BookingTypes;let N=(null===(r=null===(i=null==z?void 0:z.data)||void 0===i?void 0:i.RepairType)||void 0===r?void 0:r.length)?null===(s=z.data)||void 0===s?void 0:s.RepairType[0].RepairTypes:null;if(ne&&ne.length>0){if(this.formModel.serviceType=Object.assign(Object.assign({},this.formModel.serviceType),{options:ne}),this.repairId&&!(null===(p=this.formModel.serviceType.options)||void 0===p?void 0:p.some(B=>{var ue;return B.id==(null===(ue=this.repairResponse)||void 0===ue?void 0:ue.repairTypeId)}))){const B=yield(0,dt.z)(this.settingService.getAllSettings()),Q=(null===(u=null==B?void 0:B.data)||void 0===u?void 0:u.BookingTypes).find(ee=>ee.id==this.repairResponse.repairTypeId);if(Q&&this.formModel.serviceType.options.push(Q),"repair"==(null===(m=this.personalInfoData.serviceType)||void 0===m?void 0:m.toLowerCase())){const ee=null===(C=this.formModel.repairTypes)||void 0===C?void 0:C.selectedOption;N=(null===(v=null===(O=null==B?void 0:B.data)||void 0===O?void 0:O.RepairType[0].RepairTypes)||void 0===v?void 0:v.length)?null===(D=null===(w=B.data)||void 0===w?void 0:w.RepairType[0].RepairTypes)||void 0===D?void 0:D.filter(Me=>!(null==ee?void 0:ee.map(Le=>Le.id).includes(Me.id))):null,N=[...N,...ee],N.sort((Me,Le)=>Me.id<Le.id?-1:Me.id>Le.id?1:0)}}else if(this.repairId&&"repair"==(null===(T=this.personalInfoData.serviceType)||void 0===T?void 0:T.toLowerCase())){const ue=(null===(R=this.formModel.repairTypes)||void 0===R?void 0:R.selectedOption).filter(Q=>!N.map(ee=>ee.id).includes(Q.id));ue.length>0&&(N=[...N,...ue],N.sort((Q,ee)=>Q.id<ee.id?-1:Q.id>ee.id?1:0))}"repair"!=(null===(I=this.personalInfoData.serviceType)||void 0===I?void 0:I.toLowerCase())&&(this.formModel.bookingOutDate.disabled=!0)}N&&N.length>0&&(N.forEach((B,ue)=>{N[ue]=this.selectedOptionRepairs.some(Q=>Q.id===B.id)?Object.assign(Object.assign({},N[ue]),{dropdownItemIcon:this.getIcon(B.name),disabled:!0}):Object.assign(Object.assign({},N[ue]),{dropdownItemIcon:this.getIcon(B.name)})}),this.repairTypes=N,this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{options:N}));const X=null===(E=this.repairResponse)||void 0===E?void 0:E.repairServiceTypes;if(this.personalInfoData.serviceType&&("Repair"==this.personalInfoData.serviceType?(X.some(B=>B.employees.length>0)&&(yield this.getAllAssignedEmployees(null==X?void 0:X.filter(B=>null!=B.repairServiceType))),this.previousCompetencies=null===(F=this.formModel.repairTypes.selectedOption)||void 0===F?void 0:F.map(B=>B.id)):((null===(G=this.selectedOptionRepairs)||void 0===G?void 0:G.length)>0&&(this.previousCompetencies=null===(re=this.selectedOptionRepairs)||void 0===re?void 0:re.map(B=>B.id)),yield this.getAllAssignedEmployeesAssessment(null==X?void 0:X.filter(B=>null==B.repairServiceType)))),this.currentStatus){this.commonService.showLoading();const B=yield(0,dt.z)(this.vehicleService.getVehicleMake());this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{options:B.sort((ee,Me)=>ee.name.localeCompare(Me.name))});const Q=this.formModel.vehicleData.make.options.filter(ee=>ee.name===this.vehicleFormData.make);Q.length>0&&this.vehicleService.getVehicleModel(Q[0].id,this.estimateId).subscribe(ee=>{var Me,Le;this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{options:ee});const tt=null===(Me=this.formModel.vehicleData.model.options)||void 0===Me?void 0:Me.filter(nt=>nt.umc==this.umc);tt.length>0&&(null===(Le=this.vehicleService.getVehicleYearByModel(tt[0].id,this.estimateId))||void 0===Le||Le.subscribe(nt=>{this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{options:nt})}))}),this.commonService.hideLoading()}})}prefillVehicleData(){const t=this.commonService.getSessionStorage("selectedSearchItem");if(t){const i=JSON.parse(t);i.make&&!this.vehicleFormData.make&&(this.vehicleFormData.make=i.make,this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:i.make}})),i.model&&!this.vehicleFormData.model&&(this.vehicleFormData.model=i.model,this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:i.model}})),i.vin&&!this.vehicleFormData.vin&&(this.vehicleFormData.vin=i.vin,this.preventVinCall=!0,this.formModel.vehicleData.vin=Object.assign(Object.assign({},this.formModel.vehicleData.vin),{value:i.vin})),i.importInterval&&!this.vehicleFormData.year&&(this.vehicleFormData.year=i.importInterval,this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{value:i.importInterval,selectedOption:{name:i.importInterval}})),i.plate&&!this.vehicleFormData.licensePlate&&(this.vehicleFormData.licensePlate=i.plate,this.formModel.vehicleData.licensePlate=Object.assign(Object.assign({},this.formModel.vehicleData.licensePlate),{value:i.plate})),(i.make||i.model||i.vin||i.plate)&&(this.infoDisabled=!1,this.searchDisabled=!1,this.inputDisabled=!1,(!i.email||!i.name||!i.phoneNumber)&&this.commonService.setSessionStorage("selectedSearchItem",""))}}onObservableLoad(t){if(this.commonService.hideLoading(),t&&t&&t.length>0){const i=t.filter(r=>{var s;return r.phoneCountryCode===(null===(s=this.formModel.customerData.driverCode.selectedOption)||void 0===s?void 0:s.phoneCountryCode)});if(i.length>0){const r=i[0],s=r.regExpression;this.formModel.customerData.driverCode=Object.assign(Object.assign({},this.formModel.customerData.driverCode),{selectedOption:r}),this.driverPhone&&this.driverPhone.updateCurrentValidation(s,!0),this.repairId||this.setPrefillData(t)}}}onObservableLoadRepairTypes(t){this.commonService.hideLoading(),t&&t.length>0&&t.forEach((i,r)=>{t[r]=Object.assign(Object.assign({},t[r]),{dropdownItemIcon:this.getIcon(i.name)})}),this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{options:t})}onObservableLoadServiceAndRepairTypes(t){var i;if(this.commonService.hideLoading(),t){const r=t.BookingTypes,s=(null===(i=t.RepairType)||void 0===i?void 0:i.length)?t.RepairType[0].RepairTypes:null;r&&r.length>0&&(this.formModel.serviceType=Object.assign(Object.assign({},this.formModel.serviceType),{options:r})),s&&s.length>0&&(s.forEach((p,u)=>{s[u]=Object.assign(Object.assign({},s[u]),{dropdownItemIcon:this.getIcon(p.name)})}),this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{options:s}))}}getIcon(t){switch(t){case"Body":return"car";case"Maintenance":return"house";case"Tires":return"tire";case"Paint":return"paintbrush";case"Others":return"gears";case"Electric":case"Electrical":return"bolt-car";case"Diagnosis":return"diagnosis";case"Mechanical":return"mechanical";default:return""}}setMode(t="text"){Object.keys(this.formModel).forEach(r=>{"customerdata"==r.toLowerCase()||"vehicledata"==r.toLowerCase()?Object.keys(this.formModel[r]).forEach(s=>{if("customerdata"==r.toLowerCase())if(this.formModel[r][s].required=!1,"companyOrgType"===s){const p={},{displayValue:u,fieldValue:m}=this.formModel[r][s];p[m]=this.customerFormData[s],p[u]="",p[u]=this.customerFormData[s],this.formModel[r][s]=Object.assign(Object.assign({},this.formModel[r][s]),{mode:t})}else this.formModel[r][s]=Object.assign(Object.assign({},this.formModel[r][s]),{mode:t});else this.formModel[r][s]=Object.assign(Object.assign({},this.formModel[r][s]),{mode:t})}):this.formModel[r]=Object.assign(Object.assign({},this.formModel[r]),{mode:t})}),"text"==t&&(this.bookingButtonModel=Object.assign(Object.assign({},this.bookingButtonModel),{label:"Edit Booking",type:"outline",icon:"edit"}))}onFormUpdate(t){var i,r,s,p,u,m,C,O,v,w,D,T,R,I,E,F,G,re,z,ne,N,X,B,ue,Q,ee,Me,Le,tt,nt,Ue,Ct,Ot;return(0,Ze.mG)(this,void 0,void 0,function*(){if("select"===t.type){this.formModel[t.name]=Object.assign(Object.assign({},this.formModel[t.name]),{selectedOption:t.value});const De=this.formModel[t.name].fieldValue;if(this.personalInfoData[t.name]="repairTypes"!==t.name?t.value[De]:t.value,"repairTypes"===t.name){if(""==t.value&&(this.formModel[t.name]=Object.assign(Object.assign({},this.formModel[t.name]),{selectedOption:[]})),setTimeout(()=>{var te;null===(te=this.repairType)||void 0===te||te.setUnTouched()}),1==this.personalInfoData.jobAllocation){let te=[];this.previousCompetencies.length<(null===(i=this.formModel.repairTypes.selectedOption)||void 0===i?void 0:i.length)?(te=null===(r=this.personalInfoData[t.name])||void 0===r?void 0:r.filter(qe=>!this.previousCompetencies.includes(qe.id)),te&&te.length?yield this.getAllAssignedEmployees(null===(s=this.repairResponse)||void 0===s?void 0:s.repairServiceTypes,te[0].id):yield this.getAllAssignedEmployees(null===(p=this.repairResponse)||void 0===p?void 0:p.repairServiceTypes)):(te=null===(u=this.previousCompetencies)||void 0===u?void 0:u.filter(qe=>{var ct;return!(null===(ct=this.formModel.repairTypes.selectedOption)||void 0===ct?void 0:ct.map(Lt=>Lt.id).includes(qe))}),te.length&&(this.repairEmployees=this.repairEmployees.filter(qe=>qe.repairId!=te[0]),this.employeeRepairServiceType=null===(m=this.employeeRepairServiceType)||void 0===m?void 0:m.filter(qe=>qe.repairServiceTypeId!=te[0])))}0==(null===(C=this.repairEmployees)||void 0===C?void 0:C.length)&&this.personalInfoData.jobAllocation&&(this.commonService.showInfoToast(1e3,"msg_no_competency"),this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:!1}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=!1),this.personalInfoData.jobAllocation=!1),this.previousCompetencies=null===(O=this.formModel[t.name].selectedOption)||void 0===O?void 0:O.map(te=>te.id)}else if("serviceType"===t.name)if(this.personalInfoData.serviceType=t.value.name,this.personalInfoData.serviceTypeId=t.value.id,this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:!1}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=!1),this.personalInfoData.jobAllocation=!1,this.employeeRepairServiceType=[],this.repairEmployees=[],this.previousCompetencies=(null===(v=this.selectedOptionRepairs)||void 0===v?void 0:v.length)>0?null===(w=this.selectedOptionRepairs)||void 0===w?void 0:w.map(te=>te.id):[],"Repair"==(null===(D=t.value)||void 0===D?void 0:D.name)){if(this.selectedOptionRepairs.length>0&&"repair"!=this.serviceTypeString.toLowerCase()){const te=null===(T=this.selectedOptionRepairs)||void 0===T?void 0:T.filter(qe=>{var ct,Lt;return!(null===(Lt=null===(ct=this.repairTypes)||void 0===ct?void 0:ct.map(_n=>_n.id))||void 0===Lt?void 0:Lt.includes(qe.id))});(null==te?void 0:te.length)>0&&(this.repairTypes=[...this.repairTypes,...te]),this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{selectedOption:this.selectedOptionRepairs}),this.personalInfoData.repairTypes=this.selectedOptionRepairs}this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{options:this.repairTypes}),this.repairTypeDisabled=!1,this.formModel.bookingOutDate.disabled=!1,this.formModel.repairTypes.required=!0}else{this.formModel.repairTypes.required=!1;const te=this.formModel.serviceType.options.find(qe=>qe.id==t.value.id);if(null==te?void 0:te.duration){const qe=J.utc(this.formModel.bookingInDate.value.toString()).add(null==te?void 0:te.duration,"minutes").toDate();this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{value:qe}),this.personalInfoData.bookingOutDate=J(qe).local().utc().format(),this.formModel.bookingOutDate.disabled=!0}this.formModel.repairTypes=Object.assign(Object.assign({},this.formModel.repairTypes),{selectedOption:[],options:[],placeHolder:"Select..."}),this.personalInfoData.repairTypes=null,setTimeout(()=>{this.repairType&&(this.repairType.dropdownValidationMessage="",this.repairType.dropdownContainer.dropdownConfig.isTouched=!1,this.repairType.dropdownContainer.dropdownConfig.isDirty=!1)},0),this.repairTypeDisabled=!0}}else if("jobAllocation"==t.name)this.repairEmployees=[],"repair"===this.personalInfoData.serviceType.toLowerCase()?(null===(R=this.formModel.repairTypes.selectedOption)||void 0===R?void 0:R.length)&&(1==t.value?(yield this.getAllAssignedEmployees(null===(I=this.repairResponse)||void 0===I?void 0:I.repairServiceTypes),0==(null===(E=this.repairEmployees)||void 0===E?void 0:E.length)&&(this.commonService.showInfoToast(1e3,"msg_no_competency"),t.value=!1,this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:!1}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=!1))):((null===(G=null===(F=this.repairResponse)||void 0===F?void 0:F.repairServiceTypes)||void 0===G?void 0:G.length)&&(this.repairResponse.repairServiceTypes[0].employees=null===(re=this.repairResponse)||void 0===re?void 0:re.repairServiceTypes[0].employees.filter(De=>null!=De.assigneeId)),this.employeeRepairServiceType=[])):this.personalInfoData.serviceType&&(1==t.value?(yield this.getAllAssignedEmployeesAssessment(0==(null===(z=this.selectedOptionRepairs)||void 0===z?void 0:z.length)?null===(ne=this.repairResponse)||void 0===ne?void 0:ne.repairServiceTypes:[]),0==(null===(N=this.repairEmployees)||void 0===N?void 0:N.length)&&(this.commonService.showInfoToast(1e3,"msg_no_competency"),t.value=!1,this.formModel.jobAllocation=Object.assign(Object.assign({},this.formModel.jobAllocation),{value:!1}),this.formModel.jobAllocation.options.length&&(this.formModel.jobAllocation.options[0].checked=!1))):((null===(B=null===(X=this.repairResponse)||void 0===X?void 0:X.repairServiceTypes)||void 0===B?void 0:B.length)&&(this.repairResponse.repairServiceTypes[0].employees=null===(ue=this.repairResponse)||void 0===ue?void 0:ue.repairServiceTypes[0].employees.filter(De=>null!=De.assigneeId)),this.employeeRepairServiceType=[])),this.formModel[t.name].value=t.value,this.personalInfoData[t.name]=t.value;else if("checkbox"==t.type){if(t.value)this.personalInfoData.communicationChannel.push(t.keyFieldValue);else if(this.personalInfoData.communicationChannel.includes(t.keyFieldValue)){const De=this.personalInfoData.communicationChannel.indexOf(t.keyFieldValue);De>-1&&this.personalInfoData.communicationChannel.splice(De,1)}this.communicationForm.get("communicationChannel").setValue(this.personalInfoData.communicationChannel)}else{if("towedin"==t.name.toLowerCase())this.towingDisabled="towed in/non-drivable"!=t.value.toLowerCase();else if("bookingInDate"==t.name&&"repair"!=(null===(Q=this.personalInfoData.serviceType)||void 0===Q?void 0:Q.toLowerCase())){const De=this.formModel.serviceType.options.find(te=>te.id==this.personalInfoData.serviceTypeId);if(null==De?void 0:De.duration){const te=J.utc(t.value).add(null==De?void 0:De.duration,"minutes").toDate();this.formModel.bookingOutDate=Object.assign(Object.assign({},this.formModel.bookingOutDate),{value:te}),this.personalInfoData.bookingOutDate=J(te).local().utc().format()}}t.isValid?(this.formModel[t.name].value=t.value,this.personalInfoData[t.name]=t.value):(this.formModel[t.name].value="",this.personalInfoData[t.name]=""),"bookingInDate"==t.name?t.isValid&&new Date(this.personalInfoData.bookingOutDate)>new Date(t.value)&&this.personalInfoData.jobAllocation&&(this.repairEmployees=[],this.employeeRepairServiceType=[],"repair"==(null===(ee=this.personalInfoData.serviceType)||void 0===ee?void 0:ee.toLowerCase())?yield this.getAllAssignedEmployees(null===(Me=this.repairResponse)||void 0===Me?void 0:Me.repairServiceTypes):yield this.getAllAssignedEmployeesAssessment(0==(null===(Le=this.selectedOptionRepairs)||void 0===Le?void 0:Le.length)?null===(tt=this.repairResponse)||void 0===tt?void 0:tt.repairServiceTypes:[])):"bookingOutDate"==t.name&&t.isValid&&new Date(t.value)>new Date(this.personalInfoData.bookingInDate)&&this.personalInfoData.jobAllocation&&(this.repairEmployees=[],this.employeeRepairServiceType=[],"repair"==(null===(nt=this.personalInfoData.serviceType)||void 0===nt?void 0:nt.toLowerCase())?yield this.getAllAssignedEmployees(null===(Ue=this.repairResponse)||void 0===Ue?void 0:Ue.repairServiceTypes):yield this.getAllAssignedEmployeesAssessment(0==(null===(Ct=this.selectedOptionRepairs)||void 0===Ct?void 0:Ct.length)?null===(Ot=this.repairResponse)||void 0===Ot?void 0:Ot.repairServiceTypes:[]))}this.personalInfoData=Object.assign({},this.personalInfoData),this.checkForFormValidation()})}getAllAssignedEmployees(t=[],i=0){var r,s;return(0,Ze.mG)(this,void 0,void 0,function*(){const p=[];0==i?null===(s=null===(r=this.formModel.repairTypes)||void 0===r?void 0:r.selectedOption)||void 0===s||s.forEach(u=>{p.push(u.id)}):p.push(i),p.length>0&&(this.commonService.showLoading(),yield(0,dt.z)(this.bookingService.getEmployeesByCompetencies(p,this.personalInfoData.bookingInDate,this.personalInfoData.bookingOutDate)).then(u=>{(null==u?void 0:u.data)&&u.data.forEach(m=>{var C,O;let v=[],w=[],D=[];(null==t?void 0:t.length)&&(v=t.filter(T=>T.repairServiceTypeId==m.competencyId),v.length&&(w=v[0].employees.map(T=>T.assigneeId||T.employeeId),(null===(C=this.employeeRepairServiceType)||void 0===C?void 0:C.some(T=>T.repairServiceTypeId==m.competencyId))||this.employeeRepairServiceType.push({employees:w,repairServiceTypeId:m.competencyId}),D=m.employees.filter(T=>!w.includes(T.employeeId)))),this.repairEmployees.push({repair:null===(O=this.formModel.repairTypes.selectedOption)||void 0===O?void 0:O.filter(T=>T.id==m.competencyId).map(T=>T.name),repairId:m.competencyId,employees:v.length>0?D:m.employees,employeesAssigned:v.length>0?v[0].employees:[],active:!0})}),this.commonService.hideLoading()}).catch(()=>{this.commonService.hideLoading()}))})}getAllAssignedEmployeesAssessment(t=[]){return(0,Ze.mG)(this,void 0,void 0,function*(){this.commonService.showLoading(),yield(0,dt.z)(this.bookingService.getEmployeesByCompetencies(null,this.personalInfoData.bookingInDate,this.personalInfoData.bookingOutDate)).then(i=>{if(null==i?void 0:i.data){this.repairEmployees=[];let r=[],s=[],p=[];(null==t?void 0:t.length)?(r=t,s=r[0].employees.map(u=>u.assigneeId||u.employeeId),this.employeeRepairServiceType.push({employees:s,repairServiceTypeId:null}),p=null==i?void 0:i.data.filter(u=>!s.includes(u.employeeId)),this.repairEmployees.push({repair:"",repairId:null,employees:p,employeesAssigned:r[0].employees})):this.repairEmployees.push({repair:"",repairId:null,employees:i.data,employeesAssigned:[]})}this.commonService.hideLoading()}).catch(()=>{this.commonService.hideLoading()})})}setMinutesAndHours(t,i){const s=t,p=new Date(i).getTime()-new Date(s).getTime(),u=Math.round(p/6e4),m=Math.floor(u/60),C=u%60;this.formModel.estimatedEffortMinutes=Object.assign(Object.assign({},this.formModel.estimatedEffortMinutes),{value:C}),this.formModel.estimatedEffortHour=Object.assign(Object.assign({},this.formModel.estimatedEffortHour),{value:m})}onFormUpdateCustomer(t){var i,r,s,p,u;if("driverCode"===t.name){const m=t.value.regExpression;null===(i=this.driverPhone)||void 0===i||i.updateCurrentValidation(m)}if("select"===t.type){const m=this.customerFormData[t.name],C=this.formModel.customerData[t.name].fieldValue||this.formModel.customerData[t.name].displayValue;if((null===(r=this.formModel[t.name])||void 0===r?void 0:r.selectedOption)&&(null===(s=this.formModel[t.name])||void 0===s?void 0:s.selectedOption[C])===(null==t?void 0:t.value[C]))return;this.formModel.customerData[t.name]=Object.assign(Object.assign({},this.formModel.customerData[t.name]),{selectedOption:t.value}),this.customerFormData[t.name]=t.value[C],"companyOrgType"===t.name&&(m!==this.customerFormData[t.name]&&setTimeout(()=>{var O,v;null===(O=this.companyOrg)||void 0===O||O.setUnTouched(),null===(v=this.licenseId)||void 0===v||v.setUnTouched()}),t.value[C]&&"Insurance Company"!==t.value[this.formModel.customerData[t.name].displayValue]&&(this.formModel.customerData.claimNumber=Object.assign(Object.assign({},this.formModel.customerData.claimNumber),{value:""})),t.value[C]&&"Retail"!==t.value[this.formModel.customerData[t.name].displayValue]?(this.formModel.customerData.companyName=Object.assign(Object.assign({},this.formModel.customerData.companyName),{displayValue:"companyName",fieldValue:"companyName",onObservableLoad:this.updateCaseData.bind(this),placeHolder:"Select...",value:"",type:"select",observable:this.caseService.getCompanyData(t.value[C],"")}),this.formModel.customerData.companyName.selectedOption&&(null===(p=this.formModel.customerData.companyName.selectedOption)||void 0===p?void 0:p.tariffId)&&(this.customerFormData.companyId=null,this.customerFormData.companyName=null,this.formModel.customerData.companyName.selectedOption={}),this.customerFormData.licenseId="",this.formModel.customerData.licenseId=Object.assign(Object.assign({},this.formModel.customerData.licenseId),{value:""}),setTimeout(()=>{var O;m&&"Retail"!==m&&this.currentStatus&&(null===(O=this.companyOrg)||void 0===O||O.triggerObservable())})):(t.value[C]&&"Retail"===t.value[this.formModel.customerData[t.name].displayValue]&&(this.formModel.customerData.claimNumber=Object.assign(Object.assign({},this.formModel.customerData.claimNumber),{value:""}),this.formModel.customerData.companyName=Object.assign(Object.assign({},this.formModel.customerData.companyName),{placeHolder:"Company Name"}),this.customerFormData.claimNumber="",this.caseService.getCompanyData(t.value[C],"").subscribe({next:O=>{var v,w,D;if(O&&(null===(v=O.data)||void 0===v?void 0:v.length)>0){const T=O.data[0];this.customerFormData.companyId=T.companyId,this.customerFormData.tariffId=T.tariffId,this.formModel.customerData.companyName.selectedOption&&(null===(w=this.formModel.customerData.companyName.selectedOption)||void 0===w?void 0:w.tariffId)&&(this.customerFormData.licenseId="",this.formModel.customerData.licenseId=Object.assign(Object.assign({},null===(D=this.formModel)||void 0===D?void 0:D.customerData.licenseId),{value:""})),"Person"===this.customerFormData[this.formModel.customerData.carOwnerSelector.name]&&(this.customerFormData.companyName=null,this.formModel.customerData.companyName.value=""),this.customerFormData.isTariffEditable=T.isEditable,this.customerFormData.partnershipId=T.partnershipId,this.formModel.customerData.companyName.selectedOption=T[0],this.checkForFormValidation()}},error:()=>{this.customerFormData.tariffId=0,this.customerFormData.isTariffEditable=!1}})),this.formModel.customerData.companyName=Object.assign(Object.assign({},this.formModel.customerData.companyName),{type:"text"}))),"companyName"===t.name&&t.value&&(this.customerFormData.companyId=t.value.companyId,this.customerFormData.tariffId=t.value.tariffId,this.customerFormData.isTariffEditable=t.value.isEditable,this.customerFormData.licenseId=t.value.licenseId.toString(),this.formModel.customerData.licenseId=Object.assign(Object.assign({},null===(u=this.formModel)||void 0===u?void 0:u.customerData.licenseId),{value:t.value.licenseId.toString()}),this.customerFormData.partnershipId=t.value.partnershipId),this.customerFormData[this.formModel.customerData[t.name].idField]=t.value[this.formModel.customerData[t.name].displayValue]}else"carOwnerSelector"===t.name&&t.keyFieldValue&&this.formModel.customerData[t.name].idField&&(this.customerFormData[this.formModel.customerData[t.name].idField]=t.keyFieldValue),t.isValid?(this.formModel.customerData[t.name].value=t.value,this.customerFormData[t.name]=t.value):(this.formModel.customerData[t.name].value="",this.customerFormData[t.name]="driverPhone"!==t.name?"":0);this.customerFormData=Object.assign({},this.customerFormData),this.checkForFormValidation(),this.checkWorkProvider()}checkWorkProvider(){if(this.customerFormData.companyOrgType)if("Insurance Company"===this.customerFormData.companyOrgType){if(this.customerFormData.companyId&&this.customerFormData.claimNumber)return this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"outline"}),void(this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"outline"}))}else if("Retail"!=this.customerFormData.companyOrgType){if(this.customerFormData.companyId)return this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"outline"}),void(this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"outline"}))}else if(this.customerFormData.carOwnerSelector){if("Person"===this.customerFormData.carOwnerSelector)return this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"outline"}),void(this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"outline"}));if(this.customerFormData.companyName&&this.customerFormData.licenseId)return this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"outline"}),void(this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"outline"}))}this.chqUploadDrivingLicense=Object.assign(Object.assign({},this.chqUploadDrivingLicense),{type:"disabled-outline"}),this.chqUploadRegistrationCard=Object.assign(Object.assign({},this.chqUploadRegistrationCard),{type:"disabled-outline"})}checkForFormValidationCustomer(){const t=Object.keys(this.customerFormData);let i=[];"Retail"===this.retail?i="Person"===this.customerFormData.carOwnerSelector?["companyName","claimNumber","licenseId","companyId"]:["claimNumber","companyId"]:"Insurance Company"!=this.customerFormData.companyOrgType&&(i=["claimNumber"]);let r=!0;for(const s in t){const p=t[s];if("isTariffEditable"!==p&&-1===i.indexOf(p)&&"carOwnerSelector"!=p&&"jobNumber"!=p&&"caseTypeID"!=p&&"tariffid"!=p.toLowerCase()&&"customerid"!=p.toLowerCase()&&"contactid"!=p.toLowerCase()&&!this.customerFormData[p]){r=!1;break}}return r}checkForFormValidationBooking(t=!1){var i,r,s,p;this.monitorService.logEvent("checkForFormValidationBooking",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]);const u=["notes","repairtypes"],m=Object.keys(this.personalInfoData);let C=!0;for(const O in m){const v=m[O];if(!("customerdata"==v.toLowerCase()||"vehicledata"==v.toLowerCase()||"assignedto"==v.toLowerCase()||"joballocation"==v.toLowerCase()&&!this.personalInfoData[v]||"communicationchannel"==v.toLowerCase()&&0===(null===(i=this.formModel.communicationChannel.options)||void 0===i?void 0:i.length))){if("joballocation"==v.toLowerCase()&&!(null===(r=this.employeeRepairServiceType)||void 0===r?void 0:r.some(w=>{var D;return(null===(D=w.employees)||void 0===D?void 0:D.length)>0}))){C=!1;break}if(Array.isArray(this.personalInfoData[v])&&0==this.personalInfoData[v].length){C=!1;break}if("repairtypes"==v.toLowerCase()&&"repair"==(null===(p=null===(s=this.formModel.serviceType.selectedOption)||void 0===s?void 0:s.name)||void 0===p?void 0:p.toLowerCase())&&(!this.personalInfoData[v]||0==this.personalInfoData[v].length)){C=!1;break}if(!this.personalInfoData[v]&&!u.includes(v.toLowerCase())){C=!1;break}}}return C}checkForFormValidationVehicle(){this.monitorService.logEvent("checkForFormValidationVehicle",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]);let t=!0;return this.validVehicleFields.some(i=>0==i.valid)&&(t=!1),t}checkForFormValidation(){return this.isFormConfirmed?(this.bookingButtonModel.type="outline",!1):this.checkForFormValidationCustomer()&&this.checkForFormValidationBooking()&&this.checkForFormValidationVehicle()?(this.canNavigate=!0,this.bookingButtonModel.type="primary",!0):(this.bookingButtonModel.type="disabled",!1)}validateVehicle(){const t=Object.keys(this.vehicleFormData);let i=!0;for(const r in t){const s=t[r];if("inspectionid"!=s.toLowerCase()&&"inspectionguid"!=s.toLowerCase()&&"isvinspecifiedmanualz"!=s.toLowerCase()&&!this.vehicleFormData[s]){i=!1;break}}return i}validateBookingTime(){if(J(this.personalInfoData.bookingInDate).diff(new Date)>1||this.repairId&&"0"!=this.repairId)return!0;if(J.utc(new Date).diff(new Date(this.personalInfoData.bookingInDate),"minute")<=30){const i=J(new Date(this.personalInfoData.bookingOutDate)).diff(new Date(new Date(this.personalInfoData.bookingInDate)),"minute");return this.personalInfoData.bookingInDate=J(new Date).add(1,"minute").local().utc().format(),this.personalInfoData.bookingOutDate=J(new Date).add(i,"minute").local().utc().format(),!0}return this.commonService.showToast(0,"bookingin_greater_msg"),!1}submitForm(t,i,r){var s,p,u,m,C,O,v,w;return(0,Ze.mG)(this,void 0,void 0,function*(){if(this.monitorService.logEvent("submitForm",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.isFormConfirmed)return this.formModel.customerData.companyOrgType.observable||(this.formModel.customerData.companyOrgType.selectedOption.name="",this.formModel.customerData.companyOrgType.observable=this.caseService.getProviders(),setTimeout(()=>{var E;null===(E=this.orgType)||void 0===E||E.triggerObservable()})),void this.updateButton();if(this.commonService.showLoading(),!this.validateBookingTime())return;const D={vin:this.vehicleFormData.vin,umc:this.umc,vehicleMake:this.vehicleFormData.make,vehicleModel:this.vehicleFormData.model,modelYearRange:(null===(s=this.vinGTMotive)||void 0===s?void 0:s.modelYearRange)||this.vehicleFormData.year,vehicleID:parseInt(this.vehicleId)||0,licensePlateNumber:this.vehicleFormData.licensePlate,vehicleMileage:Number(this.vehicleFormData.carMilege),registrationDate:this.vehicleFormData.registrationDate?J(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"):null,inspectionID:this.vehicleFormData.inspectionID,inspectionGuid:this.vehicleFormData.inspectionGuid,isVinSpecifiedManualZ:this.vehicleFormData.isVinSpecifiedManualZ},T={companyOrgType:this.customerFormData.companyOrgType,customerTypeID:"Retail"===this.customerFormData.companyOrgType?this.customerFormData.customerTypeID:null,firstName:this.customerFormData.firstName,lastName:this.customerFormData.lastName,countryCode:this.customerFormData.driverCode,mobileNumber:this.customerFormData.driverPhone.toString(),email:this.customerFormData.email,companyId:this.customerFormData.companyId,workProviderId:this.customerFormData.partnershipId,claimNumber:"Insurance Company"===this.customerFormData.companyOrgType?this.customerFormData.claimNumber:"",companyName:this.isRetailAndCompanyProvider?this.customerFormData.companyName:"",companyLicenseNumber:this.isRetailAndCompanyProvider?this.customerFormData.licenseId:"",customerId:(null===(u=null===(p=this.repairResponse)||void 0===p?void 0:p.customer)||void 0===u?void 0:u.customerId)||"",contactId:null===(C=null===(m=this.repairResponse)||void 0===m?void 0:m.customer)||void 0===C?void 0:C.contactId,tariffId:this.customerFormData.tariffId,isTariffEditable:this.customerFormData.isTariffEditable,partnershipId:this.customerFormData.partnershipId};let R=[];if("Repair"===(null===(O=this.formModel.serviceType.selectedOption)||void 0===O?void 0:O.name))if(this.personalInfoData.jobAllocation){R=this.employeeRepairServiceType;const E=null===(w=this.personalInfoData.repairTypes)||void 0===w?void 0:w.filter(F=>!this.employeeRepairServiceType.map(G=>G.repairServiceTypeId).includes(F.id));null==E||E.forEach(F=>{this.employeeRepairServiceType.push({repairServiceTypeId:F.id})})}else null===(v=this.personalInfoData.repairTypes)||void 0===v||v.forEach(E=>{R.push({repairServiceTypeId:E.id,repairServiceTypeMappingId:0,repairServiceTypeEmployeeMappings:[]})});else R=this.personalInfoData.jobAllocation?this.employeeRepairServiceType:null,this.personalInfoData.repairTypes=null;const I={domainId:3100,isTowingNeeded:"Towed In/Non-Drivable"==this.personalInfoData.towedIn,customer:T,vehicle:D,booking:{typeId:this.personalInfoData.serviceTypeId||null,typeName:this.personalInfoData.serviceType||null,bookingIn:this.personalInfoData.bookingInDate,bookingOut:this.personalInfoData.bookingOutDate,slotTypeID:null,notes:this.personalInfoData.notes,communicationTypeId:this.personalInfoData.communicationChannel},repairServiceTypes:R,statusId:this.statusId||"",isJobAssignationRequired:this.personalInfoData.jobAllocation||!1};if(this.caseId&&(I.quoteGuid=this.caseId,this.vehicleId&&(D.vehicleID=parseInt(this.vehicleId))),!this.caseId&&(this.validateVehicle()&&(!this.vehicleId||"0"==this.vehicleId)||this.validateVehicle()&&this.vehicleFormData.vin!==this.originalVin&&this.vehicleId))try{yield this.addVehicle(),I.vehicle.inspectionID=this.vehicleFormData.inspectionID,I.vehicle.inspectionGuid=this.vehicleFormData.inspectionGuid,I.vehicle.vehicleID=this.vehicleId}catch(E){return}this.repairId?this.updateBooking(I,t):this.bookingService.addRepairBookings(I).subscribe({next:E=>(0,Ze.mG)(this,void 0,void 0,function*(){var F,G,re,z,ne,N,X,B,ue;if(E){if(console.log(E),this.repairId=null===(F=E.data)||void 0===F?void 0:F.repairGuid,this.status=null===(G=E.data)||void 0===G?void 0:G.status,this.statusId=null===(re=E.data)||void 0===re?void 0:re.statusId,I.repairDateCreated=null===(z=E.data)||void 0===z?void 0:z.createdDate,this.objectId=null===(ne=E.data)||void 0===ne?void 0:ne.id,this.repairId=null===(N=E.data)||void 0===N?void 0:N.repairGuid,this.commonService.repairGuid.next(null===(X=E.data)||void 0===X?void 0:X.repairGuid),this.vehicleId&&"0"!=this.vehicleId&&!this.caseId){let Q=!1;if(yield this.updateVehicle(I).then(ee=>{ee&&this.showLabourUpdateMessage()&&(Q=!0)}),Q)return}if(this.commonService.hideLoading(),i)r&&r();else if(t&&"string"==typeof t){if((t.includes("/photos")||t.includes("/estimate"))&&(!this.vehicleId||"0"==this.vehicleId))return void this.commonService.openAlertDialog("Notification","msg_add_vehicle").afterClosed().subscribe({next:Q=>{}});-1!=t.indexOf("?mode=edit")?(t=t.replace("?mode=edit",""),this.router.navigate([t.replace("{bookingId}",null===(B=E.data)||void 0===B?void 0:B.repairGuid)],{queryParams:{mode:"edit"}})):this.router.navigate([t.replace("{bookingId}",null===(ue=E.data)||void 0===ue?void 0:ue.repairGuid)])}else this.router.navigate(["/repair/booking-journal"],{queryParams:{bookInDate:this.personalInfoData.bookingInDate}})}}),error:E=>{this.commonService.hideLoading()}})})}expandCollapseAssignedTo(t){t.active=!t.active}unAssignEmployee(t,i){const r=this.translateService.instant("unassign"),s=this.translateService.instant("unassign_employee_msg");this.commonService.openDeleteDialog(r,s).afterClosed().subscribe(u=>{var m,C,O,v;if(u){const w=this.employeeRepairServiceType.filter(D=>D.repairServiceTypeId==i.repairId);if(w.length){const D=t.assigneeId||t.employeeId;w[0].employees=null===(m=w[0].employees)||void 0===m?void 0:m.filter(R=>R!=D);let T=null===(C=i.employeesAssigned)||void 0===C?void 0:C.filter(R=>(R.assigneeId||R.employeeId)==D)[0];T=Object.assign(Object.assign({},T),{isAvailable:!0}),null===(O=i.employees)||void 0===O||O.push(T),i.employeesAssigned=null===(v=i.employeesAssigned)||void 0===v?void 0:v.filter(R=>(R.assigneeId||R.employeeId)!=D)}this.checkForFormValidation()}})}showLabourUpdateMessage(){var t;if(this.monitorService.logEvent("showLabourUpdateMessage",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),null===(t=this.labourData)||void 0===t?void 0:t.isEditable){let i=!0;if(this.labourData.tariffLabourRates.forEach(r=>{r.amount>0&&(i=!1)}),i){const r={objectId:this.repairId,link:"here",labourData:this.labourData,from:jn.j.repair};return this.commonService.hideLoading(),this.commonService.showInfoToast(5e5,this.translateService.instant("labour_value_update"),r),!0}return!1}return!1}updateVehicle(t){var i,r,s,p,u,m,C,O;return(0,Ze.mG)(this,void 0,void 0,function*(){this.monitorService.logEvent("updateVehicle",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),this.commonService.showLoading();const v={vin:this.vehicleFormData.vin,umc:this.umc,vehicleMake:this.vehicleFormData.make,vehicleModel:this.vehicleFormData.model,modelYearRange:(null===(i=this.vinGTMotive)||void 0===i?void 0:i.modelYearRange)||this.vehicleFormData.year,vehicleID:null===(r=t.vehicle)||void 0===r?void 0:r.vehicleID,licensePlateNumber:this.vehicleFormData.licensePlate,vehicleMileage:Number(this.vehicleFormData.carMilege),registrationDate:J(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00")},w={inspectionID:(null===(s=t.vehicle)||void 0===s?void 0:s.inspectionID)||(null===(p=this.inspections)||void 0===p?void 0:p.inspectionId),inspectionGuid:(null===(u=t.vehicle)||void 0===u?void 0:u.inspectionGuid)||(null===(m=this.inspections)||void 0===m?void 0:m.inspectionGuid)};return this.caseId||(this.originalTariffObject.make!=this.vehicleFormData.make||this.customerFormData.partnershipId!=this.originalTariffObject.partnershipId||J(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00")!=this.originalTariffObject.registrationDate||!(null===(O=null===(C=this.labourData)||void 0===C?void 0:C.tariffLabourRates)||void 0===O?void 0:O.length))&&(yield this.getLabourData(this.customerFormData.tariffId,this.customerFormData.isTariffEditable,this.customerFormData.partnershipId,this.vehicleFormData.make,t.repairDateCreated)),(0,dt.z)(this.vehicleService.updateVehicleRepair({vehicle:v,inspection:w,tariff:this.labourData},this.repairId))})}getLabourData(t,i,r,s,p){return(0,Ze.mG)(this,void 0,void 0,function*(){return this.monitorService.logEvent("getLabourData",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),(0,dt.z)(this.labourService.getLabourData(t,s,J(this.vehicleFormData.registrationDate).format("YYYY-MM-DDT00:00:00"),p)).then(u=>{u.data&&(this.labourData={tariffId:u.data.id,tariffDiscountRates:u.data.tariffDiscountRates,tariffLabourRates:u.data.tariffLaborRates,isEditable:i,partnershipId:r})})})}updateBooking(t,i){this.monitorService.logEvent("updateBooking",["PersonalInfoComponent","addenda-repair",{repairId:this.repairId}]),t.repairGuid=this.repairId,this.bookingService.updateRepairBooking(t,this.repairId).subscribe({next:r=>(0,Ze.mG)(this,void 0,void 0,function*(){var s,p,u,m;if(r){if(this.repairId=null===(s=r.data)||void 0===s?void 0:s.repairGuid,t.repairDateCreated=null===(p=r.data)||void 0===p?void 0:p.createdDate,this.vehicleId&&"0"!=this.vehicleId&&!this.caseId){let C=!1;if(yield this.updateVehicle(t).then(O=>{O&&this.showLabourUpdateMessage()&&(C=!0)}),C)return}if(this.commonService.hideLoading(),i&&"string"==typeof i){if((i.includes("/photos")||i.includes("/estimate"))&&(!this.vehicleId||"0"==this.vehicleId))return void this.commonService.openAlertDialog("Notification","msg_add_vehicle").afterClosed().subscribe({next:C=>{}});-1!=i.indexOf("?mode=edit")?(i=i.replace("?mode=edit",""),this.router.navigate([i.replace("{bookingId}",null===(u=r.data)||void 0===u?void 0:u.repairGuid)],{queryParams:{mode:"edit"}})):this.router.navigate([i.replace("{bookingId}",null===(m=r.data)||void 0===m?void 0:m.repairGuid)])}else this.router.navigate(["/repair/booking-journal"],{queryParams:{bookInDate:this.personalInfoData.bookingInDate}})}}),error:r=>{this.commonService.hideLoading()}})}onFormUpdateVehicle(t){if(this.monitorService.logEvent("onFormUpdateVehicle",["PersonalInfoComponent","addenda-quote",{repairId:this.repairId,output:t}]),"select"===t.type)this.formModel.vehicleData[t.name]=Object.assign(Object.assign({},this.formModel.vehicleData[t.name]),{selectedOption:t.value}),this.vehicleFormData[t.name]=t.value[this.formModel.vehicleData[t.name].fieldValue],"make"==t.name?(this.vehicleFormData.model=null,this.vehicleFormData.year=null,this.modelDisabled=!0,this.yearDisabled=!0,this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{},options:[],observable:null}),this.formModel.vehicleData.year.options=[],this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{},options:[],observable:null}),t.value&&(this.vehicleFormData.isVinSpecifiedManualZ=!1,this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{observable:this.vehicleService.getVehicleModel(t.value.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)}),setTimeout(()=>{var i;null===(i=this.model)||void 0===i||i.triggerObservable()}))):"model"==t.name&&(this.yearDisabled=!0,this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{},observable:null,options:[]}),this.vehicleFormData.year=null,t.value&&(this.umc=t.value.umc,this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{observable:this.vehicleService.getVehicleYearByModel(t.value.id,this.estimateId),onObservableLoad:this.enableDropdowns.bind(this)}),setTimeout(()=>{var i;null===(i=this.year)||void 0===i||i.triggerObservable()})));else{t.isValid?(this.formModel.vehicleData[t.name].value=t.value,this.vehicleFormData[t.name]=t.value):(this.formModel.vehicleData[t.name].value="",this.vehicleFormData[t.name]="");const i=this.validVehicleFields.find(r=>r.field==t.name);null!=i?i.valid=t.isValid:this.validVehicleFields.push({valid:t.isValid,field:t.name})}this.vehicleFormData=Object.assign({},this.vehicleFormData),"vin"==t.name&&t.isValid&&this.populateForm(),this.checkForFormValidation()}hideDropdown(t){var i,r,s,p,u,m,C,O,v,w,D,T,R,I,E,F,G,re,z,ne,N,X,B,ue,Q,ee,Me,Le,tt,nt,Ue,Ct,Ot,De,te,qe,ct,Lt,_n,Rn,Wn,$n,Kn,Xn,ei,ti,it,ni,Ln,$i,jo,$r,Kr,Xr,ea,Ki;t===this.formModel.customerData.companyOrgType.name?(null===(i=this.driverCode)||void 0===i||i.closeDropdown(),null===(r=this.companyOrg)||void 0===r||r.closeDropdown(),null===(s=this.model)||void 0===s||s.closeDropdown(),null===(p=this.year)||void 0===p||p.closeDropdown(),null===(u=this.make)||void 0===u||u.closeDropdown(),null===(m=this.repairType)||void 0===m||m.closeDropdown(),null===(C=this.serviceType)||void 0===C||C.closeDropdown()):t===this.formModel.customerData.companyName.name?(null===(O=this.driverCode)||void 0===O||O.closeDropdown(),null===(v=this.orgType)||void 0===v||v.closeDropdown(),null===(w=this.model)||void 0===w||w.closeDropdown(),null===(D=this.year)||void 0===D||D.closeDropdown(),null===(T=this.make)||void 0===T||T.closeDropdown(),null===(R=this.repairType)||void 0===R||R.closeDropdown(),null===(I=this.serviceType)||void 0===I||I.closeDropdown()):t===this.formModel.customerData.driverCode.name?(null===(E=this.orgType)||void 0===E||E.closeDropdown(),null===(F=this.companyOrg)||void 0===F||F.closeDropdown(),null===(G=this.model)||void 0===G||G.closeDropdown(),null===(re=this.year)||void 0===re||re.closeDropdown(),null===(z=this.make)||void 0===z||z.closeDropdown(),null===(ne=this.repairType)||void 0===ne||ne.closeDropdown(),null===(N=this.serviceType)||void 0===N||N.closeDropdown()):t===this.formModel.vehicleData.make.name?(null===(X=this.model)||void 0===X||X.closeDropdown(),null===(B=this.year)||void 0===B||B.closeDropdown(),null===(ue=this.driverCode)||void 0===ue||ue.closeDropdown(),null===(Q=this.orgType)||void 0===Q||Q.closeDropdown(),null===(ee=this.companyOrg)||void 0===ee||ee.closeDropdown(),null===(Me=this.repairType)||void 0===Me||Me.closeDropdown(),null===(Le=this.serviceType)||void 0===Le||Le.closeDropdown()):t===this.formModel.vehicleData.model.name?(null===(tt=this.make)||void 0===tt||tt.closeDropdown(),null===(nt=this.year)||void 0===nt||nt.closeDropdown(),null===(Ue=this.driverCode)||void 0===Ue||Ue.closeDropdown(),null===(Ct=this.orgType)||void 0===Ct||Ct.closeDropdown(),null===(Ot=this.companyOrg)||void 0===Ot||Ot.closeDropdown(),null===(De=this.repairType)||void 0===De||De.closeDropdown(),null===(te=this.serviceType)||void 0===te||te.closeDropdown()):t===this.formModel.vehicleData.year.name?(null===(qe=this.model)||void 0===qe||qe.closeDropdown(),null===(ct=this.make)||void 0===ct||ct.closeDropdown(),null===(Lt=this.driverCode)||void 0===Lt||Lt.closeDropdown(),null===(_n=this.orgType)||void 0===_n||_n.closeDropdown(),null===(Rn=this.companyOrg)||void 0===Rn||Rn.closeDropdown(),null===(Wn=this.repairType)||void 0===Wn||Wn.closeDropdown(),null===($n=this.serviceType)||void 0===$n||$n.closeDropdown()):t===this.formModel.repairTypes.name?(null===(Kn=this.model)||void 0===Kn||Kn.closeDropdown(),null===(Xn=this.make)||void 0===Xn||Xn.closeDropdown(),null===(ei=this.driverCode)||void 0===ei||ei.closeDropdown(),null===(ti=this.orgType)||void 0===ti||ti.closeDropdown(),null===(it=this.companyOrg)||void 0===it||it.closeDropdown(),null===(ni=this.year)||void 0===ni||ni.closeDropdown(),null===(Ln=this.serviceType)||void 0===Ln||Ln.closeDropdown()):t===this.formModel.serviceType.name&&(null===($i=this.model)||void 0===$i||$i.closeDropdown(),null===(jo=this.make)||void 0===jo||jo.closeDropdown(),null===($r=this.driverCode)||void 0===$r||$r.closeDropdown(),null===(Kr=this.orgType)||void 0===Kr||Kr.closeDropdown(),null===(Xr=this.companyOrg)||void 0===Xr||Xr.closeDropdown(),null===(ea=this.year)||void 0===ea||ea.closeDropdown(),null===(Ki=this.repairType)||void 0===Ki||Ki.closeDropdown())}updateCaseData(t){var i;if(t&&this.customerFormData.companyId&&!this.customerFormData.tariffId){const r=t.filter(s=>s.companyId===this.customerFormData.companyId);r.length>0&&(this.customerFormData.tariffId=r[0].tariffId,this.customerFormData.isTariffEditable=r[0].isEditable,this.formModel.customerData.licenseId=Object.assign(Object.assign({},null===(i=this.formModel)||void 0===i?void 0:i.customerData.licenseId),{value:r[0].licenseId.toString()}),this.customerFormData.partnershipId=r[0].partnershipId,this.formModel.customerData.companyName.selectedOption=r[0])}}getProvider(){this.formModel.customerData.companyOrgType.observable||(this.repairId&&"0"!=this.repairId&&(this.formModel.customerData.companyOrgType.selectedOption.name=""),this.formModel.customerData.companyOrgType.observable=this.caseService.getProviders())}drop(t,i){if(t.previousContainer===t.container)Ft(t.container.data,t.previousIndex,t.currentIndex);else{10===t.container.data.length&&this.commonService.showToast(0,"max_employee_assigned");const r=t.previousContainer.data[t.previousIndex];if(!r.isAvailable)return;!function(a,c,t,i){const r=It(t,a.length-1),s=It(i,c.length);a.length&&c.splice(s,0,a.splice(r,1)[0])}(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex);const s=this.employeeRepairServiceType.filter(p=>p.repairServiceTypeId==i||null==p.repairServiceTypeId);s.length?s[0].employees.push(r.employeeId||r.assigneeId):this.employeeRepairServiceType.push({employees:[r.employeeId],repairServiceTypeId:i}),this.checkForFormValidation()}}onDoubleClick(t,i){var r,s,p;if(!t.isAvailable)return;10===i.employeesAssigned&&this.commonService.showToast(0,"max_employee_assigned");const u=t.assigneeId||t.employeeId,m=this.employeeRepairServiceType.find(O=>O.repairServiceTypeId==i.repairId);m&&(m.employees=null===(r=m.employees)||void 0===r?void 0:r.filter(O=>O!=u));const C=null===(s=i.employees)||void 0===s?void 0:s.find(O=>(O.assigneeId||O.employeeId)==u);C&&(i.employeesAssigned.push(C),i.employees=null===(p=i.employees)||void 0===p?void 0:p.filter(O=>(O.assigneeId||O.employeeId)!=u),m?m.employees.push(C.employeeId||C.assigneeId):this.employeeRepairServiceType.push({employees:[C.employeeId],repairServiceTypeId:i.repairId})),this.checkForFormValidation()}populateForm(){var t;this.monitorService.logEvent("populateForm",["PersonalInfoComponent","addenda-quote",{repairId:this.repairId}]);const i=null===(t=this.formModel.vehicleData.vin.value)||void 0===t?void 0:t.toLocaleString();(0,Jl.D)(i).pipe().subscribe({complete:()=>{17==i.length&&!this.isFormConfirmed&&!this.preventVinCall&&(this.commonService.showLoading(),this.vehicleService.getVinDecoder(i).subscribe({error:()=>{this.commonService.hideLoading(),this.vinGTMotive=null,this.resetVehicleDropdown()},next:r=>{var s;if(null==r?void 0:r.success){this.vinGTMotive=r.data,this.umc=null===(s=this.vinGTMotive)||void 0===s?void 0:s.umc,this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{name:r.data.vehicleMake}}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{modelDescription:r.data.vehicleModel}});const u=this.formModel.vehicleData.make.options.filter(m=>m.name===r.data.vehicleMake);u.length>0&&(this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{observable:this.vehicleService.getVehicleModel(u[0].id,this.estimateId)}),setTimeout(()=>{this.model.triggerObservable()})),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{name:r.data.modelYearRange}}),this.vehicleFormData.make=r.data.vehicleMake,this.vehicleFormData.model=r.data.vehicleModel,this.vehicleFormData.year=r.data.modelYearRange,this.inputDisabled=!1,this.infoDisabled=!1,this.makeDisabled=!0,this.enableDropdowns()}else this.vinGTMotive=null,this.vinFromOCR==this.vehicleFormData.vin?this.checkMakeModelExistFromOCR():(this.commonService.showInfoToast(5e3,"show-info | "+(null==r?void 0:r.message)),this.resetVehicleDropdown());this.make&&(this.make.dropdownValidationMessage="",this.make.dropdownContainer.dropdownConfig.isTouched=!1,this.make.dropdownContainer.dropdownConfig.isDirty=!1),this.model&&(this.model.dropdownValidationMessage="",this.model.dropdownContainer.dropdownConfig.isTouched=!1,this.model.dropdownContainer.dropdownConfig.isDirty=!1),this.year&&(this.year.dropdownValidationMessage="",this.year.dropdownContainer.dropdownConfig.isTouched=!1,this.year.dropdownContainer.dropdownConfig.isDirty=!1)},complete:()=>{this.commonService.hideLoading()}})),this.preventVinCall&&17==i.length&&(this.preventVinCall=!1)}})}resetVehicleDropdown(t=!0){t&&(this.inputDisabled=!1,this.infoDisabled=!1,this.makeDisabled=!1),this.vehicleFormData.make="",this.vehicleFormData.model="",this.vehicleFormData.year=null,this.formModel.vehicleData.model.options=[],this.formModel.vehicleData.year.options=[],this.formModel.vehicleData.make=Object.assign(Object.assign({},this.formModel.vehicleData.make),{selectedOption:{}}),this.formModel.vehicleData.model=Object.assign(Object.assign({},this.formModel.vehicleData.model),{selectedOption:{}}),this.formModel.vehicleData.year=Object.assign(Object.assign({},this.formModel.vehicleData.year),{selectedOption:{}})}enableDropdowns(){this.modelDisabled=!1,this.yearDisabled=!1}closeForm(){this.router.navigate(["/repair/booking-journal"])}cancelBooking(){this.repairId?this.commonService.openDeleteDialog().afterClosed().subscribe(t=>{t&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.closeForm()}}))}):this.closeForm()}ngOnDestroy(){this.commonService.actionTriggered.unsubscribe(),this.commonService.accessRight.unsubscribe(),this.commonService.viewActionTriggeredBooking.unsubscribe(),this.commonService.labourData.unsubscribe(),this.subscriptions&&this.subscriptions.forEach(t=>t.unsubscribe()),this.monitorService.logEvent("ngOnDestroy",["PersonalInfoComponent","addenda-repair"])}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Be.F0),e.Y36(He.v),e.Y36(Ge.M),e.Y36(_i.n),e.Y36(nr.p),e.Y36(Ja.f),e.Y36(Be.gz),e.Y36(on.q),e.Y36(A.qu),e.Y36(co.a),e.Y36(Yl.m),e.Y36(Gl.g),e.Y36(Hl.T),e.Y36(we.sK),e.Y36(or.o))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-personal-info"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Ql,5),e.Gf(vi,5),e.Gf(Vl,5),e.Gf(Wl,5),e.Gf(ur,5),e.Gf(Ba,5),e.Gf(Tn,5),e.Gf(po,5),e.Gf($l,5),e.Gf(Kl,5),e.Gf(Xl,5),e.Gf(bi,5),e.Gf($t,5),e.Gf(Ya,5),e.Gf(ec,5),e.Gf(tc,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.companyOrg=r.first),e.iGM(r=e.CRH())&&(i.licenseId=r.first),e.iGM(r=e.CRH())&&(i.driverPhone=r.first),e.iGM(r=e.CRH())&&(i.driverCode=r.first),e.iGM(r=e.CRH())&&(i.orgType=r.first),e.iGM(r=e.CRH())&&(i.make=r.first),e.iGM(r=e.CRH())&&(i.model=r.first),e.iGM(r=e.CRH())&&(i.year=r.first),e.iGM(r=e.CRH())&&(i.mileage=r.first),e.iGM(r=e.CRH())&&(i.license=r.first),e.iGM(r=e.CRH())&&(i.regDate=r.first),e.iGM(r=e.CRH())&&(i.repairType=r.first),e.iGM(r=e.CRH())&&(i.bookingOut=r.first),e.iGM(r=e.CRH())&&(i.serviceType=r.first),e.iGM(r=e.CRH())&&(i.communicationChannelControl=r.first),e.iGM(r=e.CRH())&&(i.chqUpload=r.first)}},decls:4,vars:7,consts:[[1,"main-wrapper"],["class","page-container-personal-info",3,"ngClass",4,"ngIf"],[3,"currentStep","currentPageName","isCurrentAdditionalModeMultiple","ngClass","imageOutput"],["chqUpload",""],[1,"page-container-personal-info",3,"ngClass"],[1,"title",3,"ngClass"],[1,"sub-title",3,"ngClass"],[1,"required"],[1,"info-wrapper"],[1,"info"],[1,"form-container","gap-32"],[1,"control-container","fx-col","gap-15"],[1,"work-provider-container","fx-col","gap-32"],[1,"row"],[1,"col-12"],[1,"col-6",3,"inputModel","clicked","controlOutput"],["orgType",""],["class","col-6",3,"inputModel","controlOutput",4,"ngIf"],["class","row",3,"ngClass",4,"ngIf"],["class","row",4,"ngIf"],[1,"button-container","wrapper",3,"ngClass"],[1,"pdf-button"],[3,"buttonModel"],[1,"driver-container"],[1,"driver-details","col-12","gap-32"],[1,"driver-input-wrapper","row"],[1,"driver-fields-wrapper"],[1,"driver-field",3,"inputModel","controlOutput"],[1,"driver-address-wrapper","row"],["class","driver-field basis-272 email",3,"inputModel","controlOutput",4,"ngIf"],["class","driver-field basis-272 email",4,"ngIf"],[1,"driver-field","basis-272"],[1,"driver-field","driver-code-field","no-padding",3,"inputModel","clicked","controlOutput"],["driverCode",""],["class","driver-field no-padding",3,"inputModel","controlOutput",4,"ngIf"],["class","driver-field-content",4,"ngIf"],[1,"fx-col","gap-32"],[1,"info-title",3,"ngClass"],[1,"vehicle-container","fx-col","gap-32"],[1,"row","vin-wrapper",3,"ngClass"],[1,"col-6",3,"inputModel","controlOutput"],[1,"col-6","button-registration",3,"ngClass"],[1,"vehicle-brand-wrapper","row",3,"ngClass"],["id","input-make",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["make",""],["id","input-model",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["model",""],[1,"vehicle-info1-wrapper","row",3,"ngClass"],["id","input-year",1,"col-6",3,"inputModel","ngClass","clicked","controlOutput"],["year",""],["license",""],[1,"vehicle-info-wrapper","row",3,"ngClass"],[1,"col-6","extra-position",3,"inputModel","controlOutput"],["mileage",""],[1,"col-6","registration-date",3,"inputModel","controlOutput"],["regDate",""],[1,"wrapper","fx-col","gap-32"],[1,"info-title"],[1,"booking-container","fx-col","gap-32"],[1,"col-6",3,"ngClass","inputModel","clicked","controlOutput"],["serviceType",""],["class","col-4 col-text-mode",4,"ngIf"],[1,"col-6","repair-type",3,"inputModel","ngClass","clicked","controlOutput"],["repairType",""],[3,"inputModel","ngClass","controlOutput"],["bookingout",""],[1,"wrapper","assigned-to-container","fx-col",3,"ngClass"],[1,"job-allocation-container"],[1,"job-allocation",3,"inputModel","ngStyle","controlOutput"],[4,"ngIf"],[1,"other-container","wrapper","fx-col","gap-32"],[1,"towing-container"],[1,"towing-layout",3,"ngClass"],[3,"inputModel","controlOutput"],["class","towing-layout",4,"ngIf"],[1,"notes-container"],["class","wrapper fx-col gap-32",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[1,"row",3,"ngClass"],[1,"insurance-input-wrapper","row"],[1,"company-input","col-3",3,"inputModel","controlOutput"],[1,"company-input","col-6",3,"inputModel","clicked","controlOutput"],["companyOrg",""],[1,"col-6",3,"ngClass","inputModel","controlOutput"],["licenseId",""],[1,"driver-field","basis-272","email",3,"inputModel","controlOutput"],[1,"driver-field","basis-272","email"],[1,"driver-field-content"],[1,"label-text"],[1,"driver-content-value"],[1,"driver-field","no-padding",3,"inputModel","controlOutput"],["driverPhone",""],[1,"col-4","col-text-mode"],["class","repair-type-container-wrapper",3,"ngClass",4,"ngFor","ngForOf"],[1,"repair-type-container-wrapper",3,"ngClass"],["class","repair-type-container",3,"click",4,"ngIf"],[1,"col-6"],[1,"text-secondary"],[1,"employee-list-wrapper"],["cdkDropList","","cdkDropListSortingDisabled","",1,"employee-list",3,"cdkDropListConnectedTo","cdkDropListData"],["class","employee","cdkDrag","",3,"cdkDragDisabled","dblclick",4,"ngFor","ngForOf"],[1,"employee-list-wrapper","dropped"],["cdkDropList","",1,"employee-list",3,"cdkDropListData","cdkDropListDropped"],["doneList","cdkDropList"],["class","employee assigned",4,"ngFor","ngForOf"],[1,"repair-type-container",3,"click"],[3,"svgIcon"],["cdkDrag","",1,"employee",3,"cdkDragDisabled","dblclick"],["src","assets/img/tick_icon.png",4,"ngIf"],["src","assets/img/cross_icon.png",4,"ngIf"],["src","assets/img/tick_icon.png"],["src","assets/img/cross_icon.png"],[1,"employee","assigned"],["color","red",3,"svgIcon","click"],[1,"towing-layout"],[1,"communication-container"],[1,"",3,"inputModel","ngStyle","controlOutput"],["communicationChannel",""],["class","footer-button-wrapper",4,"chqPermission"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,bo,112,109,"div",1),e.qZA(),e.TgZ(2,"chq-upload",2,3),e.NdJ("imageOutput",function(s){return i.handleImageOutput(s)}),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",!i.isApiLoading),e.xp6(1),e.Q6J("currentStep",i.currentStep)("currentPageName","personal-info")("isCurrentAdditionalModeMultiple",!1)("ngClass",e.VKq(5,lc,null==i.currentStep?null:i.currentStep.uploadInProgress)))},directives:[_.O5,zl.q,_.mk,nn.D,yt.E,_.PC,_.sg,il,Xe.Hw,ua,mi.A],pipes:[we.X$,_.gd],styles:[".page-container-personal-info[_ngcontent-%COMP%]{box-sizing:border-box;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px}.page-container-personal-info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{line-height:25px;font-weight:700}.page-container-personal-info[_ngcontent-%COMP%]   .title.text-mode[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray)}.page-container-personal-info[_ngcontent-%COMP%]   .sub-title[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-weight:700;margin-top:20px;color:var(--xa-red)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]{margin-top:calc(5px + 1.5vw)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{font-weight:700;font-size:16px;line-height:20px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .info-title.text-mode[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;flex:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;grid-gap:5px;gap:5px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:10px;line-height:14px;align-self:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .title-button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{align-self:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:30px;padding-right:34px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;font-size:12px;grid-gap:10px;gap:10px;color:var(--xa-primary)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{display:flex;align-items:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .search-wrapper[_ngcontent-%COMP%]   .search-div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child   mat-icon[_ngcontent-%COMP%]{width:12px;height:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]{flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .car-owner-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]{flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .work-provider-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .insurance-input-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]{flex:4;display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-input-wrapper[_ngcontent-%COMP%], .page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-address-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{flex:1 1 120px;padding:0 10px;width:120px}@media (max-width: 850px){.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{padding:0 6px}}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.no-padding[_ngcontent-%COMP%]{padding:0}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.driver-code-field[_ngcontent-%COMP%]{min-width:120px;max-width:120px;padding:0 20px 0 0}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .driver-container[_ngcontent-%COMP%]   .driver-details[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.basis-272[_ngcontent-%COMP%]{flex-basis:272px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .extra-position[_ngcontent-%COMP%]{position:relative;top:1px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .button-registration[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;position:relative;top:18px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .registration-date[_ngcontent-%COMP%]     .input-wrapper input{pointer-events:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .vehicle-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .registration-date[_ngcontent-%COMP%]     .input-wrapper input[readonly]{opacity:.6}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   .pdf-button[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]{margin-right:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{opacity:.3}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   chq-button.no-opacity[_ngcontent-%COMP%]{opacity:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   .towing-button-layout[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:5px;gap:5px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .towing-container[_ngcontent-%COMP%]   .towing-layout[_ngcontent-%COMP%]   .towing-button-layout[_ngcontent-%COMP%]   .button-top-text[_ngcontent-%COMP%]{font-size:10px;text-align:center}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:16px;gap:16px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-overflow:ellipsis!important;white-space:nowrap;overflow:hidden!important}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(1){font-size:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .booking-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(2){color:#000}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .job-allocation-container[_ngcontent-%COMP%]{margin-top:32px;margin-bottom:32px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .job-allocation-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .job-allocation[_ngcontent-%COMP%]     .input-wrapper .checkbox-wrapper .checkbox .span-label{font-size:12px;line-height:14px;color:var(--xa-black)}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]{padding:14px 10px;grid-gap:32px;gap:32px;border-width:.4px 0px;border-style:solid;border-color:#000}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper.no-border-top[_ngcontent-%COMP%]{border-top:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper.disable-container[_ngcontent-%COMP%]{pointer-events:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .repair-type-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;font-size:14px;line-height:18px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .repair-type-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:14px;width:14px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row.collapse[_ngcontent-%COMP%]{display:none}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .text-secondary[_ngcontent-%COMP%]{font-size:8px;color:var(--xa-dark-gray);line-height:12px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]{margin-top:10px;border:1px solid gray;padding:22px 12px;height:100px;overflow-y:scroll;background:rgba(236,236,236,.6);border:1px solid rgba(26,34,51,.2);border-radius:8px;cursor:-webkit-grab;cursor:grab}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper.no-outline[_ngcontent-%COMP%]{border:none;background:transparent}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper.dropped[_ngcontent-%COMP%]{cursor:auto}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;grid-gap:3px;gap:3px;padding:0;flex-wrap:wrap;height:inherit}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]{flex-basis:calc(33.33% - 10px);box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:10px 8px;width:auto;height:38px;background:var(--xa-white);border:1px solid rgba(26,34,51,.1);border-radius:14px;grid-gap:10px;gap:10px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee.assigned[_ngcontent-%COMP%]{justify-content:space-between}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee.transparent[_ngcontent-%COMP%]{background:transparent;justify-content:space-between;padding:10px 8px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:14px;width:14px}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;line-height:14px;display:flex;align-items:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;min-width:75px;max-width:150px;display:inline-block}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .assigned-to-container[_ngcontent-%COMP%]   .repair-type-container-wrapper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-6[_ngcontent-%COMP%]   .employee-list-wrapper[_ngcontent-%COMP%]   .employee-list[_ngcontent-%COMP%]   .employee[_ngcontent-%COMP%]:nth-of-type(3n){flex-grow:1}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .communication-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]{display:flex;flex-direction:column}.page-container-personal-info[_ngcontent-%COMP%]   .info-wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .communication-container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-12[_ngcontent-%COMP%]   .communication-text[_ngcontent-%COMP%]{font-size:12px;line-height:14px;padding:5px}  .disable-controls input{opacity:.6}.disable-input[_ngcontent-%COMP%], .partial-disable-info[_ngcontent-%COMP%]{pointer-events:none}.hide[_ngcontent-%COMP%]{display:none!important}.cdk-drag-preview[_ngcontent-%COMP%]{padding:10px 8px;grid-gap:10px!important;gap:10px!important;width:auto;height:38px;font-size:12px;background:var(--xa-white);border:1px solid rgba(26,34,51,.1);border-radius:14px;cursor:-webkit-grab;cursor:grab;display:flex;flex-direction:row;align-items:center}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0;grid-gap:10px!important;gap:10px!important}.cdk-drag-disabled[_ngcontent-%COMP%]{cursor:not-allowed}.main-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-tab-background);margin:calc(5px + 1.5vw)}.page-wrapper[_ngcontent-%COMP%]{background:rgba(255,255,255,.7)}.text-mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .text-mode[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{padding-bottom:5px;border-bottom:1px solid var(--xa-lighter-gray);padding-left:0!important}.text-mode[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{order:2}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;grid-gap:10px;gap:10px;height:34px}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.text-mode[_ngcontent-%COMP%]   .driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]   .driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}.text-mode[_ngcontent-%COMP%]     chq-dropdown, .text-mode[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]{opacity:1!important}.gap-15[_ngcontent-%COMP%]{grid-gap:15px;gap:15px}.gap-32[_ngcontent-%COMP%]{grid-gap:32px;gap:32px}"]}),a})();var cc=Z(4704);let Co=(()=>{class a{constructor(t,i,r){this.commonService=t,this.router=i,this.monitorService=r,this.header={title:"Upload Images",step:0,description:"",stepName:"Back / Bulk Upload",rightActionText:"Delete all and Start Over",rightActionIcon:"delete",isRepairModule:!0,showTitle:!0}}handleUpdateMode(t){"error"===t.mode?this.displayMissingInspectionMessage(t.id):this.header=Object.assign(Object.assign({},this.header),"single"===t.mode?{title:"back_smart_photo"}:{title:"back_bulk_upload"})}displayMissingInspectionMessage(t){this.commonService.openConfirmationOkDialog("Notification","Please add your vehicle in order to add car images.").afterClosed().subscribe({next:i=>{i&&this.router.navigate([`repair/booking/${t}`])},error:()=>{this.commonService.hideLoading()}})}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["Photos component","addenda-repair"])}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(He.v),e.Y36(Be.F0),e.Y36(Ge.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-photos"]],decls:1,vars:1,consts:[[3,"photosHeader","currentUploadMode"]],template:function(t,i){1&t&&(e.TgZ(0,"new-photos",0),e.NdJ("currentUploadMode",function(s){return i.handleUpdateMode(s)}),e.qZA()),2&t&&e.Q6J("photosHeader",i.header)},directives:[cc.X],styles:[""]}),a})();var Oo=Z(64307);let gr=(()=>{class a{constructor(t,i){this.commonService=t,this.monitorService=i,this.header={title:"Upload Document",step:0,description:"",stepName:"",isRepairModule:!0,isHeaderOnly:!0}}ngOnDestroy(){this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["Document Component","addenda-repair"])}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(He.v),e.Y36(Ge.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["repair-new-documents"]],decls:1,vars:1,consts:[[3,"documentHeader"]],template:function(t,i){1&t&&e._UZ(0,"new-documents",0),2&t&&e.Q6J("documentHeader",i.header)},directives:[Oo.O],styles:[""]}),a})();const dc={value:[{Id:656,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Gargash Enterprise",VehicleMake:"BMW",VehicleModel:"3 series",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:657,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Honda",VehicleModel:"Accord",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:658,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:659,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:660,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:661,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:662,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:663,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:664,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:665,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:666,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Gargash Enterprise",VehicleMake:"BMW",VehicleModel:"3 series",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:667,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Honda",VehicleModel:"Accord",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:668,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:669,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:670,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:671,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:672,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Tesla",VehicleModel:"Model X",LicensePlate:"N23145",StatusDescription:"Invoice Ready",Key:null},{Id:673,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Private",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null},{Id:674,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"Nissan",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Hold",Key:null},{Id:675,RepairId:234934328463,TotalEstmate:102045,OriginalEstimate:102045,CustomerName:"Customer Name",Insurer:"Adamjee",VehicleMake:"ADNIC",VehicleModel:"Altima",LicensePlate:"N23145",StatusDescription:"Ready for Invoice",Key:null}]},Xa={value:[{title:"TOTAL JOBS",percentage:0,amount:150},{title:"TOTAL LABOUR (36%)",percentage:0,amount:350526},{title:"PANEL LABOUR(23%)",percentage:0,amount:350526},{title:"PAINT LABOUR (14%)",percentage:0,amount:350526},{title:"PARTS",percentage:0,amount:350526},{title:"MISC",percentage:0,amount:350526},{title:"SUBLET",percentage:0,amount:350526},{title:"TOTAL",percentage:0,amount:350526}]};let Mo=(()=>{class a{constructor(t){this.http=t}getInvoices(t,i=null){return(0,Wt.of)(dc)}invoicePerDetail(t){return this.http.get(`${Fe.N.caseMgmtUrl}/api/invoice/${t}`)}saveInvoicePerDetail(t){return this.http.post(`${Fe.N.caseMgmtUrl}/api/invoice/detail`,t)}invoicePDF(t,i,r){return this.http.post(`${Fe.N.caseMgmtUrl}/api/invoice/${t}/${i}/report`,r)}invoicePerDetailProvider(t,i){return this.http.get(`${Fe.N.caseMgmtUrl}/api/invoice/${t}/detail/${i}`)}assignInvoice(t){return this.http.post(`${Fe.N.caseMgmtUrl}/api/invoice`,t)}getInvoiceSummary(){return(0,Wt.of)(Xa)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(ui.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const pc={columns:[{id:"Id",width:"0px",style:"display: none",header:{text:"Id",tooltip:"",style:"display: none; max-width: 0"},cellStyle:"display: none; max-width: 0",selector:{field:"paymentId"},widget:{type:"text"}},{id:"Payment",sortable:!1,header:{text:"payment",tooltip:""},selector:{field:"paymentId"},widget:{type:"text"}},{id:"Amount",sortable:!1,selector:{field:"amount"},header:{text:"amount",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center;",widget:{type:"currency"}},{id:"PaymentDate",sortable:!1,selector:{field:"paymentDate"},header:{text:"payment_date",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center;",widget:{type:"dateTime",dateFormat:"dd/MM/YYYY hh:mm a"}},{id:"PaymentMethod",sortable:!1,selector:{field:"paymentType"},header:{text:"payment_method",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center; text-transform: capitalize;",widget:{type:"text"}},{id:"Attachment",sortable:!1,selector:{field:"attachment"},header:{text:"attachment",tooltip:"attachment",style:"text-align: center;"},childColumns:[{id:"AttachmentRefference",selector:{field:"attachment"},widget:{type:"icon",config:{svgIcon:"attachment-refference"}}},{id:"Download",disableColumns:!0,selector:{field:"attachment"},widget:{type:"icon",config:{svgIcon:"download-arrow"}}},{id:"Preview",selector:{field:"attachment"},disableColumns:!0,widget:{type:"icon",config:{svgIcon:"eye"}}}],cellStyle:"justify-content: center;"},{id:"DeleteAction",width:"100px",sortable:!1,selector:{field:"Id"},header:{text:"action",tooltip:"",style:"text-align: center;"},cellStyle:"justify-content: center",widget:{type:"icon",config:{svgIcon:"delete",style:"fill: var(--xa-dark-red2) !important; width: 15px; height: 15px;"}}},{id:"paymentGuid",width:"0px",style:"display: none",header:{text:"paymentGuid",tooltip:"",style:"display: none; max-width: 0"},cellStyle:"display: none; max-width: 0",selector:{field:"paymentGuid"},widget:{type:"text"}}]};var Ve=Z(49457),pt=Z(25001);let es=(()=>{class a{constructor(t,i){this.http=t,this.fileService=i}getPayments(t){return this.http.get(`${Fe.N.caseMgmtUrl}/api/payment/${t}`)}getPaymentTypes(){return this.http.get(`${Fe.N.caseMgmtUrl}/api/lookup?type=paymentType`)}deletePayment(t,i){return this.http.delete(`${Fe.N.caseMgmtUrl}/api/payment/${i}/delete/${t}`)}addPayment(t){const i=`${Fe.N.caseMgmtUrl}/api/payment`,r=new FormData;return r.append("InvoiceNumber",t.invoiceNumber),r.append("Amount",t.amount),r.append("PaymentDate",t.paymentDate),r.append("PaymentTypeId",t.paymentTypeId),r.append("Description",t.description),t.files&&t.files.length>0&&t.files.forEach(s=>{r.append("attachment",s)}),this.fileService.uploadFile(i,r,!1)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(ui.eN),e.LFG(pt.I))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();const uc=["paymentTableWrapper"],ts=function(a){return{"fully-paid":a}};let hc=(()=>{class a{constructor(t,i,r,s){this.monitorService=t,this.paymentService=i,this.commonService=r,this.translateService=s,this.handlePaymentDelete=new e.vpe,this.tableConfig=pc,this.tableData=[],this.pageChanged=!1,this.showData=!1,this.currencySymbol="",this.locale="",this.numberFormat="",this.handleCellClick=(p,u,m)=>{var C,O,v,w,D,T,R,I;if("DeleteAction"===u.id)this.deletePayment(null===(O=null===(C=p[7])||void 0===C?void 0:C.result)||void 0===O?void 0:O.value);else if("Download"===u.id){const E=null===(v=p[5])||void 0===v?void 0:v.result.value.split("/"),F=null===(w=E[(null==E?void 0:E.length)-1])||void 0===w?void 0:w.split("?")[0];this.commonService.showLoading(),this.commonService.getFileBlob(null===(T=null===(D=p[5])||void 0===D?void 0:D.result)||void 0===T?void 0:T.value).subscribe({next:G=>{this.commonService.hideLoading();const re=new Blob([G.res],{type:"application/octet-stream"});(0,Ve.saveAs)(re,F)},error:G=>{this.commonService.hideLoading(),this.monitorService.logException(G)}})}else"Preview"===u.id&&window.open(null===(I=null===(R=p[5])||void 0===R?void 0:R.result)||void 0===I?void 0:I.value,"_top")},this.i18n=this.commonService.geti18nInfo(),this.currencySymbol=this.i18n.currencySymbol+" ",this.locale=this.i18n.locale,this.numberFormat=this.i18n.digitsInfo}ngOnInit(){this.monitorService.logEvent("ngOnInit",["PaymentListComponent","addenda-repair"]),this.getPayments(this.invoiceGuid)}get isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}getPayments(t){return(0,Ze.mG)(this,void 0,void 0,function*(){return this.commonService.showLoading(),this.commonService.isViewOnly&&(this.tableConfig.columns=this.tableConfig.columns.filter(i=>"DeleteAction"!==i.id)),this.monitorService.logEvent("getPayments",["PaymentListComponent","addenda-repair"]),(0,dt.z)(this.paymentService.getPayments(t)).then(i=>{i.data&&(this.formatTableData(i.data),this.showData=!0),this.commonService.hideLoading()}).catch(i=>{this.commonService.hideLoading(),this.monitorService.logException(i,je._.Error)})})}formatTableData(t){this.tableData=t}deletePayment(t){return(0,Ze.mG)(this,void 0,void 0,function*(){this.commonService.openDeleteDialog("",this.translateService.instant("payment_delete_confirmation"),this.translateService.instant("delete"),this.translateService.instant("cancel")).afterClosed().subscribe(i=>{i&&(this.commonService.showLoading(),this.monitorService.logEvent("deleteRow",["PaymentListComponent","addenda-repair"],{paymentId:t}),(0,dt.z)(this.paymentService.deletePayment(t,this.invoiceGuid)).then(r=>{var s;this.commonService.hideLoading(),(null==r?void 0:r.message)&&this.commonService.showInfoToast(5e3,r.message);const p=this.tableData.filter(u=>u.paymentGuid===t);this.handlePaymentDelete.emit({Amount:null===(s=p[0])||void 0===s?void 0:s.amount}),this.getPayments(this.invoiceGuid)}).catch(r=>{this.commonService.hideLoading(),this.monitorService.logException(r,je._.Error)}))})})}addPayment(t){const i=[...this.tableData];i.unshift(t),this.formatTableData(i),this.paymentTableWrapper.nativeElement.scrollIntoView({behavior:"smooth"})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ge.M),e.Y36(es),e.Y36(He.v),e.Y36(we.sK))},a.\u0275cmp=e.Xpm({type:a,selectors:[["payment-list"]],viewQuery:function(t,i){if(1&t&&e.Gf(uc,5),2&t){let r;e.iGM(r=e.CRH())&&(i.paymentTableWrapper=r.first)}},inputs:{invoiceGuid:"invoiceGuid",dueAmount:"dueAmount"},outputs:{handlePaymentDelete:"handlePaymentDelete"},decls:6,vars:8,consts:[[1,"table-container","payment-list",3,"ngClass"],[1,"table-wrapper"],["paymentTableWrapper",""],[3,"config","tableData","cellClicked","pageChanged","i18n"],["paymentTable",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1,2),e._UZ(4,"chq-mat-table",3,4),e.qZA(),e.BQk(),e.qZA()),2&t&&(e.Q6J("ngClass",e.VKq(6,ts,i.dueAmount<=0)),e.xp6(4),e.Q6J("config",i.tableConfig)("tableData",i.tableData)("cellClicked",i.handleCellClick)("pageChanged",i.pageChanged)("i18n",i.i18n))},directives:[_.mk,Aa.B],styles:[".payment-list[_ngcontent-%COMP%]{margin-top:30px}.payment-list.table-container[_ngcontent-%COMP%]:not(.fully-paid){height:calc(80vh - 614px);overflow:scroll;min-height:200px}.payment-list.table-container.fully-paid[_ngcontent-%COMP%]{height:calc(80vh - 237px);overflow:scroll}.payment-list[_ngcontent-%COMP%]     thead{position:sticky;top:0;z-index:1}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div{display:flex}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div mat-icon{margin:0 10px;text-align:center;align-items:center;display:flex;width:auto}@media (max-width: 1200px){.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div mat-icon{margin:0 6px}}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div   [data-mat-icon-name=download-arrow] svg{height:18px}.payment-list[_ngcontent-%COMP%]     .mat-column-Attachment>div   [data-mat-icon-name=eye] path{fill:var(--xa-black)}"]}),a})();function Yn(a,c){return t=>{const i={invalidPaymentAmount:""};return t.value<=0?(i.min=a.instant("invalid_amount"),i):t.value>c?(i.invalidPaymentAmount=a.instant("payment_amount_max_length_error").replace("{{maxAmount}}",c.toFixed(2)),i):null}}const fr=["uploader"];function Oi(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",19),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"div"),e.TgZ(4,"span"),e._UZ(5,"mat-icon",20),e.qZA(),e.TgZ(6,"span"),e.TgZ(7,"mat-icon",21),e.NdJ("click",function(){const s=e.CHM(t).index;return e.oxw(2).handleFileRemove(s)}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=c.$implicit;e.xp6(2),e.Oqu(null==t?null:t.name),e.xp6(3),e.Q6J("svgIcon","attachment-refference"),e.xp6(2),e.Q6J("svgIcon","cross")}}function Ui(a,c){1&a&&(e.TgZ(0,"div",22),e.TgZ(1,"span"),e._uU(2,"-"),e.qZA(),e.qZA())}function Ji(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",23),e.NdJ("click",function(r){return e.CHM(t),e.oxw(2).handleAddFileClick(r)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.attachmentButton)}}function xo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"form",2),e.TgZ(1,"div",3),e.TgZ(2,"div",4),e.TgZ(3,"chq-input",5),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.TgZ(4,"div",4),e.TgZ(5,"chq-input",5),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",3),e.TgZ(7,"div",4),e.TgZ(8,"chq-input",5),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.TgZ(9,"div",6),e.TgZ(10,"chq-input",5),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",7),e.TgZ(12,"div",4),e.TgZ(13,"div",8),e.TgZ(14,"label",9),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.YNc(17,Oi,8,3,"div",10),e.YNc(18,Ui,3,0,"div",11),e.qZA(),e.qZA(),e.TgZ(19,"div",4),e.YNc(20,Ji,1,1,"chq-button",12),e.TgZ(21,"input",13,14),e.NdJ("change",function(r){return e.CHM(t),e.oxw().handleUpload(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(23,"div",15),e.TgZ(24,"div",16),e.TgZ(25,"chq-input",5),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdate(r)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(26,"div",3),e.TgZ(27,"div",16),e.TgZ(28,"div",17),e.TgZ(29,"chq-button",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().handleFormSubmit()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.xp6(3),e.Q6J("inputModel",t.formModel.amount),e.xp6(2),e.Q6J("inputModel",t.formModel.paymentMethod),e.xp6(3),e.Q6J("inputModel",t.formModel.paymentDate),e.xp6(2),e.Q6J("inputModel",t.formModel.paymentStatus),e.xp6(5),e.Oqu(e.lcZ(16,10,"attachments")),e.xp6(2),e.Q6J("ngForOf",t.file),e.xp6(1),e.Q6J("ngIf",!t.file),e.xp6(2),e.Q6J("ngIf",t.file.length<1),e.xp6(5),e.Q6J("inputModel",t.formModel.description),e.xp6(4),e.Q6J("buttonModel",t.savePaymentButtonModel)}}function Mi(a,c){if(1&a&&(e.TgZ(0,"div",24),e.TgZ(1,"div",8),e.TgZ(2,"label",25),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div"),e.TgZ(6,"span"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,2,"payment_status")),e.xp6(4),e.Oqu(e.lcZ(8,4,t.repairPaymentStatus))}}let gc=(()=>{class a{constructor(t,i,r,s){this.monitorService=t,this.paymentService=i,this.commonService=r,this.translateService=s,this.handleAddPayment=new e.vpe,this.savePaymentButtonModel={label:"save_payment",type:"outline",icon:"save"},this.attachmentButton={label:"add_attachment",type:"outline",icon:"attachment"},this.formData={paymentTypeId:0,paymentDate:"",amount:0,description:"",paymentStatus:""},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.file=[]}set content(t){t&&(this.uploader=t)}ngOnInit(){var t,i;this.monitorService.logEvent("ngOnInit",["PaymentListComponent","addenda-repair"]),this.formModel=(a=>({amount:{placeHolder:"payment_amount",label:"payment_amount",name:"amount",value:0,type:"number",required:!0,validation:{name:"paymentAmount",validationFunction:()=>A.kI.compose([A.kI.min(1)]),validationMessage:c=>c.required?a.instant("payment_amount_required"):c.pattern?a.instant("invalid_number"):c.min?a.instant("greater_than_0"):c.invalidPaymentAmount?c.invalidPaymentAmount:""}},paymentDate:{placeHolder:"payment_date",label:"payment_date",name:"paymentDate",value:new Date,type:"datetime",minDate:new Date,maxDate:new Date},paymentMethod:{placeHolder:"select_payment_method",name:"paymentMethod",label:"payment_method",options:[{}],displayValue:"name",fieldValue:"id",type:"select",value:"",required:!0,validation:{name:"paymentMethod",validationFunction:()=>A.kI.compose([A.kI.required]),validationMessage:c=>c.required?a.instant("select_payment_method"):""}},paymentStatus:{placeHolder:"payment_status",label:"payment_status",name:"paymentStatus",value:"",type:"text",disabled:!0},description:{placeHolder:"add_description",label:"add_description",name:"description",value:"",type:"textarea",maxLength:100,validation:{name:"addDescription",validationFunction:()=>A.kI.compose([A.kI.maxLength(100)]),validationMessage:c=>c.maxlength?a.instant("payment_description_max_length_error"):""}}}))(this.translateService),this.formModel.paymentMethod.observable||(this.formModel.paymentMethod.observable=this.paymentService.getPaymentTypes(),this.formModel.paymentMethod.onObservableLoad=this.onObservableLoadPaymentMethods.bind(this)),this.formModel.paymentStatus=Object.assign(Object.assign({},this.formModel.paymentStatus),{value:this.paymentStatusMapper[null===(t=this.repairPaymentStatus)||void 0===t?void 0:t.toLowerCase()]}),this.formData.paymentStatus=this.repairPaymentStatus,this.formModel.amount=Object.assign(Object.assign({},this.formModel.amount),{value:null===(i=this.dueAmount)||void 0===i?void 0:i.toFixed(2)}),this.formData.amount=this.dueAmount,this.formData.paymentDate=new Date,this.formModel.paymentDate=Object.assign(Object.assign({},this.formModel.paymentDate),{minDate:J(this.invoiceDate).toDate()})}ngAfterViewInit(){this.dueAmount&&this.formModel.amount.formControl.setValidators(A.kI.compose([A.kI.required,A.kI.pattern(/^\d*\.?\d+$/),Yn(this.translateService,this.dueAmount)]))}ngOnChanges(t){var i,r,s,p,u,m;t.dueAmount&&(null===(r=null===(i=this.formModel)||void 0===i?void 0:i.amount)||void 0===r?void 0:r.formControl)&&(this.formModel.amount.formControl.setValidators(A.kI.compose([A.kI.required,Yn(this.translateService,null===(s=t.dueAmount)||void 0===s?void 0:s.currentValue)])),this.formModel.amount=Object.assign(Object.assign({},this.formModel.amount),{value:null===(p=this.dueAmount)||void 0===p?void 0:p.toFixed(2)}),this.formData.amount=this.dueAmount),t.repairPaymentStatus&&this.formModel&&(this.formModel.paymentStatus=Object.assign(Object.assign({},null===(u=this.formModel)||void 0===u?void 0:u.paymentStatus),{value:this.paymentStatusMapper[null===(m=t.repairPaymentStatus)||void 0===m?void 0:m.currentValue]}))}updateValidation(t,i){var r;this.formModel.amount.formControl.setValidators(A.kI.compose([A.kI.required,Yn(this.translateService,t)])),this.formModel.amount=Object.assign(Object.assign({},this.formModel.amount),{value:null==t?void 0:t.toFixed(2)}),this.formData.amount=t,this.formModel.paymentStatus=Object.assign(Object.assign({},null===(r=this.formModel)||void 0===r?void 0:r.paymentStatus),{value:this.paymentStatusMapper[null==i?void 0:i.toLowerCase()]})}onFormUpdate(t){"select"===t.type?(this.formModel[t.name]=Object.assign(Object.assign({},this.formModel[t.name]),{selectedOption:t.value}),"paymentMethod"===t.name?this.formData.paymentTypeId=t.value.id:this.formData[t.name]=t.value):(this.formModel[t.name].value=t.value,this.formData[t.name]=t.value),this.checkForFormValidation()}onObservableLoadPaymentMethods(t){this.formModel.paymentMethod=Object.assign(Object.assign({},this.formModel.paymentMethod),{options:t})}checkForFormValidation(){this.savePaymentButtonModel.type=this.isPaymentFormValid()?"primary":"outline"}isPaymentFormValid(){let t=!0;return this.formData.amount&&this.formData.paymentDate&&this.formData.paymentTypeId&&this.formModel.amount.formControl.valid&&this.formModel.paymentDate.formControl.valid||(t=!1),t}checkFileSize(t){return this.monitorService.logEvent("checkFileSize",["PaymentAddComponent","addenda-repair",{fileSize:t.size}]),!(t.size>this.commonService.maxileSize)}isValidImageFile(t){const i=new RegExp("^.*\\.[a-zA-Z]+$","gm");if(this.monitorService.logEvent("isValidImageFile",["PaymentAddComponent","addenda-repair",{fileName:t}]),i.test(t)){const r=t.split(".").pop();return this.commonService.allowFilesExtension.includes(null==r?void 0:r.toLowerCase())}return!1}handleUpload(t){const i=t.target.files||t.srcElement.files;if(this.monitorService.logEvent("handleUpload",["PaymentAddComponent","addenda-quote",{event:t}]),null!==i&&""!==i&&i.length>0){if(!this.checkFileSize(i[0])){const s=this.translateService.instant("file_size_5mb_error_message");return this.commonService.showToast(0,s),void(this.uploader.nativeElement.value=null)}if(!this.isValidImageFile(i[0].name)){const s=this.translateService.instant("upload_type_not_supported");return this.commonService.showToast(0,s),void(this.uploader.nativeElement.value=null)}const r=new FileReader;r.readAsDataURL(i[0]),r.onload=s=>{this.file.push(i[0]),this.checkForFormValidation()}}else this.checkForFormValidation()}handleFileRemove(t){this.commonService.openDeleteDialog("",this.translateService.instant("attachment_delete_confirmation"),this.translateService.instant("delete"),this.translateService.instant("cancel")).afterClosed().subscribe(i=>{i&&(this.monitorService.logEvent("handleFileRemove",["PaymentAddComponent","addenda-repair"]),this.file.splice(t,1))})}handleAddFileClick(t){this.uploader.nativeElement.click()}handleFormSubmit(){if(!this.isPaymentFormValid())return;this.monitorService.logEvent("submitForm",["PaymentAddComponent","addenda-repair"]);const t={amount:this.formData.amount/1,paymentTypeId:this.formData.paymentTypeId,paymentDate:J.utc(this.formData.paymentDate).format("YYYY-MM-DDTHH:mm:ss.000")+"Z",description:this.formData.description,invoiceNumber:this.invoiceNumber};this.file&&this.file.length>0&&(t.files=this.file),this.commonService.showLoading(),this.paymentService.addPayment(t).subscribe({next:i=>{console.log("result",i),i&&(this.commonService.hideLoading(),this.handleAddPayment.emit({Amount:this.formData.amount}),this.resetForm())},error:i=>{this.commonService.hideLoading(),this.monitorService.logException(i,je._.Error)}})}resetForm(){this.formModel.amount=Object.assign(Object.assign({},this.formModel.amount),{value:null}),this.formData.amount=null,this.formModel.amount.formControl.reset(),this.formModel.paymentMethod=Object.assign(Object.assign({},this.formModel.paymentMethod),{selectedOption:{}}),this.formData.paymentTypeId=null,this.formModel.paymentDate=Object.assign(Object.assign({},this.formModel.paymentDate),{value:new Date}),this.formData.paymentDate=new Date,this.formModel.description=Object.assign(Object.assign({},this.formModel.description),{value:null}),this.formData.description=null,this.formModel.description.formControl.reset(),this.file=[]}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ge.M),e.Y36(es),e.Y36(He.v),e.Y36(we.sK))},a.\u0275cmp=e.Xpm({type:a,selectors:[["payment-add"]],viewQuery:function(t,i){if(1&t&&e.Gf(fr,5),2&t){let r;e.iGM(r=e.CRH())&&(i.content=r.first)}},inputs:{repairId:"repairId",repairPaymentStatus:"repairPaymentStatus",invoiceNumber:"invoiceNumber",invoiceDate:"invoiceDate",dueAmount:"dueAmount"},outputs:{handleAddPayment:"handleAddPayment"},features:[e.TTD],decls:3,vars:2,consts:[["class","fx-1 payment-add",4,"ngIf","ngIfElse"],["fullypaid",""],[1,"fx-1","payment-add"],[1,"row"],[1,"col-6"],[3,"inputModel","controlOutput"],[1,"col-6","payment-status"],[1,"row","mt-30","align-items-end"],[1,"input-wrapper"],[1,"input-label"],["class","file-proof",4,"ngFor","ngForOf"],["class","",4,"ngIf"],["class","add-file",3,"buttonModel","click",4,"ngIf"],["hidden","","type","file","accept","image/png, image/jpg, image/jpeg, application/pdf",3,"change"],["uploader",""],[1,"row","mt-30"],[1,"col-12"],[1,"footer-button"],[1,"save-payment",3,"buttonModel","click"],[1,"file-proof"],[1,"mr-20",3,"svgIcon"],[3,"svgIcon","click"],[1,""],[1,"add-file",3,"buttonModel","click"],[1,"payment-add"],[1,"input-label","uppercase"]],template:function(t,i){if(1&t&&(e.YNc(0,xo,30,12,"form",0),e.YNc(1,Mi,9,6,"ng-template",null,1,e.W1O)),2&t){const r=e.MAs(2);e.Q6J("ngIf",i.dueAmount>0)("ngIfElse",r)}},directives:[_.O5,A._Y,A.JL,A.F,nn.D,_.sg,yt.E,Xe.Hw],pipes:[we.X$],styles:['.payment-add[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-bottom:15px}.payment-add[_ngcontent-%COMP%]   .footer-button[_ngcontent-%COMP%]{display:flex;margin-top:30px}.payment-add[_ngcontent-%COMP%]   .mt-30[_ngcontent-%COMP%]{margin-top:30px}.payment-add[_ngcontent-%COMP%]   .align-items-end[_ngcontent-%COMP%]{align-items:end}.payment-add[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .input-label[_ngcontent-%COMP%]{display:block;font-size:10px;padding-bottom:4px;text-transform:uppercase;color:var(--xa-dark-gray)}.payment-add[_ngcontent-%COMP%]   .add-file[_ngcontent-%COMP%]     button{width:auto;padding:6px 12px!important;height:auto}.payment-add[_ngcontent-%COMP%]   .add-file[_ngcontent-%COMP%]     .btn-disabled-outline{border:1px solid var(--xa-light-gray)!important}.payment-add[_ngcontent-%COMP%]   .mr-20[_ngcontent-%COMP%]{margin-right:20px}.payment-add[_ngcontent-%COMP%]   .file-proof[_ngcontent-%COMP%]{font-size:14px;padding:5px 0;border-bottom:1px solid var(--xa-light-gray);border-top:1px solid var(--xa-light-gray);display:flex;align-items:center;justify-content:space-between}.payment-add[_ngcontent-%COMP%]   .file-proof[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-red)!important}.payment-add[_ngcontent-%COMP%]     textarea{font-family:"Inter",sans-serif;height:65px}.payment-add[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]     input{background:transparent;padding:0;opacity:1}.payment-add[_ngcontent-%COMP%]     dx-date-box.dx-invalid, .payment-add[_ngcontent-%COMP%]     dx-date-box.ng-invalid{border:none!important}']}),a})();const mc=["paymentList"],fc=["paymentadd"];function _c(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"payment-add",8,9),e.NdJ("handleAddPayment",function(r){return e.CHM(t),e.oxw().handleAddPayment(r)}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("repairId",t.data.repairId)("repairPaymentStatus",t.data.paymentStatus)("dueAmount",t.data.dueAmount)("invoiceDate",t.data.invoiceDate)("invoiceNumber",t.data.invoiceNumber)}}let vc=(()=>{class a{constructor(t,i,r,s,p){this.data=t,this.dialogRef=i,this.commonService=r,this.invoiceService=s,this.monitorService=p,this.closeButtonModel={label:"close",type:"primary",icon:""}}ngOnInit(){this.data=Object.assign(Object.assign({},this.data),this.data.dueAmount===this.data.invoiceAmount?{paymentStatus:"unpaid"}:0===this.data.dueAmount?{paymentStatus:"paid"}:{paymentStatus:"partialpaid"}),this.monitorService.logEvent("ngOnInit",["PaymentsComponent","addenda-repair"])}getInvoiceDetail(){this.invoiceService.invoicePerDetailProvider(this.data.repairId,this.data.isWorkProvider?1:2).subscribe({next:t=>{const i=null==t?void 0:t.data;this.data=Object.assign(Object.assign({},this.data),i),setTimeout(()=>{this.paymentadd.updateValidation(this.data.dueAmount,this.data.paymentStatus)})}})}cancelDialog(t){this.dialogRef.close(this.data.dueAmount)}handleAddPayment(t){this.paymentList.getPayments(this.data.invoiceGuid),this.data.dueAmount=(1e5*this.data.dueAmount-1e5*t.Amount)/1e5,this.data=Object.assign(Object.assign({},this.data),this.data.dueAmount===this.data.invoiceAmount?{paymentStatus:"unpaid"}:0===this.data.dueAmount?{paymentStatus:"paid"}:{paymentStatus:"partialpaid"}),this.getInvoiceDetail()}handlePaymentDelete(t){(null==t?void 0:t.Amount)&&(this.data.dueAmount=(1e5*this.data.dueAmount+1e5*parseFloat(t.Amount))/1e5),this.data=Object.assign(Object.assign({},this.data),this.data.dueAmount===this.data.invoiceAmount?{paymentStatus:"unpaid"}:0===this.data.dueAmount?{paymentStatus:"paid"}:{paymentStatus:"partialpaid"}),this.getInvoiceDetail()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ye.WI),e.Y36(Ye.so),e.Y36(He.v),e.Y36(Mo),e.Y36(Ge.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-payments"]],viewQuery:function(t,i){if(1&t&&(e.Gf(mc,7),e.Gf(fc,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.paymentList=r.first),e.iGM(r=e.CRH())&&(i.paymentadd=r.first)}},decls:11,vars:7,consts:[[1,"payment-container","fx-col"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content","fx-col","fx-1"],[3,"repairId","repairPaymentStatus","dueAmount","invoiceDate","invoiceNumber","handleAddPayment",4,"ngIf"],[3,"invoiceGuid","dueAmount","handlePaymentDelete"],["paymentList",""],[3,"repairId","repairPaymentStatus","dueAmount","invoiceDate","invoiceNumber","handleAddPayment"],["paymentadd",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2),e.TgZ(6,"mat-icon",3),e.NdJ("click",function(){return i.cancelDialog(!1)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",4),e.YNc(8,_c,2,5,"payment-add",5),e.TgZ(9,"payment-list",6,7),e.NdJ("handlePaymentDelete",function(s){return i.handlePaymentDelete(s)}),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.hij("",e.lcZ(4,5,"payment")," "),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(2),e.Q6J("ngIf",!i.commonService.isViewOnly),e.xp6(1),e.Q6J("invoiceGuid",i.data.invoiceGuid)("dueAmount",i.data.dueAmount))},directives:[Xe.Hw,_.O5,hc,gc],pipes:[we.X$],styles:['.payment-container[_ngcontent-%COMP%]{overflow:auto;padding:20px}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:flex-end;display:flex;cursor:pointer}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:36px!important;width:36px!important;background:var(--xa-black);border-radius:50%;text-align:center}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.payment-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg   path{fill:var(--xa-white)}.payment-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:15px}.payment-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]{margin-bottom:15px}.payment-container[_ngcontent-%COMP%]   .popup-footer-buttons[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:10px}.payment-container[_ngcontent-%COMP%]     button{font-family:"Inter",sans-serif}']}),a})();function Po(a,c){if(1&a&&(e.TgZ(0,"span",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.InputModelDateTime.errorMessage))}}let Bi=(()=>{class a{constructor(t,i,r,s){this.data=t,this.dialogRef=i,this.monitorService=r,this.commonService=s,this.InputModelDateTime={placeHolder:"pickup_date",label:"pick_up_date_time",name:"",type:"datetime",maxDate:J().add(6,"month").toDate(),minDate:J().subtract(1,"minute").toDate(),value:null,error:!1,errorMessage:""},this.confirmButton={label:"save",type:"disabled",onclick:this.continue.bind(this)},this.PickUpDate=null}ngOnInit(){this.monitorService.logEvent("ngOnInit",["SchedulePickupDatePopupComponent","addenda-repair"]),null!==this.data.pickupDate&&(this.PickUpDate=this.data.pickupDate,-1===this.data.pickupDate.indexOf("Z")&&(this.PickUpDate=this.PickUpDate+"Z"),"schedule"===this.data.callSource?new Date(this.PickUpDate)>new Date&&(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"})):new Date(this.PickUpDate)<new Date&&(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"}))),"pickedUp"===this.data.callSource&&(this.InputModelDateTime.maxDate=J().add(1,"minute").toDate(),this.InputModelDateTime.minDate=J().subtract(6,"month").toDate())}close(){this.dialogRef.close()}continue(){this.monitorService.logEvent("continue",["SchedulePickupDatePopupComponent","addenda-repair"]),this.dialogRef.close({PickUpDate:this.PickUpDate})}updateInput({value:t}){if(this.InputModelDateTime.error=!1,"pickedUp"===this.data.callSource){if(new Date(t)>new Date)return J(new Date(t)).format("YYYY-MM-DD hh:mm")==J().format("YYYY-MM-DD hh:mm")?(this.InputModelDateTime.error=!1,this.PickUpDate=new Date(t.toString()),void(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"}))):(this.InputModelDateTime.error=!0,this.InputModelDateTime.errorMessage="pick_up_date_cannot_set_as_future_date",void(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"disabled"})))}else if(new Date(t)<new Date)return J(new Date(t)).format("YYYY-MM-DD hh:mm")==J().format("YYYY-MM-DD hh:mm")?(this.InputModelDateTime.error=!1,this.PickUpDate=new Date(t.toString()),void(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"}))):(this.InputModelDateTime.error=!0,this.InputModelDateTime.errorMessage="Pick_up_date_cannot_set_as_past_date",void(this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"disabled"})));this.PickUpDate=new Date(t.toString()),this.confirmButton=Object.assign(Object.assign({},this.confirmButton),{type:"primary"})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ye.WI),e.Y36(Ye.so),e.Y36(Ge.M),e.Y36(He.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-schedule-pickup-date-popup"]],decls:15,vars:16,consts:[[1,"message-container"],[1,"header"],[1,"header-text"],[1,"close-icon"],[3,"svgIcon","click"],[1,"content"],[1,"input-label","uppercase","text-muted"],["type","datetime",3,"value","acceptCustomValue","invalidDateMessage","max","min","validationError","validationMessageMode","onValueChanged"],["class","pickupDate-error input-label text-muted",4,"ngIf"],[1,"footer","form-data-footer"],[1,"right",3,"buttonModel"],[1,"pickupDate-error","input-label","text-muted"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"span",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",3),e.TgZ(6,"mat-icon",4),e.NdJ("click",function(){return i.close()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"label",6),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"dx-date-box",7),e.NdJ("onValueChanged",function(s){return i.updateInput(s)}),e.qZA(),e.YNc(12,Po,3,3,"span",8),e.qZA(),e.TgZ(13,"div",9),e._UZ(14,"chq-button",10),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,12,"pickedUp"===i.data.callSource?"picked_up_date_and_time":"schedule_pick_up")),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(3),e.Oqu(e.lcZ(10,14,i.InputModelDateTime.label)),e.xp6(2),e.Q6J("value",i.PickUpDate)("acceptCustomValue",!1)("invalidDateMessage","")("max",i.InputModelDateTime.maxDate)("min",i.InputModelDateTime.minDate)("validationError",!1)("validationMessageMode","none"),e.xp6(1),e.Q6J("ngIf",i.InputModelDateTime.error),e.xp6(2),e.Q6J("buttonModel",i.confirmButton))},directives:[Xe.Hw,ma.M,_.O5,yt.E],pipes:[we.X$],styles:[".message-container[_ngcontent-%COMP%]{padding:30px;width:483px;height:200px;background-color:var(--xa-popup-light-gray);display:flex;flex-direction:column}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{font-size:20px;font-weight:700;line-height:25px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:36px;height:60px}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label.input-label[_ngcontent-%COMP%]{font-size:12px;font-weight:400;color:var(--xa-dark-gray)}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .pickupDate-error[_ngcontent-%COMP%]{font-size:12px;font-weight:400;color:var(--xa-red);padding-top:10px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:36px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{margin-right:4px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:4px}"]}),a})();var ns=Z(39075);const g=function(a){return{"cc-email":a}};let xi=(()=>{class a{constructor(t,i,r,s,p,u,m){this.dialogRef=t,this.monitorService=i,this.messagingService=r,this.commonService=s,this.invoiceService=p,this.sanitizer=u,this.data=m,this.showCC=!1,this.fileName="Invoice",this.templateKey="",this.emailRequest={subject:"",email:[],message:""},this.emailForm={email:{label:"email_address",name:"email",placeHolder:"email_address",value:"",type:"text",validation:{name:"email",validationFunction:()=>A.kI.compose([A.kI.required,(0,cn.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:C=>C.required?"email_required":C.invalidEmailNumber?"email_invalid_number":C.invalidEmail?"email_valid":""}},cc:{label:"CC",name:"cc",placeHolder:"CC",value:"",type:"text",validation:{name:"email",validationFunction:()=>A.kI.compose([A.kI.required,(0,cn.zi)("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$")]),validationMessage:C=>C.required?"email_required":C.invalidEmailNumber?"email_invalid_number":C.invalidEmail||C.pattern||C.email?"email_valid":""}}}}downloadPDF(t){const i=this.data.invoiceId;let r;r=this.data.dueDate?{parameters:[{name:"dueDate",value:J(this.data.dueDate).format("YYYY-MM-DD")}]}:{parameters:[]},this.invoiceService.invoicePDF(t,i,r).subscribe({next:s=>{var p;if(s){this.blobUrl=null===(p=null==s?void 0:s.data)||void 0===p?void 0:p.url;const u=this.blobUrl.substring(this.blobUrl.lastIndexOf("/")+1,this.blobUrl.length),m=null==u?void 0:u.split("?")[0];this.fileName=m}this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}onFormUpdate(t){var i;return t.isValid?(this.emailRequest[t.name]="email"===t.name?(null===(i=t.value)||void 0===i?void 0:i.split(","))||[]:t.value,void(this.sendButton=Object.assign(Object.assign({},this.sendButton),this.emailRequest.email&&this.emailRequest.email.length>0?{type:"primary"}:{type:"disabled"}))):(this.sendButton=Object.assign(Object.assign({},this.sendButton),{type:"disabled"}),void(this.emailRequest[t.name]=!1))}cancel(){this.dialogRef.close()}send(){const t={toEmails:this.emailRequest.email,communicationTypeIds:[2],templateKey:this.templateKey,invoiceType:this.data.isWorkProvider?1:2,subject:btoa(this.templateSubject.changingThisBreaksApplicationSecurity),messageContent:btoa(this.templateBody.changingThisBreaksApplicationSecurity),attachments:[{name:this.fileName,blobUrl:this.blobUrl}]};this.commonService.showLoading(),this.messagingService.setMessage(t,this.data.repairId).subscribe({next:i=>{this.commonService.showInfoToast(1e3,"email_sent"),this.commonService.hideLoading(),this.dialogRef.close()},error:()=>{this.commonService.hideLoading()}})}tagsReplacers(t){var i,r;return t?this.sanitizer.bypassSecurityTrustHtml(t.replace(/{{firstName}}/i,(this.data.isWorkProvider?this.data.workProviderValue:this.data.customerValue)||"").replace(/{{lastName}}/i,"").replace(/{{make}}/i,this.repairDetails.vehicle.vehicleMake).replace(/{{model}}/i,this.repairDetails.vehicle.vehicleModel).replace("{{licensenumber}}",this.repairDetails.vehicle.licensePlateNumber).replace("{{pickupdate}}","").replace("{RepairId}",this.repairDetails.repairNumber).replace("{{License Plate}}",this.repairDetails.vehicle.licensePlateNumber).replace("{{orgname}} Team.",`<div style='margin-top:-12px;'>${(null===(i=this.repairDetails.organizationDetail)||void 0===i?void 0:i.nameOfOrganization)||"--"} Team.</div>`).replace("{{orgcontactnumber}}",(null===(r=this.repairDetails.organizationDetail)||void 0===r?void 0:r.phoneNumber)||"--")):""}ngOnInit(){this.sendButton={label:"send",type:"disabled",icon:"send",onclick:this.send.bind(this)},this.commonService.showLoading(),this.messagingService.getMessageTemplate(this.data.repairId,this.data.domainId,3).subscribe({next:t=>{var i,r,s,p,u,m,C;if(t&&(null===(i=t[0])||void 0===i?void 0:i.data)){this.repairDetails=t[0].data;const O=(null===(r=this.repairDetails.organizationDetail)||void 0===r?void 0:r.partnerships)?null===(p=null===(s=this.repairDetails.organizationDetail)||void 0===s?void 0:s.partnerships[0])||void 0===p?void 0:p.email:"";let v="";if(this.data.isWorkProvider||(v=null===(u=this.repairDetails.customer)||void 0===u?void 0:u.email),this.emailRequest.email=this.data.isWorkProvider?[O]:[v],this.emailForm.email=Object.assign(Object.assign({},this.emailForm.email),{value:this.emailRequest.email[0]}),this.downloadPDF(this.data.repairId),null===(m=t[1])||void 0===m?void 0:m.data){const w=null===(C=t[1])||void 0===C?void 0:C.data;this.templateSubject=w.subject,this.templateBody=w.body,this.templateKey=t[1].data.templateKey,this.templateBody=this.tagsReplacers(this.templateBody),this.templateSubject=this.tagsReplacers(this.templateSubject)}}}}),this.sendButton=Object.assign(Object.assign({},this.sendButton),this.emailRequest.email&&this.emailRequest.email.length>0?{type:"primary"}:{type:"disabled"})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ye.so),e.Y36(Ge.M),e.Y36(ir.K),e.Y36(He.v),e.Y36(Mo),e.Y36(ns.H7),e.Y36(Ye.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-send-invoice"]],decls:33,vars:21,consts:[[1,"dialog-container"],[1,"header"],[1,"close-icon"],[3,"svgIcon","click"],["mat-dialog-content","",1,"email-dialog-body"],[1,"form-container"],[1,"input-wrapper"],[1,"div-wrapper"],[3,"ngClass","inputModel","controlOutput"],[1,"subject-wrapper","content-wrapper"],[1,"status",3,"innerHtml"],[1,"message-wrapper","content-wrapper"],[1,"message-container",3,"innerHtml"],[1,"attachment-wrapper","content-wrapper"],[1,"attachment-container"],[1,"attachment-item"],["src","../../../assets/img/pdf.png","alt",""],[1,"btn-container"],[1,"right",3,"buttonModel"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",2),e.TgZ(6,"mat-icon",3),e.NdJ("click",function(){return i.cancel()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",4),e.TgZ(8,"div",5),e.TgZ(9,"div",6),e.TgZ(10,"div",7),e.TgZ(11,"chq-input",8),e.NdJ("controlOutput",function(s){return i.onFormUpdate(s)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",9),e.TgZ(13,"label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e._UZ(16,"div",10),e.qZA(),e.TgZ(17,"div",11),e.TgZ(18,"label"),e._uU(19),e.ALo(20,"translate"),e.qZA(),e._UZ(21,"div",12),e.qZA(),e.TgZ(22,"div",13),e.TgZ(23,"label"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"div",14),e.TgZ(27,"div",15),e.TgZ(28,"div"),e._uU(29),e.qZA(),e._UZ(30,"img",16),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(31,"div",17),e._UZ(32,"chq-button",18),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Oqu(e.lcZ(4,11,"send_email")),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(5),e.Q6J("ngClass",e.VKq(19,g,!i.showCC))("inputModel",i.emailForm.email),e.xp6(3),e.Oqu(e.lcZ(15,13,"subject")),e.xp6(2),e.Q6J("innerHtml",i.templateSubject,e.oJD),e.xp6(3),e.Oqu(e.lcZ(20,15,"message")),e.xp6(2),e.Q6J("innerHtml",i.templateBody,e.oJD),e.xp6(3),e.Oqu(e.lcZ(25,17,"attachments")),e.xp6(5),e.Oqu(i.fileName),e.xp6(3),e.Q6J("buttonModel",i.sendButton))},directives:[Xe.Hw,nn.D,_.mk,yt.E],pipes:[we.X$],styles:[".dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;background:var(--xa-popup-light-gray);width:39.3125rem;grid-gap:2.25rem;gap:2.25rem;padding:1.875rem}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.dialog-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:20px;gap:20px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:first-child{text-transform:uppercase;font-size:12px;line-height:14px}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:.24963rem;gap:.24963rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .content-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:.75rem;font-style:normal;font-weight:400;text-transform:uppercase}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:.44963rem;gap:.44963rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]     p{margin:0;line-height:20px;color:var(--xa-black-medium);font-size:16px;font-family:inherit}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-weight:400;color:var(--xa-dark-gray)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .subject-wrapper[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{display:inline-block;color:var(--xa-black)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.4rem;gap:1.4rem;font-size:1rem;font-weight:400;color:var(--xa-black-medium)}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]     p{margin:0;line-height:20px;color:var(--xa-black-medium);font-size:16px;font-family:inherit}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .message-wrapper[_ngcontent-%COMP%]   .message-container[_ngcontent-%COMP%]     br{display:none}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]{grid-gap:.86625rem;gap:.86625rem}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]   .attachment-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:.86625rem;gap:.86625rem;font-size:1rem;font-weight:400;color:#0b0e15}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .attachment-wrapper[_ngcontent-%COMP%]   .attachment-container[_ngcontent-%COMP%]   .attachment-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;border-top:1px solid #c1c1c1;border-bottom:1px solid #c1c1c1;padding:.3125rem 0}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{display:flex;grid-gap:20px;gap:20px;flex-direction:column}.dialog-container[_ngcontent-%COMP%]   .form-container[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;line-height:14px;font-weight:400}.dialog-container[_ngcontent-%COMP%]   .email-dialog-body[_ngcontent-%COMP%]{max-height:calc(90vh - 174px)!important}.cc-span[_ngcontent-%COMP%]{position:absolute;right:10px;font-size:16px;line-height:14px;top:35px;color:var(--xa-black-medium);cursor:pointer}.div-wrapper[_ngcontent-%COMP%]{position:relative}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;grid-gap:10px;gap:10px;background:var(--xa-popup-light-gray)}"]}),a})();var Yi=Z(33938),Tt=Z(48262),_e=Z(23815);let _r=(()=>{class a{constructor(){this.transform=_e.orderBy}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275pipe=e.Yjl({name:"orderBy",type:a,pure:!0}),a})();var yo=Z(93077);let is=(()=>{class a{constructor(){this.maxPoint=1e8}transform(t,i){return t.reduce((s,p)=>s+this.parseFloatingPoint(p[i]),0)/this.maxPoint}parseFloatingPoint(t){return"string"==typeof t&&(t=parseFloat(t)),parseFloat(t)*this.maxPoint}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275pipe=e.Yjl({name:"sum",type:a,pure:!0}),a})();const Gn=["print"],bc=["phone"],os=function(a,c){return{active:a,"all-border":c}};function Cc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"button",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateFormType(1)}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.WLB(4,os,t.isWorkProvider,"retail"===(null==t.currentWorkProvider?null:t.currentWorkProvider.toLowerCase())&&"person"!==(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase()))),e.xp6(1),e.hij(" ",e.lcZ(2,2,"work_provider_invoice")," ")}}function Oc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateFormType(2)}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.WLB(4,os,!t.isWorkProvider,"retail"===(null==t.currentWorkProvider?null:t.currentWorkProvider.toLowerCase())&&"person"===(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase()))),e.xp6(1),e.hij(" ",e.lcZ(2,2,"driver_owner_invoice")," ")}}function Mc(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw();e.Gre("status-pill status-",null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase(),""),e.xp6(1),e.Oqu(e.lcZ(2,4,t.paymentStatusMapper[null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase()]))}}function pn(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"img",42),e.NdJ("load",function(){return e.CHM(t),e.oxw(2).orgImageLoading=!1}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("src",t.orgLogoUrl,e.LSH)}}function xc(a,c){if(1&a&&(e.TgZ(0,"label",44),e._uU(1),e.qZA()),2&a){const t=e.oxw(3);e.xp6(1),e.Oqu(t.orgName)}}function Pc(a,c){if(1&a&&e.YNc(0,xc,2,1,"label",43),2&a){const t=e.oxw(2);e.Q6J("ngIf",t.orgName)}}function yc(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"h4"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"h5"),e._uU(5),e.qZA(),e.TgZ(6,"h5"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"h5"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"h5"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"h5"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"chq-input",45),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).dataResponse.invoiceDate=r.value}),e.qZA(),e._UZ(19,"chq-input",46),e.TgZ(20,"chq-input",45),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).dataResponse.dueDate=r.value}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,13,"work_provider")),e.xp6(3),e.Oqu(t.workProviderValue),e.xp6(2),e.AsE("",e.lcZ(8,15,"contact_phone_number"),": ",t.dataResponse.customerPhoneNumber,""),e.xp6(3),e.AsE("",e.lcZ(11,17,"contact_email"),": ",t.dataResponse.customerEmail,""),e.xp6(3),e.AsE("",e.lcZ(14,19,"vehicle_owner"),": ",t.dataResponse.vehicleOwnerName,""),e.xp6(3),e.AsE("",e.lcZ(17,21,"license_id_cin"),": ",t.dataResponse.licenseNumber,""),e.xp6(2),e.Q6J("inputModel",t.invoiceIssuedDate),e.xp6(1),e.Q6J("inputModel",t.invoiceNumberInput),e.xp6(1),e.Q6J("inputModel",t.dueDate)}}function wc(a,c){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"h4"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"h5"),e._uU(5),e.qZA(),e.TgZ(6,"h5"),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"h5"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"chq-input",45),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return s.dataResponse.address=r.value||null,s.isInvoiceFormValid()}),e.qZA(),e.TgZ(13,"chq-input",45),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw(2);return s.dataResponse.invoiceDate=r.value,s.isInvoiceFormValid()}),e.qZA(),e._UZ(14,"chq-input",46),e.TgZ(15,"chq-input",45),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(2).dataResponse.dueDate=r.value}),e.qZA(),e.BQk()}if(2&a){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,10,"driver_owner")),e.xp6(3),e.Oqu(t.customerValue),e.xp6(2),e.AsE("",e.lcZ(8,12,"driver_contact_phone_number"),": ",t.dataResponse.customerPhoneNumber,""),e.xp6(3),e.AsE("",e.lcZ(11,14,"driver_contact_email"),": ",t.dataResponse.customerEmail,""),e.xp6(2),e.Q6J("inputModel",t.addressInput),e.xp6(1),e.Q6J("inputModel",t.invoiceIssuedDate),e.xp6(1),e.Q6J("inputModel",t.invoiceNumberInput),e.xp6(1),e.Q6J("inputModel",t.dueDate)}}const Tc=function(a){return{"text-mode":a}};function un(a,c){if(1&a&&(e.TgZ(0,"div",47),e.TgZ(1,"div",48),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",49),e.TgZ(5,"span"),e._uU(6),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(6,Tc,"paid"===(null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase())||"complete"===(null==t.dataResponse||null==t.dataResponse.paymentStatus?null:t.dataResponse.paymentStatus.toLowerCase()))),e.xp6(2),e.hij(" ",e.lcZ(3,4,"contact_number")," "),e.xp6(4),e.AsE("",t.dataResponse.code," ",t.dataResponse.mobileNumber||"--","")}}function Dc(a,c){if(1&a&&(e.TgZ(0,"tr"),e.TgZ(1,"td",58),e.TgZ(2,"h6",53),e._uU(3),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(3),e.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}const at=function(a,c,t,i,r){return[a,c,t,i,r]};function Sc(a,c){if(1&a&&(e.TgZ(0,"tbody"),e.YNc(1,Dc,4,1,"tr",28),e.TgZ(2,"tr"),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",57),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"xaCurrency"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"xaCurrency"),e.qZA(),e.qZA(),e.qZA()),2&a){const t=c.$implicit,i=c.index,r=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(1),e.Q6J("ngIf","Paint"===r.key&&(0===i||i>0&&t.serviceSubType!==s.invoiceList[r.key][i-1].serviceSubType)),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.hij(" ",e.G7q(11,6,e.qbA(18,at,t.cost,s.i18n.currencySymbol,s.i18n.digitsInfo,s.i18n.locale,s.i18n.position))," "),e.xp6(3),e.hij(" ",e.G7q(14,12,e.qbA(24,at,t.total,s.i18n.currencySymbol,s.i18n.digitsInfo,s.i18n.locale,s.i18n.position))," ")}}function Ic(a,c){if(1&a&&(e.ynx(0),e.TgZ(1,"table",54),e.TgZ(2,"thead"),e.TgZ(3,"tr"),e.TgZ(4,"td"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(19,Sc,15,30,"tbody",55),e.ALo(20,"orderBy"),e.qZA(),e.TgZ(21,"table",54),e.TgZ(22,"tfoot"),e.TgZ(23,"tr"),e.TgZ(24,"td"),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"td",56),e._uU(28),e.ALo(29,"xaCurrency"),e.ALo(30,"sum"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()),2&a){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(5),e.Oqu(e.lcZ(6,10,"description")),e.xp6(3),e.Oqu(e.lcZ(9,12,"code")),e.xp6(3),e.Oqu(e.lcZ(12,14,"units")),e.xp6(3),e.AsE("",e.lcZ(15,16,"price_unit"),"(",i.currencySymbol,")"),e.xp6(3),e.AsE("",e.lcZ(18,18,"total_price"),"(",i.currencySymbol,")"),e.xp6(2),e.Q6J("ngForOf",e.Dn7(20,20,i.invoiceList[t.key],"serviceSubtype","asc")),e.xp6(6),e.Oqu(e.lcZ(26,24,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),e.xp6(3),e.hij(" ",e.G7q(29,26,e.qbA(35,at,e.xi3(30,32,i.invoiceList[t.key],"total"),i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))," ")}}function Ac(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",50),e.TgZ(1,"span",51),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).hideShowSection(s.key)}),e.TgZ(2,"mat-icon",52),e._uU(3),e.qZA(),e.TgZ(4,"h6",53),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA(),e.YNc(7,Ic,31,41,"ng-container",28),e.qZA()}if(2&a){const t=c.$implicit,i=e.oxw(2);e.xp6(3),e.Oqu(i.getSection(t.key)?"keyboard_arrow_up":"keyboard_arrow_down"),e.xp6(2),e.Oqu(e.lcZ(6,3,null==t.key?null:t.key.toLowerCase())),e.xp6(2),e.Q6J("ngIf",i.getSection(t.key))}}function Hn(a,c){if(1&a&&(e.TgZ(0,"div",65),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(3);e.xp6(2),e.hij("5% ",e.lcZ(3,2,"vat"),""),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,at,.05*(t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.labourTotal+t.estimateSummary.partsTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position)))}}function Zc(a,c){if(1&a&&(e.TgZ(0,"div",65),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,2,"total_cost_including_vat")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,at,t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.labourTotal+t.estimateSummary.partsTotal+.05*(t.estimateSummary.paintLabourTotal+t.estimateSummary.paintMaterialTotal+t.estimateSummary.partsTotal+t.estimateSummary.labourTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position)))}}function kc(a,c){if(1&a&&(e.TgZ(0,"div",59),e.TgZ(1,"div",60),e.TgZ(2,"h5"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"h6"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",61),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"span"),e._uU(13),e.ALo(14,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(15,"div",61),e.TgZ(16,"span"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"span"),e._uU(20),e.ALo(21,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(22,"div",61),e.TgZ(23,"span"),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.TgZ(26,"span"),e._uU(27),e.ALo(28,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(29,"div",62),e.TgZ(30,"span"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"span"),e._uU(34),e.qZA(),e.qZA(),e.TgZ(35,"div",63),e.TgZ(36,"span"),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"span"),e._uU(40),e.ALo(41,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(42,"h6"),e._uU(43),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"div",61),e.TgZ(46,"span"),e._uU(47),e.ALo(48,"translate"),e.qZA(),e.TgZ(49,"span"),e._uU(50),e.ALo(51,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(52,"div",61),e.TgZ(53,"span"),e._uU(54),e.ALo(55,"translate"),e.qZA(),e.TgZ(56,"span"),e._uU(57),e.qZA(),e.qZA(),e.TgZ(58,"div",62),e.TgZ(59,"span"),e._uU(60),e.ALo(61,"translate"),e.qZA(),e.TgZ(62,"span"),e._uU(63),e.qZA(),e.qZA(),e.TgZ(64,"div",63),e.TgZ(65,"span"),e._uU(66),e.ALo(67,"translate"),e.qZA(),e.TgZ(68,"span"),e._uU(69),e.ALo(70,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(71,"h6"),e._uU(72),e.ALo(73,"translate"),e.qZA(),e.TgZ(74,"div",61),e.TgZ(75,"span"),e._uU(76),e.ALo(77,"translate"),e.qZA(),e.TgZ(78,"span"),e._uU(79),e.qZA(),e.qZA(),e.TgZ(80,"div",61),e.TgZ(81,"span"),e._uU(82),e.ALo(83,"translate"),e.qZA(),e.TgZ(84,"span"),e._uU(85),e.ALo(86,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(87,"div",61),e.TgZ(88,"span"),e._uU(89),e.ALo(90,"translate"),e.qZA(),e.TgZ(91,"span"),e._uU(92),e.qZA(),e.qZA(),e.TgZ(93,"div",64),e.TgZ(94,"span"),e._uU(95),e.ALo(96,"translate"),e.qZA(),e.TgZ(97,"span"),e._uU(98),e.ALo(99,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(100,"div",61),e.TgZ(101,"span"),e._uU(102),e.ALo(103,"translate"),e.qZA(),e.TgZ(104,"span"),e._uU(105),e.ALo(106,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(107,"div",61),e.TgZ(108,"span"),e._uU(109),e.ALo(110,"translate"),e.qZA(),e.TgZ(111,"span"),e._uU(112),e.qZA(),e.qZA(),e.TgZ(113,"div",62),e.TgZ(114,"span"),e._uU(115),e.ALo(116,"translate"),e.qZA(),e.TgZ(117,"span"),e._uU(118),e.ALo(119,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(120,"div",63),e.TgZ(121,"span"),e._uU(122),e.ALo(123,"translate"),e.qZA(),e.TgZ(124,"span"),e._uU(125),e.ALo(126,"xaCurrency"),e.qZA(),e.qZA(),e.TgZ(127,"div",65),e.TgZ(128,"span"),e._uU(129),e.ALo(130,"translate"),e.qZA(),e.TgZ(131,"span"),e._uU(132),e.ALo(133,"xaCurrency"),e.qZA(),e.qZA(),e.YNc(134,Hn,7,16,"div",66),e.YNc(135,Zc,7,16,"div",66),e.qZA(),e.qZA()),2&a){const t=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,42,"summary")),e.xp6(3),e.Oqu(e.lcZ(7,44,"parts")),e.xp6(4),e.Oqu(e.lcZ(11,46,"subtotal")),e.xp6(3),e.Oqu(e.G7q(14,48,e.qbA(158,at,t.estimateSummary.partsSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(18,54,"sundry_parts")),e.xp6(3),e.Oqu(e.G7q(21,56,e.qbA(164,at,t.estimateSummary.sundryParts,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(25,62,"total_before_discount")),e.xp6(3),e.Oqu(e.G7q(28,64,e.qbA(170,at,t.estimateSummary.partsTotalBeforeDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(32,70,"discount_on_parts")),e.xp6(3),e.hij("",t.estimateSummary.partsTotalDiscountPercentage,"%"),e.xp6(3),e.Oqu(e.lcZ(38,72,"total_parts")),e.xp6(3),e.Oqu(e.G7q(41,74,e.qbA(176,at,t.estimateSummary.partsTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(3),e.Oqu(e.lcZ(44,80,"labour")),e.xp6(4),e.Oqu(e.lcZ(48,82,"labour_amount_subtotal")),e.xp6(3),e.Oqu(e.G7q(51,84,e.qbA(182,at,t.estimateSummary.labourAmountSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(55,90,"labour_hours")),e.xp6(3),e.hij("",t.estimateSummary.labourTimeHours," hrs"),e.xp6(3),e.Oqu(e.lcZ(61,92,"labour_discount")),e.xp6(3),e.hij("",t.estimateSummary.labourTotalDiscountPercentage,"%"),e.xp6(3),e.Oqu(e.lcZ(67,94,"total_labour_cost")),e.xp6(3),e.Oqu(e.G7q(70,96,e.qbA(188,at,t.estimateSummary.labourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(3),e.Oqu(e.lcZ(73,102,"paint")),e.xp6(4),e.Oqu(e.lcZ(77,104,"paint_labour_time")),e.xp6(3),e.hij("",t.estimateSummary.paintLabourTimeHour,"hrs"),e.xp6(3),e.Oqu(e.lcZ(83,106,"paint_labour_subtotal")),e.xp6(3),e.Oqu(e.G7q(86,108,e.qbA(194,at,t.estimateSummary.paintLabourSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(90,114,"paint_labour_discount")),e.xp6(3),e.hij(" ",t.estimateSummary.paintLabourDiscountPercentage,"%"),e.xp6(3),e.Oqu(e.lcZ(96,116,"labour_total")),e.xp6(3),e.Oqu(e.G7q(99,118,e.qbA(200,at,t.estimateSummary.paintLabourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(103,124,"material_subtotal")),e.xp6(3),e.Oqu(e.G7q(106,126,e.qbA(206,at,t.estimateSummary.paintMaterialSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(110,132,"material_discount")),e.xp6(3),e.hij("",t.estimateSummary.paintMateriaDiscountPercentage,"%"),e.xp6(3),e.Oqu(e.lcZ(116,134,"material_total")),e.xp6(3),e.Oqu(e.G7q(119,136,e.qbA(212,at,t.estimateSummary.paintMaterialTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(123,142,"total_paint")),e.xp6(3),e.Oqu(e.G7q(126,144,e.qbA(218,at,t.calculateSub(t.estimateSummary.paintLabourTotal,t.estimateSummary.paintMaterialTotal,0,0),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(4),e.Oqu(e.lcZ(130,150,"total_cost")),e.xp6(3),e.Oqu(e.G7q(133,152,e.qbA(224,at,t.calculateSub(t.estimateSummary.paintLabourTotal,t.estimateSummary.paintMaterialTotal,t.estimateSummary.labourTotal,t.estimateSummary.partsTotal),t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),e.xp6(2),e.Q6J("ngIf",!1),e.xp6(1),e.Q6J("ngIf",!1)}}const st=function(a){return{"do-not-print":a}},qc=function(a){return{"text-check":a}};function Rc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",20),e.TgZ(1,"section",21),e.TgZ(2,"div",22),e.TgZ(3,"div",23),e.YNc(4,pn,1,1,"img",24),e.YNc(5,Pc,1,1,"ng-template",null,25,e.W1O),e._UZ(7,"chq-customloader",26),e.qZA(),e.TgZ(8,"div",27),e.YNc(9,yc,21,23,"ng-container",28),e.YNc(10,wc,16,16,"ng-container",28),e.qZA(),e.qZA(),e.TgZ(11,"div",29),e.TgZ(12,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.workShopName=r.value||null,s.isInvoiceFormValid()}),e.qZA(),e.TgZ(13,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.bankName=r.value||null,s.isInvoiceFormValid()}),e.qZA(),e.TgZ(14,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.ifscCode=r.value||null,s.isInvoiceFormValid()}),e.qZA(),e.TgZ(15,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.accountNumber=r.value||null,s.isInvoiceFormValid()}),e.qZA(),e.TgZ(16,"chq-input",30),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.trn=r.value||null,s.isInvoiceFormValid()}),e.qZA(),e.TgZ(17,"div",31),e.TgZ(18,"chq-input",32),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw().onFormUpdateCustomer(r)}),e.qZA(),e.TgZ(19,"chq-input",33,34),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.dataResponse.mobileNumber=r.value||null,s.isInvoiceFormValid()}),e.qZA(),e.YNc(21,un,7,8,"div",35),e.qZA(),e.qZA(),e.qZA(),e.TgZ(22,"section",36),e.TgZ(23,"div",37),e.TgZ(24,"span",38),e.NdJ("click",function(){return e.CHM(t),e.oxw().expandCollapse(!0)}),e._uU(25),e.ALo(26,"translate"),e.qZA(),e.TgZ(27,"span",38),e.NdJ("click",function(){return e.CHM(t),e.oxw().expandCollapse(!1)}),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.qZA(),e.TgZ(30,"div",39),e.YNc(31,Ac,8,5,"div",40),e.ALo(32,"keyvalue"),e.YNc(33,kc,136,230,"div",41),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.MAs(6),i=e.oxw();e.xp6(4),e.Q6J("ngIf",i.orgLogoUrl)("ngIfElse",t),e.xp6(3),e.Q6J("showLoading",i.orgImageLoading),e.xp6(2),e.Q6J("ngIf",i.isWorkProvider),e.xp6(1),e.Q6J("ngIf",!i.isWorkProvider),e.xp6(2),e.Q6J("ngClass",e.VKq(36,st,!i.dataResponse.workShopName))("inputModel",i.payeeOrgNameInput),e.xp6(1),e.Q6J("ngClass",e.VKq(38,st,!i.dataResponse.bankName))("inputModel",i.payeeBankNameInput),e.xp6(1),e.Q6J("ngClass",e.VKq(40,st,!i.dataResponse.ifscCode))("inputModel",i.IfscCodeInput),e.xp6(1),e.Q6J("ngClass",e.VKq(42,st,!i.dataResponse.accountNumber))("inputModel",i.accountNumberInput),e.xp6(1),e.Q6J("ngClass",e.VKq(44,st,!i.dataResponse.trn))("inputModel",i.trnNumberInput),e.xp6(1),e.Q6J("ngClass",e.VKq(46,qc,"paid"===(null==i.dataResponse||null==i.dataResponse.paymentStatus?null:i.dataResponse.paymentStatus.toLowerCase())||"complete"===(null==i.dataResponse||null==i.dataResponse.paymentStatus?null:i.dataResponse.paymentStatus.toLowerCase()))),e.xp6(1),e.Q6J("ngClass",e.VKq(48,st,!i.phoneCode.value))("inputModel",i.phoneCode),e.xp6(1),e.Q6J("ngClass",e.VKq(50,st,!i.dataResponse.mobileNumber))("inputModel",i.contactNumberInput),e.xp6(2),e.Q6J("ngIf",i.dataResponse.mobileNumber),e.xp6(3),e.ekj("secondary-color",i.isAllExpanded),e.xp6(1),e.Oqu(e.lcZ(26,29,"expand_all")),e.xp6(2),e.ekj("secondary-color",!i.isAllExpanded),e.xp6(1),e.hij("",e.lcZ(29,31,"collapse_all")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(32,33,i.invoiceList,i.valueAscOrder)),e.xp6(2),e.Q6J("ngIf",i.estimateSummary)}}const Lc=function(a){return{value:a}};function Ec(a,c){if(1&a&&(e.TgZ(0,"div",67),e._UZ(1,"mat-icon",68),e.TgZ(2,"p",69),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("svgIcon","estimate-no-data"),e.xp6(2),e.hij(" ",e.xi3(4,2,"no_invoice_result",e.VKq(5,Lc,t.isWorkProvider?t.workProviderValue:t.customerValue)),". ")}}function Fc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-dropdown",70),e.NdJ("selected",function(r){return e.CHM(t),e.oxw().handleSelectedOption(r)}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("dropdownModel",t.dropdownApprovalModelFilter)}}function rs(a,c){if(1&a&&e._UZ(0,"chq-button",71),2&a){const t=e.oxw();e.Q6J("buttonModel",t.saveButtonModel)}}function as(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",72),e.NdJ("click",function(){return e.CHM(t),e.oxw().openPaymentPopup()}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("buttonModel",t.paymentsButtonModel)}}function Nc(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-button",72),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeRepair()}),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("buttonModel",t.closeRepairButtonModel)}}let jc=(()=>{class a{constructor(t,i,r,s,p,u,m,C,O,v,w){var D;this.commonService=t,this.route=i,this.router=r,this.dialog=s,this.coreService=p,this.translateService=u,this.OutboundService=m,this.invoiceService=C,this.bookingService=O,this.translationService=v,this.monitorServie=w,this.digitInfo="",this.locale="",this.currencySymbol="",this.charges=[],this.subs=[],this.isOptionsOpen=!1,this.invoiceList={},this.isWorkProvider=!0,this.orgImageLoading=!0,this.orgLogoUrl="",this.orgName="",this.repairStatus="",this.domainId=3100,this.isAllExpanded=!0,this.isPartsExpanded=!0,this.isLabourExpanded=!0,this.isPaintExpanded=!0,this.isDataLoading=!0,this.dataResponse={},this.pickupDate=null,this.currentDueDate=null,this.bookingOutDate=null,this.trnNumberLimit=15,this.partsCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",units:"2",cost:"500",total:"1500"}],this.totalPartsCost=0,this.labourCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",hours:"5",cost:"500",total:"1500"}],this.totalLabourCost=0,this.maxPoint=1e7,this.estimateSummary={},this.currentWorkProvider="",this.currentWorkProviderType="",this.workProviderValue="",this.customerValue="",this.paintLabour=[{description:"Boot lid Repaired <50%",code:"GtP84000",unitHours:"1.60",cost:"500",total:"1500"}],this.paintMaterial=[{description:"Boot lid Repaired <50%",code:"GtP84000",unitHours:"1",cost:"300",total:"300"}],this.totalPaintCost=0,this.noDataFound=!1,this.paintCost=[],this.dropdownApprovalModelFilter={options:[{dropdownItemIconMaterial:"mail_outline",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"send",label:this.translationService.instant("send")},{dropdownItemIconMaterial:"download-arrow",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"download",label:this.translationService.instant("download")}],placeHolder:"Options",label:"",hideDropdownIcon:!1,appearance:"button",placeHolderIcon:"settings-outline",name:"option",displayValue:"label",selectedOption:{}},this.backButtonModel={label:"Back / Edit Invoice ",type:"outline",icon:"left-arrow",onclick:()=>{var T;const R=null===(T=this.route.parent)||void 0===T?void 0:T.snapshot.paramMap.get("id");this.router.navigate([`repair/booking/${R}/invoices`],{queryParams:{isBack:!0}})}},this.saveButtonModel={label:"Save",type:"outline",onclick:()=>{this.saveInvoiceComponent()}},this.invoiceGUID="",this.paymentsButtonModel={label:"Payments",icon:"credit-card",type:"outline"},this.closeRepairButtonModel={label:"Close Repair",icon:"cross",type:"primary"},this.invoiceIssuedDate={placeHolder:"Select Date",label:"INVOICE DATE",name:"invoiceDate",value:new Date,maxDate:new Date,type:"date",required:!0,disabled:!1,mode:"text"},this.dueDate={placeHolder:"Select Date",label:"DUE DATE",name:"dueDate",value:"",type:"date",required:!1,disabled:!1,mode:"date"},this.addressInput={placeHolder:"",label:"ADDRESS",name:"address",value:"St 123",type:"text",maxLength:200,validation:{name:"address",validationFunction:()=>A.kI.compose([A.kI.maxLength(200)]),validationMessage:T=>T.required?"Please select operation type":T.maxLength?this.translateService.instant("max_length",{value:200}):""}},this.invoiceNumberInput={placeHolder:"",label:"INVOICE NUMBER",name:"invoiceNumber",value:"",type:"text",mode:"text"},this.payeeOrgNameInput={placeHolder:"",label:"workshop",name:"orgName",value:"XA Prestige Automotive",type:"text",validation:{name:"orgName",validationFunction:()=>A.kI.compose([A.kI.maxLength(30)]),validationMessage:T=>T.maxlength?this.translateService.instant("max_length",{value:30}):""}},this.payeeBankNameInput={placeHolder:"",label:"Payee BANK  Name",name:"bankname",value:"Emirates NBD",type:"text",validation:{name:"orgName",validationFunction:()=>A.kI.compose([A.kI.maxLength(30)]),validationMessage:T=>T.maxlength?this.translateService.instant("max_length",{value:30}):""}},this.IfscCodeInput={placeHolder:"",label:"IFSC/Swift Code",name:"ifscCode",maxLength:11,value:"9076986696",type:"text",validation:{name:"orgName",validationFunction:()=>A.kI.compose([A.kI.maxLength(11),A.kI.minLength(11)]),validationMessage:T=>T.maxlength||T.minlength?this.translateService.instant("max_length",{value:11}):""}},this.accountNumberInput={placeHolder:"",label:"Account Number/IBAN",name:"accountNumber",value:"",type:"text",validation:{name:"accountNumber",validationFunction:()=>A.kI.compose([A.kI.minLength(9),A.kI.maxLength(34),A.kI.pattern("^[a-zA-Z0-9]{9,34}$")]),validationMessage:T=>T.minlength?"min_account_number":T.maxlength?"max_account_number":T.pattern?"Please enter a valid Account Number/IBAN":""}},this.trnNumberInput={placeHolder:"",label:"TRN",name:"trn",value:"",type:"number",maxLength:this.trnNumberLimit,validation:{name:"accountNumber",validationFunction:()=>A.kI.compose([A.kI.pattern(`^[0-9]{${this.trnNumberLimit}}$`)]),validationMessage:T=>T.pattern?"Please enter a valid TRN Number":""}},this.phoneCode={placeHolder:"select_dot",label:"code",name:"code",value:91,showImageFlag:!0,type:"select",selectedOption:{phoneCountryCode:"+91"},displayValue:"phoneCountryCode",fieldValue:"phoneCountryCode",options:[{label:"+90"},{label:"+971"},{label:"+977"}],validation:{name:"code",validationFunction:()=>A.kI.compose([]),validationMessage:T=>T.required?"required_code":""}},this.contactNumberInput={placeHolder:"",label:"CONTACT NUMBER",name:"contactNumber",value:"",type:"number",validation:{name:"contactNumber",validationFunction:()=>A.kI.compose([A.kI.pattern("^[0-9]+[0-9 ,.'-]+$")]),validationMessage:T=>T.required?"Please enter mobile number":T.pattern?"Please enter valid mobile number":""}},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.hashPropTable={},this.IsPickedup=!1,this.isWorkProvider=1==(null===(D=this.route.snapshot)||void 0===D?void 0:D.queryParams.formType),this.navigationEndSubscription=this.router.events.subscribe(T=>{var R;T instanceof Be.m2&&(this.isWorkProvider=1==(null===(R=this.route.snapshot)||void 0===R?void 0:R.queryParams.formType))}),this.commonService.reloadDetail.closed&&(this.commonService.reloadDetail=new Vt.X(null)),this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}onObservableLoad(t){var i,r,s,p,u,m;if(this.commonService.hideLoading(),t&&t&&t.length>0){if(!this.dataResponse.contactNumber)return this.phoneCode=Object.assign(Object.assign({},this.phoneCode),{selectedOption:{}}),void(this.contactNumberInput=Object.assign(Object.assign({},this.contactNumberInput),{value:null}));const C=null===(i=this.dataResponse.contactNumber)||void 0===i?void 0:i.substring(0,3),O=null===(r=this.dataResponse.contactNumber)||void 0===r?void 0:r.substring(0,4);let v="",w=t.filter(D=>D.phoneCountryCode===C);if(0===w.length?(v=null===(s=this.dataResponse.contactNumber)||void 0===s?void 0:s.substring(4,null===(p=this.dataResponse.contactNumber)||void 0===p?void 0:p.length),w=t.filter(D=>D.phoneCountryCode===O)):v=null===(u=this.dataResponse.contactNumber)||void 0===u?void 0:u.substring(3,null===(m=this.dataResponse.contactNumber)||void 0===m?void 0:m.length),w.length>0){const D=w[0],T=D.regExpression;this.phoneCode=Object.assign(Object.assign({},this.phoneCode),{selectedOption:D,mode:"complete"===this.repairStatus.toLowerCase()||this.commonService.isViewOnly||"paid"===this.repairStatus.toLowerCase()?"text":null}),this.dataResponse.code=D.phoneCountryCode,this.contactNumberInput=Object.assign(Object.assign({},this.contactNumberInput),{value:v}),this.phone&&(this.phone.updateCurrentValidation(T,!0,!0),this.phone.setDirty())}}}sendInvoice(){var t;const i=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.dialog.open(xi,{data:{repairId:i,domainId:this.domainId,invoiceId:this.invoiceGUID,isWorkProvider:this.isWorkProvider,workProviderValue:this.workProviderValue,customerValue:this.customerValue,dueDate:this.currentDueDate},backdropClass:"confirmation-popup-backdrop",autoFocus:!1})}handleSelectedOption(t){"send"===t.value.value?this.sendInvoice():this.downloadPDF()}updateFormType(t){this.isDataLoading=!0,this.isWorkProvider=1===t,this.invoiceList={},this.noDataFound=!0,this.getBookingRepairDetails()}onFormUpdateCustomer(t){var i;if("code"===t.name){const r=t.value.regExpression;this.dataResponse.code=t.value.phoneCountryCode,this.phoneCode=Object.assign(Object.assign({},this.phoneCode),{selectedOption:t.value}),null===(i=this.phone)||void 0===i||i.updateCurrentValidation(r,!1,!0)}}valueAscOrder(t,i){var r,s;const p={part:"1",labour:"2",paint:"3"};return p[null===(r=t.key)||void 0===r?void 0:r.toLowerCase()].localeCompare(p[null===(s=i.key)||void 0===s?void 0:s.toLowerCase()])}isInvoiceFormValid(){var t,i,r,s,p,u,m;this.saveButtonModel=(null===(t=this.invoiceIssuedDate.formControl)||void 0===t?void 0:t.valid)&&(null===(i=this.IfscCodeInput.formControl)||void 0===i?void 0:i.valid)&&(null===(r=this.payeeBankNameInput.formControl)||void 0===r?void 0:r.valid)&&(null===(s=this.payeeOrgNameInput.formControl)||void 0===s?void 0:s.valid)&&(null===(p=this.accountNumberInput.formControl)||void 0===p?void 0:p.valid)&&(null===(u=this.trnNumberInput.formControl)||void 0===u?void 0:u.valid)&&(null===(m=this.contactNumberInput.formControl)||void 0===m?void 0:m.valid)?Object.assign(Object.assign({},this.saveButtonModel),{type:"outline"}):Object.assign(Object.assign({},this.saveButtonModel),{type:"disabled-outline"})}getBookingRepairDetails(){var t;this.commonService.showLoading();const i=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.monitorServie.logEvent("getBookingRepairDetails",["InvoicesComponent","addenda-repair"],{repairGuid:i}),this.bookingService.getRepairDetailByGuid(i).subscribe({next:r=>(0,Ze.mG)(this,void 0,void 0,function*(){var s,p,u,m,C,O,v,w,D,T;if(null==r?void 0:r.data){this.commonService.repairDetails.next(r.data),this.commonService.bookingId.next(r.data.repairNumber),this.pickupDate=r.data.pickUpDate,this.bookingOutDate=r.data.booking.endDate,this.IsPickedup=r.data.isPickedUp,this.repairStatus=r.data.status,this.domainId=r.data.domainId;const R=r.data.createdDate,I=J(new Date).diff(J(R),"minutes");this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{minDate:J(R).toDate(),disabled:I<0,value:J(R).toDate(),maxDate:I<0?J(R).toDate():new Date}),this.dueDate=Object.assign(Object.assign({},this.dueDate),{minDate:J(R).toDate()}),this.currentWorkProvider=r.data.customer.companyOrgType,this.currentWorkProviderType=r.data.customer.customerTypeName,this.customerValue=`${null===(p=null===(s=r.data)||void 0===s?void 0:s.customer)||void 0===p?void 0:p.firstName} ${null===(m=null===(u=r.data)||void 0===u?void 0:u.customer)||void 0===m?void 0:m.lastName}`,this.workProviderValue=(null===(O=null===(C=r.data)||void 0===C?void 0:C.customer)||void 0===O?void 0:O.companyName)||(null===(w=null===(v=r.data)||void 0===v?void 0:v.customer)||void 0===w?void 0:w.customerTypeName),null!==(null===(D=r.data.organizationDetail)||void 0===D?void 0:D.country)&&"india"===(null===(T=r.data.organizationDetail)||void 0===T?void 0:T.country.toLowerCase())&&(this.trnNumberInput=Object.assign(Object.assign({},this.trnNumberInput),{label:"TIN",validation:{name:"accountNumber",validationFunction:()=>A.kI.compose([A.kI.pattern(`^[0-9]{${this.trnNumberLimit}}$`)]),validationMessage:E=>E.pattern?"Please enter a valid TIN Number":""}})),this.invoiceService.invoicePerDetailProvider(i,this.isWorkProvider?1:2).subscribe({next:E=>{var F,G,re,z,ne,N;if(!E)return this.commonService.hideLoading(),this.isDataLoading=!1,void(this.noDataFound=!0);const{orgName:X,logoUrl:ue}=E.data;this.dataResponse=E.data,this.isDataLoading=!1,this.noDataFound=!1;let Q=null;this.invoiceGUID=this.dataResponse.invoiceGuid,("paid"===(null===(G=null===(F=this.dataResponse)||void 0===F?void 0:F.paymentStatus)||void 0===G?void 0:G.toLowerCase())||this.commonService.isViewOnly||"complete"===(null===(z=null===(re=this.dataResponse)||void 0===re?void 0:re.paymentStatus)||void 0===z?void 0:z.toLowerCase())||"complete"===(null===(ne=this.repairStatus)||void 0===ne?void 0:ne.toLowerCase()))&&(Q="text"),this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{value:this.dataResponse.invoiceDate}),this.accountNumberInput=Object.assign(Object.assign({},this.accountNumberInput),{value:this.dataResponse.accountNumber,mode:Q}),this.IfscCodeInput=Object.assign(Object.assign({},this.IfscCodeInput),{value:this.dataResponse.ifscCode,mode:Q}),this.addressInput=Object.assign(Object.assign({},this.addressInput),{value:this.dataResponse.address,mode:Q}),this.contactNumberInput=Object.assign(Object.assign({},this.contactNumberInput),{mode:Q}),this.trnNumberInput=Object.assign(Object.assign({},this.trnNumberInput),{value:this.dataResponse.trn,mode:Q}),this.payeeBankNameInput=Object.assign(Object.assign({},this.payeeBankNameInput),{value:this.dataResponse.bankname,mode:Q}),this.payeeOrgNameInput=Object.assign(Object.assign({},this.payeeOrgNameInput),{value:this.dataResponse.workShopName,mode:Q}),this.dueDate=Object.assign(Object.assign({},this.dueDate),{value:this.dataResponse.dueDate||"",mode:Q}),this.currentDueDate=this.dataResponse.dueDate,this.invoiceNumberInput=Object.assign(Object.assign({},this.invoiceNumberInput),{value:this.dataResponse.invoiceNumber}),this.dataResponse.dueDate||(this.dataResponse.dueDate=new Date),this.phoneCode.observable||(this.phoneCode.observable=this.coreService.getPhoneNumber(),this.phoneCode.onObservableLoad=this.onObservableLoad.bind(this)),this.orgName=X,this.orgLogoUrl=ue;const ee=this.dataResponse.chargesDTO;this.charges=ee,this.estimateSummary=null===(N=this.dataResponse)||void 0===N?void 0:N.chargeSummary,null==ee||ee.forEach(Me=>{this.invoiceList[Me.serviceType]||(this.invoiceList[Me.serviceType]=[]),this.invoiceList[Me.serviceType].push(Me)}),this.orgLogoUrl||(this.orgImageLoading=!1),this.commonService.hideLoading()}})}else this.isDataLoading=!1,this.commonService.hideLoading()}),error:r=>{this.isDataLoading=!1,this.commonService.hideLoading(),this.monitorServie.logException(r,je._.Error)}})}calculateSub(t,i,r,s){return(t*this.maxPoint+i*this.maxPoint+r*this.maxPoint+s*this.maxPoint)/this.maxPoint}parseFloatingPoint(t,i){return this.hashPropTable[i]?t:(i&&(this.hashPropTable[i]=!0),t*this.maxPoint)}validateLabourTypes(t,i,r,s){return i===Nn.UW.Paint?"PaintLabour"===r.serviceSubType?(t.paintLabourHourSubTotal=this.parseFloatingPoint(t.paintLabourHourSubTotal,`paintLabourHourSubTotal_${s}`)+this.parseFloatingPoint(r.quantity),t.paintLabourAmountSubTotal=this.parseFloatingPoint(t.paintLabourAmountSubTotal,`paintLabourAmountSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintLabourSubTotal=this.parseFloatingPoint(t.paintLabourSubTotal,`paintLabourSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintLabourTotal=this.parseFloatingPoint(t.paintLabourTotal,`paintLabourSubTotal+${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.paintLabourDiscountPercentage))/100)):(t.paintMaterialSubTotal=this.parseFloatingPoint(t.paintMaterialSubTotal,`paintMaterialSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintMaterialTotal=this.parseFloatingPoint(t.paintMaterialTotal,`paintMaterialTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.paintMateriaDiscountPercentage))/100)):i===Nn.UW.Labour?(t.labourTotalBeforeDiscount=this.parseFloatingPoint(t.labourTotalBeforeDiscount,`labourTotalBeforeDiscount_${s}`)+this.parseFloatingPoint(r.total),t.labourAmountSubTotal=this.parseFloatingPoint(t.labourAmountSubTotal,`labourAmountSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.labourTotal=this.parseFloatingPoint(t.labourTotal,`labourTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.labourTotalDiscountPercentage))/100),t.labourHourSubTotal=this.parseFloatingPoint(t.labourHourSubTotal,`labourHourSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.labourTimeHours=this.parseFloatingPoint(t.labourTimeHours,`labourTimeHours_${s}`)+this.parseFloatingPoint(r.quantity)):(t.partsTotalBeforeDiscount=this.parseFloatingPoint(t.partsTotalBeforeDiscount,`partsTotalBeforeDiscount_${s}`)+this.parseFloatingPoint(r.total),t.partsTotal=this.parseFloatingPoint(t.partsTotal,`partsTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.partsTotalDiscountPercentage))/100),t.partsSubTotal=this.parseFloatingPoint(t.partsSubTotal,`partsSubTotal_${s}`)+this.parseFloatingPoint(r.total)),t}calculateSummary(t){return this.hashPropTable={},t.paintLabourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.paintLabourSubTotal=0,t.labourTotal=0,t.paintLabourTotal=0,t.labourTimeHours=0,t.labourTotalBeforeDiscount=0,t.paintMaterialTotal=0,t.paintMaterialSubTotal=0,t.labourAmountSubTotal=0,t.labourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.partsSubTotal=0,t.partsTotal=0,t.partsTotalBeforeDiscount=0,this.charges.forEach(i=>{const r=i.serviceType;(i.cost||"0"===i.cost)&&(i.cost=parseFloat(i.cost)),(i.quantity||"0"===i.quantity)&&(i.quantity=parseFloat(i.quantity)),(i.total||"0"===i.total)&&(i.total=parseFloat(i.total)),t=this.validateLabourTypes(t,r,i,i.recipient)}),t.paintLabourHourSubTotal=t.paintLabourHourSubTotal/this.maxPoint,t.paintLabourAmountSubTotal=t.paintLabourAmountSubTotal/this.maxPoint,t.paintLabourSubTotal=t.paintLabourSubTotal/this.maxPoint,t.labourTotal=t.labourTotal/this.maxPoint,t.paintLabourTotal=t.paintLabourTotal/this.maxPoint,t.labourTimeHours=t.labourTimeHours/this.maxPoint,t.labourTotalBeforeDiscount=t.labourTotalBeforeDiscount/this.maxPoint,t.paintMaterialTotal=t.paintMaterialTotal/this.maxPoint,t.paintMaterialSubTotal=t.paintMaterialSubTotal/this.maxPoint,t.labourAmountSubTotal=t.labourAmountSubTotal/this.maxPoint,t.labourHourSubTotal=t.labourHourSubTotal/this.maxPoint,t.paintLabourAmountSubTotal=t.paintLabourAmountSubTotal/this.maxPoint,t.partsSubTotal=t.partsSubTotal/this.maxPoint,t.partsTotal=t.partsTotal/this.maxPoint,t.partsTotalBeforeDiscount=t.partsTotalBeforeDiscount/this.maxPoint,t}ngOnInit(){this.noDataFound=!0,this.commonService.isViewOnly&&(this.dropdownApprovalModelFilter=Object.assign(Object.assign({},this.dropdownApprovalModelFilter),{options:[{dropdownItemIconMaterial:"download-arrow",fontSize:"1.125rem",size:"25px",height:"1.125rem",value:"download",label:this.translationService.instant("download")}]})),this.getBookingRepairDetails(),this.commonService.reloadDetail.subscribe({next:t=>{t&&this.dataResponse.dueAmount&&t!==this.dataResponse.dueAmount&&this.getBookingRepairDetails()}})}ngAfterViewInit(){setTimeout(()=>{this.isInvoiceFormValid()})}expandCollapse(t){this.isAllExpanded=t,this.isPartsExpanded=t,this.isPaintExpanded=t,this.isLabourExpanded=t}hideShowSection(t){"part"===(null==t?void 0:t.toLowerCase())?this.isPartsExpanded=!this.isPartsExpanded:"labour"===(null==t?void 0:t.toLowerCase())?this.isLabourExpanded=!this.isLabourExpanded:this.isPaintExpanded=!this.isPaintExpanded}getSection(t){return"part"===(null==t?void 0:t.toLowerCase())?this.isPartsExpanded:"labour"===(null==t?void 0:t.toLowerCase())?this.isLabourExpanded:this.isPaintExpanded}downloadPDF(){var t;const i=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id"),r=this.dataResponse.invoiceGuid;let s;this.invoiceGUID=r,this.commonService.showLoading(),s=this.currentDueDate?{parameters:[{name:"dueDate",value:J(this.currentDueDate).format("YYYY-MM-DD")}]}:{parameters:[]},this.invoiceService.invoicePDF(i,r,s).subscribe({next:p=>{var u;const m=null===(u=null==p?void 0:p.data)||void 0===u?void 0:u.url;m&&window.open(m,"_top"),this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}saveInvoiceComponent(){this.dataResponse.contactNumber=this.dataResponse.code&&this.dataResponse.mobileNumber?this.dataResponse.code+this.dataResponse.mobileNumber:null;const t=Object.assign(Object.assign({},this.dataResponse),{ifscCode:this.dataResponse.ifscCode||null});this.commonService.showLoading(),this.invoiceService.saveInvoicePerDetail(t).subscribe({next:()=>{this.commonService.showInfoToast(1e3,"Invoice detail saved successfully"),this.currentDueDate=this.dataResponse.dueDate,this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}ngOnDestroy(){this.navigationEndSubscription.unsubscribe(),this.subs.forEach(t=>t.unsubscribe()),this.commonService.reloadDetail.unsubscribe()}openPaymentPopup(){var t;const i=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.dialog.open(vc,{data:Object.assign({repairId:i,isWorkProvider:this.isWorkProvider},this.dataResponse),width:"80vw",height:"80vh",panelClass:"payment-panel",autoFocus:!1}).afterClosed().subscribe({next:s=>{s!==this.dataResponse.dueAmount&&this.getBookingRepairDetails()}})}closeRepair(){"repairinprogress"!=this.repairStatus.toLowerCase()&&"approved"!=this.repairStatus.toLowerCase()?"complete"!=this.repairStatus.toLowerCase()?null!==this.pickupDate&&this.IsPickedup?this.setRepairClose():this.commonService.openConfirmYesNoDialog(this.translateService.instant("confirm_to_continue"),this.translateService.instant("is_the_vehicle_picked_up")).afterClosed().subscribe(i=>{this.openSchedulerPopUpForPickUp(i?"pickedUp":"schedule")}):this.commonService.showInfoToast(1e3,this.translateService.instant("repair_is_closed")):this.commonService.showInfoToast(1e3,this.translateService.instant("repair_stages_are_not_completed"))}setRepairClose(){this.commonService.openConfirmYesNoDialog(this.translateService.instant("confirm_closing_repair"),this.translateService.instant("repair_close_confirm_message")).afterClosed().subscribe(i=>{i&&this.setRepairCloseInner()})}setRepairCloseInner(){var t;this.commonService.showLoading(),this.subs.push(this.OutboundService.setRepairStatusComplete(null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id")).subscribe({next:i=>{var r;this.repairStatus="Complete";const s="text";this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{value:this.dataResponse.invoiceDate}),this.accountNumberInput=Object.assign(Object.assign({},this.accountNumberInput),{value:this.dataResponse.accountNumber,mode:s}),this.IfscCodeInput=Object.assign(Object.assign({},this.IfscCodeInput),{value:this.dataResponse.ifscCode,mode:s}),this.addressInput=Object.assign(Object.assign({},this.addressInput),{value:this.dataResponse.address,mode:s}),this.contactNumberInput=Object.assign(Object.assign({},this.contactNumberInput),{mode:s}),this.trnNumberInput=Object.assign(Object.assign({},this.trnNumberInput),{value:this.dataResponse.trn,mode:s}),this.payeeBankNameInput=Object.assign(Object.assign({},this.payeeBankNameInput),{value:this.dataResponse.bankname,mode:s}),this.payeeOrgNameInput=Object.assign(Object.assign({},this.payeeOrgNameInput),{value:this.dataResponse.workShopName,mode:s}),this.dueDate=Object.assign(Object.assign({},this.dueDate),{value:this.dataResponse.dueDate||new Date,mode:s}),this.phoneCode=Object.assign(Object.assign({},this.phoneCode),{mode:s});const p=null===(r=this.route.parent)||void 0===r?void 0:r.snapshot.paramMap.get("id");this.bookingService.getRepairDetailByGuid(p).subscribe({next:u=>{(null==u?void 0:u.data)&&(this.commonService.repairDetails.next(u.data),this.commonService.bookingId.next(u.data.repairNumber))},error:u=>{this.monitorServie.logException(u,je._.Error)}}),this.commonService.showInfoToast(1e3,i.message),this.commonService.hideLoading()},error:i=>{this.commonService.hideLoading()}}))}openSchedulerPopUpForPickUp(t){this.dialog.open(Bi,{data:{repairID:"",pickupDate:null===this.pickupDate?this.bookingOutDate:this.pickupDate,callSource:t},panelClass:"SchedulePickupDate-modalbox",autoFocus:!1}).afterClosed().subscribe({next:i=>{if(!i)return;const r=J.utc(i.PickUpDate.toString()).format("YYYY-MM-DDTHH:mm:ss.000")+"Z";this.setPickUpDateForRepair(r,t)}})}setPickUpDateForRepair(t,i){var r;this.commonService.showLoading(),this.subs.push(this.OutboundService.setPickupDate(null===(r=this.route.parent)||void 0===r?void 0:r.snapshot.paramMap.get("id"),t,"pickedUp"===i).subscribe({next:s=>{"pickedUp"===i&&(this.setRepairClose(),this.IsPickedup=!0),this.pickupDate=t,this.commonService.showInfoToast(1e3,s.message),this.commonService.hideLoading()},error:s=>{this.commonService.hideLoading()}}))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(He.v),e.Y36(Be.gz),e.Y36(Be.F0),e.Y36(Ye.uw),e.Y36(nr.p),e.Y36(we.sK),e.Y36(Yi.Q),e.Y36(Mo),e.Y36(on.q),e.Y36(we.sK),e.Y36(Ge.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-generate-invoices"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Gn,5),e.Gf(bc,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.print=r.first),e.iGM(r=e.CRH())&&(i.phone=r.first)}},features:[e._Bn([Yi.Q])],decls:19,vars:10,consts:[[1,"repair-invoice-wrapper"],[1,"invoice-back-btn"],[1,"no-border",3,"buttonModel"],[1,"status-pill-wrapper"],[1,"invoice-mode"],["class","btn-work",3,"ngClass","click",4,"ngIf"],["class","btn-driver",3,"ngClass","click",4,"ngIf"],[3,"class",4,"ngIf"],["class","generate-invoice-page-container","id","print-section",4,"ngIf"],["class","estimate-details-no-data-found",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["alt","addenda logo","src","assets/img/addenda-repair.png"],[1,"button-container"],["class","option-sender",3,"dropdownModel","selected",4,"ngIf"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel","click",4,"ngIf"],[1,"btn-work",3,"ngClass","click"],[1,"btn-driver",3,"ngClass","click"],["id","print-section",1,"generate-invoice-page-container"],[1,"repair-info"],[1,"repair-info-col-1"],[1,"org-image"],["alt","org logo",3,"src","load",4,"ngIf","ngIfElse"],["name",""],[3,"showLoading"],[1,"repair-detail"],[4,"ngIf"],[1,"repair-info-col-2"],[1,"col-6","invoice-date-input","outline",3,"ngClass","inputModel","controlOutput"],[1,"driver-fields-wrapper","col-6","invoice-date-input",3,"ngClass"],[1,"driver-field","driver-code-field","no-padding","outline",3,"ngClass","inputModel","controlOutput"],[1,"driver-field","no-padding","outline",3,"ngClass","inputModel","controlOutput"],["phone",""],["class","driver-field-content",3,"ngClass",4,"ngIf"],[1,"invoices-table-wrapper"],[1,"expand-collapse-btn","do-not-print"],[3,"click"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],["class","invoice-detail",4,"ngIf"],["alt","org logo",3,"src","load"],["class","org-name",4,"ngIf"],[1,"org-name"],[1,"col-6","invoice-date-input","outline",3,"inputModel","controlOutput"],[1,"col-6","invoice-date-input",3,"inputModel"],[1,"driver-field-content",3,"ngClass"],[1,"label-text"],[1,"driver-content-value"],[1,"table-parent"],[1,"expand-container",3,"click"],[1,"do-not-print"],[1,"small-heading"],["width","100%"],[4,"ngFor","ngForOf"],["align","right"],[1,"text-light"],["colspan","5"],[1,"invoice-detail"],[1,"invoice-col"],[1,"invoice-row","border-b"],[1,"invoice-row"],[1,"total-invoice-row"],[1,"total-invoice-row","no-border"],[1,"total-box"],["class","total-box",4,"ngIf"],[1,"estimate-details-no-data-found"],[1,"no-data-svg",3,"svgIcon"],[1,"no-data-text"],[1,"option-sender",3,"dropdownModel","selected"],[3,"buttonModel"],[3,"buttonModel","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"chq-button",2),e.qZA(),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.YNc(5,Cc,3,7,"button",5),e.YNc(6,Oc,3,7,"button",6),e.qZA(),e.YNc(7,Mc,3,6,"span",7),e.qZA(),e.YNc(8,Rc,34,52,"div",8),e.YNc(9,Ec,5,7,"div",9),e.TgZ(10,"div",10),e.TgZ(11,"div",11),e.TgZ(12,"div",12),e._UZ(13,"img",13),e.qZA(),e.qZA(),e.TgZ(14,"div",14),e.YNc(15,Fc,1,1,"chq-dropdown",15),e.YNc(16,rs,1,1,"chq-button",16),e.YNc(17,as,1,1,"chq-button",17),e.YNc(18,Nc,1,1,"chq-button",17),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("buttonModel",i.backButtonModel),e.xp6(3),e.Q6J("ngIf","retail"!==(null==i.currentWorkProvider?null:i.currentWorkProvider.toLowerCase())||"retail"===(null==i.currentWorkProvider?null:i.currentWorkProvider.toLowerCase())&&"person"!==(null==i.currentWorkProviderType?null:i.currentWorkProviderType.toLowerCase())),e.xp6(1),e.Q6J("ngIf","retail"!==(null==i.currentWorkProvider?null:i.currentWorkProvider.toLowerCase())||"retail"===(null==i.currentWorkProvider?null:i.currentWorkProvider.toLowerCase())&&"person"===(null==i.currentWorkProviderType?null:i.currentWorkProviderType.toLowerCase())),e.xp6(1),e.Q6J("ngIf",!i.noDataFound&&(null==i.dataResponse?null:i.dataResponse.invoiceAmount)>0),e.xp6(1),e.Q6J("ngIf",!i.isDataLoading&&!i.noDataFound),e.xp6(1),e.Q6J("ngIf",i.noDataFound&&!i.isDataLoading),e.xp6(6),e.Q6J("ngIf",!i.noDataFound),e.xp6(1),e.Q6J("ngIf",!i.noDataFound&&"paid"!==(null==i.dataResponse||null==i.dataResponse.paymentStatus?null:i.dataResponse.paymentStatus.toLowerCase())&&!i.commonService.isViewOnly&&"complete"!==i.repairStatus.toLowerCase()),e.xp6(1),e.Q6J("ngIf",!i.noDataFound&&(null==i.dataResponse?null:i.dataResponse.invoiceAmount)>0),e.xp6(1),e.Q6J("ngIf",!i.commonService.isViewOnly&&"complete"!==i.repairStatus.toLowerCase()))},directives:[yt.E,_.O5,_.mk,Tt.h,nn.D,_.sg,Xe.Hw,rr.I],pipes:[we.X$,_.Nd,_r,yo.j,is],styles:['.repair-invoice-wrapper[_ngcontent-%COMP%]{background-color:#dbdde2;height:calc(100% - 315px);padding-top:50px}.repair-invoice-wrapper[_ngcontent-%COMP%]     .invoice-back-btn{display:flex;margin-bottom:.75rem;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]     .invoice-back-btn chq-button button.button-outline{border:none!important}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]{display:flex;font-size:1rem;font-style:normal;font-weight:400}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .btn-work[_ngcontent-%COMP%]{background:transparent;border-radius:.5rem 0 0 .5rem;border:1px solid var(--xa-draft);box-shadow:0 1px 3px rgba(96,108,128,.05)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .btn-driver[_ngcontent-%COMP%]{border:1px solid var(--xa-draft);background:transparent;border-radius:0 .5rem .5rem 0}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   .invoice-mode[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background:#4c6bd2;color:#fff}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;font-size:.625rem;font-style:normal;font-weight:700;padding:.5875rem 1rem;border-radius:.625rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:var(--xa-white)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]{margin-top:2.4rem;display:flex;flex-direction:column;grid-gap:1rem;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;padding-left:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .generate-invoice-page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(rgba(26, 34, 51, .4));font-size:.75rem;font-style:normal;font-weight:600;line-height:.875rem;cursor:pointer}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{padding-right:calc(5px + 1.5vw);align-items:center;display:flex;grid-gap:1rem;gap:1rem;justify-content:flex-end}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}.repair-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .org-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5.58956rem;height:4.86131rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]{display:flex;grid-gap:.5rem;gap:.5rem;flex-direction:column}.repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:700}.repair-info[_ngcontent-%COMP%]   .repair-info-col-2[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem}.repair-info[_ngcontent-%COMP%]   .repair-info-col-2[_ngcontent-%COMP%]   chq-input.invoice-date-input[_ngcontent-%COMP%]{width:20.28494rem}.invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem;margin-bottom:1.5rem}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0 0;border-bottom:1px solid var(rgba(26, 34, 51, .1));background:#f1f2f6}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:12px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;background:#f1f2f6;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:#f1f2f6;font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}@media screen and (max-width: 864px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:105px;padding-top:5px;padding-bottom:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex-wrap:wrap}}@media screen and (max-width: 672px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:200px;padding-top:5px;padding-bottom:5px}}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-red[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-green[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-yellow[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}  chq-input.outline div.input-wrapper:not(.text-mode) input, [_nghost-%COMP%]     .dropdown{outline:1px solid var(--xa-tab-background)}  chq-input.outline div.input-wrapper.text-mode .dropdown{outline:none}  chq-input.outline div.input-wrapper.text-mode input{border:0px!important}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:white;margin:30px;justify-content:center;min-height:calc(100vh - 385px - (5px + 1.5vw + 48px + 1.6vw));border-radius:12px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:"Inter";font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}.all-border[_ngcontent-%COMP%]{border-radius:.5rem!important}.invoice-detail[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:3.43rem;gap:3.43rem;padding:10px;border-radius:.625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.0625rem;gap:1.0625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-weight:700}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:.8125rem;font-style:normal;font-weight:600}.invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.no-border[_ngcontent-%COMP%]{border:none!important}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-dp-light-gray)!important}.options-btn-container[_ngcontent-%COMP%]{position:relative}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]{position:absolute;bottom:45px;left:-5px;display:flex;align-items:stretch;padding:.625rem;flex-direction:column;grid-gap:.625rem;gap:.625rem;border-radius:.625rem;background:#fff}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;border:none;box-shadow:none!important;justify-content:flex-start;padding:.425rem .75rem;font-size:1rem;font-weight:400;display:flex;grid-gap:.5rem;gap:.5rem;cursor:pointer;-webkit-user-select:none;user-select:none}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.options-btn-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:1px solid var(--xa-light-gray)}.driver-field-content[_ngcontent-%COMP%]{display:none}@media print{.driver-field[_ngcontent-%COMP%]{display:none}  chq-input.outline div.input-wrapper .dropdown{outline:none}.driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;grid-gap:10px;gap:10px;height:34px}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}}.text-check[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{display:none}.text-mode.driver-field-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.text-mode.driver-field-content[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{font-size:12px;color:var(--xa-dark-gray);text-transform:uppercase}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:end;grid-gap:10px;gap:10px;height:34px}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background-color:#1b03a3;border-radius:4px;height:26px;width:26px;text-align:center;margin-right:5px;display:block;align-self:end}.text-mode.driver-field-content[_ngcontent-%COMP%]   .driver-content-value[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]     svg{width:15px}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}.options-btn[_ngcontent-%COMP%]   .options-ico[_ngcontent-%COMP%]{font-size:.79638rem;width:.79638rem}.driver-fields-wrapper[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{flex:1 1 120px;padding:0 10px;width:120px}@media (max-width: 850px){.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field[_ngcontent-%COMP%]{padding:0 6px}}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.no-padding[_ngcontent-%COMP%]{padding:0}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.driver-code-field[_ngcontent-%COMP%]{min-width:120px;max-width:120px;padding:0 10px 0 0}.driver-fields-wrapper[_ngcontent-%COMP%]   .driver-field.basis-272[_ngcontent-%COMP%]{flex-basis:272px}']}),a})();function vr(a,c){if(1&a&&(e.TgZ(0,"h5"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,null==t?null:t.title))}}function Gi(a,c){if(1&a&&(e.TgZ(0,"tr",21),e.TgZ(1,"td",22),e.TgZ(2,"h6",15),e._uU(3),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(3),e.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}const _t=function(a,c,t,i,r){return[a,c,t,i,r]};function Uc(a,c){if(1&a&&(e.TgZ(0,"tbody"),e.YNc(1,Gi,4,1,"tr",20),e.TgZ(2,"tr"),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.ALo(7,"xaCurrency"),e.qZA(),e.TgZ(8,"td",17),e._uU(9),e.ALo(10,"xaCurrency"),e.qZA(),e.qZA(),e.qZA()),2&a){const t=c.$implicit,i=c.index,r=e.oxw().$implicit,s=e.oxw(2).$implicit,p=e.oxw();e.xp6(1),e.Q6J("ngIf","Paint"===r.key.toString()&&(0===i||i>0&&t.serviceSubType!==s.invoiceList[r.key.toString()][i-1].serviceSubType)),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.hij(" ",e.G7q(7,4,e.qbA(16,_t,t.cost,p.i18n.currencySymbol,p.i18n.digitsInfo,p.i18n.locale,p.i18n.position))," "),e.xp6(3),e.hij(" ",e.G7q(10,10,e.qbA(22,_t,t.total,p.i18n.currencySymbol,p.i18n.digitsInfo,p.i18n.locale,p.i18n.position))," ")}}function ss(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"subtotal")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,_t,t.partsSubTotal,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)))}}function Jc(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"sundry_parts")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,_t,t.sundryParts,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)))}}function hn(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"total_before_discount")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,_t,t.partsTotalBeforeDiscount,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)))}}function br(a,c){if(1&a&&(e.TgZ(0,"div",26),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"discount_on_parts")),e.xp6(3),e.hij("",t.partsTotalDiscountPercentage,"%")}}function zn(a,c){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,ss,7,16,"div",23),e.YNc(2,Jc,7,16,"div",23),e.YNc(3,hn,7,16,"div",23),e.YNc(4,br,6,4,"div",24),e.qZA()),2&a){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showParts),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showParts),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showParts),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showParts)}}function Ut(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"paint_labour_time")),e.xp6(3),e.hij("",t.paintLabourTimeHour,"hrs")}}function Bc(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"paint_labour_subtotal")),e.xp6(3),e.hij(" ",e.G7q(6,4,e.qbA(10,_t,t.paintLabourHourSubTotal,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)),"")}}function ls(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"paint_labour_discount")),e.xp6(3),e.hij("",t.paintLabourDiscountPercentage,"%")}}function cs(a,c){if(1&a&&(e.TgZ(0,"div",29),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"labour_total")),e.xp6(3),e.hij(" ",e.G7q(6,4,e.qbA(10,_t,t.paintLabourTotal,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)),"")}}function Hi(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"material_subtotal")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,_t,t.paintMaterialSubTotal,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)))}}function In(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"material_discount")),e.xp6(3),e.hij("",t.paintMateriaDiscountPercentage,"%")}}function ds(a,c){if(1&a&&(e.TgZ(0,"div",30),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"material_total")),e.xp6(3),e.Oqu(e.G7q(6,4,e.qbA(10,_t,t.paintMaterialTotal,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)))}}function Yc(a,c){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,Ut,6,4,"div",23),e.YNc(2,Bc,7,16,"div",23),e.YNc(3,ls,6,4,"div",23),e.YNc(4,cs,7,16,"div",27),e.YNc(5,Hi,7,16,"div",23),e.YNc(6,In,6,4,"div",23),e.YNc(7,ds,7,16,"div",28),e.qZA()),2&a){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showPaint)}}function wo(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"xaCurrency"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"labour_amount_subtotal")),e.xp6(3),e.hij(" ",e.G7q(6,4,e.qbA(10,_t,t.labourHourSubTotal,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)),"")}}function Gc(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"labour_hours")),e.xp6(3),e.hij("",t.labourTimeHours," hrs")}}function ps(a,c){if(1&a&&(e.TgZ(0,"div",25),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"number"),e.qZA(),e.qZA()),2&a){const t=e.oxw(4).$implicit,i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"labour_discount")),e.xp6(3),e.hij("",e.Dn7(6,4,t.labourTotalDiscountPercentage,i.digitInfo,i.locale),"%")}}function lt(a,c){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,wo,7,16,"div",23),e.YNc(2,Gc,6,4,"div",23),e.YNc(3,ps,7,8,"div",23),e.qZA()),2&a){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showLabour),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showLabour),e.xp6(1),e.Q6J("ngIf",t.summaryDialogData.showLabour)}}function Cr(a,c){if(1&a&&(e.TgZ(0,"div",13),e.TgZ(1,"span",14),e.TgZ(2,"h6",15),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.ynx(5),e.TgZ(6,"table",16),e.TgZ(7,"thead"),e.TgZ(8,"tr"),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"td",17),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(18,Uc,11,28,"tbody",18),e.ALo(19,"orderBy"),e.qZA(),e.YNc(20,zn,5,4,"div",8),e.YNc(21,Yc,8,7,"div",8),e.YNc(22,lt,4,3,"div",8),e.TgZ(23,"table",16),e.TgZ(24,"tfoot"),e.TgZ(25,"tr"),e.TgZ(26,"td"),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"td",19),e._uU(30),e.ALo(31,"xaCurrency"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk(),e.qZA()),2&a){const t=c.$implicit,i=e.oxw(2).$implicit,r=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,12,t.key.toString().toLowerCase())),e.xp6(7),e.Oqu(e.lcZ(11,14,"description")),e.xp6(3),e.AsE("",e.lcZ(14,16,"price_unit"),"(",r.currencySymbol,")"),e.xp6(3),e.AsE("",e.lcZ(17,18,"total_price"),"(",r.currencySymbol,")"),e.xp6(2),e.Q6J("ngForOf",e.Dn7(19,20,i.invoiceList[t.key.toString()],"serviceSubtype","asc")),e.xp6(2),e.Q6J("ngIf","Part"===t.key.toString()),e.xp6(1),e.Q6J("ngIf","Paint"===t.key.toString()),e.xp6(1),e.Q6J("ngIf","Labour"===t.key.toString()),e.xp6(5),e.Oqu(e.lcZ(28,24,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),e.xp6(3),e.hij(" ",e.G7q(31,26,e.qbA(32,_t,"Paint"===t.key.toString()?i.paintLabourTotal+i.paintMaterialTotal:"Labour"===t.key.toString()?i.labourTotal:i.partsTotal,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," ")}}function us(a,c){if(1&a&&(e.TgZ(0,"div",10),e.YNc(1,Cr,32,38,"div",11),e.ALo(2,"keyvalue"),e.TgZ(3,"div",12),e.TgZ(4,"span"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"span"),e._uU(8),e.ALo(9,"xaCurrency"),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw().$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,3,t.invoiceList,i.valueAscOrder)),e.xp6(4),e.Oqu(e.lcZ(6,6,"total_cost")),e.xp6(3),e.Oqu(e.G7q(9,8,e.qbA(14,_t,t.paintLabourTotal+t.paintMaterialTotal+t.labourTotal+t.partsTotal,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position)))}}const rn=function(a){return{"full-flex":a}};function Or(a,c){if(1&a&&(e.TgZ(0,"div",7),e.YNc(1,vr,3,3,"h5",8),e.YNc(2,us,10,20,"div",9),e.qZA()),2&a){const t=c.$implicit,i=e.oxw();e.Q6J("ngClass",e.VKq(3,rn,1===(null==i.summaryDialogData.summaryData?null:i.summaryDialogData.summaryData.length))),e.xp6(1),e.Q6J("ngIf",null==t?null:t.title),e.xp6(1),e.Q6J("ngIf",null==t?null:t.title)}}let To=(()=>{class a{constructor(t,i,r){this.summaryDialogData=t,this.commonService=i,this.dialogRef=r,this.digitInfo="",this.locale="",this.currencySymbol="",this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}valueAscOrder(t,i){var r,s;const p={part:"1",labour:"2",paint:"3"};return p[null===(r=t.key)||void 0===r?void 0:r.toLowerCase()].localeCompare(p[null===(s=i.key)||void 0===s?void 0:s.toLowerCase()])}onClose(){this.dialogRef.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ye.WI),e.Y36(He.v),e.Y36(Ye.so))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-invoice-summary"]],decls:10,vars:5,consts:[[1,"invoice-wrapper"],[1,"summary-container"],[1,"invoice-title"],[1,"close-icon"],[1,"cross",3,"svgIcon","click"],[1,"invoice-detail"],["class","invoice-col",3,"ngClass",4,"ngFor","ngForOf"],[1,"invoice-col",3,"ngClass"],[4,"ngIf"],["class","invoices-table-container",4,"ngIf"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],[1,"total-box"],[1,"table-parent"],[1,"expand-container"],[1,"small-heading"],["width","100%"],[1,"last-td"],[4,"ngFor","ngForOf"],["align","right"],["class","sub-heading",4,"ngIf"],[1,"sub-heading"],["colspan","5"],["class","invoice-row border-b",4,"ngIf"],["class","invoice-row",4,"ngIf"],[1,"invoice-row","border-b"],[1,"invoice-row"],["class","total-invoice-row no-border total-border",4,"ngIf"],["class","total-invoice-row no-border",4,"ngIf"],[1,"total-invoice-row","no-border","total-border"],[1,"total-invoice-row","no-border"]],template:function(t,i){1&t&&(e.TgZ(0,"section",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"h3"),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",3),e.TgZ(7,"mat-icon",4),e.NdJ("click",function(){return i.onClose()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",5),e.YNc(9,Or,3,5,"div",6),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,3,"invoices_summary")),e.xp6(3),e.Q6J("svgIcon","cross"),e.xp6(2),e.Q6J("ngForOf",i.summaryDialogData.summaryData))},directives:[Xe.Hw,_.sg,_.mk,_.O5],pipes:[we.X$,_.Nd,yo.j,_r,_.JJ],styles:['.invoice-wrapper[_ngcontent-%COMP%]{min-height:100%;padding:1.88rem;background-color:#f1f2f6}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]{display:flex;grid-gap:2.1rem;gap:2.1rem;flex-direction:column;padding:.625rem}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;padding:.625rem;align-items:flex-start;border-radius:14.25rem;background:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f1f2f6;font-size:20px;width:20px;height:20px}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]{display:flex;padding:inherit;grid-gap:10px;gap:10px;border-radius:.625rem;background:var(--xa-white);max-width:100%;overflow-x:auto}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0;flex-basis:50%}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:inherit;padding:10px}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:600}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:14px;line-height:16px;font-weight:500;color:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-size:14px;line-height:16px;font-weight:400;color:var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:500}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:inherit;margin:0;font-size:.875rem;font-style:normal;font-weight:600}.invoice-wrapper[_ngcontent-%COMP%]   .summary-container[_ngcontent-%COMP%]   .invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-dp-light-gray)}.close-icon[_ngcontent-%COMP%]{border-radius:50%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:6px;background:var(--xa-black);width:36px;height:36px}.close-icon[_ngcontent-%COMP%]   .cross[_ngcontent-%COMP%]{height:24px!important;width:24px!important;cursor:pointer;fill:var(--xa-white)!important}.full-flex[_ngcontent-%COMP%]{flex-basis:100%!important}.invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem;margin-bottom:1.5rem}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0 0;border-bottom:1px solid var(rgba(26, 34, 51, .1))}.invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px!important;line-height:14px!important;font-style:normal;font-weight:500!important}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:16px!important;line-height:20px!important;font-weight:400!important;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500!important;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray);font-size:10px;font-weight:500}.invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700!important;font-size:16px!important;border-bottom:4px solid var(--xa-white)}@media screen and (max-width: 864px){  .payer-radio-btn.outline div.input-wrapper .radio{flex-direction:column}}@media screen and (max-width: 864px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:105px;padding-top:5px;padding-bottom:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex-wrap:wrap}}@media screen and (max-width: 672px){.repair-invoice-wrapper[_ngcontent-%COMP%]   .footer-full-wrapper[_ngcontent-%COMP%]{height:200px;padding-top:5px;padding-bottom:5px}}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-red[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-green[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-yellow[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}  chq-input.outline div.input-wrapper:not(.text-mode) input{outline:1px solid black}  chq-input.outline div.input-wrapper.text-mode input{border:0px!important}.small-heading[_ngcontent-%COMP%]{font-size:14px!important;line-height:16px!important;font-weight:500!important}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:white;margin:30px;justify-content:center;min-height:calc(100vh - 385px - (5px + 1.5vw + 48px + 1.6vw));border-radius:12px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:"Inter";font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}.all-border[_ngcontent-%COMP%]{border-radius:.5rem!important}.invoice-detail[_ngcontent-%COMP%]{display:flex;flex-direction:row;grid-gap:10px;gap:10px;padding:0;border-radius:.625rem}.invoice-detail[_ngcontent-%COMP%]   .invoice-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]{padding:.625rem;display:flex;justify-content:space-between;border-bottom:1px solid var(--xa-black);border-top:1px solid var(--xa-black)}.invoice-detail[_ngcontent-%COMP%]   .total-invoice-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.75rem;font-style:normal;font-weight:500}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]{padding:.625rem;background-color:#f1f2f6;display:flex;justify-content:space-between}.invoice-detail[_ngcontent-%COMP%]   .total-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-style:normal;font-weight:700}.invoice-detail[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:.8125rem;font-style:normal;font-weight:600}.invoice-detail[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin:0;font-size:.75rem;font-style:normal;font-weight:500}.no-border[_ngcontent-%COMP%]{border:none!important}.last-td[_ngcontent-%COMP%]{text-align:end}.sub-heading[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray)}.total-border[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black)!important;border-bottom:1px solid var(--xa-black)!important}.border-b[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-lighter-gray)}.options-btn-container[_ngcontent-%COMP%]{position:relative}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]{position:absolute;bottom:45px;left:-5px;display:flex;align-items:stretch;padding:.625rem;flex-direction:column;grid-gap:.625rem;gap:.625rem;border-radius:.625rem;background:#fff}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:0;border:none;box-shadow:none!important;justify-content:flex-start;padding:.425rem .75rem;font-size:1rem;font-weight:400;display:flex;grid-gap:.5rem;gap:.5rem;cursor:pointer;-webkit-user-select:none;user-select:none}.options-btn-container[_ngcontent-%COMP%]   .options-list[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1.125rem;width:1.125rem;height:1.125rem}.options-btn-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:transparent;border:1px solid var(--xa-light-gray)}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}']}),a})();var Qn=Z(87636),ut=Z(14581),vt=Z(32085),Mr=Z(62728),zc=Z(65857),Qc=Z(5490),xr=Z(22241),Vc=Z.n(xr);const Pi=new e.OlP("SMOOTH_SCROLL_OPTIONS");let Pr=(()=>{class a{constructor(t,i,r){this._document=t,this._platform=i,this._onGoingScrolls=new Map,this._defaultOptions=Object.assign({duration:468,easing:{x1:.42,y1:0,x2:.58,y2:1}},r)}get _w(){return this._document.defaultView}get _now(){return this._w.performance&&this._w.performance.now?this._w.performance.now.bind(this._w.performance):Date.now}_scrollElement(t,i,r){t.scrollLeft=i,t.scrollTop=r}_getElement(t,i){return"string"==typeof t?(i||this._document).querySelector(t):(0,ce.fI)(t)}_initSmoothScroll(t){return this._onGoingScrolls.has(t)&&this._onGoingScrolls.get(t).next(),this._onGoingScrolls.set(t,new le.x).get(t)}_isFinished(t,i,r){return t.currentX!==t.x||t.currentY!==t.y||(i.next(),r(),!1)}_interrupted(t,i){return(0,V.T)((0,ut.R)(t,"wheel",{passive:!0,capture:!0}),(0,ut.R)(t,"touchmove",{passive:!0,capture:!0}),i).pipe((0,mt.q)(1))}_destroy(t,i){i.complete(),this._onGoingScrolls.delete(t)}_step(t){return new pe.y(i=>{let r=(this._now()-t.startTime)/t.duration;r=r>1?1:r;const s=t.easing(r);t.currentX=t.startX+(t.x-t.startX)*s,t.currentY=t.startY+(t.y-t.startY)*s,this._scrollElement(t.scrollable,t.currentX,t.currentY),ot.Z.schedule(()=>i.next(t))})}_applyScrollToOptions(t,i){if(!i.duration)return this._scrollElement(t,i.left,i.top),Promise.resolve();const r=this._initSmoothScroll(t),s={scrollable:t,startTime:this._now(),startX:t.scrollLeft,startY:t.scrollTop,x:null==i.left?t.scrollLeft:~~i.left,y:null==i.top?t.scrollTop:~~i.top,duration:i.duration,easing:Vc()(i.easing.x1,i.easing.y1,i.easing.x2,i.easing.y2)};return new Promise(p=>{(0,Wt.of)(null).pipe(function(a,c=1/0,t){return c=(c||0)<1?1/0:c,(0,vt.e)((i,r)=>(0,Mr.p)(i,r,a,c,void 0,!0,t))}(()=>this._step(s).pipe((0,zc.o)(u=>this._isFinished(u,r,p)))),(0,W.R)(this._interrupted(t,r)),(0,Qc.x)(()=>this._destroy(t,r))).subscribe()})}scrollTo(t,i){if((0,_.NF)(this._platform)){const r=this._getElement(t),s="rtl"===getComputedStyle(r).direction,p=(0,Ce._i)(),u=Object.assign(Object.assign(Object.assign({},this._defaultOptions),i),{left:null==i.left?s?i.end:i.start:i.left,right:null==i.right?s?i.start:i.end:i.right});return null!=u.bottom&&(u.top=r.scrollHeight-r.clientHeight-u.bottom),s&&0!==p?(null!=u.left&&(u.right=r.scrollWidth-r.clientWidth-u.left),2===p?u.left=u.right:1===p&&(u.left=u.right?-u.right:u.right)):null!=u.right&&(u.left=r.scrollWidth-r.clientWidth-u.right),this._applyScrollToOptions(r,u)}return Promise.resolve()}scrollToElement(t,i,r={}){const s=this._getElement(t),p=this._getElement(i,s),u=Object.assign(Object.assign({},r),{left:p.offsetLeft+(r.left||0),top:p.offsetTop+(r.top||0)});return p?this.scrollTo(s,u):Promise.resolve()}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(_.K0),e.LFG(e.Lbi),e.LFG(Pi,8))},a.\u0275prov=e.Yz7({factory:function(){return new a(e.LFG(_.K0),e.LFG(e.Lbi),e.LFG(Pi,8))},token:a,providedIn:"root"}),a})(),Wc=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({}),a})();var zi=Z(9018);function Do(...a){const c=a.length;if(0===c)throw new Error("list of properties cannot be empty.");return(0,fe.U)(t=>{let i=t;for(let r=0;r<c;r++){const s=null==i?void 0:i[a[r]];if(void 0===s)return;i=s}return i})}var $c=Z(79034),yr=Z(74970),hs=Z(68048),gs=Z(83151),wr=Z(42147),Kc=Z(65619);const ms=["scrollbarY"],Tr=["scrollbarX"];function Xc(a,c){if(1&a&&e._UZ(0,"scrollbar-x",null,4),2&a){const t=e.oxw(2);e.uIk("scrollable",t.state.isHorizontallyScrollable)("fit",t.state.verticalUsed)}}function Dr(a,c){if(1&a&&e._UZ(0,"scrollbar-y",null,5),2&a){const t=e.oxw(2);e.uIk("scrollable",t.state.isVerticallyScrollable)("fit",t.state.horizontalUsed)}}function fs(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Xc,2,2,"scrollbar-x",3),e.YNc(2,Dr,2,2,"scrollbar-y",3),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.state.horizontalUsed),e.xp6(1),e.Q6J("ngIf",t.state.verticalUsed)}}const _s=["*"];function Sr(a){return(0,ie.b)(()=>{a.onselectstart=()=>!1})}function Qi(a){return(0,ie.b)(()=>{a.onselectstart=null})}function An(){return(0,ie.b)(a=>a.stopPropagation())}function So(a,c){return a.clientX>=c.left&&a.clientX<=c.left+c.width&&a.clientY>=c.top&&a.clientY<=c.top+c.height}let Io=(()=>{class a{constructor(t){this.viewPort=t,this.nativeElement=t.nativeElement}get clientHeight(){return this.nativeElement.clientHeight}get clientWidth(){return this.nativeElement.clientWidth}get scrollHeight(){return this.nativeElement.scrollHeight}get scrollWidth(){return this.nativeElement.scrollWidth}get scrollTop(){return this.nativeElement.scrollTop}get scrollLeft(){return this.nativeElement.scrollLeft}get scrollMaxX(){return this.scrollWidth-this.clientWidth}get scrollMaxY(){return this.scrollHeight-this.clientHeight}get contentHeight(){var t;return(null===(t=this.contentWrapperElement)||void 0===t?void 0:t.clientHeight)||0}get contentWidth(){var t;return(null===(t=this.contentWrapperElement)||void 0===t?void 0:t.clientWidth)||0}activatePointerEvents(t,i){this.hovered=new pe.y(r=>{const s=(0,ut.R)(this.nativeElement,"mousemove",{passive:!0}),p=t?s:s.pipe(An()),u=(0,ut.R)(this.nativeElement,"mouseleave").pipe((0,fe.U)(()=>!1));(0,V.T)(p,u).pipe((0,ie.b)(m=>r.next(m)),(0,W.R)(i)).subscribe()}),this.clicked=new pe.y(r=>{const s=(0,ut.R)(this.nativeElement,"mousedown",{passive:!0}).pipe((0,ie.b)(u=>r.next(u))),p=(0,ut.R)(this.nativeElement,"mouseup",{passive:!0}).pipe((0,ie.b)(()=>r.next(!1)));s.pipe((0,ye.w)(()=>p),(0,W.R)(i)).subscribe()})}setAsWrapper(){this.nativeElement.className="ng-native-scrollbar-hider ng-scroll-layer",this.nativeElement.firstElementChild&&(this.nativeElement.firstElementChild.className="ng-scroll-layer")}setAsViewport(t){this.nativeElement.className=`ng-native-scrollbar-hider ng-scroll-viewport ${t}`,this.nativeElement.firstElementChild&&(this.contentWrapperElement=this.nativeElement.firstElementChild,this.contentWrapperElement.classList.add("ng-scroll-content"))}scrollYTo(t){this.nativeElement.scrollTop=t}scrollXTo(t){this.nativeElement.scrollLeft=t}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollViewport",""]]}),a})();const Ir=new e.OlP("NG_SCROLLBAR_OPTIONS"),Ar={viewClass:"",trackClass:"",thumbClass:"",track:"vertical",appearance:"compact",visibility:"native",position:"native",pointerEventsMethod:"viewport",trackClickScrollDuration:300,minThumbSize:20,windowResizeDebounce:0,sensorDebounce:0,scrollAuditTime:0,viewportPropagateMouseMove:!0,autoHeightDisabled:!0,autoWidthDisabled:!0,sensorDisabled:!1,pointerEventsDisabled:!1};let Zr=(()=>{class a{constructor(t){this.globalOptions=t?Object.assign(Object.assign({},Ar),t):Ar,this.rtlScrollAxisType=(0,Ce._i)()}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(Ir,8))},a.\u0275prov=e.Yz7({factory:function(){return new a(e.LFG(Ir,8))},token:a,providedIn:"root"}),a})(),kt=(()=>{class a{constructor(t,i,r,s,p,u){this.el=t,this.zone=i,this.changeDetectorRef=r,this.dir=s,this.smoothScroll=p,this.manager=u,this._disabled=!1,this._sensorDisabled=this.manager.globalOptions.sensorDisabled,this._pointerEventsDisabled=this.manager.globalOptions.pointerEventsDisabled,this._autoHeightDisabled=this.manager.globalOptions.autoHeightDisabled,this._autoWidthDisabled=this.manager.globalOptions.autoWidthDisabled,this._viewportPropagateMouseMove=this.manager.globalOptions.viewportPropagateMouseMove,this.viewClass=this.manager.globalOptions.viewClass,this.trackClass=this.manager.globalOptions.trackClass,this.thumbClass=this.manager.globalOptions.thumbClass,this.minThumbSize=this.manager.globalOptions.minThumbSize,this.trackClickScrollDuration=this.manager.globalOptions.trackClickScrollDuration,this.pointerEventsMethod=this.manager.globalOptions.pointerEventsMethod,this.track=this.manager.globalOptions.track,this.visibility=this.manager.globalOptions.visibility,this.appearance=this.manager.globalOptions.appearance,this.position=this.manager.globalOptions.position,this.sensorDebounce=this.manager.globalOptions.sensorDebounce,this.scrollAuditTime=this.manager.globalOptions.scrollAuditTime,this.updated=new e.vpe,this.state={},this.destroyed=new le.x}get disabled(){return this._disabled}set disabled(t){this._disabled=(0,ce.Ig)(t)}get sensorDisabled(){return this._sensorDisabled}set sensorDisabled(t){this._sensorDisabled=(0,ce.Ig)(t)}get pointerEventsDisabled(){return this._pointerEventsDisabled}set pointerEventsDisabled(t){this._pointerEventsDisabled=(0,ce.Ig)(t)}get viewportPropagateMouseMove(){return this._viewportPropagateMouseMove}set viewportPropagateMouseMove(t){this._viewportPropagateMouseMove=(0,ce.Ig)(t)}get autoHeightDisabled(){return this._autoHeightDisabled}set autoHeightDisabled(t){this._autoHeightDisabled=(0,ce.Ig)(t)}get autoWidthDisabled(){return this._autoWidthDisabled}set autoWidthDisabled(t){this._autoWidthDisabled=(0,ce.Ig)(t)}get nativeElement(){return this.el.nativeElement}updateState(){let t=!1,i=!1,r=!1,s=!1;("all"===this.track||"vertical"===this.track)&&(r=this.viewport.scrollHeight>this.viewport.clientHeight,t="always"===this.visibility||r),("all"===this.track||"horizontal"===this.track)&&(s=this.viewport.scrollWidth>this.viewport.clientWidth,i="always"===this.visibility||s),this.setState({position:this.position,track:this.track,appearance:this.appearance,visibility:this.visibility,deactivated:this.disabled,dir:this.dir.value,pointerEventsMethod:this.pointerEventsMethod,verticalUsed:t,horizontalUsed:i,isVerticallyScrollable:r,isHorizontallyScrollable:s})}setState(t){this.state=Object.assign(Object.assign({},this.state),t),this.changeDetectorRef.detectChanges()}getScrolledByDirection(t){let i;return this.scrolled.pipe((0,ie.b)(r=>i=r),Do("target",t),(0,$c.G)(),(0,yr.h)(([r,s])=>r!==s),(0,fe.U)(()=>i))}setHovered(t){this.zone.run(()=>this.setState(Object.assign({},t)))}setDragging(t){this.zone.run(()=>this.setState(Object.assign({},t)))}setClicked(t){this.zone.run(()=>this.setState({scrollbarClicked:t}))}ngOnInit(){this.zone.runOutsideAngular(()=>{this.customViewPort?(this.viewport=this.customViewPort,this.defaultViewPort.setAsWrapper()):this.viewport=this.defaultViewPort,this.viewport.setAsViewport(this.viewClass);let t=(0,ut.R)(this.viewport.nativeElement,"scroll",{passive:!0});t=this.scrollAuditTime?t.pipe((0,hs.e)(this.scrollAuditTime)):t,this.scrolled=t.pipe((0,W.R)(this.destroyed)),this.verticalScrolled=this.getScrolledByDirection("scrollTop"),this.horizontalScrolled=this.getScrolledByDirection("scrollLeft")})}ngOnChanges(t){this.viewport&&this.update()}ngAfterViewInit(){this.update(),this.dir.change.pipe((0,ie.b)(()=>this.update()),(0,W.R)(this.destroyed)).subscribe()}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}update(){this.autoHeightDisabled||this.updateHeight(),this.autoWidthDisabled||this.updateWidth(),this.updateState(),this.updated.next()}scrollTo(t){return this.smoothScroll.scrollTo(this.viewport.nativeElement,t)}scrollToElement(t,i){return this.smoothScroll.scrollToElement(this.viewport.nativeElement,t,i)}updateHeight(){this.nativeElement.style.height="standard"===this.appearance&&this.scrollbarX?`${this.viewport.contentHeight+this.scrollbarX.nativeElement.clientHeight}px`:`${this.viewport.contentHeight}px`}updateWidth(){this.nativeElement.style.width="standard"===this.appearance&&this.scrollbarY?`${this.viewport.contentWidth+this.scrollbarY.nativeElement.clientWidth}px`:`${this.viewport.contentWidth}px`}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(e.R0b),e.Y36(e.sBO),e.Y36(Ke.Is),e.Y36(Pr),e.Y36(Zr))},a.\u0275cmp=e.Xpm({type:a,selectors:[["ng-scrollbar"]],contentQueries:function(t,i,r){if(1&t&&e.Suo(r,Io,7),2&t){let s;e.iGM(s=e.CRH())&&(i.customViewPort=s.first)}},viewQuery:function(t,i){if(1&t&&(e.Gf(ms,5,e.SBq),e.Gf(Tr,5,e.SBq),e.Gf(Io,7)),2&t){let r;e.iGM(r=e.CRH())&&(i.scrollbarY=r.first),e.iGM(r=e.CRH())&&(i.scrollbarX=r.first),e.iGM(r=e.CRH())&&(i.defaultViewPort=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&e.ekj("ng-scrollbar",!0)},inputs:{viewClass:"viewClass",trackClass:"trackClass",thumbClass:"thumbClass",minThumbSize:"minThumbSize",trackClickScrollDuration:"trackClickScrollDuration",pointerEventsMethod:"pointerEventsMethod",track:"track",visibility:"visibility",appearance:"appearance",position:"position",sensorDebounce:"sensorDebounce",scrollAuditTime:"scrollAuditTime",disabled:"disabled",sensorDisabled:"sensorDisabled",pointerEventsDisabled:"pointerEventsDisabled",viewportPropagateMouseMove:"viewportPropagateMouseMove",autoHeightDisabled:"autoHeightDisabled",autoWidthDisabled:"autoWidthDisabled"},outputs:{updated:"updated"},exportAs:["ngScrollbar"],features:[e.TTD],ngContentSelectors:_s,decls:6,vars:4,consts:[[1,"ng-scrollbar-wrapper",3,"ngAttr"],[1,"ng-scroll-viewport-wrapper",3,"sensorDebounce","sensorDisabled","resizeSensor"],["scrollViewport","","hideNativeScrollbar",""],[4,"ngIf"],["scrollbarX",""],["scrollbarY",""]],template:function(t,i){1&t&&(e.F$t(),e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.NdJ("resizeSensor",function(){return i.update()}),e.TgZ(2,"div",2),e.TgZ(3,"div"),e.Hsn(4),e.qZA(),e.qZA(),e.qZA(),e.YNc(5,fs,3,2,"ng-container",3),e.qZA()),2&t&&(e.Q6J("ngAttr",i.state),e.xp6(1),e.Q6J("sensorDebounce",i.sensorDebounce)("sensorDisabled",i.sensorDisabled),e.xp6(4),e.Q6J("ngIf",!i.disabled))},directives:function(){return[ed,qr,Io,kr,_.O5,Lr,Zo]},styles:[".ng-scrollbar-measure{scrollbar-width:none;-ms-overflow-style:none}  .ng-scrollbar-measure::-webkit-scrollbar{display:none}[_nghost-%COMP%]{--scrollbar-border-radius:7px;--scrollbar-padding:4px;--scrollbar-track-color:transparent;--scrollbar-thumb-color:rgba(0,0,0,0.2);--scrollbar-thumb-hover-color:var(--scrollbar-thumb-color);--scrollbar-size:5px;--scrollbar-hover-size:var(--scrollbar-size);--scrollbar-overscroll-behavior:initial;--scrollbar-transition-duration:400ms;--scrollbar-transition-delay:800ms;--scrollbar-thumb-transition:height ease-out 150ms,width ease-out 150ms;--scrollbar-track-transition:height ease-out 150ms,width ease-out 150ms;display:block;position:relative;height:100%;max-height:100%;max-width:100%;box-sizing:content-box!important}[_nghost-%COMP%] > .ng-scrollbar-wrapper[_ngcontent-%COMP%]{--scrollbar-total-size:calc(var(--scrollbar-size) + var(--scrollbar-padding) * 2);--vertical-scrollbar-size:var(--scrollbar-size);--horizontal-scrollbar-size:var(--scrollbar-size);--vertical-scrollbar-total-size:calc(var(--vertical-scrollbar-size) + var(--scrollbar-padding) * 2);--horizontal-scrollbar-total-size:calc(var(--horizontal-scrollbar-size) + var(--scrollbar-padding) * 2)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalDragging=true][_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalHovered=true][_ngcontent-%COMP%]{--vertical-scrollbar-size:var(--scrollbar-hover-size);--vertical-scrollbar-total-size:calc(var(--vertical-scrollbar-size) + var(--scrollbar-padding) * 2);cursor:default}[_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalDragging=true][_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalHovered=true][_ngcontent-%COMP%]{--horizontal-scrollbar-size:var(--scrollbar-hover-size);--horizontal-scrollbar-total-size:calc(var(--horizontal-scrollbar-size) + var(--scrollbar-padding) * 2);cursor:default}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:0;right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:var(--scrollbar-total-size);right:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-left:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:var(--scrollbar-total-size);right:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=ltr][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-left:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{left:0;right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertAll][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][verticalUsed=true][position=invertY][dir=rtl][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-right:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{top:0;bottom:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-bottom:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=scrollbar][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{top:var(--scrollbar-total-size);bottom:0}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertAll][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][appearance=standard][horizontalUsed=true][position=invertX][pointerEventsMethod=viewport][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{padding-top:var(--scrollbar-total-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport::-webkit-scrollbar, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-native-scrollbar-hider, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%]{bottom:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-native-scrollbar-hider, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%]{left:0;right:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][dir=rtl][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-native-scrollbar-hider, [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][verticalUsed=true][dir=rtl][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-native-scrollbar-hider[_ngcontent-%COMP%]{right:0;left:var(--native-scrollbar-size)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%] > .scrollbar-control[_ngcontent-%COMP%]{opacity:0;transition-property:opacity;transition-duration:var(--scrollbar-transition-duration);transition-delay:var(--scrollbar-transition-delay)}[_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:active > .scrollbar-control[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:focus > .scrollbar-control[_ngcontent-%COMP%], [_nghost-%COMP%] > .ng-scrollbar-wrapper[deactivated=false][visibility=hover][_ngcontent-%COMP%]:hover > .scrollbar-control[_ngcontent-%COMP%]{opacity:1;transition-duration:var(--scrollbar-transition-duration);transition-delay:0ms}[_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}[_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] >  .ng-scroll-viewport, [_nghost-%COMP%] > .ng-scrollbar-wrapper[verticalUsed=true][horizontalUsed=true][_ngcontent-%COMP%] > .ng-scroll-viewport-wrapper[_ngcontent-%COMP%] > .ng-scroll-viewport[_ngcontent-%COMP%]{overflow:auto}.ng-scroll-viewport-wrapper[_ngcontent-%COMP%]{overflow:hidden}.ng-scroll-viewport[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch;contain:strict;will-change:scroll-position;overscroll-behavior:var(--scrollbar-overscroll-behavior)}  .ng-scroll-content{position:relative!important;display:inline-block;min-width:100%}.ng-scroll-layer[_ngcontent-%COMP%], .ng-scroll-viewport-wrapper[_ngcontent-%COMP%], .ng-scrollbar-wrapper[_ngcontent-%COMP%],   .ng-scroll-viewport{position:absolute;left:0;right:0;top:0;bottom:0}",".ng-scrollbar-wrapper[pointerEventsMethod=viewport]>.scrollbar-control{pointer-events:none}  .ng-scrollbar-wrapper[horizontalDragging=true]>.ng-scroll-viewport-wrapper>*>*> .ng-scroll-viewport,   .ng-scrollbar-wrapper[horizontalDragging=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport,   .ng-scrollbar-wrapper[scrollbarClicked=true]>.ng-scroll-viewport-wrapper>*>*> .ng-scroll-viewport,   .ng-scrollbar-wrapper[scrollbarClicked=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport,   .ng-scrollbar-wrapper[verticalDragging=true]>.ng-scroll-viewport-wrapper>*>*> .ng-scroll-viewport,   .ng-scrollbar-wrapper[verticalDragging=true]>.ng-scroll-viewport-wrapper>.ng-scroll-viewport{-webkit-user-select:none;-moz-user-select:none;user-select:none}  .ng-scrollbar-wrapper>.scrollbar-control{position:absolute;display:flex;justify-content:center;align-items:center;transition:var(--scrollbar-track-transition)}  .ng-scrollbar-wrapper>.scrollbar-control[scrollable=false] .ng-scrollbar-thumb{display:none}  .ng-scrollbar-track{height:100%;width:100%;z-index:1;border-radius:var(--scrollbar-border-radius);background-color:var(--scrollbar-track-color);overflow:hidden;transition:var(--scrollbar-track-transition);cursor:default}  .ng-scrollbar-thumb{box-sizing:border-box;position:relative;border-radius:inherit;background-color:var(--scrollbar-thumb-color);transform:translateZ(0);transition:var(--scrollbar-thumb-transition)}"],changeDetection:0}),a})(),vs=(()=>{class a{constructor(t,i,r){this.document=t,this.manager=i,this.platform=r,this._scrollbarSize=new Vt.X(this.getNativeScrollbarSize()),this.scrollbarSize=this._scrollbarSize.asObservable(),r.isBrowser&&(0,ut.R)(this.document.defaultView,"resize",{passive:!0}).pipe((0,gs.b)(this.manager.globalOptions.windowResizeDebounce),(0,fe.U)(()=>this.getNativeScrollbarSize()),(0,wr.x)(),(0,ie.b)(s=>this._scrollbarSize.next(s))).subscribe()}getNativeScrollbarSize(){if(!this.platform.isBrowser)return 0;if(this.platform.IOS)return 6;const t=this.document.createElement("div");t.className="ng-scrollbar-measure",t.style.left=0,t.style.overflow="scroll",t.style.position="fixed",t.style.top="-9999px",this.document.body.appendChild(t);const i=t.getBoundingClientRect().right;return this.document.body.removeChild(t),i}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(_.K0),e.LFG(Zr),e.LFG(Ce.t4))},a.\u0275prov=e.Yz7({factory:function(){return new a(e.LFG(_.K0),e.LFG(Zr),e.LFG(Ce.t4))},token:a,providedIn:"root"}),a})(),kr=(()=>{class a{constructor(t,i,r){this.renderer=i,this.hideNativeScrollbar=r,this._subscriber=Mt.w0.EMPTY,this._subscriber=r.scrollbarSize.subscribe(s=>{this.renderer.setStyle(t.nativeElement,"--native-scrollbar-size",`-${s}px`,e.JOm.DashCase)})}ngOnDestroy(){this._subscriber.unsubscribe()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(vs))},a.\u0275dir=e.lG2({type:a,selectors:[["","hideNativeScrollbar",""]]}),a})(),ed=(()=>{class a{constructor(t){this.el=t}set ngAttr(t){for(const[i,r]of Object.entries(t))this.el.nativeElement.setAttribute(i,r)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq))},a.\u0275dir=e.lG2({type:a,selectors:[["","ngAttr",""]],inputs:{ngAttr:"ngAttr"}}),a})(),qr=(()=>{class a{constructor(t,i,r){if(this.zone=t,this.platform=i,this.scrollbar=r,this._disabled=!1,this._currentSubscription=null,this.event=new e.vpe,!r)throw new Error("[NgScrollbar Resize Sensor Directive]: Host element must be an NgScrollbar component.")}get debounce(){return this._debounce}set debounce(t){this._debounce=(0,ce.su)(t),this._subscribe()}get disabled(){return this._disabled}set disabled(t){this._disabled=(0,ce.Ig)(t),this._disabled?this._unsubscribe():this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this._disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){if(this._unsubscribe(),this.platform.isBrowser){const t=new pe.y(i=>{this._resizeObserver=new ResizeObserver(r=>i.next(r)),this._resizeObserver.observe(this.scrollbar.viewport.nativeElement),this.scrollbar.viewport.contentWrapperElement&&this._resizeObserver.observe(this.scrollbar.viewport.contentWrapperElement)});this.zone.runOutsideAngular(()=>{this._currentSubscription=(this._debounce?t.pipe((0,gs.b)(this._debounce)):t).subscribe(this.event)})}}_unsubscribe(){var t,i;null===(t=this._resizeObserver)||void 0===t||t.disconnect(),null===(i=this._currentSubscription)||void 0===i||i.unsubscribe()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.R0b),e.Y36(Ce.t4),e.Y36(kt))},a.\u0275dir=e.lG2({type:a,selectors:[["","resizeSensor",""]],inputs:{debounce:["sensorDebounce","debounce"],disabled:["sensorDisabled","disabled"]},outputs:{event:"resizeSensor"}}),a})(),ae=(()=>{class a{constructor(t,i,r){this.cmp=t,this.trackElement=i,this.document=r}get clicked(){const t=(0,ut.R)(this.trackElement,"mousedown",{passive:!0}).pipe(An(),Sr(this.document)),i=(0,ut.R)(this.document,"mouseup",{passive:!0}).pipe(An(),Qi(this.document),(0,ye.w)(()=>zi.E));return(0,V.T)(t,i)}get clientRect(){return this.trackElement.getBoundingClientRect()}onTrackClicked(t,i,r){return(0,Wt.of)(t).pipe(Do(this.pageProperty),(0,fe.U)(s=>(s-this.offset-i/2)/this.size*r),(0,ie.b)(s=>{this.cmp.scrollTo(Object.assign(Object.assign({},this.mapToScrollToOption(s)),{duration:(0,ce.su)(this.cmp.trackClickScrollDuration)}))}))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(kt),e.Y36(HTMLElement),e.Y36(void 0))},a.\u0275dir=e.lG2({type:a}),a})(),bs=(()=>{class a{constructor(t,i,r,s){this.cmp=t,this.track=i,this.thumbElement=r,this.document=s,this._dragging=new le.x,this.dragging=this._dragging.pipe((0,wr.x)())}get trackMax(){return this.track.size-this.size}get clientRect(){return this.thumbElement.getBoundingClientRect()}get clicked(){return(0,ut.R)(this.thumbElement,"mousedown",{passive:!0}).pipe(An())}update(){const t=function(a,c,t){return Math.max(~~(a/c*a),t)}(this.track.size,this.viewportScrollSize,this.cmp.minThumbSize),i=function(a,c,t){return a*t/c}(this.viewportScrollOffset,this.viewportScrollMax,this.trackMax);ot.Z.schedule(()=>this.updateStyles(this.handleDirection(i,this.trackMax),t))}dragged(t){let i,r;const s=(0,Wt.of)(t).pipe(Sr(this.document),(0,ie.b)(()=>{i=this.trackMax,r=this.viewportScrollMax,this.setDragging(!0)})),p=(0,ut.R)(this.document,"mousemove",{capture:!0,passive:!0}).pipe(An()),u=(0,ut.R)(this.document,"mouseup",{capture:!0}).pipe(An(),Qi(this.document),(0,ie.b)(()=>this.setDragging(!1)));return s.pipe(Do(this.pageProperty),(0,fe.U)(m=>m-this.dragStartOffset),(0,Kc.z)(m=>p.pipe(Do(this.clientProperty),(0,fe.U)(C=>C-this.track.offset),(0,fe.U)(C=>r*(C-m)/i),(0,fe.U)(C=>this.handleDrag(C,r)),(0,ie.b)(C=>this.scrollTo(C)),(0,W.R)(u))))}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(kt),e.Y36(ae),e.Y36(HTMLElement),e.Y36(void 0))},a.\u0275dir=e.lG2({type:a,outputs:{dragging:"dragging"}}),a})(),Ao=(()=>{class a extends ae{constructor(t,i,r){super(t,i.nativeElement,r),this.cmp=t,this.document=r}get pageProperty(){return"pageX"}get offset(){return this.clientRect.left}get size(){return this.trackElement.clientWidth}mapToScrollToOption(t){return{left:t}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(kt),e.Y36(e.SBq),e.Y36(_.K0))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollbarTrackX",""]],features:[e.qOj]}),a})(),Rr=(()=>{class a extends ae{constructor(t,i,r){super(t,i.nativeElement,r),this.cmp=t,this.document=r}get pageProperty(){return"pageY"}get offset(){return this.clientRect.top}get size(){return this.trackElement.clientHeight}mapToScrollToOption(t){return{top:t}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(kt),e.Y36(e.SBq),e.Y36(_.K0))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollbarTrackY",""]],features:[e.qOj]}),a})(),Cs=(()=>{class a extends bs{constructor(t,i,r,s,p){super(t,i,r.nativeElement,s),this.cmp=t,this.track=i,this.element=r,this.document=s,this.dir=p}get clientProperty(){return"clientX"}get pageProperty(){return"pageX"}get viewportScrollSize(){return this.cmp.viewport.scrollWidth}get viewportScrollOffset(){return this.cmp.viewport.scrollLeft}get viewportScrollMax(){return this.cmp.viewport.scrollMaxX}get dragStartOffset(){return this.clientRect.left+this.document.defaultView.pageXOffset||0}get size(){return this.thumbElement.clientWidth}updateStyles(t,i){this.thumbElement.style.width=`${i}px`,this.thumbElement.style.transform=`translate3d(${t}px, 0, 0)`}handleDrag(t,i){if("rtl"===this.dir.value){if(1===this.cmp.manager.rtlScrollAxisType)return t-i;if(2===this.cmp.manager.rtlScrollAxisType)return i-t}return t}handleDirection(t,i){if("rtl"===this.dir.value){if(2===this.cmp.manager.rtlScrollAxisType)return-t;if(0===this.cmp.manager.rtlScrollAxisType)return t-i}return t}setDragging(t){this.cmp.setDragging({horizontalDragging:t})}scrollTo(t){this.cmp.viewport.scrollXTo(t)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(kt),e.Y36(Ao),e.Y36(e.SBq),e.Y36(_.K0),e.Y36(Ke.Is))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollbarThumbX",""]],features:[e.qOj]}),a})(),qt=(()=>{class a extends bs{constructor(t,i,r,s){super(t,i,r.nativeElement,s),this.cmp=t,this.track=i,this.element=r,this.document=s}get pageProperty(){return"pageY"}get viewportScrollSize(){return this.cmp.viewport.scrollHeight}get viewportScrollOffset(){return this.cmp.viewport.scrollTop}get viewportScrollMax(){return this.cmp.viewport.scrollMaxY}get clientProperty(){return"clientY"}get dragStartOffset(){return this.clientRect.top+this.document.defaultView.pageYOffset||0}get size(){return this.thumbElement.clientHeight}updateStyles(t,i){this.thumbElement.style.height=`${i}px`,this.thumbElement.style.transform=`translate3d(0px, ${t}px, 0)`}handleDrag(t){return t}handleDirection(t){return t}setDragging(t){this.cmp.setDragging({verticalDragging:t})}scrollTo(t){this.cmp.viewport.scrollYTo(t)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(kt),e.Y36(Rr),e.Y36(e.SBq),e.Y36(_.K0))},a.\u0275dir=e.lG2({type:a,selectors:[["","scrollbarThumbY",""]],features:[e.qOj]}),a})(),Os=(()=>{class a{constructor(t,i,r,s,p){this.el=t,this.cmp=i,this.platform=r,this.document=s,this.zone=p,this.destroyed=new le.x}activatePointerEvents(){let t,i,r;return"viewport"===this.cmp.pointerEventsMethod?(this.viewportTrackClicked=new le.x,this.viewportThumbClicked=new le.x,this.cmp.viewport.activatePointerEvents(this.cmp.viewportPropagateMouseMove,this.destroyed),t=this.viewportThumbClicked,i=this.viewportTrackClicked,r=this.cmp.viewport.hovered.pipe((0,fe.U)(s=>So(s,this.el.getBoundingClientRect())),(0,wr.x)(),(0,ie.b)(s=>this.document.onselectstart=s?()=>!1:null)),this.cmp.viewport.clicked.pipe((0,ie.b)(s=>{s?So(s,this.thumb.clientRect)?this.viewportThumbClicked.next(s):So(s,this.track.clientRect)&&(this.cmp.setClicked(!0),this.viewportTrackClicked.next(s)):this.cmp.setClicked(!1)}),(0,W.R)(this.destroyed)).subscribe()):(t=this.thumb.clicked,i=this.track.clicked,r=this.hovered),(0,V.T)(r.pipe((0,ie.b)(s=>this.setHovered(s))),t.pipe((0,ye.w)(s=>this.thumb.dragged(s))),i.pipe((0,ye.w)(s=>this.track.onTrackClicked(s,this.thumb.size,this.viewportScrollSize))))}get hovered(){const t=(0,ut.R)(this.el,"mouseenter",{passive:!0}).pipe(An(),(0,fe.U)(()=>!0)),i=(0,ut.R)(this.el,"mouseleave",{passive:!0}).pipe(An(),(0,fe.U)(()=>!1));return(0,V.T)(t,i)}ngOnInit(){this.zone.runOutsideAngular(()=>{!(this.platform.IOS||this.platform.ANDROID)&&!this.cmp.pointerEventsDisabled&&this.activatePointerEvents().pipe((0,W.R)(this.destroyed)).subscribe(),(0,V.T)(this.cmp.scrolled,this.cmp.updated).pipe((0,ie.b)(()=>{var t;return null===(t=this.thumb)||void 0===t?void 0:t.update()}),(0,W.R)(this.destroyed)).subscribe()})}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete(),this.viewportThumbClicked&&this.viewportTrackClicked&&(this.viewportTrackClicked.complete(),this.viewportThumbClicked.complete())}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(HTMLElement),e.Y36(kt),e.Y36(Ce.t4),e.Y36(void 0),e.Y36(e.R0b))},a.\u0275dir=e.lG2({type:a}),a})(),Zo=(()=>{class a extends Os{constructor(t,i,r,s,p){super(t.nativeElement,i,r,s,p),this.cmp=i,this.platform=r,this.document=s,this.zone=p}get viewportScrollSize(){return this.cmp.viewport.scrollHeight}setHovered(t){this.cmp.setHovered({verticalHovered:t})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(kt),e.Y36(Ce.t4),e.Y36(_.K0),e.Y36(e.R0b))},a.\u0275cmp=e.Xpm({type:a,selectors:[["scrollbar-y"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Rr,7),e.Gf(qt,7)),2&t){let r;e.iGM(r=e.CRH())&&(i.track=r.first),e.iGM(r=e.CRH())&&(i.thumb=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&e.ekj("scrollbar-control",!0)},features:[e.qOj],decls:2,vars:6,consts:[["scrollbarTrackY",""],["scrollbarThumbY",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.qZA()),2&t&&(e.Gre("ng-scrollbar-track ",i.cmp.trackClass,""),e.xp6(1),e.Gre("ng-scrollbar-thumb ",i.cmp.thumbClass,""))},directives:[Rr,qt],styles:[".ng-scrollbar-wrapper>scrollbar-y.scrollbar-control{width:var(--vertical-scrollbar-total-size)}  .ng-scrollbar-wrapper>scrollbar-y.scrollbar-control>.ng-scrollbar-track{width:var(--vertical-scrollbar-size);height:calc(100% - var(--scrollbar-padding) * 2)}  .ng-scrollbar-wrapper>scrollbar-y.scrollbar-control>.ng-scrollbar-track>.ng-scrollbar-thumb{height:0;width:100%}  .ng-scrollbar-wrapper[verticalDragging=true]>scrollbar-y.scrollbar-control .ng-scrollbar-thumb,   .ng-scrollbar-wrapper[verticalHovered=true]>scrollbar-y.scrollbar-control .ng-scrollbar-thumb{background-color:var(--scrollbar-thumb-hover-color)}  .ng-scrollbar-wrapper[deactivated=false]>scrollbar-y.scrollbar-control{top:0;bottom:0}  .ng-scrollbar-wrapper[deactivated=false][dir=ltr]>scrollbar-y.scrollbar-control{right:0;left:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=ltr][position=invertAll]>scrollbar-y.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][dir=ltr][position=invertY]>scrollbar-y.scrollbar-control{left:0;right:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=rtl]>scrollbar-y.scrollbar-control{left:0;right:unset}  .ng-scrollbar-wrapper[deactivated=false][dir=rtl][position=invertAll]>scrollbar-y.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][dir=rtl][position=invertY]>scrollbar-y.scrollbar-control{left:unset;right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all]>scrollbar-y.scrollbar-control[fit=true]{bottom:var(--scrollbar-total-size);top:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][position=invertAll]>scrollbar-y.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][position=invertX]>scrollbar-y.scrollbar-control[fit=true]{top:var(--scrollbar-total-size);bottom:0}"],changeDetection:0}),a})(),Lr=(()=>{class a extends Os{constructor(t,i,r,s,p){super(t.nativeElement,i,r,s,p),this.cmp=i,this.platform=r,this.document=s,this.zone=p}get viewportScrollSize(){return this.cmp.viewport.scrollWidth}setHovered(t){this.cmp.setHovered({horizontalHovered:t})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.SBq),e.Y36(kt),e.Y36(Ce.t4),e.Y36(_.K0),e.Y36(e.R0b))},a.\u0275cmp=e.Xpm({type:a,selectors:[["scrollbar-x"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Ao,7),e.Gf(Cs,7)),2&t){let r;e.iGM(r=e.CRH())&&(i.track=r.first),e.iGM(r=e.CRH())&&(i.thumb=r.first)}},hostVars:2,hostBindings:function(t,i){2&t&&e.ekj("scrollbar-control",!0)},features:[e.qOj],decls:2,vars:6,consts:[["scrollbarTrackX",""],["scrollbarThumbX",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"div",1),e.qZA()),2&t&&(e.Gre("ng-scrollbar-track ",i.cmp.trackClass,""),e.xp6(1),e.Gre("ng-scrollbar-thumb ",i.cmp.thumbClass,""))},directives:[Ao,Cs],styles:[".ng-scrollbar-wrapper>scrollbar-x.scrollbar-control{height:var(--horizontal-scrollbar-total-size)}  .ng-scrollbar-wrapper>scrollbar-x.scrollbar-control>.ng-scrollbar-track{height:var(--horizontal-scrollbar-size);width:calc(100% - var(--scrollbar-padding) * 2)}  .ng-scrollbar-wrapper>scrollbar-x.scrollbar-control>.ng-scrollbar-track>.ng-scrollbar-thumb{width:0;height:100%}  .ng-scrollbar-wrapper[horizontalDragging=true]>scrollbar-x.scrollbar-control .ng-scrollbar-thumb,   .ng-scrollbar-wrapper[horizontalHovered=true]>scrollbar-x.scrollbar-control .ng-scrollbar-thumb{background-color:var(--scrollbar-thumb-hover-color)}  .ng-scrollbar-wrapper[position=invertAll]>scrollbar-x.scrollbar-control,   .ng-scrollbar-wrapper[position=invertX]>scrollbar-x.scrollbar-control{top:0;bottom:unset}  .ng-scrollbar-wrapper[deactivated=false]>scrollbar-x.scrollbar-control{left:0;right:0;bottom:0;top:unset}  .ng-scrollbar-wrapper[deactivated=false][position=invertAll]>scrollbar-x.scrollbar-control,   .ng-scrollbar-wrapper[deactivated=false][position=invertX]>scrollbar-x.scrollbar-control{top:0;bottom:unset}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr]>scrollbar-x.scrollbar-control[fit=true]{right:var(--scrollbar-total-size);left:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr][position=invertAll]>scrollbar-x.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][dir=ltr][position=invertY]>scrollbar-x.scrollbar-control[fit=true]{left:var(--scrollbar-total-size);right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl]>scrollbar-x.scrollbar-control[fit=true]{left:var(--scrollbar-total-size);right:0}  .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl][position=invertAll]>scrollbar-x.scrollbar-control[fit=true],   .ng-scrollbar-wrapper[deactivated=false][track=all][dir=rtl][position=invertY]>scrollbar-x.scrollbar-control[fit=true]{right:var(--scrollbar-total-size);left:0}"],changeDetection:0}),a})(),Er=(()=>{class a{static withConfig(t){return{ngModule:a,providers:[{provide:Ir,useValue:t}]}}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[_.ez,Ke.vT,Qn.eL,Ce.ud,Wc]]}),a})();function Ms(a,c){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a){const t=e.oxw(2);e.Gre("status-pill status-",null==t.paymentStatus?null:t.paymentStatus.replace(" ","").toLowerCase(),""),e.xp6(1),e.Oqu(e.lcZ(2,4,t.paymentStatusMapper[null==t.paymentStatus?null:t.paymentStatus.toLowerCase()]))}}function Rt(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"img",26),e.NdJ("load",function(){return e.CHM(t),e.oxw(2).orgImageLoading=!1}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("src",t.orgLogoUrl,e.LSH)}}function Zn(a,c){if(1&a&&(e.TgZ(0,"label",28),e._uU(1),e.qZA()),2&a){const t=e.oxw(3);e.xp6(1),e.Oqu(t.orgName)}}function Fr(a,c){if(1&a&&e.YNc(0,Zn,2,1,"label",27),2&a){const t=e.oxw(2);e.Q6J("ngIf",t.orgName)}}function xs(a,c){if(1&a&&(e.TgZ(0,"tr"),e.TgZ(1,"td",44),e.TgZ(2,"h6",31),e._uU(3),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(3),e.Oqu("PaintLabour"===(null==t?null:t.serviceSubType)?"Paint Labour":"Paint Material")}}function ko(a,c){if(1&a&&(e.TgZ(0,"span",45),e._uU(1),e.qZA()),2&a){const t=e.oxw(5);e.xp6(1),e.hij(" ","person"===(null==t.currentWorkProviderType?null:t.currentWorkProviderType.toLowerCase())?t.customerValue:t.workProviderValue," ")}}function Ps(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",46),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw().$implicit,p=e.oxw(4);return s.recipient=r.value===p.workProviderValue?1:2,p.isAllocationChanged()}),e.qZA()}if(2&a){const t=e.oxw().index,i=e.oxw(2).$implicit,r=e.oxw(2);e.Q6J("inputModel",r.radioList[i.key][t])}}const Wi=function(a,c,t,i,r){return[a,c,t,i,r]},ys=function(a){return{"provide-td":a}};function Nr(a,c){if(1&a&&(e.TgZ(0,"tbody"),e.YNc(1,xs,4,1,"tr",39),e.TgZ(2,"tr"),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",40),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"xaCurrency"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.ALo(14,"xaCurrency"),e.qZA(),e.TgZ(15,"td",41),e.YNc(16,ko,2,1,"span",42),e.YNc(17,Ps,1,1,"chq-input",43),e.qZA(),e.qZA(),e.qZA()),2&a){const t=c.$implicit,i=c.index,r=e.oxw(2).$implicit,s=e.oxw(2);e.xp6(1),e.Q6J("ngIf","Paint"===r.key&&(0===i||i>0&&t.serviceSubType!==s.invoiceList[r.key][i-1].serviceSubType)),e.xp6(3),e.Oqu(t.description),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.hij(" ",e.G7q(11,9,e.qbA(21,Wi,t.cost,s.i18n.currencySymbol,s.i18n.digitsInfo,s.i18n.locale,s.i18n.position))," "),e.xp6(3),e.hij(" ",e.G7q(14,15,e.qbA(27,Wi,t.total,s.i18n.currencySymbol,s.i18n.digitsInfo,s.i18n.locale,s.i18n.position))," "),e.xp6(2),e.Q6J("ngClass",e.VKq(33,ys,"retail"===(null==s.currentWorkProvider?null:s.currentWorkProvider.toLowerCase()))),e.xp6(1),e.Q6J("ngIf","retail"===(null==s.currentWorkProvider?null:s.currentWorkProvider.toLowerCase())),e.xp6(1),e.Q6J("ngIf","retail"!==(null==s.currentWorkProvider?null:s.currentWorkProvider.toLowerCase()))}}function jr(a,c){if(1&a&&(e.TgZ(0,"ng-scrollbar",33),e.TgZ(1,"table",34),e.TgZ(2,"thead"),e.TgZ(3,"tr"),e.TgZ(4,"td"),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"td"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"td",35),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.qZA(),e.qZA(),e.YNc(22,Nr,18,35,"tbody",36),e.ALo(23,"orderBy"),e.TgZ(24,"tfoot"),e.TgZ(25,"tr"),e.TgZ(26,"td",37),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"td",38),e._uU(30),e.ALo(31,"xaCurrency"),e.ALo(32,"sum"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw().$implicit,i=e.oxw(2);e.Q6J("disabled",!i.isiOS)("track","horizontal")("autoHeightDisabled",!1),e.xp6(5),e.Oqu(e.lcZ(6,14,"description")),e.xp6(3),e.Oqu(e.lcZ(9,16,"code")),e.xp6(3),e.Oqu(e.lcZ(12,18,"units")),e.xp6(3),e.AsE("",e.lcZ(15,20,"price_unit"),"(",i.currencySymbol,")"),e.xp6(3),e.AsE("",e.lcZ(18,22,"total_price"),"(",i.currencySymbol,")"),e.xp6(3),e.Oqu(e.lcZ(21,24,"payer")),e.xp6(2),e.Q6J("ngForOf",e.Dn7(23,26,i.invoiceList[t.key],"serviceSubtype","asc")),e.xp6(5),e.Oqu(e.lcZ(28,30,"Paint"===t.key.toString()?"total_paint_cost":"Labour"===t.key.toString()?"total_labour_cost":"total_parts_cost")),e.xp6(3),e.hij(" ",e.G7q(31,32,e.qbA(41,Wi,e.xi3(32,38,i.invoiceList[t.key],"total"),i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))," ")}}function kn(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",29),e.TgZ(1,"span",30),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).hideShowSection(s.key)}),e.TgZ(2,"mat-icon"),e._uU(3),e.qZA(),e.TgZ(4,"h6",31),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.qZA(),e.YNc(7,jr,33,47,"ng-scrollbar",32),e.qZA()}if(2&a){const t=c.$implicit,i=e.oxw(2);e.xp6(3),e.Oqu(i.getSection(t.key)?"keyboard_arrow_up":"keyboard_arrow_down"),e.xp6(2),e.Oqu(e.lcZ(6,3,null==t.key?null:t.key.toLowerCase())),e.xp6(2),e.Q6J("ngIf",i.getSection(t.key))}}function nd(a,c){if(1&a&&e._UZ(0,"chq-button",47),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.previewButtonModel)}}function qn(a,c){if(1&a&&e._UZ(0,"chq-button",47),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.saveButtonModel)}}function ws(a,c){if(1&a&&e._UZ(0,"chq-button",47),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.generateInvoiceButtonModel)}}function Ts(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"div",2),e.YNc(2,Ms,3,6,"span",3),e.ALo(3,"sum"),e.qZA(),e.TgZ(4,"div",4),e.TgZ(5,"section",5),e.TgZ(6,"div",6),e.TgZ(7,"div",7),e.YNc(8,Rt,1,1,"img",8),e.YNc(9,Fr,1,1,"ng-template",null,9,e.W1O),e._UZ(11,"chq-customloader",10),e.qZA(),e.TgZ(12,"div",11),e.TgZ(13,"h4"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"h5"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"h5"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"h5"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(25,"div",12),e.TgZ(26,"chq-input",13,14),e.NdJ("controlOutput",function(r){e.CHM(t);const s=e.oxw();return s.invoiceIssuedDate.value=r.value||null,s.isAllocationChanged()}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"section",15),e.TgZ(29,"div",16),e.TgZ(30,"span",17),e.NdJ("click",function(){return e.CHM(t),e.oxw().expandCollapse(!0)}),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"span",17),e.NdJ("click",function(){return e.CHM(t),e.oxw().expandCollapse(!1)}),e._uU(34),e.ALo(35,"translate"),e.qZA(),e.qZA(),e.TgZ(36,"div",18),e.YNc(37,kn,8,5,"div",19),e.ALo(38,"keyvalue"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(39,"div",20),e.TgZ(40,"div",21),e.TgZ(41,"div",22),e._UZ(42,"img",23),e.qZA(),e.qZA(),e.TgZ(43,"div",24),e.YNc(44,nd,1,1,"chq-button",25),e.YNc(45,qn,1,1,"chq-button",25),e.YNc(46,ws,1,1,"chq-button",25),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=e.MAs(10),i=e.oxw();e.xp6(2),e.Q6J("ngIf",e.xi3(3,23,i.charges,"total")>0),e.xp6(6),e.Q6J("ngIf",i.orgLogoUrl)("ngIfElse",t),e.xp6(3),e.Q6J("showLoading",i.orgImageLoading),e.xp6(3),e.AsE("",e.lcZ(15,26,"repair_id"),": ",i.repairId,""),e.xp6(3),e.AsE("",e.lcZ(18,28,"make"),": ",i.make,""),e.xp6(3),e.AsE("",e.lcZ(21,30,"model"),": ",i.model,""),e.xp6(3),e.AsE("",e.lcZ(24,32,"license_plate"),": ",i.licensePlate,""),e.xp6(3),e.Q6J("inputModel",i.invoiceIssuedDate),e.xp6(4),e.ekj("secondary-color",i.isAllExpanded),e.xp6(1),e.Oqu(e.lcZ(32,34,"expand_all")),e.xp6(2),e.ekj("secondary-color",!i.isAllExpanded),e.xp6(1),e.hij("",e.lcZ(35,36,"collapse_all")," "),e.xp6(3),e.Q6J("ngForOf",e.xi3(38,38,i.invoiceList,i.valueAscOrder)),e.xp6(7),e.Q6J("ngIf","retail"!==(null==i.currentWorkProvider?null:i.currentWorkProvider.toLowerCase())),e.xp6(1),e.Q6J("ngIf","readytoinvoice"!==i.status.toLowerCase()&&!i.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf","readytoinvoice"===i.status.toLowerCase()||!i.commonService.isViewOnly)}}let Ur=(()=>{class a{constructor(t,i,r,s,p,u,m){this.commonService=t,this.invoiceService=i,this.bookingService=r,this.monitorServie=s,this.dialog=p,this.router=u,this.route=m,this.digitInfo="",this.locale="",this.repairId="",this.make="",this.maxPoint=1e7,this.model="",this.status="",this.licensePlate="",this.currencySymbol="",this.caseGuid="",this.orgImageLoading=!0,this.orgLogoUrl="",this.orgName="",this.paymentStatus="",this.isAllExpanded=!0,this.isPartsExpanded=!0,this.isLabourExpanded=!0,this.isPaintExpanded=!0,this.workProviderValue="",this.customerValue="",this.partsCost=[{description:"Rear left wing w/ sill panel - Section M",code:"A35492315",units:"2",cost:"500",total:"1500"}],this.totalPartsCost=0,this.currentChangesString="",this.totalPaintCost=0,this.hasPaint=!1,this.hasParts=!1,this.hasLabour=!1,this.repairStatus="",this.paintCost=[],this.invoiceList={},this.isDataLoading=!0,this.radioList={},this.summary={},this.charges=[],this.currentWorkProvider="",this.currentWorkProviderType="",this.currentDate=new Date,this.invoiceIssuedDate={placeHolder:"Select Date",label:"INVOICE DATE",name:"issuedDate",value:this.currentDate,maxDate:this.currentDate,minDate:J().subtract(1,"year").toDate(),type:"date",required:!1,disabled:!1,mode:"date"},this.radioButtonList=[],this.previewButtonModel={label:"Preview",type:"outline",onclick:()=>this.previewInvoiceSummary()},this.saveButtonModel={label:"Save",type:"disabled-outline",onclick:()=>{this.updateEstimateCharge()}},this.paymentStatusMapper={unpaid:"Unpaid",partialpaid:"Partially Paid",paid:"Paid"},this.hashPropTable={},this.generateInvoiceButtonModel={label:"Generate Invoice",icon:"invoices",type:"primary",onclick:()=>{this.goToGenerateInvoice()}},this.i18n=this.commonService.geti18nInfo(),this.digitInfo=this.commonService.getDigitsInfo(),this.locale=this.commonService.getLocale(),this.currencySymbol=this.commonService.getCurrencySymbol()}goToGenerateInvoice(){var t,i,r;if("readytoinvoice"===(null===(t=this.status)||void 0===t?void 0:t.toLowerCase())){let p=1;return"retail"===(null===(i=this.currentWorkProvider)||void 0===i?void 0:i.toLowerCase())&&"person"===(null===(r=this.currentWorkProviderType)||void 0===r?void 0:r.toLowerCase())&&(p=2),void this.router.navigate(["../invoicesEdit"],{relativeTo:this.route,queryParams:{formType:p}})}this.commonService.openConfirmYesNoDialog("Confirm to Continue","Once the invoice is generated, you won\u2019t be able to edit the estimate again. Are you sure you want to continue?").afterClosed().subscribe(p=>{p&&this.updateEstimateCharge(!0)})}parseFloatingPoint(t,i){return this.hashPropTable[i]?t:(i&&(this.hashPropTable[i]=!0),t*this.maxPoint)}get isiOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}valueAscOrder(t,i){var r,s;const p={part:"1",labour:"2",paint:"3"};return p[null===(r=t.key)||void 0===r?void 0:r.toLowerCase()].localeCompare(p[null===(s=i.key)||void 0===s?void 0:s.toLowerCase()])}validateLabourTypes(t,i,r,s){return i===Nn.UW.Paint?(this.hasPaint=!0,"PaintLabour"===r.serviceSubType?(t.paintLabourHourSubTotal=this.parseFloatingPoint(t.paintLabourHourSubTotal,`paintLabourHourSubTotal_${s}`)+this.parseFloatingPoint(r.quantity),t.paintLabourAmountSubTotal=this.parseFloatingPoint(t.paintLabourAmountSubTotal,`paintLabourAmountSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintLabourSubTotal=this.parseFloatingPoint(t.paintLabourSubTotal,`paintLabourSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintLabourTotal=this.parseFloatingPoint(t.paintLabourTotal,`paintLabourSubTotal+${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.paintLabourDiscountPercentage))/100)):(t.paintMaterialSubTotal=this.parseFloatingPoint(t.paintMaterialSubTotal,`paintMaterialSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.paintMaterialTotal=this.parseFloatingPoint(t.paintMaterialTotal,`paintMaterialTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.paintMateriaDiscountPercentage))/100))):i===Nn.UW.Labour?(this.hasLabour=!0,t.labourTotalBeforeDiscount=this.parseFloatingPoint(t.labourTotalBeforeDiscount,`labourTotalBeforeDiscount_${s}`)+this.parseFloatingPoint(r.total),t.labourAmountSubTotal=this.parseFloatingPoint(t.labourAmountSubTotal,`labourAmountSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.labourTotal=this.parseFloatingPoint(t.labourTotal,`labourTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.labourTotalDiscountPercentage))/100),t.labourHourSubTotal=this.parseFloatingPoint(t.labourHourSubTotal,`labourHourSubTotal_${s}`)+this.parseFloatingPoint(r.total),t.labourTimeHours=this.parseFloatingPoint(t.labourTimeHours,`labourTimeHours_${s}`)+this.parseFloatingPoint(r.quantity)):(this.hasParts=!0,t.partsTotalBeforeDiscount=this.parseFloatingPoint(t.partsTotalBeforeDiscount,`partsTotalBeforeDiscount_${s}`)+this.parseFloatingPoint(r.total),t.partsTotal=this.parseFloatingPoint(t.partsTotal,`partsTotal_${s}`)+this.parseFloatingPoint(r.total)*((100-parseFloat(t.partsTotalDiscountPercentage))/100),t.partsSubTotal=this.parseFloatingPoint(t.partsSubTotal,`partsSubTotal_${s}`)+this.parseFloatingPoint(r.total)),t}calculateSummary(t){var i,r,s,p;this.hashPropTable={};const u=Object.keys(t);t.paintLabourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.paintLabourSubTotal=0,t.labourTotal=0,t.paintLabourTotal=0,t.labourTimeHours=0,t.labourTotalBeforeDiscount=0,t.paintMaterialTotal=0,t.paintMaterialSubTotal=0,t.labourAmountSubTotal=0,t.labourHourSubTotal=0,t.paintLabourAmountSubTotal=0,t.partsSubTotal=0,t.partsTotal=0,t.partsTotalBeforeDiscount=0,u.forEach(I=>{t[I]=t[I]||"0"===t[I]?parseFloat(t[I]):0});let m=!1,C=!1;const O=JSON.parse(JSON.stringify(t)),v=[];O.title="work_provider_invoice";const w={};null===(i=this.charges)||void 0===i||i.forEach(I=>{1===I.recipient&&(m=!0,w[I.serviceType]||(w[I.serviceType]=[]),w[I.serviceType].push(I))}),m&&(O.invoiceList=w,v[0]=O);const T=JSON.parse(JSON.stringify(t));T.title="driver_owner_invoice";const R={};return null===(r=this.charges)||void 0===r||r.forEach(I=>{2===I.recipient&&(C=!0,R[I.serviceType]||(R[I.serviceType]=[]),R[I.serviceType].push(I))}),C&&(T.invoiceList=R,v[1]=T),this.charges.forEach(I=>{const E=I.serviceType;(I.cost||"0"===I.cost)&&(I.cost=parseFloat(I.cost)),(I.quantity||"0"===I.quantity)&&(I.quantity=parseFloat(I.quantity)),(I.total||"0"===I.total)&&(I.total=parseFloat(I.total)),1===I.recipient?v[0]=this.validateLabourTypes(v[0],E,I,I.recipient):v[1]=this.validateLabourTypes(v[1],E,I,I.recipient)}),m&&(v[0].paintLabourHourSubTotal=v[0].paintLabourHourSubTotal/this.maxPoint,v[0].paintLabourSubTotal=v[0].paintLabourSubTotal/this.maxPoint,v[0].labourTotal=v[0].labourTotal/this.maxPoint,v[0].paintLabourTotal=v[0].paintLabourTotal/this.maxPoint,v[0].labourTimeHours=v[0].labourTimeHours/this.maxPoint,v[0].labourTotalBeforeDiscount=v[0].labourTotalBeforeDiscount/this.maxPoint,v[0].paintMaterialTotal=v[0].paintMaterialTotal/this.maxPoint,v[0].paintMaterialSubTotal=v[0].paintMaterialSubTotal/this.maxPoint,v[0].labourAmountSubTotal=v[0].labourAmountSubTotal/this.maxPoint,v[0].labourHourSubTotal=v[0].labourHourSubTotal/this.maxPoint,v[0].paintLabourAmountSubTotal=v[0].paintLabourAmountSubTotal/this.maxPoint,v[0].partsSubTotal=v[0].partsSubTotal/this.maxPoint,v[0].partsTotal=v[0].partsTotal/this.maxPoint,v[0].partsTotalBeforeDiscount=v[0].partsTotalBeforeDiscount/this.maxPoint),C&&(v[1].paintLabourHourSubTotal=v[1].paintLabourHourSubTotal/this.maxPoint,v[1].paintLabourSubTotal=v[1].paintLabourSubTotal/this.maxPoint,v[1].labourTotal=v[1].labourTotal/this.maxPoint,v[1].paintLabourTotal=v[1].paintLabourTotal/this.maxPoint,v[1].labourTimeHours=v[1].labourTimeHours/this.maxPoint,v[1].labourTotalBeforeDiscount=v[1].labourTotalBeforeDiscount/this.maxPoint,v[1].paintMaterialTotal=v[1].paintMaterialTotal/this.maxPoint,v[1].paintMaterialSubTotal=v[1].paintMaterialSubTotal/this.maxPoint,v[1].labourAmountSubTotal=v[1].labourAmountSubTotal/this.maxPoint,v[1].labourHourSubTotal=v[1].labourHourSubTotal/this.maxPoint,v[1].paintLabourAmountSubTotal=v[1].paintLabourAmountSubTotal/this.maxPoint,v[1].partsSubTotal=v[1].partsSubTotal/this.maxPoint,v[1].partsTotal=v[1].partsTotal/this.maxPoint,v[1].partsTotalBeforeDiscount=v[1].partsTotalBeforeDiscount/this.maxPoint),"retail"===(null===(s=this.currentWorkProvider)||void 0===s?void 0:s.toLowerCase())?"person"===(null===(p=this.currentWorkProviderType)||void 0===p?void 0:p.toLowerCase())?[v[1]]:[v[0]]:v}isAllocationChanged(){const t=JSON.stringify(this.invoiceList);this.saveButtonModel=this.invoiceIssuedDate.disabled||t===this.currentChangesString&&J(this.invoiceIssuedDate.value).format("DD/MM/YYYY")==J(this.currentDate).format("DD/MM/YYYY")?Object.assign(Object.assign({},this.saveButtonModel),{type:"disabled-outline"}):Object.assign(Object.assign({},this.saveButtonModel),{type:"outline"})}hideShowSection(t){"part"===(null==t?void 0:t.toLowerCase())?this.isPartsExpanded=!this.isPartsExpanded:"labour"===(null==t?void 0:t.toLowerCase())?this.isLabourExpanded=!this.isLabourExpanded:this.isPaintExpanded=!this.isPaintExpanded}getSection(t){return"part"===(null==t?void 0:t.toLowerCase())?this.isPartsExpanded:"labour"===(null==t?void 0:t.toLowerCase())?this.isLabourExpanded:this.isPaintExpanded}getBookingRepairDetails(){var t;this.commonService.showLoading();const i=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.monitorServie.logEvent("getBookingRepairDetails",["InvoicesComponent","addenda-repair"],{repairGuid:i}),this.bookingService.getRepairDetailByGuid(i).subscribe({next:r=>(0,Ze.mG)(this,void 0,void 0,function*(){var s,p,u,m,C,O,v,w,D,T,R,I,E;if(null==r?void 0:r.data){this.commonService.repairDetails.next(r.data),this.commonService.bookingId.next(r.data.repairNumber),this.caseGuid=r.data.quoteId,this.repairStatus=r.data.status,this.status=r.data.invoiceStatus||"";const F=r.data.createdDate,G=J(new Date).diff(J(F),"minutes");if(this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{minDate:J(F).toDate(),disabled:G<0,maxDate:G<0?J(F).toDate():new Date}),["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(this.repairStatus.toLowerCase())||(this.generateInvoiceButtonModel=Object.assign(Object.assign({},this.generateInvoiceButtonModel),{type:"disabled"})),this.currentWorkProvider=r.data.customer.companyOrgType,this.currentWorkProviderType=r.data.customer.customerTypeName,this.orgName=null===(p=null===(s=r.data)||void 0===s?void 0:s.organizationDetail)||void 0===p?void 0:p.nameOfOrganization,this.orgLogoUrl=null===(m=null===(u=r.data)||void 0===u?void 0:u.organizationDetail)||void 0===m?void 0:m.logoOfOrg,this.customerValue=`${null===(O=null===(C=r.data)||void 0===C?void 0:C.customer)||void 0===O?void 0:O.firstName} ${null===(w=null===(v=r.data)||void 0===v?void 0:v.customer)||void 0===w?void 0:w.lastName}`,this.workProviderValue=(null===(T=null===(D=r.data)||void 0===D?void 0:D.customer)||void 0===T?void 0:T.companyName)||(null===(I=null===(R=r.data)||void 0===R?void 0:R.customer)||void 0===I?void 0:I.customerTypeName),this.orgLogoUrl||(this.orgImageLoading=!1),"technician"===(null===(E=this.commonService.roleName)||void 0===E?void 0:E.toLowerCase()))return;this.invoiceService.invoicePerDetail(i).subscribe({next:z=>{var ne,N;const{chargesDTO:X,chargeSummary:B,repairEstimateId:ue,repairId:Q,repairNumber:ee,status:Me,paymentStatus:Le,vehicle:tt,invoiceDate:nt}=z.data;if(this.repairId=ee,this.repairIntId=Q,this.estimateIntId=ue,this.paymentStatus=Le,this.summary=B,this.make=tt.vehicleMake,this.model=tt.vehicleModel,this.licensePlate=tt.licensePlateNumber,this.charges=X,nt&&(this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{value:nt})),("readytoinvoice"===(null===(ne=this.status)||void 0===ne?void 0:ne.toLowerCase())||"paid"===(null===(N=this.paymentStatus)||void 0===N?void 0:N.toLowerCase()))&&(this.generateInvoiceButtonModel=Object.assign(Object.assign({},this.generateInvoiceButtonModel),{label:"view_invoices"}),this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{mode:"text"})),this.commonService.isViewOnly&&(this.invoiceIssuedDate=Object.assign(Object.assign({},this.invoiceIssuedDate),{mode:"text"})),!this.charges||0===this.charges.length)return this.commonService.showToast(0,"no_charges"),void this.commonService.hideLoading();this.isDataLoading=!1,X.forEach(Ue=>{var Ct,Ot,De;this.invoiceList[Ue.serviceType]||(this.invoiceList[Ue.serviceType]=[],this.radioList[Ue.serviceType]=[]),Ue.serviceType===Nn.UW.Paint?this.hasPaint=!0:Ue.serviceType===Nn.UW.Labour?this.hasLabour=!0:this.hasParts=!0;let te={placeHolder:"",label:"",name:"payer",idField:"payer",value:1===Ue.recipient?this.workProviderValue:this.customerValue,type:"radio",disabled:"readytoinvoice"===Me.toLowerCase(),options:[{label:this.workProviderValue,id:1},{label:this.customerValue,id:2}]};if("retail"===(null===(Ct=this.currentWorkProvider)||void 0===Ct?void 0:Ct.toLowerCase())){const qe="person"===(null===(Ot=this.currentWorkProviderType)||void 0===Ot?void 0:Ot.toLowerCase())?this.customerValue:this.workProviderValue,ct="person"===(null===(De=this.currentWorkProviderType)||void 0===De?void 0:De.toLowerCase())?2:1;te=Object.assign(Object.assign({},te),{options:[{label:qe,id:ct}],mode:"text"})}this.radioList[Ue.serviceType].push(te),this.invoiceList[Ue.serviceType].push(Ue)}),this.currentChangesString=JSON.stringify(this.invoiceList),this.commonService.hideLoading()}})}else this.commonService.hideLoading()}),error:r=>{this.commonService.hideLoading(),this.isDataLoading=!1,this.monitorServie.logException(r,je._.Error)}})}updateEstimateCharge(t){const i={repairId:this.repairIntId,estimateId:this.estimateIntId,status:t?3:1,invoiceDate:this.invoiceIssuedDate.value,estimateCharges:[]};Object.keys(this.invoiceList).forEach(s=>{this.invoiceList[s].forEach(u=>{i.estimateCharges.push({estimateChargeId:u.chargeId,RecipientId:u.recipient})})}),this.commonService.showLoading(),this.invoiceService.assignInvoice(i).subscribe({next:s=>{var p,u;if(s){this.commonService.showInfoToast(1e3,"Invoice saved successfully");let m=1;"retail"===(null===(p=this.currentWorkProvider)||void 0===p?void 0:p.toLowerCase())&&"person"===(null===(u=this.currentWorkProviderType)||void 0===u?void 0:u.toLowerCase())&&(m=2),this.commonService.hideLoading(),t&&this.router.navigate(["../invoicesEdit"],{relativeTo:this.route,queryParams:{formType:m}})}},error:()=>{this.commonService.hideLoading()}})}ngOnInit(){this.getBookingRepairDetails()}expandCollapse(t){this.isAllExpanded=t,this.isPartsExpanded=t,this.isPaintExpanded=t,this.isLabourExpanded=t}previewInvoiceSummary(){const i=this.calculateSummary(this.summary).filter(r=>null==r?void 0:r.title);this.dialog.open(To,{width:" 58.5rem",height:"39.625rem",disableClose:!0,data:{title:"delete",message:"delete_confirm",messageEntity:"entity",okText:"yes",cancelText:"no",summaryData:i,showPaint:this.hasPaint,showLabour:this.hasLabour,showParts:this.hasParts},autoFocus:!1})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(He.v),e.Y36(Mo),e.Y36(on.q),e.Y36(Ge.M),e.Y36(Ye.uw),e.Y36(Be.F0),e.Y36(Be.gz))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-repair-invoices"]],decls:1,vars:1,consts:[["class","repair-invoice-wrapper",4,"ngIf"],[1,"repair-invoice-wrapper"],[1,"status-pill-wrapper"],[3,"class",4,"ngIf"],[1,"page-container"],[1,"repair-info"],[1,"repair-info-col-1"],[1,"org-image"],["alt","org logo",3,"src","load",4,"ngIf","ngIfElse"],["name",""],[3,"showLoading"],[1,"repair-detail"],[1,"repair-info-col-2"],[1,"col-6","invoice-date-input",3,"inputModel","controlOutput"],["regDate",""],[1,"invoices-table-wrapper"],[1,"expand-collapse-btn"],[3,"click"],[1,"invoices-table-container"],["class","table-parent",4,"ngFor","ngForOf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["alt","addenda logo","src","assets/img/addenda-repair.png"],[1,"button-container"],[3,"buttonModel",4,"ngIf"],["alt","org logo",3,"src","load"],["class","org-name",4,"ngIf"],[1,"org-name"],[1,"table-parent"],[1,"expand-container",3,"click"],[1,"small-heading"],["class","wrapper-table-scroll",3,"disabled","track","autoHeightDisabled",4,"ngIf"],[1,"wrapper-table-scroll",3,"disabled","track","autoHeightDisabled"],["width","100%"],["align","center"],[4,"ngFor","ngForOf"],["colspan","5"],["align","right"],[4,"ngIf"],[1,"text-light"],[3,"ngClass"],["class","provider-class",4,"ngIf"],["class","payer-radio-btn",3,"inputModel","controlOutput",4,"ngIf"],["colspan","6"],[1,"provider-class"],[1,"payer-radio-btn",3,"inputModel","controlOutput"],[3,"buttonModel"]],template:function(t,i){1&t&&e.YNc(0,Ts,47,41,"div",0),2&t&&e.Q6J("ngIf",!i.isDataLoading)},directives:[_.O5,Tt.h,nn.D,_.sg,Xe.Hw,kt,_.mk,yt.E],pipes:[is,we.X$,_.Nd,_r,yo.j],styles:[".repair-invoice-wrapper[_ngcontent-%COMP%]{background-color:#dbdde2;height:calc(100% - 315px);padding-top:50px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .status-pill-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:.625rem;font-style:normal;font-weight:700;padding:.6875rem 2rem;border-radius:.625rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:rgba(255,255,255,.82)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.5rem;gap:1.5rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .org-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:5.58956rem;height:4.86131rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]   .repair-info-col-1[_ngcontent-%COMP%]   .repair-detail[_ngcontent-%COMP%]{display:flex;grid-gap:.5rem;gap:.5rem;flex-direction:column}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2{display:flex;flex-direction:column;grid-gap:1rem;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2 chq-input.invoice-date-input{width:16.28494rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .repair-info[_ngcontent-%COMP%]     .repair-info-col-2 chq-input.invoice-date-input div.input-wrapper:not(.text-mode) input{outline:2px solid black}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]{margin-top:2.4rem;display:flex;flex-direction:column;grid-gap:1rem;gap:1rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;padding-left:5px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .expand-collapse-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--colors-gray-40, rgba(26, 34, 51, .4));font-size:.75rem;font-style:normal;font-weight:600;line-height:.875rem;cursor:pointer}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:1.25rem;gap:1.25rem;margin-bottom:1.5rem}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .payer-radio-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .expand-container[_ngcontent-%COMP%]{display:flex;grid-gap:1.25rem;gap:1.25rem;align-items:center;padding:.5rem .625rem;border-radius:.5rem .5rem 0 0;border-bottom:1px solid var(--colors-gray-10, rgba(26, 34, 51, .1));background:var(--colors-background, #f1f2f6)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-style:normal;font-weight:500;font-size:.75rem;margin-top:0;margin-bottom:0}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.625rem;font-style:normal;font-weight:700}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:12px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.text-light[_ngcontent-%COMP%]{color:var(--xa-dark-gray)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:10px;font-weight:500}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:12px;font-weight:500;padding-bottom:25px}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray);font-size:10px;font-weight:500}.repair-invoice-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .invoices-table-wrapper[_ngcontent-%COMP%]   .invoices-table-container[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{padding-right:calc(5px + 1.5vw);align-items:center;display:flex;grid-gap:1rem;gap:1rem;justify-content:flex-end}.repair-invoice-wrapper[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}.xa-light-gray[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray)}.secondary-color[_ngcontent-%COMP%]{color:var(--xa-secondary)!important}.status-unpaid[_ngcontent-%COMP%]{background-color:var(--xa-red)}.status-paid[_ngcontent-%COMP%]{background-color:var(--xa-green)}.status-partialpaid[_ngcontent-%COMP%]{background-color:var(--xa-yellow)}.provide-td[_ngcontent-%COMP%]{text-align:center}.provider-class[_ngcontent-%COMP%]{height:20px}.wrapper-table-scroll[_ngcontent-%COMP%]{max-width:100%;overflow-x:auto}.wrapper-table-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{display:inherit}.wrapper-table-scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}[_ngcontent-%COMP%]::-webkit-scrollbar{-webkit-appearance:none;width:7px}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,.5);box-shadow:0 0 1px rgba(255,255,255,.5)}.wrapper-table-scroll[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{border-radius:10px;background:rgba(100,100,100,.8);-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.5)}@media screen and (max-width: 864px){  .payer-radio-btn div.input-wrapper .radio{flex-direction:column;grid-gap:0px;gap:0px}}"]}),a})();function id(a,c){if(1&a&&(e.TgZ(0,"div",19),e.TgZ(1,"div",20),e._uU(2),e.ALo(3,"uppercase"),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",21),e._uU(6),e.qZA(),e.qZA()),2&a){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,e.lcZ(4,4,"status"))),e.xp6(4),e.Oqu(t.partsStatus)}}function od(a,c){if(1&a&&e._UZ(0,"chq-button",24),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.addPartButtonModel)}}function rd(a,c){1&a&&(e.TgZ(0,"div",22),e.YNc(1,od,1,1,"chq-button",23),e.qZA()),2&a&&(e.xp6(1),e.Q6J("chqPermission","repairAddParts"))}function Ds(a,c){if(1&a&&(e.TgZ(0,"div",30),e._UZ(1,"mat-icon",31),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.qZA()),2&a){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("svgIcon",i.partMapper[t.statusId+"_icon"]),e.xp6(2),e.hij("",i.partMapper[t.statusId+"_name"]," ")}}function Ss(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-input",32),e.NdJ("controlOutput",function(r){return e.CHM(t),e.oxw(3).onStatusChange(r)}),e.qZA()}if(2&a){const t=e.oxw().index,i=e.oxw(2);e.Q6J("inputModel",i.individualStatusModels[t])}}function ad(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"mat-icon",33),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),s=r.index,p=r.$implicit;return e.oxw(2).showDropdown(s,p.partId)}),e.qZA()}if(2&a){const t=e.oxw().index,i=e.oxw(2);e.Q6J("svgIcon",i.editMode[t]?"cross":"edit")}}const Jr=function(a,c,t,i,r){return[a,c,t,i,r]};function Is(a,c){if(1&a&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"xaCurrency"),e.qZA(),e.TgZ(10,"td",26),e._uU(11),e.ALo(12,"xaCurrency"),e.qZA(),e.TgZ(13,"td"),e.YNc(14,Ds,4,2,"div",27),e.YNc(15,Ss,1,1,"chq-input",28),e.qZA(),e.TgZ(16,"td"),e.YNc(17,ad,1,1,"mat-icon",29),e.qZA(),e.qZA()),2&a){const t=c.$implicit,i=c.index,r=e.oxw(2);e.xp6(2),e.hij(" ",t.description," "),e.xp6(2),e.hij(" ",t.code," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.G7q(9,8,e.qbA(20,Jr,t.cost,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," "),e.xp6(3),e.hij(" ",e.G7q(12,14,e.qbA(26,Jr,t.total,r.i18n.currencySymbol,r.i18n.digitsInfo,r.i18n.locale,r.i18n.position))," "),e.xp6(3),e.Q6J("ngIf",!r.editMode[i]),e.xp6(1),e.Q6J("ngIf",r.editMode[i]),e.xp6(2),e.Q6J("ngIf",!r.readOnlyMode&&!r.commonService.isViewOnly)}}function Dt(a,c){if(1&a&&(e.TgZ(0,"tbody"),e.YNc(1,Is,18,32,"tr",25),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.parts)}}function an(a,c){1&a&&(e.TgZ(0,"tbody"),e.TgZ(1,"tr"),e.TgZ(2,"td",34),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.qZA()),2&a&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"no_parts_available")))}function sd(a,c){if(1&a&&e._UZ(0,"chq-button",24),2&a){const t=e.oxw();e.Q6J("buttonModel",t.saveButtonModel)}}let ld=(()=>{class a{constructor(t,i,r,s,p,u,m,C){var O,v;this.dialog=t,this.bookingService=i,this.commonService=r,this.route=s,this.monitorService=p,this.repairEstimateService=u,this.repairEstimateOperationService=m,this.router=C,this.notifyServiceButtonModel={label:"Notify Service Advisor",type:"outline",icon:"paperplane",iconColor:"black"},this.addPartButtonModel={label:"Add Part",type:"outline",icon:"plus",onclick:this.openPartPopup.bind(this)},this.saveButtonModel={label:"Save",type:"disabled",onclick:this.saveParts.bind(this)},this.individualStatusModel={placeHolder:"Select Status",name:"indStatus",label:"",type:"select",value:0,displayValue:"name",options:[]},this.individualStatusModels=[],this.parts=[],this.partsStatus="",this.repairGuid="",this.estimateSource="",this.userPermission={},this.partMapper={},this.editMode=[],this.formData=[],this.repairStatus="",this.readOnlyMode=!1,this.hideButton=!1,this.repairTypesArray=[],this.afterOperation=!1,this.commonService.accessRight.closed&&(this.commonService.accessRight=new Vt.X(!0)),this.commonService.userProfileData.subscribe(w=>{if(w&&w.data){const{userPermission:D}=w.data;this.userPermission=D||{}}}),this.i18n=this.commonService.geti18nInfo(),null===(v=null===(O=this.route.parent)||void 0===O?void 0:O.params)||void 0===v||v.subscribe(w=>{""!=this.repairGuid&&this.repairGuid!==w.id&&(this.repairGuid=w.id,this.getRepairDetails(),this.getParts())})}get disableEdit(){var t;return!!["pendingapproval","readytoinvoice","invoiced","complete"].includes(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())}ngOnInit(){var t;this.repairGuid=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id"),this.commonService.showLoading(),(0,Un.D)({partStatuses:this.repairEstimateOperationService.getPartStatuses(),part:this.repairEstimateOperationService.getParts(this.repairGuid),repairDetail:this.bookingService.getRepairDetailByGuid(this.repairGuid)}).pipe((0,Jn.K)(r=>(0,Wt.of)(r))).subscribe({next:r=>{var s,p,u;if(r.partStatuses&&this.getPartStatuses(null===(s=r.partStatuses)||void 0===s?void 0:s.data),r.part){const m=r.part;m&&(this.parts=m.repairParts,(null===(p=this.parts)||void 0===p?void 0:p.length)>0&&this.parts.forEach((C,O)=>{this.individualStatusModels[O]=this.individualStatusModel,this.individualStatusModels[O]=Object.assign(Object.assign({},this.individualStatusModels[O]),{selectedOption:{name:C.status,id:C.statusId},name:`ind-status-${O}`}),this.editMode[O]=!1}),this.partsStatus=this.mapStatus(m.status))}if(r.repairDetail){const m=r.repairDetail;this.repairResponse=r.repairDetail.data,this.commonService.bookingId.next(this.repairResponse.repairNumber),this.commonService.repairGuid.next(this.repairResponse.repairGuid),this.commonService.repairDetails.next(this.repairResponse),this.estimateSource=this.repairResponse.estimateSource||"",this.repairStatus=this.repairResponse.status,this.disableEdit?(this.readOnlyMode=!0,this.hideButton=!0):("GTMotive"!=this.estimateSource&&this.checkGTEstimatePermission()||"GTMotive"==this.estimateSource&&!this.checkGTEstimatePermission())&&(this.readOnlyMode=!0),"repair"==(null===(u=m.data.repairType)||void 0===u?void 0:u.toLowerCase())&&(this.afterOperation||this.getInitialRepairTypes(m.data.repairServiceTypes))}},error:r=>{this.commonService.hideLoading()}})}getPartStatuses(t){if(t){this.individualStatusModel=Object.assign(Object.assign({},this.individualStatusModel),{options:t});const i={};this.individualStatusModel.options.forEach((r,s)=>{this.individualStatusModel.options[s]=Object.assign(Object.assign({},this.individualStatusModel.options[s]),{dropdownItemIcon:this.getIcon(r.name)}),i[r.id+"_name"]=r.description,i[r.id+"_icon"]=this.getIcon(r.name)}),this.partMapper=i}}getIcon(t){switch(t){case"NotOrdered":return"parts-not-ordered";case"Ordered":return"parts-ordered";case"Arrived":return"parts-arrived";default:return""}}mapStatus(t){switch(t){case"NotOrdered":return"Not Ordered";case"OrderedPartially":return"Ordered Partially";case"ArrivedPartially":return"Arrived Partially";default:return t}}getParts(){this.commonService.showLoading(),this.repairEstimateOperationService.getParts(this.repairGuid).subscribe({next:t=>{var i;t&&(this.parts=t.repairParts,(null===(i=this.parts)||void 0===i?void 0:i.length)>0&&this.parts.forEach((r,s)=>{this.individualStatusModels[s]=this.individualStatusModel,this.individualStatusModels[s]=Object.assign(Object.assign({},this.individualStatusModels[s]),{selectedOption:{name:r.status,id:r.statusId},name:`ind-status-${s}`}),this.editMode[s]=!1}),this.partsStatus=this.mapStatus(t.status))},complete:()=>{this.commonService.hideLoading()},error:()=>{this.commonService.hideLoading()}})}saveParts(){this.commonService.showLoading(),this.repairEstimateOperationService.editPartStatuses(this.formData,this.repairGuid).subscribe({next:t=>{t&&(this.getParts(),this.formData=[],this.saveButtonModel.type="disabled")},complete:()=>{this.commonService.hideLoading()}})}getRepairDetails(){this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairGuid).subscribe({next:t=>{var i;this.repairResponse=t.data,this.commonService.bookingId.next(this.repairResponse.repairNumber),this.commonService.repairGuid.next(this.repairResponse.repairGuid),this.commonService.repairDetails.next(this.repairResponse),this.estimateSource=this.repairResponse.estimateSource||"",this.repairStatus=this.repairResponse.status,this.disableEdit?(this.readOnlyMode=!0,this.hideButton=!0):("GTMotive"!=this.estimateSource&&this.checkGTEstimatePermission()||"GTMotive"==this.estimateSource&&!this.checkGTEstimatePermission())&&(this.readOnlyMode=!0),"repair"==(null===(i=t.data.repairType)||void 0===i?void 0:i.toLowerCase())&&(this.afterOperation?"GTMotive"!=this.estimateSource&&(this.showRepairTypeUpdateMessage(t.data.repairServiceTypes,this.repairTypesArray),-1!==location.search.indexOf("?mode=edit")?this.router.navigate([`/repair/booking/${this.repairGuid}/estimate`],{queryParams:{mode:"edit"}}):this.router.navigate([`/repair/booking/${this.repairGuid}/estimate`])):this.getInitialRepairTypes(t.data.repairServiceTypes)),this.commonService.hideLoading()},complete:()=>{this.commonService.hideLoading()}})}checkGTEstimatePermission(){const{orgPackages:t=[]}=this.userPermission,i=t.filter(r=>"Repair Estimate"===r.automotiveServiceName);if(i&&i.length>0){const{permissions:r}=i[0],s=r.filter(p=>"gt.estimate"===p.permissionName||"gt.estimate.vinquery"===p.permissionName);if(s&&s.length>0)return!0}return!1}redirectToGtEstimate(){this.commonService.showLoading(),this.monitorService.logEvent("redirectToGtEstimate",["RepairPartsComponent","addenda-repair",{repairId:this.repairGuid}]),this.repairEstimateService.createEstimateFromRepair(this.repairGuid).subscribe({next:t=>{t&&(location.href=t.data.url,sessionStorage.setItem("update","1"),sessionStorage.setItem("current-url",this.router.url.toString()),sessionStorage.setItem("initial-repair-types",JSON.stringify(this.repairTypesArray)))},complete:()=>{this.commonService.hideLoading()}})}onStatusChange(t){var i,r,s,p;const u=null===(i=t.name)||void 0===i?void 0:i.replace("ind-status-","");this.individualStatusModels[u]=Object.assign(Object.assign({},this.individualStatusModels[u]),{selectedOption:t.value});const m=this.formData.find(C=>{var O;return C.partGuid==(null===(O=this.parts[u])||void 0===O?void 0:O.partGuidId)});m?m.status=null===(r=t.value)||void 0===r?void 0:r.name:this.formData.push({status:null===(s=t.value)||void 0===s?void 0:s.name,partGuid:null===(p=this.parts[u])||void 0===p?void 0:p.partGuidId}),this.saveButtonModel.type="primary"}showDropdown(t,i=""){var r;if(this.editMode[t]=!this.editMode[t],this.saveButtonModel.type=this.editMode.some(s=>!0===s)?"primary":"disabled",0==this.editMode[t]){const s=this.parts.find(p=>p.partId==i);s&&(this.individualStatusModels[t]=Object.assign(Object.assign({},this.individualStatusModels[t]),{selectedOption:{name:s.status,id:s.statusId}})),this.formData=null===(r=this.formData)||void 0===r?void 0:r.filter(p=>p.partGuid!=s.partGuidId)}}openPartPopup(){if("GTMotive"==this.estimateSource)this.redirectToGtEstimate();else{if(this.checkGTEstimatePermission())return void this.commonService.showToast(0,"msg_gt_permission");this.dialog.open(Ie,{data:{repairId:this.repairGuid},width:"85vw",height:"90vh",panelClass:"operation-panel",autoFocus:!1}).afterClosed().subscribe({next:i=>{i&&(this.afterOperation=!0,this.getRepairDetails())}})}}getInitialRepairTypes(t){t.forEach(i=>{this.repairTypesArray.push(i.repairServiceType)})}showRepairTypeUpdateMessage(t,i){const s=[];if(null==t||t.forEach(p=>{s.push("object"==typeof p?p.repairServiceType:p)}),s.length>0){const p=s.filter(u=>!i.includes(u));p.length>0&&(this.commonService.showInfoToast(1e3,`Repair Type was updated: Added ${p.join(",")}`),this.repairTypesArray=[...this.repairTypesArray,...p])}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ye.uw),e.Y36(on.q),e.Y36(He.v),e.Y36(Be.gz),e.Y36(Ge.M),e.Y36(wt.H),e.Y36(Fi),e.Y36(Be.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-repair-parts"]],decls:39,vars:28,consts:[[1,"repair-part-wrapper"],[1,"page-container"],[1,"toolbar-container"],[1,"toolbar-wrapper","row"],["class","part-status col-6",4,"ngIf"],[1,"col-6","button-section-wrapper"],["class","button-section",4,"ngIf"],[1,"table-container"],[1,"main-table"],["width","40%"],[1,"price"],[1,"total-price"],[4,"ngIf"],[1,"button-container"],[3,"buttonModel",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[1,"part-status","col-6"],[1,"part-status-label"],[1,"part-status-text"],[1,"button-section"],[3,"buttonModel",4,"chqPermission"],[3,"buttonModel"],[4,"ngFor","ngForOf"],[1,"total"],["class","dropdown-parts",4,"ngIf"],[3,"inputModel","controlOutput",4,"ngIf"],[3,"svgIcon","click",4,"ngIf"],[1,"dropdown-parts"],[3,"svgIcon"],[3,"inputModel","controlOutput"],[3,"svgIcon","click"],["colspan","7",1,"no-parts"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.YNc(4,id,7,6,"div",4),e.TgZ(5,"div",5),e.YNc(6,rd,2,1,"div",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",7),e.TgZ(8,"table",8),e.TgZ(9,"thead"),e.TgZ(10,"th",9),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th",10),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th",11),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"th"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e.TgZ(28,"th"),e._uU(29),e.ALo(30,"translate"),e.qZA(),e.qZA(),e.YNc(31,Dt,2,1,"tbody",12),e.YNc(32,an,5,3,"tbody",12),e.qZA(),e.qZA(),e.TgZ(33,"div",13),e.YNc(34,sd,1,1,"chq-button",14),e.qZA(),e.qZA(),e.TgZ(35,"div",15),e.TgZ(36,"div",16),e.TgZ(37,"div",17),e._UZ(38,"img",18),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngIf",(null==i.parts?null:i.parts.length)>0),e.xp6(2),e.Q6J("ngIf",!i.hideButton&&!i.commonService.isViewOnly),e.xp6(5),e.Oqu(e.lcZ(12,14,"parts_description")),e.xp6(3),e.Oqu(e.lcZ(15,16,"code")),e.xp6(3),e.Oqu(e.lcZ(18,18,"units")),e.xp6(3),e.AsE("",e.lcZ(21,20,"price_unit"),"(",i.i18n.currencySymbol,")"),e.xp6(3),e.AsE("",e.lcZ(24,22,"total_price"),"(",i.i18n.currencySymbol,")"),e.xp6(3),e.Oqu(e.lcZ(27,24,"status")),e.xp6(3),e.hij("",e.lcZ(30,26,"actions")," "),e.xp6(2),e.Q6J("ngIf",(null==i.parts?null:i.parts.length)>0),e.xp6(1),e.Q6J("ngIf",0===(null==i.parts?null:i.parts.length)),e.xp6(2),e.Q6J("ngIf",!i.hideButton&&!i.commonService.isViewOnly))},directives:[_.O5,mi.A,yt.E,_.sg,Xe.Hw,nn.D],pipes:[we.X$,_.gd,yo.j],styles:[".repair-part-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-tab-background);padding-top:calc(5px + 1.5vw)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]{box-sizing:border-box;background:rgba(255,255,255,.82)!important;border:1px solid var(--xa-form-border);border-radius:10px;padding:30px 25px;margin-top:20px;margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]{justify-content:flex-end}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:53px;padding-top:.5px;justify-content:center}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]   .part-status-label[_ngcontent-%COMP%]{font-size:14px;font-style:normal;font-weight:400;line-height:14px;color:var(--xa-dark-gray)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .part-status[_ngcontent-%COMP%]   .part-status-text[_ngcontent-%COMP%]{font-size:16px;line-height:20px;display:flex;height:48px;flex-direction:column;justify-content:center;align-items:flex-start;align-self:stretch}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   chq-input[_ngcontent-%COMP%]     chq-dropdown{width:50%}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .toolbar-container[_ngcontent-%COMP%]   .toolbar-wrapper[_ngcontent-%COMP%]   .button-section-wrapper[_ngcontent-%COMP%]   .button-section[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;grid-gap:10px;gap:10px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{margin-bottom:30px;overflow:scroll;margin-top:30px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid var(--xa-light-gray);background:white}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:12px;line-height:14px;color:var(--xa-black);text-align:left;padding:10px;grid-gap:10px;gap:10px;height:34px;-moz-appearance:none}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:500;background:rgba(26,34,51,.1)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:400;font-size:14px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]     chq-input a, .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]     chq-input a{background-color:var(--xa-popup-light-gray)}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .dropdown-parts[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .dropdown-parts[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;grid-gap:5px;gap:5px}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   td.no-parts[_ngcontent-%COMP%], .repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.no-parts[_ngcontent-%COMP%]{text-align:center}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.repair-part-wrapper[_ngcontent-%COMP%]   .page-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   chq-button[_ngcontent-%COMP%]{min-width:116px}"]}),a})();var et=(()=>{return(a=et||(et={})).Start="Start",a.Pause="Pause",a.Stop="Stop",et;var a})(),Jt=(()=>{return(a=Jt||(Jt={})).NotStarted="NotStarted",a.Completed="Completed",Jt;var a})();const As=function(a){return{selected:a}};function Zs(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().triggerMenuItemClick(s)}),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._uU(3),e.qZA(),e.TgZ(4,"span"),e._uU(5),e.qZA(),e.qZA(),e.qZA()}if(2&a){const t=c.$implicit;e.Q6J("ngClass",e.VKq(5,As,t.active)),e.xp6(1),e.Udp("background",t.color),e.xp6(2),e.hij("",t.displayName,"%"),e.xp6(2),e.Oqu(t.name)}}let cd=(()=>{class a{constructor(t,i){this.monitorService=t,this.router=i,this.menuItemClick=new e.vpe,this.router.events.subscribe(()=>{this.setCurrentActiveMenu()})}triggerMenuItemClick(t){this.menuItemClick.emit(t)}splitter(t){const i=null==t?void 0:t.split("/");if((null==i?void 0:i.length)>0){const r=i[i.length-1];return r.includes("?")?r.split("?")[0]:r}return""}setCurrentActiveMenu(){var t,i;null===(t=this.menuItems)||void 0===t||t.map(p=>p.active=!1);const r=this.splitter(location.href),s=null===(i=this.menuItems)||void 0===i?void 0:i.filter(p=>{var u;return this.splitter(p.url)===r||p.childMenuLinks&&(null===(u=p.childMenuLinks)||void 0===u?void 0:u.includes(r))});s&&s.length>0?s[0].active=!0:this.menuItems[0]&&(this.menuItems[0].active=!0)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ge.M),e.Y36(Be.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["button-tabs"]],inputs:{menuItems:"menuItems"},outputs:{menuItemClick:"menuItemClick"},decls:3,vars:1,consts:[[1,"button-wrapper"],[1,"button-toggle"],["class","menu-wrapper",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"menu-wrapper",3,"ngClass","click"],[1,"menu-block"],[1,"head"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,Zs,6,7,"div",2),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngForOf",i.menuItems))},directives:[_.sg,_.mk],styles:[".button-wrapper[_ngcontent-%COMP%]{display:inline-flex;padding:7.31px 0 0 29px;justify-content:flex-start;align-items:center;flex:1;width:100%;overflow-x:auto}.menu-block[_ngcontent-%COMP%]{display:flex;height:59px;padding:10px 11px;align-items:center;grid-gap:12px;gap:12px;justify-content:space-between;border-radius:10px;color:var(--xa-white);width:135px;border:1px solid var(--xa-white);margin-top:13px}.menu-block[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;font-weight:400;line-height:14px}.menu-block[_ngcontent-%COMP%]   span.head[_ngcontent-%COMP%]{font-size:16px;font-weight:700;line-height:20px}.menu-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:flex-start;grid-gap:20px;gap:20px;border-radius:14px 14px 0 0}.selected[_ngcontent-%COMP%]{background:var(--xa-popup-light-gray);padding:13px 20px}.selected[_ngcontent-%COMP%]   .menu-block[_ngcontent-%COMP%]{margin-top:0}.button-toggle[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;padding-top:10px;grid-gap:10px;gap:10px}"]}),a})();var ks=Z(8358),yi=Z(15058),wi=Z(4885);function dd(a,c){1&a&&(e.TgZ(0,"div",18),e.TgZ(1,"span",19),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()),2&a&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"label_mandatory")))}function qs(a,c){1&a&&(e.TgZ(0,"span",31),e._uU(1,"*"),e.qZA())}function Rs(a,c){if(1&a&&(e.TgZ(0,"span",32),e._uU(1),e.ALo(2,"date"),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,t.updatedDate,"dd/MM/yyyy hh:mm:ss"))}}function qo(a,c){1&a&&e._UZ(0,"div",33)}function Ls(a,c){1&a&&(e.TgZ(0,"div",34),e._UZ(1,"div",35),e.TgZ(2,"div",36),e._UZ(3,"mat-spinner",37),e.qZA(),e.qZA()),2&a&&(e.xp6(3),e.Q6J("strokeWidth",2)("diameter",20))}const Ro=function(a){return{"not-allowed":a}};function Br(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"span",38),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().updateTaskStatus(r)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(1,Ro,t.commonService.isViewOnly))}}function Lo(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"span",39),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit;return e.oxw().updateTaskStatus(r)}),e.qZA()}}function pd(a,c){1&a&&(e.TgZ(0,"div",34),e._UZ(1,"div",35),e.TgZ(2,"div",36),e._UZ(3,"mat-spinner",37),e.qZA(),e.qZA()),2&a&&(e.xp6(3),e.Q6J("strokeWidth",2)("diameter",20))}function Es(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",20),e.TgZ(1,"div",8),e._uU(2),e.YNc(3,qs,2,0,"span",21),e.qZA(),e.TgZ(4,"div",9),e._uU(5),e.qZA(),e.TgZ(6,"div",9),e.TgZ(7,"div",22),e.TgZ(8,"span"),e._uU(9),e.qZA(),e.YNc(10,Rs,3,4,"span",23),e.qZA(),e.qZA(),e.TgZ(11,"div",9),e.TgZ(12,"div",24),e.TgZ(13,"mat-icon",25),e.NdJ("click",function(r){const p=e.CHM(t).$implicit,u=e.oxw();return r.stopPropagation(),u.showCommentDialog(null==p?null:p.notes,p)}),e.qZA(),e.YNc(14,qo,1,0,"div",26),e.qZA(),e.YNc(15,Ls,4,2,"div",27),e.qZA(),e.TgZ(16,"div",28),e.YNc(17,Br,1,3,"span",29),e.YNc(18,Lo,1,0,"span",30),e.YNc(19,pd,4,2,"div",27),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.qZA()}if(2&a){const t=c.$implicit;e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.isMandatory),e.xp6(2),e.Oqu(t.repairTypeNames),e.xp6(4),e.Oqu(t.modifiedBy),e.xp6(1),e.Q6J("ngIf",t.updatedDate),e.xp6(3),e.Q6J("svgIcon","comment"),e.xp6(1),e.Q6J("ngIf",null==t?null:t.notes),e.xp6(1),e.Q6J("ngIf",t.isNoteLoading),e.xp6(2),e.Q6J("ngIf",t.completedDate&&!t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.completedDate&&!t.isLoading),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.hij(" ",e.lcZ(21,12,t.isLoading?"updating_task":"task_done")," ")}}function Eo(a,c){1&a&&(e.TgZ(0,"div",40),e.TgZ(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.qZA()),2&a&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"no_repair_tasks_available")))}function Fs(a,c){if(1&a&&e._UZ(0,"chq-button",42),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.notifyButtonModel)}}function Yr(a,c){if(1&a&&e._UZ(0,"chq-button",42),2&a){const t=e.oxw(2);e.Q6J("buttonModel",t.addPartButtonModel)}}function ud(a,c){if(1&a&&(e.ynx(0),e.YNc(1,Fs,1,1,"chq-button",41),e.YNc(2,Yr,1,1,"chq-button",41),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.activateNotifyButton&&!t.commonService.isViewOnly&&t.notifyData.communicationList.length>0),e.xp6(1),e.Q6J("ngIf","go_invoice"===t.addPartButtonModel.label||!t.commonService.isViewOnly)}}let Ns=(()=>{class a{constructor(t,i,r,s,p){this.monitorService=t,this.dialog=i,this.bookingService=r,this.translateService=s,this.commonService=p,this.updateJobs=new e.vpe,this.confirmJob=new e.vpe,this.taskList=[],this.mandatoryTasks=0,this.allMandatoryTasks=0,this.notifyButtonModel={label:"notify",type:"outline",icon:"send",onclick:this.openNotify.bind(this)},this.addPartButtonModel={label:"Complete Repair",type:"disabled",onclick:this.completeJob.bind(this)}}openNotify(){this.dialog.open(yi.b,{data:{repairGuid:this.notifyData.repairGuid,domainId:this.notifyData.domainId,templateId:1,communicationList:this.notifyData.communicationList,communicatedList:this.notifyData.communicatedList,method:"notifier"},backdropClass:"confirmation-popup-backdrop",maxHeight:"693px",maxWidth:"629px"}).afterClosed().subscribe({next:i=>{(null==i?void 0:i.notifySend)&&(console.log(i),i.selectedCommunication&&i.selectedCommunication.forEach(r=>{this.notifyData.communicatedList.push({id:0,eventName:i.templateKey,communicationTypeId:r})}),this.commonService.showInfoToast(1e3,"Message sent"))}})}completeJob(){this.confirmJob.emit()}ngOnChanges(t){var i;this.monitorService.logEvent("ngOnChanges",["ChqEstimateDetailsComponent","addenda-repair"]),t&&(this.activateNotifyButton&&t.repairStatus&&t.repairStatus.currentValue&&(this.activateNotifyButton="repairinprogress"===t.repairStatus.currentValue.toLowerCase()),t.repairDataMappings&&t.repairDataMappings.currentValue&&(this.taskList=[...this.repairDataMappings.repairJobTasks],this.taskList.forEach(s=>{const p=s.repairJobMappings.map(u=>u.repairServiceTypeName);s.repairTypeNames=p.join(", ")}),this.mandatoryTasks=this.taskList.filter(s=>!0===s.isMandatory&&"Completed"!==s.statusName).length,this.allMandatoryTasks=this.taskList.filter(s=>!0===s.isMandatory).length),t.activateRepairButton&&t.activateRepairButton.currentValue&&(this.addPartButtonModel=Object.assign(Object.assign({},this.addPartButtonModel),{type:"primary"})),["readytoinvoice","invoiced","paid","complete"].includes(null===(i=this.repairStatus)||void 0===i?void 0:i.toLowerCase())&&this.activateRepairButton&&(this.addPartButtonModel=Object.assign(Object.assign({},this.addPartButtonModel),{label:"go_invoice"})),setTimeout(()=>{this.mandatoryTasks=this.taskList.filter(s=>!0===s.isMandatory&&"Completed"!==s.statusName).length}))}ngOnInit(){var t;this.repairDataMappings&&(this.taskList=[...this.repairDataMappings.repairJobTasks],this.taskList.forEach(i=>{const r=i.repairJobMappings.map(s=>s.repairServiceTypeName);i.repairTypeNames=r.join(", ")}),this.mandatoryTasks=this.taskList.filter(i=>!0===i.isMandatory&&"Completed"!==i.statusName).length,this.allMandatoryTasks=this.taskList.filter(i=>!0===i.isMandatory).length),"readytoinvoice"===(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())&&this.activateRepairButton&&(this.addPartButtonModel=Object.assign(Object.assign({},this.addPartButtonModel),{label:"go_invoice"}))}updateTaskStatus(t){var i,r;if(!this.commonService.isViewOnly){if(!this.repairDataMappings.startDate)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_comment")).afterClosed().subscribe();if((null===(r=null===(i=this.repairDataMappings)||void 0===i?void 0:i.timerLog)||void 0===r?void 0:r.statusName)===et.Pause)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_pause_comment")).afterClosed().subscribe();if(!this.repairDataMappings.startDate)return void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("warning_comment")).afterClosed().subscribe();if(this.repairDataMappings.endDate)return void this.commonService.openAlertDialog(this.translateService.instant("cannot_update_status"),this.translateService.instant("job_completed")).afterClosed().subscribe();if(this.mandatoryTasks<=1&&t.isMandatory)return void this.commonService.openConfirmationOkDialog(this.translateService.instant("confirm_action"),this.translateService.instant("job_no_mandatory_task")).afterClosed().subscribe(p=>{p?(t.isLoading=!0,this.bookingService.updateRepairTaskStatus(t.repairTaskGuid,this.repairDataMappings.repairJobGuid,t.completedDate?Jt.NotStarted:Jt.Completed).subscribe({next:()=>{t.completedDate=t.completedDate?null:new Date,this.mandatoryTasks--,this.updateJobs.emit(),t.isLoading=!1},error:()=>{t.isLoading=!1}})):t.isLoading=!1});t.isLoading=!0,this.bookingService.updateRepairTaskStatus(t.repairTaskGuid,this.repairDataMappings.repairJobGuid,t.completedDate?Jt.NotStarted:Jt.Completed).subscribe({next:()=>{t.completedDate=t.completedDate?null:new Date,this.updateJobs.emit(),t.isLoading=!1},error:()=>{t.isLoading=!1}})}}showCommentDialog(t,i){let r="";t&&(r=t),this.monitorService.logEvent("showCommentDialog",["CommentDialogComponent","addenda-repair"]),this.dialog.open(ks.E,{data:{notes:r},panelClass:"comment-modalbox",autoFocus:!1}).afterClosed().subscribe({next:s=>{!s||(s.delete&&(s.comment=""),i.isNoteLoading=!0,this.bookingService.updateRepairTaskNotes(this.repairDataMappings.repairJobGuid,s.comment,i.repairTaskGuid).subscribe({next:()=>{i.notes=s.comment,this.updateJobs.emit(),i.isNoteLoading=!1},error:()=>{i.isNoteLoading=!1}}))}})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(Ge.M),e.Y36(Ye.uw),e.Y36(on.q),e.Y36(we.sK),e.Y36(He.v))},a.\u0275cmp=e.Xpm({type:a,selectors:[["repair-stages-table"]],inputs:{repairDataMappings:"repairDataMappings",notifyData:"notifyData",activateRepairButton:"activateRepairButton",activateNotifyButton:"activateNotifyButton",repairStatus:"repairStatus"},outputs:{updateJobs:"updateJobs",confirmJob:"confirmJob"},features:[e.TTD],decls:33,vars:20,consts:[[1,"card"],[1,"card-header"],[1,"title"],[1,"card-body"],[1,"wrapper"],[1,"header-wrapper"],["class","mandatory-div",4,"ngIf"],[1,"header","row","header-repair"],[1,"col-4"],[1,"col-2"],[1,"data-wrapper"],["class","data-row row",4,"ngFor","ngForOf"],["class","wrapper error-wrapper",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],["src","assets/img/addenda-repair.png"],[4,"chqPermission"],[1,"mandatory-div"],[1,"mandatory-text","text-danger"],[1,"data-row","row"],["class","text-danger",4,"ngIf"],[1,"wrapper-span"],["class","span-date",4,"ngIf"],[1,"comment-div"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon","click"],["class","red-icon",4,"ngIf"],["class","loading",4,"ngIf"],[1,"col-2","relate-spinner"],["class","checked",3,"ngClass","click",4,"ngIf"],["class","circle",3,"click",4,"ngIf"],[1,"text-danger"],[1,"span-date"],[1,"red-icon"],[1,"loading"],[1,"overlay"],[1,"spinner"],[3,"strokeWidth","diameter"],[1,"checked",3,"ngClass","click"],[1,"circle",3,"click"],[1,"wrapper","error-wrapper"],["class","submit-button",3,"buttonModel",4,"ngIf"],[1,"submit-button",3,"buttonModel"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"h3",2),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.YNc(7,dd,4,3,"div",6),e.TgZ(8,"div",7),e.TgZ(9,"div",8),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",9),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",9),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",9),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"div",9),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",10),e.YNc(25,Es,22,14,"div",11),e.YNc(26,Eo,4,3,"div",12),e.qZA(),e.qZA(),e.qZA(),e.TgZ(27,"div",13),e.TgZ(28,"div",14),e.TgZ(29,"div",15),e._UZ(30,"img",16),e.qZA(),e.qZA(),e.TgZ(31,"div",14),e.YNc(32,ud,3,2,"ng-container",17),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Oqu(null==i.repairDataMappings?null:i.repairDataMappings.name),e.xp6(4),e.Q6J("ngIf",i.allMandatoryTasks>0),e.xp6(3),e.Oqu(e.lcZ(11,10,"item_name")),e.xp6(3),e.Oqu(e.lcZ(14,12,"repair_type")),e.xp6(3),e.Oqu(e.lcZ(17,14,"modified_by")),e.xp6(3),e.Oqu(e.lcZ(20,16,"notes")),e.xp6(3),e.Oqu(e.lcZ(23,18,"status")),e.xp6(3),e.Q6J("ngForOf",i.taskList),e.xp6(1),e.Q6J("ngIf",i.taskList&&0===i.taskList.length),e.xp6(6),e.Q6J("chqPermission","newBooking"))},directives:[_.O5,_.sg,mi.A,Xe.Hw,wi.$g,_.mk,yt.E],pipes:[we.X$,_.uU],styles:['.card[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:10px;flex:none;order:0;align-self:stretch;flex-grow:0}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;justify-content:space-between;align-items:center;padding:calc(5px + .5vw);padding-left:30px;height:35px;background:var(--xa-secondary);border-radius:10px 10px 0 0}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:20px;line-height:25px;color:var(--xa-white)}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-weight:500}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]{min-height:60px!important;display:flex;align-items:center}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:12px;line-height:35px;display:flex;align-items:center;color:var(--xa-black-medium)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-repair[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{padding-left:40px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;background:var(--xa-table-header-light)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--xa-dark-gray);font-size:12px;font-weight:500;line-height:35px;letter-spacing:-.25px;height:36px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:var(--xa-black);font-size:12px;font-weight:400;line-height:14px;height:36px;align-items:center;display:flex}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]{padding:14px 0}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{padding-left:30px}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   .comment-div[_ngcontent-%COMP%]{position:relative}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   .comment-div[_ngcontent-%COMP%]   .red-icon[_ngcontent-%COMP%]{height:7px;width:7px;position:absolute;background:var(--xa-red);top:3px;right:-1px;border-radius:50%;border:2px solid var(--xa-white)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]{border:none;font-style:normal;font-weight:700;font-size:11px;line-height:35px;color:var(--xa-black)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .image-text[_ngcontent-%COMP%]{display:flex;align-items:center;grid-gap:calc(5px + .5vw);gap:calc(5px + .5vw)}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .image-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{background:white;padding:0 10px;border-radius:19px;text-transform:capitalize;width:90px;height:20px;font-style:normal;font-size:10px;line-height:10px;display:flex;align-items:center;color:#0b0e15;flex:none;order:0;flex-grow:0;justify-content:center;font-weight:500}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.assigned[_ngcontent-%COMP%]{background:#76D672}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.readyforinvoice[_ngcontent-%COMP%]{background:#B3E573}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.noshow[_ngcontent-%COMP%]{background:#B53E3E;color:#fff}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.pickedup[_ngcontent-%COMP%]{background:#E8DA18}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]   mat-cell[_ngcontent-%COMP%]   .status.likelyouttoday[_ngcontent-%COMP%]{background:#B3E573}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]:nth-child(even){background-color:var(--xa-white-light);margin-right:0;margin-left:0}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   .data-row[_ngcontent-%COMP%]:nth-child(odd){background-color:var(--xa-table-light);margin-right:0;margin-left:0}.header-text[_ngcontent-%COMP%]{color:var(--xa-black);font-size:13px;font-weight:700;line-height:35px;letter-spacing:-.25px}.checked[_ngcontent-%COMP%]{border:1px solid var(--xa-repair-header);background-color:var(--xa-repair-header);border-radius:50%;height:20px;width:20px;position:relative;cursor:pointer;margin-right:4px}.circle[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray);background-color:var(--xa-light-radio-gray);border-radius:50%;height:20px;width:20px;position:relative;cursor:pointer;margin-right:4px}.mandatory-div[_ngcontent-%COMP%]{margin-top:10px}.mandatory-text[_ngcontent-%COMP%]{font-size:12px;font-weight:700;padding-left:30px;line-height:20px}.checked[_ngcontent-%COMP%]:after{content:"";position:absolute}.span-date[_ngcontent-%COMP%]{font-size:10px;line-height:14px;font-weight:300}.wrapper-span[_ngcontent-%COMP%]{display:flex;flex-direction:column;grid-gap:2px;gap:2px;align-items:flex-start!important;justify-content:center!important}.checked[_ngcontent-%COMP%]:after{left:7px;top:3px;width:4px;height:10px;border:solid var(--xa-white);border-width:0 3px 3px 0;transform:rotate(45deg)}.submit-button[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:20px}.relate-spinner[_ngcontent-%COMP%]{position:relative}.loading[_ngcontent-%COMP%]{margin-left:4px}.error-wrapper[_ngcontent-%COMP%]{padding:12px;justify-content:center}.error-wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{text-align:center}.not-allowed[_ngcontent-%COMP%]{cursor:not-allowed}']}),a})();var gn=Z(62119),js=Z(39912),Us=Z(9988),hd=Z(54135);const Js=["addPhotos"],gd=["imageUploaders"];function md(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"add-photos",10,11),e.NdJ("mode",function(r){return e.CHM(t),e.oxw(3).handleMode(r)}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("caseData",t.caseData)("caseNumber",t.photosHeader.caseNumber)("repairUnapproved",t.isInvalidStatus)("showSPI",t.showSPI)("photosHeader",t.addPhotosHeader)("hideBulk",t.hideBulk)("hidden",t.hideContent)("showEstimate",!1)}}function mn(a,c){1&a&&(e.TgZ(0,"div",12),e.TgZ(1,"div",13),e._UZ(2,"img",14),e.TgZ(3,"label",15),e._uU(4," No Content Available "),e.qZA(),e.qZA(),e.TgZ(5,"div",16),e._UZ(6,"div",17),e._UZ(7,"div",17),e._UZ(8,"div",17),e._UZ(9,"div",17),e.qZA(),e.qZA())}function Gr(a,c){if(1&a&&(e.TgZ(0,"div",18),e.TgZ(1,"div",19),e.TgZ(2,"div",20),e._UZ(3,"img",21),e.qZA(),e.qZA(),e.qZA()),2&a){const t=e.oxw(3);e.xp6(3),e.MGl("src","assets/img/",+t.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",e.LSH)}}function Hr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"chq-images-uploader",22,23),e.NdJ("handleDeleteAllEvent",function(){return e.CHM(t),e.oxw(3).handleDeleteAll()})("backToUpload",function(){return e.CHM(t),e.oxw(3).setInitialMode()})("updateMassUpload",function(r){return e.CHM(t),e.oxw(3).updateCurrentStatus(r)}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("maximumImages",t.minimumImageJob)("hideAI",!t.displayAI)("hidden",t.showDamageAnalysis||!t.showUploading)("currentAdditionalModeMultiple",t.currentAdditionalModeMultiple)("fileUploaderService",t.currentObservable)("footerOptions",t.footer)("isRepairStage",!0)("isMassUpload",t.isMultipleUpload)("showReTakeDelete",!0)("imageStatusSteps",t.imageStatusSteps)("header",t.photosHeader)("inspectionId",t.inspectionId)("inspection","photos")}}function zr(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"damage-analysis",24),e.NdJ("backEvent",function(r){return e.CHM(t),e.oxw(3).handleBack(r)}),e.qZA()}if(2&a){const t=e.oxw(3);e.Q6J("isBulkUpload",t.isMultipleUpload)("minPhotoRequired",t.minimumPhotosRequired)("caseDetail",t.partialCaseDetail||t.repairDetail)("steps",t.imageStatusSteps)("isRepairStage",!0)("isRepairModule",t.photosHeader.isRepairModule)("jobId",t.objectId)}}function Fo(a,c){if(1&a&&(e.ynx(0),e.YNc(1,md,2,8,"add-photos",5),e.YNc(2,mn,10,0,"div",6),e.YNc(3,Gr,4,1,"div",7),e.YNc(4,Hr,2,13,"chq-images-uploader",8),e.YNc(5,zr,1,7,"damage-analysis",9),e.BQk()),2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!1===t.showUploading),e.xp6(1),e.Q6J("ngIf",t.noImagesData),e.xp6(1),e.Q6J("ngIf",t.noImagesData),e.xp6(1),e.Q6J("ngIf",(t.showSPI||!t.hideBulk)&&(!0===t.showUploading||t.isMultipleUpload||t.imageStatusSteps&&t.imageStatusSteps.length>0)),e.xp6(1),e.Q6J("ngIf",t.showDamageAnalysis)}}const Ti=function(a){return{"photo-container":a}};function H(a,c){if(1&a&&(e.TgZ(0,"div",3),e.YNc(1,Fo,6,5,"ng-container",4),e.qZA()),2&a){const t=e.oxw();e.Q6J("ngClass",e.VKq(2,Ti,t.photosHeader.isRepairModule)),e.xp6(1),e.Q6J("chqPermission","repairStages")}}function No(a,c){1&a&&e._UZ(0,"no-access-error")}const Qr={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let Vn=(()=>{class a{constructor(t,i,r,s,p,u,m,C,O,v){this.cd=t,this.commonService=i,this.route=r,this.router=s,this.caseService=p,this.monitorService=u,this.inspectionService=m,this.bookingService=C,this.translateService=O,this.estimateService=v,this.photosHeader=Qr,this.currentUploadMode=new e.vpe,this.noImagesData=!1,this.imageStatusSteps=[],this.showUploading=!1,this.isMultipleUpload=!1,this.triggerMassUpload=!1,this.caseStatus="",this.caseId="0",this.bookingId="",this.maximumImages=20,this.setStatus=new e.vpe,this.minimumPhotosRequired=0,this.hideContent=!0,this.currentAdditionalModeMultiple=!1,this.hideUploaders=!1,this.repairTypes=[],this.repairType="",this.repairId="",this.currentRepairStatus="",this.originalSteps=[],this.showNoAccess=!1,this.footer={text:"Next create estimate",icon:"boardview",route:"case/gt",status:"UploadPhotos",caseId:"",currentStatus:"",showButton:!0,showUploadOption:!0,section:"repair-stage"},i.pageName.closed&&(i.pageName=new Vt.X(null)),i.pageName.next("photos"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new Vt.X(!0))}handleBack(t){this.showDamageAnalysis=!t.back}get checkRepairTypes(){return-1===location.href.indexOf("repair")||"repair"!==this.repairType||this.repairTypes.filter(t=>"Body"===t.repairServiceType||"Paint"===t.repairServiceType).length>0}updateCurrentStatus(t){this.monitorService.logEvent("updateCurrentStatus",["RepairPhotosComponent","addenda-quote",{caseId:t}]),t.initial?this.setInitialMode():(this.showUploading=!0,this.uploadBulkUploadFile(t.steps))}handleDeleteAll(){this.setInitialMode()}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","photos"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["RepairPhotosComponent","addenda-quote"])}uploadBulkUploadFile(t){for(let i=0;i<(null==t?void 0:t.length);i++){const r=new Image;r.src=t[i].image,r.onload=()=>{const s={height:r.height,width:r.width,inspectionId:this.inspectionId,templateId:this.inspectionBulkTemplateId,type:this.vehicelType||"",isBulk:!0,isSPI:!1,domainId:3100,objectId:this.objectId},p=t[i];p.uploadInProgress=!0,p.isSkipped=!1,p.isUploadFailed=!1,p.isUploadSuccess=!1,this.monitorService.logEvent("uploadBulkUploadFile",["RepairPhotosComponent","addenda-quote",{uploadObject:s}]),this.inspectionService.uploadImageBulkJob(s,p.imageFile).subscribe({next:u=>{var m;p.url=null===(m=u.rawImage)||void 0===m?void 0:m.rawAzureBlobUrl,p.inspectionItem=u,p.procedureSteps="Bulk Upload Image",this.imageUploaders.updateUploadStatus("success",p,null,u),this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1})},error:u=>{401!=u.status&&(this.imageUploaders.imageStatusSteps=this.imageUploaders.imageStatusSteps.filter(m=>m.index!==p.index||m.stepName!==p.stepName||!0!==m.uploadInProgress),this.imageUploaders.updateUploadStatus("failed",p,u,null,!0)),this.monitorService.logException(u,je._.Error)}})}}}uploadFile(t){const i={height:t.imageHeight,width:t.imageWidth,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,inspectionitemId:t.inspectionItem.id,type:this.vehicelType||"",isBulk:!1,isSPI:!0,domainId:3100,objectId:this.objectId};this.monitorService.logEvent("uploadFile",["RepairPhotosComponent","addenda-quote",{uploadObject:i}]),t.uploadInProgress=!0,t.isSkipped=!1,t.isUploadFailed=!1,t.isUploadSuccess=!1,this.commonService.inProgressSteps.next(1),this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1}),this.commonService.showNotification(this.translateService.instant("photos_upload",{value:t.stepName})),this.inspectionService.uploadImageBulkJob(i,t.imageFile).subscribe({next:r=>{var s,p;this.commonService.showNotification(this.translateService.instant("photos_upload_success",{value:t.stepName}));const m=this.inspectionItemTemplates.find(C=>C.inspectionItem.id==(null==r?void 0:r.id));m.inspectionItem.rawAzureBlobUrl=null===(s=r.rawImage)||void 0===s?void 0:s.rawAzureBlobUrl,m&&(t.url=null===(p=r.rawImage)||void 0===p?void 0:p.rawAzureBlobUrl,this.imageUploaders.updateUploadStatus("success",t,null,r))},error:r=>{401!=r.status&&(this.commonService.showNotification(this.translateService.instant("photo_upload_error",{value:t.stepName})),this.imageUploaders.updateUploadStatus("failed",t,r),this.monitorService.logException(r,je._.Error))}})}ngOnDestroy(){this.commonService.pageName.unsubscribe(),this.commonService.accessRight.unsubscribe(),this.monitorService.logEvent("ngOnDestroy",["RepairPhotosComponent","addenda-quote"])}mapInspection(t){if(t)try{this.inspection=t,this.uploadType=this.inspection.uploadType;let i="SPI";this.uploadType&&(this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1})),"Bulk"===this.uploadType&&(i="BULK");const r=this.inspectionTemplates.filter(p=>"Bulk Upload Image"===p.name),s=this.inspection.inspectionItems.filter(p=>("Bulk Upload Image"===p.name||p.inspectionItemTemplateID===r[0].id)&&p.rawAzureBlobUrl);if((null==s?void 0:s.length)>0||"Bulk"===this.uploadType){const p=[];this.currentUploadMode.emit({mode:"multiple"});for(const u in s){const m=Object.assign(Object.assign({},r[0]),{name:s[u].name||r[0].name,inspectionItem:s[u]});p.push(m)}this.inspectionItemTemplates=p}else this.currentUploadMode.emit({mode:"single"}),this.inspectionTemplates.map(p=>{const u=this.inspection.inspectionItems.find(m=>m.inspectionItemTemplateID==p.id);u&&(p.inspectionItem=u)}),this.inspectionItemTemplates=this.inspectionTemplates.filter(p=>"Bulk Upload Image"!=p.name);(null==r?void 0:r.length)>0&&(this.inspectionBulkTemplateId=r[0].id),this.inspectionItemTemplates.map(p=>{var u,m;(null===(u=p.inspectionItem)||void 0===u?void 0:u.rawAzureBlobUrl)?(p.isUploadSuccess=!0,p.image=null===(m=p.inspectionItem)||void 0===m?void 0:m.rawAzureBlobUrl):(p.inspectionItem||(p.inspectionItem={rawAzureBlobUrl:""}),p.inspectionItem.rawAzureBlobUrl="",p.isUploadFailed=!1,p.isUploadSuccess=!1,p.uploadInProgress=!1)}),this.uploadType&&("SPI"===i?(this.isMultipleUpload=!1,this.showUploading=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{title:"back_smart_photo"})),this.minimumPhotosRequired=this.minimumImageJob||this.inspectionItemTemplates.filter(p=>!0!==p.isSkipEnabled).length,this.currentObservable=this.uploadFile.bind(this)):(this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.minimumPhotosRequired=this.minimumImageJob||this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!0,this.isBulkUploaded=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{title:"bulk_upload"}))))}catch(i){console.log(i)}}getInspectionTemplateByObject(){var t,i,r,s,p;for(let u=0;u<(null===(t=this.inspectionItemTemplates)||void 0===t?void 0:t.length);u++){const m=this.inspectionItemTemplates[u],C=(0,cn.A1)(m,u),O=-1!=(null===(i=C.stepName)||void 0===i?void 0:i.toLowerCase().indexOf("additional photo")),v=-1!=(null===(r=C.stepName)||void 0===r?void 0:r.toLowerCase().indexOf("bulk upload image")),w=O&&!C.url;this.imageStatusSteps.push(Object.assign(Object.assign({},C),{mandatory:!m.isSkipEnabled,index:u,isAdditionalDocumentFromReviewPageOnly:w,isMassUpload:v,updatedDate:C.url?null===(s=null==m?void 0:m.inspectionItem)||void 0===s?void 0:s.updatedDate:"",uploadedDate:C.url?null===(p=null==m?void 0:m.inspectionItem)||void 0===p?void 0:p.created:"",domainId:this.domainId,objectId:this.objectId,uploadedPartGuid:"",uploadedGuid:""}))}}createInspectionForJob(t,i,r){this.inspectionService.createInspectionItemJobDetail({objectId:t,inspectionId:i,templateId:r}).subscribe({next:p=>{const u=p.data;this.uploadType=p.data.uploadType,this.mapInspection(u),setTimeout(()=>{if(this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.isJobLoading=!1,this.uploadType)this.imageUploaders.goToReview();else{if(this.showSPI&&this.hideBulk)return void this.addPhotos.allowSingleUpload();!this.showSPI&&!this.hideBulk&&this.addPhotos.allowMultipleUpload()}}),this.commonService.hideLoading()},error:()=>{this.isJobLoading=!1,this.noImagesData=!0,this.commonService.hideLoading()}})}loadApiData(){const t={};this.isJobLoading=!0,t.jobDetail=this.inspectionService.getInspectionJobDetail(this.inspectionId,this.objectId),(0,Un.D)(t).pipe((0,Jn.K)(r=>(0,Wt.of)(r))).subscribe({next:r=>{const{jobDetail:s}=r;if(204!==s.status)if(s.body){const p=s.body.data;p&&(this.inspectionDetail=p),this.mapInspection(p),this.getInspectionTemplateByObject(),setTimeout(()=>{if(this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.isJobLoading=!1,this.uploadType)this.imageUploaders.goToReview();else{if(this.showSPI&&this.hideBulk)return void this.addPhotos.allowSingleUpload();!this.showSPI&&!this.hideBulk&&this.addPhotos.allowMultipleUpload()}})}else this.noImagesData=!0,this.commonService.hideLoading();else this.createInspectionForJob(this.objectId,this.inspectionId,this.inspectionTemplateId)},error:()=>{this.noImagesData=!0,this.isJobLoading=!1,this.commonService.hideLoading()}})}ngOnInit(){var t;const i=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.addPhotosHeader=Object.assign(Object.assign({},this.photosHeader),{isHeaderOnly:!1}),this.monitorService.logEvent("ngOnInit",["RepairPhotosComponent","addenda-quote",{caseId:i,repairId:i}]),this.footer=Object.assign(Object.assign({},this.footer),{caseId:this.photosHeader.isRepairModule?"":i,repairId:this.photosHeader.isRepairModule?i:"",handleBack:this.handleBack.bind(this)}),this.commonService.accessRight.subscribe({next:s=>{s||(this.showNoAccess=!0)}}),this.showSPI||!this.hideBulk?this.loadApiData():(this.bookingService.getRepairDetailByGuid(i).subscribe({next:s=>{const{vehicle:p,repairNumber:u,status:m}=s.data;this.setStatus.emit(m),this.repairDetail=s.data,this.inspectionId=p.inspectionId,this.footer=Object.assign(Object.assign({},this.footer),{isRepairModule:!0,from:jn.j.repair}),this.commonService.repairDetails.next(s.data),this.commonService.bookingId.next(u)}}),this.hideContent=!1);const r=document.querySelector(".addenda-container");r&&(r.scrollTop=0),this.currentObservable=this.uploadFile.bind(this)}reloadInspection(){this.commonService.showLoading(),this.inspectionId&&this.inspectionService.getInspectionJobDetail(this.inspectionId,this.objectId).subscribe({next:t=>{t&&t.body&&t.body.data&&(this.mapInspection(t.body.data),this.getInspectionTemplateByObject(),this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,setTimeout(()=>{this.hideContent=!1,this.showUploading=!0}))},complete:()=>{this.commonService.hideLoading()}})}setInitialMode(){this.showUploading=!1,this.imageStatusSteps=[],this.triggerMassUpload=!1,this.isBulkUploaded=!1,this.imageUploaders.isReviewSection=!1,this.isMultipleUpload=!1,this.currentAdditionalModeMultiple=!1}handleMode(t){var i;this.monitorService.logEvent("handleMode",["RepairPhotosComponent","addenda-quote",{$event:t}]),this.inspectionId?(this.currentUploadMode.emit(t),"single"===t.mode?(0===(null===(i=this.imageStatusSteps)||void 0===i?void 0:i.length)?(this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,this.minimumPhotosRequired=this.minimumImageJob||this.inspectionItemTemplates.filter(r=>!0!==r.isSkipEnabled).length,this.reloadInspection()):(this.isMultipleUpload=!1,this.showUploading=!0,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.minimumPhotosRequired=this.minimumImageJob||this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!1),this.currentObservable=this.uploadFile.bind(this)):(this.imageStatusSteps=[],this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.triggerMassUpload=!0,this.showUploading=!0)):this.currentUploadMode.emit({mode:"error",id:this.bookingId})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(e.sBO),e.Y36(He.v),e.Y36(Be.gz),e.Y36(Be.F0),e.Y36(_i.n),e.Y36(Ge.M),e.Y36(co.a),e.Y36(on.q),e.Y36(we.sK),e.Y36(wt.H))},a.\u0275cmp=e.Xpm({type:a,selectors:[["repair-photos"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Js,5),e.Gf(gd,5)),2&t){let r;e.iGM(r=e.CRH())&&(i.addPhotos=r.first),e.iGM(r=e.CRH())&&(i.imageUploaders=r.first)}},inputs:{photosHeader:"photosHeader",displayAI:"displayAI",isInvalidStatus:"isInvalidStatus",objectId:"objectId",showSPI:"showSPI",minimumImageJob:"minimumImageJob",hideBulk:"hideBulk",inspectionId:"inspectionId",currentInspectionTemplate:"currentInspectionTemplate",repairDetail:"repairDetail",inspectionTemplateId:"inspectionTemplateId",inspectionTemplates:"inspectionTemplates"},outputs:{currentUploadMode:"currentUploadMode",setStatus:"setStatus"},decls:3,vars:3,consts:[[3,"showLoading"],[3,"ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass"],[4,"chqPermission"],[3,"caseData","caseNumber","repairUnapproved","showSPI","photosHeader","hideBulk","hidden","showEstimate","mode",4,"ngIf"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"maximumImages","hideAI","hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isRepairStage","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload",4,"ngIf"],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairStage","isRepairModule","jobId","backEvent",4,"ngIf"],[3,"caseData","caseNumber","repairUnapproved","showSPI","photosHeader","hideBulk","hidden","showEstimate","mode"],["addPhotos",""],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[3,"maximumImages","hideAI","hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isRepairStage","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload"],["imageUploaders",""],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairStage","isRepairModule","jobId","backEvent"]],template:function(t,i){1&t&&(e._UZ(0,"chq-customloader",0),e.YNc(1,H,2,4,"div",1),e.YNc(2,No,1,0,"no-access-error",2)),2&t&&(e.Q6J("showLoading",i.isJobLoading),e.xp6(1),e.Q6J("ngIf",!i.showNoAccess),e.xp6(1),e.Q6J("ngIf",i.showNoAccess))},directives:[Tt.h,_.O5,_.mk,mi.A,gn.b,js.q,Us.wm,hd.U],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),a})();const fd=["basicTimer"],Vr=function(a){return{selected:a}};function Bs(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",4),e.NdJ("click",function(){return e.CHM(t),e.oxw().setTabActive("photos")}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.VKq(4,Vr,"photos"===t.currentActiveTab)),e.xp6(1),e.Oqu(e.lcZ(2,2,"photos"))}}function ht(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",14),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return r.currentJobStarted&&!r.currentJobPaused?r.stopJobTimer():r.startJobTimer()}),e._UZ(1,"mat-icon",13),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&a){const t=e.oxw(2);e.xp6(1),e.Q6J("svgIcon",t.currentJobStarted&&!t.currentJobPaused?"stop":"start"),e.xp6(1),e.hij(" ",e.lcZ(3,2,t.currentJobStarted&&!t.currentJobPaused?"Stop Job":t.currentJobPaused?"Continue":"Start Job")," ")}}const _d=function(a){return{"row-reverse":a}};function vd(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"div",10),e.YNc(1,ht,4,4,"div",11),e.TgZ(2,"div",12),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return r.currentJobPaused?r.stopJobTimer():r.pauseJobTimer()}),e._UZ(3,"mat-icon",13),e.qZA(),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("ngClass",e.VKq(3,_d,t.currentJobStarted&&!t.currentJobStopped)),e.xp6(1),e.Q6J("ngIf",!t.currentJobStopped),e.xp6(2),e.Q6J("svgIcon",!t.currentJobStarted||t.currentJobPaused||t.currentJobStopped?"stop":"pause")}}function Ys(a,c){if(1&a&&e._UZ(0,"cd-timer",17,18),2&a){const t=e.oxw(2);e.Q6J("startTime",t.timeDuration)}}function bd(a,c){if(1&a&&(e.TgZ(0,"div",15),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,Ys,2,1,"cd-timer",16),e.qZA()),2&a){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,t.currentJobStopped?"time_spent":"timer")),e.xp6(2),e.Q6J("ngIf",t.currentJobStarted)}}function Gs(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"repair-stages-table",22),e.NdJ("updateJobs",function(){return e.CHM(t),e.oxw(2).getJobs(!0)})("confirmJob",function(){return e.CHM(t),e.oxw(2).completeJob()}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("repairStatus",t.repairStatus)("activateRepairButton",t.enableCompleteButton)("activateNotifyButton",t.enableNotifyButton)("hidden","photos"===t.currentActiveTab)("repairDataMappings",t.currentJobList)("notifyData",t.notifyData)}}function Cd(a,c){if(1&a){const t=e.EpF();e.TgZ(0,"repair-photos",23),e.NdJ("confirmJob",function(){return e.CHM(t),e.oxw(2).completeJob()})("setStatus",function(r){return e.CHM(t),e.oxw(2).setRepairStatus(r)})("currentUploadMode",function(r){return e.CHM(t),e.oxw(2).handleUpdateMode(r)}),e.qZA()}if(2&a){const t=e.oxw(2);e.Q6J("isInvalidStatus",!t.currentStatus)("inspectionTemplates",t.inspectionTemplates)("currentInspectionTemplate",t.currentInspectionTemplate)("repairDetail",t.repairDetail)("inspectionId",t.inspectionId)("inspectionTemplateId",t.inspectionTemplateId)("minimumImageJob",t.currentJobList.minNumOfPhotos)("showSPI",(null==t.currentJobList?null:t.currentJobList.isUploadPhotosRequired)&&t.currentJobList.isSPIEnabled)("displayAI",t.currentJobList.isAIAnalysisEnabled)("hideBulk",!(null!=t.currentJobList&&t.currentJobList.isUploadPhotosRequired&&t.currentJobList.isBulkUploadEnabled))("objectId",null==t.currentJobList?null:t.currentJobList.id)("hidden","tasks"===t.currentActiveTab)("photosHeader",t.header)}}function Od(a,c){if(1&a&&(e.TgZ(0,"div",19),e.YNc(1,Gs,1,6,"repair-stages-table",20),e.YNc(2,Cd,1,13,"repair-photos",21),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.currentJobList),e.xp6(1),e.Q6J("ngIf",t.currentJobList)}}const Md=function(a,c){return{selected:a,"all-border":c}};let fn=(()=>{class a{constructor(t,i,r,s,p,u,m){this.bookingService=t,this.commonService=i,this.inspectionService=r,this.router=s,this.translateService=p,this.route=u,this.monitorService=m,this.header={title:"Upload Images",step:0,description:"",stepName:"back_bulk_upload",rightActionText:"delete_all",rightActionIcon:"delete",isRepairModule:!0,showTitle:!0},this.jobList=null,this.currentActiveIndex=0,this.currentJobStarted=!1,this.currentJobStopped=!1,this.currentJobPaused=!1,this.timeDuration=0,this.repairId="",this.currentActiveTab="tasks",this.isJobLoading=!0,this.currentJobList=null,this.menuItems=[],this.repairStatus="",this.isResumed=!1,this.notifyData={},this.outBoundStatus=""}setTabActive(t){this.currentActiveTab=t}startJobTimer(){var t,i;const r=null===(i=null===(t=this.repairDetail)||void 0===t?void 0:t.booking)||void 0===i?void 0:i.startDate;if(J(new Date).diff(J(r),"days")<0)return void this.commonService.showToast(1e3,this.translateService.instant("cannot_start_future_date"));const p=this.currentJobList.repairJobGuid;this.commonService.showLoading(),this.updateJobTimerStatus(p,et.Start)}pauseJobTimer(){const t=this.currentJobList.repairJobGuid;this.commonService.showLoading(),this.updateJobTimerStatus(t,et.Pause)}get currentStatus(){var t;return["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(null===(t=this.repairStatus)||void 0===t?void 0:t.toLowerCase())}updateJobTimerStatus(t,i){var r,s,p;if(null===(r=this.currentJobList)||void 0===r?void 0:r.endDate)return void this.commonService.hideLoading();if(!["approved","repairinprogress","partsordered","partsorderedpartially","readytoinvoice","invoiced","paid","complete"].includes(null===(s=this.repairStatus)||void 0===s?void 0:s.toLowerCase()))return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("start_job"));const m=null===(p=this.jobList)||void 0===p?void 0:p.filter(C=>C.startDate&&!C.endDate);if(m&&(null==m?void 0:m.length)>0&&i===et.Start&&m[0].id!==this.currentJobList.id)return this.commonService.hideLoading(),void this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("job_in_progress",{value:m[0].name}));this.bookingService.updateRepairTimerStatus(t,i).subscribe({next:()=>{var C,O,v,w,D;let T=!1;if(i===et.Start)if(this.currentJobStarted=!0,this.currentJobPaused){this.currentJobPaused=!1;try{null===(C=this.basicTimer)||void 0===C||C.resume(),this.isResumed=!0}catch(R){this.isResumed=!1}}else"repairinprogress"!==(null===(O=this.repairDetail)||void 0===O?void 0:O.status.toLowerCase())&&this.bookingService.getRepairDetailByGuid(null===(v=this.repairDetail)||void 0===v?void 0:v.repairGuid).subscribe({next:R=>(0,Ze.mG)(this,void 0,void 0,function*(){(null==R?void 0:R.data)&&(this.commonService.repairDetails.next(R.data),this.commonService.bookingId.next(R.data.repairNumber))}),error:R=>{this.monitorService.logException(R,je._.Error)}}),T=!0;else i===et.Stop?(this.currentJobStopped=!0,this.currentJobPaused&&(null===(w=this.basicTimer)||void 0===w||w.stop(),this.currentJobPaused=!1)):(null===(D=this.basicTimer)||void 0===D||D.stop(),this.currentJobPaused=!0);this.outBoundStatus="Repair In Progress",this.repairStatus="RepairInProgress",this.getJobs(!0,T)},error:()=>{this.commonService.hideLoading()}})}stopJobTimer(){const t=this.currentJobList.repairJobGuid;this.currentJobList.endDate||(this.currentJobList.repairJobTasks.filter(r=>!1===r.isMandatory&&null===r.completedDate).length>0?this.commonService.openConfirmationOkDialog(this.translateService.instant("confirm_action"),this.translateService.instant("confirm_normal_action")).afterClosed().subscribe(s=>{s?(this.commonService.showLoading(),this.updateJobTimerStatus(t,et.Stop)):this.commonService.hideLoading()}):(this.commonService.showLoading(),this.updateJobTimerStatus(t,et.Stop)))}loadApiData(t){if(t&&"0"!=t){this.commonService.showLoading();const i={inspectionList:this.inspectionService.getInspectionTemplateList(),repairDetail:this.bookingService.getRepairDetailByGuid(t)};this.isJobLoading=!0,(0,Un.D)(i).pipe((0,Jn.K)(s=>(0,Wt.of)(s))).subscribe({next:s=>{const{inspectionList:p,repairDetail:u}=s;if(u){const{vehicle:v,repairNumber:w,status:D}=u.data;this.setRepairStatus(D),this.repairDetail=u.data,this.inspectionId=v.inspectionId,this.commonService.repairDetails.next(u.data),this.commonService.bookingId.next(w),this.notifyData={repairGuid:this.repairDetail.repairGuid,domainId:this.repairDetail.domainId,communicationList:this.repairDetail.booking.communicationTypeId,communicatedList:this.repairDetail.communicationEvents}}const m=null==p?void 0:p.data;this.outBoundStatus=this.repairDetail.outboundStatus,(null==m?void 0:m.length)>0&&(this.currentInspectionTemplate=m[0],this.inspectionTemplateId=m[0].id);const C={};C.inspectionTemplate=this.inspectionService.getInspectionTemplate(this.inspectionTemplateId),(0,Un.D)(C).pipe((0,Jn.K)(v=>(0,Wt.of)(v))).subscribe({next:v=>{const{inspectionTemplate:w}=v;this.inspectionTemplates=w.inspectionItemTemplates,this.getJobs(),this.isJobLoading=!1},error:()=>{this.commonService.hideLoading(),this.isJobLoading=!1}})},error:()=>{this.isJobLoading=!1}})}}getJobs(t,i){var r;const s=null===(r=this.route.parent)||void 0===r?void 0:r.snapshot.paramMap.get("id");t?this.commonService.hideLoading():this.commonService.showLoading(),this.bookingService.getRepairTask(s).subscribe({next:p=>(0,Ze.mG)(this,void 0,void 0,function*(){var u;if(this.jobList=p.data,0===(null===(u=this.jobList)||void 0===u?void 0:u.length))return void this.commonService.hideLoading();const m=this.jobList.filter(O=>!O.endDate),C=this.jobList.filter(O=>O.startDate);if(this.enableNotifyButton=!1,(null==C?void 0:C.length)>0&&"Repair In Progress"===this.outBoundStatus&&(this.enableNotifyButton=!0),0===(null==m?void 0:m.length))this.enableCompleteButton=!0;else{let O=!1;m.forEach(v=>{v.repairJobTasks&&v.repairJobTasks.length>0&&v.repairJobTasks.filter(D=>!0===D.isMandatory&&null===D.completedDate).length>0&&(O=!0)}),this.enableCompleteButton=!O}t?this.updateActiveTask(this.currentActiveIndex,i,t):(this.menuItems=this.jobList.map(O=>({name:O.name,icon:"",displayName:O.taskCompletionPercentage,url:"",title:O.name,subTitle:"",color:O.color,permission:!0})),this.setActiveJob(this.menuItems[this.currentActiveIndex])),this.commonService.hideLoading()}),error:()=>{this.commonService.hideLoading()}})}setRepairStatus(t){this.repairStatus=t}updateActiveTask(t,i,r){var s;if(this.currentJobList=this.jobList[t],this.currentJobList=Object.assign({},this.currentJobList),this.menuItems[t].displayName=this.currentJobList.taskCompletionPercentage,null===(s=this.currentJobList)||void 0===s?void 0:s.timerLog){const{startDate:p,endDate:u,statusName:m}=this.currentJobList.timerLog,C=J(new Date),O=J(p);if(this.currentJobStarted=!0,et.Pause===m){if(this.currentJobPaused=!0,u){const w=J(u).diff(O,"seconds");this.timeDuration=w,this.isResumed=!1,setTimeout(()=>{var D;null===(D=this.basicTimer)||void 0===D||D.stop()})}}else if(et.Stop===m){if(this.currentJobStopped=!0,u){const w=J(u).diff(O,"seconds");this.timeDuration=w,this.isResumed=!1,setTimeout(()=>{var D;null===(D=this.basicTimer)||void 0===D||D.stop()})}}else{if(!i&&r||(this.timeDuration=C.diff(O,"seconds"),!i&&this.isResumed))return;setTimeout(()=>{var v,w;i?null===(v=this.basicTimer)||void 0===v||v.start():(r||null===(w=this.basicTimer)||void 0===w||w.resume(),this.isResumed=!0)})}}}setActiveJob(t){const i=this.jobList.filter(r=>r.name===t.name);if(i.name!==t.name&&(null==i?void 0:i.length)>0){const r=this.menuItems.findIndex(s=>s.name===t.name);this.menuItems.forEach(s=>{s.active=!1}),t.active=!0,this.currentJobStarted=!1,this.currentJobStopped=!1,this.currentJobPaused=!1,this.timeDuration=0,this.menuItems[r]=t,this.menuItems=[...this.menuItems],this.reinitialize=!0,this.currentJobList=null,this.currentActiveTab="tasks",setTimeout(()=>{var s;if(this.currentActiveIndex=r,this.currentJobList=i[0],this.reinitialize=!1,null===(s=this.currentJobList)||void 0===s?void 0:s.timerLog){const{startDate:p,endDate:u,statusName:m}=this.currentJobList.timerLog,C=J(new Date),O=J(p);if(this.currentJobStarted=!0,et.Pause===m){if(this.currentJobPaused=!0,u){const w=J(u).diff(O,"seconds");this.timeDuration=w,setTimeout(()=>{this.basicTimer.stop()})}}else if(et.Stop===m){if(this.currentJobStopped=!0,u){const w=J(u).diff(O,"seconds");this.timeDuration=w,setTimeout(()=>{var D;null===(D=this.basicTimer)||void 0===D||D.stop()})}}else this.timeDuration=C.diff(O,"seconds"),setTimeout(()=>{this.basicTimer.resume()})}})}}completeJob(){var t,i;const r=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.jobList.filter(u=>u.startDate&&!u.endDate).length>0?this.commonService.openAlertDialog(this.translateService.instant("warning"),this.translateService.instant("stop_job_complete")).afterClosed().subscribe():["readytoinvoice","invoiced","paid","complete"].includes(null===(i=this.repairStatus)||void 0===i?void 0:i.toLowerCase())?this.router.navigate([`repair/booking/${r}/invoices`]):this.commonService.openConfirmationOkDialog("confirm_completing","complete_repair_process").afterClosed().subscribe({next:u=>{u&&(this.commonService.showLoading(),this.bookingService.updateRepairStatus("ReadytoInvoice",r,"").subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate([`repair/booking/${r}/invoices`])}}))},error:()=>{this.commonService.hideLoading()}})}handleUpdateMode(t){this.header=Object.assign(Object.assign({},this.header),"single"===t.mode?{title:"back_smart_photo"}:{title:"back_bulk_upload"})}ngOnInit(){var t;const i=null===(t=this.route.parent)||void 0===t?void 0:t.snapshot.paramMap.get("id");this.loadApiData(i)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(on.q),e.Y36(He.v),e.Y36(co.a),e.Y36(Be.F0),e.Y36(we.sK),e.Y36(Be.gz),e.Y36(Ge.M))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-repair-stages"]],viewQuery:function(t,i){if(1&t&&e.Gf(fd,5),2&t){let r;e.iGM(r=e.CRH())&&(i.basicTimer=r.first)}},decls:12,vars:12,consts:[[3,"menuItems","menuItemClick"],[1,"content-wrapper"],[1,"control-nav"],[1,"switch"],[3,"ngClass","click"],[3,"ngClass","click",4,"ngIf"],[1,"time-counter"],["class","button-wrapper",3,"ngClass",4,"ngIf"],["class","timer-div",4,"ngIf"],["class","content",4,"ngIf"],[1,"button-wrapper",3,"ngClass"],["class","start-capsule",3,"click",4,"ngIf"],[1,"stop-capsule",3,"click"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon"],[1,"start-capsule",3,"click"],[1,"timer-div"],[3,"startTime",4,"ngIf"],[3,"startTime"],["basicTimer",""],[1,"content"],[3,"repairStatus","activateRepairButton","activateNotifyButton","hidden","repairDataMappings","notifyData","updateJobs","confirmJob",4,"ngIf"],[3,"isInvalidStatus","inspectionTemplates","currentInspectionTemplate","repairDetail","inspectionId","inspectionTemplateId","minimumImageJob","showSPI","displayAI","hideBulk","objectId","hidden","photosHeader","confirmJob","setStatus","currentUploadMode",4,"ngIf"],[3,"repairStatus","activateRepairButton","activateNotifyButton","hidden","repairDataMappings","notifyData","updateJobs","confirmJob"],[3,"isInvalidStatus","inspectionTemplates","currentInspectionTemplate","repairDetail","inspectionId","inspectionTemplateId","minimumImageJob","showSPI","displayAI","hideBulk","objectId","hidden","photosHeader","confirmJob","setStatus","currentUploadMode"]],template:function(t,i){1&t&&(e.TgZ(0,"button-tabs",0),e.NdJ("menuItemClick",function(s){return i.setActiveJob(s)}),e.qZA(),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"div",4),e.NdJ("click",function(){return i.setTabActive("tasks")}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,Bs,3,6,"div",5),e.qZA(),e.TgZ(8,"div",6),e.YNc(9,vd,4,5,"div",7),e.YNc(10,bd,5,4,"div",8),e.qZA(),e.qZA(),e.YNc(11,Od,3,2,"div",9),e.qZA()),2&t&&(e.Q6J("menuItems",i.menuItems),e.xp6(4),e.Q6J("ngClass",e.WLB(9,Md,"tasks"===i.currentActiveTab,!(null!=i.currentJobList&&i.currentJobList.isUploadPhotosRequired&&(null!=i.currentJobList&&i.currentJobList.isSPIEnabled||null!=i.currentJobList&&i.currentJobList.isBulkUploadEnabled)))),e.xp6(1),e.Oqu(e.lcZ(6,7,"tasks")),e.xp6(2),e.Q6J("ngIf",(null==i.currentJobList?null:i.currentJobList.isUploadPhotosRequired)&&((null==i.currentJobList?null:i.currentJobList.isSPIEnabled)||(null==i.currentJobList?null:i.currentJobList.isBulkUploadEnabled))),e.xp6(2),e.Q6J("ngIf",!i.commonService.isViewOnly),e.xp6(1),e.Q6J("ngIf",null==i.currentJobList?null:i.currentJobList.isTimerEnabled),e.xp6(1),e.Q6J("ngIf",!i.reinitialize))},directives:[cd,_.mk,_.O5,Xe.Hw,ll,Ns,Vn],pipes:[we.X$],styles:[".content-wrapper[_ngcontent-%COMP%]{background-color:var(--xa-popup-light-gray);padding:16px 30px}.control-nav[_ngcontent-%COMP%]{display:flex;grid-gap:46px;gap:46px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]{display:flex;padding:8px 16px;align-items:center;grid-gap:10px;gap:10px;border-radius:10px;margin-bottom:20px;background:var(--xa-bold-gray);color:var(--xa-black-medium);font-size:12px;font-weight:400;line-height:14px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .start-capsule[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer;grid-gap:10px;gap:10px;padding:7px 14px;flex-shrink:0;border-radius:18px;border:1px solid var(--xa-light-gray);background:var(--xa-light-capsule-white)}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .start-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:14px;width:14px;cursor:inherit}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]{border-radius:50%;background:var(--xa-bold-gray);display:flex;align-items:center;justify-content:center;padding:8px}.control-nav[_ngcontent-%COMP%]   .time-counter[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:12px;width:12px;fill:var(--xa-lighter-gray)!important}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray)}.control-nav[_ngcontent-%COMP%]   .row-reverse[_ngcontent-%COMP%]   .stop-capsule[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:16px!important;width:16px!important;fill:var(--xa-black)!important}button-tabs[_ngcontent-%COMP%]{display:flex}.button-wrapper[_ngcontent-%COMP%]{display:flex;grid-gap:10px;gap:10px}.timer-div[_ngcontent-%COMP%]{display:flex;align-items:center;grid-gap:10px;gap:10px}.switch[_ngcontent-%COMP%]{display:flex;margin-bottom:18px;align-items:center}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;padding:10px 21px;flex-direction:column;align-items:center;grid-gap:10px;gap:10px;cursor:pointer;color:var(--xa-black);font-size:16px;font-style:normal;font-weight:400;line-height:20px;border:1px solid var(--xa-light-gray);background:var(--xa-popup-light-gray)}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:first-child{border-radius:8px 0 0 8px}.switch[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{border-radius:0 8px 8px 0}.switch[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:var(--xa-secondary);color:var(--xa-white)}.switch[_ngcontent-%COMP%]   .all-border[_ngcontent-%COMP%]{border-radius:8px!important}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.wrapper[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;line-height:24px;font-weight:700}.hide-block[_ngcontent-%COMP%]{display:none!important}"]}),a})();var bt=Z(20363);const Wr=[{path:"",component:Ka},{path:"refresh",component:Ka},{path:"document",component:gr,resolve:{version:Fn.n}},{path:"photos",component:Co,resolve:{version:Fn.n}},{path:"estimate",component:ja,resolve:{version:Fn.n}},{path:"parts",component:ld,resolve:{version:Fn.n}},{path:"repair-stages",component:fn,resolve:{version:Fn.n}},{path:"invoices",component:Ur,resolve:{version:Fn.n}},{path:"invoicesEdit",component:jc,resolve:{version:Fn.n}}];let xd=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[[_.ez,Be.Bz.forChild(Wr),ul.H,pl.m,ga.FA,Xe.Ps,al,dl.T,cl,we.aw,ma.k,bt.Z,wi.Cq,Er],Be.Bz,ga.FA,Er]}),a})()}}]);