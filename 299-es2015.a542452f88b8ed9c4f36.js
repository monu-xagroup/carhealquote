"use strict";(self.webpackChunkcar_heal_quote=self.webpackChunkcar_heal_quote||[]).push([[299],{14368:function(e,t,i){i.d(t,{I:function(){return r}});var n=i(22238),o=i(37716),a=i(95016),s=i(29790);let r=(()=>{class e{constructor(e,t,i){this.dialogRef=e,this.monitorService=t,this.data=i}continue(){this.dialogRef.close(!0),this.monitorService.logEvent("close",["GtMotiveEstimationDialogComponent","addenda-quote"])}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(n.so),o.Y36(a.M),o.Y36(n.WI))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-gt-motive-estimation-dialog"]],decls:11,vars:3,consts:[[1,"message-container"],[1,"header"],[1,"content"],[1,"footer","form-data-footer"],["mat-dialog-close","",1,"btn-confirm",3,"click"]],template:function(e,t){1&e&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"h3"),o._uU(3,"Notification!"),o.qZA(),o.qZA(),o.TgZ(4,"div",2),o.TgZ(5,"label"),o._uU(6),o.ALo(7,"translate"),o.qZA(),o.qZA(),o.TgZ(8,"div",3),o.TgZ(9,"button",4),o.NdJ("click",function(){return t.continue()}),o._uU(10,"Continue"),o.qZA(),o.qZA(),o.qZA()),2&e&&(o.xp6(6),o.Oqu(o.lcZ(7,1,t.data.message)))},directives:[n.ZT],pipes:[s.X$],styles:[".message-container[_ngcontent-%COMP%]{padding:20px 20px 40px 62px;width:480px;background-color:var(--xa-white)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:38px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;cursor:pointer;height:36px!important;width:36px!important;border-radius:50%;background:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{fill:var(--xa-white)!important;text-align:center;height:16px!important;width:16px!important}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle;position:relative;top:7px}.message-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .close-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{fill:#fff}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:32px;margin-right:38px}.message-container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black)}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;margin-top:52px;margin-right:38px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;display:block;background-color:var(--xa-black);color:#fff}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{margin-right:4px}.message-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{margin-left:4px}"]}),e})()},60562:function(e,t,i){i.d(t,{br:function(){return o},mo:function(){return a},nG:function(){return s},Gp:function(){return r}});var n=i(3679);const o=()=>({vin:{placeHolder:"search_vin",name:"vin",label:"vin_number",type:"text",value:0,icon:"search",maxLength:17,validation:{name:"vin",validationFunction:()=>n.kI.compose([n.kI.minLength(17),n.kI.pattern("^[a-hA-Hj-nJ-NpPr-zR-Z0-9]+$")]),validationMessage:e=>e.pattern?"pattern_vin":e.minlength?"min_length_vin":""}},make:{placeHolder:"make",name:"make",label:"make",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:0,validation:{name:"make",validationFunction:()=>n.kI.compose([n.kI.required]),validationMessage:e=>e.required?"required_make":""}},model:{placeHolder:"model",name:"model",label:"model",options:[{}],displayValue:"modelDescription",fieldValue:"modelDescription",type:"select",value:0,validation:{name:"model",validationFunction:()=>n.kI.compose([n.kI.required]),validationMessage:e=>e.required?"required_model":""}},year:{placeHolder:"import_interval",label:"import_interval",name:"year",options:[{}],displayValue:"name",fieldValue:"name",type:"select",value:0,validation:{name:"year",validationFunction:()=>n.kI.compose([n.kI.required]),validationMessage:e=>e.required?"required_year":""}},licensePlate:{placeHolder:"license_plate",label:"license_plate",name:"licensePlate",value:0,type:"text",maxLength:12,validation:{name:"licensePlate",validationFunction:()=>n.kI.compose([n.kI.required,n.kI.maxLength(12),n.kI.pattern("^[a-zA-Z0-9]*$"),r()]),validationMessage:e=>e.required?"required_license_plate":e.maxlength?"max_length_license_plate":e.pattern?"pattern_digit_alphabets":e.invalidLicensePlate?"invalid_license_plate":""}},carMilege:{placeHolder:"car_mileage",label:"mileage",name:"carMilege",value:0,type:"text",maxLength:7,validation:{name:"carMilege",validationFunction:()=>n.kI.compose([n.kI.required,n.kI.maxLength(7),n.kI.pattern("^[0-9]+$"),s()]),validationMessage:e=>e.required?"required_car_mileage":e.maxlength?"max_length_car_mileage":e.pattern?"pattern_numeric":e.invalidCarMileage?"invalid_car_mileage":""}},registrationDate:{placeHolder:"first_reg_mfg_date",label:"reg_mfg_date",name:"registrationDate",value:"",type:"date",maxDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()-1),minDate:new Date("1980-01-01"),disabled:!0,validation:{name:"registrationDate",validationFunction:()=>n.kI.compose([n.kI.required]),validationMessage:e=>e.required?"required_date":""}}}),a={title:"add_vehicle",step:2,description:"add_vehicle_msg",stepName:"step_two"};function s(){const e={invalidCarMileage:!1};return t=>t.value<1&&""!=t.value?(e.invalidCarMileage=!0,e):null}function r(){const e={invalidLicensePlate:!1};return t=>"0"===t.value?(e.invalidLicensePlate=!0,e):null}},74743:function(e,t,i){i.d(t,{n:function(){return l}});var n=i(27969),o=i(84945),a=i(33568),s=i(37716),r=i(4893);let l=(()=>{class e{constructor(e){this.commonService=e}resolve(){return this.commonService.showLoading(),this.commonService.checkVersion().pipe((0,n.U)(e=>{this.commonService.hideLoading();const t=localStorage.getItem("appVersion"),i=e.buildRevision;return t&&t!=i?(localStorage.setItem("appVersion",i),setTimeout(()=>{location.reload()},10),(0,o.of)("new version available")):(localStorage.setItem("appVersion",i),(0,o.of)("new version is not available"))}),(0,a.K)(()=>(this.commonService.hideLoading(),(0,o.of)("data not available at this time"))))}}return e.\u0275fac=function(t){return new(t||e)(s.LFG(r.v))},e.\u0275prov=s.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},62119:function(e,t,i){i.d(t,{b:function(){return w}});var n=i(37716),o=i(95016),a=i(4893),s=i(55278),r=i(22238),l=i(38709),d=i(13975),c=i(87855),u=i(56785),p=i(38583),m=i(35782),h=i(36978),g=i(29790);function v(e,t){if(1&e&&n._UZ(0,"chq-step-header",11),2&e){const e=n.oxw();n.Q6J("chqModel",e.photosHeader)}}function f(e,t){if(1&e&&(n.TgZ(0,"div",15),n.TgZ(1,"label",16),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"p",17),n._uU(5),n.ALo(6,"translate"),n.qZA(),n.TgZ(7,"p",18),n._uU(8),n.ALo(9,"translate"),n.qZA(),n._UZ(10,"chq-button",19),n.qZA()),2&e){const e=n.oxw(2);n.xp6(2),n.Oqu(n.lcZ(3,4,"smart_photo_inspection")),n.xp6(3),n.Oqu(n.lcZ(6,6,"open_your_camera")),n.xp6(3),n.hij(" ",n.lcZ(9,8,"add_photo_msg")," "),n.xp6(2),n.Q6J("buttonModel",e.cameraButtonModel)}}function S(e,t){if(1&e&&(n.TgZ(0,"div",15),n.TgZ(1,"label",16),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.TgZ(4,"p",17),n._uU(5),n.ALo(6,"translate"),n.qZA(),n.TgZ(7,"p",18),n._uU(8),n.ALo(9,"translate"),n.qZA(),n._UZ(10,"chq-button",19),n.qZA()),2&e){const e=n.oxw(2);n.xp6(2),n.Oqu(n.lcZ(3,4,"bulk_upload")),n.xp6(3),n.Oqu(n.lcZ(6,6,"upload_device")),n.xp6(3),n.hij(" ",n.lcZ(9,8,"bulk_msg")," "),n.xp6(2),n.Q6J("buttonModel",e.bulkUploadButtonModel)}}function b(e,t){if(1&e&&(n.TgZ(0,"div",12),n.TgZ(1,"div",13),n.YNc(2,f,11,10,"div",14),n.YNc(3,S,11,10,"div",14),n.qZA(),n.qZA()),2&e){const e=n.oxw();n.xp6(2),n.Q6J("ngIf",e.showSPI),n.xp6(1),n.Q6J("ngIf",!e.hideBulk)}}function x(e,t){if(1&e&&(n.TgZ(0,"div",20),n.TgZ(1,"div",21),n._UZ(2,"img",22),n.TgZ(3,"label",23),n._uU(4),n.ALo(5,"translate"),n.qZA(),n.qZA(),n.qZA()),2&e){const e=n.oxw();n.xp6(4),n.hij(" ",n.lcZ(5,1,e.repairUnapproved?"start_job":"bulk_spi_disabled")," ")}}function Z(e,t){if(1&e&&n._UZ(0,"chq-button",19),2&e){const e=n.oxw();n.Q6J("buttonModel",e.cancelButtonModel)}}function q(e,t){if(1&e&&n._UZ(0,"chq-button",24),2&e){const e=n.oxw();n.Q6J("buttonModel",e.nextButton)}}const A={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let w=(()=>{class e{constructor(e,t,i,o,a,s,r,l,d){this.monitorService=e,this.commonService=t,this.route=i,this.dialog=o,this.caseService=a,this.router=s,this.inspectionService=r,this.estimateService=l,this.calendarService=d,this.mode=new n.vpe,this.showEstimate=!1,this.nextButton={label:"Next create estimate",type:"primary",color:"primary",icon:"boardview"},this.photosHeader=A,this.cameraButtonModel={label:"camera_upload",type:"primary",icon:"camera",color:"primary",onclick:this.allowSingleUpload.bind(this)},this.bulkUploadButtonModel={label:"btn_bulk_upload",type:"primary",icon:"upload",color:"primary",onclick:this.allowMultipleUpload.bind(this)},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)}}allowSingleUpload(){this.mode.emit({mode:"single"})}get showDelete(){var e,t,i,n,o,a,s;return!(!(null===(e=this.repairData)||void 0===e?void 0:e.repairGuid)||"draft"!==(null===(i=null===(t=this.repairData)||void 0===t?void 0:t.status)||void 0===i?void 0:i.toLowerCase()))||!(!(null===(n=this.repairData)||void 0===n?void 0:n.repairGuid)||1!=(null===(o=this.repairData)||void 0===o?void 0:o.repairGuidisRepairCreatedFromCase)||"repairestimation"!=(null===(s=null===(a=this.repairData)||void 0===a?void 0:a.status)||void 0===s?void 0:s.toLowerCase()))}ngOnChanges(e){this.monitorService.logEvent("allowMultipleUpload",["ChqAddPhotosComponent","addenda-quote",{changes:e}]),e&&e.caseNumber&&e.caseNumber.currentValue&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{caseNumber:this.caseNumber}))}allowMultipleUpload(){this.monitorService.logEvent("allowMultipleUpload",["ChqAddPhotosComponent","addenda-quote"]),this.mode.emit({mode:"multiple"})}redirectToGtEstimate(){this.commonService.showLoading();const{status:e,caseGuid:t,inspections:i,vehicleId:n,domainID:o}=this.caseData;let a=0;(null==i?void 0:i.length)>0&&(a=i[0].inspectionId),"uploaddocuments"===(null==e?void 0:e.toLowerCase())?(this.monitorService.logEvent("redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:t}]),this.caseService.updateCaseStatus(t,"UploadPhotos").subscribe({next:e=>{this.estimateService.createEstimate(t,a,n,o).subscribe({next:e=>{var t,i;e&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.url)&&(location.href=null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}})},error:()=>{this.commonService.hideLoading()}})):"uploadphotos"===(null==e?void 0:e.toLowerCase())?(this.monitorService.logEvent("redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:t}]),this.estimateService.createEstimate(t,a,n,o).subscribe({next:e=>{e&&(null==e?void 0:e.data)&&(location.href=e.data.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}})):(this.monitorService.logEvent("skipped_redirectToGtEstimate",["ChqDamageAnalysisComponent","addenda-quote",{caseId:t}]),this.router.navigate([`/case/${t}/estimate`]))}ngOnInit(){this.nextButton.onclick=this.redirectToGtEstimate.bind(this)}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(e=>{var t,i;e&&(this.commonService.showLoading(),this.calendarService.deleteBooking(null===(i=null===(t=this.repairData)||void 0===t?void 0:t.booking)||void 0===i?void 0:i.bookingGuid).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(o.M),n.Y36(a.v),n.Y36(s.gz),n.Y36(r.uw),n.Y36(l.n),n.Y36(s.F0),n.Y36(d.a),n.Y36(c.H),n.Y36(u.o))},e.\u0275cmp=n.Xpm({type:e,selectors:[["add-photos"]],inputs:{caseNumber:"caseNumber",caseData:"caseData",showEstimate:"showEstimate",repairUnapproved:"repairUnapproved",repairData:"repairData",photosHeader:"photosHeader",showSPI:"showSPI",hideBulk:"hideBulk"},outputs:{mode:"mode"},features:[n.TTD],decls:11,vars:6,consts:[[1,"add-photo-container"],[3,"chqModel",4,"ngIf"],["class","photo-container",4,"ngIf"],["class","wrapper",4,"ngIf"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper","wrapper-flex"],[1,"image-wrapper"],[3,"src"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"],["class","margin-right",3,"buttonModel",4,"ngIf"],[3,"chqModel"],[1,"photo-container"],[1,"card-container"],["class","card",4,"ngIf"],[1,"card"],[1,"card-title"],[1,"card-action"],[1,"card-description"],[3,"buttonModel"],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"margin-right",3,"buttonModel"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n.YNc(1,v,1,1,"chq-step-header",1),n.YNc(2,b,4,2,"div",2),n.YNc(3,x,6,3,"div",3),n.TgZ(4,"div",4),n.TgZ(5,"div",5),n.TgZ(6,"div",6),n._UZ(7,"img",7),n.qZA(),n.TgZ(8,"div",8),n.YNc(9,Z,1,1,"chq-button",9),n.YNc(10,q,1,1,"chq-button",10),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&e&&(n.xp6(1),n.Q6J("ngIf",!0!==t.photosHeader.isRepairModule||!0===t.photosHeader.isHeaderOnly),n.xp6(1),n.Q6J("ngIf",(t.showSPI||!t.hideBulk)&&!t.repairUnapproved&&!t.commonService.isViewOnly),n.xp6(1),n.Q6J("ngIf",!t.showSPI&&t.hideBulk||t.repairUnapproved||t.commonService.isViewOnly),n.xp6(4),n.MGl("src","assets/img/",+t.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",n.LSH),n.xp6(2),n.Q6J("ngIf",t.showDelete&&(null==t.photosHeader?null:t.photosHeader.isRepairModule)),n.xp6(1),n.Q6J("ngIf",t.showEstimate&&!t.photosHeader.isRepairModule))},directives:[p.O5,m._,h.E],pipes:[g.X$],styles:[".photo-container[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:calc(100vh - 170px - (calc(1.5vw)) - (calc(5px + 1.5vw + 48px + 1.6vw)));justify-content:space-evenly;border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-card-dark);margin-top:calc(18px + 1.5vh);margin-bottom:calc(12px + 1.5vh)}.card-container[_ngcontent-%COMP%]{display:flex;justify-content:center;grid-gap:27px;gap:27px}.wrapper-flex[_ngcontent-%COMP%]{flex:1;justify-content:space-between;align-items:center}.margin-right[_ngcontent-%COMP%]{margin-right:20px}.card[_ngcontent-%COMP%]{border:1px solid var(--xa-light-gray);padding:16px;width:202px;background-color:var(--xa-white);border-radius:8px}.card-title[_ngcontent-%COMP%]{font-weight:600;font-size:16px;line-height:20px}.card-action[_ngcontent-%COMP%]{font-weight:600;font-size:12px;line-height:21px;margin:0;color:var(--xa-black-medium)}.card-description[_ngcontent-%COMP%]{font-size:12px;line-height:18px;margin-bottom:30px;color:var(--xa-dark-gray)}.image-car[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:654px}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:50px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),e})()},54135:function(e,t,i){i.d(t,{U:function(){return o}});var n=i(37716);let o=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Xpm({type:e,selectors:[["no-access-error"]],decls:3,vars:0,consts:[[1,"main-container"],[1,""],["src","assets/img/no-access.png"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n._UZ(2,"img",2),n.qZA(),n.qZA())},styles:[".main-container[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column;align-items:center;justify-content:center}"]}),e})()},64307:function(e,t,i){i.d(t,{O:function(){return y}});var n=i(97582),o=i(7408),a=i(54121),s=i(84967),r=i(33568),l=i(84945),d=i(83853),c=i(37716),u=i(4893),p=i(55278),m=i(38709),h=i(95016),g=i(8985),v=i(74178),f=i(38583),S=i(39912),b=i(54135);const x=["imageUploaders"];function Z(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"chq-images-uploader",4,5),c.NdJ("cardSelection",function(t){return c.CHM(e),c.oxw(2).setObservable(t)})("stepSkipped",function(){return c.CHM(e),c.oxw(2).stepSkipped()}),c.qZA()}if(2&e){const e=c.oxw(2);c.Q6J("fileUploaderService",e.currentObservable)("footerOptions",e.footer)("imageStatusSteps",e.imageStatusSteps)("header",e.documentHeader)}}function q(e,t){1&e&&(c.TgZ(0,"div",6),c.TgZ(1,"div",7),c._UZ(2,"img",8),c.TgZ(3,"label",9),c._uU(4," No Content Available "),c.qZA(),c.qZA(),c.TgZ(5,"div",10),c._UZ(6,"div",11),c._UZ(7,"div",11),c._UZ(8,"div",11),c._UZ(9,"div",11),c.qZA(),c.qZA())}function A(e,t){if(1&e&&(c.TgZ(0,"div",12),c.TgZ(1,"div",13),c.TgZ(2,"div",14),c._UZ(3,"img",15),c.qZA(),c.qZA(),c.qZA()),2&e){const e=c.oxw(2);c.xp6(3),c.MGl("src","assets/img/",+e.documentHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",c.LSH)}}function w(e,t){if(1&e&&(c.TgZ(0,"div"),c.YNc(1,Z,2,4,"chq-images-uploader",1),c.YNc(2,q,10,0,"div",2),c.YNc(3,A,4,1,"div",3),c.qZA()),2&e){const e=c.oxw();c.xp6(1),c.Q6J("ngIf",e.imageStatusSteps&&e.imageStatusSteps.length>0),c.xp6(1),c.Q6J("ngIf",e.noDocumentData),c.xp6(1),c.Q6J("ngIf",e.noDocumentData)}}function _(e,t){1&e&&c._UZ(0,"no-access-error")}const T={title:"add_documents",step:3,description:"add_documents_msg",stepName:"step_three"};let y=(()=>{class e{constructor(e,t,i,n,o,s,r){this.cd=e,this.commonService=t,this.route=i,this.caseService=n,this.monitorService=o,this.bookingService=s,this.mediaCollectionService=r,this.documentHeader=T,this.imageStatusSteps=[],this.allowExtension=["jpg","jpeg","png"],this.skipButtonModel={label:"Skip",type:"primary"},this.footer={text:"Next add photos",icon:"review",route:"quote/case/photos",currentStatus:"",status:"UploadDocuments",caseId:""},this.documentSizeLimit=5242880,this.noDocumentData=!1,this.repairId="",this.currentRepairStatus="",this.showNoAccess=!1,this.statusUpdated=!1,t.pageName.closed&&(t.pageName=new a.X(null)),t.pageName.next("document"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new a.X(!0))}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","document"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["ChqNewDocumentsComponent","addenda-quote"])}checkRouteParams(){var e;null===(e=this.route.queryParams)||void 0===e||e.subscribe(e=>{const t=e.fromPersonal;("true"===t||!0===t)&&(this.imageStatusSteps=this.imageStatusSteps.filter(e=>-1!=e.stepName.indexOf("Vehicle Registration")))})}setObservable(e){this.currentObservable=e.uploadedGuid&&e.uploadedPartGuid?this.updateFile.bind(this):this.uploadFile.bind(this)}getMediaTemplateByObject(){var e;this.mediaPartTemplates=this.commonService.getAllChild(null===(e=this.mediaTemplate)||void 0===e?void 0:e.mediaTemplates,"mediaPartTemplates","mediaTemplateGuid",{parentProp:"name",childProp:"parentName"});for(let t=0;t<this.mediaPartTemplates.length;t++){const e=this.mediaPartTemplates[t],i=(0,d.sH)(e,t),n=-1!=i.stepName.toLowerCase().indexOf("additional document")&&!i.url;this.imageStatusSteps.push(Object.assign(Object.assign({},i),{mandatory:e.mandatory,index:t,isAdditionalDocumentFromReviewPageOnly:n,parentName:e.parentName,isFront:e.frontSide,updatedDate:"00000000-0000-0000-0000-000000000000"!=e.mediaPartGuid?e.updatedDate:"",uploadedDate:"00000000-0000-0000-0000-000000000000"!=e.mediaPartGuid?e.createdDate:"",domainId:this.domainId,objectId:this.objectId,sizeLimit:e.sizeLimit,allowExtension:e.allowExtension,uploadedPartGuid:"00000000-0000-0000-0000-000000000000"!=e.mediaPartGuid?e.mediaPartGuid:"",uploadedGuid:"00000000-0000-0000-0000-000000000000"!=e.mediaGuid?e.mediaGuid:"",partTemplateGuid:e.mediaPartTemplateGuid,templateGuid:e.mediaTemplateGuid})),this.checkRouteParams()}}updateRepairStatus(e){this.statusUpdated||(this.statusUpdated=!0,this.bookingService.updateRepairStatus("UploadDocuments",e,"").subscribe({next:()=>{this.currentRepairStatus="UploadDocuments",this.footer.currentStatus=this.currentRepairStatus,this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairId).subscribe({next:e=>(0,n.mG)(this,void 0,void 0,function*(){(null==e?void 0:e.data)&&(this.commonService.repairDetails.next(e.data),this.commonService.bookingId.next(e.data.repairNumber),this.commonService.hideLoading())}),error:e=>{this.monitorService.logException(e,o._.Error),this.commonService.hideLoading()}})}}))}uploadFile(e){const t={mediaCollectionId:this.mediaTemplate.collectionGuid,domainId:this.domainId,objectId:this.objectId,mediaTemplateId:e.templateGuid,mediaPartTemplateId:e.partTemplateGuid};this.monitorService.logEvent("uploadFile",["ChqNewDocumentsComponent","addenda-quote",{obj:t}]),e.uploadInProgress=!0,e.isSkipped=!1,e.isUploadFailed=!1,e.isUploadSuccess=!1,this.commonService.showNotification("Your photo is currently uploading won\u2019t be long and we\u2019ll \n    notify you when its uploaded, you can continue to take your photos."),this.mediaCollectionService.uploadDocument(e.imageFile,t).subscribe({next:t=>{var i,n,o;const a=null==t?void 0:t.data,s=null===(i=this.mediaPartTemplates)||void 0===i?void 0:i.find(e=>e.mediaPartTemplateGuid==(null==a?void 0:a.mediaPartTemplateId));s&&(s.mediaGuid=a.mediaGuid,s.mediaPartGuid=a.mediaPartGuid,location.href.includes("repair")&&"draft"===(null===(n=this.currentRepairStatus)||void 0===n?void 0:n.toLowerCase())&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"vehicledetails"===(null===(o=this.footer.currentStatus)||void 0===o?void 0:o.toLowerCase())&&this.updateStatus(),this.imageUploaders.updateUploadStatus("success",e,null,a))},error:t=>{if(401!=t.status)try{this.imageUploaders.updateUploadStatus("failed",e,t)}catch(i){this.imageUploaders.updateUploadStatus("failed",e)}this.monitorService.logException(t,o._.Error)},complete:()=>this.commonService.hideLoading()})}updateFile(e){const t={objectId:this.objectId,mediaGuid:e.uploadedGuid,mediaPartGuid:e.uploadedPartGuid};this.monitorService.logEvent("updateFile",["ChqNewDocumentsComponent","addenda-quote",{obj:t}]),e.uploadInProgress=!0,e.isSkipped=!1,e.isUploadFailed=!1,e.isUploadSuccess=!1,this.mediaCollectionService.updateDocument(e.imageFile,t).subscribe({next:t=>{this.imageUploaders.updateUploadStatus("success",e)},error:t=>{if(401!=t.status)try{this.imageUploaders.updateUploadStatus("failed",e,t)}catch(i){this.imageUploaders.updateUploadStatus("failed",e)}this.monitorService.logException(t,o._.Error)},complete:()=>this.commonService.hideLoading()})}updateStatus(){this.statusUpdated||(this.statusUpdated=!0,this.monitorService.logEvent("updateStatus",["ChqNewDocumentsComponent","addenda-quote",{caseId:this.footer.caseId}]),this.caseService.updateCaseStatus(this.footer.caseId,"UploadDocuments").subscribe({next:()=>{this.footer=Object.assign(Object.assign({},this.footer),{status:""})}}))}mapMediaTemplate(e){if(this.mediaTemplate)try{for(let t=0;t<this.mediaTemplate.mediaTemplates.length;t++){const i=this.mediaTemplate.mediaTemplates[t],n=e.find(e=>e.mediaTemplateGuid==i.mediaTemplateGuid);if(n)for(let e=0;e<i.mediaPartTemplates.length;e++){const t=i.mediaPartTemplates[e],o=n.mediaParts.find(e=>e.mediaPartTemplateGuid==t.mediaPartTemplateGuid);t.mediaGuid=n.mediaGuid,t.mediaPartGuid=o.mediaPartGuid,t.createdDate=o.createdDate,t.updatedDate=o.updatedDate,t.image=o.getURL,t.isUploadSuccess=!1,t.mediaPartGuid&&"00000000-0000-0000-0000-000000000000"!=t.mediaPartGuid&&(t.isUploadSuccess=!0)}}this.mediaTemplate=Object.assign({},this.mediaTemplate)}catch(t){console.log(t)}}ngOnInit(){var e;this.commonService.showLoading();const t=null===(e=this.route.parent)||void 0===e?void 0:e.snapshot.paramMap.get("id");this.monitorService.logEvent("ngOnInit",["ChqNewDocumentsComponent","addenda-quote",{caseId:t}]),this.footer=Object.assign(Object.assign({},this.footer),{route:`quote/case/${t}/photos`,caseId:t}),this.commonService.accessRight.subscribe({next:e=>{e||(this.showNoAccess=!0)}});const i={mediaTemplate:this.mediaCollectionService.getMediaTemplate()};let n=!1;location.href.includes("repair")?(i.bookingDetail=this.bookingService.getRepairDetailByGuid(t),n=!0):(this.commonService.userProfileData.subscribe(e=>{if(e&&e.data){const{organizationDetail:t}=e.data;this.currentOrgId=t.id}}),i.caseDetail=this.caseService.getCaseDetail(t)),(0,s.D)(i).pipe((0,r.K)(e=>(0,l.of)(e))).subscribe(e=>{if(e){const t=e.mediaTemplate;if(t){const i=t.data;if(e.caseDetail){const{caseNumber:t,id:i,status:n,inspections:o,repairGuid:a,organizationDetail:s}=e.caseDetail.data;this.commonService.isViewOnly=this.currentOrgId!=(null==s?void 0:s.organizationId),o.length>0&&this.commonService.inspectionId.next(o[0].inspectionId),this.commonService.caseStatus.next(n),"vehicledetails"===n.toLowerCase()||(this.footer=Object.assign(Object.assign({},this.footer),{status:""})),this.footer.currentStatus=n,this.documentHeader.caseNumber=t,this.objectId=i,a&&(this.footer.repairId=a,this.footer.from="Quote")}if(e.bookingDetail){const{id:t,status:i,repairGuid:n,quoteId:o,repairNumber:a,isRepairCreatedFromCase:s,booking:r}=e.bookingDetail.data;this.objectId=t,this.repairId=n,o&&(this.footer.caseId=o,this.footer.from="Repair"),this.footer.isRepairCreatedFromCase=s,this.footer.repairId=n,this.footer.bookingId=null==r?void 0:r.bookingGuid,this.footer.currentStatus=i,this.commonService.repairStatus.next(i),this.currentRepairStatus=i,this.commonService.repairDetails.next(e.bookingDetail.data),this.commonService.bookingId.next(a)}if(i.length>0){const{id:e,collectionGuid:t}=i[0];this.mediaTemplateId=e,this.domainId=2100,n&&(this.domainId=3100),this.collectionGuid=t,(0,s.D)({mediaTemplateDetail:this.mediaCollectionService.getMediaTemplateById(t),mediaDetail:this.mediaCollectionService.getMediaDocumentData(e,this.objectId,this.domainId)}).pipe((0,r.K)(e=>(0,l.of)(e))).subscribe(e=>{if(e){const{mediaTemplateDetail:t,mediaDetail:i}=e;this.mediaTemplate=t.data,this.mediaTemplate.mediaTemplates=t.data.mediaTemplates.sort((e,t)=>e.orderNumber-t.orderNumber),i.data&&this.mapMediaTemplate(i.data.medias),this.getMediaTemplateByObject()}this.commonService.hideLoading()},e=>{this.commonService.hideLoading(),this.monitorService.logException(e,o._.Error)})}else this.commonService.hideLoading()}else this.noDocumentData=!0,this.commonService.hideLoading()}else this.noDocumentData=!0,this.commonService.hideLoading()});const a=document.querySelector(".addenda-container");a&&(a.scrollTop=0)}stepSkipped(){var e,t;location.href.includes("repair")&&"draft"===(null===(e=this.currentRepairStatus)||void 0===e?void 0:e.toLowerCase())&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"vehicledetails"===(null===(t=this.footer.currentStatus)||void 0===t?void 0:t.toLowerCase())&&this.updateStatus()}ngOnDestroy(){this.monitorService.logEvent("ngOnDestroy",["ChqNewDocumentComponent","addenda-quote"]),this.commonService.accessRight.unsubscribe(),location.href.includes("quote")&&(this.commonService.isViewOnly=!1)}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(c.sBO),c.Y36(u.v),c.Y36(p.gz),c.Y36(m.n),c.Y36(h.M),c.Y36(g.q),c.Y36(v.m))},e.\u0275cmp=c.Xpm({type:e,selectors:[["new-documents"]],viewQuery:function(e,t){if(1&e&&c.Gf(x,5),2&e){let e;c.iGM(e=c.CRH())&&(t.imageUploaders=e.first)}},inputs:{documentHeader:"documentHeader"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"fileUploaderService","footerOptions","imageStatusSteps","header","cardSelection","stepSkipped",4,"ngIf"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"fileUploaderService","footerOptions","imageStatusSteps","header","cardSelection","stepSkipped"],["imageUploaders",""],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"]],template:function(e,t){1&e&&(c.YNc(0,w,4,3,"div",0),c.YNc(1,_,1,0,"no-access-error",0)),2&e&&(c.Q6J("ngIf",!t.showNoAccess),c.xp6(1),c.Q6J("ngIf",t.showNoAccess))},directives:[f.O5,S.q,b.U],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),e})()},4704:function(e,t,i){i.d(t,{X:function(){return R}});var n=i(97582),o=i(37716),a=i(7408),s=i(54121),r=i(84967),l=i(33568),d=i(84945),c=i(75983),u=i(83853),p=i(4893),m=i(55278),h=i(38709),g=i(95016),v=i(13975),f=i(8985),S=i(87855),b=i(38583),x=i(22406),Z=i(62119),q=i(39912),A=i(9988),w=i(54135),_=i(29790);const T=["imageUploaders"];function y(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"add-photos",9),o.NdJ("mode",function(t){return o.CHM(e),o.oxw(3).handleMode(t)}),o.qZA()}if(2&e){const e=o.oxw(3);o.Q6J("caseData",e.caseData)("caseNumber",e.photosHeader.caseNumber)("showSPI",e.checkRepairTypes)("photosHeader",e.addPhotosHeader)("hidden",e.hideContent)("showEstimate",e.showEstimateButton)("repairData",e.repairDetail)}}function I(e,t){if(1&e&&(o.ynx(0),o.YNc(1,y,1,7,"add-photos",8),o.BQk()),2&e){const e=o.oxw(2);o.xp6(1),o.Q6J("ngIf",!1===e.showUploading)}}function M(e,t){1&e&&(o.TgZ(0,"div",10),o.TgZ(1,"div",11),o._UZ(2,"img",12),o.TgZ(3,"label",13),o._uU(4),o.ALo(5,"translate"),o.qZA(),o.qZA(),o.TgZ(6,"div",14),o._UZ(7,"div",15),o._UZ(8,"div",15),o._UZ(9,"div",15),o._UZ(10,"div",15),o.qZA(),o.qZA()),2&e&&(o.xp6(4),o.hij(" ",o.lcZ(5,1,"no_photos_configured")," "))}function O(e,t){if(1&e&&(o.TgZ(0,"div",16),o.TgZ(1,"div",17),o.TgZ(2,"div",18),o._UZ(3,"img",19),o.qZA(),o.qZA(),o.qZA()),2&e){const e=o.oxw(2);o.xp6(3),o.MGl("src","assets/img/",+e.photosHeader.isRepairModule?"addenda-repair.png":"addenda-quote.png","",o.LSH)}}function C(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"chq-images-uploader",20,21),o.NdJ("handleDeleteAllEvent",function(){return o.CHM(e),o.oxw(2).handleDeleteAll()})("backToUpload",function(){return o.CHM(e),o.oxw(2).setInitialMode()})("updateMassUpload",function(t){return o.CHM(e),o.oxw(2).updateCurrentStatus(t)})("stepSkipped",function(){return o.CHM(e),o.oxw(2).stepSkipped()}),o.qZA()}if(2&e){const e=o.oxw(2);o.Q6J("hidden",e.showDamageAnalysis||!e.showUploading)("currentAdditionalModeMultiple",e.currentAdditionalModeMultiple)("fileUploaderService",e.currentObservable)("footerOptions",e.footer)("isMassUpload",e.isMultipleUpload)("showReTakeDelete",!0)("imageStatusSteps",e.imageStatusSteps)("header",e.photosHeader)("inspectionId",e.inspectionId)("inspection","photos")}}function U(e,t){if(1&e){const e=o.EpF();o.TgZ(0,"damage-analysis",22),o.NdJ("backEvent",function(t){return o.CHM(e),o.oxw(2).handleBack(t)}),o.qZA()}if(2&e){const e=o.oxw(2);o.Q6J("isBulkUpload",e.isMultipleUpload)("minPhotoRequired",e.minimumPhotosRequired)("caseDetail",e.partialCaseDetail||e.repairDetail)("steps",e.imageStatusSteps)("isRepairModule",e.photosHeader.isRepairModule)}}const P=function(e){return{"photo-container":e}};function k(e,t){if(1&e&&(o.TgZ(0,"div",2),o.YNc(1,I,2,1,"ng-container",3),o.YNc(2,M,11,3,"div",4),o.YNc(3,O,4,1,"div",5),o.YNc(4,C,2,10,"chq-images-uploader",6),o.YNc(5,U,1,5,"damage-analysis",7),o.qZA()),2&e){const e=o.oxw();o.Q6J("ngClass",o.VKq(6,P,e.photosHeader.isRepairModule)),o.xp6(1),o.Q6J("chqPermission","newBooking"),o.xp6(1),o.Q6J("ngIf",e.noImagesData),o.xp6(1),o.Q6J("ngIf",e.noImagesData),o.xp6(1),o.Q6J("ngIf",!0===e.showUploading||e.isMultipleUpload||e.imageStatusSteps&&e.imageStatusSteps.length>0),o.xp6(1),o.Q6J("ngIf",e.showDamageAnalysis)}}function D(e,t){1&e&&o._UZ(0,"no-access-error")}const L={title:"add_damage_photos",step:4,description:"damage_photos_msg",stepName:"step_four"};let R=(()=>{class e{constructor(e,t,i,n,a,r,l,d,c){this.cd=e,this.commonService=t,this.route=i,this.router=n,this.caseService=a,this.monitorService=r,this.inspectionService=l,this.bookingService=d,this.estimateService=c,this.photosHeader=L,this.currentUploadMode=new o.vpe,this.imageStatusSteps=[],this.showUploading=!1,this.isMultipleUpload=!1,this.triggerMassUpload=!1,this.caseStatus="",this.caseId="0",this.bookingId="",this.minimumPhotosRequired=0,this.hideContent=!0,this.currentAdditionalModeMultiple=!1,this.hideUploaders=!1,this.repairTypes=[],this.repairType="",this.noImagesData=!1,this.repairId="",this.inspectionTemplatesJSONString="",this.currentRepairStatus="",this.originalSteps=[],this.showNoAccess=!1,this.footer={text:"Next create estimate",icon:"boardview",route:"case/gt",status:"UploadPhotos",caseId:"",currentStatus:"",showButton:!0,showUploadOption:!0},this.statusUpdated=!1,t.pageName.closed&&(t.pageName=new s.X(null)),t.pageName.next("photos"),this.commonService.accessRight.closed&&(this.commonService.accessRight=new s.X(!0))}handleBack(e){this.showDamageAnalysis=!e.back}get checkRepairTypes(){return-1===location.href.indexOf("repair")||"repair"!==this.repairType||this.repairTypes.filter(e=>"Body"===e.repairServiceType||"Paint"===e.repairServiceType).length>0}redirectToGtEstimate(){var e,t;this.commonService.showLoading(),"uploaddocuments"===(null===(e=this.caseStatus)||void 0===e?void 0:e.toLowerCase())||"uploadphotos"===(null===(t=this.caseStatus)||void 0===t?void 0:t.toLowerCase())?this.estimateService.createEstimate(this.caseId,this.inspectionId,this.vehicleId,this.domainId).subscribe({next:e=>{var t;e&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.url)&&(location.href=e.data.url,sessionStorage.setItem("update","1"))},complete:()=>{this.commonService.hideLoading()}}):this.router.navigate([`/quote/case/${this.caseId}/estimate`])}updateCurrentStatus(e){this.monitorService.logEvent("updateCurrentStatus",["ChqNewPhotosComponent","addenda-quote",{caseId:e}]),e.initial?this.setInitialMode():(this.showUploading=!0,this.uploadBulkUploadFile(e.steps))}handleDeleteAll(){this.setInitialMode()}ngAfterViewInit(){this.commonService.updatePage("/quote/case/0","photos"),this.cd.detectChanges(),this.monitorService.logEvent("ngAfterViewInit",["ChqNewPhotosComponent","addenda-quote"])}uploadBulkUploadFile(e){for(let t=0;t<(null==e?void 0:e.length);t++){const i=new Image;i.src=e[t].image,i.onload=()=>{const n={height:i.height,width:i.width,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,type:this.vehicelType||"",isBulk:!0},o=e[t];o.uploadInProgress=!0,o.isSkipped=!1,o.isUploadFailed=!1,o.isUploadSuccess=!1,this.monitorService.logEvent("uploadBulkUploadFile",["ChqNewPhotosComponent","addenda-quote",{uploadObject:n}]),this.inspectionService.uploadImageBulk(n,o.imageFile).subscribe({next:e=>{var t,i,n,a;o.url=null===(t=e.rawImage)||void 0===t?void 0:t.rawAzureBlobUrl,o.inspectionItem=e,o.procedureSteps="Bulk Upload Image",this.imageUploaders.updateUploadStatus("success",o,null,e),this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1}),location.href.includes("repair")&&("draft"===(null===(i=this.currentRepairStatus)||void 0===i?void 0:i.toLowerCase())||"uploaddocuments"===(null===(n=this.currentRepairStatus)||void 0===n?void 0:n.toLowerCase()))&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===(null===(a=this.footer.currentStatus)||void 0===a?void 0:a.toLowerCase())&&this.updateStatus()},error:e=>{401!=e.status&&(this.imageUploaders.imageStatusSteps=this.imageUploaders.imageStatusSteps.filter(e=>e.index!==o.index||e.stepName!==o.stepName||!0!==e.uploadInProgress),this.imageUploaders.updateUploadStatus("failed",o,e,null,!0)),this.monitorService.logException(e,a._.Error)}})}}}updateRepairStatus(e){this.statusUpdated||(this.statusUpdated=!0,this.bookingService.updateRepairStatus("UploadPhotos",e,"").subscribe({next:()=>{this.currentRepairStatus="UploadPhotos",this.footer.currentStatus=this.currentRepairStatus,this.commonService.showLoading(),this.bookingService.getRepairDetailByGuid(this.repairId).subscribe({next:e=>(0,n.mG)(this,void 0,void 0,function*(){(null==e?void 0:e.data)&&(this.commonService.repairDetails.next(e.data),this.commonService.bookingId.next(e.data.repairNumber),this.commonService.hideLoading())}),error:e=>{this.monitorService.logException(e,a._.Error),this.commonService.hideLoading()}})}}))}uploadFile(e){const t={height:e.imageHeight,width:e.imageWidth,inspectionId:this.inspectionId,templateId:this.inspectionTemplateId,inspectionitemId:e.inspectionItem.id,type:this.vehicelType||"",isBulk:!1};this.monitorService.logEvent("uploadFile",["ChqNewPhotosComponent","addenda-quote",{uploadObject:t}]),e.uploadInProgress=!0,e.isSkipped=!1,e.isUploadFailed=!1,e.isUploadSuccess=!1,this.commonService.inProgressSteps.next(1),this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1}),this.commonService.showNotification(`Your photo \u2018${e.stepName}\u2019 is currently uploading won\u2019t be long and we\u2019ll notify \n       you when its uploaded, you can continue to take your photos.`),this.inspectionService.uploadImageBulk(t,e.imageFile).subscribe({next:t=>{var i,n,o,a;this.commonService.showNotification(`Your photo \u2018${e.stepName}\u2019 is uploaded successfully.`);const s=null===(i=this.inspectionItemTemplates)||void 0===i?void 0:i.find(e=>e.inspectionItem.id==(null==t?void 0:t.id));s.inspectionItem.rawAzureBlobUrl=null===(n=t.rawImage)||void 0===n?void 0:n.rawAzureBlobUrl,s&&(e.url=null===(o=t.rawImage)||void 0===o?void 0:o.rawAzureBlobUrl,this.imageUploaders.updateUploadStatus("success",e,null,t)),location.href.includes("repair")&&("Draft"==this.currentRepairStatus||"UploadDocuments"===this.currentRepairStatus)&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===(null===(a=this.footer.currentStatus)||void 0===a?void 0:a.toLowerCase())&&this.updateStatus()},error:t=>{401!=t.status&&(this.commonService.showNotification(`Your photo \u2018${e.stepName}\u2019 failed to upload. Please try to upload again.`),this.imageUploaders.updateUploadStatus("failed",e,t),this.monitorService.logException(t,a._.Error))}})}ngOnDestroy(){this.commonService.pageName.unsubscribe(),this.commonService.accessRight.unsubscribe(),location.href.includes("quote")&&(this.commonService.isViewOnly=!1),this.monitorService.logEvent("ngOnDestroy",["ChqNewPhotosComponent","addenda-quote"])}get showEstimateButton(){var e,t;return 0===(null===(e=this.currentInspectionTemplate)||void 0===e?void 0:e.minImageLimit)&&0===(null===(t=this.inspectionItemTemplates)||void 0===t?void 0:t.filter(e=>!0!==e.isSkipEnabled).length)}mapInspection(e){var t,i,n,o,a,s;if(e)try{this.inspection=e,this.uploadType=this.inspection.uploadType;let r="SPI";this.uploadType&&(this.footer=Object.assign(Object.assign({},this.footer),{showUploadOption:!1})),"Bulk"===this.uploadType&&(r="BULK");const l=null===(t=this.inspectionTemplates)||void 0===t?void 0:t.filter(e=>"Bulk Upload Image"===e.name),d=null===(i=this.inspection.inspectionItems)||void 0===i?void 0:i.filter(e=>("Bulk Upload Image"===e.name||e.inspectionItemTemplateID===l[0].id)&&e.rawAzureBlobUrl);if((null==d?void 0:d.length)>0||"Bulk"===this.uploadType){const e=[];this.currentUploadMode.emit({mode:"multiple"});for(const t in d){const i=Object.assign(Object.assign({},l[0]),{name:d[t].name||l[0].name,inspectionItem:d[t]});e.push(i)}this.inspectionItemTemplates=e}else this.currentUploadMode.emit({mode:"single"}),null===(n=this.inspectionTemplates)||void 0===n||n.map(e=>{var t;const i=null===(t=this.inspection.inspectionItems)||void 0===t?void 0:t.find(t=>t.inspectionItemTemplateID==e.id);i&&(e.inspectionItem=i)}),this.inspectionItemTemplates=null===(o=this.inspectionTemplates)||void 0===o?void 0:o.filter(e=>"Bulk Upload Image"!=e.name);(null==l?void 0:l.length)>0&&(this.inspectionTemplateId=l[0].id),null===(a=this.inspectionItemTemplates)||void 0===a||a.map(e=>{var t,i;(null===(t=e.inspectionItem)||void 0===t?void 0:t.rawAzureBlobUrl)?(e.isUploadSuccess=!0,e.image=null===(i=e.inspectionItem)||void 0===i?void 0:i.rawAzureBlobUrl):(e.inspectionItem||(e.inspectionItem={rawAzureBlobUrl:""}),e.inspectionItem.rawAzureBlobUrl="",e.isUploadFailed=!1,e.isUploadSuccess=!1,e.uploadInProgress=!1)}),this.uploadType&&("SPI"===r?(this.isMultipleUpload=!1,this.showUploading=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{title:"back_smart_photo"})),this.minimumPhotosRequired=null===(s=this.inspectionItemTemplates)||void 0===s?void 0:s.filter(e=>!0!==e.isSkipEnabled).length,this.currentObservable=this.uploadFile.bind(this)):(this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.minimumPhotosRequired=this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!0,this.isBulkUploaded=!0,this.addPhotosHeader.isRepairModule&&(this.photosHeader=Object.assign(Object.assign({},this.photosHeader),{title:"bulk_upload"}))))}catch(r){console.log(r)}}getInspectionTemplateByObject(){var e,t,i,n,o;for(let a=0;a<(null===(e=this.inspectionItemTemplates)||void 0===e?void 0:e.length);a++){const e=this.inspectionItemTemplates[a],s=(0,u.A1)(e,a),r=-1!=(null===(t=s.stepName)||void 0===t?void 0:t.toLowerCase().indexOf("additional photo")),l=-1!=(null===(i=s.stepName)||void 0===i?void 0:i.toLowerCase().indexOf("bulk upload image")),d=r&&!s.url;this.imageStatusSteps.push(Object.assign(Object.assign({},s),{mandatory:!e.isSkipEnabled,index:a,isAdditionalDocumentFromReviewPageOnly:d,isMassUpload:l,updatedDate:s.url?null===(n=null==e?void 0:e.inspectionItem)||void 0===n?void 0:n.updatedDate:"",uploadedDate:s.url?null===(o=null==e?void 0:e.inspectionItem)||void 0===o?void 0:o.created:"",domainId:this.domainId,objectId:this.objectId,uploadedPartGuid:"",uploadedGuid:""}))}}updateStatus(){this.statusUpdated||(this.statusUpdated=!0,this.monitorService.logEvent("updateStatus",["ChqNewPhotosComponent","addenda-quote"]),this.caseService.updateCaseStatus(this.caseId,"UploadPhotos").subscribe({next:()=>{this.footer=Object.assign(Object.assign({},this.footer),{status:""}),this.partialCaseDetail.status="UploadPhotos"}}))}stepSkipped(){var e,t,i;location.href.includes("repair")&&("draft"===(null===(e=this.currentRepairStatus)||void 0===e?void 0:e.toLowerCase())||"uploaddocuments"===(null===(t=this.currentRepairStatus)||void 0===t?void 0:t.toLowerCase()))&&this.updateRepairStatus(this.repairId),location.href.includes("quote")&&"uploaddocuments"===(null===(i=this.footer.currentStatus)||void 0===i?void 0:i.toLowerCase())&&this.updateStatus()}loadApiData(e){e&&"0"!=e&&(this.caseId=e,this.bookingId=e,this.commonService.showLoading(),this.inspectionService.getInspectionTemplateList().subscribe({next:t=>{let i=!1,n=0;location.href.includes("repair")&&(i=!0);const o=null==t?void 0:t.data;(null==o?void 0:o.length)>0&&(this.commonService.repairInspectionTemplate=o[0],n=o[0].id);const a={};a.inspectionTemplate=this.inspectionService.getInspectionTemplate(n),i?a.bookingDetail=this.bookingService.getRepairDetailByGuid(e):(this.commonService.userProfileData.subscribe(e=>{if(e&&e.data){const{organizationDetail:t}=e.data;this.currentOrgId=t.id}}),a.caseDetail=this.caseService.getCaseDetail(e)),(0,r.D)(a).pipe((0,l.K)(e=>(0,d.of)(e))).subscribe({next:e=>{if(e.inspectionTemplate){const t=e.inspectionTemplate.inspectionItemTemplates;if(this.currentInspectionTemplate=e.inspectionTemplate,e.inspectionDetail&&(this.inspectionDetail=e.inspectionDetail),this.inspectionTemplates=t,this.inspectionTemplatesJSONString=JSON.stringify(this.inspectionTemplates),e.caseDetail){const{caseNumber:t,id:i,status:n,domainID:o,inspections:a,vehicleModel:s,vehicleId:r,organizationDetail:l}=e.caseDetail.data;this.caseData=e.caseDetail.data,this.partialCaseDetail=e.caseDetail.data,this.commonService.isViewOnly=this.currentOrgId!=(null==l?void 0:l.organizationId),this.vehicelType=s,this.vehicleId=r,this.domainId=o,this.commonService.caseStatus.next(n),this.caseStatus=n,"uploaddocuments"===(null==n?void 0:n.toLowerCase())||(this.footer=Object.assign(Object.assign({},this.footer),{status:"",caseId:i})),this.footer.currentStatus=n,(null==a?void 0:a.length)>0&&(this.inspectionId=a[0].inspectionId,this.commonService.inspectionId.next(this.inspectionId)),this.photosHeader.caseNumber=t,this.caseData.repairGuid&&(this.footer.repairId=this.caseData.repairGuid,this.footer.from=c.j.quote),this.objectId=i}if(e.bookingDetail){const{id:t,vehicle:i,repairServiceTypes:n,repairGuid:o,domainId:a,status:s,quoteId:r,repairType:l,repairNumber:d,booking:u,isRepairCreatedFromCase:p}=e.bookingDetail.data;this.repairDetail=e.bookingDetail.data;const{vehicleModel:m,vehicleId:h}=i;this.objectId=t,this.domainId=a,this.repairId=o,this.currentRepairStatus=s,this.repairTypes=n,this.repairType=l,this.inspectionId=i.inspectionId,this.vehicelType=m,this.vehicleId=h,this.footer=Object.assign(Object.assign({},this.footer),{currentStatus:s,isRepairModule:!0,caseId:r,from:c.j.repair,repairTypes:n,isRepairCreatedFromCase:p,bookingId:null==u?void 0:u.bookingGuid}),this.commonService.repairDetails.next(e.bookingDetail.data),this.commonService.bookingId.next(d),this.commonService.repairStatus.next(s)}this.inspectionId?this.inspectionService.getInspection(this.inspectionId).subscribe({next:e=>{e&&(this.mapInspection(e),this.noImagesData=!1,this.getInspectionTemplateByObject(),setTimeout(()=>{this.hideContent=!1,this.isBulkUploaded&&(this.showUploading=!0,this.isMultipleUpload=!0,this.currentAdditionalModeMultiple=!0),this.uploadType&&this.imageUploaders.goToReview()}))},error:()=>{this.noImagesData=!0},complete:()=>{this.commonService.hideLoading()}}):(this.noImagesData=!0,this.hideContent=!1,this.commonService.hideLoading())}else this.noImagesData=!0,this.commonService.hideLoading()}})},error:()=>{this.noImagesData=!0,this.commonService.hideLoading()}}))}ngOnInit(){var e;const t=null===(e=this.route.parent)||void 0===e?void 0:e.snapshot.paramMap.get("id");this.addPhotosHeader=Object.assign(Object.assign({},this.photosHeader),{isHeaderOnly:!1}),this.monitorService.logEvent("ngOnInit",["ChqNewPhotosComponent","addenda-quote",{caseId:t,repairId:t}]),this.footer=Object.assign(Object.assign({},this.footer),{caseId:this.photosHeader.isRepairModule?"":t,repairId:this.photosHeader.isRepairModule?t:"",handleBack:this.handleBack.bind(this),finalRedirection:this.redirectToGtEstimate.bind(this)}),this.commonService.accessRight.subscribe({next:e=>{e||(this.showNoAccess=!0)}}),this.loadApiData(t);const i=document.querySelector(".addenda-container");i&&(i.scrollTop=0),this.currentObservable=this.uploadFile.bind(this)}reloadInspection(){this.commonService.showLoading(),this.inspectionTemplates=JSON.parse(this.inspectionTemplatesJSONString),this.inspectionId&&this.inspectionService.getInspection(this.inspectionId).subscribe({next:e=>{e&&(this.mapInspection(e),this.getInspectionTemplateByObject(),this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,setTimeout(()=>{this.hideContent=!1,this.showUploading=!0}))},complete:()=>{this.commonService.hideLoading()}})}setInitialMode(){this.showUploading=!1,this.imageStatusSteps=[],this.triggerMassUpload=!1,this.isBulkUploaded=!1,this.imageUploaders.isReviewSection=!1,this.isMultipleUpload=!1,this.currentAdditionalModeMultiple=!1}handleMode(e){var t;this.monitorService.logEvent("handleMode",["ChqNewPhotosComponent","addenda-quote",{$event:e}]),this.inspectionId?(this.currentUploadMode.emit(e),"single"===e.mode?(0===(null===(t=this.imageStatusSteps)||void 0===t?void 0:t.length)?(this.isMultipleUpload=!1,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.triggerMassUpload=!1,this.minimumPhotosRequired=this.inspectionItemTemplates.filter(e=>!0!==e.isSkipEnabled).length,this.reloadInspection()):(this.isMultipleUpload=!1,this.showUploading=!0,this.isBulkUploaded=!1,this.currentAdditionalModeMultiple=!1,this.minimumPhotosRequired=this.currentInspectionTemplate.minImageLimit,this.triggerMassUpload=!1),this.currentObservable=this.uploadFile.bind(this)):(this.imageStatusSteps=[],this.currentObservable=this.uploadBulkUploadFile.bind(this),this.isMultipleUpload=!0,this.triggerMassUpload=!0,this.showUploading=!0)):this.currentUploadMode.emit({mode:"error",id:this.bookingId})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(o.sBO),o.Y36(p.v),o.Y36(m.gz),o.Y36(m.F0),o.Y36(h.n),o.Y36(g.M),o.Y36(v.a),o.Y36(f.q),o.Y36(S.H))},e.\u0275cmp=o.Xpm({type:e,selectors:[["new-photos"]],viewQuery:function(e,t){if(1&e&&o.Gf(T,5),2&e){let e;o.iGM(e=o.CRH())&&(t.imageUploaders=e.first)}},inputs:{photosHeader:"photosHeader"},outputs:{currentUploadMode:"currentUploadMode"},decls:2,vars:2,consts:[[3,"ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass"],[4,"chqPermission"],["class","wrapper",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload","stepSkipped",4,"ngIf"],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairModule","backEvent",4,"ngIf"],[3,"caseData","caseNumber","showSPI","photosHeader","hidden","showEstimate","repairData","mode",4,"ngIf"],[3,"caseData","caseNumber","showSPI","photosHeader","hidden","showEstimate","repairData","mode"],[1,"wrapper"],[1,"no-document-div"],["src","assets/icons/no-document.svg"],[1,"no-vehicle-content"],[1,"empty-wrapper"],[1,"step-container"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[3,"hidden","currentAdditionalModeMultiple","fileUploaderService","footerOptions","isMassUpload","showReTakeDelete","imageStatusSteps","header","inspectionId","inspection","handleDeleteAllEvent","backToUpload","updateMassUpload","stepSkipped"],["imageUploaders",""],[3,"isBulkUpload","minPhotoRequired","caseDetail","steps","isRepairModule","backEvent"]],template:function(e,t){1&e&&(o.YNc(0,k,6,8,"div",0),o.YNc(1,D,1,0,"no-access-error",1)),2&e&&(o.Q6J("ngIf",!t.showNoAccess),o.xp6(1),o.Q6J("ngIf",t.showNoAccess))},directives:[b.O5,b.mk,x.A,Z.b,q.q,A.wm,w.U],pipes:[_.X$],styles:[".photo-container[_ngcontent-%COMP%]{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:calc(100vh - 160px);overflow:hidden}.empty-wrapper[_ngcontent-%COMP%]{border-left:1px solid var(--xa-light-gray)}.step-container[_ngcontent-%COMP%]{padding:15px 11px;height:25%;border-bottom:1px solid var(--xa-light-gray);background-color:var(--xa-white);width:130px}.no-document-div[_ngcontent-%COMP%]{width:100%;height:100%;flex:1;display:flex;justify-content:center;align-items:center;flex-direction:column}.no-document-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:225px;height:215px}.no-document-div[_ngcontent-%COMP%]   .no-vehicle-content[_ngcontent-%COMP%]{font-weight:500;font-size:20px;line-height:21px;text-align:center;color:var(--xa-black)}"]}),e})()},72076:function(e,t,i){i.d(t,{r:function(){return B}});var n=i(37716),o=i(95016),a=i(38583),s=i(36978),r=i(76627),l=i(29790),d=i(93077);function c(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"chq-button",5),n.NdJ("click",function(){return n.CHM(e),n.oxw().handledownloadPdf()}),n.qZA()}if(2&e){const e=n.oxw();n.Q6J("buttonModel",e.repairEstimateReportModel)}}function u(e,t){1&e&&n._UZ(0,"td")}function p(e,t){1&e&&(n.TgZ(0,"td",25),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&e&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"actions")))}function m(e,t){if(1&e&&(n.TgZ(0,"td",29),n._UZ(1,"span",30),n.qZA()),2&e){const e=n.oxw().$implicit,t=n.oxw(2);n.xp6(1),n.Q6J("innerHTML",t.displayNotes(e),n.oJD)}}function h(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"td"),n.TgZ(1,"div",31),n.TgZ(2,"mat-icon",32),n.NdJ("click",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw(2).handleIconClick("edit",t.operationId)}),n.qZA(),n.TgZ(3,"mat-icon",33),n.NdJ("click",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw(2).handleIconClick("delete",t.operationId)}),n.qZA(),n.qZA(),n.qZA()}2&e&&(n.xp6(2),n.Q6J("svgIcon","edit"),n.xp6(1),n.Q6J("svgIcon","delete"))}const g=function(e){return{"child-data":e}},v=function(e,t,i,n,o){return[e,t,i,n,o]};function f(e,t){if(1&e&&(n.TgZ(0,"tr",26),n.YNc(1,m,2,1,"td",27),n.TgZ(2,"td"),n._uU(3),n.qZA(),n.TgZ(4,"td"),n._uU(5),n.qZA(),n.TgZ(6,"td",28),n._uU(7),n.qZA(),n.TgZ(8,"td"),n._uU(9),n.ALo(10,"xaCurrency"),n.qZA(),n.TgZ(11,"td",11),n._uU(12),n.ALo(13,"xaCurrency"),n.qZA(),n.YNc(14,h,4,2,"td",10),n.qZA()),2&e){const e=t.$implicit,i=n.oxw(2);n.Q6J("ngClass",n.VKq(21,g,!0===e.isChildItem&&i.isGTEstimate())),n.xp6(1),n.Q6J("ngIf",i.isGTEstimate()),n.xp6(2),n.Oqu(e.description),n.xp6(2),n.Oqu(e.code),n.xp6(2),n.Oqu(e.quantity),n.xp6(2),n.Oqu(n.G7q(10,9,n.qbA(23,v,e.cost,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),n.xp6(2),n.Q6J("align",i.editEstimate?"center":"right"),n.xp6(1),n.Oqu(n.G7q(13,15,n.qbA(29,v,e.total,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),n.xp6(2),n.Q6J("ngIf",i.editEstimate)}}function S(e,t){1&e&&n._UZ(0,"td")}function b(e,t){1&e&&(n.TgZ(0,"td",25),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&e&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"actions")))}function x(e,t){if(1&e&&(n.TgZ(0,"td",29),n._UZ(1,"span",30),n.qZA()),2&e){const e=n.oxw().$implicit,t=n.oxw(2);n.xp6(1),n.Q6J("innerHTML",t.displayNotes(e),n.oJD)}}function Z(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"td"),n.TgZ(1,"div",31),n.TgZ(2,"mat-icon",32),n.NdJ("click",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw(2).handleIconClick("edit",t.operationId)}),n.qZA(),n.TgZ(3,"mat-icon",33),n.NdJ("click",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw(2).handleIconClick("delete",t.operationId)}),n.qZA(),n.qZA(),n.qZA()}2&e&&(n.xp6(2),n.Q6J("svgIcon","edit"),n.xp6(1),n.Q6J("svgIcon","delete"))}function q(e,t){if(1&e&&(n.TgZ(0,"tr",26),n.YNc(1,x,2,1,"td",27),n.TgZ(2,"td"),n._uU(3),n.qZA(),n.TgZ(4,"td"),n._uU(5),n.qZA(),n.TgZ(6,"td",28),n._uU(7),n.ALo(8,"translate"),n.qZA(),n.TgZ(9,"td"),n._uU(10),n.ALo(11,"xaCurrency"),n.qZA(),n.TgZ(12,"td",11),n._uU(13),n.ALo(14,"xaCurrency"),n.qZA(),n.YNc(15,Z,4,2,"td",10),n.qZA()),2&e){const e=t.$implicit,i=n.oxw(2);n.Q6J("ngClass",n.VKq(24,g,!0===e.isChildItem&&i.isGTEstimate())),n.xp6(1),n.Q6J("ngIf",i.isGTEstimate()),n.xp6(2),n.hij(" ",e.description,""),n.xp6(2),n.Oqu(e.code),n.xp6(2),n.AsE("",e.quantity," ",n.lcZ(8,10,"hours"),""),n.xp6(3),n.Oqu(n.G7q(11,12,n.qbA(26,v,e.cost,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),n.xp6(2),n.s9C("align",i.editEstimate?"center":"right"),n.xp6(1),n.Oqu(n.G7q(14,18,n.qbA(32,v,e.total,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),n.xp6(2),n.Q6J("ngIf",i.editEstimate)}}function A(e,t){if(1&e&&(n.TgZ(0,"div"),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&e){const e=n.oxw(3);n.xp6(1),n.AsE(" ",n.lcZ(2,2,"paint_type"),": ",null==e.estimateResponse||null==e.estimateResponse.estimateSummary?null:e.estimateResponse.estimateSummary.paintType," ")}}function w(e,t){if(1&e&&(n.TgZ(0,"div",34),n.TgZ(1,"div"),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.YNc(4,A,3,4,"div",10),n.qZA()),2&e){const e=n.oxw(2);n.xp6(2),n.AsE(" ",n.lcZ(3,3,"paint_system"),": ",null==e.estimateResponse||null==e.estimateResponse.estimateSummary?null:e.estimateResponse.estimateSummary.paintSystem," "),n.xp6(2),n.Q6J("ngIf","azt"===(null==e.estimateResponse||null==e.estimateResponse.estimateSummary||null==e.estimateResponse.estimateSummary.paintSystem?null:e.estimateResponse.estimateSummary.paintSystem.toLowerCase()))}}function _(e,t){1&e&&n._UZ(0,"td")}function T(e,t){1&e&&(n.TgZ(0,"td",25),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&e&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"actions")))}function y(e,t){if(1&e&&(n.TgZ(0,"td",29),n._UZ(1,"span",30),n.qZA()),2&e){const e=n.oxw().$implicit,t=n.oxw(3);n.xp6(1),n.Q6J("innerHTML",t.displayNotes(e),n.oJD)}}function I(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"td"),n.TgZ(1,"div",31),n.TgZ(2,"mat-icon",32),n.NdJ("click",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw(3).handleIconClick("edit",t.operationId)}),n.qZA(),n.TgZ(3,"mat-icon",33),n.NdJ("click",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw(3).handleIconClick("delete",t.operationId)}),n.qZA(),n.qZA(),n.qZA()}2&e&&(n.xp6(2),n.Q6J("svgIcon","edit"),n.xp6(1),n.Q6J("svgIcon","delete"))}function M(e,t){if(1&e&&(n.TgZ(0,"tr",26),n.YNc(1,y,2,1,"td",27),n.TgZ(2,"td"),n._uU(3),n.qZA(),n.TgZ(4,"td"),n._uU(5),n.qZA(),n.TgZ(6,"td",28),n._uU(7),n.qZA(),n.TgZ(8,"td"),n._uU(9),n.ALo(10,"xaCurrency"),n.qZA(),n.TgZ(11,"td",11),n._uU(12),n.ALo(13,"xaCurrency"),n.qZA(),n.YNc(14,I,4,2,"td",10),n.qZA()),2&e){const e=t.$implicit,i=n.oxw(3);n.Q6J("ngClass",n.VKq(21,g,!0===e.isChildItem&&i.isGTEstimate())),n.xp6(1),n.Q6J("ngIf",i.isGTEstimate()),n.xp6(2),n.hij(" ",e.description,""),n.xp6(2),n.Oqu(e.code),n.xp6(2),n.hij("",e.quantity," h"),n.xp6(2),n.Oqu(n.G7q(10,9,n.qbA(23,v,e.cost,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),n.xp6(2),n.Q6J("align",i.editEstimate?"center":"right"),n.xp6(1),n.Oqu(n.G7q(13,15,n.qbA(29,v,e.total,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),n.xp6(2),n.Q6J("ngIf",i.editEstimate)}}function O(e,t){if(1&e&&(n.ynx(0),n.TgZ(1,"tr"),n.TgZ(2,"td",35),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.qZA(),n.YNc(5,M,15,35,"tr",13),n.BQk()),2&e){const e=n.oxw(2);n.xp6(2),n.uIk("colspan",e.editEstimate?"6":"5"),n.xp6(1),n.Oqu(n.lcZ(4,3,"paint_labour")),n.xp6(2),n.Q6J("ngForOf",e.paintLabour)}}function C(e,t){if(1&e&&(n.TgZ(0,"td",29),n._UZ(1,"span",30),n.qZA()),2&e){const e=n.oxw().$implicit,t=n.oxw(3);n.xp6(1),n.Q6J("innerHTML",t.displayNotes(e),n.oJD)}}function U(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"td"),n.TgZ(1,"div",31),n.TgZ(2,"mat-icon",32),n.NdJ("click",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw(3).handleIconClick("edit",t.operationId)}),n.qZA(),n.TgZ(3,"mat-icon",33),n.NdJ("click",function(){n.CHM(e);const t=n.oxw().$implicit;return n.oxw(3).handleIconClick("delete",t.operationId)}),n.qZA(),n.qZA(),n.qZA()}2&e&&(n.xp6(2),n.Q6J("svgIcon","edit"),n.xp6(1),n.Q6J("svgIcon","delete"))}function P(e,t){if(1&e&&(n.TgZ(0,"tr",26),n.YNc(1,C,2,1,"td",27),n.TgZ(2,"td"),n._uU(3),n.qZA(),n.TgZ(4,"td"),n._uU(5),n.qZA(),n.TgZ(6,"td",28),n._uU(7),n.qZA(),n.TgZ(8,"td"),n._uU(9),n.ALo(10,"xaCurrency"),n.qZA(),n.TgZ(11,"td",11),n._uU(12),n.ALo(13,"xaCurrency"),n.qZA(),n.YNc(14,U,4,2,"td",10),n.qZA()),2&e){const e=t.$implicit,i=n.oxw(3);n.Q6J("ngClass",n.VKq(21,g,!0===e.isChildItem&&i.isGTEstimate())),n.xp6(1),n.Q6J("ngIf",i.isGTEstimate()),n.xp6(2),n.hij(" ",e.description,""),n.xp6(2),n.Oqu(e.code),n.xp6(2),n.Oqu(e.quantity),n.xp6(2),n.Oqu(n.G7q(10,9,n.qbA(23,v,e.cost,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),n.xp6(2),n.Q6J("align",i.editEstimate?"center":"right"),n.xp6(1),n.Oqu(n.G7q(13,15,n.qbA(29,v,e.total,i.i18n.currencySymbol,i.i18n.digitsInfo,i.i18n.locale,i.i18n.position))),n.xp6(2),n.Q6J("ngIf",i.editEstimate)}}function k(e,t){if(1&e&&(n.ynx(0),n.TgZ(1,"tr"),n.TgZ(2,"td",35),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.qZA(),n.YNc(5,P,15,35,"tr",13),n.BQk()),2&e){const e=n.oxw(2);n.xp6(2),n.uIk("colspan",e.editEstimate?"6":"5"),n.xp6(1),n.Oqu(n.lcZ(4,3,"paint_material")),n.xp6(2),n.Q6J("ngForOf",e.paintMaterial)}}function D(e,t){1&e&&(n.ynx(0),n.TgZ(1,"td"),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.BQk()),2&e&&(n.xp6(2),n.Oqu(n.lcZ(3,1,"total_cost_with_gst")))}function L(e,t){1&e&&(n.TgZ(0,"td"),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&e&&(n.xp6(1),n.Oqu(n.lcZ(2,1,"total_cost")))}function R(e,t){1&e&&(n.TgZ(0,"div",36),n.TgZ(1,"div",37),n.TgZ(2,"div",38),n._UZ(3,"img",39),n.TgZ(4,"span"),n._uU(5),n.ALo(6,"translate"),n.qZA(),n.qZA(),n.TgZ(7,"div"),n._UZ(8,"mat-icon",40),n.TgZ(9,"span"),n._uU(10),n.ALo(11,"translate"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(12,"div",37),n.TgZ(13,"div",38),n._UZ(14,"img",41),n.TgZ(15,"span"),n._uU(16),n.ALo(17,"translate"),n.qZA(),n.qZA(),n.TgZ(18,"div",42),n.TgZ(19,"div"),n.TgZ(20,"b"),n._uU(21," I "),n.qZA(),n.TgZ(22,"span"),n._uU(23),n.ALo(24,"translate"),n.qZA(),n.qZA(),n.TgZ(25,"div"),n.TgZ(26,"b"),n._uU(27,"NI"),n.qZA(),n.TgZ(28,"span"),n._uU(29),n.ALo(30,"translate"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(31,"div",37),n.TgZ(32,"div",38),n._UZ(33,"img",43),n.TgZ(34,"span"),n._uU(35),n.ALo(36,"translate"),n.qZA(),n.qZA(),n.TgZ(37,"div"),n.TgZ(38,"b"),n._uU(39,"C "),n.qZA(),n.TgZ(40,"span"),n._uU(41),n.ALo(42,"translate"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(43,"div",37),n.TgZ(44,"div",38),n.TgZ(45,"b"),n._uU(46,"+"),n.qZA(),n.TgZ(47,"span"),n._uU(48),n.ALo(49,"translate"),n.qZA(),n.qZA(),n.TgZ(50,"div"),n.TgZ(51,"b"),n._uU(52,"-"),n.qZA(),n.TgZ(53,"span"),n._uU(54),n.ALo(55,"translate"),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&e&&(n.xp6(5),n.Oqu(n.lcZ(6,10,"manual")),n.xp6(3),n.Q6J("svgIcon","approximate"),n.xp6(2),n.Oqu(n.lcZ(11,12,"approximate")),n.xp6(6),n.Oqu(n.lcZ(17,14,"documented_by_gt_motive")),n.xp6(7),n.Oqu(n.lcZ(24,16,"included")),n.xp6(6),n.Oqu(n.lcZ(30,18,"not_included")),n.xp6(6),n.Oqu(n.lcZ(36,20,"prepainted_part")),n.xp6(6),n.Oqu(n.lcZ(42,22,"conditioned_by")),n.xp6(7),n.Oqu(n.lcZ(49,24,"thrown_by")),n.xp6(6),n.Oqu(n.lcZ(55,26,"overlapped_by")))}const N=function(e){return{"mb-0":e}};function E(e,t){if(1&e&&(n.TgZ(0,"div",6),n.TgZ(1,"div",7),n.TgZ(2,"h6",8),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"table",9),n.TgZ(6,"thead"),n.TgZ(7,"tr"),n.YNc(8,u,1,0,"td",10),n.TgZ(9,"td"),n._uU(10),n.ALo(11,"translate"),n.qZA(),n.TgZ(12,"td"),n._uU(13),n.ALo(14,"translate"),n.qZA(),n.TgZ(15,"td"),n._uU(16),n.ALo(17,"translate"),n.qZA(),n.TgZ(18,"td"),n._uU(19),n.ALo(20,"translate"),n.qZA(),n.TgZ(21,"td",11),n._uU(22),n.ALo(23,"translate"),n.qZA(),n.YNc(24,p,3,3,"td",12),n.qZA(),n.qZA(),n.TgZ(25,"tbody"),n.YNc(26,f,15,35,"tr",13),n.qZA(),n.qZA(),n.TgZ(27,"table",9),n.TgZ(28,"tfoot"),n.TgZ(29,"tr"),n.TgZ(30,"td"),n._uU(31),n.ALo(32,"translate"),n.qZA(),n.TgZ(33,"td",14),n._uU(34),n.ALo(35,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(36,"div",15),n.TgZ(37,"h6",8),n._uU(38),n.ALo(39,"translate"),n.qZA(),n.TgZ(40,"table",9),n.TgZ(41,"thead"),n.TgZ(42,"tr"),n.YNc(43,S,1,0,"td",10),n.TgZ(44,"td"),n._uU(45),n.ALo(46,"translate"),n.qZA(),n.TgZ(47,"td"),n._uU(48),n.ALo(49,"translate"),n.qZA(),n.TgZ(50,"td"),n._uU(51),n.ALo(52,"translate"),n.qZA(),n.TgZ(53,"td"),n._uU(54),n.ALo(55,"translate"),n.qZA(),n.TgZ(56,"td",11),n._uU(57),n.ALo(58,"translate"),n.qZA(),n.YNc(59,b,3,3,"td",12),n.qZA(),n.qZA(),n.TgZ(60,"tbody"),n.YNc(61,q,16,38,"tr",13),n.qZA(),n.qZA(),n.TgZ(62,"table",9),n.TgZ(63,"tfoot"),n.TgZ(64,"tr"),n.TgZ(65,"td"),n._uU(66),n.ALo(67,"translate"),n.qZA(),n.TgZ(68,"td",14),n._uU(69),n.ALo(70,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(71,"div",15),n.TgZ(72,"h6",8),n._uU(73),n.ALo(74,"translate"),n.qZA(),n.YNc(75,w,5,5,"div",16),n.TgZ(76,"table",9),n.TgZ(77,"thead"),n.TgZ(78,"tr"),n.YNc(79,_,1,0,"td",10),n.TgZ(80,"td"),n._uU(81),n.ALo(82,"translate"),n.qZA(),n.TgZ(83,"td"),n._uU(84),n.ALo(85,"translate"),n.qZA(),n.TgZ(86,"td"),n._uU(87),n.ALo(88,"translate"),n.qZA(),n.TgZ(89,"td"),n._uU(90),n.ALo(91,"translate"),n.qZA(),n.TgZ(92,"td",11),n._uU(93),n.ALo(94,"translate"),n.qZA(),n.YNc(95,T,3,3,"td",12),n.qZA(),n.qZA(),n.TgZ(96,"tbody"),n.YNc(97,O,6,5,"ng-container",10),n.YNc(98,k,6,5,"ng-container",10),n.qZA(),n.qZA(),n.TgZ(99,"table",9),n.TgZ(100,"tfoot"),n.TgZ(101,"tr"),n.TgZ(102,"td"),n._uU(103),n.ALo(104,"translate"),n.qZA(),n.TgZ(105,"td",14),n._uU(106),n.ALo(107,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(108,"div",17),n.TgZ(109,"div",15),n.TgZ(110,"h4",18),n._uU(111),n.ALo(112,"translate"),n.qZA(),n.TgZ(113,"h6",8),n._uU(114),n.ALo(115,"translate"),n.qZA(),n.TgZ(116,"table",9),n.TgZ(117,"tbody"),n.TgZ(118,"tr"),n.TgZ(119,"td"),n._uU(120),n.ALo(121,"translate"),n.qZA(),n.TgZ(122,"td",14),n._uU(123),n.ALo(124,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(125,"tr"),n.TgZ(126,"td"),n._uU(127),n.ALo(128,"translate"),n.qZA(),n.TgZ(129,"td",14),n._uU(130),n.ALo(131,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(132,"tr"),n.TgZ(133,"td"),n._uU(134),n.ALo(135,"translate"),n.qZA(),n.TgZ(136,"td",14),n._uU(137),n.ALo(138,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(139,"tr"),n.TgZ(140,"td"),n._uU(141),n.ALo(142,"translate"),n.qZA(),n.TgZ(143,"td",14),n._uU(144),n.ALo(145,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(146,"tfoot"),n.TgZ(147,"tr"),n.TgZ(148,"td"),n._uU(149),n.ALo(150,"translate"),n.qZA(),n.TgZ(151,"td",14),n._uU(152),n.ALo(153,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(154,"div",15),n.TgZ(155,"h6",8),n._uU(156),n.ALo(157,"translate"),n.qZA(),n.TgZ(158,"table",9),n.TgZ(159,"tbody"),n.TgZ(160,"tr"),n.TgZ(161,"td"),n._uU(162),n.ALo(163,"translate"),n.qZA(),n.TgZ(164,"td",14),n._uU(165),n.ALo(166,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(167,"tr"),n.TgZ(168,"td"),n._uU(169),n.ALo(170,"translate"),n.qZA(),n.TgZ(171,"td",14),n._uU(172),n.qZA(),n.qZA(),n.TgZ(173,"tr"),n.TgZ(174,"td"),n._uU(175),n.ALo(176,"translate"),n.qZA(),n.TgZ(177,"td",14),n._uU(178),n.ALo(179,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(180,"tfoot"),n.TgZ(181,"tr"),n.TgZ(182,"td"),n._uU(183),n.ALo(184,"translate"),n.qZA(),n.TgZ(185,"td",14),n._uU(186),n.ALo(187,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(188,"div",15),n.TgZ(189,"h6",8),n._uU(190),n.ALo(191,"translate"),n.qZA(),n.TgZ(192,"table",9),n.TgZ(193,"tbody"),n.TgZ(194,"tr"),n.TgZ(195,"td"),n._uU(196),n.ALo(197,"translate"),n.qZA(),n.TgZ(198,"td",14),n._uU(199),n.qZA(),n.qZA(),n.TgZ(200,"tr"),n.TgZ(201,"td"),n._uU(202),n.ALo(203,"translate"),n.qZA(),n.TgZ(204,"td",14),n._uU(205),n.ALo(206,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(207,"tr"),n.TgZ(208,"td"),n._uU(209),n.ALo(210,"translate"),n.qZA(),n.TgZ(211,"td",14),n._uU(212),n.ALo(213,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(214,"tr"),n.TgZ(215,"td",19),n._uU(216),n.ALo(217,"translate"),n.qZA(),n.TgZ(218,"td",14),n._uU(219),n.ALo(220,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(221,"tr"),n.TgZ(222,"td"),n._uU(223),n.ALo(224,"translate"),n.qZA(),n.TgZ(225,"td",14),n._uU(226),n.ALo(227,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(228,"tr"),n.TgZ(229,"td"),n._uU(230),n.ALo(231,"translate"),n.qZA(),n.TgZ(232,"td",14),n._uU(233),n.ALo(234,"xaCurrency"),n.qZA(),n.qZA(),n.TgZ(235,"tr"),n.TgZ(236,"td"),n._uU(237),n.ALo(238,"translate"),n.qZA(),n.TgZ(239,"td",14),n._uU(240),n.ALo(241,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(242,"tfoot"),n.TgZ(243,"tr"),n.TgZ(244,"td"),n._uU(245),n.ALo(246,"translate"),n.qZA(),n.TgZ(247,"td",14),n._uU(248),n.ALo(249,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(250,"div",20),n.TgZ(251,"table",21),n.TgZ(252,"thead"),n.TgZ(253,"tr"),n.YNc(254,D,4,3,"ng-container",22),n.YNc(255,L,3,3,"ng-template",null,23,n.W1O),n.TgZ(257,"td",14),n._uU(258),n.ALo(259,"xaCurrency"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.YNc(260,R,56,28,"div",24),n.qZA()),2&e){const e=n.MAs(256),t=n.oxw();n.xp6(3),n.Oqu(n.lcZ(4,91,"parts")),n.xp6(5),n.Q6J("ngIf",t.isGTEstimate()),n.xp6(2),n.Oqu(n.lcZ(11,93,"estimate_details_description")),n.xp6(3),n.Oqu(n.lcZ(14,95,"code")),n.xp6(3),n.Oqu(n.lcZ(17,97,"units")),n.xp6(3),n.AsE("",n.lcZ(20,99,"price_unit"),"(",t.i18n.currencySymbol,")"),n.xp6(2),n.Q6J("align",t.editEstimate?"center":"right"),n.xp6(1),n.AsE("",n.lcZ(23,101,"total_price"),"(",t.i18n.currencySymbol,")"),n.xp6(2),n.Q6J("ngIf",t.editEstimate),n.xp6(2),n.Q6J("ngForOf",t.partsCost),n.xp6(5),n.Oqu(n.lcZ(32,103,"total_parts_cost")),n.xp6(3),n.Oqu(n.G7q(35,105,n.qbA(289,v,t.totalPartsCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(39,111,"labour")),n.xp6(5),n.Q6J("ngIf",t.isGTEstimate()),n.xp6(2),n.Oqu(n.lcZ(46,113,"estimate_details_description")),n.xp6(3),n.Oqu(n.lcZ(49,115,"code")),n.xp6(3),n.Oqu(n.lcZ(52,117,"hours")),n.xp6(3),n.AsE("",n.lcZ(55,119,"price_unit"),"(",t.i18n.currencySymbol,")"),n.xp6(2),n.Q6J("align",t.editEstimate?"center":"right"),n.xp6(1),n.AsE("",n.lcZ(58,121,"total_price"),"(",t.i18n.currencySymbol,")"),n.xp6(2),n.Q6J("ngIf",t.editEstimate),n.xp6(2),n.Q6J("ngForOf",t.labourCost),n.xp6(5),n.Oqu(n.lcZ(67,123,"total_labour_cost")),n.xp6(3),n.Oqu(n.G7q(70,125,n.qbA(295,v,t.totalLabourCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(74,131,"paint")),n.xp6(2),n.Q6J("ngIf",t.isGTEstimate()),n.xp6(4),n.Q6J("ngIf",t.isGTEstimate()),n.xp6(2),n.Oqu(n.lcZ(82,133,"estimate_details_description")),n.xp6(3),n.Oqu(n.lcZ(85,135,"code")),n.xp6(3),n.Oqu(n.lcZ(88,137,"unit_hours")),n.xp6(3),n.AsE(" ",n.lcZ(91,139,"price_unit"),"(",t.i18n.currencySymbol,")"),n.xp6(2),n.Q6J("align",t.editEstimate?"center":"right"),n.xp6(1),n.AsE("",n.lcZ(94,141,"total_price"),"(",t.i18n.currencySymbol,")"),n.xp6(2),n.Q6J("ngIf",t.editEstimate),n.xp6(2),n.Q6J("ngIf",t.paintLabour.length>0),n.xp6(1),n.Q6J("ngIf",t.paintMaterial.length>0),n.xp6(5),n.Oqu(n.lcZ(104,143,"total_paint_cost")),n.xp6(3),n.Oqu(n.G7q(107,145,n.qbA(301,v,t.totalPaintCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(5),n.Oqu(n.lcZ(112,151,"summary")),n.xp6(3),n.hij(" ",n.lcZ(115,153,"parts"),""),n.xp6(6),n.Oqu(n.lcZ(121,155,"subtotal")),n.xp6(3),n.Oqu(n.G7q(124,157,n.qbA(307,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(128,163,"estimate_details_sundry_parts")),n.xp6(3),n.Oqu(n.G7q(131,165,n.qbA(313,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.sundryParts,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(135,171,"total_before_discount")),n.xp6(3),n.Oqu(n.G7q(138,173,n.qbA(319,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalBeforeDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.AsE("",n.lcZ(142,179,"discount_on_parts"),"(",null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalDiscountPercentage,"%)"),n.xp6(3),n.Oqu(n.G7q(145,181,n.qbA(325,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotalDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(5),n.Oqu(n.lcZ(150,187,"total_parts")),n.xp6(3),n.Oqu(n.G7q(153,189,n.qbA(331,v,null==t.summary||null==t.summary.parts?null:t.summary.parts.partsTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(157,195,"labour")),n.xp6(6),n.Oqu(n.lcZ(163,197,"labour_amount_subtotal")),n.xp6(3),n.Oqu(n.G7q(166,199,n.qbA(337,v,t.totalLabourCost,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(170,205,"labour_hours")),n.xp6(3),n.hij("",null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTimeHours," Hrs"),n.xp6(3),n.AsE("",n.lcZ(176,207,"estimate_details_labour_discount"),"(",null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotalDiscountPercentage,"%)"),n.xp6(3),n.Oqu(n.G7q(179,209,n.qbA(343,v,null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotalDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(5),n.Oqu(n.lcZ(184,215,"total_labour_cost")),n.xp6(3),n.Oqu(n.G7q(187,217,n.qbA(349,v,null==t.summary||null==t.summary.labour?null:t.summary.labour.labourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.hij(" ",n.lcZ(191,223,"paint"),""),n.xp6(6),n.Oqu(n.lcZ(197,225,"paint_labour_time")),n.xp6(3),n.hij("",null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourTimeHour," Hrs"),n.xp6(3),n.Oqu(n.lcZ(203,227,"paint_labour_subtotal")),n.xp6(3),n.Oqu(n.G7q(206,229,n.qbA(355,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.AsE("",n.lcZ(210,235,"estimate_details_paint_labour_discount"),"(",null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourDiscountPercentage,"%)"),n.xp6(3),n.Oqu(n.G7q(213,237,n.qbA(361,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(217,243,"labour_total")),n.xp6(3),n.Oqu(n.G7q(220,245,n.qbA(367,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.labour?null:t.summary.paint.labour.paintLabourTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(224,251,"material_subtotal")),n.xp6(3),n.Oqu(n.G7q(227,253,n.qbA(373,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialSubTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.AsE("",n.lcZ(231,259,"estimate_details_material_discount"),"(",null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMateriaDiscountPercentage,"%)"),n.xp6(3),n.Oqu(n.G7q(234,261,n.qbA(379,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialDiscount,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(4),n.Oqu(n.lcZ(238,267,"material_total")),n.xp6(3),n.Oqu(n.G7q(241,269,n.qbA(385,v,null==t.summary||null==t.summary.paint||null==t.summary.paint.material?null:t.summary.paint.material.paintMaterialTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(5),n.Oqu(n.lcZ(246,275,"total_paint")),n.xp6(3),n.Oqu(n.G7q(249,277,n.qbA(391,v,null==t.summary||null==t.summary.paint?null:t.summary.paint.paintTotal,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(3),n.Q6J("ngClass",n.VKq(397,N,!t.isGTEstimate())),n.xp6(3),n.Q6J("ngIf","Rs."===t.i18n.currencySymbol)("ngIfElse",e),n.xp6(4),n.Oqu(n.G7q(259,283,n.qbA(399,v,t.total.total,t.i18n.currencySymbol,t.i18n.digitsInfo,t.i18n.locale,t.i18n.position))),n.xp6(2),n.Q6J("ngIf",t.isGTEstimate())}}function J(e,t){1&e&&(n.TgZ(0,"div",44),n._UZ(1,"mat-icon",45),n.TgZ(2,"p",46),n._uU(3),n.ALo(4,"translate"),n._UZ(5,"br"),n._uU(6),n.ALo(7,"translate"),n._UZ(8,"br"),n._uU(9),n.ALo(10,"translate"),n.qZA(),n.qZA()),2&e&&(n.xp6(1),n.Q6J("svgIcon","estimate-no-data"),n.xp6(2),n.hij(" ",n.lcZ(4,4,"no_result"),". "),n.xp6(3),n.hij(" ",n.lcZ(7,6,"no_estimate")," "),n.xp6(3),n.hij(" ",n.lcZ(10,8,"add_try_again")," "))}let B=(()=>{class e{constructor(e){this.monitorService=e,this.iconClicked=new n.vpe,this.downloadPdf=new n.vpe,this.repairEstimateReportModel={label:"estimate_report",type:"outline",icon:"report-check"},this.paintCost=[],this.partsCost=[],this.totalPartsCost=0,this.labourCost=[],this.totalLabourCost=0,this.paintLabour=[],this.paintMaterial=[],this.totalPaintCost=0,this.noDataFound=!1,this.summary={parts:{partsSubTotal:0,sundryParts:0,sundryPartsPercentage:0,partsTotalBeforeDiscount:0,partsTotalDiscountPercentage:0,partsTotal:0},labour:{labourTimeHours:0,labourTotalDiscountPercentage:0,labourTotalDiscount:0,labourTotal:0},paint:{labour:{paintLabourTimeHour:0,paintLabourSubTotal:0,paintLabourDiscountPercentage:0,paintLabourDiscount:0,paintLabourTotal:0},material:{paintMaterialSubTotal:0,paintMateriaDiscountPercentage:0,paintMaterialDiscount:0,paintMaterialTotal:0},paintTotal:0}},this.total={total:0,vatPercent:0,vat:0,totalWithVat:0}}ngOnInit(){this.monitorService.logEvent("ngOnInit",["ChqEstimateDetailsComponent","addenda-repair"]),this.setData()}ngOnChanges(e){this.monitorService.logEvent("ngOnChanges",["ChqEstimateDetailsComponent","addenda-repair"]),e&&e.estimateResponse&&e.estimateResponse.currentValue&&(this.estimateResponse=Object.assign({},e.estimateResponse.currentValue),this.setData())}setData(){var e,t,i,n,o,a,s,r,l,d,c,u,p,m,h,g,v,f,S,b,x,Z,q,A,w,_,T,y,I,M,O,C,U,P,k,D,L,R,N,E,J,B,F,G,Q,H,j,Y,z,V,$,X;const K=(null===(e=this.estimateResponse)||void 0===e?void 0:e.estimateCharges)||[];if(0===K.length)this.noDataFound=!0;else{this.noDataFound=!1,this.labourCost=null==K?void 0:K.filter(e=>{var t;return"labour"==(null===(t=e.serviceType)||void 0===t?void 0:t.toLowerCase())}),this.paintCost=null==K?void 0:K.filter(e=>{var t;return"paint"==(null===(t=e.serviceType)||void 0===t?void 0:t.toLowerCase())}),this.partsCost=null==K?void 0:K.filter(e=>{var t;return"part"==(null===(t=e.serviceType)||void 0===t?void 0:t.toLowerCase())}),this.paintLabour=null===(t=this.paintCost)||void 0===t?void 0:t.filter(e=>{var t;return"paintlabour"==(null===(t=e.serviceSubType)||void 0===t?void 0:t.toLowerCase())}),this.paintMaterial=null===(i=this.paintCost)||void 0===i?void 0:i.filter(e=>{var t;return"paintmaterial"==(null===(t=e.serviceSubType)||void 0===t?void 0:t.toLowerCase())});const e=null===(n=this.estimateResponse)||void 0===n?void 0:n.estimateSummary;this.totalPartsCost=(null==e?void 0:e.partsSubTotal)?parseFloat(null==e?void 0:e.partsSubTotal):0,this.totalLabourCost=(null==e?void 0:e.labourTotalBeforeDiscount)?parseFloat(null==e?void 0:e.labourTotalBeforeDiscount):0,this.totalPaintCost=(null==e?void 0:e.paintSubTotal)?parseFloat(null==e?void 0:e.paintSubTotal):0,this.total.total=(null===(o=this.estimateResponse)||void 0===o?void 0:o.subTotal)||0,this.total.vatPercent=(null===(a=this.estimateResponse)||void 0===a?void 0:a.taxPercentage)||0,this.total.vat=(null===(s=this.estimateResponse)||void 0===s?void 0:s.taxTotal)||0,this.total.totalWithVat=(null===(r=this.estimateResponse)||void 0===r?void 0:r.total)||0,(null===(l=this.estimateResponse)||void 0===l?void 0:l.currencyCode)&&(this.i18n.currencySymbol=null===(d=this.estimateResponse)||void 0===d?void 0:d.currencyCode),this.summary.parts.partsSubTotal=(null===(u=null===(c=this.estimateResponse)||void 0===c?void 0:c.estimateSummary)||void 0===u?void 0:u.partsSubTotal)||0,this.summary.parts.sundryParts=(null===(m=null===(p=this.estimateResponse)||void 0===p?void 0:p.estimateSummary)||void 0===m?void 0:m.sundryParts)||0,this.summary.parts.sundryPartsPercentage=(null===(g=null===(h=this.estimateResponse)||void 0===h?void 0:h.estimateSummary)||void 0===g?void 0:g.sundryPartsPercentage)||0,this.summary.parts.partsTotalBeforeDiscount=(null===(f=null===(v=this.estimateResponse)||void 0===v?void 0:v.estimateSummary)||void 0===f?void 0:f.partsTotalBeforeDiscount)||0,this.summary.parts.partsTotalDiscountPercentage=(null===(b=null===(S=this.estimateResponse)||void 0===S?void 0:S.estimateSummary)||void 0===b?void 0:b.partsTotalDiscountPercentage)||0,this.summary.parts.partsTotal=(null===(Z=null===(x=this.estimateResponse)||void 0===x?void 0:x.estimateSummary)||void 0===Z?void 0:Z.partsTotal)||0,this.summary.parts.partsTotalDiscount=(null===(A=null===(q=this.estimateResponse)||void 0===q?void 0:q.estimateSummary)||void 0===A?void 0:A.partsTotalDiscount)||0,this.summary.labour.labourTimeHours=(null===(_=null===(w=this.estimateResponse)||void 0===w?void 0:w.estimateSummary)||void 0===_?void 0:_.labourTimeHours)||0,this.summary.labour.labourTotalDiscountPercentage=(null===(y=null===(T=this.estimateResponse)||void 0===T?void 0:T.estimateSummary)||void 0===y?void 0:y.labourTotalDiscountPercentage)||0,this.summary.labour.labourTotalDiscount=(null===(M=null===(I=this.estimateResponse)||void 0===I?void 0:I.estimateSummary)||void 0===M?void 0:M.labourTotalDiscount)||0,this.summary.labour.labourTotal=(null===(C=null===(O=this.estimateResponse)||void 0===O?void 0:O.estimateSummary)||void 0===C?void 0:C.labourTotal)||0,this.summary.paint.labour.paintLabourTimeHour=(null===(P=null===(U=this.estimateResponse)||void 0===U?void 0:U.estimateSummary)||void 0===P?void 0:P.paintLabourTimeHour)||0,this.summary.paint.labour.paintLabourSubTotal=(null===(D=null===(k=this.estimateResponse)||void 0===k?void 0:k.estimateSummary)||void 0===D?void 0:D.paintLabourSubTotal)||0,this.summary.paint.labour.paintLabourDiscountPercentage=(null===(R=null===(L=this.estimateResponse)||void 0===L?void 0:L.estimateSummary)||void 0===R?void 0:R.paintLabourDiscountPercentage)||0,this.summary.paint.labour.paintLabourDiscount=(null===(E=null===(N=this.estimateResponse)||void 0===N?void 0:N.estimateSummary)||void 0===E?void 0:E.paintLabourDiscount)||0,this.summary.paint.labour.paintLabourTotal=(null===(B=null===(J=this.estimateResponse)||void 0===J?void 0:J.estimateSummary)||void 0===B?void 0:B.paintLabourTotal)||0,this.summary.paint.material.paintMaterialSubTotal=(null===(G=null===(F=this.estimateResponse)||void 0===F?void 0:F.estimateSummary)||void 0===G?void 0:G.paintMaterialSubTotal)||0,this.summary.paint.material.paintMateriaDiscountPercentage=(null===(H=null===(Q=this.estimateResponse)||void 0===Q?void 0:Q.estimateSummary)||void 0===H?void 0:H.paintMateriaDiscountPercentage)||0,this.summary.paint.material.paintMaterialDiscount=(null===(Y=null===(j=this.estimateResponse)||void 0===j?void 0:j.estimateSummary)||void 0===Y?void 0:Y.paintMaterialDiscount)||0,this.summary.paint.material.paintMaterialTotal=(null===(V=null===(z=this.estimateResponse)||void 0===z?void 0:z.estimateSummary)||void 0===V?void 0:V.paintMaterialTotal)||0,this.summary.paint.paintTotal=(null===(X=null===($=this.estimateResponse)||void 0===$?void 0:$.estimateSummary)||void 0===X?void 0:X.paintTotal)||0}}handleIconClick(e,t){this.iconClicked.emit({action:e,id:t})}displayNotes(e){return e.isAztPartDocumentedByGT?'<img src="assets/img/gt.png" />':e.isConditionedBy?"<b>C </b>":e.isIncluded?"<b> I </b>":e.isNotIncluded?"<b>NI</b>":e.isOverlappedBy?"<b>-</b>":e.isPrepainted?'<img src="assets/img/prepainted_part.png" />':e.isThrownBy?"<b>+</b>":e.isApproximate?'<img src="assets/img/approximate.png" />':e.isManual?'<img src="assets/img/white_flag.png" />':""}isGTEstimate(){return"GTMotive"===this.estimateSource}handledownloadPdf(){this.downloadPdf.emit()}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(o.M))},e.\u0275cmp=n.Xpm({type:e,selectors:[["chq-estimate-details"]],inputs:{estimateResponse:"estimateResponse",editEstimate:"editEstimate",estimateSource:"estimateSource",serviceType:"serviceType",i18n:"i18n"},outputs:{iconClicked:"iconClicked",downloadPdf:"downloadPdf"},features:[n.TTD],decls:9,vars:6,consts:[[1,"d-flex","justify-space-between","align-center","estimate-label"],[3,"buttonModel","click",4,"ngIf"],[1,"estimate-main-container"],["class","estimate-details-block",4,"ngIf"],["class","estimate-details-no-data-found",4,"ngIf"],[3,"buttonModel","click"],[1,"estimate-details-block"],[1,"table-parent","mt-0"],[1,"small-heading"],["width","100%"],[4,"ngIf"],[3,"align"],["align","center","width","80px",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],["align","right"],[1,"table-parent"],["class","paint-type small-heading",4,"ngIf"],[1,"summary"],[1,"sub-heading"],[1,"sub-total"],[1,"table-parent","mb-0"],["width","100%",1,"total-table",3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["class","notes",4,"ngIf"],["align","center","width","80px"],[3,"ngClass"],["width","20px",4,"ngIf"],[1,"text-light"],["width","20px"],[3,"innerHTML"],[1,"icon-wrapper"],[1,"edit-icon",3,"svgIcon","click"],[1,"delete-icon",3,"svgIcon","click"],[1,"paint-type","small-heading"],[1,"fw-bold"],[1,"notes"],[1,"span-1"],[1,"p-10"],["src","assets/img/white_flag.png"],["aria-hidden","false",3,"svgIcon"],["src","assets/img/gt.png"],[1,"include"],["src","assets/img/prepainted_part.png"],[1,"estimate-details-no-data-found"],[1,"no-data-svg",3,"svgIcon"],[1,"no-data-text"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n.TgZ(1,"h3"),n._uU(2),n.ALo(3,"translate"),n.qZA(),n.ynx(4),n.YNc(5,c,1,1,"chq-button",1),n.BQk(),n.qZA(),n.TgZ(6,"div",2),n.YNc(7,E,261,405,"div",3),n.YNc(8,J,11,10,"div",4),n.qZA()),2&e&&(n.xp6(2),n.Oqu(n.lcZ(3,4,"estimate")),n.xp6(3),n.Q6J("ngIf",(null==t.estimateResponse||null==t.estimateResponse.estimateCharges?null:t.estimateResponse.estimateCharges.length)>0),n.xp6(2),n.Q6J("ngIf",!t.noDataFound),n.xp6(1),n.Q6J("ngIf",t.noDataFound))},directives:[a.O5,s.E,a.sg,a.mk,r.Hw],pipes:[l.X$,d.j],styles:['.estimate-details-block[_ngcontent-%COMP%]   .sub-heading[_ngcontent-%COMP%]{font-weight:500;font-size:14px;margin:0 0 15px;padding-left:10px}.estimate-details-block[_ngcontent-%COMP%]   .small-heading[_ngcontent-%COMP%]{font-weight:500;font-size:14px;margin:0 0 5px;padding-left:10px}.estimate-details-block[_ngcontent-%COMP%]   .table-parent[_ngcontent-%COMP%]{margin:32px 0}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{border-spacing:0px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{fill:red!important;height:15px;width:15px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   .edit-icon[_ngcontent-%COMP%]{height:18px;width:18px;margin-left:20px}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;font-size:14px;color:var(--xa-black-medium);border-bottom:1px solid var(--xa-lighter-gray)}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.fw-bold[_ngcontent-%COMP%]{font-weight:700}.estimate-details-block[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px;color:var(--xa-black) 3;font-weight:500;border-top:1px solid var(--xa-black);border-bottom:1px solid var(--xa-black)}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px}.estimate-details-block[_ngcontent-%COMP%]   .summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td.sub-total[_ngcontent-%COMP%]{font-size:14px;font-weight:500;padding-bottom:25px}.estimate-details-block[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-lighter-gray);font-size:12px;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]{margin-bottom:22px}.estimate-details-block[_ngcontent-%COMP%]   .total-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--xa-bold-gray);font-weight:700;font-size:16px;border-bottom:4px solid var(--xa-white)}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]{flex-wrap:wrap;display:flex;flex-direction:row;justify-content:space-between;font-weight:500}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]{font-size:14px;display:flex;flex-direction:column;justify-content:flex-start;box-sizing:border-box;padding:0 10px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .p-10[_ngcontent-%COMP%]{padding:10px 0}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .include[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;grid-gap:10px;gap:10px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:12px!important;width:10px!important}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   b[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{align-self:center}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:5px}.estimate-details-block[_ngcontent-%COMP%]   .notes[_ngcontent-%COMP%]   .span-1[_ngcontent-%COMP%]   .mb-20[_ngcontent-%COMP%]{margin-bottom:20px}.estimate-details-block[_ngcontent-%COMP%]   tr.child-data[_ngcontent-%COMP%]{background:rgba(26,34,55,.2)}.estimate-details-block[_ngcontent-%COMP%]   tr.child-data[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{padding-left:20px}.estimate-details-block[_ngcontent-%COMP%]   .paint-type[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;width:50%;font-size:12px;color:var(--xa-dark-gray)}.estimate-details-no-data-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 385px - (5px + 1.5vw + 48px + 1.6vw))}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-svg[_ngcontent-%COMP%]{width:112px;height:112px}.estimate-details-no-data-found[_ngcontent-%COMP%]   .no-data-text[_ngcontent-%COMP%]{font-family:"Inter";font-style:normal;font-weight:400;font-size:14px;line-height:21px;text-align:center;color:var(--xa-dark-gray)}']}),e})()},39912:function(e,t,i){i.d(t,{q:function(){return z}});var n=i(37716),o=i(75983),a=i(48873),s=i(4893),r=i(13975),l=i(95016),d=i(55278),c=i(56785),u=i(38583),p=i(8571),m=i(35782),h=i(48262),g=i(76627),v=i(36072),f=i(22406),S=i(36978),b=i(2913),x=i(29790);const Z=["chqUpload"];function q(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"chq-step-header",9),n.NdJ("uploadBackHandler",function(){return n.CHM(e),n.oxw().goBackToSelection()})("back",function(){return n.CHM(e),n.oxw().showReview()}),n.qZA()}if(2&e){const e=n.oxw();n.Q6J("chqModel",e.header)("hideHeader",e.hideHeader)("hideBack",e.hideback)("hideDelete",!0)}}function A(e,t){1&e&&n._UZ(0,"mat-icon",22),2&e&&n.Q6J("svgIcon","checked")}function w(e,t){1&e&&n._UZ(0,"mat-icon",23),2&e&&n.Q6J("svgIcon","unchecked")}function _(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"div",24),n.TgZ(1,"img",25),n.NdJ("load",function(){n.CHM(e);const t=n.oxw(2);return t.imageLoading[null==t.currentStep?null:t.currentStep.stepName]=!0}),n.qZA(),n.qZA()}if(2&e){const e=n.oxw(2);n.xp6(1),n.Q6J("src",null==e.currentStep?null:e.currentStep.image,n.LSH)}}function T(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"div",24),n.TgZ(1,"img",25),n.NdJ("load",function(){n.CHM(e);const t=n.oxw(3);return t.imageLoading[null==t.currentStep?null:t.currentStep.stepName]=!0}),n.qZA(),n.qZA()}if(2&e){const e=n.oxw(3);n.xp6(1),n.Q6J("src",null==e.currentStep?null:e.currentStep.url,n.LSH)}}function y(e,t){if(1&e&&n.YNc(0,T,2,1,"div",18),2&e){n.oxw();const e=n.MAs(18),t=n.oxw();n.Q6J("ngIf",null==t.currentStep?null:t.currentStep.url)("ngIfElse",e)}}function I(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"div",26),n.TgZ(1,"img",25),n.NdJ("load",function(){n.CHM(e);const t=n.oxw(2);return t.imageLoading[null==t.currentStep?null:t.currentStep.stepName]=!0}),n.qZA(),n.qZA()}if(2&e){const e=n.oxw(2);n.xp6(1),n.Q6J("src",null==e.currentStep?null:e.currentStep.placeHolderUrl,n.LSH)}}function M(e,t){if(1&e&&(n.TgZ(0,"div",10),n.TgZ(1,"div",11),n.TgZ(2,"h3",12),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.YNc(5,A,1,1,"mat-icon",13),n.YNc(6,w,1,1,"ng-template",null,14,n.W1O),n.qZA(),n.TgZ(8,"div",15),n.TgZ(9,"span",16),n._uU(10),n.ALo(11,"translate"),n.qZA(),n.qZA(),n.TgZ(12,"div",17),n.ynx(13),n.YNc(14,_,2,1,"div",18),n.YNc(15,y,1,2,"ng-template",null,19,n.W1O),n.YNc(17,I,2,1,"ng-template",null,20,n.W1O),n._UZ(19,"chq-customloader",21),n.BQk(),n.qZA(),n.qZA()),2&e){const e=n.MAs(7),t=n.MAs(16),i=n.oxw();n.xp6(3),n.hij(" ",n.lcZ(4,7,null!=i.currentStep&&i.currentStep.isAdditionalDocumentFromReviewPageOnly?"photos"===i.inspection?"add_additional_image":"add_additional_documents":null==i.currentStep?null:i.currentStep.stepName)," "),n.xp6(2),n.Q6J("ngIf","success"===(null==i.currentStep?null:i.currentStep.uploadStatus)||(null==i.currentStep?null:i.currentStep.url))("ngIfElse",e),n.xp6(5),n.Oqu(null!=i.currentStep&&i.currentStep.isUploadSuccess?"Uploaded":n.lcZ(11,9,null!=i.currentStep&&i.currentStep.uploadInProgress?"upload_inprogress":"not_uploaded")),n.xp6(4),n.Q6J("ngIf",null==i.currentStep?null:i.currentStep.image)("ngIfElse",t),n.xp6(5),n.Q6J("showLoading",!i.imageLoading[null==i.currentStep?null:i.currentStep.stepName]&&!(null==i.currentStep||!i.currentStep.url))}}function O(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"div",27),n.TgZ(1,"chq-vertical-image-preview",28),n.NdJ("selection",function(t){return n.CHM(e),n.oxw().setCurrentStep(t)}),n.qZA(),n.qZA()}if(2&e){const e=n.oxw();n.xp6(1),n.Q6J("maximumImages",e.maximumImages)("page",e.inspection)("steps",e.imageStatusSteps)("isMultipleUpload",e.isMassUpload)}}function C(e,t){1&e&&(n.TgZ(0,"div",29),n._UZ(1,"img",30),n.TgZ(2,"label"),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.qZA()),2&e&&(n.xp6(3),n.Oqu(n.lcZ(4,1,"drag_drop")))}function U(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.cancelButtonModel)}}function P(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.backButtonModel)}}function k(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.skipButtonModel)}}function D(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.uploadButtonModel)}}function L(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.deleteButton)}}function R(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.retakeButton)}}function N(e,t){if(1&e&&(n.TgZ(0,"div",37),n.YNc(1,U,1,1,"chq-button",38),n.YNc(2,P,1,1,"chq-button",38),n.YNc(3,k,1,1,"chq-button",38),n.YNc(4,D,1,1,"chq-button",38),n.YNc(5,L,1,1,"chq-button",38),n.YNc(6,R,1,1,"chq-button",38),n.qZA()),2&e){const e=n.oxw(3);n.xp6(1),n.Q6J("ngIf",e.showDelete&&(null==e.header?null:e.header.isRepairModule)&&!e.commonService.isViewOnly),n.xp6(1),n.Q6J("ngIf",!0===(null==e.footerOptions?null:e.footerOptions.showUploadOption)&&!(null!=e.header&&e.header.isRepairModule)),n.xp6(1),n.Q6J("ngIf",!(null!=e.currentStep&&e.currentStep.mandatory||e.showReTakeDelete&&-1===(null==e.currentStep?null:e.currentStep.stepName.indexOf("Additional"))&&(null!=e.currentStep&&e.currentStep.image||null!=e.currentStep&&e.currentStep.url))),n.xp6(1),n.Q6J("ngIf",(!e.showReTakeDelete||-1!==(null==e.currentStep?null:e.currentStep.stepName.indexOf("Additional"))||!(null!=e.currentStep&&e.currentStep.image)&&!(null!=e.currentStep&&e.currentStep.url))&&!e.commonService.isViewOnly&&e.currentStatus),n.xp6(1),n.Q6J("ngIf",e.showReTakeDelete&&!e.commonService.isViewOnly&&e.currentStatus&&-1===(null==e.currentStep?null:e.currentStep.stepName.indexOf("Additional"))&&((null==e.currentStep?null:e.currentStep.image)||(null==e.currentStep?null:e.currentStep.url))),n.xp6(1),n.Q6J("ngIf",e.showReTakeDelete&&!e.commonService.isViewOnly&&e.currentStatus&&-1===(null==e.currentStep?null:e.currentStep.stepName.indexOf("Additional"))&&((null==e.currentStep?null:e.currentStep.image)||(null==e.currentStep?null:e.currentStep.url)))}}function E(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.cancelButtonModel)}}function J(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.backButtonModel)}}function B(e,t){if(1&e&&n._UZ(0,"chq-button",39),2&e){const e=n.oxw(4);n.Q6J("buttonModel",e.uploadButtonModel)}}function F(e,t){if(1&e&&(n.TgZ(0,"div",37),n.YNc(1,E,1,1,"chq-button",38),n.YNc(2,J,1,1,"chq-button",38),n.YNc(3,B,1,1,"chq-button",38),n.qZA()),2&e){const e=n.oxw(3);n.xp6(1),n.Q6J("ngIf",e.showDelete&&(null==e.header?null:e.header.isRepairModule)&&!e.commonService.isViewOnly),n.xp6(1),n.Q6J("ngIf",!0===(null==e.footerOptions?null:e.footerOptions.showUploadOption)&&!(null!=e.header&&e.header.isRepairModule)),n.xp6(1),n.Q6J("ngIf",(!e.showReTakeDelete||e.hideback||-1!==(null==e.currentStep?null:e.currentStep.stepName.indexOf("Additional"))||!(null!=e.currentStep&&e.currentStep.image)&&!(null!=e.currentStep&&e.currentStep.url))&&e.currentStatus&&!e.commonService.isViewOnly)}}function G(e,t){if(1&e&&(n.ynx(0),n.YNc(1,N,7,6,"div",36),n.YNc(2,F,4,3,"div",36),n.BQk()),2&e){const e=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!e.isMassUpload),n.xp6(1),n.Q6J("ngIf",e.isMassUpload)}}function Q(e,t){if(1&e&&(n.TgZ(0,"div",31),n.TgZ(1,"div",32),n.TgZ(2,"div",33),n._UZ(3,"img",34),n.qZA(),n.qZA(),n.YNc(4,G,3,2,"ng-container",35),n.qZA()),2&e){const e=n.oxw();n.xp6(3),n.MGl("src","assets/img/",+(null==e.header?null:e.header.isRepairModule)?"addenda-repair.png":"addenda-quote.png","",n.LSH),n.xp6(1),n.Q6J("chqPermission",null!=e.footerOptions&&e.footerOptions.section?"repairStages":"newBooking")}}function H(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"chq-review-section",40),n.NdJ("backToUpload",function(){return n.CHM(e),n.oxw().goBackToSelection()})("handleDeleteAllEvent",function(){return n.CHM(e),n.oxw().handleAllImagesDelete()})("selection",function(t){return n.CHM(e),n.oxw().handleReviewAction(t)}),n.qZA()}if(2&e){const e=n.oxw();n.Q6J("maximumImages",e.maximumImages)("hideAI",e.hideAI)("isRepairStage",e.isRepairStage)("minimumPhotosRequired",e.minumumImagesRequired)("footerOptions",e.footerOptions)("currentAdditionalModeMultiple",e.currentAdditionalModeMultiple)("isMultipleUpload",e.isMassUpload)("inspectionId",e.inspectionId)("header",e.header)("steps",e.imageStatusSteps)}}const j=function(e,t){return{"no-border":e,"document-container":t}},Y=function(e){return{disabled:e}};let z=(()=>{class e{constructor(e,t,i,o,a,s,r){this.cd=e,this.commonService=t,this.inspectionService=i,this.monitorService=o,this.route=a,this.router=s,this.calendarService=r,this.minumumImagesRequired=0,this.updateMassUpload=new n.vpe,this.cardSelection=new n.vpe,this.backToUpload=new n.vpe,this.handleDeleteAllEvent=new n.vpe,this.stepSkipped=new n.vpe,this.totalAdditionalSteps=0,this.hideHeader=!1,this.skipButtonModel={label:"skip",type:"primary"},this.uploadButtonModel={label:"upload",type:"primary"},this.retakeButton={label:"retake",type:"primary"},this.backButtonModel={label:"back_to_photo",type:"outline"},this.deleteButton={label:"delete",type:"red"},this.bookButton={label:"book_in",type:"primary"},this.cancelButtonModel={label:"Cancel Booking",type:"outline-danger",onclick:this.cancelBooking.bind(this)},this.imageLoading={},this.fromReviewPage=!1,this.isReviewSection=!1,this.hideback=!1,this.currentStepIndex=0,this.currentNonReviewSteps=0,this.imageStatusSteps=[]}get showDelete(){var e,t,i,n,o,a,s;return!(!(null===(e=this.footerOptions)||void 0===e?void 0:e.repairId)||"draft"!==(null===(i=null===(t=this.footerOptions)||void 0===t?void 0:t.currentStatus)||void 0===i?void 0:i.toLowerCase()))||!(!(null===(n=this.footerOptions)||void 0===n?void 0:n.repairId)||1!=(null===(o=this.footerOptions)||void 0===o?void 0:o.isRepairCreatedFromCase)||"repairestimation"!=(null===(s=null===(a=this.footerOptions)||void 0===a?void 0:a.currentStatus)||void 0===s?void 0:s.toLowerCase()))}handleImageOutput(e){var t;if(this.monitorService.logEvent("handleImageOutput",["ChqImagesUploaderComponent","addenda-quote",{$event:e}]),this.isMassUpload||this.currentAdditionalModeMultiple){this.currentAdditionalModeMultiple=!0;const i=e;let n=0;for(const e in i){const t=i[e],o={stepName:t.fileName,uploadStatus:"notUploaded",url:"",image:t.image,imageFile:t.file,index:n,sizeLimit:5242880,isMassUpload:!0,allowExtension:["jpg","jpeg","png"],mandatory:!0,placeHolderUrl:"",isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,templateGuid:"",partTemplateGuid:""};n++,this.imageStatusSteps.push(o)}this.updateMassUpload.emit(this.isMassUpload?{steps:this.imageStatusSteps.filter(e=>1!=e.isUploadSuccess&&!0!==e.uploadInProgress)}:{steps:[this.imageStatusSteps[this.imageStatusSteps.length-1]]}),this.nonAdditional<(this.maximumImages||20)?0===this.imageStatusSteps.filter(e=>-1===e.index&&!0===e.isAdditionalDocumentFromReviewPageOnly).length&&this.imageStatusSteps.push({stepName:"photos"===this.inspection?"Additional Image":"Additional Documents",uploadStatus:"notUploaded",url:"",image:"",index:-1,isAdditionalDocumentFromReviewPageOnly:!0,sizeLimit:5242880,allowExtension:["jpg","jpeg","png"],mandatory:!1,isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,templateGuid:"",partTemplateGuid:"",placeHolderUrl:"/assets/icons/additional-image.svg"}):(this.imageStatusSteps=null===(t=null==this?void 0:this.imageStatusSteps)||void 0===t?void 0:t.filter(e=>1!=e.isAdditionalDocumentFromReviewPageOnly||e.image||e.url),this.imageStatusSteps[this.imageStatusSteps.length-1].isAdditionalDocumentFromReviewPageOnly=!1),this.imageStatusSteps=[...this.imageStatusSteps],this.isReviewSection=!0,this.fromReviewPage=!1}else{const t=e;if(this.currentStep.isAdditionalDocumentFromReviewPageOnly){const e=this.imageStatusSteps.filter(e=>!0===e.isAdditionalDocumentFromReviewPageOnly&&1!=e.uploadInProgress);this.currentStep=e[0]}if(this.currentStep.image=t.image,this.currentStep.imageFile=t.file,this.imageStatusSteps=[...this.imageStatusSteps],"photos"==this.inspection){const e=new Image;e.src=t.image,e.onload=()=>{var t;this.currentStep.imageHeight=e.height,this.currentStep.imageWidth=e.width,this.executeUploader(),0==(null===(t=this.imageStatusSteps.filter(e=>e=>!0!==e.isUploadSuccess&&e.mandatory))||void 0===t?void 0:t.length)||this.fromReviewPage||this.currentStep.isAdditionalDocumentFromReviewPageOnly?(this.isReviewSection=!0,this.fromReviewPage=!1):(this.isReviewSection=!1,this.currentStepIndex++,this.currentStepIndex>this.imageStatusSteps.length-1&&this.currentStepIndex--,this.currentStep=this.imageStatusSteps[this.currentStepIndex])}}else this.executeUploader(),this.currentStepIndex===this.imageStatusSteps.length||0===this.totalAdditionalSteps&&this.currentStepIndex===this.imageStatusSteps.length-1||this.currentStep.isAdditionalDocumentFromReviewPageOnly||this.fromReviewPage?(this.isReviewSection=!0,this.fromReviewPage=!1,this.checkRouteParams()):(this.isReviewSection=!1,this.currentStepIndex++,this.currentStep=this.imageStatusSteps[this.currentStepIndex],this.cardSelection.emit(this.currentStep))}}checkRouteParams(){var e;null===(e=this.route.queryParams)||void 0===e||e.subscribe(e=>{const t=e.fromPersonal;"true"===t||!0===t?this.router.navigate(["/repair/booking/0"]):(this.isReviewSection=!0,this.fromReviewPage=!1)})}onScroll(){window.clearTimeout(this.isScrolling);const e=document.getElementsByClassName("footer-full-wrapper");e&&e.length>0&&(e[0].style.position="absolute"),this.isScrolling=setTimeout(()=>{const e=document.getElementsByClassName("footer-full-wrapper");e&&e.length>0&&(e[0].style.position="fixed")},66)}get nonAdditional(){var e;return null===(e=null==this?void 0:this.imageStatusSteps)||void 0===e?void 0:e.filter(e=>1!=e.isAdditionalDocumentFromReviewPageOnly||e.image||e.url).length}goToReview(){this.isReviewSection=!0,this.fromReviewPage=!1,this.monitorService.logEvent("goToReview",["ChqImagesUploaderComponent","addenda-quote"])}handleAllImagesDelete(){this.imageStatusSteps=[],this.handleDeleteAllEvent.emit()}executeUploader(){this.fileUploaderService&&(this.commonService.showNotification("Your photo is currently uploading won\u2019t be long and we\u2019ll \n    notify you when its uploaded, you can continue to take your photos."),this.fileUploaderService(this.currentStep),this.monitorService.logEvent("executeUploader",["ChqImagesUploaderComponent","addenda-quote"]),setTimeout(()=>{const e=this.imageStatusSteps.filter(e=>!0===e.uploadInProgress);e.length>0&&(this.hideback=!0),this.commonService.inProgressSteps.next(e.length)}))}handleReviewAction(e){var t,i,n,a;this.monitorService.logEvent("handleReviewAction",["ChqImagesUploaderComponent","addenda-quote",{$event:e}]),(null===(t=this.footerOptions)||void 0===t?void 0:t.repairId)&&["edit","upload"].includes(e.mode)&&(null===(i=this.footerOptions)||void 0===i?void 0:i.from)==o.j.quote&&this.commonService.repairPermission||(null===(n=this.footerOptions)||void 0===n?void 0:n.caseId)&&["edit","upload"].includes(e.mode)&&(null===(a=this.footerOptions)||void 0===a?void 0:a.from)==o.j.repair&&this.commonService.quotePermission?this.commonService.showChangeWarningMessage(this.handleReviewActionCall.bind(this,e),"Quote"==this.footerOptions.from?"Repair":"Quote"):this.handleReviewActionCall(e)}handleReviewActionCall(e){if("edit"===e.mode)this.setCurrentStep(e.step),this.isReviewSection=!1,this.fromReviewPage=!0;else if("upload"===e.mode)this.setCurrentStep(e.step),this.fromReviewPage=!0,this.uploadFile();else if(e.step.inspectionItem){const t=this.imageStatusSteps.findIndex(t=>{var i,n;return(null===(i=t.inspectionItem)||void 0===i?void 0:i.id)===(null===(n=e.step.inspectionItem)||void 0===n?void 0:n.id)});this.deleteSelectedImage(e.step,t)}else{const t=e.step.index;this.deleteSelectedImage(this.imageStatusSteps[t],t)}}deleteSelectedImage(e,t){e.url="",e.uploadedGuid="",e.updatedDate="",e.uploadedDate="",e.uploadInProgress=!1,e.isSkipped=!1,e.isUploadSuccess=!1,e.uploadedPartGuid="",e.isUploadFailed=!1,e.imageFile=null,e.image=null,e.uploadStatus="notUploaded",-1!=e.stepName.indexOf("Additional")&&(e.isAdditionalDocumentFromReviewPageOnly=!0),e.isMassUpload||"Bulk Upload Image"===e.procedureSteps?this.imageStatusSteps=this.imageStatusSteps.filter(t=>{var i,n;return(null===(i=null==t?void 0:t.inspectionItem)||void 0===i?void 0:i.id)!=(null===(n=null==e?void 0:e.inspectionItem)||void 0===n?void 0:n.id)}):(this.imageStatusSteps[t]=Object.assign({},e),this.imageStatusSteps=[...this.imageStatusSteps],0===this.imageStatusSteps.filter(e=>e.image||e.url).length&&"photos"===this.inspection?(this.footerOptions.showUploadOption=!0,this.hideback=!1,this.header=Object.assign(Object.assign({},this.header),{showTitle:!0})):this.header=Object.assign(Object.assign({},this.header),{showTitle:!1})),0===this.imageStatusSteps.filter(e=>e.url).length&&(this.hideback=!1,this.setCurrentStep(this.imageStatusSteps[0]))}get currentStatus(){var e,t,i;return!(null===(e=this.footerOptions)||void 0===e?void 0:e.currentStatus)||-1===["closed","complete"].indexOf(null===(i=null===(t=this.footerOptions)||void 0===t?void 0:t.currentStatus)||void 0===i?void 0:i.toLowerCase())}delete(){this.monitorService.logEvent("delete",["ChqImagesUploaderComponent","addenda-quote"]),this.currentStep.url&&"photos"===this.inspection&&this.inspectionService.deleteInspection(this.currentStep.inspectionItem.id).subscribe(e=>{this.commonService.hideLoading(),0===this.imageStatusSteps.filter(e=>e.image||e.url).length&&(this.footerOptions.showUploadOption=!0)},()=>{this.commonService.hideLoading()}),this.currentStep.image=null,this.currentStep.uploadedGuid="",this.currentStep.uploadInProgress=!1,this.currentStep.isSkipped=!1,this.currentStep.isUploadSuccess=!1,this.currentStep.isUploadFailed=!1,this.currentStep.imageFile=null,this.currentStep.url="",this.currentStep.updatedDate="",this.currentStep.uploadedDate="",this.currentStep.uploadStatus="notUploaded",-1!=this.currentStep.stepName.indexOf("Additional")&&(this.currentStep.isAdditionalDocumentFromReviewPageOnly=!0),0===this.imageStatusSteps.filter(e=>e.url).length&&(this.hideback=!1,this.setCurrentStep(this.imageStatusSteps[0]))}updateUploadStatus(e,t,i,n,o){var s,r;if(this.monitorService.logEvent("updateUploadStatus",["ChqImagesUploaderComponent","addenda-quote",{status:e,currentStep:t,responseData:n,isBulk:o}]),this.chqUpload.resetValue(),"failed"==e){t.uploadInProgress=!1,t.isSkipped=!1,t.isUploadSuccess=!1,t.isUploadFailed=!1,o?t.isUploadFailed=!0:(t.imageFile=null,t.image=null);const e=i&&(null===(s=i.error)||void 0===s?void 0:s.msg)?null===(r=i.error)||void 0===r?void 0:r.msg:`Your photo \u2018${t.stepName}\u2019 failed to upload. Please try to upload again.`;this.commonService.showToast(i?i.status:0,e),this.currentStep.isAdditionalDocumentFromReviewPageOnly&&(this.currentStep={stepName:"photos"===this.inspection?"Additional Image":"Additional Documents",uploadStatus:"notUploaded",url:"",image:"",index:-1,isAdditionalDocumentFromReviewPageOnly:!0,sizeLimit:this.currentStep.sizeLimit,allowExtension:this.currentStep.allowExtension,mandatory:!1,isUploadSuccess:!1,uploadInProgress:!1,isUploadFailed:!1,isSkipped:!1,isMassUpload:t.isMassUpload,templateGuid:this.currentStep.templateGuid,partTemplateGuid:this.currentStep.partTemplateGuid,placeHolderUrl:"/assets/icons/additional-image.svg"})}else"success"==e&&(t.uploadInProgress=!1,t.isSkipped=!1,t.isUploadFailed=!1,t.isUploadSuccess=!0,t.uploadStatus="success",t.updatedDate=a().toISOString(),t.uploadedDate=a().toISOString(),t.isAdditionalDocumentFromReviewPageOnly=!1,"photos"===this.inspection&&(t.inspectionItem=n),n&&(t.originalName&&(t.stepName=t.originalName),t.uploadedGuid=n.mediaGuid,t.uploadedPartGuid=n.mediaPartGuid));this.imageStatusSteps=[...this.imageStatusSteps];const l=this.imageStatusSteps.filter(e=>!0===e.uploadInProgress);this.hideback=!0,this.commonService.inProgressSteps.next(l.length)}deleteImage(){this.monitorService.logEvent("deleteImage",["ChqImagesUploaderComponent","addenda-quote"]),this.commonService.openDeleteDialog("image").afterClosed().subscribe(e=>{e&&this.delete()})}uploadFile(){this.monitorService.logEvent("uploadFile",["ChqImagesUploaderComponent","addenda-quote"]),this.chqUpload.triggerUpload()}setCurrentStep(e){this.currentStepIndex=null==e?void 0:e.index,this.currentStep=e,-1!==(null==e?void 0:e.stepName.indexOf("Additional"))&&(this.skipButtonModel=Object.assign(Object.assign({},this.skipButtonModel),{label:"Skip and Review"})),this.cardSelection.emit(this.currentStep)}skipUpload(){var e,t;if(this.monitorService.logEvent("skipUpload",["ChqImagesUploaderComponent","addenda-quote"]),this.stepSkipped.emit(),this.currentStepIndex===this.imageStatusSteps.length||0===this.totalAdditionalSteps&&this.currentStepIndex===this.imageStatusSteps.length-1||this.currentStep.isAdditionalDocumentFromReviewPageOnly||this.fromReviewPage){if("photos"===this.inspection&&0!==(null===(e=this.imageStatusSteps.filter(e=>!0!==e.isUploadSuccess&&e.mandatory))||void 0===e?void 0:e.length))return(null===(t=this.imageStatusSteps.filter(e=>!0===e.uploadInProgress&&e.mandatory))||void 0===t?void 0:t.length)?void this.commonService.showToast(0,"Please wait until all images are uploaded."):void this.commonService.showToast(0,"All 8 sides images are mandatory and cannot skip to next section.");this.isReviewSection=!0,this.fromReviewPage=!1}else this.currentStep.isUploadSuccess||(this.currentStep.uploadStatus="skipped"),this.currentStepIndex++,this.currentStep=this.imageStatusSteps[this.currentStepIndex],this.cardSelection.emit(this.currentStep)}goBackToSelection(){const e=this.imageStatusSteps.filter(e=>e.url||e.image).length;if(this.isReviewSection&&e>0)return this.isReviewSection=!1,void(this.isMassUpload&&(this.hideHeader=!0));this.hideHeader=!1,this.backToUpload.emit()}showReview(){this.isReviewSection=!0,this.hideHeader=!1}cancelBooking(){this.commonService.openDeleteDialog().afterClosed().subscribe(e=>{e&&(this.commonService.showLoading(),this.calendarService.deleteBooking(this.footerOptions.bookingId).subscribe({next:()=>{this.commonService.hideLoading(),this.router.navigate(["/repair/booking-journal"])}}))})}dragOver(e){e.preventDefault(),e.stopPropagation()}dragLeave(e){e.preventDefault(),e.stopPropagation()}drop(e){e.preventDefault(),e.stopPropagation(),this.chqUpload.handleUpload(e)}ngOnInit(){var e;this.monitorService.logEvent("ngOnInit",["ChqImagesUploaderComponent","addenda-quote"]),this.currentStep=this.imageStatusSteps[this.currentStepIndex];const t=this.imageStatusSteps.find(e=>e.stepName.includes("Additional Document")&&!e.uploadedPartGuid);t&&(t.originalName=t.stepName,t.stepName=t.parentName,t.placeHolderUrl="/assets/icons/additional-image.svg"),this.backButtonModel=Object.assign(Object.assign({},this.backButtonModel),{onclick:this.goBackToSelection.bind(this)});for(let i=0;i<this.imageStatusSteps.length;i++)this.imageLoading[this.imageStatusSteps[i].stepName]=!1;this.currentNonReviewSteps=this.imageStatusSteps.filter(e=>!0!==e.isAdditionalDocumentFromReviewPageOnly).length,this.totalAdditionalSteps=this.imageStatusSteps.length-this.currentNonReviewSteps,this.cardSelection.emit(this.currentStep),this.commonService.updatePage("/quote/case/0",this.inspection?this.inspection:"document"),this.imageStatusSteps.filter(e=>e.url).length>0&&(this.isReviewSection=!0,this.hideback=!0),this.skipButtonModel={label:"Skip",type:"outline",onclick:this.skipUpload.bind(this)},this.uploadButtonModel={label:"Upload",type:"primary",icon:"upload",onclick:this.uploadFile.bind(this)},(null===(e=this.header)||void 0===e?void 0:e.isRepairModule)&&(this.uploadButtonModel=Object.assign(Object.assign({},this.uploadButtonModel),{icon:"",type:"outline"})),this.retakeButton={label:"Retake",type:"primary",icon:"renew",onclick:this.uploadFile.bind(this)},this.deleteButton={label:"Delete",type:"red",icon:"delete",onclick:this.deleteImage.bind(this)}}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(n.sBO),n.Y36(s.v),n.Y36(r.a),n.Y36(l.M),n.Y36(d.gz),n.Y36(d.F0),n.Y36(c.o))},e.\u0275cmp=n.Xpm({type:e,selectors:[["chq-images-uploader"]],viewQuery:function(e,t){if(1&e&&n.Gf(Z,5),2&e){let e;n.iGM(e=n.CRH())&&(t.chqUpload=e.first)}},hostBindings:function(e,t){1&e&&n.NdJ("dragover",function(e){return t.dragOver(e)})("dragleave",function(e){return t.dragLeave(e)})("drop",function(e){return t.drop(e)})},inputs:{header:"header",footerOptions:"footerOptions",showReTakeDelete:"showReTakeDelete",isMassUpload:"isMassUpload",inspection:"inspection",inspectionId:"inspectionId",isRepairStage:"isRepairStage",hideAI:"hideAI",minumumImagesRequired:"minumumImagesRequired",maximumImages:"maximumImages",currentAdditionalModeMultiple:"currentAdditionalModeMultiple",fileUploaderService:"fileUploaderService",imageStatusSteps:"imageStatusSteps"},outputs:{updateMassUpload:"updateMassUpload",cardSelection:"cardSelection",backToUpload:"backToUpload",handleDeleteAllEvent:"handleDeleteAllEvent",stepSkipped:"stepSkipped"},decls:9,vars:19,consts:[[3,"chqModel","hideHeader","hideBack","hideDelete","uploadBackHandler","back",4,"ngIf"],[1,"main-container",3,"ngClass","scroll"],[3,"currentStep","currentPageName","currentFileNumber","isCurrentAdditionalModeMultiple","maxFileAllowed","ngClass","isMultiple","imageOutput"],["chqUpload",""],["class","info-container",4,"ngIf"],["class","vehicle-status-container",4,"ngIf"],["class","mass-upload",4,"ngIf"],["class","footer-full-wrapper",4,"ngIf"],[3,"maximumImages","hideAI","isRepairStage","minimumPhotosRequired","footerOptions","currentAdditionalModeMultiple","isMultipleUpload","inspectionId","header","steps","backToUpload","handleDeleteAllEvent","selection",4,"ngIf"],[3,"chqModel","hideHeader","hideBack","hideDelete","uploadBackHandler","back"],[1,"info-container"],[1,"header-div"],[1,"header-label","text-black"],["aria-hidden","false","aria-label","checked icon",3,"svgIcon",4,"ngIf","ngIfElse"],["unchecked",""],[1,"span-container"],[1,"text-dark-gray"],[1,"block-image"],["class","car-image-container",4,"ngIf","ngIfElse"],["serverImage",""],["defaultImage",""],[3,"showLoading"],["aria-hidden","false","aria-label","checked icon",3,"svgIcon"],["aria-hidden","false","aria-label","unchecked icon",3,"svgIcon"],[1,"car-image-container"],[3,"src","load"],[1,"car-image-container","default-image"],[1,"vehicle-status-container"],[3,"maximumImages","page","steps","isMultipleUpload","selection"],[1,"mass-upload"],["src","assets/icons/no-document.svg"],[1,"footer-full-wrapper"],[1,"footer-image-wrapper"],[1,"image-wrapper"],[3,"src"],[4,"chqPermission"],["class","footer-button-wrapper",4,"ngIf"],[1,"footer-button-wrapper"],[3,"buttonModel",4,"ngIf"],[3,"buttonModel"],[3,"maximumImages","hideAI","isRepairStage","minimumPhotosRequired","footerOptions","currentAdditionalModeMultiple","isMultipleUpload","inspectionId","header","steps","backToUpload","handleDeleteAllEvent","selection"]],template:function(e,t){1&e&&(n.YNc(0,q,1,4,"chq-step-header",0),n.TgZ(1,"div",1),n.NdJ("scroll",function(){return t.onScroll()}),n.TgZ(2,"chq-upload",2,3),n.NdJ("imageOutput",function(e){return t.handleImageOutput(e)}),n.qZA(),n.YNc(4,M,20,11,"div",4),n.YNc(5,O,2,4,"div",5),n.YNc(6,C,5,3,"div",6),n.YNc(7,Q,5,2,"div",7),n.YNc(8,H,1,10,"chq-review-section",8),n.qZA()),2&e&&(n.Q6J("ngIf",!t.isReviewSection),n.xp6(1),n.Q6J("ngClass",n.WLB(14,j,t.isReviewSection,"photos"!==t.inspection&&(null==t.header?null:t.header.isRepairModule))),n.xp6(1),n.Q6J("currentStep",t.currentStep)("currentPageName",t.inspection)("currentFileNumber",t.nonAdditional)("isCurrentAdditionalModeMultiple",t.currentAdditionalModeMultiple)("maxFileAllowed",t.maximumImages||20)("ngClass",n.VKq(17,Y,null==t.currentStep?null:t.currentStep.uploadInProgress))("isMultiple",t.isMassUpload),n.xp6(2),n.Q6J("ngIf",!t.isReviewSection&&!t.isMassUpload),n.xp6(1),n.Q6J("ngIf",!t.isReviewSection&&!t.isMassUpload),n.xp6(1),n.Q6J("ngIf",!t.isReviewSection&&t.isMassUpload),n.xp6(1),n.Q6J("ngIf",!t.isReviewSection),n.xp6(1),n.Q6J("ngIf",t.isReviewSection))},directives:[u.O5,u.mk,p.q,m._,h.h,g.Hw,v.Z,f.A,S.E,b.F],pipes:[x.X$],styles:[".main-container[_ngcontent-%COMP%]{display:flex;border:1px solid var(--xa-form-border);border-radius:8px;background:var(--xa-white)}.main-container.document-container[_ngcontent-%COMP%]{margin-left:calc(6px + 1.5vw);margin-right:calc(5px + 1.5vw)}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;position:relative;border-right:1px solid var(--xa-light-gray);padding:54px 34px}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .header-div[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.main-container[_ngcontent-%COMP%]   .info-container[_ngcontent-%COMP%]   .header-div[_ngcontent-%COMP%]   .header-label[_ngcontent-%COMP%]{margin-right:16px}.main-container[_ngcontent-%COMP%]   .span-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;line-height:14px}.main-container[_ngcontent-%COMP%]   .block-image[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;grid-gap:10px;gap:10px;flex:1;justify-content:center;position:relative}.main-container[_ngcontent-%COMP%]   .block-image[_ngcontent-%COMP%]   .car-image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:auto;width:auto;max-height:calc(100vh - 168px - 188px - 126px);max-width:100%}.main-container[_ngcontent-%COMP%]   .vehicle-status-container[_ngcontent-%COMP%]{overflow:auto;z-index:2;border-top-right-radius:8px;border-bottom-right-radius:8px}.main-container[_ngcontent-%COMP%]   chq-review-section[_ngcontent-%COMP%]{flex:1}.no-border[_ngcontent-%COMP%]{border:none;background:transparent}.disabled[_ngcontent-%COMP%]{pointer-events:none}.mass-upload[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex:1;flex-direction:column;width:154px;height:calc(100vh - 295px)}.mass-upload[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:154px}.mass-upload[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:12px;line-height:16px;color:var(--xa-text-ligher-gray)}.no-border.main-container[_ngcontent-%COMP%]{padding-bottom:1.5vw}.main-container[_ngcontent-%COMP%]:not(.no-border){height:calc(100vh - 170px - (calc(1.5vw)) - (calc(5px + 1.5vw + 48px + 1.6vw)))}"]}),e})()},8571:function(e,t,i){i.d(t,{q:function(){return p}});var n=i(37716),o=i(67980),a=i(84967),s=i(33568),r=i(84945),l=i(83853),d=i(4893),c=i(95016);const u=["upload"];let p=(()=>{class e{constructor(e,t,i){this.el=e,this.commonService=t,this.monitorService=i,this.imageOutput=new n.vpe,this.maxFileAllowed=20}getFileExtension(e){return e.split(".").pop()}checkFileSize(e){return!(e.size>(this.currentStep?this.currentStep.sizeLimit:l.rs)||e.size<l.fi&&"photos"===this.currentPageName)||(this.monitorService.logEvent("checkFileSize",["ChqUploadComponent","addenda-quote",{message:"invalid file size."}]),!1)}isValidImageFile(e){if(new RegExp("^.*\\.[a-zA-Z]+$","gm").test(e)){const t=e.split(".").pop();return(this.currentStep?this.currentStep.allowExtension:l.m2).includes(null==t?void 0:t.toLowerCase())}return!1}triggerUpload(){setTimeout(()=>{this.upload.nativeElement.click()})}resetValue(){setTimeout(()=>{this.upload.nativeElement.value=null})}fileReaderObservable(e){return new o.y(t=>{const i=new FileReader;i.readAsDataURL(e),i.onload=n=>{t.next({image:i.result,fileName:e.name,file:e}),t.complete()}})}handleUpload(e){this.monitorService.logEvent("handleUpload",["ChqUploadComponent","addenda-quote",{event:e}]);const t=e.target.files||e.srcElement.files||e.dataTransfer.files;if(null!==t&&""!==t&&t.length>0)if(this.commonService.showLoading(),this.isMultiple||this.isCurrentAdditionalModeMultiple){if(t.length>this.maxFileAllowed)return this.commonService.showToast(0,`Maximum ${this.maxFileAllowed} files are allowed.`),this.commonService.hideLoading(),void this.resetValue();if(t.length+this.currentFileNumber>this.maxFileAllowed)return this.commonService.showToast(0,`Maximum ${this.maxFileAllowed} files are allowed.`),this.commonService.hideLoading(),void this.resetValue();const e={};let i=0,n=0;for(let o=0;o<t.length;o++)this.isValidImageFile(t[o].name)?this.checkFileSize(t[o])||this.skipFileSizeValidation?e[o]=this.fileReaderObservable(t[o]):n++:i++;if(n>0&&this.commonService.showToast(0,"For an accurate A.I. analysis please upload images which are not smaller than 0.5 MB and do not exceed 5 MB"),i>0&&this.commonService.showToast(0,"Failed to upload file; the format is not supported."),0===Object.keys(e).length)return this.commonService.hideLoading(),void this.resetValue();(0,a.D)(e).pipe((0,s.K)(e=>(0,r.of)(e))).subscribe(e=>{this.commonService.hideLoading(),e&&this.imageOutput.emit(e),this.resetValue()},()=>{this.resetValue(),this.commonService.hideLoading()})}else{if(!this.isValidImageFile(t[0].name))return this.commonService.showToast(0,"Failed to upload file; the format is not supported."),this.commonService.hideLoading(),void this.resetValue();if(!this.checkFileSize(t[0])){let e="For an accurate A.I. analysis please upload image which are not smaller than 0.5 MB and do not exceed 5 MB";return"photos"!==this.currentPageName&&(e="Image is not of the correct size.  Please provide valid file size  (Max : 5 MB)"),this.commonService.showToast(0,e),this.commonService.hideLoading(),void this.resetValue()}const e=new FileReader;e.readAsDataURL(t[0]),e.onload=i=>{this.commonService.hideLoading(),this.resetValue(),this.imageOutput.emit({image:e.result,fileName:t[0].name,file:t[0]})},e.onerror=e=>{this.resetValue(),this.commonService.hideLoading()}}}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(n.SBq),n.Y36(d.v),n.Y36(c.M))},e.\u0275cmp=n.Xpm({type:e,selectors:[["chq-upload"]],viewQuery:function(e,t){if(1&e&&n.Gf(u,5),2&e){let e;n.iGM(e=n.CRH())&&(t.upload=e.first)}},inputs:{currentStep:"currentStep",isMultiple:"isMultiple",isCurrentAdditionalModeMultiple:"isCurrentAdditionalModeMultiple",currentFileNumber:"currentFileNumber",skipFileSizeValidation:"skipFileSizeValidation",currentPageName:"currentPageName",maxFileAllowed:"maxFileAllowed"},outputs:{imageOutput:"imageOutput"},decls:2,vars:1,consts:[["hidden","","type","file","accept","image/png, image/jpg, image/jpeg",3,"multiple","change"],["upload",""]],template:function(e,t){1&e&&(n.TgZ(0,"input",0,1),n.NdJ("change",function(e){return t.handleUpload(e)}),n.qZA()),2&e&&n.Q6J("multiple",t.isMultiple)},encapsulation:2}),e})()}}]);